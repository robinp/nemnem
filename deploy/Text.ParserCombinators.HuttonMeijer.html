<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Text.ParserCombinators.HuttonMeijer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  Graham Hutton (University of Nottingham), Erik Meijer (University of Utrecht)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Licence     :  BSD</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Malcolm Wallace &lt;Malcolm.Wallace@cs.york.ac.uk&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  Stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  All</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                  A LIBRARY OF MONADIC PARSER COMBINATORS</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                               29th July 1996</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                  Graham Hutton               Erik Meijer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--             University of Nottingham    University of Utrecht</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This Haskell script defines a library of parser combinators, and is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- taken from sections 1-6 of our article &quot;Monadic Parser Combinators&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Some changes to the library have been made in the move from Gofer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to Haskell:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    * Do notation is used in place of monad comprehension notation;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    * The parser datatype is defined using &quot;newtype&quot;, to avoid the overhead</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      of tagging and untagging parsers with the P constructor.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">


module Text.ParserCombinators.HuttonMeijer
   (Parser(..), item, first, papply, (+++), sat, </span><span class="hl_comment"><span class="mpre">{-tok,-}</span></span><span class="mpre"> many, many1,
    sepby, sepby1, chainl,
    chainl1, chainr, chainr1, ops, bracket, char, digit, lower, upper,
    letter, alphanum, string, ident, nat, int, spaces, comment, junk,
    skip, token, natural, integer, symbol, identifier) where

import Data.Char
import Control.Monad

</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijer.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 1, srcSpanEndLine = 40, srcSpanEndColumn = 13}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijer.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 8, srcSpanEndLine = 40, srcSpanEndColumn = 9}]}) (AssocRight (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename"><span class="mpre">infixr 5 +++</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijer.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 1, srcSpanEndLine = 42, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijer.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 1, srcSpanEndLine = 42, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/"><span class="mpre">type Token = Char</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The parser monad</span></span><span class="mpre">

newtype </span><a name="loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tycondecl"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">   = </span><a name="loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_condecl"><span class="mpre">P</span></span></a><span class="mpre"> ([</span><span class="hl_tyconref"><span class="mpre">Token</span></span><span class="mpre">] -&gt; [(</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">Token</span></span><span class="mpre">])])

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> where
   </span><span class="hl_comment"><span class="mpre">-- map         :: (a -&gt; b) -&gt; (Parser a -&gt; Parser b)</span></span><span class="mpre">
   </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_51_9_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_51_14_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_14_51_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">)    = </span><a href="#loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_51_26_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_26_51_29&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> -&gt; [(</span><a href="#loc_51_9_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_51_48_51_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_48_51_49&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">, </span><a href="#loc_51_50_51_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_50_51_53&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">) | (</span><a name="loc_51_48_51_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_48_51_49&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_51_50_51_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_50_51_53&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_51_14_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_14_51_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_51_26_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_26_51_29&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">])

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> where
   </span><span class="hl_comment"><span class="mpre">-- return      :: a -&gt; Parser a</span></span><span class="mpre">
   </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_55_11_55_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_11_55_12&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">        = </span><a href="#loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_55_26_55_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_26_55_29&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> -&gt; [(</span><a href="#loc_55_11_55_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_11_55_12&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_55_26_55_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_26_55_29&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">)])

   </span><span class="hl_comment"><span class="mpre">-- &gt;&gt;=         :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b</span></span><span class="mpre">
   (</span><a href="#loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_58_7_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_7_58_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_58_14_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_14_58_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     = </span><a href="#loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_58_26_58_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_26_58_29&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> [</span><a href="#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_7&#39;)"><span class="hl_varref"><span class="mpre">papply</span></span></a><span class="mpre"> (</span><a href="#loc_58_14_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_14_58_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_58_61_58_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_61_58_62&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) </span><a href="#loc_58_63_58_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_63_58_66&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre"> | (</span><a name="loc_58_61_58_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_61_58_62&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_58_63_58_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_63_58_66&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_58_7_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_7_58_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_58_26_58_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_26_58_29&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">])

   </span><span class="hl_comment"><span class="mpre">-- fail        :: String -&gt; Parser a</span></span><span class="mpre">
   </span><span class="hl_fundecl"><span class="mpre">fail</span></span><span class="mpre"> _          = </span><a href="#loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\_ -&gt; [])

instance </span><span class="hl_classref"><span class="mpre">MonadPlus</span></span><span class="mpre"> </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> where
   </span><span class="hl_comment"><span class="mpre">-- mzero       :: Parser a</span></span><span class="mpre">
   </span><span class="hl_vardecl"><span class="mpre">mzero</span></span><span class="mpre">           = </span><a href="#loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\_ -&gt; [])

   </span><span class="hl_comment"><span class="mpre">-- mplus       :: Parser a -&gt; Parser a -&gt; Parser a</span></span><span class="mpre">
   (</span><a href="#loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_68_7_68_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_7_68_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_fundecl"><span class="mpre">`mplus`</span></span><span class="mpre"> (</span><a href="#loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_68_21_68_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_21_68_22&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">)  = </span><a href="#loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_68_31_68_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_31_68_34&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_68_7_68_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_7_68_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_68_31_68_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_31_68_34&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_68_21_68_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_21_68_22&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><a href="#loc_68_31_68_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_31_68_34&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Other primitive parser combinators</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_75_1_75_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_5&#39;)"><span class="mpre">item</span></a><span class="mpre">               :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Token</span></span><span class="mpre">
</span><a name="loc_75_1_75_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_5&#39;)"><span class="hl_vardecl"><span class="mpre">item</span></span></a><span class="mpre">                = </span><a href="#loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_75_27_75_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_27_75_30&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_75_27_75_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_27_75_30&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre"> of
                                   []     -&gt; []
                                   (</span><a name="loc_77_37_77_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_37_77_38&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_77_39_77_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_39_77_41&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) -&gt; [(</span><a href="#loc_77_37_77_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_37_77_38&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_77_39_77_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_39_77_41&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)])

</span><a href="#loc_80_1_80_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_6&#39;)"><span class="mpre">first</span></a><span class="mpre">             :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_80_1_80_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_6&#39;)"><span class="hl_fundecl"><span class="mpre">first</span></span></a><span class="mpre"> (</span><a href="#loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_80_10_80_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_10_80_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">)        = </span><a href="#loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_80_26_80_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_26_80_29&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_80_10_80_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_10_80_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_80_26_80_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_26_80_29&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre"> of
                                   []    -&gt; []
                                   (</span><a name="loc_82_37_82_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_37_82_38&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; [</span><a href="#loc_82_37_82_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_37_82_38&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">])

</span><a href="#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_7&#39;)"><span class="mpre">papply</span></a><span class="mpre">            :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Token</span></span><span class="mpre">] -&gt; [(</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">Token</span></span><span class="mpre">])]
</span><a name="loc_85_1_85_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_7&#39;)"><span class="hl_fundecl"><span class="mpre">papply</span></span></a><span class="mpre"> (</span><a href="#loc_47_22_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_23&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_85_11_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_11_85_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><a name="loc_85_14_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_17&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre">   = </span><a href="#loc_85_11_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_11_85_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_85_14_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_17&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Derived combinators</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_6&#39;)"><span class="mpre">(+++)</span></a><span class="mpre">             :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_92_1_92_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_2&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_92_3_92_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_6&#39;)"><span class="hl_fundecl"><span class="mpre">+++</span></span></a><span class="mpre"> </span><a name="loc_92_7_92_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_7_92_8&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">            = </span><a href="#loc_80_1_80_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_6&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="mpre"> (</span><a href="#loc_92_1_92_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mplus`</span></span><span class="mpre"> </span><a href="#loc_92_7_92_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_7_92_8&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">)

</span><a href="#loc_95_1_95_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_4&#39;)"><span class="mpre">sat</span></a><span class="mpre">               :: (</span><span class="hl_tyconref"><span class="mpre">Token</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Token</span></span><span class="mpre">
</span><a name="loc_95_1_95_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_4&#39;)"><span class="hl_fundecl"><span class="mpre">sat</span></span></a><span class="mpre"> </span><a name="loc_95_5_95_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_5_95_6&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">              = do {</span><a name="loc_95_26_95_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_26_95_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_75_1_75_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_5&#39;)"><span class="hl_varref"><span class="mpre">item</span></span></a><span class="mpre">; if </span><a href="#loc_95_5_95_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_5_95_6&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_95_26_95_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_26_95_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_95_26_95_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_26_95_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">mzero</span></span><span class="mpre">}

</span><span class="hl_comment"><span class="mpre">--tok               :: Token -&gt; Parser Token</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--tok t              = do {x &lt;- item; if t==snd x then return t else mzero}</span></span><span class="mpre">

</span><a href="#loc_101_1_101_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_5&#39;)"><span class="mpre">many</span></a><span class="mpre">              :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_101_1_101_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_5&#39;)"><span class="hl_fundecl"><span class="mpre">many</span></span></a><span class="mpre"> </span><a name="loc_101_6_101_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_6_101_7&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">             = </span><a href="#loc_105_1_105_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_6&#39;)"><span class="hl_varref"><span class="mpre">many1</span></span></a><span class="mpre"> </span><a href="#loc_101_6_101_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_6_101_7&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
</span><span class="hl_comment"><span class="mpre">--many p           = force (many1 p +++ return [])</span></span><span class="mpre">

</span><a href="#loc_105_1_105_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_6&#39;)"><span class="mpre">many1</span></a><span class="mpre">             :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_105_1_105_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_6&#39;)"><span class="hl_fundecl"><span class="mpre">many1</span></span></a><span class="mpre"> </span><a name="loc_105_7_105_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_7_105_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">            = do {</span><a name="loc_105_26_105_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_26_105_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_105_7_105_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_7_105_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><a name="loc_105_34_105_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_34_105_36&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_101_1_101_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_105_7_105_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_7_105_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_105_26_105_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_26_105_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_105_34_105_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_34_105_36&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)}

</span><a href="#loc_108_3_108_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_3_108_10&#39;)"><span class="mpre">sepby</span></a><span class="mpre">             :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_108_1_108_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_2&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_108_3_108_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_3_108_10&#39;)"><span class="hl_fundecl"><span class="mpre">`sepby`</span></span></a><span class="mpre"> </span><a name="loc_108_11_108_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_11_108_14&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre">      = (</span><a href="#loc_108_1_108_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_111_3_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_3_111_11&#39;)"><span class="hl_infix"><span class="mpre">`sepby1`</span></span></a><span class="mpre"> </span><a href="#loc_108_11_108_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_11_108_14&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre">) </span><a href="#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []

</span><a href="#loc_111_3_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_3_111_11&#39;)"><span class="mpre">sepby1</span></a><span class="mpre">            :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_111_1_111_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_2&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_111_3_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_3_111_11&#39;)"><span class="hl_fundecl"><span class="mpre">`sepby1`</span></span></a><span class="mpre"> </span><a name="loc_111_12_111_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_12_111_15&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre">     = do {</span><a name="loc_111_26_111_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_26_111_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_111_1_111_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><a name="loc_111_34_111_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_34_111_36&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_101_1_101_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> (do {</span><a href="#loc_111_12_111_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_12_111_15&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre">; </span><a href="#loc_111_1_111_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">}); </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_111_26_111_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_26_111_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_111_34_111_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_34_111_36&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)}

</span><a href="#loc_114_1_114_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_7&#39;)"><span class="mpre">chainl</span></a><span class="mpre">            :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_114_1_114_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_7&#39;)"><span class="hl_fundecl"><span class="mpre">chainl</span></span></a><span class="mpre"> </span><a name="loc_114_8_114_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_8_114_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_114_10_114_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_10_114_12&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> </span><a name="loc_114_13_114_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_13_114_14&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">      = (</span><a href="#loc_114_8_114_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_8_114_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_117_3_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_3_117_12&#39;)"><span class="hl_infix"><span class="mpre">`chainl1`</span></span></a><span class="mpre"> </span><a href="#loc_114_10_114_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_10_114_12&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">) </span><a href="#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_114_13_114_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_13_114_14&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><a href="#loc_117_3_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_3_117_12&#39;)"><span class="mpre">chainl1</span></a><span class="mpre">           :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_117_1_117_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_2&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_117_3_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_3_117_12&#39;)"><span class="hl_fundecl"><span class="mpre">`chainl1`</span></span></a><span class="mpre"> </span><a name="loc_117_13_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_13_117_15&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre">     = do {</span><a name="loc_117_26_117_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_117_1_117_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><a href="#loc_119_25_119_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_25_119_29&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a href="#loc_117_26_117_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">}
                     where
                        </span><a name="loc_119_25_119_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_25_119_29&#39;)"><span class="hl_fundecl"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a name="loc_119_30_119_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_30_119_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do {</span><a name="loc_119_38_119_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_38_119_39&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_117_13_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_13_117_15&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">; </span><a name="loc_119_47_119_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_47_119_48&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_117_1_117_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><a href="#loc_119_25_119_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_25_119_29&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> (</span><a href="#loc_119_38_119_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_38_119_39&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_119_30_119_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_30_119_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_119_47_119_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_47_119_48&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)}
                                 </span><a href="#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_119_30_119_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_30_119_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_123_1_123_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_7&#39;)"><span class="mpre">chainr</span></a><span class="mpre">            :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_123_1_123_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_7&#39;)"><span class="hl_fundecl"><span class="mpre">chainr</span></span></a><span class="mpre"> </span><a name="loc_123_8_123_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_8_123_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_123_10_123_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_10_123_12&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> </span><a name="loc_123_13_123_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_14&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">      = (</span><a href="#loc_123_8_123_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_8_123_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_126_3_126_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_3_126_12&#39;)"><span class="hl_infix"><span class="mpre">`chainr1`</span></span></a><span class="mpre"> </span><a href="#loc_123_10_123_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_10_123_12&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">) </span><a href="#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_123_13_123_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_14&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><a href="#loc_126_3_126_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_3_126_12&#39;)"><span class="mpre">chainr1</span></a><span class="mpre">           :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_126_1_126_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_2&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_126_3_126_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_3_126_12&#39;)"><span class="hl_fundecl"><span class="mpre">`chainr1`</span></span></a><span class="mpre"> </span><a name="loc_126_13_126_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_13_126_15&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre">     = do {</span><a name="loc_126_26_126_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_26_126_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_126_1_126_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><a href="#loc_128_25_128_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_25_128_29&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a href="#loc_126_26_126_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_26_126_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">}
                     where
                        </span><a name="loc_128_25_128_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_25_128_29&#39;)"><span class="hl_fundecl"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a name="loc_128_30_128_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_30_128_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do {</span><a name="loc_128_38_128_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_38_128_39&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_126_13_126_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_13_126_15&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">; </span><a name="loc_128_47_128_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_47_128_48&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_126_1_126_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_126_3_126_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_3_126_12&#39;)"><span class="hl_infix"><span class="mpre">`chainr1`</span></span></a><span class="mpre"> </span><a href="#loc_126_13_126_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_13_126_15&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_128_38_128_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_38_128_39&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_128_30_128_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_30_128_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_128_47_128_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_47_128_48&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)}
                                 </span><a href="#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_128_30_128_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_30_128_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_132_1_132_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_4&#39;)"><span class="mpre">ops</span></a><span class="mpre">               :: [(</span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)] -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_132_1_132_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_4&#39;)"><span class="hl_fundecl"><span class="mpre">ops</span></span></a><span class="mpre"> </span><a name="loc_132_5_132_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_5_132_7&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">             = </span><span class="hl_varref"><span class="mpre">foldr1</span></span><span class="mpre"> </span><a href="#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_6&#39;)"><span class="hl_varref"><span class="mpre">(+++)</span></span></a><span class="mpre"> [do {</span><a href="#loc_132_57_132_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_57_132_58&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_132_59_132_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_59_132_61&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">} | (</span><a name="loc_132_57_132_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_57_132_58&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><a name="loc_132_59_132_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_59_132_61&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_132_5_132_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_5_132_7&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">]

</span><a href="#loc_135_1_135_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_8&#39;)"><span class="mpre">bracket</span></a><span class="mpre">           :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_135_1_135_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_8&#39;)"><span class="hl_fundecl"><span class="mpre">bracket</span></span></a><span class="mpre"> </span><a name="loc_135_9_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_13&#39;)"><span class="hl_vardecl"><span class="mpre">open</span></span></a><span class="mpre"> </span><a name="loc_135_14_135_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_14_135_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_135_16_135_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_16_135_21&#39;)"><span class="hl_vardecl"><span class="mpre">close</span></span></a><span class="mpre"> = do {</span><a href="#loc_135_9_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_13&#39;)"><span class="hl_varref"><span class="mpre">open</span></span></a><span class="mpre">; </span><a name="loc_135_34_135_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_34_135_35&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_135_14_135_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_14_135_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><a href="#loc_135_16_135_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_16_135_21&#39;)"><span class="hl_varref"><span class="mpre">close</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_135_34_135_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_34_135_35&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">}

</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Useful parsers</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_142_1_142_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_5&#39;)"><span class="mpre">char</span></a><span class="mpre">              :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_142_1_142_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_5&#39;)"><span class="hl_fundecl"><span class="mpre">char</span></span></a><span class="mpre"> </span><a name="loc_142_6_142_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_6_142_7&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">             = </span><a href="#loc_95_1_95_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_4&#39;)"><span class="hl_varref"><span class="mpre">sat</span></span></a><span class="mpre"> (\</span><a name="loc_142_28_142_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_28_142_29&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_142_6_142_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_6_142_7&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_142_28_142_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_28_142_29&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)

</span><a href="#loc_145_1_145_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_6&#39;)"><span class="mpre">digit</span></a><span class="mpre">             :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_145_1_145_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_6&#39;)"><span class="hl_vardecl"><span class="mpre">digit</span></span></a><span class="mpre">              = </span><a href="#loc_95_1_95_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_4&#39;)"><span class="hl_varref"><span class="mpre">sat</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isDigit</span></span><span class="mpre">

</span><a href="#loc_148_1_148_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_6&#39;)"><span class="mpre">lower</span></a><span class="mpre">             :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_148_1_148_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_6&#39;)"><span class="hl_vardecl"><span class="mpre">lower</span></span></a><span class="mpre">              = </span><a href="#loc_95_1_95_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_4&#39;)"><span class="hl_varref"><span class="mpre">sat</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isLower</span></span><span class="mpre">

</span><a href="#loc_151_1_151_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_6&#39;)"><span class="mpre">upper</span></a><span class="mpre">             :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_151_1_151_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_6&#39;)"><span class="hl_vardecl"><span class="mpre">upper</span></span></a><span class="mpre">              = </span><a href="#loc_95_1_95_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_4&#39;)"><span class="hl_varref"><span class="mpre">sat</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isUpper</span></span><span class="mpre">

</span><a href="#loc_154_1_154_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_7&#39;)"><span class="mpre">letter</span></a><span class="mpre">            :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_154_1_154_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_7&#39;)"><span class="hl_vardecl"><span class="mpre">letter</span></span></a><span class="mpre">             = </span><a href="#loc_95_1_95_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_4&#39;)"><span class="hl_varref"><span class="mpre">sat</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isAlpha</span></span><span class="mpre">

</span><a href="#loc_157_1_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_9&#39;)"><span class="mpre">alphanum</span></a><span class="mpre">          :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_157_1_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_9&#39;)"><span class="hl_vardecl"><span class="mpre">alphanum</span></span></a><span class="mpre">           = </span><a href="#loc_95_1_95_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_4&#39;)"><span class="hl_varref"><span class="mpre">sat</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isAlphaNum</span></span><span class="mpre"> </span><a href="#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><a href="#loc_142_1_142_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="mpre">

</span><a href="#loc_160_1_160_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_7&#39;)"><span class="mpre">string</span></a><span class="mpre">            :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_160_1_160_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_7&#39;)"><span class="hl_fundecl"><span class="mpre">string</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">          = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
</span><a href="#loc_160_1_160_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_7&#39;)"><span class="hl_fundecl"><span class="mpre">string</span></span></a><span class="mpre"> (</span><a name="loc_161_9_161_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_161_11_161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_11_161_13&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)      = do {</span><a href="#loc_142_1_142_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><a href="#loc_161_9_161_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">; </span><a href="#loc_160_1_160_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_7&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><a href="#loc_161_11_161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_11_161_13&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_161_9_161_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_161_11_161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_11_161_13&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)}

</span><a href="#loc_164_1_164_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_6&#39;)"><span class="mpre">ident</span></a><span class="mpre">             :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_164_1_164_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_6&#39;)"><span class="hl_vardecl"><span class="mpre">ident</span></span></a><span class="mpre">              = do {</span><a name="loc_164_26_164_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_26_164_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_148_1_148_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_6&#39;)"><span class="hl_varref"><span class="mpre">lower</span></span></a><span class="mpre">; </span><a name="loc_164_38_164_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_38_164_40&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_101_1_101_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_157_1_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_9&#39;)"><span class="hl_varref"><span class="mpre">alphanum</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_164_26_164_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_26_164_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_164_38_164_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_38_164_40&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)}

</span><a href="#loc_167_1_167_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_4&#39;)"><span class="mpre">nat</span></a><span class="mpre">               :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_167_1_167_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_4&#39;)"><span class="hl_vardecl"><span class="mpre">nat</span></span></a><span class="mpre">                = do {</span><a name="loc_167_26_167_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_26_167_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_145_1_145_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_6&#39;)"><span class="hl_varref"><span class="mpre">digit</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_167_26_167_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_26_167_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre">)} </span><a href="#loc_117_3_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_3_117_12&#39;)"><span class="hl_infix"><span class="mpre">`chainl1`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_169_27_169_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_27_169_31&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">
                     where
                        </span><a name="loc_169_25_169_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_25_169_26&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_169_27_169_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_27_169_31&#39;)"><span class="hl_fundecl"><span class="mpre">`op`</span></span></a><span class="mpre"> </span><a name="loc_169_32_169_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_32_169_33&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">10</span></span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_169_25_169_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_25_169_26&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_169_32_169_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_32_169_33&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><a href="#loc_172_1_172_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_1_172_4&#39;)"><span class="mpre">int</span></a><span class="mpre">               :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_172_1_172_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_1_172_4&#39;)"><span class="hl_vardecl"><span class="mpre">int</span></span></a><span class="mpre">                = do {</span><a href="#loc_142_1_142_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="mpre">; </span><a name="loc_172_36_172_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_36_172_37&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_167_1_167_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_4&#39;)"><span class="hl_varref"><span class="mpre">nat</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (-</span><a href="#loc_172_36_172_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_36_172_37&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)} </span><a href="#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><a href="#loc_167_1_167_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_4&#39;)"><span class="hl_varref"><span class="mpre">nat</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Lexical combinators</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_179_1_179_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_7&#39;)"><span class="mpre">spaces</span></a><span class="mpre">            :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_179_1_179_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_7&#39;)"><span class="hl_vardecl"><span class="mpre">spaces</span></span></a><span class="mpre">             = do {</span><a href="#loc_105_1_105_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_6&#39;)"><span class="hl_varref"><span class="mpre">many1</span></span></a><span class="mpre"> (</span><a href="#loc_95_1_95_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_4&#39;)"><span class="hl_varref"><span class="mpre">sat</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isSpace</span></span><span class="mpre">); </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">}

</span><a href="#loc_187_1_187_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_8&#39;)"><span class="mpre">comment</span></a><span class="mpre">           :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--comment            = do {string &quot;--&quot;; many (sat (\x -&gt; x /= &#39;\n&#39;)); return ()}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--comment            = do </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                       _ &lt;- string &quot;--&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                       _ &lt;- many (sat (\x -&gt; x /= &#39;\n&#39;))</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                       return ()</span></span><span class="mpre">
</span><a name="loc_187_1_187_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_8&#39;)"><span class="hl_vardecl"><span class="mpre">comment</span></span></a><span class="mpre">            = do
                       </span><a href="#loc_135_1_135_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_8&#39;)"><span class="hl_varref"><span class="mpre">bracket</span></span></a><span class="mpre"> (</span><a href="#loc_160_1_160_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_7&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/*&quot;</span></span><span class="mpre">) (</span><a href="#loc_101_1_101_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_75_1_75_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_5&#39;)"><span class="hl_varref"><span class="mpre">item</span></span></a><span class="mpre">) (</span><a href="#loc_160_1_160_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_7&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;*/&quot;</span></span><span class="mpre">)
                       </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_192_1_192_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_5&#39;)"><span class="mpre">junk</span></a><span class="mpre">              :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_192_1_192_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_5&#39;)"><span class="hl_vardecl"><span class="mpre">junk</span></span></a><span class="mpre">               = do {</span><a href="#loc_101_1_101_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> (</span><a href="#loc_179_1_179_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_7&#39;)"><span class="hl_varref"><span class="mpre">spaces</span></span></a><span class="mpre"> </span><a href="#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><a href="#loc_187_1_187_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_8&#39;)"><span class="hl_varref"><span class="mpre">comment</span></span></a><span class="mpre">); </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">}

</span><a href="#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_5&#39;)"><span class="mpre">skip</span></a><span class="mpre">              :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_195_1_195_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_5&#39;)"><span class="hl_fundecl"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a name="loc_195_6_195_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_6_195_7&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">             = do {</span><a href="#loc_192_1_192_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_5&#39;)"><span class="hl_varref"><span class="mpre">junk</span></span></a><span class="mpre">; </span><a href="#loc_195_6_195_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_6_195_7&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">}

</span><a href="#loc_198_1_198_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_6&#39;)"><span class="mpre">token</span></a><span class="mpre">             :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_198_1_198_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_6&#39;)"><span class="hl_fundecl"><span class="mpre">token</span></span></a><span class="mpre"> </span><a name="loc_198_7_198_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_7_198_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">            = do {</span><a name="loc_198_26_198_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_26_198_27&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_198_7_198_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_7_198_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><a href="#loc_192_1_192_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_5&#39;)"><span class="hl_varref"><span class="mpre">junk</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_198_26_198_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_26_198_27&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">}

</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Token parsers</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_205_1_205_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_8&#39;)"><span class="mpre">natural</span></a><span class="mpre">           :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_205_1_205_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_8&#39;)"><span class="hl_vardecl"><span class="mpre">natural</span></span></a><span class="mpre">            = </span><a href="#loc_198_1_198_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_6&#39;)"><span class="hl_varref"><span class="mpre">token</span></span></a><span class="mpre"> </span><a href="#loc_167_1_167_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_4&#39;)"><span class="hl_varref"><span class="mpre">nat</span></span></a><span class="mpre">

</span><a href="#loc_208_1_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_8&#39;)"><span class="mpre">integer</span></a><span class="mpre">           :: </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_208_1_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_8&#39;)"><span class="hl_vardecl"><span class="mpre">integer</span></span></a><span class="mpre">            = </span><a href="#loc_198_1_198_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_6&#39;)"><span class="hl_varref"><span class="mpre">token</span></span></a><span class="mpre"> </span><a href="#loc_172_1_172_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_1_172_4&#39;)"><span class="hl_varref"><span class="mpre">int</span></span></a><span class="mpre">

</span><a href="#loc_211_1_211_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_1_211_7&#39;)"><span class="mpre">symbol</span></a><span class="mpre">            :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_211_1_211_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_1_211_7&#39;)"><span class="hl_fundecl"><span class="mpre">symbol</span></span></a><span class="mpre"> </span><a name="loc_211_8_211_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_8_211_10&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">          = </span><a href="#loc_198_1_198_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_6&#39;)"><span class="hl_varref"><span class="mpre">token</span></span></a><span class="mpre"> (</span><a href="#loc_160_1_160_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_7&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><a href="#loc_211_8_211_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_8_211_10&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

</span><a href="#loc_214_1_214_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_11&#39;)"><span class="mpre">identifier</span></a><span class="mpre">        :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><a href="#loc_47_9_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_214_1_214_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_11&#39;)"><span class="hl_fundecl"><span class="mpre">identifier</span></span></a><span class="mpre"> </span><a name="loc_214_12_214_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_12_214_14&#39;)"><span class="hl_vardecl"><span class="mpre">ks</span></span></a><span class="mpre">      = </span><a href="#loc_198_1_198_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_6&#39;)"><span class="hl_varref"><span class="mpre">token</span></span></a><span class="mpre"> (do {</span><a name="loc_214_33_214_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_33_214_34&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_164_1_164_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_6&#39;)"><span class="hl_varref"><span class="mpre">ident</span></span></a><span class="mpre">;
                                if </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">elem</span></span><span class="mpre"> </span><a href="#loc_214_33_214_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_33_214_34&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_214_12_214_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_12_214_14&#39;)"><span class="hl_varref"><span class="mpre">ks</span></span></a><span class="mpre">) then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_214_33_214_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_33_214_34&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                                else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">mzero</span></span><span class="mpre">})

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span></div></body></html>