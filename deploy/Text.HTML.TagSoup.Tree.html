<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">{-|
    /NOTE/: This module is preliminary and may change at a future date.

    This module is intended to help converting a list of tags into a
    tree of tags.
-}</span></span><span class="mpre">

module Text.HTML.TagSoup.Tree
    (
    TagTree(..), tagTree,
    flattenTree, transformTree, universeTree
    ) where

import Text.HTML.TagSoup.Type
import Control.Arrow


data </span><a name="loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tycondecl"><span class="mpre">TagTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre"> = </span><a name="loc_18_20_18_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_20_18_29&#39;)"><span class="hl_condecl"><span class="mpre">TagBranch</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Attribute</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">] [</span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">TagTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]
                 | </span><a name="loc_19_20_19_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_20_19_27&#39;)"><span class="hl_condecl"><span class="mpre">TagLeaf</span></span></a><span class="mpre"> (</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">)
                   </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Tree.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 20, srcSpanEndLine = 20, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Tree.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 20, srcSpanEndLine = 20, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Tree.hs&quot;, "><span class="mpre">deriving (Eq,Ord,Show)</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">TagTree</span></span></a><span class="mpre"> where
    </span><a name="loc_23_5_23_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_5_23_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> </span><a name="loc_23_10_23_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_10_23_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_18_20_18_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_20_18_29&#39;)"><span class="hl_conref"><span class="mpre">TagBranch</span></span></a><span class="mpre"> </span><a name="loc_23_23_23_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_23_23_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_23_25_23_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_25_23_26&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_23_27_23_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_27_23_28&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">) = </span><a href="#loc_18_20_18_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_20_18_29&#39;)"><span class="hl_conref"><span class="mpre">TagBranch</span></span></a><span class="mpre"> (</span><a href="#loc_23_10_23_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_10_23_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_23_23_23_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_23_23_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_23_10_23_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_10_23_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><a href="Control.Arrow.html#loc_107_5_107_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_107_5_107_10&#39;)"><span class="hl_infix"><span class="mpre">***</span></span></a><a href="#loc_23_10_23_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_10_23_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_23_25_23_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_25_23_26&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_23_10_23_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_10_23_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_23_27_23_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_27_23_28&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">)
    </span><a href="#loc_23_5_23_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_5_23_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> </span><a name="loc_24_10_24_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_10_24_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_19_20_19_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_20_19_27&#39;)"><span class="hl_conref"><span class="mpre">TagLeaf</span></span></a><span class="mpre"> </span><a name="loc_24_21_24_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_21_24_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_19_20_19_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_20_19_27&#39;)"><span class="hl_conref"><span class="mpre">TagLeaf</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_24_10_24_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_10_24_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_24_21_24_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_21_24_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Convert a list of tags into a tree. This version is not lazy at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   all, that is saved for version 2.</span></span><span class="mpre">
</span><a href="#loc_30_1_30_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_8&#39;)"><span class="mpre">tagTree</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Tree.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 12, srcSpanEndLine = 29, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Tree.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 19, srcSpanEndLine = 29, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tags"><span class="mpre">Eq str =&gt;</span></span><span class="mpre"> [</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">] -&gt; [</span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">TagTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]
</span><a name="loc_30_1_30_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_8&#39;)"><span class="hl_vardecl"><span class="mpre">tagTree</span></span></a><span class="mpre"> = </span><a href="#loc_33_9_33_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
    where
        </span><a href="#loc_33_9_33_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_10&#39;)"><span class="mpre">g</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Tree.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 14, srcSpanEndLine = 32, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Tree.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 21, srcSpanEndLine = 32, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tags"><span class="mpre">Eq str =&gt;</span></span><span class="mpre"> [</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">] -&gt; [</span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">TagTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]
        </span><a name="loc_33_9_33_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_10&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> [] = []
        </span><a href="#loc_33_9_33_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_10&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_34_11_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_11_34_13&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_35_20_35_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_20_35_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_19_20_19_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_20_19_27&#39;)"><span class="hl_conref"><span class="mpre">TagLeaf</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_35_22_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_22_35_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_33_9_33_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_35_22_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_22_35_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
            where (</span><a name="loc_35_20_35_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_20_35_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_35_22_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_22_35_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_34_11_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_11_34_13&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- the second tuple is either null or starts with a close</span></span><span class="mpre">
        </span><a href="#loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="mpre">f</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Tree.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 14, srcSpanEndLine = 38, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tagsoup-0.13.1/Text/HTML/TagSoup/Tree.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 21, srcSpanEndLine = 38, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tags"><span class="mpre">Eq str =&gt;</span></span><span class="mpre"> [</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">] -&gt; ([</span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">TagTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">],[</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">])
        </span><a name="loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="Text.HTML.TagSoup.Type.html#loc_60_6_60_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_60_6_60_13&#39;)"><span class="hl_conref"><span class="mpre">TagOpen</span></span></a><span class="mpre"> </span><a name="loc_39_20_39_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_20_39_24&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_39_25_39_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_25_39_29&#39;)"><span class="hl_vardecl"><span class="mpre">atts</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_39_30_39_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_30_39_34&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) =
            case </span><a href="#loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_39_30_39_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_30_39_34&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> of
                (</span><a name="loc_41_18_41_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_18_41_23&#39;)"><span class="hl_vardecl"><span class="mpre">inner</span></span></a><span class="mpre">,[]) -&gt; (</span><a href="#loc_19_20_19_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_20_19_27&#39;)"><span class="hl_conref"><span class="mpre">TagLeaf</span></span></a><span class="mpre"> (</span><a href="Text.HTML.TagSoup.Type.html#loc_60_6_60_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_60_6_60_13&#39;)"><span class="hl_conref"><span class="mpre">TagOpen</span></span></a><span class="mpre"> </span><a href="#loc_39_20_39_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_20_39_24&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_39_25_39_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_25_39_29&#39;)"><span class="hl_varref"><span class="mpre">atts</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_41_18_41_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_18_41_23&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre">, [])
                (</span><a name="loc_42_18_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_18_42_23&#39;)"><span class="hl_vardecl"><span class="mpre">inner</span></span></a><span class="mpre">,</span><a href="Text.HTML.TagSoup.Type.html#loc_61_6_61_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_61_6_61_14&#39;)"><span class="hl_conref"><span class="mpre">TagClose</span></span></a><span class="mpre"> </span><a name="loc_42_33_42_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_33_42_34&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_42_35_42_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_35_42_37&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)
                    | </span><a href="#loc_42_33_42_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_33_42_34&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_39_20_39_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_20_39_24&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> -&gt; let (</span><a name="loc_43_41_43_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_41_43_42&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_43_43_43_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_43_43_44&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_42_35_42_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_35_42_37&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> in (</span><a href="#loc_18_20_18_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_20_18_29&#39;)"><span class="hl_conref"><span class="mpre">TagBranch</span></span></a><span class="mpre"> </span><a href="#loc_39_20_39_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_20_39_24&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_39_25_39_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_25_39_29&#39;)"><span class="hl_varref"><span class="mpre">atts</span></span></a><span class="mpre"> </span><a href="#loc_42_18_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_18_42_23&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_43_41_43_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_41_43_42&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_43_43_43_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_43_43_44&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
                    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; (</span><a href="#loc_19_20_19_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_20_19_27&#39;)"><span class="hl_conref"><span class="mpre">TagLeaf</span></span></a><span class="mpre"> (</span><a href="Text.HTML.TagSoup.Type.html#loc_60_6_60_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_60_6_60_13&#39;)"><span class="hl_conref"><span class="mpre">TagOpen</span></span></a><span class="mpre"> </span><a href="#loc_39_20_39_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_20_39_24&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_39_25_39_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_25_39_29&#39;)"><span class="hl_varref"><span class="mpre">atts</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_42_18_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_18_42_23&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre">, </span><a href="Text.HTML.TagSoup.Type.html#loc_61_6_61_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_61_6_61_14&#39;)"><span class="hl_conref"><span class="mpre">TagClose</span></span></a><span class="mpre"> </span><a href="#loc_42_33_42_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_33_42_34&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_42_35_42_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_35_42_37&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
                _ -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;TagSoup.Tree.tagTree: safe as - forall x . isTagClose (snd (f x))&quot;</span></span><span class="mpre">

        </span><a href="#loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="Text.HTML.TagSoup.Type.html#loc_61_6_61_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_61_6_61_14&#39;)"><span class="hl_conref"><span class="mpre">TagClose</span></span></a><span class="mpre"> </span><a name="loc_47_21_47_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_21_47_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_47_23_47_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_23_47_25&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = ([], </span><a href="Text.HTML.TagSoup.Type.html#loc_61_6_61_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_61_6_61_14&#39;)"><span class="hl_conref"><span class="mpre">TagClose</span></span></a><span class="mpre"> </span><a href="#loc_47_21_47_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_21_47_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_47_23_47_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_23_47_25&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
        </span><a href="#loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a name="loc_48_12_48_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_12_48_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_48_14_48_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_14_48_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = (</span><a href="#loc_19_20_19_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_20_19_27&#39;)"><span class="hl_conref"><span class="mpre">TagLeaf</span></span></a><span class="mpre"> </span><a href="#loc_48_12_48_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_12_48_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_49_20_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_20_49_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_49_22_49_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_22_49_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
            where (</span><a name="loc_49_20_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_20_49_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_49_22_49_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_22_49_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_48_14_48_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_14_48_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> [] = ([], [])


</span><a href="#loc_54_1_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_12&#39;)"><span class="mpre">flattenTree</span></a><span class="mpre"> :: [</span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">TagTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">] -&gt; [</span><a href="Text.HTML.TagSoup.Type.html#loc_59_6_59_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_59_6_59_9&#39;)"><span class="hl_tyconref"><span class="mpre">Tag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]
</span><a name="loc_54_1_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_12&#39;)"><span class="hl_fundecl"><span class="mpre">flattenTree</span></span></a><span class="mpre"> </span><a name="loc_54_13_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_13_54_15&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_56_9_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_54_13_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_13_54_15&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    where
        </span><a name="loc_56_9_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_18_20_18_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_20_18_29&#39;)"><span class="hl_conref"><span class="mpre">TagBranch</span></span></a><span class="mpre"> </span><a name="loc_56_22_56_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_22_56_26&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_56_27_56_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_27_56_31&#39;)"><span class="hl_vardecl"><span class="mpre">atts</span></span></a><span class="mpre"> </span><a name="loc_56_32_56_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_32_56_37&#39;)"><span class="hl_vardecl"><span class="mpre">inner</span></span></a><span class="mpre">) =
            </span><a href="Text.HTML.TagSoup.Type.html#loc_60_6_60_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_60_6_60_13&#39;)"><span class="hl_conref"><span class="mpre">TagOpen</span></span></a><span class="mpre"> </span><a href="#loc_56_22_56_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_22_56_26&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_56_27_56_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_27_56_31&#39;)"><span class="hl_varref"><span class="mpre">atts</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_54_1_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_12&#39;)"><span class="hl_varref"><span class="mpre">flattenTree</span></span></a><span class="mpre"> </span><a href="#loc_56_32_56_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_32_56_37&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="Text.HTML.TagSoup.Type.html#loc_61_6_61_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.HTML.TagSoup.Type.html#loc_61_6_61_14&#39;)"><span class="hl_conref"><span class="mpre">TagClose</span></span></a><span class="mpre"> </span><a href="#loc_56_22_56_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_22_56_26&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">]
        </span><a href="#loc_56_9_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_19_20_19_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_20_19_27&#39;)"><span class="hl_conref"><span class="mpre">TagLeaf</span></span></a><span class="mpre"> </span><a name="loc_58_20_58_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_20_58_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = [</span><a href="#loc_58_20_58_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_20_58_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]


</span><span class="hl_comment"><span class="mpre">-- | This operation is based on the Uniplate @universe@ function. Given a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   list of trees, it returns those trees, and all the children trees at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   any level. For example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; universeTree</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;    [TagBranch &quot;a&quot; [(&quot;href&quot;,&quot;url&quot;)] [TagBranch &quot;b&quot; [] [TagLeaf (TagText &quot;text&quot;)]]]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; == [TagBranch &quot;a&quot; [(&quot;href&quot;,&quot;url&quot;)] [TagBranch &quot;b&quot; [] [TagLeaf (TagText &quot;text&quot;)]]]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;    ,TagBranch &quot;b&quot; [] [TagLeaf (TagText &quot;text&quot;)]]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   This operation is particularly useful for queries. To collect all @\&quot;a\&quot;@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   tags in a tree, simply do:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; [x | x@(TagTree &quot;a&quot; _ _) &lt;- universeTree tree]</span></span><span class="mpre">
</span><a href="#loc_75_1_75_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_13&#39;)"><span class="mpre">universeTree</span></a><span class="mpre"> :: [</span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">TagTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">] -&gt; [</span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">TagTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]
</span><a name="loc_75_1_75_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_13&#39;)"><span class="hl_vardecl"><span class="mpre">universeTree</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_77_9_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
    where
        </span><a name="loc_77_9_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_77_11_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_11_77_12&#39;)"><span class="hl_specname"><span class="mpre">t</span></span></a><span class="mpre">@(</span><a href="#loc_18_20_18_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_20_18_29&#39;)"><span class="hl_conref"><span class="mpre">TagBranch</span></span></a><span class="mpre"> _ _ </span><a name="loc_77_28_77_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_28_77_33&#39;)"><span class="hl_vardecl"><span class="mpre">inner</span></span></a><span class="mpre">) = </span><a href="#loc_77_11_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_11_77_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_75_1_75_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_13&#39;)"><span class="hl_varref"><span class="mpre">universeTree</span></span></a><span class="mpre"> </span><a href="#loc_77_28_77_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_28_77_33&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre">
        </span><a href="#loc_77_9_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_78_11_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = [</span><a href="#loc_78_11_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]


</span><span class="hl_comment"><span class="mpre">-- | This operation is based on the Uniplate @transform@ function. Given a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   list of trees, it applies the function to every tree in a bottom-up</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   manner. This operation is useful for manipulating a tree - for example</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   to make all tag names upper case:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; upperCase = transformTree f</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   where f (TagBranch name atts inner) = [TagBranch (map toUpper name) atts inner]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;         f x = x</span></span><span class="mpre">
</span><a href="#loc_90_1_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_14&#39;)"><span class="mpre">transformTree</span></a><span class="mpre"> :: (</span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">TagTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre"> -&gt; [</span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">TagTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]) -&gt; [</span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">TagTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">] -&gt; [</span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">TagTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">str</span></span><span class="mpre">]
</span><a name="loc_90_1_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_14&#39;)"><span class="hl_fundecl"><span class="mpre">transformTree</span></span></a><span class="mpre"> </span><a name="loc_90_15_90_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_15_90_18&#39;)"><span class="hl_vardecl"><span class="mpre">act</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_92_9_92_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
    where
        </span><a name="loc_92_9_92_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_18_20_18_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_20_18_29&#39;)"><span class="hl_conref"><span class="mpre">TagBranch</span></span></a><span class="mpre"> </span><a name="loc_92_22_92_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_22_92_23&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_92_24_92_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_24_92_25&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_92_26_92_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_26_92_31&#39;)"><span class="hl_vardecl"><span class="mpre">inner</span></span></a><span class="mpre">) = </span><a href="#loc_90_15_90_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_15_90_18&#39;)"><span class="hl_varref"><span class="mpre">act</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_18_20_18_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_20_18_29&#39;)"><span class="hl_conref"><span class="mpre">TagBranch</span></span></a><span class="mpre"> </span><a href="#loc_92_22_92_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_22_92_23&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_92_24_92_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_24_92_25&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (</span><a href="#loc_90_1_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_14&#39;)"><span class="hl_varref"><span class="mpre">transformTree</span></span></a><span class="mpre"> </span><a href="#loc_90_15_90_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_15_90_18&#39;)"><span class="hl_varref"><span class="mpre">act</span></span></a><span class="mpre"> </span><a href="#loc_92_26_92_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_26_92_31&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre">)
        </span><a href="#loc_92_9_92_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_93_11_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_11_93_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_90_15_90_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_15_90_18&#39;)"><span class="hl_varref"><span class="mpre">act</span></span></a><span class="mpre"> </span><a href="#loc_93_11_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_11_93_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span></div></body></html>