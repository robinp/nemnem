<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings, FlexibleInstances, TypeSynonymInstances #-}
{-# OPTIONS_GHC -fno-warn-orphans        #-}
{-# OPTIONS_GHC -fno-warn-unused-do-bind #-}
module Text.Blaze.Tests
    ( tests
    ) where

import Prelude hiding (div, id, null)
import Data.Monoid (</span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="mpre">mempty</span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="mpre">mappend</span></a><span class="mpre">)
import Control.Monad (</span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="mpre">replicateM</span></a><span class="mpre">)
import Control.Applicative (</span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">)
import Data.Word (Word8)
import Data.Char (ord)
import qualified Data.List as List

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-markup-0.6.1.0/tests/Text/Blaze/Tests.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 8, srcSpanEndLine = 16, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Test.Framework&quot;"><span class="mpre">Test.Framework</span></span><span class="mpre"> (Test)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-markup-0.6.1.0/tests/Text/Blaze/Tests.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 8, srcSpanEndLine = 17, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre"> (Assertion, (@=?))
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-markup-0.6.1.0/tests/Text/Blaze/Tests.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 8, srcSpanEndLine = 18, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Test.Framework.Providers.HUnit&quot;"><span class="mpre">Test.Framework.Providers.HUnit</span></span><span class="mpre"> (testCase)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-markup-0.6.1.0/tests/Text/Blaze/Tests.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 8, srcSpanEndLine = 19, srcSpanEndColumn = 44}, srcInfoPoints = []}) &quot;Test.Framework.Providers.QuickCheck2&quot;"><span class="mpre">Test.Framework.Providers.QuickCheck2</span></span><span class="mpre"> (testProperty)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-markup-0.6.1.0/tests/Text/Blaze/Tests.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 8, srcSpanEndLine = 20, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Test.QuickCheck&quot;"><span class="mpre">Test.QuickCheck</span></span><span class="mpre">
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-markup-0.6.1.0/tests/Text/Blaze/Tests.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 18, srcSpanEndLine = 21, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as SB
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-markup-0.6.1.0/tests/Text/Blaze/Tests.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 18, srcSpanEndLine = 22, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as LB
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-markup-0.6.1.0/tests/Text/Blaze/Tests.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 18, srcSpanEndLine = 23, srcSpanEndColumn = 44}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy.Char8&quot;"><span class="mpre">Data.ByteString.Lazy.Char8</span></span><span class="mpre"> as LBC

import Text.Blaze.Internal
import Text.Blaze.Tests.Util

</span><a href="#loc_29_1_29_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_6&#39;)"><span class="mpre">tests</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">]
</span><a name="loc_29_1_29_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = [ </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;left identity Monoid law&quot;</span></span><span class="mpre">  </span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_varref"><span class="mpre">monoidLeftIdentity</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;right identity Monoid law&quot;</span></span><span class="mpre"> </span><a href="#loc_53_1_53_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_20&#39;)"><span class="hl_varref"><span class="mpre">monoidRightIdentity</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;associativity Monoid law&quot;</span></span><span class="mpre">  </span><a href="#loc_58_1_58_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_20&#39;)"><span class="hl_varref"><span class="mpre">monoidAssociativity</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;mconcat Monoid law&quot;</span></span><span class="mpre">        </span><a href="#loc_63_1_63_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_13&#39;)"><span class="hl_varref"><span class="mpre">monoidConcat</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;post escaping characters&quot;</span></span><span class="mpre">  </span><a href="#loc_68_1_68_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_23&#39;)"><span class="hl_varref"><span class="mpre">postEscapingCharacters</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;valid UTF-8&quot;</span></span><span class="mpre">               </span><a href="#loc_76_1_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_12&#39;)"><span class="hl_varref"><span class="mpre">isValidUtf8</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;external &lt;/ sequence&quot;</span></span><span class="mpre">      </span><a href="#loc_107_1_107_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_20&#39;)"><span class="hl_varref"><span class="mpre">externalEndSequence</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;well nested &lt;&gt;&quot;</span></span><span class="mpre">            </span><a href="#loc_113_1_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_19&#39;)"><span class="hl_varref"><span class="mpre">wellNestedBrackets</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unsafeByteString id&quot;</span></span><span class="mpre">       </span><a href="#loc_101_1_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_19&#39;)"><span class="hl_varref"><span class="mpre">unsafeByteStringId</span></span></a><span class="mpre">

        , </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre">     </span><span class="hl_string"><span class="mpre">&quot;conditional attributes&quot;</span></span><span class="mpre">    </span><a href="#loc_122_1_122_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_22&#39;)"><span class="hl_varref"><span class="mpre">conditionalAttributes</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre">     </span><span class="hl_string"><span class="mpre">&quot;contents 1&quot;</span></span><span class="mpre">                </span><a href="#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">contents1</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre">     </span><span class="hl_string"><span class="mpre">&quot;empty 1&quot;</span></span><span class="mpre">                   </span><a href="#loc_139_1_139_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_7&#39;)"><span class="hl_varref"><span class="mpre">empty1</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre">     </span><span class="hl_string"><span class="mpre">&quot;empty 2&quot;</span></span><span class="mpre">                   </span><a href="#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">empty2</span></span></a><span class="mpre">
        ]

</span><span class="hl_comment"><span class="mpre">-- | The left identity Monoid law.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="mpre">monoidLeftIdentity</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_fundecl"><span class="mpre">monoidLeftIdentity</span></span></a><span class="mpre"> </span><a name="loc_48_20_48_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_20_48_21&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_48_20_48_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_20_48_21&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_48_20_48_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_20_48_21&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The right identity Monoid law.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_53_1_53_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_20&#39;)"><span class="mpre">monoidRightIdentity</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_53_1_53_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_20&#39;)"><span class="hl_fundecl"><span class="mpre">monoidRightIdentity</span></span></a><span class="mpre"> </span><a name="loc_53_21_53_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_21_53_22&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = (</span><a href="#loc_53_21_53_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_21_53_22&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_53_21_53_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_21_53_22&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The associativity Monoid law.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_58_1_58_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_20&#39;)"><span class="mpre">monoidAssociativity</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_58_1_58_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_20&#39;)"><span class="hl_fundecl"><span class="mpre">monoidAssociativity</span></span></a><span class="mpre"> </span><a name="loc_58_21_58_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_21_58_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_58_23_58_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_23_58_24&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_58_25_58_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_25_58_26&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = (</span><a href="#loc_58_21_58_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_21_58_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> (</span><a href="#loc_58_23_58_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_23_58_24&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_58_25_58_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_25_58_26&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> ((</span><a href="#loc_58_21_58_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_21_58_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_58_23_58_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_23_58_24&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_58_25_58_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_25_58_26&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Concatenation Monoid law.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_63_1_63_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_13&#39;)"><span class="mpre">monoidConcat</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_63_1_63_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_13&#39;)"><span class="hl_fundecl"><span class="mpre">monoidConcat</span></span></a><span class="mpre"> </span><a name="loc_63_14_63_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_14_63_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_106_1_106_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_106_1_106_10&#39;)"><span class="hl_varref"><span class="mpre">sequence_</span></span></a><span class="mpre"> </span><a href="#loc_63_14_63_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_14_63_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(&gt;&gt;)</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_63_14_63_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_14_63_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Escaped content cannot contain certain characters.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_68_1_68_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_23&#39;)"><span class="mpre">postEscapingCharacters</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_68_1_68_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_23&#39;)"><span class="hl_fundecl"><span class="mpre">postEscapingCharacters</span></span></a><span class="mpre"> </span><a name="loc_68_24_68_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_24_68_27&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">LB.all</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`notElem`</span></span><span class="mpre"> </span><a href="#loc_71_5_71_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_14&#39;)"><span class="hl_varref"><span class="mpre">forbidden</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_36_1_36_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingUtf8</span></span></a><span class="mpre"> (</span><a href="Text.Blaze.Internal.html#loc_290_1_290_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_290_1_290_7&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><a href="#loc_68_24_68_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_24_68_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)
  where
    </span><a name="loc_71_5_71_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_14&#39;)"><span class="hl_vardecl"><span class="mpre">forbidden</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre">) </span><span class="hl_string"><span class="mpre">&quot;\&quot;&#39;&lt;&gt;&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Check if the produced bytes are valid UTF-8</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_76_1_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_12&#39;)"><span class="mpre">isValidUtf8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_76_1_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_12&#39;)"><span class="hl_vardecl"><span class="mpre">isValidUtf8</span></span></a><span class="mpre"> = </span><a href="#loc_80_5_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_17&#39;)"><span class="hl_varref"><span class="mpre">isValidUtf8&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">LB.unpack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_36_1_36_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingUtf8</span></span></a><span class="mpre">
  where
    </span><a name="loc_78_5_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_9&#39;)"><span class="hl_fundecl"><span class="mpre">isIn</span></span></a><span class="mpre"> </span><a name="loc_78_10_78_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_10_78_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_78_12_78_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_12_78_13&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_78_14_78_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_14_78_15&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = (</span><a href="#loc_78_10_78_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_10_78_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_78_14_78_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_14_78_15&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> (</span><a href="#loc_78_14_78_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_14_78_15&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_78_12_78_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_12_78_13&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
    </span><a href="#loc_80_5_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_17&#39;)"><span class="mpre">isValidUtf8&#39;</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    </span><a name="loc_80_5_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_17&#39;)"><span class="hl_fundecl"><span class="mpre">isValidUtf8&#39;</span></span></a><span class="mpre"> [] = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_80_5_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_17&#39;)"><span class="hl_fundecl"><span class="mpre">isValidUtf8&#39;</span></span></a><span class="mpre"> (</span><a name="loc_81_19_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_19_81_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_81_21_81_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_21_81_22&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">)
        </span><span class="hl_comment"><span class="mpre">-- One byte</span></span><span class="mpre">
        | </span><a href="#loc_78_5_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_9&#39;)"><span class="hl_varref"><span class="mpre">isIn</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x00</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7f</span></span><span class="mpre"> </span><a href="#loc_81_19_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_19_81_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_80_5_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_17&#39;)"><span class="hl_varref"><span class="mpre">isValidUtf8&#39;</span></span></a><span class="mpre"> </span><a href="#loc_81_21_81_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_21_81_22&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- Two bytes</span></span><span class="mpre">
        | </span><a href="#loc_78_5_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_9&#39;)"><span class="hl_varref"><span class="mpre">isIn</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xdf</span></span><span class="mpre"> </span><a href="#loc_81_19_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_19_81_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = case </span><a href="#loc_81_21_81_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_21_81_22&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> of
            (</span><a name="loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_86_16_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_16_86_18&#39;)"><span class="hl_vardecl"><span class="mpre">t&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_78_5_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_9&#39;)"><span class="hl_varref"><span class="mpre">isIn</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xbf</span></span><span class="mpre"> </span><a href="#loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_80_5_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_17&#39;)"><span class="hl_varref"><span class="mpre">isValidUtf8&#39;</span></span></a><span class="mpre"> </span><a href="#loc_86_16_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_16_86_18&#39;)"><span class="hl_varref"><span class="mpre">t&#39;</span></span></a><span class="mpre">
            _      -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- Three bytes</span></span><span class="mpre">
        | </span><a href="#loc_78_5_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_9&#39;)"><span class="hl_varref"><span class="mpre">isIn</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xe0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xef</span></span><span class="mpre"> </span><a href="#loc_81_19_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_19_81_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = case </span><a href="#loc_81_21_81_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_21_81_22&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> of
            (</span><a name="loc_90_14_90_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_14_90_15&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_90_16_90_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_16_90_17&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_90_18_90_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_18_90_20&#39;)"><span class="hl_vardecl"><span class="mpre">t&#39;</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> (</span><a href="#loc_78_5_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_9&#39;)"><span class="hl_varref"><span class="mpre">isIn</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xbf</span></span><span class="mpre">) [</span><a href="#loc_90_14_90_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_14_90_15&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">, </span><a href="#loc_90_16_90_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_16_90_17&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_80_5_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_17&#39;)"><span class="hl_varref"><span class="mpre">isValidUtf8&#39;</span></span></a><span class="mpre"> </span><a href="#loc_90_18_90_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_18_90_20&#39;)"><span class="hl_varref"><span class="mpre">t&#39;</span></span></a><span class="mpre">
            _        -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- Four bytes</span></span><span class="mpre">
        | </span><a href="#loc_78_5_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_9&#39;)"><span class="hl_varref"><span class="mpre">isIn</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf7</span></span><span class="mpre"> </span><a href="#loc_81_19_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_19_81_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = case </span><a href="#loc_81_21_81_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_21_81_22&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> of
            (</span><a name="loc_94_14_94_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_14_94_15&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_94_16_94_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_16_94_17&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_94_18_94_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_18_94_19&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_94_20_94_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_20_94_22&#39;)"><span class="hl_vardecl"><span class="mpre">t&#39;</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> (</span><a href="#loc_78_5_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_9&#39;)"><span class="hl_varref"><span class="mpre">isIn</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xbf</span></span><span class="mpre">) [</span><a href="#loc_94_14_94_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_14_94_15&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">, </span><a href="#loc_94_16_94_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_16_94_17&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">, </span><a href="#loc_94_18_94_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_18_94_19&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_80_5_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_17&#39;)"><span class="hl_varref"><span class="mpre">isValidUtf8&#39;</span></span></a><span class="mpre"> </span><a href="#loc_94_20_94_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_20_94_22&#39;)"><span class="hl_varref"><span class="mpre">t&#39;</span></span></a><span class="mpre">
            _          -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Rendering an unsafe bytestring should not do anything</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_101_1_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_19&#39;)"><span class="mpre">unsafeByteStringId</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_101_1_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_19&#39;)"><span class="hl_fundecl"><span class="mpre">unsafeByteStringId</span></span></a><span class="mpre"> </span><a name="loc_101_20_101_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_20_101_22&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">LB.pack</span></span><span class="mpre"> </span><a href="#loc_101_20_101_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_20_101_22&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_36_1_36_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingUtf8</span></span></a><span class="mpre"> (</span><a href="Text.Blaze.Internal.html#loc_309_1_309_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_309_1_309_17&#39;)"><span class="hl_varref"><span class="mpre">unsafeByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">SB.pack</span></span><span class="mpre"> </span><a href="#loc_101_20_101_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_20_101_22&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Check if the &quot;&lt;/&quot; sequence does not appear in @&lt;script&gt;@ or @&lt;style&gt;@ tags.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_107_1_107_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_20&#39;)"><span class="mpre">externalEndSequence</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_107_1_107_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_20&#39;)"><span class="hl_vardecl"><span class="mpre">externalEndSequence</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.List.html#loc_305_1_305_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_305_1_305_10&#39;)"><span class="hl_varref"><span class="mpre">List.isInfixOf</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&lt;/&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">LBC.unpack</span></span><span class="mpre">
                    </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_36_1_36_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingUtf8</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Text.Blaze.Internal.html#loc_444_1_444_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_444_1_444_9&#39;)"><span class="hl_varref"><span class="mpre">external</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Text.Blaze.Internal.html#loc_290_1_290_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_290_1_290_7&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Check that the &quot;&lt;&gt;&quot; characters are well-nested.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_113_1_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_19&#39;)"><span class="mpre">wellNestedBrackets</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_113_1_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_19&#39;)"><span class="hl_vardecl"><span class="mpre">wellNestedBrackets</span></span></a><span class="mpre"> = </span><a href="#loc_115_5_115_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_5_115_15&#39;)"><span class="hl_varref"><span class="mpre">wellNested</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">LBC.unpack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_36_1_36_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingUtf8</span></span></a><span class="mpre">
  where
    </span><a name="loc_115_5_115_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_5_115_15&#39;)"><span class="hl_fundecl"><span class="mpre">wellNested</span></span></a><span class="mpre"> </span><a name="loc_115_16_115_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_22&#39;)"><span class="hl_vardecl"><span class="mpre">isOpen</span></span></a><span class="mpre"> [] = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><a href="#loc_115_16_115_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_22&#39;)"><span class="hl_varref"><span class="mpre">isOpen</span></span></a><span class="mpre">
    </span><a href="#loc_115_5_115_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_5_115_15&#39;)"><span class="hl_fundecl"><span class="mpre">wellNested</span></span></a><span class="mpre"> </span><a name="loc_116_16_116_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_22&#39;)"><span class="hl_vardecl"><span class="mpre">isOpen</span></span></a><span class="mpre"> (</span><a name="loc_116_24_116_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_24_116_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_116_26_116_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_26_116_28&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = case </span><a href="#loc_116_24_116_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_24_116_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
        </span><span class="hl_char"><span class="mpre">&#39;&lt;&#39;</span></span><span class="mpre"> -&gt; if </span><a href="#loc_116_16_116_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_22&#39;)"><span class="hl_varref"><span class="mpre">isOpen</span></span></a><span class="mpre"> then </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> else </span><a href="#loc_115_5_115_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_5_115_15&#39;)"><span class="hl_varref"><span class="mpre">wellNested</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_116_26_116_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_26_116_28&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><span class="hl_char"><span class="mpre">&#39;&gt;&#39;</span></span><span class="mpre"> -&gt; if </span><a href="#loc_116_16_116_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_22&#39;)"><span class="hl_varref"><span class="mpre">isOpen</span></span></a><span class="mpre"> then </span><a href="#loc_115_5_115_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_5_115_15&#39;)"><span class="hl_varref"><span class="mpre">wellNested</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_116_26_116_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_26_116_28&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> else </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
        _   -&gt; </span><a href="#loc_115_5_115_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_5_115_15&#39;)"><span class="hl_varref"><span class="mpre">wellNested</span></span></a><span class="mpre"> </span><a href="#loc_116_16_116_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_16_116_22&#39;)"><span class="hl_varref"><span class="mpre">isOpen</span></span></a><span class="mpre"> </span><a href="#loc_116_26_116_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_26_116_28&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><a href="#loc_122_1_122_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_22&#39;)"><span class="mpre">conditionalAttributes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_122_1_122_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_22&#39;)"><span class="hl_vardecl"><span class="mpre">conditionalAttributes</span></span></a><span class="mpre"> =
    </span><span class="hl_string"><span class="mpre">&quot;&lt;p class=\&quot;foo\&quot;&gt;Hello&lt;/p&gt;&lt;p id=\&quot;2nd\&quot;&gt;World&lt;/p&gt;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">@=?</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_36_1_36_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingUtf8</span></span></a><span class="mpre"> </span><a href="#loc_125_5_125_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_5_125_9&#39;)"><span class="hl_varref"><span class="mpre">html</span></span></a><span class="mpre">
  where
    </span><a name="loc_125_5_125_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_5_125_9&#39;)"><span class="hl_vardecl"><span class="mpre">html</span></span></a><span class="mpre"> = do
        </span><a href="Text.Blaze.Tests.Util.html#loc_42_1_42_2" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_42_1_42_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Text.Blaze.Internal.html#loc_432_1_432_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_432_1_432_5&#39;)"><span class="hl_infix"><span class="mpre">!?</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">], </span><a href="Text.Blaze.Tests.Util.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">class_</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Hello&quot;</span></span><span class="mpre">
        </span><a href="Text.Blaze.Tests.Util.html#loc_42_1_42_2" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_42_1_42_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Text.Blaze.Internal.html#loc_432_1_432_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_432_1_432_5&#39;)"><span class="hl_infix"><span class="mpre">!?</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">], </span><a href="Text.Blaze.Tests.Util.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">class_</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bar&quot;</span></span><span class="mpre">) </span><a href="Text.Blaze.Internal.html#loc_432_1_432_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_432_1_432_5&#39;)"><span class="hl_infix"><span class="mpre">!?</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a href="Text.Blaze.Tests.Util.html#loc_67_1_67_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_67_1_67_3&#39;)"><span class="hl_varref"><span class="mpre">id</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;2nd&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;World&quot;</span></span><span class="mpre">

</span><a href="#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_10&#39;)"><span class="mpre">contents1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_130_1_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_10&#39;)"><span class="hl_vardecl"><span class="mpre">contents1</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;Hello World!&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">@=?</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_36_1_36_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingUtf8</span></span></a><span class="mpre"> (</span><a href="Text.Blaze.Internal.html#loc_464_1_464_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_464_1_464_9&#39;)"><span class="hl_varref"><span class="mpre">contents</span></span></a><span class="mpre"> </span><a href="#loc_133_5_133_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_5_133_9&#39;)"><span class="hl_varref"><span class="mpre">html</span></span></a><span class="mpre">)
  where
    </span><a href="#loc_133_5_133_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_5_133_9&#39;)"><span class="mpre">html</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre">
    </span><a name="loc_133_5_133_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_5_133_9&#39;)"><span class="hl_vardecl"><span class="mpre">html</span></span></a><span class="mpre"> = </span><a href="Text.Blaze.Tests.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_46_1_46_4&#39;)"><span class="hl_varref"><span class="mpre">div</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a href="Text.Blaze.Tests.Util.html#loc_42_1_42_2" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_42_1_42_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Text.Blaze.Internal.html#loc_411_5_411_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_411_5_411_8&#39;)"><span class="hl_infix"><span class="mpre">!</span></span></a><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_67_1_67_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_67_1_67_3&#39;)"><span class="hl_varref"><span class="mpre">id</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;para&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Hello &quot;</span></span><span class="mpre">
        </span><a href="Text.Blaze.Tests.Util.html#loc_53_1_53_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_53_1_53_4&#39;)"><span class="hl_varref"><span class="mpre">img</span></span></a><span class="mpre"> </span><a href="Text.Blaze.Internal.html#loc_411_5_411_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_411_5_411_8&#39;)"><span class="hl_infix"><span class="mpre">!</span></span></a><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_71_1_71_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_71_1_71_5&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;An image&quot;</span></span><span class="mpre">
        </span><a href="Text.Blaze.Tests.Util.html#loc_42_1_42_2" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_42_1_42_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;World!&quot;</span></span><span class="mpre">

</span><a href="#loc_139_1_139_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_7&#39;)"><span class="mpre">empty1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_139_1_139_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_7&#39;)"><span class="hl_vardecl"><span class="mpre">empty1</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">@=?</span></span><span class="mpre"> </span><a href="Text.Blaze.Internal.html#loc_475_1_475_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_475_1_475_5&#39;)"><span class="hl_varref"><span class="mpre">null</span></span></a><span class="mpre"> </span><a href="#loc_142_5_142_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_5_142_9&#39;)"><span class="hl_varref"><span class="mpre">html</span></span></a><span class="mpre">
  where
    </span><a href="#loc_142_5_142_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_5_142_9&#39;)"><span class="mpre">html</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre">
    </span><a name="loc_142_5_142_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_5_142_9&#39;)"><span class="hl_vardecl"><span class="mpre">html</span></span></a><span class="mpre"> = do
        </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
        </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">

</span><a href="#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_7&#39;)"><span class="mpre">empty2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_148_1_148_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_7&#39;)"><span class="hl_vardecl"><span class="mpre">empty2</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">@=?</span></span><span class="mpre"> </span><a href="Text.Blaze.Internal.html#loc_475_1_475_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_475_1_475_5&#39;)"><span class="hl_varref"><span class="mpre">null</span></span></a><span class="mpre"> </span><a href="#loc_151_5_151_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_5_151_9&#39;)"><span class="hl_varref"><span class="mpre">html</span></span></a><span class="mpre">
  where
    </span><a href="#loc_151_5_151_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_5_151_9&#39;)"><span class="mpre">html</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre">
    </span><a name="loc_151_5_151_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_5_151_9&#39;)"><span class="hl_vardecl"><span class="mpre">html</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_42_1_42_2" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_42_1_42_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;a&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Show instance for the HTML type, so we can debug.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre"> where
    </span><span class="hl_vardecl"><span class="mpre">show</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_36_1_36_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingUtf8</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Eq instance for the HTML type, so we can compare the results.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Eq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre"> where
    </span><a name="loc_161_5_161_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_5_161_6&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">==</span></span><span class="mpre"> </span><a name="loc_161_10_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_10_161_11&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> =  </span><a href="Text.Blaze.Tests.Util.html#loc_26_1_26_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_26_1_26_18&#39;)"><span class="hl_varref"><span class="mpre">renderUsingString</span></span></a><span class="mpre"> </span><a href="#loc_161_5_161_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_5_161_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_26_1_26_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_26_1_26_18&#39;)"><span class="hl_varref"><span class="mpre">renderUsingString</span></span></a><span class="mpre"> </span><a href="#loc_161_10_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_10_161_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
           </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_31_1_31_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_31_1_31_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingText</span></span></a><span class="mpre"> </span><a href="#loc_161_5_161_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_5_161_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">   </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_31_1_31_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_31_1_31_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingText</span></span></a><span class="mpre"> </span><a href="#loc_161_10_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_10_161_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
           </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_36_1_36_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingUtf8</span></span></a><span class="mpre"> </span><a href="#loc_161_5_161_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_5_161_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">   </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_36_1_36_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingUtf8</span></span></a><span class="mpre"> </span><a href="#loc_161_10_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_10_161_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
           </span><span class="hl_comment"><span class="mpre">-- Some cross-checks</span></span><span class="mpre">
           </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_26_1_26_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_26_1_26_18&#39;)"><span class="hl_varref"><span class="mpre">renderUsingString</span></span></a><span class="mpre"> </span><a href="#loc_161_5_161_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_5_161_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_31_1_31_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_31_1_31_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingText</span></span></a><span class="mpre"> </span><a href="#loc_161_10_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_10_161_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
           </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_31_1_31_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_31_1_31_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingText</span></span></a><span class="mpre"> </span><a href="#loc_161_5_161_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_5_161_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">   </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Text.Blaze.Tests.Util.html#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_36_1_36_16&#39;)"><span class="hl_varref"><span class="mpre">renderUsingUtf8</span></span></a><span class="mpre"> </span><a href="#loc_161_10_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_10_161_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Arbitrary instance for the HTML type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Arbitrary</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre"> where
    </span><span class="hl_vardecl"><span class="mpre">arbitrary</span></span><span class="mpre"> = </span><a href="#loc_178_1_178_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_16&#39;)"><span class="hl_varref"><span class="mpre">arbitraryMarkup</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Auxiliary function for the arbitrary instance of the HTML type, used</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to limit the depth and size of the type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_178_1_178_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_16&#39;)"><span class="mpre">arbitraryMarkup</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ Maximum depth.</span></span><span class="mpre">
              -&gt; </span><span class="hl_tyconref"><span class="mpre">Gen</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Markup</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Resulting arbitrary HTML snippet.</span></span><span class="mpre">
</span><a name="loc_178_1_178_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_16&#39;)"><span class="hl_fundecl"><span class="mpre">arbitraryMarkup</span></span></a><span class="mpre"> </span><a name="loc_178_17_178_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_17_178_22&#39;)"><span class="hl_vardecl"><span class="mpre">depth</span></span></a><span class="mpre"> = do
    </span><span class="hl_comment"><span class="mpre">-- Choose the size (width) of this element.</span></span><span class="mpre">
    </span><a name="loc_180_5_180_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_5_180_9&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)

    </span><span class="hl_comment"><span class="mpre">-- Generate `size` new HTML snippets.</span></span><span class="mpre">
    </span><a name="loc_183_5_183_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_5_183_13&#39;)"><span class="hl_vardecl"><span class="mpre">children</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><a href="#loc_180_5_180_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_5_180_9&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><a href="#loc_190_5_190_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_19&#39;)"><span class="hl_varref"><span class="mpre">arbitraryChild</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- Return a concatenation of these children.</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_106_1_106_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_106_1_106_10&#39;)"><span class="hl_varref"><span class="mpre">sequence_</span></span></a><span class="mpre"> </span><a href="#loc_183_5_183_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_5_183_13&#39;)"><span class="hl_varref"><span class="mpre">children</span></span></a><span class="mpre">
  where
    </span><span class="hl_comment"><span class="mpre">-- Generate an arbitrary child. Do not take a parent when we have no depth</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- left, obviously.</span></span><span class="mpre">
    </span><a name="loc_190_5_190_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_19&#39;)"><span class="hl_vardecl"><span class="mpre">arbitraryChild</span></span></a><span class="mpre"> = do
        </span><a name="loc_191_9_191_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_9_191_14&#39;)"><span class="hl_vardecl"><span class="mpre">child</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">oneof</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">  [</span><a href="#loc_205_5_205_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_5_205_18&#39;)"><span class="hl_varref"><span class="mpre">arbitraryLeaf</span></span></a><span class="mpre">, </span><a href="#loc_208_5_208_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_5_208_20&#39;)"><span class="hl_varref"><span class="mpre">arbitraryString</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">]
                       </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_200_5_200_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_5_200_20&#39;)"><span class="hl_varref"><span class="mpre">arbitraryParent</span></span></a><span class="mpre"> | </span><a href="#loc_178_17_178_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_17_178_22&#39;)"><span class="hl_varref"><span class="mpre">depth</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">]

        </span><span class="hl_comment"><span class="mpre">-- Generate some attributes for the child.</span></span><span class="mpre">
        </span><a name="loc_195_9_195_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_13&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
        </span><a name="loc_196_9_196_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_9_196_19&#39;)"><span class="hl_vardecl"><span class="mpre">attributes</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><a href="#loc_195_9_195_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_13&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><a href="#loc_213_5_213_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_5_213_23&#39;)"><span class="hl_varref"><span class="mpre">arbitraryAttribute</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> </span><a href="Text.Blaze.Internal.html#loc_411_5_411_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_411_5_411_8&#39;)"><span class="hl_varref"><span class="mpre">(!)</span></span></a><span class="mpre"> </span><a href="#loc_191_9_191_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_9_191_14&#39;)"><span class="hl_varref"><span class="mpre">child</span></span></a><span class="mpre"> </span><a href="#loc_196_9_196_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_9_196_19&#39;)"><span class="hl_varref"><span class="mpre">attributes</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- Generate an arbitrary parent element.</span></span><span class="mpre">
    </span><a name="loc_200_5_200_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_5_200_20&#39;)"><span class="hl_vardecl"><span class="mpre">arbitraryParent</span></span></a><span class="mpre"> = do
        </span><a name="loc_201_9_201_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_15&#39;)"><span class="hl_vardecl"><span class="mpre">parent</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">elements</span></span><span class="mpre"> [</span><a href="Text.Blaze.Tests.Util.html#loc_42_1_42_2" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_42_1_42_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><a href="Text.Blaze.Tests.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_46_1_46_4&#39;)"><span class="hl_varref"><span class="mpre">div</span></span></a><span class="mpre">, </span><a href="Text.Blaze.Tests.Util.html#loc_50_1_50_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_50_1_50_6&#39;)"><span class="hl_varref"><span class="mpre">table</span></span></a><span class="mpre">]
        </span><a href="#loc_201_9_201_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_15&#39;)"><span class="hl_varref"><span class="mpre">parent</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_178_1_178_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_16&#39;)"><span class="hl_varref"><span class="mpre">arbitraryMarkup</span></span></a><span class="mpre"> (</span><a href="#loc_178_17_178_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_17_178_22&#39;)"><span class="hl_varref"><span class="mpre">depth</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

    </span><span class="hl_comment"><span class="mpre">-- Generate an arbitrary leaf element.</span></span><span class="mpre">
    </span><a name="loc_205_5_205_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_5_205_18&#39;)"><span class="hl_vardecl"><span class="mpre">arbitraryLeaf</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">oneof</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="Text.Blaze.Tests.Util.html#loc_53_1_53_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_53_1_53_4&#39;)"><span class="hl_varref"><span class="mpre">img</span></span></a><span class="mpre">, </span><a href="Text.Blaze.Tests.Util.html#loc_56_1_56_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_56_1_56_3&#39;)"><span class="hl_varref"><span class="mpre">br</span></span></a><span class="mpre">, </span><a href="Text.Blaze.Tests.Util.html#loc_59_1_59_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_59_1_59_5&#39;)"><span class="hl_varref"><span class="mpre">area</span></span></a><span class="mpre">]

    </span><span class="hl_comment"><span class="mpre">-- Generate arbitrary string element.</span></span><span class="mpre">
    </span><a name="loc_208_5_208_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_5_208_20&#39;)"><span class="hl_vardecl"><span class="mpre">arbitraryString</span></span></a><span class="mpre"> = do
        </span><a name="loc_209_9_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_9_209_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.Blaze.Internal.html#loc_290_1_290_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_290_1_290_7&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><a href="#loc_209_9_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_9_209_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- Generate an arbitrary HTML attribute.</span></span><span class="mpre">
    </span><a name="loc_213_5_213_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_5_213_23&#39;)"><span class="hl_vardecl"><span class="mpre">arbitraryAttribute</span></span></a><span class="mpre"> = do
        </span><a name="loc_214_9_214_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_9_214_13&#39;)"><span class="hl_vardecl"><span class="mpre">attr</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">elements</span></span><span class="mpre"> [</span><a href="Text.Blaze.Tests.Util.html#loc_67_1_67_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_67_1_67_3&#39;)"><span class="hl_varref"><span class="mpre">id</span></span></a><span class="mpre">, </span><a href="Text.Blaze.Tests.Util.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">class_</span></span></a><span class="mpre">, </span><a href="Text.Blaze.Tests.Util.html#loc_71_1_71_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Tests.Util.html#loc_71_1_71_5&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">]
        </span><a name="loc_215_9_215_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_9_215_14&#39;)"><span class="hl_vardecl"><span class="mpre">value</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_214_9_214_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_9_214_13&#39;)"><span class="hl_varref"><span class="mpre">attr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.Blaze.Internal.html#loc_363_1_363_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Blaze.Internal.html#loc_363_1_363_12&#39;)"><span class="hl_varref"><span class="mpre">stringValue</span></span></a><span class="mpre"> </span><a href="#loc_215_9_215_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_9_215_14&#39;)"><span class="hl_varref"><span class="mpre">value</span></span></a><span class="mpre">
</span></div></body></html>