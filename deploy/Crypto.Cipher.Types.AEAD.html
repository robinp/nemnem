<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Cipher.Types.AEAD</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : Stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Excellent</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- AEAD cipher basic types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Crypto.Cipher.Types.AEAD where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/AEAD.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 8, srcSpanEndLine = 12, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/AEAD.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 18, srcSpanEndLine = 13, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Data.Byteable
import Crypto.Cipher.Types.Base
import Crypto.Cipher.Types.Block

</span><span class="hl_comment"><span class="mpre">-- | Append associated data into the AEAD state</span></span><span class="mpre">
</span><a href="#loc_20_1_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_17&#39;)"><span class="mpre">aeadAppendHeader</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/AEAD.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 21, srcSpanEndLine = 19, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/AEAD.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 35, srcSpanEndLine = 19, srcSpanEndColumn = 37}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/hom"><span class="mpre">BlockCipher a =&gt;</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Block.html#loc_128_6_128_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_6_128_10&#39;)"><span class="hl_tyconref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Block.html#loc_128_6_128_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_6_128_10&#39;)"><span class="hl_tyconref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_20_1_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_17&#39;)"><span class="hl_fundecl"><span class="mpre">aeadAppendHeader</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Block.html#loc_128_20_128_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_20_128_24&#39;)"><span class="hl_conref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><a name="loc_20_24_20_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_24_20_30&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Block.html#loc_131_63_131_72" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_131_63_131_72&#39;)"><span class="hl_conref"><span class="mpre">AEADState</span></span></a><span class="mpre"> </span><a name="loc_20_42_20_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_42_20_47&#39;)"><span class="hl_vardecl"><span class="mpre">state</span></span></a><span class="mpre">)) </span><a name="loc_20_50_20_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_50_20_52&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
    </span><a href="Crypto.Cipher.Types.Block.html#loc_128_20_128_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_20_128_24&#39;)"><span class="hl_conref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><a href="#loc_20_24_20_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_24_20_30&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Block.html#loc_131_63_131_72" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_131_63_131_72&#39;)"><span class="hl_conref"><span class="mpre">AEADState</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Block.html#loc_135_5_135_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_135_5_135_26&#39;)"><span class="hl_varref"><span class="mpre">aeadStateAppendHeader</span></span></a><span class="mpre"> </span><a href="#loc_20_24_20_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_24_20_30&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a href="#loc_20_42_20_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_42_20_47&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><a href="#loc_20_50_20_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_50_20_52&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Encrypt input and append into the AEAD state</span></span><span class="mpre">
</span><a href="#loc_25_1_25_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_12&#39;)"><span class="mpre">aeadEncrypt</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/AEAD.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 16, srcSpanEndLine = 24, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/AEAD.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 30, srcSpanEndLine = 24, srcSpanEndColumn = 32}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/hom"><span class="mpre">BlockCipher a =&gt;</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Block.html#loc_128_6_128_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_6_128_10&#39;)"><span class="hl_tyconref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><a href="Crypto.Cipher.Types.Block.html#loc_128_6_128_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_6_128_10&#39;)"><span class="hl_tyconref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_25_1_25_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_12&#39;)"><span class="hl_fundecl"><span class="mpre">aeadEncrypt</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Block.html#loc_128_20_128_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_20_128_24&#39;)"><span class="hl_conref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><a name="loc_25_19_25_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_19_25_25&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Block.html#loc_131_63_131_72" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_131_63_131_72&#39;)"><span class="hl_conref"><span class="mpre">AEADState</span></span></a><span class="mpre"> </span><a name="loc_25_37_25_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_37_25_42&#39;)"><span class="hl_vardecl"><span class="mpre">state</span></span></a><span class="mpre">)) </span><a name="loc_25_45_25_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_45_25_50&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = (</span><a href="#loc_26_10_26_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_10_26_16&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">, </span><a href="Crypto.Cipher.Types.Block.html#loc_128_20_128_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_20_128_24&#39;)"><span class="hl_conref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><a href="#loc_25_19_25_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_19_25_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Block.html#loc_131_63_131_72" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_131_63_131_72&#39;)"><span class="hl_conref"><span class="mpre">AEADState</span></span></a><span class="mpre"> </span><a href="#loc_26_18_26_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_21&#39;)"><span class="hl_varref"><span class="mpre">nst</span></span></a><span class="mpre">))
  where (</span><a name="loc_26_10_26_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_10_26_16&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre">, </span><a name="loc_26_18_26_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_21&#39;)"><span class="hl_vardecl"><span class="mpre">nst</span></span></a><span class="mpre">) = </span><a href="Crypto.Cipher.Types.Block.html#loc_136_5_136_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_136_5_136_21&#39;)"><span class="hl_varref"><span class="mpre">aeadStateEncrypt</span></span></a><span class="mpre"> </span><a href="#loc_25_19_25_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_19_25_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a href="#loc_25_37_25_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_37_25_42&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><a href="#loc_25_45_25_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_45_25_50&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Decrypt input and append into the AEAD state</span></span><span class="mpre">
</span><a href="#loc_30_1_30_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_12&#39;)"><span class="mpre">aeadDecrypt</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/AEAD.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 16, srcSpanEndLine = 29, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/AEAD.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 30, srcSpanEndLine = 29, srcSpanEndColumn = 32}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/hom"><span class="mpre">BlockCipher a =&gt;</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Block.html#loc_128_6_128_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_6_128_10&#39;)"><span class="hl_tyconref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><a href="Crypto.Cipher.Types.Block.html#loc_128_6_128_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_6_128_10&#39;)"><span class="hl_tyconref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_30_1_30_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_12&#39;)"><span class="hl_fundecl"><span class="mpre">aeadDecrypt</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Block.html#loc_128_20_128_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_20_128_24&#39;)"><span class="hl_conref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><a name="loc_30_19_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_19_30_25&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Block.html#loc_131_63_131_72" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_131_63_131_72&#39;)"><span class="hl_conref"><span class="mpre">AEADState</span></span></a><span class="mpre"> </span><a name="loc_30_37_30_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_37_30_42&#39;)"><span class="hl_vardecl"><span class="mpre">state</span></span></a><span class="mpre">)) </span><a name="loc_30_45_30_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_45_30_50&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = (</span><a href="#loc_31_10_31_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_10_31_16&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">, </span><a href="Crypto.Cipher.Types.Block.html#loc_128_20_128_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_20_128_24&#39;)"><span class="hl_conref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><a href="#loc_30_19_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_19_30_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Block.html#loc_131_63_131_72" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_131_63_131_72&#39;)"><span class="hl_conref"><span class="mpre">AEADState</span></span></a><span class="mpre"> </span><a href="#loc_31_18_31_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_18_31_21&#39;)"><span class="hl_varref"><span class="mpre">nst</span></span></a><span class="mpre">))
  where (</span><a name="loc_31_10_31_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_10_31_16&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre">, </span><a name="loc_31_18_31_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_18_31_21&#39;)"><span class="hl_vardecl"><span class="mpre">nst</span></span></a><span class="mpre">) = </span><a href="Crypto.Cipher.Types.Block.html#loc_137_5_137_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_137_5_137_21&#39;)"><span class="hl_varref"><span class="mpre">aeadStateDecrypt</span></span></a><span class="mpre"> </span><a href="#loc_30_19_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_19_30_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a href="#loc_30_37_30_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_37_30_42&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><a href="#loc_30_45_30_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_45_30_50&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Finalize the AEAD state and create an authentification tag</span></span><span class="mpre">
</span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="mpre">aeadFinalize</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/AEAD.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 17, srcSpanEndLine = 34, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/AEAD.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 31, srcSpanEndLine = 34, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/hom"><span class="mpre">BlockCipher a =&gt;</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Block.html#loc_128_6_128_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_6_128_10&#39;)"><span class="hl_tyconref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_58_9_58_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_58_9_58_16&#39;)"><span class="hl_tyconref"><span class="mpre">AuthTag</span></span></a><span class="mpre">
</span><a name="loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_fundecl"><span class="mpre">aeadFinalize</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Block.html#loc_128_20_128_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_20_128_24&#39;)"><span class="hl_conref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><a name="loc_35_20_35_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_20_35_26&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Block.html#loc_131_63_131_72" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_131_63_131_72&#39;)"><span class="hl_conref"><span class="mpre">AEADState</span></span></a><span class="mpre"> </span><a name="loc_35_38_35_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_38_35_43&#39;)"><span class="hl_vardecl"><span class="mpre">state</span></span></a><span class="mpre">)) </span><a name="loc_35_46_35_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_46_35_49&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> =
    </span><a href="Crypto.Cipher.Types.Block.html#loc_138_5_138_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_138_5_138_22&#39;)"><span class="hl_varref"><span class="mpre">aeadStateFinalize</span></span></a><span class="mpre"> </span><a href="#loc_35_20_35_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_20_35_26&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a href="#loc_35_38_35_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_38_35_43&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><a href="#loc_35_46_35_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_46_35_49&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Simple AEAD encryption</span></span><span class="mpre">
</span><a href="#loc_45_1_45_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_18&#39;)"><span class="mpre">aeadSimpleEncrypt</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/AEAD.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 22, srcSpanEndLine = 40, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/AEAD.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 19, srcSpanEndLine = 40, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/hom"><span class="mpre">BlockCipher a
                  =&gt;</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Block.html#loc_128_6_128_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_6_128_10&#39;)"><span class="hl_tyconref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- ^ A new AEAD Context</span></span><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Optional Authentified Header</span></span><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Optional Plaintext</span></span><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ Tag length</span></span><span class="mpre">
                  -&gt; (</span><a href="Crypto.Cipher.Types.Base.html#loc_58_9_58_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_58_9_58_16&#39;)"><span class="hl_tyconref"><span class="mpre">AuthTag</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ Authentification tag and ciphertext</span></span><span class="mpre">
</span><a name="loc_45_1_45_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_18&#39;)"><span class="hl_fundecl"><span class="mpre">aeadSimpleEncrypt</span></span></a><span class="mpre"> </span><a name="loc_45_19_45_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_19_45_26&#39;)"><span class="hl_vardecl"><span class="mpre">aeadIni</span></span></a><span class="mpre"> </span><a name="loc_45_27_45_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_27_45_33&#39;)"><span class="hl_vardecl"><span class="mpre">header</span></span></a><span class="mpre"> </span><a name="loc_45_34_45_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_34_45_39&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> </span><a name="loc_45_40_45_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_40_45_46&#39;)"><span class="hl_vardecl"><span class="mpre">taglen</span></span></a><span class="mpre"> = (</span><a href="#loc_48_9_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_12&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre">, </span><a href="#loc_47_10_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_10_47_16&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">)
  where </span><a name="loc_46_9_46_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_13&#39;)"><span class="hl_vardecl"><span class="mpre">aead</span></span></a><span class="mpre">                = </span><a href="#loc_20_1_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_17&#39;)"><span class="hl_varref"><span class="mpre">aeadAppendHeader</span></span></a><span class="mpre"> </span><a href="#loc_45_19_45_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_19_45_26&#39;)"><span class="hl_varref"><span class="mpre">aeadIni</span></span></a><span class="mpre"> </span><a href="#loc_45_27_45_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_27_45_33&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="mpre">
        (</span><a name="loc_47_10_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_10_47_16&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre">, </span><a name="loc_47_18_47_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_18_47_27&#39;)"><span class="hl_vardecl"><span class="mpre">aeadFinal</span></span></a><span class="mpre">) = </span><a href="#loc_25_1_25_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_12&#39;)"><span class="hl_varref"><span class="mpre">aeadEncrypt</span></span></a><span class="mpre"> </span><a href="#loc_46_9_46_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_13&#39;)"><span class="hl_varref"><span class="mpre">aead</span></span></a><span class="mpre"> </span><a href="#loc_45_34_45_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_34_45_39&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
        </span><a name="loc_48_9_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_12&#39;)"><span class="hl_vardecl"><span class="mpre">tag</span></span></a><span class="mpre">                 = </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">aeadFinalize</span></span></a><span class="mpre"> </span><a href="#loc_47_18_47_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_18_47_27&#39;)"><span class="hl_varref"><span class="mpre">aeadFinal</span></span></a><span class="mpre"> </span><a href="#loc_45_40_45_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_40_45_46&#39;)"><span class="hl_varref"><span class="mpre">taglen</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Simple AEAD decryption</span></span><span class="mpre">
</span><a href="#loc_57_1_57_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_18&#39;)"><span class="mpre">aeadSimpleDecrypt</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/AEAD.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 22, srcSpanEndLine = 52, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/AEAD.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 19, srcSpanEndLine = 52, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/hom"><span class="mpre">BlockCipher a
                  =&gt;</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Block.html#loc_128_6_128_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_128_6_128_10&#39;)"><span class="hl_tyconref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- ^ A new AEAD Context</span></span><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Optional Authentified Header</span></span><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Optional Plaintext</span></span><span class="mpre">
                  -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_58_9_58_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_58_9_58_16&#39;)"><span class="hl_tyconref"><span class="mpre">AuthTag</span></span></a><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ Tag length</span></span><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Plaintext</span></span><span class="mpre">
</span><a name="loc_57_1_57_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_18&#39;)"><span class="hl_fundecl"><span class="mpre">aeadSimpleDecrypt</span></span></a><span class="mpre"> </span><a name="loc_57_19_57_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_19_57_26&#39;)"><span class="hl_vardecl"><span class="mpre">aeadIni</span></span></a><span class="mpre"> </span><a name="loc_57_27_57_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_27_57_33&#39;)"><span class="hl_vardecl"><span class="mpre">header</span></span></a><span class="mpre"> </span><a name="loc_57_34_57_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_34_57_39&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> </span><a name="loc_57_40_57_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_40_57_47&#39;)"><span class="hl_vardecl"><span class="mpre">authTag</span></span></a><span class="mpre">
    | </span><a href="#loc_62_9_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_12&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_57_40_57_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_40_57_47&#39;)"><span class="hl_varref"><span class="mpre">authTag</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_61_10_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_10_61_16&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">      = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
  where </span><a name="loc_60_9_60_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_9_60_13&#39;)"><span class="hl_vardecl"><span class="mpre">aead</span></span></a><span class="mpre">                = </span><a href="#loc_20_1_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_17&#39;)"><span class="hl_varref"><span class="mpre">aeadAppendHeader</span></span></a><span class="mpre"> </span><a href="#loc_57_19_57_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_19_57_26&#39;)"><span class="hl_varref"><span class="mpre">aeadIni</span></span></a><span class="mpre"> </span><a href="#loc_57_27_57_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_27_57_33&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="mpre">
        (</span><a name="loc_61_10_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_10_61_16&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre">, </span><a name="loc_61_18_61_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_18_61_27&#39;)"><span class="hl_vardecl"><span class="mpre">aeadFinal</span></span></a><span class="mpre">) = </span><a href="#loc_30_1_30_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_12&#39;)"><span class="hl_varref"><span class="mpre">aeadDecrypt</span></span></a><span class="mpre"> </span><a href="#loc_60_9_60_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_9_60_13&#39;)"><span class="hl_varref"><span class="mpre">aead</span></span></a><span class="mpre"> </span><a href="#loc_57_34_57_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_34_57_39&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
        </span><a name="loc_62_9_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_12&#39;)"><span class="hl_vardecl"><span class="mpre">tag</span></span></a><span class="mpre">                 = </span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_varref"><span class="mpre">aeadFinalize</span></span></a><span class="mpre"> </span><a href="#loc_61_18_61_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_18_61_27&#39;)"><span class="hl_varref"><span class="mpre">aeadFinal</span></span></a><span class="mpre"> (</span><a href="Data.Byteable.html#loc_27_5_27_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_27_5_27_19&#39;)"><span class="hl_varref"><span class="mpre">byteableLength</span></span></a><span class="mpre"> </span><a href="#loc_57_40_57_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_40_57_47&#39;)"><span class="hl_varref"><span class="mpre">authTag</span></span></a><span class="mpre">)

</span></div></body></html>