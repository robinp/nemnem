<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
{-# LANGUAGE GADTs #-}
{-# LANGUAGE Rank2Types #-}
{-# LANGUAGE FlexibleInstances #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE UndecidableInstances #-}
{-# LANGUAGE MultiParamTypeClasses #-}
#ifdef TRUSTWORTHY
{-# LANGUAGE Trustworthy #-}
#endif
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Control.Lens.Internal.Level</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (C) 2012-2014 Edward Kmett</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Edward Kmett &lt;ekmett@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module provides implementation details of the combinators in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;Control.Lens.Level&quot;, which provides for the breadth-first &#39;Control.Lens.Traversal.Traversal&#39; of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- an arbitrary &#39;Control.Lens.Traversal.Traversal&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------------</span></span><span class="mpre">
module Control.Lens.Internal.Level
  (
  </span><span class="hl_comment"><span class="mpre">-- * Levels</span></span><span class="mpre">
    Level(..)
  , Deepening(..), deepening
  , Flows(..)
  ) where

import Control.Applicative
import Control.Category
import Control.Comonad
import Data.Foldable
import Data.Functor.Apply
import Data.Int
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Internal/Level.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 8, srcSpanEndLine = 38, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Data.Semigroup&quot;"><span class="mpre">Data.Semigroup</span></span><span class="mpre">
import Data.Traversable
import Data.Word
import Prelude hiding ((.),id)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Levels</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This data type represents a path-compressed copy of one level of a source</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- data structure. We can safely use path-compression because we know the depth</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of the tree.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Path compression is performed by viewing a &#39;Level&#39; as a PATRICIA trie of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- paths into the structure to leaves at a given depth, similar in many ways</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to a &#39;Data.IntMap.IntMap&#39;, but unlike a regular PATRICIA trie we do not need</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to store the mask bits merely the depth of the fork.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- One invariant of this structure is that underneath a &#39;Two&#39; node you will not</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- find any &#39;Zero&#39; nodes, so &#39;Zero&#39; can only occur at the root.</span></span><span class="mpre">
data </span><a name="loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tycondecl"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
  = </span><a name="loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_condecl"><span class="mpre">Two</span></span></a><span class="mpre"> {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Word</span></span><span class="mpre"> !(</span><a href="#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) !(</span><a href="#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
  | </span><a name="loc_60_5_60_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_8&#39;)"><span class="hl_condecl"><span class="mpre">One</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
  | </span><a name="loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_condecl"><span class="mpre">Zero</span></span></a><span class="mpre">
  </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Internal/Level.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 3, srcSpanEndLine = 62, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Internal/Level.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 3, srcSpanEndLine = 62, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Internal/Leve"><span class="mpre">deriving (Eq,Ord,Show,Read)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Append a pair of &#39;Level&#39; values to get a new &#39;Level&#39; with path compression.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- As the &#39;Level&#39; type is user-visible, we do not expose this as an illegal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Semigroup&#39; instance, and just use it directly in &#39;Deepening&#39; as needed.</span></span><span class="mpre">
</span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="mpre">lappend</span></a><span class="mpre"> :: </span><a href="#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_fundecl"><span class="mpre">lappend</span></span></a><span class="mpre"> </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre">        </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre">        = </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre">
</span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_fundecl"><span class="mpre">lappend</span></span></a><span class="mpre"> </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre">        </span><a name="loc_70_21_70_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_21_70_22&#39;)"><span class="hl_specname"><span class="mpre">r</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Internal/Level.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 23, srcSpanEndLine = 70, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Internal/Level.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 26, srcSpanEndLine = 70, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Internal/Level."><span class="mpre">One{}</span></span><span class="mpre">     = </span><a href="#loc_70_21_70_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_21_70_22&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_fundecl"><span class="mpre">lappend</span></span></a><span class="mpre"> </span><a name="loc_71_9_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_10&#39;)"><span class="hl_specname"><span class="mpre">l</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Internal/Level.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 11, srcSpanEndLine = 71, srcSpanEndColumn = 16}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Internal/Level.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 14, srcSpanEndLine = 71, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Internal/Level."><span class="mpre">One{}</span></span><span class="mpre">     </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre">        = </span><a href="#loc_71_9_71_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
</span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_fundecl"><span class="mpre">lappend</span></span></a><span class="mpre"> </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre">        (</span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> </span><a name="loc_72_26_72_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_26_72_27&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_72_28_72_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_28_72_29&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_72_30_72_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_30_72_31&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> (</span><a href="#loc_72_26_72_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_26_72_27&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_72_28_72_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_28_72_29&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_72_30_72_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_30_72_31&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_fundecl"><span class="mpre">lappend</span></span></a><span class="mpre"> (</span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> </span><a name="loc_73_14_73_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_14_73_15&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_73_16_73_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_16_73_17&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_73_18_73_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_18_73_19&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre">        = </span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> (</span><a href="#loc_73_14_73_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_14_73_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_73_16_73_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_16_73_17&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_73_18_73_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_18_73_19&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_fundecl"><span class="mpre">lappend</span></span></a><span class="mpre"> </span><a name="loc_74_9_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_10&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">           </span><a name="loc_74_21_74_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_21_74_22&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">           = </span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_74_9_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_74_21_74_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_21_74_22&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="mpre">lappend</span></a><span class="mpre"> #-}</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> (</span><a href="#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre">) where
  </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_78_8_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_8_78_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_79_5_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_5_79_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> where
    </span><a name="loc_79_5_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_5_79_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> </span><a name="loc_79_13_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_79_15_79_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_15_79_16&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_79_17_79_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_17_79_18&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> </span><a href="#loc_79_13_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a href="#loc_79_5_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_5_79_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_79_15_79_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_15_79_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) (</span><a href="#loc_79_5_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_5_79_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_79_17_79_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_17_79_18&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
    </span><a href="#loc_79_5_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_5_79_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_60_5_60_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_8&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a name="loc_80_13_80_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_13_80_14&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_80_15_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_15_80_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">)   = </span><a href="#loc_60_5_60_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_8&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a href="#loc_80_13_80_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_13_80_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="#loc_78_8_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_8_78_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_80_15_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_15_80_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
    </span><a href="#loc_79_5_79_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_5_79_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre">        = </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre">
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE fmap #-}</span></span><span class="mpre">

instance </span><a href="Data.Foldable.html#loc_97_7_97_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Foldable.html#loc_97_7_97_15&#39;)"><span class="hl_classref"><span class="mpre">Foldable</span></span></a><span class="mpre"> (</span><a href="#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre">) where
  </span><a href="Data.Foldable.html#loc_104_5_104_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Foldable.html#loc_104_5_104_12&#39;)"><span class="hl_fundecl"><span class="mpre">foldMap</span></span></a><span class="mpre"> </span><a name="loc_85_11_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_11_85_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_86_5_86_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> where
    </span><a name="loc_86_5_86_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> _ </span><a name="loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_86_17_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_18&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_86_5_86_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_86_15_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mappend`</span></span><span class="mpre"> </span><a href="#loc_86_5_86_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_86_17_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_18&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
    </span><a href="#loc_86_5_86_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_60_5_60_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_8&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> _ </span><a name="loc_87_15_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_15_87_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_85_11_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_11_85_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_87_15_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_15_87_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
    </span><a href="#loc_86_5_86_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mempty</span></span><span class="mpre">
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Foldable.html#loc_104_5_104_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Foldable.html#loc_104_5_104_12&#39;)"><span class="mpre">foldMap</span></a><span class="mpre"> #-}</span></span><span class="mpre">

instance </span><a href="Data.Traversable.html#loc_147_34_147_45" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_147_34_147_45&#39;)"><span class="hl_classref"><span class="mpre">Traversable</span></span></a><span class="mpre"> (</span><a href="#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre">) where
  </span><a href="Data.Traversable.html#loc_150_5_150_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_150_5_150_13&#39;)"><span class="hl_fundecl"><span class="mpre">traverse</span></span></a><span class="mpre"> </span><a name="loc_92_12_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_12_92_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_93_5_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_5_93_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> where
    </span><a name="loc_93_5_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_5_93_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> </span><a name="loc_93_13_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_13_93_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_93_15_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_16&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_93_17_93_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_17_93_18&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> </span><a href="#loc_93_13_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_13_93_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_93_5_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_5_93_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_93_15_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_93_5_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_5_93_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_93_17_93_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_17_93_18&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
    </span><a href="#loc_93_5_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_5_93_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_60_5_60_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_8&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a name="loc_94_13_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_14&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_94_15_94_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_60_5_60_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_8&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a href="#loc_94_13_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_92_12_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_12_92_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_94_15_94_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
    </span><a href="#loc_93_5_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_5_93_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre"> = </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_varref"><span class="mpre">pure</span></span></a><span class="mpre"> </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre">
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Traversable.html#loc_150_5_150_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_150_5_150_13&#39;)"><span class="mpre">traverse</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Generating Levels</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This is an illegal &#39;Monoid&#39; used to construct a single &#39;Level&#39;.</span></span><span class="mpre">
newtype </span><a name="loc_103_9_103_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_18&#39;)"><span class="hl_tycondecl"><span class="mpre">Deepening</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_103_25_103_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_25_103_34&#39;)"><span class="hl_condecl"><span class="mpre">Deepening</span></span></a><span class="mpre"> { </span><a name="loc_103_37_103_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_37_103_49&#39;)"><span class="hl_fielddecl"><span class="mpre">runDeepening</span></span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">. </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><a href="#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> }

instance </span><span class="hl_classref"><span class="mpre">Semigroup</span></span><span class="mpre"> (</span><a href="#loc_103_9_103_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_18&#39;)"><span class="hl_tyconref"><span class="mpre">Deepening</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
  </span><a href="#loc_103_25_103_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_25_103_34&#39;)"><span class="hl_conref"><span class="mpre">Deepening</span></span></a><span class="mpre"> </span><a name="loc_106_13_106_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_13_106_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&lt;&gt;</span></span><span class="mpre"> </span><a href="#loc_103_25_103_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_25_103_34&#39;)"><span class="hl_conref"><span class="mpre">Deepening</span></span></a><span class="mpre"> </span><a name="loc_106_28_106_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_28_106_29&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_103_25_103_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_25_103_34&#39;)"><span class="hl_conref"><span class="mpre">Deepening</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_106_46_106_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_46_106_47&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_106_48_106_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_48_106_49&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_106_46_106_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_46_106_47&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> of
    </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> -&gt; </span><a href="#loc_106_48_106_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_48_106_49&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    _ -&gt; let </span><a name="loc_108_14_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_14_108_16&#39;)"><span class="hl_vardecl"><span class="mpre">n&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_106_46_106_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_46_106_47&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> in </span><a href="#loc_106_13_106_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_13_106_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_108_14_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_14_108_16&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_108_36_108_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_36_108_37&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_108_38_108_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_38_108_39&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_106_28_106_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_28_106_29&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_108_14_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_14_108_16&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_108_51_108_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_51_108_52&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_108_53_108_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_53_108_54&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_106_48_106_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_48_106_49&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_varref"><span class="mpre">lappend</span></span></a><span class="mpre"> </span><a href="#loc_108_36_108_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_36_108_37&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_108_51_108_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_51_108_52&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) (</span><a href="#loc_108_38_108_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_38_108_39&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_108_53_108_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_53_108_54&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE (&lt;&gt;) #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This is an illegal &#39;Monoid&#39;.</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Monoid</span></span><span class="mpre"> (</span><a href="#loc_103_9_103_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_18&#39;)"><span class="hl_tyconref"><span class="mpre">Deepening</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
  </span><span class="hl_vardecl"><span class="mpre">mempty</span></span><span class="mpre"> = </span><a href="#loc_103_25_103_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_25_103_34&#39;)"><span class="hl_conref"><span class="mpre">Deepening</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ _ </span><a name="loc_113_28_113_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_28_113_29&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_113_28_113_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_28_113_29&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE mempty #-}</span></span><span class="mpre">
  </span><span class="hl_fundecl"><span class="mpre">mappend</span></span><span class="mpre"> (</span><a href="#loc_103_25_103_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_25_103_34&#39;)"><span class="hl_conref"><span class="mpre">Deepening</span></span></a><span class="mpre"> </span><a name="loc_115_22_115_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_22_115_23&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) (</span><a href="#loc_103_25_103_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_25_103_34&#39;)"><span class="hl_conref"><span class="mpre">Deepening</span></span></a><span class="mpre"> </span><a name="loc_115_36_115_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_36_115_37&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_103_25_103_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_25_103_34&#39;)"><span class="hl_conref"><span class="mpre">Deepening</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_115_55_115_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_55_115_56&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_115_57_115_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_57_115_58&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_115_55_115_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_55_115_56&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> of
    </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> -&gt; </span><a href="#loc_115_57_115_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_57_115_58&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    _ -&gt; let </span><a name="loc_117_14_117_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_14_117_16&#39;)"><span class="hl_vardecl"><span class="mpre">n&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_115_55_115_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_55_115_56&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> in </span><a href="#loc_115_22_115_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_22_115_23&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_117_14_117_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_14_117_16&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_117_36_117_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_36_117_37&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_117_38_117_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_38_117_39&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_115_36_115_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_36_115_37&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_117_14_117_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_14_117_16&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_117_51_117_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_51_117_52&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_117_53_117_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_53_117_54&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_115_57_115_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_57_115_58&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_varref"><span class="mpre">lappend</span></span></a><span class="mpre"> </span><a href="#loc_117_36_117_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_36_117_37&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_117_51_117_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_51_117_52&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) (</span><a href="#loc_117_38_117_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_38_117_39&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_117_53_117_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_53_117_54&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE mappend #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Generate the leaf of a given &#39;Deepening&#39; based on whether or not we&#39;re at the correct depth.</span></span><span class="mpre">
</span><a href="#loc_122_1_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_10&#39;)"><span class="mpre">deepening</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_103_9_103_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_18&#39;)"><span class="hl_tyconref"><span class="mpre">Deepening</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_122_1_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_10&#39;)"><span class="hl_fundecl"><span class="mpre">deepening</span></span></a><span class="mpre"> </span><a name="loc_122_11_122_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_11_122_12&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_122_13_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_13_122_14&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_103_25_103_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_25_103_34&#39;)"><span class="hl_conref"><span class="mpre">Deepening</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_122_30_122_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_30_122_31&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_122_32_122_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_32_122_33&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_122_32_122_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_32_122_33&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (if </span><a href="#loc_122_30_122_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_30_122_31&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><a href="#loc_60_5_60_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_8&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a href="#loc_122_11_122_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_11_122_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_122_13_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_13_122_14&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> else </span><a href="#loc_61_5_61_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_9&#39;)"><span class="hl_conref"><span class="mpre">Zero</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_122_1_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_10&#39;)"><span class="mpre">deepening</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Reassembling Levels</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This is an illegal &#39;Applicative&#39; used to replace the contents of a list of consecutive &#39;Level&#39; values</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- representing each layer of a structure into the original shape that they were derived from.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Attempting to &#39;Flow&#39; something back into a shape other than the one it was taken from will fail.</span></span><span class="mpre">
newtype </span><a name="loc_133_9_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_9_133_14&#39;)"><span class="hl_tycondecl"><span class="mpre">Flows</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_133_23_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_23_133_28&#39;)"><span class="hl_condecl"><span class="mpre">Flows</span></span></a><span class="mpre"> { </span><a name="loc_133_31_133_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_31_133_39&#39;)"><span class="hl_fielddecl"><span class="mpre">runFlows</span></span></a><span class="mpre"> :: [</span><a href="#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> }

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> (</span><a href="#loc_133_9_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_9_133_14&#39;)"><span class="hl_tyconref"><span class="mpre">Flows</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) where
  </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_136_8_136_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_8_136_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_133_23_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_23_133_28&#39;)"><span class="hl_conref"><span class="mpre">Flows</span></span></a><span class="mpre"> </span><a name="loc_136_17_136_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_17_136_18&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) = </span><a href="#loc_133_23_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_23_133_28&#39;)"><span class="hl_conref"><span class="mpre">Flows</span></span></a><span class="mpre"> (</span><a href="#loc_136_8_136_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_8_136_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="Control.Category.html#loc_37_5_37_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Category.html#loc_37_5_37_8&#39;)"><span class="hl_infix"><span class="mpre">.</span></span></a><span class="mpre"> </span><a href="#loc_136_17_136_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_17_136_18&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE fmap #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Walk down one constructor in a &#39;Level&#39;, veering left.</span></span><span class="mpre">
</span><a href="#loc_141_1_141_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_6&#39;)"><span class="mpre">triml</span></a><span class="mpre"> :: </span><a href="#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_141_1_141_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_6&#39;)"><span class="hl_fundecl"><span class="mpre">triml</span></span></a><span class="mpre"> (</span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_141_14_141_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_14_141_15&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> _) = </span><a href="#loc_141_14_141_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_14_141_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
</span><a href="#loc_141_1_141_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_6&#39;)"><span class="hl_fundecl"><span class="mpre">triml</span></span></a><span class="mpre"> (</span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> </span><a name="loc_142_12_142_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_12_142_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_142_14_142_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_14_142_15&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_142_16_142_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_16_142_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> (</span><a href="#loc_142_12_142_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_12_142_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_142_14_142_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_14_142_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_142_16_142_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_16_142_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><a href="#loc_141_1_141_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_6&#39;)"><span class="hl_fundecl"><span class="mpre">triml</span></span></a><span class="mpre"> </span><a name="loc_143_7_143_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_7_143_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">           = </span><a href="#loc_143_7_143_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_7_143_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_141_1_141_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_6&#39;)"><span class="mpre">triml</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Walk down one constructor in a &#39;Level&#39;, veering right.</span></span><span class="mpre">
</span><a href="#loc_148_1_148_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_6&#39;)"><span class="mpre">trimr</span></a><span class="mpre"> :: </span><a href="#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_148_1_148_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_6&#39;)"><span class="hl_fundecl"><span class="mpre">trimr</span></span></a><span class="mpre"> (</span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> _ </span><a name="loc_148_16_148_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_16_148_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_148_16_148_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_16_148_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><a href="#loc_148_1_148_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_6&#39;)"><span class="hl_fundecl"><span class="mpre">trimr</span></span></a><span class="mpre"> (</span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> </span><a name="loc_149_12_149_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_12_149_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_149_14_149_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_14_149_15&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_149_16_149_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_16_149_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_59_5_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_8&#39;)"><span class="hl_conref"><span class="mpre">Two</span></span></a><span class="mpre"> (</span><a href="#loc_149_12_149_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_12_149_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_149_14_149_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_14_149_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_149_16_149_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_16_149_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><a href="#loc_148_1_148_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_6&#39;)"><span class="hl_fundecl"><span class="mpre">trimr</span></span></a><span class="mpre"> </span><a name="loc_150_7_150_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_7_150_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">           = </span><a href="#loc_150_7_150_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_7_150_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_148_1_148_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_6&#39;)"><span class="mpre">trimr</span></a><span class="mpre"> #-}</span></span><span class="mpre">

instance </span><a href="Data.Functor.Bind.html#loc_98_20_98_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.Bind.html#loc_98_20_98_25&#39;)"><span class="hl_classref"><span class="mpre">Apply</span></span></a><span class="mpre"> (</span><a href="#loc_133_9_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_9_133_14&#39;)"><span class="hl_tyconref"><span class="mpre">Flows</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) where
  </span><a href="#loc_133_23_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_23_133_28&#39;)"><span class="hl_conref"><span class="mpre">Flows</span></span></a><span class="mpre"> </span><a name="loc_154_9_154_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_11&#39;)"><span class="hl_vardecl"><span class="mpre">mf</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&lt;.&gt;</span></span><span class="mpre"> </span><a href="#loc_133_23_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_23_133_28&#39;)"><span class="hl_conref"><span class="mpre">Flows</span></span></a><span class="mpre"> </span><a name="loc_154_22_154_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_22_154_24&#39;)"><span class="hl_vardecl"><span class="mpre">ma</span></span></a><span class="mpre"> = </span><a href="#loc_133_23_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_23_133_28&#39;)"><span class="hl_conref"><span class="mpre">Flows</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_154_37_154_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_37_154_40&#39;)"><span class="hl_vardecl"><span class="mpre">xss</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_154_37_154_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_37_154_40&#39;)"><span class="hl_varref"><span class="mpre">xss</span></span></a><span class="mpre"> of
    []             -&gt; </span><a href="#loc_154_9_154_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_11&#39;)"><span class="hl_varref"><span class="mpre">mf</span></span></a><span class="mpre"> [] (</span><a href="#loc_154_22_154_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_22_154_24&#39;)"><span class="hl_varref"><span class="mpre">ma</span></span></a><span class="mpre"> [])
    (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_156_8_156_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_8_156_10&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)         -&gt; </span><a href="#loc_154_9_154_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_11&#39;)"><span class="hl_varref"><span class="mpre">mf</span></span></a><span class="mpre"> (</span><a href="#loc_141_1_141_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_6&#39;)"><span class="hl_varref"><span class="mpre">triml</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_156_8_156_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_8_156_10&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_154_22_154_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_22_154_24&#39;)"><span class="hl_varref"><span class="mpre">ma</span></span></a><span class="mpre"> (</span><a href="#loc_148_1_148_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_6&#39;)"><span class="hl_varref"><span class="mpre">trimr</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_156_8_156_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_8_156_10&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE (&lt;.&gt;) #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This is an illegal &#39;Applicative&#39;.</span></span><span class="mpre">
instance </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> (</span><a href="#loc_133_9_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_9_133_14&#39;)"><span class="hl_tyconref"><span class="mpre">Flows</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) where
  </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_fundecl"><span class="mpre">pure</span></span></a><span class="mpre"> </span><a name="loc_161_8_161_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_8_161_9&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_133_23_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_23_133_28&#39;)"><span class="hl_conref"><span class="mpre">Flows</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="#loc_161_8_161_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_8_161_9&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="mpre">pure</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a href="#loc_133_23_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_23_133_28&#39;)"><span class="hl_conref"><span class="mpre">Flows</span></span></a><span class="mpre"> </span><a name="loc_163_9_163_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_9_163_11&#39;)"><span class="hl_vardecl"><span class="mpre">mf</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_133_23_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_23_133_28&#39;)"><span class="hl_conref"><span class="mpre">Flows</span></span></a><span class="mpre"> </span><a name="loc_163_22_163_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_22_163_24&#39;)"><span class="hl_vardecl"><span class="mpre">ma</span></span></a><span class="mpre"> = </span><a href="#loc_133_23_133_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_23_133_28&#39;)"><span class="hl_conref"><span class="mpre">Flows</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_163_37_163_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_37_163_40&#39;)"><span class="hl_vardecl"><span class="mpre">xss</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_163_37_163_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_37_163_40&#39;)"><span class="hl_varref"><span class="mpre">xss</span></span></a><span class="mpre"> of
    []             -&gt; </span><a href="#loc_163_9_163_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_9_163_11&#39;)"><span class="hl_varref"><span class="mpre">mf</span></span></a><span class="mpre"> [] (</span><a href="#loc_163_22_163_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_22_163_24&#39;)"><span class="hl_varref"><span class="mpre">ma</span></span></a><span class="mpre"> [])
    (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_165_8_165_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_8_165_10&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)         -&gt; </span><a href="#loc_163_9_163_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_9_163_11&#39;)"><span class="hl_varref"><span class="mpre">mf</span></span></a><span class="mpre"> (</span><a href="#loc_141_1_141_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_6&#39;)"><span class="hl_varref"><span class="mpre">triml</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_165_8_165_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_8_165_10&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_163_22_163_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_22_163_24&#39;)"><span class="hl_varref"><span class="mpre">ma</span></span></a><span class="mpre"> (</span><a href="#loc_148_1_148_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_6&#39;)"><span class="hl_varref"><span class="mpre">trimr</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_165_8_165_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_8_165_10&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="mpre">(&lt;*&gt;)</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span></div></body></html>