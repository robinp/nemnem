<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">{- |
This module contains the various datatypes which model the state of the line; that is, the characters displayed and the position of the cursor.
-}</span></span><span class="mpre">
module System.Console.Haskeline.LineState(
                    </span><span class="hl_comment"><span class="mpre">-- * Graphemes</span></span><span class="mpre">
                    Grapheme(),
                    baseChar,
                    stringToGraphemes,
                    graphemesToString,
                    modifyBaseChar,
                    mapBaseChars,
                    </span><span class="hl_comment"><span class="mpre">-- * Line State class</span></span><span class="mpre">
                    LineState(..),
                    Prefix,
                    </span><span class="hl_comment"><span class="mpre">-- ** Convenience functions for the drawing backends</span></span><span class="mpre">
                    LineChars,
                    lineChars,
                    lengthToEnd,
                    </span><span class="hl_comment"><span class="mpre">-- ** Supplementary classes</span></span><span class="mpre">
                    Result(..),
                    Save(..),
                    listSave,
                    listRestore,
                    Move(..),
                    </span><span class="hl_comment"><span class="mpre">-- * Instances</span></span><span class="mpre">
                    </span><span class="hl_comment"><span class="mpre">-- ** InsertMode</span></span><span class="mpre">
                    InsertMode(..),
                    emptyIM,
                    insertChar,
                    insertString,
                    replaceCharIM,
                    insertGraphemes,
                    deleteNext,
                    deletePrev,
                    skipLeft,
                    skipRight,
                    transposeChars,
                    </span><span class="hl_comment"><span class="mpre">-- *** Moving to word boundaries</span></span><span class="mpre">
                    goRightUntil,
                    goLeftUntil,
                    atStart,
                    atEnd,
                    beforeChar,
                    afterChar,
                    overChar,
                    </span><span class="hl_comment"><span class="mpre">-- ** CommandMode</span></span><span class="mpre">
                    CommandMode(..),
                    deleteChar,
                    replaceChar,
                    pasteGraphemesBefore,
                    pasteGraphemesAfter,
                    </span><span class="hl_comment"><span class="mpre">-- *** Transitioning between modes</span></span><span class="mpre">
                    enterCommandMode,
                    enterCommandModeRight,
                    insertFromCommandMode,
                    appendFromCommandMode,
                    withCommandMode,
                    </span><span class="hl_comment"><span class="mpre">-- ** ArgMode</span></span><span class="mpre">
                    ArgMode(..),
                    startArg,
                    addNum,
                    applyArg,
                    applyCmdArg,
                    </span><span class="hl_comment"><span class="mpre">-- ** Other line state types</span></span><span class="mpre">
                    Message(..),
                    Password(..),
                    addPasswordChar,
                    deletePasswordChar,
                    ) where

import Data.Char

</span><span class="hl_comment"><span class="mpre">-- | A &#39;Grapheme&#39; is a fundamental unit of display for the UI.  Several characters in sequence</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- can represent one grapheme; for example, an @a@ followed by the diacritic @\&#39;\\768\&#39;@ should</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- be treated as one unit.</span></span><span class="mpre">
data </span><a name="loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tycondecl"><span class="mpre">Grapheme</span></span></a><span class="mpre"> = </span><a name="loc_76_17_76_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_17_76_25&#39;)"><span class="hl_condecl"><span class="mpre">Grapheme</span></span></a><span class="mpre"> {</span><a name="loc_76_27_76_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_27_76_36&#39;)"><span class="hl_fielddecl"><span class="mpre">gBaseChar</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">,
                            </span><a name="loc_77_29_77_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_29_77_43&#39;)"><span class="hl_fielddecl"><span class="mpre">combiningChars</span></span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]}
                    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 78, srcSpanStartColumn = 21, srcSpanEndLine = 78, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 78, srcSpanStartColumn = 21, srcSpanEndLine = 78, srcSpanEndColumn = 29}]}) [IHead (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/"><span class="mpre">deriving Eq</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> </span><a name="loc_81_10_81_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_10_81_11&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_76_27_76_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_27_76_36&#39;)"><span class="hl_varref"><span class="mpre">gBaseChar</span></span></a><span class="mpre"> </span><a href="#loc_81_10_81_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_10_81_11&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_77_29_77_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_29_77_43&#39;)"><span class="hl_varref"><span class="mpre">combiningChars</span></span></a><span class="mpre"> </span><a href="#loc_81_10_81_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_10_81_11&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)

</span><a href="#loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="mpre">baseChar</span></a><span class="mpre"> :: </span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="hl_vardecl"><span class="mpre">baseChar</span></span></a><span class="mpre"> = </span><a href="#loc_76_27_76_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_27_76_36&#39;)"><span class="hl_varref"><span class="mpre">gBaseChar</span></span></a><span class="mpre">

</span><a href="#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_15&#39;)"><span class="mpre">modifyBaseChar</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">) -&gt; </span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">
</span><a name="loc_87_1_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_15&#39;)"><span class="hl_fundecl"><span class="mpre">modifyBaseChar</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">g</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 22, srcSpanEndLine = 87, srcSpanEndColumn = 53}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 24, srcSpanEndLine = 87, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0."><span class="mpre">g {gBaseChar = f (gBaseChar g)}</span></span><span class="mpre">

</span><a href="#loc_90_1_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_13&#39;)"><span class="mpre">mapBaseChars</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">) -&gt; [</span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">] -&gt; [</span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">]
</span><a name="loc_90_1_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_13&#39;)"><span class="hl_fundecl"><span class="mpre">mapBaseChars</span></span></a><span class="mpre"> </span><a name="loc_90_14_90_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_14_90_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_15&#39;)"><span class="hl_varref"><span class="mpre">modifyBaseChar</span></span></a><span class="mpre"> </span><a href="#loc_90_14_90_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_14_90_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Create a &#39;Grapheme&#39; from a single base character.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- NOTE: Careful, don&#39;t use outside this module; and inside, make sure this is only</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ever called on non-combining characters.</span></span><span class="mpre">
</span><a href="#loc_97_1_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_13&#39;)"><span class="mpre">baseGrapheme</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">
</span><a name="loc_97_1_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_13&#39;)"><span class="hl_fundecl"><span class="mpre">baseGrapheme</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">c</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 18, srcSpanEndLine = 97, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 27, srcSpanEndLine = 97, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0."><span class="mpre">Grapheme {gBaseChar = c, combiningChars = []}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Add a combining character to the given &#39;Grapheme&#39;.</span></span><span class="mpre">
</span><a href="#loc_101_1_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_12&#39;)"><span class="mpre">addCombiner</span></a><span class="mpre"> :: </span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">
</span><a name="loc_101_1_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_12&#39;)"><span class="hl_fundecl"><span class="mpre">addCombiner</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">g</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">c</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 101, srcSpanStartColumn = 19, srcSpanEndLine = 101, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 101, srcSpanStartColumn = 21, srcSpanEndLine = 101, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskelin"><span class="mpre">g {combiningChars = combiningChars g ++ [c]}</span></span><span class="mpre">

</span><a href="#loc_104_1_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_16&#39;)"><span class="mpre">isCombiningChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_104_1_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_16&#39;)"><span class="hl_fundecl"><span class="mpre">isCombiningChar</span></span></a><span class="mpre"> </span><a name="loc_104_17_104_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_17_104_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">generalCategory</span></span><span class="mpre"> </span><a href="#loc_104_17_104_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_17_104_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">NonSpacingMark</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Converts a string into a sequence of graphemes.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- NOTE: Drops any initial, unattached combining characters.</span></span><span class="mpre">
</span><a href="#loc_110_1_110_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_18&#39;)"><span class="mpre">stringToGraphemes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">]
</span><a name="loc_110_1_110_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_18&#39;)"><span class="hl_vardecl"><span class="mpre">stringToGraphemes</span></span></a><span class="mpre"> = </span><a href="#loc_112_9_112_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_17&#39;)"><span class="hl_varref"><span class="mpre">mkString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> </span><a href="#loc_104_1_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_16&#39;)"><span class="hl_varref"><span class="mpre">isCombiningChar</span></span></a><span class="mpre">
    where
        </span><a name="loc_112_9_112_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_17&#39;)"><span class="hl_fundecl"><span class="mpre">mkString</span></span></a><span class="mpre"> [] = []
        </span><span class="hl_comment"><span class="mpre">-- Minor hack: &quot;\ESC...\STX&quot; or &quot;\SOH\ESC...\STX&quot;, where &quot;\ESC...&quot; is some</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- control sequence (e.g., ANSI colors), is represented as a grapheme</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- of zero length with &#39;\ESC&#39; as the base character.</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- Note that this won&#39;t round-trip correctly with graphemesToString.</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- In practice, however, that&#39;s fine since control characters can only occur</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- in the prompt.</span></span><span class="mpre">
        </span><a href="#loc_112_9_112_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_17&#39;)"><span class="hl_fundecl"><span class="mpre">mkString</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\SOH&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_119_26_119_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_26_119_28&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) = </span><a href="#loc_110_1_110_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_18&#39;)"><span class="hl_varref"><span class="mpre">stringToGraphemes</span></span></a><span class="mpre"> </span><a href="#loc_119_26_119_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_26_119_28&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
        </span><a href="#loc_112_9_112_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_17&#39;)"><span class="hl_fundecl"><span class="mpre">mkString</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\ESC&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_120_26_120_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_26_120_28&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) | (</span><span class="hl_vardecl"><span class="mpre">ctrl</span></span><span class="mpre">,</span><span class="hl_char"><span class="mpre">&#39;\STX&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_vardecl"><span class="mpre">rest</span></span><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;\STX&#39;</span></span><span class="mpre">) </span><a href="#loc_120_26_120_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_26_120_28&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
                    = </span><a href="#loc_76_17_76_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_17_76_25&#39;)"><span class="hl_conref"><span class="mpre">Grapheme</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\ESC&#39;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ctrl</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_110_1_110_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_18&#39;)"><span class="hl_varref"><span class="mpre">stringToGraphemes</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">rest</span></span><span class="mpre">
        </span><a href="#loc_112_9_112_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_17&#39;)"><span class="hl_fundecl"><span class="mpre">mkString</span></span></a><span class="mpre"> (</span><a name="loc_122_19_122_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_19_122_20&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_122_21_122_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_21_122_23&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) = </span><a href="#loc_76_17_76_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_17_76_25&#39;)"><span class="hl_conref"><span class="mpre">Grapheme</span></span></a><span class="mpre"> </span><a href="#loc_122_19_122_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_19_122_20&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">takeWhile</span></span><span class="mpre"> </span><a href="#loc_104_1_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_16&#39;)"><span class="hl_varref"><span class="mpre">isCombiningChar</span></span></a><span class="mpre"> </span><a href="#loc_122_21_122_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_21_122_23&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
                                </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_112_9_112_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_17&#39;)"><span class="hl_varref"><span class="mpre">mkString</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> </span><a href="#loc_104_1_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_16&#39;)"><span class="hl_varref"><span class="mpre">isCombiningChar</span></span></a><span class="mpre"> </span><a href="#loc_122_21_122_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_21_122_23&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)

</span><a href="#loc_126_1_126_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_18&#39;)"><span class="mpre">graphemesToString</span></a><span class="mpre"> :: [</span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_126_1_126_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_18&#39;)"><span class="hl_vardecl"><span class="mpre">graphemesToString</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (\</span><a name="loc_126_33_126_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_33_126_34&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="hl_varref"><span class="mpre">baseChar</span></span></a><span class="mpre"> </span><a href="#loc_126_33_126_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_33_126_34&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_77_29_77_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_29_77_43&#39;)"><span class="hl_varref"><span class="mpre">combiningChars</span></span></a><span class="mpre"> </span><a href="#loc_126_33_126_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_33_126_34&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | This class abstracts away the internal representations of the line state,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for use by the drawing actions.  Line state is generally stored in a zipper format.</span></span><span class="mpre">
class </span><a name="loc_130_7_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_7_130_16&#39;)"><span class="hl_classdecl"><span class="mpre">LineState</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> where
    </span><a name="loc_131_5_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_17&#39;)"><span class="mpre">beforeCursor</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Prefix</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ The input prefix.</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ The current line state.</span></span><span class="mpre">
                    -&gt; [</span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ The text to the left of the cursor</span></span><span class="mpre">
                                  </span><span class="hl_comment"><span class="mpre">-- (including the prefix).</span></span><span class="mpre">
    </span><a name="loc_135_5_135_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_16&#39;)"><span class="mpre">afterCursor</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; [</span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ The text under and to the right of the cursor.</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 137, srcSpanStartColumn = 1, srcSpanEndLine = 137, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 137, srcSpanStartColumn = 1, srcSpanEndLine = 137, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0."><span class="mpre">type Prefix = [Grapheme]</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The characters in the line (with the cursor in the middle).  NOT in a zippered format;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- both lists are in the order left-&gt;right that appears on the screen.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 141, srcSpanStartColumn = 1, srcSpanEndLine = 141, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 141, srcSpanStartColumn = 1, srcSpanEndLine = 141, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0."><span class="mpre">type LineChars = ([Grapheme],[Grapheme])</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Accessor function for the various backends.</span></span><span class="mpre">
</span><a href="#loc_145_1_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_10&#39;)"><span class="mpre">lineChars</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 144, srcSpanStartColumn = 14, srcSpanEndLine = 144, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 144, srcSpanStartColumn = 26, srcSpanEndLine = 144, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename"><span class="mpre">LineState s =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Prefix</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">LineChars</span></span><span class="mpre">
</span><a name="loc_145_1_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_10&#39;)"><span class="hl_fundecl"><span class="mpre">lineChars</span></span></a><span class="mpre"> </span><a name="loc_145_11_145_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_17&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><a name="loc_145_18_145_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_18_145_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = (</span><a href="#loc_131_5_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_17&#39;)"><span class="hl_varref"><span class="mpre">beforeCursor</span></span></a><span class="mpre"> </span><a href="#loc_145_11_145_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_17&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><a href="#loc_145_18_145_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_18_145_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_135_5_135_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_16&#39;)"><span class="hl_varref"><span class="mpre">afterCursor</span></span></a><span class="mpre"> </span><a href="#loc_145_18_145_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_18_145_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Compute the number of characters under and to the right of the cursor.</span></span><span class="mpre">
</span><a href="#loc_149_1_149_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_12&#39;)"><span class="mpre">lengthToEnd</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">LineChars</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_149_1_149_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_12&#39;)"><span class="hl_vardecl"><span class="mpre">lengthToEnd</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">

class </span><span class="warning" data-warning="ClassDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 151, srcSpanStartColumn = 7, srcSpanEndLine = 151, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 151, srcSpanStartColumn = 19, srcSpanEndLine = 151, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename "><span class="mpre">LineState s =&gt;</span></span><span class="mpre"> </span><a name="loc_151_22_151_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_22_151_28&#39;)"><span class="hl_classdecl"><span class="mpre">Result</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> where
    </span><a name="loc_152_5_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_5_152_13&#39;)"><span class="mpre">toResult</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">

class </span><span class="warning" data-warning="ClassDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 154, srcSpanStartColumn = 7, srcSpanEndLine = 154, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 154, srcSpanStartColumn = 19, srcSpanEndLine = 154, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename "><span class="mpre">LineState s =&gt;</span></span><span class="mpre"> </span><a name="loc_154_22_154_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_22_154_26&#39;)"><span class="hl_classdecl"><span class="mpre">Save</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> where
    </span><a name="loc_155_5_155_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_5_155_9&#39;)"><span class="mpre">save</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre">
    </span><a name="loc_156_5_156_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_5_156_12&#39;)"><span class="mpre">restore</span></a><span class="mpre"> :: </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">

</span><a href="#loc_159_1_159_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_9&#39;)"><span class="mpre">listSave</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 158, srcSpanStartColumn = 13, srcSpanEndLine = 158, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 158, srcSpanStartColumn = 20, srcSpanEndLine = 158, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename"><span class="mpre">Save s =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; [</span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">]
</span><a name="loc_159_1_159_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_9&#39;)"><span class="hl_fundecl"><span class="mpre">listSave</span></span></a><span class="mpre"> </span><a name="loc_159_10_159_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_10_159_11&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = case </span><a href="#loc_155_5_155_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_5_155_9&#39;)"><span class="hl_varref"><span class="mpre">save</span></span></a><span class="mpre"> </span><a href="#loc_159_10_159_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_10_159_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_159_35_159_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_35_159_37&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_159_38_159_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_38_159_40&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_159_35_159_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_35_159_37&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_159_38_159_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_38_159_40&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">

</span><a href="#loc_162_1_162_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_12&#39;)"><span class="mpre">listRestore</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 161, srcSpanStartColumn = 16, srcSpanEndLine = 161, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 161, srcSpanStartColumn = 23, srcSpanEndLine = 161, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename"><span class="mpre">Save s =&gt;</span></span><span class="mpre"> [</span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_162_1_162_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_12&#39;)"><span class="hl_fundecl"><span class="mpre">listRestore</span></span></a><span class="mpre"> </span><a name="loc_162_13_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_13_162_15&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_156_5_156_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_5_156_12&#39;)"><span class="hl_varref"><span class="mpre">restore</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_162_13_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_13_162_15&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) []

class </span><a name="loc_164_7_164_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_7_164_11&#39;)"><span class="hl_classdecl"><span class="mpre">Move</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> where
    </span><a name="loc_165_5_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_11&#39;)"><span class="mpre">goLeft</span></a><span class="mpre">, </span><a name="loc_165_13_165_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_13_165_20&#39;)"><span class="mpre">goRight</span></a><span class="mpre">, </span><a name="loc_165_22_165_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_22_165_33&#39;)"><span class="mpre">moveToStart</span></a><span class="mpre">, </span><a name="loc_165_35_165_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_35_165_44&#39;)"><span class="mpre">moveToEnd</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
    
</span><span class="hl_comment"><span class="mpre">-- | The standard line state representation; considers the cursor to be located</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- between two characters.  The first list is reversed.</span></span><span class="mpre">
data </span><a name="loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tycondecl"><span class="mpre">InsertMode</span></span></a><span class="mpre"> = </span><a name="loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_condecl"><span class="mpre">IMode</span></span></a><span class="mpre"> [</span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">] [</span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">]
                    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 170, srcSpanStartColumn = 21, srcSpanEndLine = 170, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 170, srcSpanStartColumn = 21, srcSpanEndLine = 170, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline"><span class="mpre">deriving (Show, Eq)</span></span><span class="mpre">

instance </span><a href="#loc_130_7_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_7_130_16&#39;)"><span class="hl_classref"><span class="mpre">LineState</span></span></a><span class="mpre"> </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> where
    </span><a href="#loc_131_5_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_17&#39;)"><span class="hl_fundecl"><span class="mpre">beforeCursor</span></span></a><span class="mpre"> </span><a name="loc_173_18_173_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_18_173_24&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_173_32_173_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_32_173_34&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> _) = </span><a href="#loc_173_18_173_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_18_173_24&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_173_32_173_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_32_173_34&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="#loc_135_5_135_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_16&#39;)"><span class="hl_fundecl"><span class="mpre">afterCursor</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> _ </span><a name="loc_174_26_174_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_26_174_28&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_174_26_174_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_26_174_28&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">

instance </span><a href="#loc_151_22_151_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_22_151_28&#39;)"><span class="hl_classref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> where
    </span><a href="#loc_152_5_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_5_152_13&#39;)"><span class="hl_fundecl"><span class="mpre">toResult</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_177_21_177_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_21_177_23&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_177_24_177_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_24_177_26&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_126_1_126_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_18&#39;)"><span class="hl_varref"><span class="mpre">graphemesToString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_177_21_177_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_21_177_23&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_177_24_177_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_24_177_26&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">

instance </span><a href="#loc_154_22_154_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_22_154_26&#39;)"><span class="hl_classref"><span class="mpre">Save</span></span></a><span class="mpre"> </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> where
    </span><a href="#loc_155_5_155_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_5_155_9&#39;)"><span class="hl_vardecl"><span class="mpre">save</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
    </span><a href="#loc_156_5_156_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_5_156_12&#39;)"><span class="hl_vardecl"><span class="mpre">restore</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">

instance </span><a href="#loc_164_7_164_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_7_164_11&#39;)"><span class="hl_classref"><span class="mpre">Move</span></span></a><span class="mpre"> </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> where
    </span><a href="#loc_165_5_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_11&#39;)"><span class="hl_fundecl"><span class="mpre">goLeft</span></span></a><span class="mpre"> </span><a name="loc_184_12_184_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_12_184_14&#39;)"><span class="hl_specname"><span class="mpre">im</span></span></a><span class="mpre">@(</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> [] _) = </span><a href="#loc_184_12_184_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_12_184_14&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre"> 
    </span><a href="#loc_165_5_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_11&#39;)"><span class="hl_fundecl"><span class="mpre">goLeft</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a name="loc_185_20_185_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_20_185_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_185_22_185_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_22_185_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_185_26_185_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_26_185_28&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a href="#loc_185_22_185_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_22_185_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> (</span><a href="#loc_185_20_185_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_20_185_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_185_26_185_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_26_185_28&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">)

    </span><a href="#loc_165_13_165_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_13_165_20&#39;)"><span class="hl_fundecl"><span class="mpre">goRight</span></span></a><span class="mpre"> </span><a name="loc_187_13_187_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_13_187_15&#39;)"><span class="hl_specname"><span class="mpre">im</span></span></a><span class="mpre">@(</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> _ []) = </span><a href="#loc_187_13_187_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_13_187_15&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre">
    </span><a href="#loc_165_13_165_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_13_165_20&#39;)"><span class="hl_fundecl"><span class="mpre">goRight</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_188_20_188_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_20_188_22&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre"> (</span><a name="loc_188_24_188_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_188_26_188_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_26_188_28&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)) = </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a href="#loc_188_24_188_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_188_20_188_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_20_188_22&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">) </span><a href="#loc_188_26_188_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_26_188_28&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

    </span><a href="#loc_165_22_165_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_22_165_33&#39;)"><span class="hl_fundecl"><span class="mpre">moveToStart</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_190_24_190_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_24_190_26&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_190_27_190_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_27_190_29&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> [] (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_190_24_190_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_24_190_26&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_190_27_190_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_27_190_29&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">)
    </span><a href="#loc_165_35_165_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_35_165_44&#39;)"><span class="hl_fundecl"><span class="mpre">moveToEnd</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_191_22_191_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_22_191_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_191_25_191_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_25_191_27&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_191_25_191_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_25_191_27&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_191_22_191_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_22_191_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) []

</span><a href="#loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="mpre">emptyIM</span></a><span class="mpre"> :: </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre">
</span><a name="loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="hl_vardecl"><span class="mpre">emptyIM</span></span></a><span class="mpre"> = </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> [] []

</span><span class="hl_comment"><span class="mpre">-- | Insert one character, which may be combining, to the left of the cursor.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  </span></span><span class="mpre">
</span><a href="#loc_199_1_199_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_11&#39;)"><span class="mpre">insertChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre">
</span><a name="loc_199_1_199_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_11&#39;)"><span class="hl_fundecl"><span class="mpre">insertChar</span></span></a><span class="mpre"> </span><a name="loc_199_12_199_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_12_199_13&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_199_14_199_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_14_199_16&#39;)"><span class="hl_specname"><span class="mpre">im</span></span></a><span class="mpre">@(</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_199_24_199_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_24_199_26&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_199_27_199_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_27_199_29&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">)
    | </span><a href="#loc_104_1_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_16&#39;)"><span class="hl_varref"><span class="mpre">isCombiningChar</span></span></a><span class="mpre"> </span><a href="#loc_199_12_199_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_12_199_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> = case </span><a href="#loc_199_24_199_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_24_199_26&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                            []   -&gt; </span><a href="#loc_199_14_199_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_14_199_16&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- drop a combining character if it</span></span><span class="mpre">
                                       </span><span class="hl_comment"><span class="mpre">-- appears at the start of the line.</span></span><span class="mpre">
                            </span><a name="loc_203_29_203_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_29_203_30&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_203_31_203_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_31_203_33&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a href="#loc_101_1_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_12&#39;)"><span class="hl_varref"><span class="mpre">addCombiner</span></span></a><span class="mpre"> </span><a href="#loc_203_29_203_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_29_203_30&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_199_12_199_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_12_199_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_203_31_203_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_31_203_33&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">) </span><a href="#loc_199_27_199_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_27_199_29&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         = </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a href="#loc_97_1_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_13&#39;)"><span class="hl_varref"><span class="mpre">baseGrapheme</span></span></a><span class="mpre"> </span><a href="#loc_199_12_199_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_12_199_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_199_24_199_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_24_199_26&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_199_27_199_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_27_199_29&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Insert a sequence of characters to the left of the cursor. </span></span><span class="mpre">
</span><a href="#loc_208_1_208_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_13&#39;)"><span class="mpre">insertString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre">
</span><a name="loc_208_1_208_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_13&#39;)"><span class="hl_fundecl"><span class="mpre">insertString</span></span></a><span class="mpre"> </span><a name="loc_208_14_208_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_14_208_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_208_23_208_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_23_208_25&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_208_26_208_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_26_208_28&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> (</span><a href="#loc_110_1_110_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_18&#39;)"><span class="hl_varref"><span class="mpre">stringToGraphemes</span></span></a><span class="mpre"> </span><a href="#loc_208_14_208_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_14_208_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_208_23_208_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_23_208_25&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_208_26_208_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_26_208_28&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">

</span><a href="#loc_211_1_211_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_1_211_11&#39;)"><span class="mpre">deleteNext</span></a><span class="mpre">, </span><a href="#loc_214_1_214_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_11&#39;)"><span class="mpre">deletePrev</span></a><span class="mpre"> :: </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre">
</span><a name="loc_211_1_211_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_1_211_11&#39;)"><span class="hl_fundecl"><span class="mpre">deleteNext</span></span></a><span class="mpre"> </span><a name="loc_211_12_211_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_12_211_14&#39;)"><span class="hl_specname"><span class="mpre">im</span></span></a><span class="mpre">@(</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> _ []) = </span><a href="#loc_211_12_211_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_12_211_14&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre">
</span><a href="#loc_211_1_211_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_1_211_11&#39;)"><span class="hl_fundecl"><span class="mpre">deleteNext</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_212_19_212_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_19_212_21&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_212_25_212_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_25_212_27&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">)) = </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a href="#loc_212_19_212_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_19_212_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_212_25_212_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_25_212_27&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">

</span><a name="loc_214_1_214_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_11&#39;)"><span class="hl_fundecl"><span class="mpre">deletePrev</span></span></a><span class="mpre"> </span><a name="loc_214_12_214_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_12_214_14&#39;)"><span class="hl_specname"><span class="mpre">im</span></span></a><span class="mpre">@(</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> [] _) = </span><a href="#loc_214_12_214_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_12_214_14&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre">
</span><a href="#loc_214_1_214_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_11&#39;)"><span class="hl_fundecl"><span class="mpre">deletePrev</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_215_22_215_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_22_215_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_215_26_215_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_26_215_28&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a href="#loc_215_22_215_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_22_215_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_215_26_215_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_26_215_28&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre"> 

</span><a href="#loc_218_1_218_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_1_218_9&#39;)"><span class="mpre">skipLeft</span></a><span class="mpre">, </span><a href="#loc_220_1_220_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_10&#39;)"><span class="mpre">skipRight</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre">
</span><a name="loc_218_1_218_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_1_218_9&#39;)"><span class="hl_fundecl"><span class="mpre">skipLeft</span></span></a><span class="mpre"> </span><a name="loc_218_10_218_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_10_218_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_218_19_218_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_19_218_21&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_218_22_218_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_22_218_24&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = let (</span><a name="loc_218_33_218_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_33_218_35&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">,</span><a name="loc_218_36_218_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_36_218_38&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> (</span><a href="#loc_218_10_218_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_10_218_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="hl_varref"><span class="mpre">baseChar</span></span></a><span class="mpre">) </span><a href="#loc_218_19_218_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_19_218_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> 
                           in </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a href="#loc_218_36_218_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_36_218_38&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_218_33_218_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_33_218_35&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_218_22_218_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_22_218_24&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">)
</span><a name="loc_220_1_220_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_10&#39;)"><span class="hl_fundecl"><span class="mpre">skipRight</span></span></a><span class="mpre"> </span><a name="loc_220_11_220_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_11_220_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_220_20_220_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_20_220_22&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_220_23_220_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_23_220_25&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = let (</span><a name="loc_220_34_220_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_34_220_36&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">,</span><a name="loc_220_37_220_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_37_220_39&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> (</span><a href="#loc_220_11_220_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_11_220_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="hl_varref"><span class="mpre">baseChar</span></span></a><span class="mpre">) </span><a href="#loc_220_23_220_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_23_220_25&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre"> 
                            in </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_220_34_220_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_34_220_36&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_220_20_220_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_20_220_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_220_37_220_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_37_220_39&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">

</span><a href="#loc_224_1_224_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_15&#39;)"><span class="mpre">transposeChars</span></a><span class="mpre"> :: </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre">
</span><a name="loc_224_1_224_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_15&#39;)"><span class="hl_fundecl"><span class="mpre">transposeChars</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a name="loc_224_24_224_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_24_224_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_224_26_224_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_26_224_28&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) (</span><a name="loc_224_31_224_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_31_224_32&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_224_33_224_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_33_224_35&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">)) = </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a href="#loc_224_24_224_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_24_224_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_224_31_224_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_31_224_32&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_224_26_224_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_26_224_28&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_224_33_224_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_33_224_35&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
</span><a href="#loc_224_1_224_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_15&#39;)"><span class="hl_fundecl"><span class="mpre">transposeChars</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a name="loc_225_24_225_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_24_225_25&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_225_26_225_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_26_225_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_225_28_225_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_28_225_30&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) []) = </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a href="#loc_225_26_225_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_26_225_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_225_24_225_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_24_225_25&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_225_28_225_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_28_225_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) []
</span><a href="#loc_224_1_224_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_15&#39;)"><span class="hl_fundecl"><span class="mpre">transposeChars</span></span></a><span class="mpre"> </span><a name="loc_226_16_226_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_16_226_18&#39;)"><span class="hl_vardecl"><span class="mpre">im</span></span></a><span class="mpre"> = </span><a href="#loc_226_16_226_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_16_226_18&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre">

</span><a href="#loc_229_1_229_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_16&#39;)"><span class="mpre">insertGraphemes</span></a><span class="mpre"> :: [</span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre">
</span><a name="loc_229_1_229_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_16&#39;)"><span class="hl_fundecl"><span class="mpre">insertGraphemes</span></span></a><span class="mpre"> </span><a name="loc_229_17_229_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_17_229_18&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_229_26_229_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_26_229_28&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_229_29_229_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_29_229_31&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_229_17_229_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_17_229_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_229_26_229_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_26_229_28&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_229_29_229_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_29_229_31&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- For the &#39;R&#39; command.</span></span><span class="mpre">
</span><a href="#loc_233_1_233_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_14&#39;)"><span class="mpre">replaceCharIM</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre">
</span><a name="loc_233_1_233_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_14&#39;)"><span class="hl_fundecl"><span class="mpre">replaceCharIM</span></span></a><span class="mpre"> </span><a name="loc_233_15_233_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_15_233_16&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_233_17_233_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_17_233_19&#39;)"><span class="hl_vardecl"><span class="mpre">im</span></span></a><span class="mpre">
    | </span><a href="#loc_104_1_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_16&#39;)"><span class="hl_varref"><span class="mpre">isCombiningChar</span></span></a><span class="mpre"> </span><a href="#loc_233_15_233_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_15_233_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> = case </span><a href="#loc_233_17_233_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_17_233_19&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre"> of
                    </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> [] [] -&gt; </span><a href="#loc_233_17_233_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_17_233_19&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre">
                    </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> [] (</span><a name="loc_236_31_236_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_31_236_32&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_236_33_236_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_33_236_35&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> [] (</span><a href="#loc_101_1_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_12&#39;)"><span class="hl_varref"><span class="mpre">addCombiner</span></span></a><span class="mpre"> </span><a href="#loc_236_31_236_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_31_236_32&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_233_15_233_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_15_233_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_236_33_236_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_33_236_35&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">)
                    </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a name="loc_237_28_237_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_28_237_29&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_237_30_237_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_30_237_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_237_34_237_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_34_237_36&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a href="#loc_101_1_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_12&#39;)"><span class="hl_varref"><span class="mpre">addCombiner</span></span></a><span class="mpre"> </span><a href="#loc_237_28_237_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_28_237_29&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_233_15_233_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_15_233_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_237_30_237_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_30_237_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_237_34_237_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_34_237_36&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = let </span><a name="loc_238_23_238_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_23_238_24&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_97_1_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_13&#39;)"><span class="hl_varref"><span class="mpre">baseGrapheme</span></span></a><span class="mpre"> </span><a href="#loc_233_15_233_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_15_233_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                  in case </span><a href="#loc_233_17_233_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_17_233_19&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre"> of
                    </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_240_27_240_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_27_240_29&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> [] -&gt; </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a href="#loc_238_23_238_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_23_238_24&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_240_27_240_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_27_240_29&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) []
                    </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_241_27_241_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_27_241_29&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_241_33_241_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_33_241_35&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a href="#loc_238_23_238_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_23_238_24&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_241_27_241_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_27_241_29&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_241_33_241_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_33_241_35&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Used by vi mode.  Considers the cursor to be located over some specific character.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The first list is reversed.</span></span><span class="mpre">
data </span><a name="loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tycondecl"><span class="mpre">CommandMode</span></span></a><span class="mpre"> = </span><a name="loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_condecl"><span class="mpre">CMode</span></span></a><span class="mpre"> [</span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">] </span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre"> [</span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">] | </span><a name="loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_condecl"><span class="mpre">CEmpty</span></span></a><span class="mpre">
                    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 247, srcSpanStartColumn = 21, srcSpanEndLine = 247, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 247, srcSpanStartColumn = 21, srcSpanEndLine = 247, srcSpanEndColumn = 29}]}) [IHead (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename "><span class="mpre">deriving Show</span></span><span class="mpre">

instance </span><a href="#loc_130_7_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_7_130_16&#39;)"><span class="hl_classref"><span class="mpre">LineState</span></span></a><span class="mpre"> </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre"> where
    </span><a href="#loc_131_5_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_17&#39;)"><span class="hl_fundecl"><span class="mpre">beforeCursor</span></span></a><span class="mpre"> </span><a name="loc_250_18_250_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_18_250_24&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><a href="#loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_conref"><span class="mpre">CEmpty</span></span></a><span class="mpre"> = </span><a href="#loc_250_18_250_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_18_250_24&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre">
    </span><a href="#loc_131_5_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_17&#39;)"><span class="hl_fundecl"><span class="mpre">beforeCursor</span></span></a><span class="mpre"> </span><a name="loc_251_18_251_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_18_251_24&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre"> (</span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a name="loc_251_32_251_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_32_251_34&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> _ _) = </span><a href="#loc_251_18_251_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_18_251_24&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_251_32_251_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_32_251_34&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="#loc_135_5_135_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_16&#39;)"><span class="hl_fundecl"><span class="mpre">afterCursor</span></span></a><span class="mpre"> </span><a href="#loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_conref"><span class="mpre">CEmpty</span></span></a><span class="mpre"> = []
    </span><a href="#loc_135_5_135_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_16&#39;)"><span class="hl_fundecl"><span class="mpre">afterCursor</span></span></a><span class="mpre"> (</span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> _ </span><a name="loc_253_26_253_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_26_253_27&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_253_28_253_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_28_253_30&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_253_26_253_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_26_253_27&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_253_28_253_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_28_253_30&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">

instance </span><a href="#loc_151_22_151_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_22_151_28&#39;)"><span class="hl_classref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre"> where
    </span><a href="#loc_152_5_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_5_152_13&#39;)"><span class="hl_fundecl"><span class="mpre">toResult</span></span></a><span class="mpre"> </span><a href="#loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_conref"><span class="mpre">CEmpty</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
    </span><a href="#loc_152_5_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_5_152_13&#39;)"><span class="hl_fundecl"><span class="mpre">toResult</span></span></a><span class="mpre"> (</span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a name="loc_257_21_257_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_21_257_23&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_257_24_257_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_24_257_25&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_257_26_257_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_26_257_28&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_126_1_126_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_18&#39;)"><span class="hl_varref"><span class="mpre">graphemesToString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_257_21_257_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_21_257_23&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><a href="#loc_257_24_257_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_24_257_25&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_257_26_257_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_26_257_28&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">)

instance </span><a href="#loc_154_22_154_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_22_154_26&#39;)"><span class="hl_classref"><span class="mpre">Save</span></span></a><span class="mpre"> </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre"> where
    </span><a href="#loc_155_5_155_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_5_155_9&#39;)"><span class="hl_vardecl"><span class="mpre">save</span></span></a><span class="mpre"> = </span><a href="#loc_309_1_309_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_22&#39;)"><span class="hl_varref"><span class="mpre">insertFromCommandMode</span></span></a><span class="mpre">
    </span><a href="#loc_156_5_156_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_5_156_12&#39;)"><span class="hl_vardecl"><span class="mpre">restore</span></span></a><span class="mpre"> = </span><a href="#loc_302_1_302_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_1_302_22&#39;)"><span class="hl_varref"><span class="mpre">enterCommandModeRight</span></span></a><span class="mpre">

instance </span><a href="#loc_164_7_164_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_7_164_11&#39;)"><span class="hl_classref"><span class="mpre">Move</span></span></a><span class="mpre"> </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre"> where
    </span><a href="#loc_165_5_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_11&#39;)"><span class="hl_fundecl"><span class="mpre">goLeft</span></span></a><span class="mpre"> (</span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> (</span><a name="loc_264_20_264_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_20_264_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_264_22_264_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_22_264_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_264_26_264_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_26_264_27&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_264_28_264_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_28_264_30&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a href="#loc_264_22_264_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_22_264_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_264_20_264_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_20_264_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><a href="#loc_264_26_264_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_26_264_27&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_264_28_264_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_28_264_30&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">)
    </span><a href="#loc_165_5_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_11&#39;)"><span class="hl_fundecl"><span class="mpre">goLeft</span></span></a><span class="mpre"> </span><a name="loc_265_12_265_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_12_265_14&#39;)"><span class="hl_vardecl"><span class="mpre">cm</span></span></a><span class="mpre"> = </span><a href="#loc_265_12_265_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_12_265_14&#39;)"><span class="hl_varref"><span class="mpre">cm</span></span></a><span class="mpre">

    </span><a href="#loc_165_13_165_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_13_165_20&#39;)"><span class="hl_fundecl"><span class="mpre">goRight</span></span></a><span class="mpre"> (</span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a name="loc_267_20_267_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_20_267_22&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_267_23_267_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_23_267_24&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a name="loc_267_26_267_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_26_267_27&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_267_28_267_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_28_267_30&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">)) = </span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> (</span><a href="#loc_267_23_267_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_23_267_24&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_267_20_267_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_20_267_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_267_26_267_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_26_267_27&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_267_28_267_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_28_267_30&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
    </span><a href="#loc_165_13_165_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_13_165_20&#39;)"><span class="hl_fundecl"><span class="mpre">goRight</span></span></a><span class="mpre"> </span><a name="loc_268_13_268_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_13_268_15&#39;)"><span class="hl_vardecl"><span class="mpre">cm</span></span></a><span class="mpre"> = </span><a href="#loc_268_13_268_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_13_268_15&#39;)"><span class="hl_varref"><span class="mpre">cm</span></span></a><span class="mpre">

    </span><a href="#loc_165_22_165_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_22_165_33&#39;)"><span class="hl_fundecl"><span class="mpre">moveToStart</span></span></a><span class="mpre"> (</span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a name="loc_270_24_270_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_24_270_26&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_270_27_270_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_27_270_28&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_270_29_270_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_29_270_31&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = let </span><a name="loc_270_39_270_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_39_270_41&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_270_24_270_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_24_270_26&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><a href="#loc_270_27_270_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_27_270_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_270_29_270_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_29_270_31&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">) in </span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> [] (</span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_270_39_270_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_39_270_41&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><a href="#loc_270_39_270_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_39_270_41&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">)
    </span><a href="#loc_165_22_165_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_22_165_33&#39;)"><span class="hl_fundecl"><span class="mpre">moveToStart</span></span></a><span class="mpre"> </span><a href="#loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_conref"><span class="mpre">CEmpty</span></span></a><span class="mpre"> = </span><a href="#loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_conref"><span class="mpre">CEmpty</span></span></a><span class="mpre">

    </span><a href="#loc_165_35_165_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_35_165_44&#39;)"><span class="hl_fundecl"><span class="mpre">moveToEnd</span></span></a><span class="mpre"> (</span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a name="loc_273_22_273_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_22_273_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_273_25_273_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_25_273_26&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_273_27_273_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_27_273_29&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = let </span><a name="loc_273_37_273_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_37_273_39&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_273_27_273_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_27_273_29&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><a href="#loc_273_25_273_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_25_273_26&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_273_22_273_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_22_273_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) in </span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><a href="#loc_273_37_273_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_37_273_39&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_273_37_273_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_37_273_39&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">) []
    </span><a href="#loc_165_35_165_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_35_165_44&#39;)"><span class="hl_fundecl"><span class="mpre">moveToEnd</span></span></a><span class="mpre"> </span><a href="#loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_conref"><span class="mpre">CEmpty</span></span></a><span class="mpre"> = </span><a href="#loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_conref"><span class="mpre">CEmpty</span></span></a><span class="mpre">

</span><a href="#loc_277_1_277_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_1_277_11&#39;)"><span class="mpre">deleteChar</span></a><span class="mpre"> :: </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre">
</span><a name="loc_277_1_277_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_1_277_11&#39;)"><span class="hl_fundecl"><span class="mpre">deleteChar</span></span></a><span class="mpre"> (</span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a name="loc_277_19_277_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_19_277_21&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> _ (</span><a name="loc_277_25_277_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_25_277_26&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_277_27_277_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_27_277_29&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">)) = </span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a href="#loc_277_19_277_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_19_277_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_277_25_277_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_25_277_26&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_277_27_277_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_27_277_29&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
</span><a href="#loc_277_1_277_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_1_277_11&#39;)"><span class="hl_fundecl"><span class="mpre">deleteChar</span></span></a><span class="mpre"> (</span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> (</span><a name="loc_278_20_278_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_20_278_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_278_22_278_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_22_278_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) _ []) = </span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a href="#loc_278_22_278_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_22_278_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_278_20_278_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_20_278_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> []
</span><a href="#loc_277_1_277_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_1_277_11&#39;)"><span class="hl_fundecl"><span class="mpre">deleteChar</span></span></a><span class="mpre"> _ = </span><a href="#loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_conref"><span class="mpre">CEmpty</span></span></a><span class="mpre">

</span><a href="#loc_282_1_282_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_12&#39;)"><span class="mpre">replaceChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre">
</span><a name="loc_282_1_282_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_12&#39;)"><span class="hl_fundecl"><span class="mpre">replaceChar</span></span></a><span class="mpre"> </span><a name="loc_282_13_282_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_13_282_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a name="loc_282_22_282_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_22_282_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_282_25_282_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_25_282_26&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_282_27_282_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_27_282_29&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_104_1_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_16&#39;)"><span class="hl_varref"><span class="mpre">isCombiningChar</span></span></a><span class="mpre"> </span><a href="#loc_282_13_282_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_13_282_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)   = </span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a href="#loc_282_22_282_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_22_282_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> (</span><a href="#loc_97_1_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_13&#39;)"><span class="hl_varref"><span class="mpre">baseGrapheme</span></span></a><span class="mpre"> </span><a href="#loc_282_13_282_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_13_282_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_282_27_282_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_27_282_29&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                 = </span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a href="#loc_282_22_282_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_22_282_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> (</span><a href="#loc_101_1_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_12&#39;)"><span class="hl_varref"><span class="mpre">addCombiner</span></span></a><span class="mpre"> </span><a href="#loc_282_25_282_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_25_282_26&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_282_13_282_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_13_282_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_282_27_282_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_27_282_29&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
</span><a href="#loc_282_1_282_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_12&#39;)"><span class="hl_fundecl"><span class="mpre">replaceChar</span></span></a><span class="mpre"> _ </span><a href="#loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_conref"><span class="mpre">CEmpty</span></span></a><span class="mpre"> = </span><a href="#loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_conref"><span class="mpre">CEmpty</span></span></a><span class="mpre">

</span><a href="#loc_288_1_288_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_1_288_21&#39;)"><span class="mpre">pasteGraphemesBefore</span></a><span class="mpre">, </span><a href="#loc_291_1_291_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_1_291_20&#39;)"><span class="mpre">pasteGraphemesAfter</span></a><span class="mpre"> :: [</span><a href="#loc_76_6_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_6_76_14&#39;)"><span class="hl_tyconref"><span class="mpre">Grapheme</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre">
</span><a name="loc_288_1_288_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_1_288_21&#39;)"><span class="hl_fundecl"><span class="mpre">pasteGraphemesBefore</span></span></a><span class="mpre"> [] = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><a href="#loc_288_1_288_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_1_288_21&#39;)"><span class="hl_fundecl"><span class="mpre">pasteGraphemesBefore</span></span></a><span class="mpre"> </span><a name="loc_289_22_289_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_22_289_23&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_298_1_298_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_1_298_17&#39;)"><span class="hl_varref"><span class="mpre">enterCommandMode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_229_1_229_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_16&#39;)"><span class="hl_varref"><span class="mpre">insertGraphemes</span></span></a><span class="mpre"> </span><a href="#loc_289_22_289_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_22_289_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_309_1_309_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_22&#39;)"><span class="hl_varref"><span class="mpre">insertFromCommandMode</span></span></a><span class="mpre">

</span><a name="loc_291_1_291_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_1_291_20&#39;)"><span class="hl_fundecl"><span class="mpre">pasteGraphemesAfter</span></span></a><span class="mpre"> [] = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><a href="#loc_291_1_291_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_1_291_20&#39;)"><span class="hl_fundecl"><span class="mpre">pasteGraphemesAfter</span></span></a><span class="mpre"> </span><a name="loc_292_21_292_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_21_292_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_298_1_298_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_1_298_17&#39;)"><span class="hl_varref"><span class="mpre">enterCommandMode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_229_1_229_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_16&#39;)"><span class="hl_varref"><span class="mpre">insertGraphemes</span></span></a><span class="mpre"> </span><a href="#loc_292_21_292_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_21_292_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_312_1_312_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_22&#39;)"><span class="hl_varref"><span class="mpre">appendFromCommandMode</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Transitioning between modes</span></span><span class="mpre">

</span><a href="#loc_298_1_298_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_1_298_17&#39;)"><span class="mpre">enterCommandMode</span></a><span class="mpre">, </span><a href="#loc_302_1_302_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_1_302_22&#39;)"><span class="mpre">enterCommandModeRight</span></a><span class="mpre"> :: </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre">
</span><a name="loc_298_1_298_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_1_298_17&#39;)"><span class="hl_fundecl"><span class="mpre">enterCommandMode</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a name="loc_298_26_298_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_26_298_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_298_28_298_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_28_298_30&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_298_32_298_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_32_298_34&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a href="#loc_298_28_298_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_28_298_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_298_26_298_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_26_298_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_298_32_298_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_32_298_34&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
</span><a href="#loc_298_1_298_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_1_298_17&#39;)"><span class="hl_fundecl"><span class="mpre">enterCommandMode</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> [] (</span><a name="loc_299_29_299_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_29_299_30&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_299_31_299_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_31_299_33&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">)) = </span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> [] </span><a href="#loc_299_29_299_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_29_299_30&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_299_31_299_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_31_299_33&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
</span><a href="#loc_298_1_298_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_1_298_17&#39;)"><span class="hl_fundecl"><span class="mpre">enterCommandMode</span></span></a><span class="mpre"> _ = </span><a href="#loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_conref"><span class="mpre">CEmpty</span></span></a><span class="mpre">

</span><a name="loc_302_1_302_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_1_302_22&#39;)"><span class="hl_fundecl"><span class="mpre">enterCommandModeRight</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_302_30_302_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_30_302_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> (</span><a name="loc_302_34_302_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_34_302_35&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_302_36_302_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_36_302_38&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">)) = </span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a href="#loc_302_30_302_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_30_302_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_302_34_302_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_34_302_35&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_302_36_302_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_36_302_38&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
</span><a href="#loc_302_1_302_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_1_302_22&#39;)"><span class="hl_fundecl"><span class="mpre">enterCommandModeRight</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a name="loc_303_31_303_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_31_303_32&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_303_33_303_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_33_303_35&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) []) = </span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a href="#loc_303_33_303_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_33_303_35&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_303_31_303_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_31_303_32&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> []
</span><a href="#loc_302_1_302_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_1_302_22&#39;)"><span class="hl_fundecl"><span class="mpre">enterCommandModeRight</span></span></a><span class="mpre"> _ = </span><a href="#loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_conref"><span class="mpre">CEmpty</span></span></a><span class="mpre">


</span><a href="#loc_309_1_309_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_22&#39;)"><span class="mpre">insertFromCommandMode</span></a><span class="mpre">, </span><a href="#loc_312_1_312_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_22&#39;)"><span class="mpre">appendFromCommandMode</span></a><span class="mpre"> :: </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre">

</span><a name="loc_309_1_309_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_22&#39;)"><span class="hl_fundecl"><span class="mpre">insertFromCommandMode</span></span></a><span class="mpre"> </span><a href="#loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_conref"><span class="mpre">CEmpty</span></span></a><span class="mpre"> = </span><a href="#loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="hl_varref"><span class="mpre">emptyIM</span></span></a><span class="mpre">
</span><a href="#loc_309_1_309_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_22&#39;)"><span class="hl_fundecl"><span class="mpre">insertFromCommandMode</span></span></a><span class="mpre"> (</span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a name="loc_310_30_310_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_30_310_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_310_33_310_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_33_310_34&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_310_35_310_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_35_310_37&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a href="#loc_310_30_310_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_30_310_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> (</span><a href="#loc_310_33_310_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_33_310_34&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_310_35_310_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_35_310_37&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">)

</span><a name="loc_312_1_312_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_22&#39;)"><span class="hl_fundecl"><span class="mpre">appendFromCommandMode</span></span></a><span class="mpre"> </span><a href="#loc_246_59_246_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_59_246_65&#39;)"><span class="hl_conref"><span class="mpre">CEmpty</span></span></a><span class="mpre"> = </span><a href="#loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="hl_varref"><span class="mpre">emptyIM</span></span></a><span class="mpre">
</span><a href="#loc_312_1_312_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_22&#39;)"><span class="hl_fundecl"><span class="mpre">appendFromCommandMode</span></span></a><span class="mpre"> (</span><a href="#loc_246_20_246_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_20_246_25&#39;)"><span class="hl_conref"><span class="mpre">CMode</span></span></a><span class="mpre"> </span><a name="loc_313_30_313_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_30_313_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_313_33_313_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_33_313_34&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_313_35_313_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_35_313_37&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a href="#loc_313_33_313_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_33_313_34&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_313_30_313_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_30_313_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_313_35_313_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_35_313_37&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">

</span><a href="#loc_316_1_316_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_16&#39;)"><span class="mpre">withCommandMode</span></a><span class="mpre"> :: (</span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre">
</span><a name="loc_316_1_316_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_16&#39;)"><span class="hl_fundecl"><span class="mpre">withCommandMode</span></span></a><span class="mpre"> </span><a name="loc_316_17_316_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_17_316_18&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_302_1_302_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_1_302_22&#39;)"><span class="hl_varref"><span class="mpre">enterCommandModeRight</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_316_17_316_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_17_316_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_309_1_309_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_22&#39;)"><span class="hl_varref"><span class="mpre">insertFromCommandMode</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Supplementary modes</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Used for commands which take an integer argument.</span></span><span class="mpre">
data </span><a name="loc_322_6_322_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_6_322_13&#39;)"><span class="hl_tycondecl"><span class="mpre">ArgMode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> = </span><a name="loc_322_18_322_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_18_322_25&#39;)"><span class="hl_condecl"><span class="mpre">ArgMode</span></span></a><span class="mpre"> {</span><a name="loc_322_27_322_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_27_322_30&#39;)"><span class="hl_fielddecl"><span class="mpre">arg</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><a name="loc_322_39_322_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_39_322_47&#39;)"><span class="hl_fielddecl"><span class="mpre">argState</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">}

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_322_6_322_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_6_322_13&#39;)"><span class="hl_tyconref"><span class="mpre">ArgMode</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">am</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 325, srcSpanStartColumn = 17, srcSpanEndLine = 325, srcSpanEndColumn = 48}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 325, srcSpanStartColumn = 20, srcSpanEndLine = 325, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskelin"><span class="mpre">am {argState = f (argState am)}</span></span><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 327, srcSpanStartColumn = 10, srcSpanEndLine = 327, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 327, srcSpanStartColumn = 22, srcSpanEndLine = 327, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename"><span class="mpre">LineState s =&gt;</span></span><span class="mpre"> </span><a href="#loc_130_7_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_7_130_16&#39;)"><span class="hl_classref"><span class="mpre">LineState</span></span></a><span class="mpre"> (</span><a href="#loc_322_6_322_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_6_322_13&#39;)"><span class="hl_tyconref"><span class="mpre">ArgMode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
    </span><a href="#loc_131_5_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_17&#39;)"><span class="hl_fundecl"><span class="mpre">beforeCursor</span></span></a><span class="mpre"> _ </span><a name="loc_328_20_328_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_20_328_22&#39;)"><span class="hl_vardecl"><span class="mpre">am</span></span></a><span class="mpre"> = let </span><a name="loc_328_29_328_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_29_328_32&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_97_1_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_13&#39;)"><span class="hl_varref"><span class="mpre">baseGrapheme</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;(arg: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_322_27_322_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_27_322_30&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre"> </span><a href="#loc_328_20_328_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_20_328_22&#39;)"><span class="hl_varref"><span class="mpre">am</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;) &quot;</span></span><span class="mpre">
                             in </span><a href="#loc_131_5_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_17&#39;)"><span class="hl_varref"><span class="mpre">beforeCursor</span></span></a><span class="mpre"> </span><a href="#loc_328_29_328_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_29_328_32&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> (</span><a href="#loc_322_39_322_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_39_322_47&#39;)"><span class="hl_varref"><span class="mpre">argState</span></span></a><span class="mpre"> </span><a href="#loc_328_20_328_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_20_328_22&#39;)"><span class="hl_varref"><span class="mpre">am</span></span></a><span class="mpre">) 
    </span><a href="#loc_135_5_135_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_16&#39;)"><span class="hl_vardecl"><span class="mpre">afterCursor</span></span></a><span class="mpre"> = </span><a href="#loc_135_5_135_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_16&#39;)"><span class="hl_varref"><span class="mpre">afterCursor</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_322_39_322_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_39_322_47&#39;)"><span class="hl_varref"><span class="mpre">argState</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 332, srcSpanStartColumn = 10, srcSpanEndLine = 332, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 332, srcSpanStartColumn = 19, srcSpanEndLine = 332, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename"><span class="mpre">Result s =&gt;</span></span><span class="mpre"> </span><a href="#loc_151_22_151_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_22_151_28&#39;)"><span class="hl_classref"><span class="mpre">Result</span></span></a><span class="mpre"> (</span><a href="#loc_322_6_322_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_6_322_13&#39;)"><span class="hl_tyconref"><span class="mpre">ArgMode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
    </span><a href="#loc_152_5_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_5_152_13&#39;)"><span class="hl_vardecl"><span class="mpre">toResult</span></span></a><span class="mpre"> = </span><a href="#loc_152_5_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_5_152_13&#39;)"><span class="hl_varref"><span class="mpre">toResult</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_322_39_322_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_39_322_47&#39;)"><span class="hl_varref"><span class="mpre">argState</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 335, srcSpanStartColumn = 10, srcSpanEndLine = 335, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 335, srcSpanStartColumn = 17, srcSpanEndLine = 335, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename"><span class="mpre">Save s =&gt;</span></span><span class="mpre"> </span><a href="#loc_154_22_154_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_22_154_26&#39;)"><span class="hl_classref"><span class="mpre">Save</span></span></a><span class="mpre"> (</span><a href="#loc_322_6_322_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_6_322_13&#39;)"><span class="hl_tyconref"><span class="mpre">ArgMode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
    </span><a href="#loc_155_5_155_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_5_155_9&#39;)"><span class="hl_vardecl"><span class="mpre">save</span></span></a><span class="mpre"> = </span><a href="#loc_155_5_155_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_5_155_9&#39;)"><span class="hl_varref"><span class="mpre">save</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_322_39_322_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_39_322_47&#39;)"><span class="hl_varref"><span class="mpre">argState</span></span></a><span class="mpre">
    </span><a href="#loc_156_5_156_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_5_156_12&#39;)"><span class="hl_vardecl"><span class="mpre">restore</span></span></a><span class="mpre"> = </span><a href="#loc_340_1_340_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_1_340_9&#39;)"><span class="hl_varref"><span class="mpre">startArg</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_156_5_156_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_5_156_12&#39;)"><span class="hl_varref"><span class="mpre">restore</span></span></a><span class="mpre">

</span><a href="#loc_340_1_340_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_1_340_9&#39;)"><span class="mpre">startArg</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><a href="#loc_322_6_322_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_6_322_13&#39;)"><span class="hl_tyconref"><span class="mpre">ArgMode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_340_1_340_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_1_340_9&#39;)"><span class="hl_vardecl"><span class="mpre">startArg</span></span></a><span class="mpre"> = </span><a href="#loc_322_18_322_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_18_322_25&#39;)"><span class="hl_conref"><span class="mpre">ArgMode</span></span></a><span class="mpre">

</span><a href="#loc_343_1_343_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_1_343_7&#39;)"><span class="mpre">addNum</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_322_6_322_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_6_322_13&#39;)"><span class="hl_tyconref"><span class="mpre">ArgMode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><a href="#loc_322_6_322_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_6_322_13&#39;)"><span class="hl_tyconref"><span class="mpre">ArgMode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_343_1_343_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_1_343_7&#39;)"><span class="hl_fundecl"><span class="mpre">addNum</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">n</span></span><span class="mpre"> </span><a name="loc_343_10_343_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_10_343_12&#39;)"><span class="hl_vardecl"><span class="mpre">am</span></span></a><span class="mpre">
    | </span><a href="#loc_322_27_322_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_27_322_30&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre"> </span><a href="#loc_343_10_343_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_10_343_12&#39;)"><span class="hl_varref"><span class="mpre">am</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1000</span></span><span class="mpre"> = </span><a href="#loc_343_10_343_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_10_343_12&#39;)"><span class="hl_varref"><span class="mpre">am</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- shouldn&#39;t ever need more than 4 digits</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 345, srcSpanStartColumn = 19, srcSpanEndLine = 345, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 345, srcSpanStartColumn = 22, srcSpanEndLine = 345, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskelin"><span class="mpre">am {arg = arg am * 10 + n}</span></span><span class="mpre"> 

</span><span class="hl_comment"><span class="mpre">-- todo: negatives</span></span><span class="mpre">
</span><a href="#loc_349_1_349_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_9&#39;)"><span class="mpre">applyArg</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><a href="#loc_322_6_322_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_6_322_13&#39;)"><span class="hl_tyconref"><span class="mpre">ArgMode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_349_1_349_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_9&#39;)"><span class="hl_fundecl"><span class="mpre">applyArg</span></span></a><span class="mpre"> </span><a name="loc_349_10_349_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_10_349_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_349_12_349_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_12_349_14&#39;)"><span class="hl_vardecl"><span class="mpre">am</span></span></a><span class="mpre"> = </span><a href="#loc_352_1_352_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_1_352_8&#39;)"><span class="hl_varref"><span class="mpre">repeatN</span></span></a><span class="mpre"> (</span><a href="#loc_322_27_322_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_27_322_30&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre"> </span><a href="#loc_349_12_349_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_12_349_14&#39;)"><span class="hl_varref"><span class="mpre">am</span></span></a><span class="mpre">) </span><a href="#loc_349_10_349_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_10_349_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_322_39_322_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_39_322_47&#39;)"><span class="hl_varref"><span class="mpre">argState</span></span></a><span class="mpre"> </span><a href="#loc_349_12_349_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_12_349_14&#39;)"><span class="hl_varref"><span class="mpre">am</span></span></a><span class="mpre">)

</span><a href="#loc_352_1_352_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_1_352_8&#39;)"><span class="mpre">repeatN</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_352_1_352_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_1_352_8&#39;)"><span class="hl_fundecl"><span class="mpre">repeatN</span></span></a><span class="mpre"> </span><a name="loc_352_9_352_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_9_352_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_352_11_352_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_11_352_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> | </span><a href="#loc_352_9_352_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_9_352_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><a href="#loc_352_11_352_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_11_352_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_352_11_352_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_11_352_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_352_1_352_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_1_352_8&#39;)"><span class="hl_varref"><span class="mpre">repeatN</span></span></a><span class="mpre"> (</span><a href="#loc_352_9_352_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_9_352_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_352_11_352_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_11_352_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><a href="#loc_356_1_356_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_12&#39;)"><span class="mpre">applyCmdArg</span></a><span class="mpre"> :: (</span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_322_6_322_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_6_322_13&#39;)"><span class="hl_tyconref"><span class="mpre">ArgMode</span></span></a><span class="mpre"> </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_246_6_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_6_246_17&#39;)"><span class="hl_tyconref"><span class="mpre">CommandMode</span></span></a><span class="mpre">
</span><a name="loc_356_1_356_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_12&#39;)"><span class="hl_fundecl"><span class="mpre">applyCmdArg</span></span></a><span class="mpre"> </span><a name="loc_356_13_356_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_13_356_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_356_15_356_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_15_356_17&#39;)"><span class="hl_vardecl"><span class="mpre">am</span></span></a><span class="mpre"> = </span><a href="#loc_316_1_316_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_16&#39;)"><span class="hl_varref"><span class="mpre">withCommandMode</span></span></a><span class="mpre"> (</span><a href="#loc_352_1_352_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_1_352_8&#39;)"><span class="hl_varref"><span class="mpre">repeatN</span></span></a><span class="mpre"> (</span><a href="#loc_322_27_322_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_27_322_30&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre"> </span><a href="#loc_356_15_356_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_15_356_17&#39;)"><span class="hl_varref"><span class="mpre">am</span></span></a><span class="mpre">) </span><a href="#loc_356_13_356_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_13_356_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) (</span><a href="#loc_322_39_322_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_39_322_47&#39;)"><span class="hl_varref"><span class="mpre">argState</span></span></a><span class="mpre"> </span><a href="#loc_356_15_356_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_15_356_17&#39;)"><span class="hl_varref"><span class="mpre">am</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">---------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- TODO: messageState param not needed anymore.</span></span><span class="mpre">
data </span><a name="loc_360_6_360_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_6_360_13&#39;)"><span class="hl_tycondecl"><span class="mpre">Message</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">Message</span></span><span class="mpre"> {</span><a name="loc_360_27_360_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_27_360_39&#39;)"><span class="hl_fielddecl"><span class="mpre">messageState</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">, </span><a name="loc_360_46_360_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_46_360_57&#39;)"><span class="hl_fielddecl"><span class="mpre">messageText</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">}

instance </span><a href="#loc_130_7_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_7_130_16&#39;)"><span class="hl_classref"><span class="mpre">LineState</span></span></a><span class="mpre"> (</span><a href="#loc_360_6_360_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_6_360_13&#39;)"><span class="hl_tyconref"><span class="mpre">Message</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
    </span><a href="#loc_131_5_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_17&#39;)"><span class="hl_fundecl"><span class="mpre">beforeCursor</span></span></a><span class="mpre"> _ = </span><a href="#loc_110_1_110_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_18&#39;)"><span class="hl_varref"><span class="mpre">stringToGraphemes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_360_46_360_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_46_360_57&#39;)"><span class="hl_varref"><span class="mpre">messageText</span></span></a><span class="mpre">
    </span><a href="#loc_135_5_135_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_16&#39;)"><span class="hl_fundecl"><span class="mpre">afterCursor</span></span></a><span class="mpre"> _ = []

</span><span class="hl_comment"><span class="mpre">----------------</span></span><span class="mpre">

data </span><a name="loc_368_6_368_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_6_368_14&#39;)"><span class="hl_tycondecl"><span class="mpre">Password</span></span></a><span class="mpre"> = </span><a name="loc_368_17_368_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_17_368_25&#39;)"><span class="hl_condecl"><span class="mpre">Password</span></span></a><span class="mpre"> {</span><a name="loc_368_27_368_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_27_368_40&#39;)"><span class="hl_fielddecl"><span class="mpre">passwordState</span></span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">], </span><span class="hl_comment"><span class="mpre">-- ^ reversed</span></span><span class="mpre">
                          </span><a name="loc_369_27_369_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_27_369_39&#39;)"><span class="hl_fielddecl"><span class="mpre">passwordChar</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">}

instance </span><a href="#loc_130_7_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_7_130_16&#39;)"><span class="hl_classref"><span class="mpre">LineState</span></span></a><span class="mpre"> </span><a href="#loc_368_6_368_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_6_368_14&#39;)"><span class="hl_tyconref"><span class="mpre">Password</span></span></a><span class="mpre"> where
    </span><a href="#loc_131_5_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_17&#39;)"><span class="hl_fundecl"><span class="mpre">beforeCursor</span></span></a><span class="mpre"> </span><a name="loc_372_18_372_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_18_372_24&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><a name="loc_372_25_372_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_25_372_26&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">
        = </span><a href="#loc_372_18_372_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_18_372_24&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><a href="#loc_110_1_110_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_18&#39;)"><span class="hl_varref"><span class="mpre">stringToGraphemes</span></span></a><span class="mpre">
                      </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> case </span><a href="#loc_369_27_369_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_27_369_39&#39;)"><span class="hl_varref"><span class="mpre">passwordChar</span></span></a><span class="mpre"> </span><a href="#loc_372_25_372_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_25_372_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> of
                        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; []
                        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_376_30_376_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_30_376_31&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_368_27_368_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_27_368_40&#39;)"><span class="hl_varref"><span class="mpre">passwordState</span></span></a><span class="mpre"> </span><a href="#loc_372_25_372_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_25_372_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><a href="#loc_376_30_376_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_30_376_31&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)
    </span><a href="#loc_135_5_135_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_16&#39;)"><span class="hl_fundecl"><span class="mpre">afterCursor</span></span></a><span class="mpre"> _ = []

instance </span><a href="#loc_151_22_151_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_22_151_28&#39;)"><span class="hl_classref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a href="#loc_368_6_368_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_6_368_14&#39;)"><span class="hl_tyconref"><span class="mpre">Password</span></span></a><span class="mpre"> where
    </span><a href="#loc_152_5_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_5_152_13&#39;)"><span class="hl_vardecl"><span class="mpre">toResult</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_368_27_368_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_27_368_40&#39;)"><span class="hl_varref"><span class="mpre">passwordState</span></span></a><span class="mpre">

</span><a href="#loc_383_1_383_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_1_383_16&#39;)"><span class="mpre">addPasswordChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="#loc_368_6_368_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_6_368_14&#39;)"><span class="hl_tyconref"><span class="mpre">Password</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_368_6_368_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_6_368_14&#39;)"><span class="hl_tyconref"><span class="mpre">Password</span></span></a><span class="mpre">
</span><a name="loc_383_1_383_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_1_383_16&#39;)"><span class="hl_fundecl"><span class="mpre">addPasswordChar</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">c</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 383, srcSpanStartColumn = 23, srcSpanEndLine = 383, srcSpanEndColumn = 62}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/LineState.hs&quot;, srcSpanStartLine = 383, srcSpanStartColumn = 25, srcSpanEndLine = 383, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskelin"><span class="mpre">p {passwordState = c : passwordState p}</span></span><span class="mpre">

</span><a href="#loc_386_1_386_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_1_386_19&#39;)"><span class="mpre">deletePasswordChar</span></a><span class="mpre"> :: </span><a href="#loc_368_6_368_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_6_368_14&#39;)"><span class="hl_tyconref"><span class="mpre">Password</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_368_6_368_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_6_368_14&#39;)"><span class="hl_tyconref"><span class="mpre">Password</span></span></a><span class="mpre">
</span><a name="loc_386_1_386_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_1_386_19&#39;)"><span class="hl_fundecl"><span class="mpre">deletePasswordChar</span></span></a><span class="mpre"> (</span><a href="#loc_368_17_368_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_17_368_25&#39;)"><span class="hl_conref"><span class="mpre">Password</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_386_33_386_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_33_386_35&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) </span><a name="loc_386_37_386_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_37_386_38&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) = </span><a href="#loc_368_17_368_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_17_368_25&#39;)"><span class="hl_conref"><span class="mpre">Password</span></span></a><span class="mpre"> </span><a href="#loc_386_33_386_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_33_386_35&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> </span><a href="#loc_386_37_386_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_37_386_38&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
</span><a href="#loc_386_1_386_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_1_386_19&#39;)"><span class="hl_fundecl"><span class="mpre">deletePasswordChar</span></span></a><span class="mpre"> </span><a name="loc_387_20_387_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_20_387_21&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_387_20_387_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_20_387_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-----------------</span></span><span class="mpre">
</span><a href="#loc_391_1_391_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_1_391_8&#39;)"><span class="mpre">atStart</span></a><span class="mpre">, </span><a href="#loc_394_1_394_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_6&#39;)"><span class="mpre">atEnd</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_391_1_391_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_1_391_8&#39;)"><span class="hl_fundecl"><span class="mpre">atStart</span></span></a><span class="mpre"> </span><a name="loc_391_9_391_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_9_391_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a name="loc_391_19_391_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_19_391_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) (</span><a name="loc_391_25_391_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_25_391_26&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)) = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_391_9_391_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_9_391_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="hl_varref"><span class="mpre">baseChar</span></span></a><span class="mpre"> </span><a href="#loc_391_19_391_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_19_391_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_391_9_391_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_9_391_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="hl_varref"><span class="mpre">baseChar</span></span></a><span class="mpre"> </span><a href="#loc_391_25_391_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_25_391_26&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
</span><a href="#loc_391_1_391_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_1_391_8&#39;)"><span class="hl_fundecl"><span class="mpre">atStart</span></span></a><span class="mpre"> _ _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><a name="loc_394_1_394_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_6&#39;)"><span class="hl_fundecl"><span class="mpre">atEnd</span></span></a><span class="mpre"> </span><a name="loc_394_7_394_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_7_394_8&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> _ (</span><a name="loc_394_19_394_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_19_394_21&#39;)"><span class="hl_vardecl"><span class="mpre">y1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_394_22_394_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_22_394_24&#39;)"><span class="hl_vardecl"><span class="mpre">y2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)) = </span><a href="#loc_394_7_394_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_7_394_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="hl_varref"><span class="mpre">baseChar</span></span></a><span class="mpre"> </span><a href="#loc_394_19_394_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_19_394_21&#39;)"><span class="hl_varref"><span class="mpre">y1</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_394_7_394_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_7_394_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="hl_varref"><span class="mpre">baseChar</span></span></a><span class="mpre"> </span><a href="#loc_394_22_394_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_22_394_24&#39;)"><span class="hl_varref"><span class="mpre">y2</span></span></a><span class="mpre">))
</span><a href="#loc_394_1_394_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_6&#39;)"><span class="hl_fundecl"><span class="mpre">atEnd</span></span></a><span class="mpre"> _ _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><a href="#loc_398_1_398_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_1_398_9&#39;)"><span class="mpre">overChar</span></a><span class="mpre">, </span><a href="#loc_401_1_401_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_1_401_11&#39;)"><span class="mpre">beforeChar</span></a><span class="mpre">, </span><a href="#loc_404_1_404_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_1_404_10&#39;)"><span class="mpre">afterChar</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_398_1_398_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_1_398_9&#39;)"><span class="hl_fundecl"><span class="mpre">overChar</span></span></a><span class="mpre"> </span><a name="loc_398_10_398_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_10_398_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> _ (</span><a name="loc_398_22_398_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_22_398_23&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)) = </span><a href="#loc_398_10_398_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_10_398_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="hl_varref"><span class="mpre">baseChar</span></span></a><span class="mpre"> </span><a href="#loc_398_22_398_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_22_398_23&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
</span><a href="#loc_398_1_398_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_1_398_9&#39;)"><span class="hl_fundecl"><span class="mpre">overChar</span></span></a><span class="mpre"> _ _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><a name="loc_401_1_401_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_1_401_11&#39;)"><span class="hl_fundecl"><span class="mpre">beforeChar</span></span></a><span class="mpre"> </span><a name="loc_401_12_401_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_12_401_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> _ (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_401_26_401_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_26_401_27&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)) = </span><a href="#loc_401_12_401_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_12_401_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="hl_varref"><span class="mpre">baseChar</span></span></a><span class="mpre"> </span><a href="#loc_401_26_401_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_26_401_27&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
</span><a href="#loc_401_1_401_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_1_401_11&#39;)"><span class="hl_fundecl"><span class="mpre">beforeChar</span></span></a><span class="mpre"> _ _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><a name="loc_404_1_404_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_1_404_10&#39;)"><span class="hl_fundecl"><span class="mpre">afterChar</span></span></a><span class="mpre"> </span><a name="loc_404_11_404_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_11_404_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> (</span><a name="loc_404_21_404_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_21_404_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) _) = </span><a href="#loc_404_11_404_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_11_404_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_84_1_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_9&#39;)"><span class="hl_varref"><span class="mpre">baseChar</span></span></a><span class="mpre"> </span><a href="#loc_404_21_404_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_21_404_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
</span><a href="#loc_404_1_404_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_1_404_10&#39;)"><span class="hl_fundecl"><span class="mpre">afterChar</span></span></a><span class="mpre"> _ _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><a href="#loc_408_1_408_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_408_1_408_13&#39;)"><span class="mpre">goRightUntil</span></a><span class="mpre">, </span><a href="#loc_412_1_412_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_1_412_12&#39;)"><span class="mpre">goLeftUntil</span></a><span class="mpre"> :: (</span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre">
</span><a name="loc_408_1_408_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_408_1_408_13&#39;)"><span class="hl_fundecl"><span class="mpre">goRightUntil</span></span></a><span class="mpre"> </span><a name="loc_408_14_408_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_408_14_408_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_410_9_410_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_9_410_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_165_13_165_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_13_165_20&#39;)"><span class="hl_varref"><span class="mpre">goRight</span></span></a><span class="mpre">
    where
        </span><a name="loc_410_9_410_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_9_410_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_410_14_410_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_14_410_16&#39;)"><span class="hl_specname"><span class="mpre">im</span></span></a><span class="mpre">@(</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> _ </span><a name="loc_410_26_410_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_26_410_28&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_410_26_410_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_26_410_28&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_408_14_408_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_408_14_408_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_410_14_410_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_14_410_16&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre">  = </span><a href="#loc_410_14_410_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_14_410_16&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre">
                             | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_410_9_410_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_9_410_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_165_13_165_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_13_165_20&#39;)"><span class="hl_varref"><span class="mpre">goRight</span></span></a><span class="mpre"> </span><a href="#loc_410_14_410_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_14_410_16&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre">)
</span><a name="loc_412_1_412_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_1_412_12&#39;)"><span class="hl_fundecl"><span class="mpre">goLeftUntil</span></span></a><span class="mpre"> </span><a name="loc_412_13_412_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_13_412_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_414_9_414_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_9_414_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_165_5_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_11&#39;)"><span class="hl_varref"><span class="mpre">goLeft</span></span></a><span class="mpre">
    where
        </span><a name="loc_414_9_414_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_9_414_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_414_14_414_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_14_414_16&#39;)"><span class="hl_specname"><span class="mpre">im</span></span></a><span class="mpre">@(</span><a href="#loc_169_19_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_24&#39;)"><span class="hl_conref"><span class="mpre">IMode</span></span></a><span class="mpre"> </span><a name="loc_414_24_414_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_24_414_26&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> _)   | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_414_24_414_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_24_414_26&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_412_13_412_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_13_412_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_414_14_414_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_14_414_16&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre"> = </span><a href="#loc_414_14_414_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_14_414_16&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre">
                            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_414_9_414_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_9_414_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_165_5_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_11&#39;)"><span class="hl_varref"><span class="mpre">goLeft</span></span></a><span class="mpre"> </span><a href="#loc_414_14_414_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_14_414_16&#39;)"><span class="hl_varref"><span class="mpre">im</span></span></a><span class="mpre">)

</span></div></body></html>