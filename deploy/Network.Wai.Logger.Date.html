<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, OverloadedStrings #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Formatting time is slow.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This package provides mechanisms to cache formatted date.</span></span><span class="mpre">
module Network.Wai.Logger.Date (
  </span><span class="hl_comment"><span class="mpre">-- * Types</span></span><span class="mpre">
    DateCacheGetter
  , DateCacheUpdater
  , ZonedDate
  </span><span class="hl_comment"><span class="mpre">-- * Cache configuration</span></span><span class="mpre">
  , DateCacheConf(..)
  , zonedDateCacheConf
  </span><span class="hl_comment"><span class="mpre">-- * Date cacher</span></span><span class="mpre">
  , clockDateCacher
  ) where

import Control.Applicative (</span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 8, srcSpanEndLine = 19, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import Data.IORef (</span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="mpre">newIORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="mpre">readIORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="mpre">writeIORef</span></a><span class="mpre">)
#if WINDOWS
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 18, srcSpanEndLine = 22, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as BS
import Data.Time
import System.Locale
#else
import Data.UnixTime (</span><a href="Data.UnixTime.Conv.html#loc_69_1_69_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Conv.html#loc_69_1_69_15&#39;)"><span class="mpre">formatUnixTime</span></a><span class="mpre">, </span><a href="Data.UnixTime.Conv.html#loc_125_1_125_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.UnixTime.Conv.html#loc_125_1_125_14&#39;)"><span class="mpre">fromEpochTime</span></a><span class="mpre">)
import System.Posix (EpochTime, epochTime)
#endif

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Getting cached &#39;ZonedDate&#39;.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 1, srcSpanEndLine = 33, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 1, srcSpanEndLine = 33, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date"><span class="mpre">type DateCacheGetter = IO ZonedDate</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Updateing cached &#39;ZonedDate&#39;. This should be called every second.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   See the source code of &#39;withStdoutLogger&#39;.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 1, srcSpanEndLine = 36, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 1, srcSpanEndLine = 36, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date"><span class="mpre">type DateCacheUpdater = IO ()</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A type for zoned date.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 1, srcSpanEndLine = 41, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 1, srcSpanEndLine = 41, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date"><span class="mpre">type ZonedDate = ByteString</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

data </span><a name="loc_45_6_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_6_45_19&#39;)"><span class="hl_tycondecl"><span class="mpre">DateCacheConf</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">DateCacheConf</span></span><span class="mpre"> {
    </span><span class="hl_comment"><span class="mpre">-- | A function to get a time. E.g &#39;epochTime&#39; and &#39;getCurrentTime&#39;.</span></span><span class="mpre">
    </span><a name="loc_47_5_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_12&#39;)"><span class="hl_fielddecl"><span class="mpre">getTime</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | A function to format a time.</span></span><span class="mpre">
  , </span><a name="loc_49_5_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_15&#39;)"><span class="hl_fielddecl"><span class="mpre">formatDate</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
  }

#if WINDOWS
</span><span class="hl_comment"><span class="mpre">-- | Zoned date cacher using UTC.</span></span><span class="mpre">
</span><a href="#loc_55_1_55_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_19&#39;)"><span class="mpre">zonedDateCacheConf</span></a><span class="mpre"> :: </span><a href="#loc_45_6_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_6_45_19&#39;)"><span class="hl_tyconref"><span class="mpre">DateCacheConf</span></span></a><span class="mpre"> </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">
</span><a name="loc_55_1_55_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_19&#39;)"><span class="hl_vardecl"><span class="mpre">zonedDateCacheConf</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 22, srcSpanEndLine = 60, srcSpanEndColumn = 4}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 36, srcSpanEndLine = 55, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/D"><span class="mpre">DateCacheConf {
    getTime = getCurrentTime
  , formatDate = \ut -&gt; do
      zt &lt;- utcToLocalZonedTime ut
      return $ BS.pack $ formatTime defaultTimeLocale &quot;%d/%b/%Y:%T %z&quot; zt
  }</span></span><span class="mpre">
#else
</span><span class="hl_comment"><span class="mpre">-- | Zoned date cacher using UnixTime.</span></span><span class="mpre">
</span><a href="#loc_55_1_55_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_19&#39;)"><span class="mpre">zonedDateCacheConf</span></a><span class="mpre"> :: </span><a href="#loc_45_6_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_6_45_19&#39;)"><span class="hl_tyconref"><span class="mpre">DateCacheConf</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">EpochTime</span></span><span class="mpre">
</span><span class="hl_vardecl"><span class="mpre">zonedDateCacheConf</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 22, srcSpanEndLine = 67, srcSpanEndColumn = 4}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 36, srcSpanEndLine = 64, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/D"><span class="mpre">DateCacheConf {
    getTime = epochTime
  , formatDate = formatUnixTime &quot;%d/%b/%Y:%T %z&quot; . fromEpochTime
  }</span></span><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

data </span><a name="loc_72_6_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_6_72_15&#39;)"><span class="hl_tycondecl"><span class="mpre">DateCache</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> = </span><a name="loc_72_20_72_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_20_72_29&#39;)"><span class="hl_condecl"><span class="mpre">DateCache</span></span></a><span class="mpre"> {
    </span><span class="hl_fielddecl"><span class="mpre">timeKey</span></span><span class="mpre"> :: !</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">
  , </span><a name="loc_74_5_74_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_18&#39;)"><span class="hl_fielddecl"><span class="mpre">formattedDate</span></span></a><span class="mpre"> :: !</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
  } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 5, srcSpanEndLine = 75, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 5, srcSpanEndLine = 75, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Dat"><span class="mpre">deriving (Eq, Show)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_80_1_80_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_8&#39;)"><span class="mpre">newDate</span></a><span class="mpre"> :: </span><a href="#loc_45_6_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_6_45_19&#39;)"><span class="hl_tyconref"><span class="mpre">DateCacheConf</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_72_6_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_6_72_15&#39;)"><span class="hl_tyconref"><span class="mpre">DateCache</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">)
</span><a name="loc_80_1_80_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_8&#39;)"><span class="hl_fundecl"><span class="mpre">newDate</span></span></a><span class="mpre"> </span><a name="loc_80_9_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_16&#39;)"><span class="hl_vardecl"><span class="mpre">setting</span></span></a><span class="mpre"> </span><a name="loc_80_17_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_17_80_19&#39;)"><span class="hl_vardecl"><span class="mpre">tm</span></span></a><span class="mpre"> = </span><a href="#loc_72_20_72_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_20_72_29&#39;)"><span class="hl_conref"><span class="mpre">DateCache</span></span></a><span class="mpre"> </span><a href="#loc_80_17_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_17_80_19&#39;)"><span class="hl_varref"><span class="mpre">tm</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_49_5_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_15&#39;)"><span class="hl_varref"><span class="mpre">formatDate</span></span></a><span class="mpre"> </span><a href="#loc_80_9_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_16&#39;)"><span class="hl_varref"><span class="mpre">setting</span></span></a><span class="mpre"> </span><a href="#loc_80_17_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_17_80_19&#39;)"><span class="hl_varref"><span class="mpre">tm</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Returning &#39;DateCacheGetter&#39; and &#39;DateCacheUpdater&#39;.</span></span><span class="mpre">

</span><a href="#loc_86_1_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_16&#39;)"><span class="mpre">clockDateCacher</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">DateCacheGetter</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">DateCacheUpdater</span></span><span class="mpre">)
</span><a name="loc_86_1_86_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_16&#39;)"><span class="hl_vardecl"><span class="mpre">clockDateCacher</span></span></a><span class="mpre"> = do
    </span><a name="loc_87_5_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_8&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_47_5_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_12&#39;)"><span class="hl_varref"><span class="mpre">getTime</span></span></a><span class="mpre"> </span><a href="#loc_55_1_55_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_19&#39;)"><span class="hl_varref"><span class="mpre">zonedDateCacheConf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_80_1_80_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_8&#39;)"><span class="hl_varref"><span class="mpre">newDate</span></span></a><span class="mpre"> </span><a href="#loc_55_1_55_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_19&#39;)"><span class="hl_varref"><span class="mpre">zonedDateCacheConf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_90_5_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_5_90_11&#39;)"><span class="hl_varref"><span class="mpre">getter</span></span></a><span class="mpre"> </span><a href="#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">, </span><a href="#loc_91_5_91_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_5_91_10&#39;)"><span class="hl_varref"><span class="mpre">clock</span></span></a><span class="mpre"> </span><a href="#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">)
  where
    </span><a name="loc_90_5_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_5_90_11&#39;)"><span class="hl_fundecl"><span class="mpre">getter</span></span></a><span class="mpre"> </span><a name="loc_90_12_90_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_12_90_15&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> = </span><a href="#loc_74_5_74_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_18&#39;)"><span class="hl_varref"><span class="mpre">formattedDate</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_90_12_90_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_12_90_15&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
    </span><a name="loc_91_5_91_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_5_91_10&#39;)"><span class="hl_fundecl"><span class="mpre">clock</span></span></a><span class="mpre"> </span><a name="loc_91_11_91_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_14&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> = do
        </span><a name="loc_92_9_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_11&#39;)"><span class="hl_vardecl"><span class="mpre">tm</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_47_5_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_12&#39;)"><span class="hl_varref"><span class="mpre">getTime</span></span></a><span class="mpre"> </span><a href="#loc_55_1_55_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_19&#39;)"><span class="hl_varref"><span class="mpre">zonedDateCacheConf</span></span></a><span class="mpre">
        </span><span class="hl_vardecl"><span class="mpre">date</span></span><span class="mpre"> &lt;- </span><a href="#loc_49_5_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_15&#39;)"><span class="hl_varref"><span class="mpre">formatDate</span></span></a><span class="mpre"> </span><a href="#loc_55_1_55_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_19&#39;)"><span class="hl_varref"><span class="mpre">zonedDateCacheConf</span></span></a><span class="mpre"> </span><a href="#loc_92_9_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_9_92_11&#39;)"><span class="hl_varref"><span class="mpre">tm</span></span></a><span class="mpre">
        let </span><a name="loc_94_13_94_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_16&#39;)"><span class="hl_vardecl"><span class="mpre">new</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 94, srcSpanStartColumn = 19, srcSpanEndLine = 97, srcSpanEndColumn = 16}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/Date.hs&quot;, srcSpanStartLine = 94, srcSpanStartColumn = 29, srcSpanEndLine = 94, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-logger-2.1.1/Network/Wai/Logger/"><span class="mpre">DateCache {
                timeKey = tm
              , formattedDate = date
              }</span></span><span class="mpre">
        </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_91_11_91_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_14&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_94_13_94_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_16&#39;)"><span class="hl_varref"><span class="mpre">new</span></span></a><span class="mpre">
</span></div></body></html>