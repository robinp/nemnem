<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Distribution.ParseUtils</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The University of Glasgow 2004</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  cabal-devel@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Utilities for parsing &#39;PackageDescription&#39; and &#39;InstalledPackageInfo&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The @.cabal@ file format is not trivial, especially with the introduction</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of configurations and the section syntax that goes with that. This module</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- has a bunch of parsing functions that is used by the @.cabal@ parser and a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- couple others. It has the parsing framework code and also little parsers for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- many of the formats we get in various @.cabal@ file fields, like module</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- names, comma separated lists etc.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.

    * Redistributions in binary form must reproduce the above
      copyright notice, this list of conditions and the following
      disclaimer in the documentation and/or other materials provided
      with the distribution.

    * Neither the name of the University nor the names of other
      contributors may be used to endorse or promote products derived
      from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
&quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. -}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- This module is meant to be local-only to Distribution...</span></span><span class="mpre">

{-# OPTIONS_HADDOCK hide #-}
module Distribution.ParseUtils (
        LineNo, PError(..), PWarning(..), locatedErrorMsg, syntaxError, warning,
        runP, runE, ParseResult(..), catchParseError, parseFail, showPWarning,
        Field(..), fName, lineNo,
        FieldDescr(..), ppField, ppFields, readFields, readFieldsFlat,
        showFields, showSingleNamedField, showSimpleSingleNamedField,
        parseFields, parseFieldsFlat,
        parseFilePathQ, parseTokenQ, parseTokenQ&#39;,
        parseModuleNameQ, parseBuildTool, parsePkgconfigDependency,
        parseOptVersion, parsePackageNameQ, parseVersionRangeQ,
        parseTestedWithQ, parseLicenseQ, parseLanguageQ, parseExtensionQ,
        parseSepList, parseCommaList, parseOptCommaList,
        showFilePath, showToken, showTestedWith, showFreeText, parseFreeText,
        field, simpleField, listField, spaceListField, commaListField,
        optsField, liftField, boolField, parseQuoted,

        UnrecFieldParser, warnUnrec, ignoreUnrec,
  ) where

import Distribution.Compiler (</span><a href="Distribution.Compiler.html#loc_81_6_81_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compiler.html#loc_81_6_81_20&#39;)"><span class="mpre">CompilerFlavor</span></a><span class="mpre">, </span><a href="Distribution.Compiler.html#loc_119_1_119_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compiler.html#loc_119_1_119_26&#39;)"><span class="mpre">parseCompilerFlavorCompat</span></a><span class="mpre">)
import Distribution.License
import Distribution.Version
         ( </span><a href="Data.Version.html#loc_68_6_68_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Version.html#loc_68_6_68_13&#39;)"><span class="mpre">Version</span></a><span class="mpre">(..), </span><a href="Distribution.Version.html#loc_113_6_113_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Version.html#loc_113_6_113_18&#39;)"><span class="mpre">VersionRange</span></a><span class="mpre">, </span><a href="Distribution.Version.html#loc_143_1_143_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Version.html#loc_143_1_143_11&#39;)"><span class="mpre">anyVersion</span></a><span class="mpre"> )
import Distribution.Package     ( </span><a href="Distribution.Package.html#loc_80_9_80_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_80_9_80_20&#39;)"><span class="mpre">PackageName</span></a><span class="mpre">(..), </span><a href="Distribution.Package.html#loc_145_6_145_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_145_6_145_16&#39;)"><span class="mpre">Dependency</span></a><span class="mpre">(..) )
import Distribution.ModuleName (</span><a href="Distribution.ModuleName.html#loc_67_9_67_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.ModuleName.html#loc_67_9_67_19&#39;)"><span class="mpre">ModuleName</span></a><span class="mpre">)
import Distribution.Compat.ReadP as ReadP hiding (</span><a href="Distribution.Compat.ReadP.html#loc_187_1_187_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_187_1_187_4&#39;)"><span class="mpre">get</span></a><span class="mpre">)
import Distribution.ReadE
import Distribution.Text
         ( </span><a href="Distribution.Text.html#loc_26_7_26_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_26_7_26_11&#39;)"><span class="mpre">Text</span></a><span class="mpre">(..) )
import Distribution.Simple.Utils
         ( </span><a href="Distribution.Simple.Utils.html#loc_1277_1_1277_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_1277_1_1277_10&#39;)"><span class="mpre">comparing</span></a><span class="mpre">, </span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="mpre">intercalate</span></a><span class="mpre">, </span><a href="Distribution.Simple.Utils.html#loc_1283_1_1283_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_1283_1_1283_10&#39;)"><span class="mpre">lowercase</span></a><span class="mpre">, </span><a href="Distribution.Simple.Utils.html#loc_1264_1_1264_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_1264_1_1264_21&#39;)"><span class="mpre">normaliseLineEndings</span></a><span class="mpre"> )
import Language.Haskell.Extension
         ( </span><a href="Language.Haskell.Extension.html#loc_69_6_69_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.Extension.html#loc_69_6_69_14&#39;)"><span class="mpre">Language</span></a><span class="mpre">, </span><a href="Language.Haskell.Extension.html#loc_118_6_118_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.Extension.html#loc_118_6_118_15&#39;)"><span class="mpre">Extension</span></a><span class="mpre"> )

import Text.PrettyPrint hiding (</span><a href="Text.PrettyPrint.HughesPJ.html#loc_366_1_366_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_366_1_366_7&#39;)"><span class="mpre">braces</span></a><span class="mpre">)
import Data.Char (</span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="mpre">isSpace</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="mpre">toLower</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_136_1_136_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_136_1_136_11&#39;)"><span class="mpre">isAlphaNum</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_103_1_103_8&#39;)"><span class="mpre">isDigit</span></a><span class="mpre">)
import Data.Maybe       (</span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="mpre">fromMaybe</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 8, srcSpanEndLine = 88, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Tree&quot;"><span class="mpre">Data.Tree</span></span><span class="mpre"> as Tree (Tree(..), flatten)
import qualified Data.Map as Map
import Control.Monad (</span><a href="Control.Monad.html#loc_240_1_240_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_240_1_240_6&#39;)"><span class="mpre">foldM</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="mpre">ap</span></a><span class="mpre">) 
import Control.Applicative (</span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="mpre">Applicative</span></a><span class="mpre">(..))
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 8, srcSpanEndLine = 92, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;System.FilePath&quot;"><span class="mpre">System.FilePath</span></span><span class="mpre"> (normalise)
import Data.List (</span><a href="Data.List.html#loc_810_1_810_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_810_1_810_7&#39;)"><span class="mpre">sortBy</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- -----------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 1, srcSpanEndLine = 97, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 1, srcSpanEndLine = 97, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, "><span class="mpre">type LineNo = Int</span></span><span class="mpre">

data </span><a name="loc_99_6_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_6_99_12&#39;)"><span class="hl_tycondecl"><span class="mpre">PError</span></span></a><span class="mpre"> = </span><a name="loc_99_15_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_29&#39;)"><span class="hl_condecl"><span class="mpre">AmbiguousParse</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre">
            | </span><a name="loc_100_15_100_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_15_100_22&#39;)"><span class="hl_condecl"><span class="mpre">NoParse</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre">
            | </span><a name="loc_101_15_101_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_15_101_24&#39;)"><span class="hl_condecl"><span class="mpre">TabsError</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre">
            | </span><a name="loc_102_15_102_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_15_102_25&#39;)"><span class="hl_condecl"><span class="mpre">FromString</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre">)
        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 103, srcSpanStartColumn = 9, srcSpanEndLine = 103, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 103, srcSpanStartColumn = 9, srcSpanEndLine = 103, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils."><span class="mpre">deriving (Eq, Show)</span></span><span class="mpre">

data </span><a name="loc_105_6_105_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_6_105_14&#39;)"><span class="hl_tycondecl"><span class="mpre">PWarning</span></span></a><span class="mpre"> = </span><a name="loc_105_17_105_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_25&#39;)"><span class="hl_condecl"><span class="mpre">PWarning</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
              | </span><a name="loc_106_17_106_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_17_106_27&#39;)"><span class="hl_condecl"><span class="mpre">UTFWarning</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 9, srcSpanEndLine = 107, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 9, srcSpanEndLine = 107, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils."><span class="mpre">deriving (Eq, Show)</span></span><span class="mpre">

</span><a href="#loc_110_1_110_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_13&#39;)"><span class="mpre">showPWarning</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="#loc_105_6_105_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_6_105_14&#39;)"><span class="hl_tyconref"><span class="mpre">PWarning</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_110_1_110_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_13&#39;)"><span class="hl_fundecl"><span class="mpre">showPWarning</span></span></a><span class="mpre"> </span><a name="loc_110_14_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_14_110_19&#39;)"><span class="hl_vardecl"><span class="mpre">fpath</span></span></a><span class="mpre"> (</span><a href="#loc_105_17_105_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_25&#39;)"><span class="hl_conref"><span class="mpre">PWarning</span></span></a><span class="mpre"> </span><a name="loc_110_30_110_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_30_110_33&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre">) =
  </span><span class="hl_varref"><span class="mpre">normalise</span></span><span class="mpre"> </span><a href="#loc_110_14_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_14_110_19&#39;)"><span class="hl_varref"><span class="mpre">fpath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_110_30_110_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_30_110_33&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
</span><a href="#loc_110_1_110_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_13&#39;)"><span class="hl_fundecl"><span class="mpre">showPWarning</span></span></a><span class="mpre"> </span><a name="loc_112_14_112_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_14_112_19&#39;)"><span class="hl_vardecl"><span class="mpre">fpath</span></span></a><span class="mpre"> (</span><a href="#loc_106_17_106_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_17_106_27&#39;)"><span class="hl_conref"><span class="mpre">UTFWarning</span></span></a><span class="mpre"> </span><a name="loc_112_32_112_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_32_112_36&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> </span><a name="loc_112_37_112_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_37_112_42&#39;)"><span class="hl_vardecl"><span class="mpre">fname</span></span></a><span class="mpre">) =
  </span><span class="hl_varref"><span class="mpre">normalise</span></span><span class="mpre"> </span><a href="#loc_112_14_112_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_14_112_19&#39;)"><span class="hl_varref"><span class="mpre">fpath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_112_32_112_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_32_112_36&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: Invalid UTF-8 text in the &#39;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_112_37_112_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_37_112_42&#39;)"><span class="hl_varref"><span class="mpre">fname</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39; field.&quot;</span></span><span class="mpre">

data </span><a name="loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tycondecl"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_condecl"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a href="#loc_99_6_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_6_99_12&#39;)"><span class="hl_tyconref"><span class="mpre">PError</span></span></a><span class="mpre"> | </span><a name="loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_condecl"><span class="mpre">ParseOk</span></span></a><span class="mpre"> [</span><a href="#loc_105_6_105_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_6_105_14&#39;)"><span class="hl_tyconref"><span class="mpre">PWarning</span></span></a><span class="mpre">] </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 117, srcSpanStartColumn = 9, srcSpanEndLine = 117, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 117, srcSpanStartColumn = 9, srcSpanEndLine = 117, srcSpanEndColumn = 17}]}) [IHead (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/C"><span class="mpre">deriving Show</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> where
        </span><a name="loc_120_9_120_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_13&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> _ (</span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a name="loc_120_29_120_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_29_120_32&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">) = </span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a href="#loc_120_29_120_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_29_120_32&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
        </span><a href="#loc_120_9_120_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_13&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> </span><a name="loc_121_14_121_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_14_121_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><a name="loc_121_25_121_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_25_121_27&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre"> </span><a name="loc_121_28_121_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_28_121_29&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><a href="#loc_121_25_121_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_25_121_27&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_121_14_121_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_14_121_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_121_28_121_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_28_121_29&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        
instance </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> where
        </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_vardecl"><span class="mpre">pure</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">
        </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;*&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="hl_varref"><span class="mpre">ap</span></span></a><span class="mpre">
        

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> where
        </span><span class="hl_vardecl"><span class="mpre">return</span></span><span class="mpre"> = </span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> []
        </span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a name="loc_130_21_130_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_21_130_24&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> </span><a name="loc_130_25_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_25_130_28&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span></a><span class="mpre"> _ = </span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a href="#loc_130_21_130_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_21_130_24&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
        </span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><a name="loc_131_17_131_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_17_131_19&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre"> </span><a name="loc_131_20_131_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_20_131_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_130_25_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_25_130_28&#39;)"><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span></a><span class="mpre"> </span><a name="loc_131_26_131_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_26_131_27&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = case </span><a href="#loc_131_26_131_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_26_131_27&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_131_20_131_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_20_131_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
                               </span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a name="loc_132_44_132_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_44_132_47&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a href="#loc_132_44_132_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_44_132_47&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
                               </span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> </span><a name="loc_133_40_133_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_40_133_43&#39;)"><span class="hl_vardecl"><span class="mpre">ws&#39;</span></span></a><span class="mpre"> </span><a name="loc_133_44_133_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_44_133_46&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> (</span><a href="#loc_133_40_133_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_40_133_43&#39;)"><span class="hl_varref"><span class="mpre">ws&#39;</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_131_17_131_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_17_131_19&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">) </span><a href="#loc_133_44_133_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_44_133_46&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre">
        </span><span class="hl_fundecl"><span class="mpre">fail</span></span><span class="mpre"> </span><a name="loc_134_14_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_14_134_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> (</span><a href="#loc_102_15_102_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_15_102_25&#39;)"><span class="hl_conref"><span class="mpre">FromString</span></span></a><span class="mpre"> </span><a href="#loc_134_14_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_14_134_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)

</span><a href="#loc_138_17_138_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_17_138_34&#39;)"><span class="mpre">catchParseError</span></a><span class="mpre"> :: </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><a href="#loc_99_6_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_6_99_12&#39;)"><span class="hl_tyconref"><span class="mpre">PError</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
                -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_138_1_138_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_2&#39;)"><span class="hl_specname"><span class="mpre">p</span></span></a><span class="mpre">@(</span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> _ _) </span><a name="loc_138_17_138_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_17_138_34&#39;)"><span class="hl_fundecl"><span class="mpre">`catchParseError`</span></span></a><span class="mpre"> _ = </span><a href="#loc_138_1_138_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
</span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><a name="loc_139_13_139_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_13_139_14&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="#loc_138_17_138_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_17_138_34&#39;)"><span class="hl_fundecl"><span class="mpre">`catchParseError`</span></span></a><span class="mpre"> </span><a name="loc_139_33_139_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_34&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">   = </span><a href="#loc_139_33_139_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_34&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_139_13_139_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_13_139_14&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">

</span><a href="#loc_142_1_142_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_10&#39;)"><span class="mpre">parseFail</span></a><span class="mpre"> :: </span><a href="#loc_99_6_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_6_99_12&#39;)"><span class="hl_tyconref"><span class="mpre">PError</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_142_1_142_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_10&#39;)"><span class="hl_vardecl"><span class="mpre">parseFail</span></span></a><span class="mpre"> = </span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre">

</span><a href="#loc_145_1_145_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_5&#39;)"><span class="mpre">runP</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_145_1_145_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_5&#39;)"><span class="hl_fundecl"><span class="mpre">runP</span></span></a><span class="mpre"> </span><a name="loc_145_6_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_10&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> </span><a name="loc_145_11_145_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_20&#39;)"><span class="hl_vardecl"><span class="mpre">fieldname</span></span></a><span class="mpre"> </span><a name="loc_145_21_145_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_21_145_22&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_145_23_145_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_23_145_24&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
  case [ </span><a href="#loc_146_15_146_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_15_146_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> | (</span><a name="loc_146_15_146_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_15_146_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">) &lt;- </span><a href="#loc_155_9_155_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_9_155_16&#39;)"><span class="hl_varref"><span class="mpre">results</span></span></a><span class="mpre"> ] of
    [</span><a name="loc_147_6_147_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_6_147_7&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> (</span><a href="#loc_165_1_165_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_13&#39;)"><span class="hl_varref"><span class="mpre">utf8Warnings</span></span></a><span class="mpre"> </span><a href="#loc_145_6_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_10&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre"> </span><a href="#loc_145_11_145_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_20&#39;)"><span class="hl_varref"><span class="mpre">fieldname</span></span></a><span class="mpre"> </span><a href="#loc_145_23_145_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_23_145_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_147_6_147_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_6_147_7&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--TODO: what is this double parse thing all about?</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--      Can&#39;t we just do the all isSpace test the first time?</span></span><span class="mpre">
    []  -&gt; case [ </span><a href="#loc_150_24_150_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_24_150_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> | (</span><a name="loc_150_24_150_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_24_150_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_150_26_150_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_26_150_28&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_155_9_155_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_9_155_16&#39;)"><span class="hl_varref"><span class="mpre">results</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><a href="#loc_150_26_150_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_26_150_28&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre"> ] of
             [</span><a name="loc_151_15_151_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_15_151_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> (</span><a href="#loc_165_1_165_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_13&#39;)"><span class="hl_varref"><span class="mpre">utf8Warnings</span></span></a><span class="mpre"> </span><a href="#loc_145_6_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_10&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre"> </span><a href="#loc_145_11_145_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_20&#39;)"><span class="hl_varref"><span class="mpre">fieldname</span></span></a><span class="mpre"> </span><a href="#loc_145_23_145_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_23_145_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_151_15_151_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_15_151_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
             []  -&gt; </span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> (</span><a href="#loc_100_15_100_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_15_100_22&#39;)"><span class="hl_conref"><span class="mpre">NoParse</span></span></a><span class="mpre"> </span><a href="#loc_145_11_145_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_20&#39;)"><span class="hl_varref"><span class="mpre">fieldname</span></span></a><span class="mpre"> </span><a href="#loc_145_6_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_10&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">)
             _   -&gt; </span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> (</span><a href="#loc_99_15_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_29&#39;)"><span class="hl_conref"><span class="mpre">AmbiguousParse</span></span></a><span class="mpre"> </span><a href="#loc_145_11_145_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_20&#39;)"><span class="hl_varref"><span class="mpre">fieldname</span></span></a><span class="mpre"> </span><a href="#loc_145_6_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_10&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">)
    _   -&gt; </span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> (</span><a href="#loc_99_15_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_29&#39;)"><span class="hl_conref"><span class="mpre">AmbiguousParse</span></span></a><span class="mpre"> </span><a href="#loc_145_11_145_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_20&#39;)"><span class="hl_varref"><span class="mpre">fieldname</span></span></a><span class="mpre"> </span><a href="#loc_145_6_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_10&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">)
  where </span><a name="loc_155_9_155_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_9_155_16&#39;)"><span class="hl_vardecl"><span class="mpre">results</span></span></a><span class="mpre"> = </span><a href="Distribution.Compat.ReadP.html#loc_387_1_387_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_387_1_387_11&#39;)"><span class="hl_varref"><span class="mpre">readP_to_S</span></span></a><span class="mpre"> </span><a href="#loc_145_21_145_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_21_145_22&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_145_23_145_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_23_145_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><a href="#loc_158_1_158_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_5&#39;)"><span class="mpre">runE</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="Distribution.ReadE.html#loc_54_9_54_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.ReadE.html#loc_54_9_54_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadE</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_158_1_158_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_5&#39;)"><span class="hl_fundecl"><span class="mpre">runE</span></span></a><span class="mpre"> </span><a name="loc_158_6_158_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_6_158_10&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> </span><a name="loc_158_11_158_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_11_158_20&#39;)"><span class="hl_vardecl"><span class="mpre">fieldname</span></span></a><span class="mpre"> </span><a name="loc_158_21_158_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_21_158_22&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_158_23_158_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_23_158_24&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
    case </span><a href="Distribution.ReadE.html#loc_54_26_54_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.ReadE.html#loc_54_26_54_34&#39;)"><span class="hl_varref"><span class="mpre">runReadE</span></span></a><span class="mpre"> </span><a href="#loc_158_21_158_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_21_158_22&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_158_23_158_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_23_158_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
      </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_160_13_160_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_13_160_14&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> (</span><a href="#loc_165_1_165_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_13&#39;)"><span class="hl_varref"><span class="mpre">utf8Warnings</span></span></a><span class="mpre"> </span><a href="#loc_158_6_158_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_6_158_10&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre"> </span><a href="#loc_158_11_158_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_11_158_20&#39;)"><span class="hl_varref"><span class="mpre">fieldname</span></span></a><span class="mpre"> </span><a href="#loc_158_23_158_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_23_158_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_160_13_160_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_13_160_14&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
      </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">  </span><a name="loc_161_13_161_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_13_161_14&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_158_6_158_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_6_158_10&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;Parse of field &#39;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_158_11_158_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_11_158_20&#39;)"><span class="hl_varref"><span class="mpre">fieldname</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39; failed (&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_161_13_161_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_13_161_14&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;): &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_158_23_158_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_23_158_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><a href="#loc_165_1_165_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_13&#39;)"><span class="mpre">utf8Warnings</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><a href="#loc_105_6_105_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_6_105_14&#39;)"><span class="hl_tyconref"><span class="mpre">PWarning</span></span></a><span class="mpre">]
</span><a name="loc_165_1_165_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_13&#39;)"><span class="hl_fundecl"><span class="mpre">utf8Warnings</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">line</span></span><span class="mpre"> </span><a name="loc_165_19_165_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_19_165_28&#39;)"><span class="hl_vardecl"><span class="mpre">fieldname</span></span></a><span class="mpre"> </span><a name="loc_165_29_165_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_29_165_30&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
  </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> [ </span><a href="#loc_106_17_106_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_17_106_27&#39;)"><span class="hl_conref"><span class="mpre">UTFWarning</span></span></a><span class="mpre"> </span><a href="#loc_167_13_167_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_13_167_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_165_19_165_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_19_165_28&#39;)"><span class="hl_varref"><span class="mpre">fieldname</span></span></a><span class="mpre">
         | (</span><a name="loc_167_13_167_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_13_167_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">,</span><a name="loc_167_15_167_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_15_167_16&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">zip</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 167, srcSpanStartColumn = 25, srcSpanEndLine = 167, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 167, srcSpanStartColumn = 25, srcSpanEndLine = 167, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtil"><span class="mpre">[line..]</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">lines</span></span><span class="mpre"> </span><a href="#loc_165_29_165_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_29_165_30&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
         , </span><span class="hl_char"><span class="mpre">&#39;\xfffd&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_167_15_167_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_15_167_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> ]

</span><a href="#loc_171_1_171_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_16&#39;)"><span class="mpre">locatedErrorMsg</span></a><span class="mpre"> :: </span><a href="#loc_99_6_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_6_99_12&#39;)"><span class="hl_tyconref"><span class="mpre">PError</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_171_1_171_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_16&#39;)"><span class="hl_fundecl"><span class="mpre">locatedErrorMsg</span></span></a><span class="mpre"> (</span><a href="#loc_99_15_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_29&#39;)"><span class="hl_conref"><span class="mpre">AmbiguousParse</span></span></a><span class="mpre"> </span><a name="loc_171_33_171_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_33_171_34&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_171_35_171_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_35_171_36&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) = (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_171_35_171_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_35_171_36&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">,
                                        </span><span class="hl_string"><span class="mpre">&quot;Ambiguous parse in field &#39;&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_171_33_171_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_33_171_34&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;&#39;.&quot;</span></span><span class="mpre">)
</span><a href="#loc_171_1_171_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_16&#39;)"><span class="hl_fundecl"><span class="mpre">locatedErrorMsg</span></span></a><span class="mpre"> (</span><a href="#loc_100_15_100_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_15_100_22&#39;)"><span class="hl_conref"><span class="mpre">NoParse</span></span></a><span class="mpre"> </span><a name="loc_173_26_173_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_26_173_27&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_173_28_173_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_28_173_29&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">)        = (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_173_28_173_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_28_173_29&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">,
                                        </span><span class="hl_string"><span class="mpre">&quot;Parse of field &#39;&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_173_26_173_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_26_173_27&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;&#39; failed.&quot;</span></span><span class="mpre">)
</span><a href="#loc_171_1_171_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_16&#39;)"><span class="hl_fundecl"><span class="mpre">locatedErrorMsg</span></span></a><span class="mpre"> (</span><a href="#loc_101_15_101_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_15_101_24&#39;)"><span class="hl_conref"><span class="mpre">TabsError</span></span></a><span class="mpre"> </span><a name="loc_175_28_175_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_28_175_29&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">)        = (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_175_28_175_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_28_175_29&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;Tab used as indentation.&quot;</span></span><span class="mpre">)
</span><a href="#loc_171_1_171_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_16&#39;)"><span class="hl_fundecl"><span class="mpre">locatedErrorMsg</span></span></a><span class="mpre"> (</span><a href="#loc_102_15_102_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_15_102_25&#39;)"><span class="hl_conref"><span class="mpre">FromString</span></span></a><span class="mpre"> </span><a name="loc_176_29_176_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_29_176_30&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_176_31_176_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_31_176_32&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">)     = (</span><a href="#loc_176_31_176_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_31_176_32&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><a href="#loc_176_29_176_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_29_176_30&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="mpre">syntaxError</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_fundecl"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a name="loc_179_13_179_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_13_179_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_179_15_179_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_15_179_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_102_15_102_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_15_102_25&#39;)"><span class="hl_conref"><span class="mpre">FromString</span></span></a><span class="mpre"> </span><a href="#loc_179_15_179_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_15_179_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_179_13_179_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_13_179_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)

</span><a href="#loc_182_1_182_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_10&#39;)"><span class="mpre">tabsError</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre"> -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_182_1_182_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_10&#39;)"><span class="hl_fundecl"><span class="mpre">tabsError</span></span></a><span class="mpre"> </span><a name="loc_182_11_182_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_11_182_13&#39;)"><span class="hl_vardecl"><span class="mpre">ln</span></span></a><span class="mpre"> = </span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_101_15_101_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_15_101_24&#39;)"><span class="hl_conref"><span class="mpre">TabsError</span></span></a><span class="mpre"> </span><a href="#loc_182_11_182_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_11_182_13&#39;)"><span class="hl_varref"><span class="mpre">ln</span></span></a><span class="mpre">

</span><a href="#loc_185_1_185_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_8&#39;)"><span class="mpre">warning</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_185_1_185_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_8&#39;)"><span class="hl_fundecl"><span class="mpre">warning</span></span></a><span class="mpre"> </span><a name="loc_185_9_185_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_9_185_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> [</span><a href="#loc_105_17_105_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_25&#39;)"><span class="hl_conref"><span class="mpre">PWarning</span></span></a><span class="mpre"> </span><a href="#loc_185_9_185_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_9_185_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">] </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Field descriptor.  The parameter @a@ parameterizes over where the field&#39;s</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   value is stored in.</span></span><span class="mpre">
data </span><a name="loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tycondecl"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
  = </span><a name="loc_190_5_190_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_15&#39;)"><span class="hl_condecl"><span class="mpre">FieldDescr</span></span></a><span class="mpre">
      { </span><a name="loc_191_9_191_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_9_191_18&#39;)"><span class="hl_fielddecl"><span class="mpre">fieldName</span></span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
      , </span><a name="loc_192_9_192_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_9_192_17&#39;)"><span class="hl_fielddecl"><span class="mpre">fieldGet</span></span></a><span class="mpre">      :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
      , </span><a name="loc_193_9_193_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_9_193_17&#39;)"><span class="hl_fielddecl"><span class="mpre">fieldSet</span></span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- ^ @fieldSet n str x@ Parses the field value from the given input</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- string @str@ and stores the result in @x@ if the parse was</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- successful.  Otherwise, reports an error on line number @n@.</span></span><span class="mpre">
      }

</span><a href="#loc_200_1_200_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_6&#39;)"><span class="mpre">field</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_200_1_200_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_6&#39;)"><span class="hl_fundecl"><span class="mpre">field</span></span></a><span class="mpre"> </span><a name="loc_200_7_200_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_7_200_11&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_200_12_200_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_12_200_17&#39;)"><span class="hl_vardecl"><span class="mpre">showF</span></span></a><span class="mpre"> </span><a name="loc_200_18_200_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_18_200_23&#39;)"><span class="hl_vardecl"><span class="mpre">readF</span></span></a><span class="mpre"> =
  </span><a href="#loc_190_5_190_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_15&#39;)"><span class="hl_conref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><a href="#loc_200_7_200_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_7_200_11&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_200_12_200_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_12_200_17&#39;)"><span class="hl_varref"><span class="mpre">showF</span></span></a><span class="mpre"> (\</span><a name="loc_201_27_201_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_27_201_31&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> </span><a name="loc_201_32_201_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_32_201_35&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_st</span></span><span class="mpre"> -&gt; </span><a href="#loc_145_1_145_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_5&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> </span><a href="#loc_201_27_201_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_27_201_31&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre"> </span><a href="#loc_200_7_200_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_7_200_11&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_200_18_200_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_18_200_23&#39;)"><span class="hl_varref"><span class="mpre">readF</span></span></a><span class="mpre"> </span><a href="#loc_201_32_201_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_32_201_35&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Lift a field descriptor storing into an &#39;a&#39; to a field descriptor storing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- into a &#39;b&#39;.</span></span><span class="mpre">
</span><a href="#loc_206_1_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_10&#39;)"><span class="mpre">liftField</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_206_1_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_10&#39;)"><span class="hl_fundecl"><span class="mpre">liftField</span></span></a><span class="mpre"> </span><a name="loc_206_11_206_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_11_206_14&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="mpre"> </span><a name="loc_206_15_206_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_15_206_18&#39;)"><span class="hl_vardecl"><span class="mpre">set</span></span></a><span class="mpre"> (</span><a href="#loc_190_5_190_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_15&#39;)"><span class="hl_conref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><a name="loc_206_31_206_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_31_206_35&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_206_36_206_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_36_206_41&#39;)"><span class="hl_vardecl"><span class="mpre">showF</span></span></a><span class="mpre"> </span><a name="loc_206_42_206_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_42_206_48&#39;)"><span class="hl_vardecl"><span class="mpre">parseF</span></span></a><span class="mpre">)
 = </span><a href="#loc_190_5_190_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_15&#39;)"><span class="hl_conref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><a href="#loc_206_31_206_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_31_206_35&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> (</span><a href="#loc_206_36_206_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_36_206_41&#39;)"><span class="hl_varref"><span class="mpre">showF</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_206_11_206_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_11_206_14&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">)
        (\</span><a name="loc_208_11_208_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_11_208_15&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> </span><a name="loc_208_16_208_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_16_208_19&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><a name="loc_208_20_208_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_20_208_21&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; do
            </span><a name="loc_209_13_209_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_13_209_14&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_206_42_206_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_42_206_48&#39;)"><span class="hl_varref"><span class="mpre">parseF</span></span></a><span class="mpre"> </span><a href="#loc_208_11_208_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_11_208_15&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre"> </span><a href="#loc_208_16_208_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_16_208_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> (</span><a href="#loc_206_11_206_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_11_206_14&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><a href="#loc_208_20_208_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_20_208_21&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_206_15_206_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_15_206_18&#39;)"><span class="hl_varref"><span class="mpre">set</span></span></a><span class="mpre"> </span><a href="#loc_209_13_209_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_13_209_14&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_208_20_208_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_20_208_21&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- Parser combinator for simple fields.  Takes a field name, a pretty printer,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a parser function, an accessor, and a setter, returns a FieldDescr over the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- compoid structure.</span></span><span class="mpre">
</span><a href="#loc_217_1_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_12&#39;)"><span class="mpre">simpleField</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
            -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_217_1_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_12&#39;)"><span class="hl_fundecl"><span class="mpre">simpleField</span></span></a><span class="mpre"> </span><a name="loc_217_13_217_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_13_217_17&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_217_18_217_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_18_217_23&#39;)"><span class="hl_vardecl"><span class="mpre">showF</span></span></a><span class="mpre"> </span><a name="loc_217_24_217_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_24_217_29&#39;)"><span class="hl_vardecl"><span class="mpre">readF</span></span></a><span class="mpre"> </span><a name="loc_217_30_217_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_30_217_33&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="mpre"> </span><a name="loc_217_34_217_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_34_217_37&#39;)"><span class="hl_vardecl"><span class="mpre">set</span></span></a><span class="mpre">
  = </span><a href="#loc_206_1_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_10&#39;)"><span class="hl_varref"><span class="mpre">liftField</span></span></a><span class="mpre"> </span><a href="#loc_217_30_217_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_30_217_33&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><a href="#loc_217_34_217_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_34_217_37&#39;)"><span class="hl_varref"><span class="mpre">set</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_200_1_200_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_6&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre"> </span><a href="#loc_217_13_217_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_13_217_17&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_217_18_217_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_18_217_23&#39;)"><span class="hl_varref"><span class="mpre">showF</span></span></a><span class="mpre"> </span><a href="#loc_217_24_217_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_24_217_29&#39;)"><span class="hl_varref"><span class="mpre">readF</span></span></a><span class="mpre">

</span><a href="#loc_222_1_222_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_15&#39;)"><span class="mpre">commaListField</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
                 -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]) -&gt; ([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_222_1_222_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_15&#39;)"><span class="hl_fundecl"><span class="mpre">commaListField</span></span></a><span class="mpre"> </span><a name="loc_222_16_222_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_16_222_20&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_222_21_222_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_21_222_26&#39;)"><span class="hl_vardecl"><span class="mpre">showF</span></span></a><span class="mpre"> </span><a name="loc_222_27_222_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_27_222_32&#39;)"><span class="hl_vardecl"><span class="mpre">readF</span></span></a><span class="mpre"> </span><a name="loc_222_33_222_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_33_222_36&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="mpre"> </span><a name="loc_222_37_222_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_37_222_40&#39;)"><span class="hl_vardecl"><span class="mpre">set</span></span></a><span class="mpre"> =
  </span><a href="#loc_206_1_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_10&#39;)"><span class="hl_varref"><span class="mpre">liftField</span></span></a><span class="mpre"> </span><a href="#loc_222_33_222_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_33_222_36&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><a href="#loc_226_5_226_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_5_226_9&#39;)"><span class="hl_varref"><span class="mpre">set&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><a href="#loc_200_1_200_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_6&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre"> </span><a href="#loc_222_16_222_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_16_222_20&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> (</span><a href="Text.PrettyPrint.HughesPJ.html#loc_648_1_648_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_648_1_648_5&#39;)"><span class="hl_varref"><span class="mpre">fsep</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Text.PrettyPrint.HughesPJ.html#loc_416_1_416_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_416_1_416_10&#39;)"><span class="hl_varref"><span class="mpre">punctuate</span></span></a><span class="mpre"> </span><a href="Text.PrettyPrint.HughesPJ.html#loc_331_1_331_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_331_1_331_6&#39;)"><span class="hl_varref"><span class="mpre">comma</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_222_21_222_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_21_222_26&#39;)"><span class="hl_varref"><span class="mpre">showF</span></span></a><span class="mpre">) (</span><a href="#loc_698_1_698_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_698_1_698_15&#39;)"><span class="hl_varref"><span class="mpre">parseCommaList</span></span></a><span class="mpre"> </span><a href="#loc_222_27_222_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_27_222_32&#39;)"><span class="hl_varref"><span class="mpre">readF</span></span></a><span class="mpre">)
  where
    </span><a name="loc_226_5_226_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_5_226_9&#39;)"><span class="hl_fundecl"><span class="mpre">set&#39;</span></span></a><span class="mpre"> </span><a name="loc_226_10_226_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_10_226_12&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_226_13_226_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_13_226_14&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_222_37_222_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_37_222_40&#39;)"><span class="hl_varref"><span class="mpre">set</span></span></a><span class="mpre"> (</span><a href="#loc_222_33_222_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_33_222_36&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><a href="#loc_226_13_226_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_13_226_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_226_10_226_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_10_226_12&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_226_13_226_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_13_226_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><a href="#loc_230_1_230_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_15&#39;)"><span class="mpre">spaceListField</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
                 -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]) -&gt; ([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_230_1_230_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_15&#39;)"><span class="hl_fundecl"><span class="mpre">spaceListField</span></span></a><span class="mpre"> </span><a name="loc_230_16_230_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_16_230_20&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_230_21_230_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_21_230_26&#39;)"><span class="hl_vardecl"><span class="mpre">showF</span></span></a><span class="mpre"> </span><a name="loc_230_27_230_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_27_230_32&#39;)"><span class="hl_vardecl"><span class="mpre">readF</span></span></a><span class="mpre"> </span><a name="loc_230_33_230_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_33_230_36&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="mpre"> </span><a name="loc_230_37_230_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_37_230_40&#39;)"><span class="hl_vardecl"><span class="mpre">set</span></span></a><span class="mpre"> =
  </span><a href="#loc_206_1_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_10&#39;)"><span class="hl_varref"><span class="mpre">liftField</span></span></a><span class="mpre"> </span><a href="#loc_230_33_230_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_33_230_36&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><a href="#loc_234_5_234_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_5_234_9&#39;)"><span class="hl_varref"><span class="mpre">set&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><a href="#loc_200_1_200_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_6&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre"> </span><a href="#loc_230_16_230_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_16_230_20&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> (</span><a href="Text.PrettyPrint.HughesPJ.html#loc_648_1_648_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_648_1_648_5&#39;)"><span class="hl_varref"><span class="mpre">fsep</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_230_21_230_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_21_230_26&#39;)"><span class="hl_varref"><span class="mpre">showF</span></span></a><span class="mpre">) (</span><a href="#loc_694_1_694_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_694_1_694_15&#39;)"><span class="hl_varref"><span class="mpre">parseSpaceList</span></span></a><span class="mpre"> </span><a href="#loc_230_27_230_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_27_230_32&#39;)"><span class="hl_varref"><span class="mpre">readF</span></span></a><span class="mpre">)
  where
    </span><a name="loc_234_5_234_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_5_234_9&#39;)"><span class="hl_fundecl"><span class="mpre">set&#39;</span></span></a><span class="mpre"> </span><a name="loc_234_10_234_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_10_234_12&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_234_13_234_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_13_234_14&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_230_37_230_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_37_230_40&#39;)"><span class="hl_varref"><span class="mpre">set</span></span></a><span class="mpre"> (</span><a href="#loc_230_33_230_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_33_230_36&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><a href="#loc_234_13_234_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_13_234_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_234_10_234_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_10_234_12&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_234_13_234_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_13_234_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><a href="#loc_238_1_238_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_1_238_10&#39;)"><span class="mpre">listField</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
                 -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]) -&gt; ([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_238_1_238_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_1_238_10&#39;)"><span class="hl_fundecl"><span class="mpre">listField</span></span></a><span class="mpre"> </span><a name="loc_238_11_238_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_11_238_15&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_238_16_238_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_16_238_21&#39;)"><span class="hl_vardecl"><span class="mpre">showF</span></span></a><span class="mpre"> </span><a name="loc_238_22_238_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_22_238_27&#39;)"><span class="hl_vardecl"><span class="mpre">readF</span></span></a><span class="mpre"> </span><a name="loc_238_28_238_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_28_238_31&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="mpre"> </span><a name="loc_238_32_238_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_32_238_35&#39;)"><span class="hl_vardecl"><span class="mpre">set</span></span></a><span class="mpre"> =
  </span><a href="#loc_206_1_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_10&#39;)"><span class="hl_varref"><span class="mpre">liftField</span></span></a><span class="mpre"> </span><a href="#loc_238_28_238_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_28_238_31&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><a href="#loc_242_5_242_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_5_242_9&#39;)"><span class="hl_varref"><span class="mpre">set&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><a href="#loc_200_1_200_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_6&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre"> </span><a href="#loc_238_11_238_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_11_238_15&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> (</span><a href="Text.PrettyPrint.HughesPJ.html#loc_648_1_648_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_648_1_648_5&#39;)"><span class="hl_varref"><span class="mpre">fsep</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_238_16_238_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_16_238_21&#39;)"><span class="hl_varref"><span class="mpre">showF</span></span></a><span class="mpre">) (</span><a href="#loc_702_1_702_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_702_1_702_18&#39;)"><span class="hl_varref"><span class="mpre">parseOptCommaList</span></span></a><span class="mpre"> </span><a href="#loc_238_22_238_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_22_238_27&#39;)"><span class="hl_varref"><span class="mpre">readF</span></span></a><span class="mpre">)
  where
    </span><a name="loc_242_5_242_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_5_242_9&#39;)"><span class="hl_fundecl"><span class="mpre">set&#39;</span></span></a><span class="mpre"> </span><a name="loc_242_10_242_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_10_242_12&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_242_13_242_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_13_242_14&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_238_32_238_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_32_238_35&#39;)"><span class="hl_varref"><span class="mpre">set</span></span></a><span class="mpre"> (</span><a href="#loc_238_28_238_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_28_238_31&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><a href="#loc_242_13_242_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_13_242_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_242_10_242_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_10_242_12&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="#loc_242_13_242_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_13_242_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><a href="#loc_246_1_246_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_10&#39;)"><span class="mpre">optsField</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="Distribution.Compiler.html#loc_81_6_81_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compiler.html#loc_81_6_81_20&#39;)"><span class="hl_tyconref"><span class="mpre">CompilerFlavor</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [(</span><a href="Distribution.Compiler.html#loc_81_6_81_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compiler.html#loc_81_6_81_20&#39;)"><span class="hl_tyconref"><span class="mpre">CompilerFlavor</span></span></a><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">])])
             -&gt; ([(</span><a href="Distribution.Compiler.html#loc_81_6_81_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compiler.html#loc_81_6_81_20&#39;)"><span class="hl_tyconref"><span class="mpre">CompilerFlavor</span></span></a><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">])] -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_246_1_246_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_10&#39;)"><span class="hl_fundecl"><span class="mpre">optsField</span></span></a><span class="mpre"> </span><a name="loc_246_11_246_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_11_246_15&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_246_16_246_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_16_246_22&#39;)"><span class="hl_vardecl"><span class="mpre">flavor</span></span></a><span class="mpre"> </span><a name="loc_246_23_246_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_23_246_26&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="mpre"> </span><a name="loc_246_27_246_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_27_246_30&#39;)"><span class="hl_vardecl"><span class="mpre">set</span></span></a><span class="mpre"> =
   </span><a href="#loc_206_1_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_10&#39;)"><span class="hl_varref"><span class="mpre">liftField</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> [] </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><a href="#loc_246_16_246_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_16_246_22&#39;)"><span class="hl_varref"><span class="mpre">flavor</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_246_23_246_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_23_246_26&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">)
             (\</span><a name="loc_248_16_248_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_16_248_20&#39;)"><span class="hl_vardecl"><span class="mpre">opts</span></span></a><span class="mpre"> </span><a name="loc_248_21_248_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_21_248_22&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_246_27_246_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_27_246_30&#39;)"><span class="hl_varref"><span class="mpre">set</span></span></a><span class="mpre"> (</span><a href="#loc_257_9_257_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_9_257_16&#39;)"><span class="hl_varref"><span class="mpre">reorder</span></span></a><span class="mpre"> (</span><a href="#loc_252_9_252_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_9_252_15&#39;)"><span class="hl_varref"><span class="mpre">update</span></span></a><span class="mpre"> </span><a href="#loc_246_16_246_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_16_246_22&#39;)"><span class="hl_varref"><span class="mpre">flavor</span></span></a><span class="mpre"> </span><a href="#loc_248_16_248_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_16_248_20&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre"> (</span><a href="#loc_246_23_246_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_23_246_26&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><a href="#loc_248_21_248_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_21_248_22&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">))) </span><a href="#loc_248_21_248_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_21_248_22&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><a href="#loc_200_1_200_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_6&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre"> </span><a href="#loc_246_11_246_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_11_246_15&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> (</span><a href="Text.PrettyPrint.HughesPJ.html#loc_384_1_384_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_384_1_384_5&#39;)"><span class="hl_varref"><span class="mpre">hsep</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre">)
                   (</span><a href="Distribution.Compat.ReadP.html#loc_325_1_325_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_325_1_325_6&#39;)"><span class="hl_varref"><span class="mpre">sepBy</span></span></a><span class="mpre"> </span><a href="#loc_684_1_684_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_1_684_13&#39;)"><span class="hl_varref"><span class="mpre">parseTokenQ&#39;</span></span></a><span class="mpre"> (</span><a href="Distribution.Compat.ReadP.html#loc_264_1_264_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_264_1_264_7&#39;)"><span class="hl_varref"><span class="mpre">munch1</span></span></a><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre">))
  where
        </span><a name="loc_252_9_252_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_9_252_15&#39;)"><span class="hl_fundecl"><span class="mpre">update</span></span></a><span class="mpre"> _ </span><a name="loc_252_18_252_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_18_252_22&#39;)"><span class="hl_vardecl"><span class="mpre">opts</span></span></a><span class="mpre"> </span><a name="loc_252_23_252_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_23_252_24&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_252_18_252_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_18_252_22&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre"> = </span><a href="#loc_252_23_252_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_23_252_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">--empty opts as if no opts</span></span><span class="mpre">
        </span><a href="#loc_252_9_252_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_9_252_15&#39;)"><span class="hl_fundecl"><span class="mpre">update</span></span></a><span class="mpre"> </span><a name="loc_253_16_253_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_16_253_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_253_18_253_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_18_253_22&#39;)"><span class="hl_vardecl"><span class="mpre">opts</span></span></a><span class="mpre"> [] = [(</span><a href="#loc_253_16_253_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_16_253_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">,</span><a href="#loc_253_18_253_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_18_253_22&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre">)]
        </span><a href="#loc_252_9_252_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_9_252_15&#39;)"><span class="hl_fundecl"><span class="mpre">update</span></span></a><span class="mpre"> </span><a name="loc_254_16_254_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_16_254_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_254_18_254_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_18_254_22&#39;)"><span class="hl_vardecl"><span class="mpre">opts</span></span></a><span class="mpre"> ((</span><a name="loc_254_25_254_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_25_254_27&#39;)"><span class="hl_vardecl"><span class="mpre">f&#39;</span></span></a><span class="mpre">,</span><a name="loc_254_28_254_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_28_254_33&#39;)"><span class="hl_vardecl"><span class="mpre">opts&#39;</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_254_35_254_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_35_254_39&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">)
           | </span><a href="#loc_254_16_254_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_16_254_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_254_25_254_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_25_254_27&#39;)"><span class="hl_varref"><span class="mpre">f&#39;</span></span></a><span class="mpre">   = (</span><a href="#loc_254_16_254_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_16_254_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">, </span><a href="#loc_254_28_254_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_28_254_33&#39;)"><span class="hl_varref"><span class="mpre">opts&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_254_18_254_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_18_254_22&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_254_35_254_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_35_254_39&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = (</span><a href="#loc_254_25_254_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_25_254_27&#39;)"><span class="hl_varref"><span class="mpre">f&#39;</span></span></a><span class="mpre">,</span><a href="#loc_254_28_254_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_28_254_33&#39;)"><span class="hl_varref"><span class="mpre">opts&#39;</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_252_9_252_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_9_252_15&#39;)"><span class="hl_varref"><span class="mpre">update</span></span></a><span class="mpre"> </span><a href="#loc_254_16_254_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_16_254_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_254_18_254_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_18_254_22&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre"> </span><a href="#loc_254_35_254_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_35_254_39&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
        </span><a name="loc_257_9_257_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_9_257_16&#39;)"><span class="hl_vardecl"><span class="mpre">reorder</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_810_1_810_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_810_1_810_7&#39;)"><span class="hl_varref"><span class="mpre">sortBy</span></span></a><span class="mpre"> (</span><a href="Distribution.Simple.Utils.html#loc_1277_1_1277_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_1277_1_1277_10&#39;)"><span class="hl_varref"><span class="mpre">comparing</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- TODO: this is a bit smelly hack. It&#39;s because we want to parse bool fields</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--       liberally but not accept new parses. We cannot do that with ReadP</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--       because it does not support warnings. We need a new parser framework!</span></span><span class="mpre">
</span><a href="#loc_263_1_263_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_10&#39;)"><span class="mpre">boolField</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_263_1_263_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_10&#39;)"><span class="hl_fundecl"><span class="mpre">boolField</span></span></a><span class="mpre"> </span><a name="loc_263_11_263_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_11_263_15&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_263_16_263_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_16_263_19&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="mpre"> </span><a name="loc_263_20_263_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_20_263_23&#39;)"><span class="hl_vardecl"><span class="mpre">set</span></span></a><span class="mpre"> = </span><a href="#loc_206_1_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_10&#39;)"><span class="hl_varref"><span class="mpre">liftField</span></span></a><span class="mpre"> </span><a href="#loc_263_16_263_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_16_263_19&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><a href="#loc_263_20_263_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_20_263_23&#39;)"><span class="hl_varref"><span class="mpre">set</span></span></a><span class="mpre"> (</span><a href="#loc_190_5_190_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_15&#39;)"><span class="hl_conref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><a href="#loc_263_11_263_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_11_263_15&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_265_5_265_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_5_265_10&#39;)"><span class="hl_varref"><span class="mpre">showF</span></span></a><span class="mpre"> </span><a href="#loc_266_5_266_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_5_266_10&#39;)"><span class="hl_varref"><span class="mpre">readF</span></span></a><span class="mpre">)
  where
    </span><a name="loc_265_5_265_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_5_265_10&#39;)"><span class="hl_vardecl"><span class="mpre">showF</span></span></a><span class="mpre"> = </span><a href="Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">
    </span><a name="loc_266_5_266_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_5_266_10&#39;)"><span class="hl_fundecl"><span class="mpre">readF</span></span></a><span class="mpre"> </span><a name="loc_266_11_266_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_11_266_15&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> </span><a name="loc_266_16_266_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_16_266_19&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> _
      |  </span><a href="#loc_266_16_266_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_16_266_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;True&quot;</span></span><span class="mpre">  = </span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> [] </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
      |  </span><a href="#loc_266_16_266_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_16_266_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;False&quot;</span></span><span class="mpre"> = </span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> [] </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
      | </span><a href="#loc_273_9_273_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_9_273_13&#39;)"><span class="hl_varref"><span class="mpre">lstr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;true&quot;</span></span><span class="mpre">  = </span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> [</span><a href="#loc_274_9_274_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_9_274_20&#39;)"><span class="hl_varref"><span class="mpre">caseWarning</span></span></a><span class="mpre">] </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
      | </span><a href="#loc_273_9_273_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_9_273_13&#39;)"><span class="hl_varref"><span class="mpre">lstr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;false&quot;</span></span><span class="mpre"> = </span><a href="#loc_116_43_116_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_43_116_50&#39;)"><span class="hl_conref"><span class="mpre">ParseOk</span></span></a><span class="mpre"> [</span><a href="#loc_274_9_274_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_9_274_20&#39;)"><span class="hl_varref"><span class="mpre">caseWarning</span></span></a><span class="mpre">] </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       = </span><a href="#loc_116_22_116_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_22_116_33&#39;)"><span class="hl_conref"><span class="mpre">ParseFailed</span></span></a><span class="mpre"> (</span><a href="#loc_100_15_100_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_15_100_22&#39;)"><span class="hl_conref"><span class="mpre">NoParse</span></span></a><span class="mpre"> </span><a href="#loc_263_11_263_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_11_263_15&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_266_11_266_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_11_266_15&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">)
      where
        </span><a name="loc_273_9_273_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_9_273_13&#39;)"><span class="hl_vardecl"><span class="mpre">lstr</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.Utils.html#loc_1283_1_1283_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_1283_1_1283_10&#39;)"><span class="hl_varref"><span class="mpre">lowercase</span></span></a><span class="mpre"> </span><a href="#loc_266_16_266_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_16_266_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
        </span><a name="loc_274_9_274_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_9_274_20&#39;)"><span class="hl_vardecl"><span class="mpre">caseWarning</span></span></a><span class="mpre"> = </span><a href="#loc_105_17_105_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_25&#39;)"><span class="hl_conref"><span class="mpre">PWarning</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
          </span><span class="hl_string"><span class="mpre">&quot;The &#39;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_263_11_263_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_11_263_15&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39; field is case sensitive, use &#39;True&#39; or &#39;False&#39;.&quot;</span></span><span class="mpre">

</span><a href="#loc_278_1_278_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_9&#39;)"><span class="mpre">ppFields</span></a><span class="mpre"> :: [</span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_278_1_278_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_9&#39;)"><span class="hl_fundecl"><span class="mpre">ppFields</span></span></a><span class="mpre"> </span><a name="loc_278_10_278_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_10_278_16&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> </span><a name="loc_278_17_278_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Text.PrettyPrint.HughesPJ.html#loc_388_1_388_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_388_1_388_5&#39;)"><span class="hl_varref"><span class="mpre">vcat</span></span></a><span class="mpre"> [ </span><a href="#loc_282_1_282_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_8&#39;)"><span class="hl_varref"><span class="mpre">ppField</span></span></a><span class="mpre"> </span><a href="#loc_279_39_279_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_39_279_43&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> (</span><a href="#loc_279_44_279_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_44_279_50&#39;)"><span class="hl_varref"><span class="mpre">getter</span></span></a><span class="mpre"> </span><a href="#loc_278_17_278_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
                         | </span><a href="#loc_190_5_190_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_15&#39;)"><span class="hl_conref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><a name="loc_279_39_279_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_39_279_43&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_279_44_279_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_44_279_50&#39;)"><span class="hl_vardecl"><span class="mpre">getter</span></span></a><span class="mpre"> _ &lt;- </span><a href="#loc_278_10_278_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_10_278_16&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">]

</span><a href="#loc_282_1_282_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_8&#39;)"><span class="mpre">ppField</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_282_1_282_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_8&#39;)"><span class="hl_fundecl"><span class="mpre">ppField</span></span></a><span class="mpre"> </span><a name="loc_282_9_282_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_9_282_13&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_282_14_282_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_14_282_22&#39;)"><span class="hl_vardecl"><span class="mpre">fielddoc</span></span></a><span class="mpre"> = </span><a href="Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> </span><a href="#loc_282_9_282_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_9_282_13&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="Text.PrettyPrint.HughesPJ.html#loc_546_3_546_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_546_3_546_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="Text.PrettyPrint.HughesPJ.html#loc_332_1_332_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_332_1_332_6&#39;)"><span class="hl_varref"><span class="mpre">colon</span></span></a><span class="mpre"> </span><a href="Text.PrettyPrint.HughesPJ.html#loc_551_3_551_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_551_3_551_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;+&gt;</span></span></a><span class="mpre"> </span><a href="#loc_282_14_282_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_14_282_22&#39;)"><span class="hl_varref"><span class="mpre">fielddoc</span></span></a><span class="mpre">

</span><a href="#loc_285_1_285_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_1_285_11&#39;)"><span class="mpre">showFields</span></a><span class="mpre"> :: [</span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_285_1_285_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_1_285_11&#39;)"><span class="hl_fundecl"><span class="mpre">showFields</span></span></a><span class="mpre"> </span><a name="loc_285_12_285_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_12_285_18&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> = </span><a href="Text.PrettyPrint.HughesPJ.html#loc_804_1_804_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_804_1_804_7&#39;)"><span class="hl_varref"><span class="mpre">render</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="Text.PrettyPrint.HughesPJ.html#loc_490_3_490_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_490_3_490_6&#39;)"><span class="hl_infix"><span class="mpre">$+$</span></span></a><span class="mpre"> </span><a href="Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_278_1_278_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_9&#39;)"><span class="hl_varref"><span class="mpre">ppFields</span></span></a><span class="mpre"> </span><a href="#loc_285_12_285_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_12_285_18&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">

</span><a href="#loc_288_1_288_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_1_288_21&#39;)"><span class="mpre">showSingleNamedField</span></a><span class="mpre"> :: [</span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_288_1_288_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_1_288_21&#39;)"><span class="hl_fundecl"><span class="mpre">showSingleNamedField</span></span></a><span class="mpre"> </span><a name="loc_288_22_288_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_22_288_28&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> </span><a name="loc_288_29_288_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_29_288_30&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =
  case [ </span><a href="#loc_289_31_289_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_31_289_34&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> | (</span><a href="#loc_190_5_190_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_15&#39;)"><span class="hl_conref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><a name="loc_289_28_289_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_28_289_30&#39;)"><span class="hl_vardecl"><span class="mpre">f&#39;</span></span></a><span class="mpre"> </span><a name="loc_289_31_289_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_31_289_34&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="mpre"> _) &lt;- </span><a href="#loc_288_22_288_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_22_288_28&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">, </span><a href="#loc_289_28_289_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_28_289_30&#39;)"><span class="hl_varref"><span class="mpre">f&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_288_29_288_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_29_288_30&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> ] of
    []      -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    (</span><a name="loc_291_6_291_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_6_291_9&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="Text.PrettyPrint.HughesPJ.html#loc_804_1_804_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_804_1_804_7&#39;)"><span class="hl_varref"><span class="mpre">render</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_282_1_282_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_8&#39;)"><span class="hl_varref"><span class="mpre">ppField</span></span></a><span class="mpre"> </span><a href="#loc_288_29_288_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_29_288_30&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_291_6_291_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_6_291_9&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">)

</span><a href="#loc_294_1_294_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_1_294_27&#39;)"><span class="mpre">showSimpleSingleNamedField</span></a><span class="mpre"> :: [</span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_294_1_294_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_1_294_27&#39;)"><span class="hl_fundecl"><span class="mpre">showSimpleSingleNamedField</span></span></a><span class="mpre"> </span><a name="loc_294_28_294_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_28_294_34&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> </span><a name="loc_294_35_294_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_35_294_36&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =
  case [ </span><a href="#loc_295_31_295_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_31_295_34&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> | (</span><a href="#loc_190_5_190_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_15&#39;)"><span class="hl_conref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><a name="loc_295_28_295_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_28_295_30&#39;)"><span class="hl_vardecl"><span class="mpre">f&#39;</span></span></a><span class="mpre"> </span><a name="loc_295_31_295_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_31_295_34&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="mpre"> _) &lt;- </span><a href="#loc_294_28_294_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_28_294_34&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">, </span><a href="#loc_295_28_295_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_28_295_30&#39;)"><span class="hl_varref"><span class="mpre">f&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_294_35_294_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_35_294_36&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> ] of
    []      -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    (</span><a name="loc_297_6_297_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_6_297_9&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="Text.PrettyPrint.HughesPJ.html#loc_809_1_809_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_809_1_809_12&#39;)"><span class="hl_varref"><span class="mpre">renderStyle</span></span></a><span class="mpre"> </span><a href="#loc_298_8_298_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_8_298_15&#39;)"><span class="hl_varref"><span class="mpre">myStyle</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_297_6_297_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_6_297_9&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">)
 where </span><a name="loc_298_8_298_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_8_298_15&#39;)"><span class="hl_vardecl"><span class="mpre">myStyle</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 298, srcSpanStartColumn = 18, srcSpanEndLine = 298, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 298, srcSpanStartColumn = 24, srcSpanEndLine = 298, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUti"><span class="mpre">style { mode = LeftMode }</span></span><span class="mpre">

</span><a href="#loc_301_1_301_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_1_301_12&#39;)"><span class="mpre">parseFields</span></a><span class="mpre"> :: [</span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_301_1_301_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_1_301_12&#39;)"><span class="hl_fundecl"><span class="mpre">parseFields</span></span></a><span class="mpre"> </span><a name="loc_301_13_301_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_13_301_19&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> </span><a name="loc_301_20_301_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_20_301_27&#39;)"><span class="hl_vardecl"><span class="mpre">initial</span></span></a><span class="mpre"> </span><a name="loc_301_28_301_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_28_301_31&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> =
  </span><a href="#loc_379_1_379_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_1_379_11&#39;)"><span class="hl_varref"><span class="mpre">readFields</span></span></a><span class="mpre"> </span><a href="#loc_301_28_301_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_28_301_31&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_309_1_309_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_12&#39;)"><span class="hl_varref"><span class="mpre">accumFields</span></span></a><span class="mpre"> </span><a href="#loc_301_13_301_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_13_301_19&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre"> </span><a href="#loc_301_20_301_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_20_301_27&#39;)"><span class="hl_varref"><span class="mpre">initial</span></span></a><span class="mpre">

</span><a href="#loc_305_1_305_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_1_305_16&#39;)"><span class="mpre">parseFieldsFlat</span></a><span class="mpre"> :: [</span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_305_1_305_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_1_305_16&#39;)"><span class="hl_fundecl"><span class="mpre">parseFieldsFlat</span></span></a><span class="mpre"> </span><a name="loc_305_17_305_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_17_305_23&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> </span><a name="loc_305_24_305_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_24_305_31&#39;)"><span class="hl_vardecl"><span class="mpre">initial</span></span></a><span class="mpre"> </span><a name="loc_305_32_305_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_32_305_35&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> =
  </span><a href="#loc_387_1_387_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_15&#39;)"><span class="hl_varref"><span class="mpre">readFieldsFlat</span></span></a><span class="mpre"> </span><a href="#loc_305_32_305_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_32_305_35&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_309_1_309_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_12&#39;)"><span class="hl_varref"><span class="mpre">accumFields</span></span></a><span class="mpre"> </span><a href="#loc_305_17_305_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_17_305_23&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre"> </span><a href="#loc_305_24_305_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_24_305_31&#39;)"><span class="hl_varref"><span class="mpre">initial</span></span></a><span class="mpre">

</span><a href="#loc_309_1_309_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_12&#39;)"><span class="mpre">accumFields</span></a><span class="mpre"> :: [</span><a href="#loc_189_6_189_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_6_189_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><a href="#loc_343_6_343_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_6_343_11&#39;)"><span class="hl_tyconref"><span class="mpre">Field</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_309_1_309_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_12&#39;)"><span class="hl_fundecl"><span class="mpre">accumFields</span></span></a><span class="mpre"> </span><a name="loc_309_13_309_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_13_309_19&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_240_1_240_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_240_1_240_6&#39;)"><span class="hl_varref"><span class="mpre">foldM</span></span></a><span class="mpre"> </span><a href="#loc_313_5_313_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_5_313_13&#39;)"><span class="hl_varref"><span class="mpre">setField</span></span></a><span class="mpre">
  where
    </span><a name="loc_311_5_311_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_5_311_13&#39;)"><span class="hl_vardecl"><span class="mpre">fieldMap</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">Map.fromList</span></span><span class="mpre">
      [ (</span><a href="#loc_312_35_312_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_35_312_39&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">, </span><a href="#loc_312_21_312_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_21_312_22&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) | </span><a name="loc_312_21_312_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_21_312_22&#39;)"><span class="hl_specname"><span class="mpre">f</span></span></a><span class="mpre">@(</span><a href="#loc_190_5_190_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_15&#39;)"><span class="hl_conref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> </span><a name="loc_312_35_312_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_35_312_39&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> _ _) &lt;- </span><a href="#loc_309_13_309_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_13_309_19&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre"> ]
    </span><a name="loc_313_5_313_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_5_313_13&#39;)"><span class="hl_fundecl"><span class="mpre">setField</span></span></a><span class="mpre"> </span><a name="loc_313_14_313_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_14_313_19&#39;)"><span class="hl_vardecl"><span class="mpre">accum</span></span></a><span class="mpre"> (</span><a href="#loc_344_7_344_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_7_344_8&#39;)"><span class="hl_conref"><span class="mpre">F</span></span></a><span class="mpre"> </span><a name="loc_313_23_313_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_23_313_27&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> </span><a name="loc_313_28_313_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_28_313_32&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_313_33_313_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_33_313_38&#39;)"><span class="hl_vardecl"><span class="mpre">value</span></span></a><span class="mpre">) = case </span><span class="hl_varref"><span class="mpre">Map.lookup</span></span><span class="mpre"> </span><a href="#loc_313_28_313_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_28_313_32&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_311_5_311_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_5_311_13&#39;)"><span class="hl_varref"><span class="mpre">fieldMap</span></span></a><span class="mpre"> of
      </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_190_5_190_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_15&#39;)"><span class="hl_conref"><span class="mpre">FieldDescr</span></span></a><span class="mpre"> _ _ </span><a name="loc_314_28_314_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_28_314_31&#39;)"><span class="hl_vardecl"><span class="mpre">set</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_314_28_314_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_28_314_31&#39;)"><span class="hl_varref"><span class="mpre">set</span></span></a><span class="mpre"> </span><a href="#loc_313_23_313_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_23_313_27&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre"> </span><a href="#loc_313_33_313_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_33_313_38&#39;)"><span class="hl_varref"><span class="mpre">value</span></span></a><span class="mpre"> </span><a href="#loc_313_14_313_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_14_313_19&#39;)"><span class="hl_varref"><span class="mpre">accum</span></span></a><span class="mpre">
      </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; do
        </span><a href="#loc_185_1_185_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_8&#39;)"><span class="hl_varref"><span class="mpre">warning</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Unrecognized field &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_313_28_313_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_28_313_32&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; on line &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_313_23_313_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_23_313_27&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">)
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_313_14_313_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_14_313_19&#39;)"><span class="hl_varref"><span class="mpre">accum</span></span></a><span class="mpre">
    </span><a href="#loc_313_5_313_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_5_313_13&#39;)"><span class="hl_fundecl"><span class="mpre">setField</span></span></a><span class="mpre"> </span><a name="loc_318_14_318_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_14_318_19&#39;)"><span class="hl_vardecl"><span class="mpre">accum</span></span></a><span class="mpre"> </span><a name="loc_318_20_318_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_20_318_21&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
      </span><a href="#loc_185_1_185_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_8&#39;)"><span class="hl_varref"><span class="mpre">warning</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Unrecognized stanza on line &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_369_1_369_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_1_369_7&#39;)"><span class="hl_varref"><span class="mpre">lineNo</span></span></a><span class="mpre"> </span><a href="#loc_318_20_318_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_20_318_21&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">))
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_318_14_318_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_14_318_19&#39;)"><span class="hl_varref"><span class="mpre">accum</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The type of a function which, given a name-value pair of an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   unrecognized field, and the current structure being built,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   decides whether to incorporate the unrecognized field</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   (by returning  Just x, where x is a possibly modified version</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   of the structure being built), or not (by returning Nothing).</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 327, srcSpanStartColumn = 1, srcSpanEndLine = 327, srcSpanEndColumn = 58}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 327, srcSpanStartColumn = 1, srcSpanEndLine = 327, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.h"><span class="mpre">type UnrecFieldParser a = (String,String) -&gt; a -&gt; Maybe a</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A default unrecognized field parser which simply returns Nothing,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   i.e. ignores all unrecognized fields, so warnings will be generated.</span></span><span class="mpre">
</span><a href="#loc_332_1_332_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_1_332_10&#39;)"><span class="mpre">warnUnrec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">UnrecFieldParser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_332_1_332_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_1_332_10&#39;)"><span class="hl_fundecl"><span class="mpre">warnUnrec</span></span></a><span class="mpre"> _ _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A default unrecognized field parser which silently (i.e. no</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   warnings will be generated) ignores unrecognized fields, by</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   returning the structure being built unmodified.</span></span><span class="mpre">
</span><a href="#loc_338_1_338_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_1_338_12&#39;)"><span class="mpre">ignoreUnrec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">UnrecFieldParser</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_338_1_338_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_1_338_12&#39;)"><span class="hl_fundecl"><span class="mpre">ignoreUnrec</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- The data type for our three syntactic categories</span></span><span class="mpre">
data </span><a name="loc_343_6_343_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_6_343_11&#39;)"><span class="hl_tycondecl"><span class="mpre">Field</span></span></a><span class="mpre">
    = </span><a name="loc_344_7_344_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_7_344_8&#39;)"><span class="hl_condecl"><span class="mpre">F</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- ^ A regular @&lt;property&gt;: &lt;value&gt;@ field</span></span><span class="mpre">
    | </span><a name="loc_346_7_346_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_7_346_14&#39;)"><span class="hl_condecl"><span class="mpre">Section</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> [</span><a href="#loc_343_6_343_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_6_343_11&#39;)"><span class="hl_tyconref"><span class="mpre">Field</span></span></a><span class="mpre">]
      </span><span class="hl_comment"><span class="mpre">-- ^ A section with a name and possible parameter.  The syntactic</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- structure is:</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--   &lt;sectionname&gt; &lt;arg&gt; {</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--     &lt;field&gt;*</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--   }</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
    | </span><a name="loc_355_7_355_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_7_355_14&#39;)"><span class="hl_condecl"><span class="mpre">IfBlock</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> [</span><a href="#loc_343_6_343_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_6_343_11&#39;)"><span class="hl_tyconref"><span class="mpre">Field</span></span></a><span class="mpre">] [</span><a href="#loc_343_6_343_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_6_343_11&#39;)"><span class="hl_tyconref"><span class="mpre">Field</span></span></a><span class="mpre">]
      </span><span class="hl_comment"><span class="mpre">-- ^ A conditional block with an optional else branch:</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--  if &lt;condition&gt; {</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--    &lt;field&gt;*</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--  } else {</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--    &lt;field&gt;*</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--  }</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
      </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 365, srcSpanStartColumn = 7, srcSpanEndLine = 366, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 365, srcSpanStartColumn = 7, srcSpanEndLine = 365, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils."><span class="mpre">deriving (Show
               ,Eq)</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- for testing</span></span><span class="mpre">

</span><a href="#loc_369_1_369_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_1_369_7&#39;)"><span class="mpre">lineNo</span></a><span class="mpre"> :: </span><a href="#loc_343_6_343_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_6_343_11&#39;)"><span class="hl_tyconref"><span class="mpre">Field</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre">
</span><a name="loc_369_1_369_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_1_369_7&#39;)"><span class="hl_fundecl"><span class="mpre">lineNo</span></span></a><span class="mpre"> (</span><a href="#loc_344_7_344_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_7_344_8&#39;)"><span class="hl_conref"><span class="mpre">F</span></span></a><span class="mpre"> </span><a name="loc_369_11_369_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_11_369_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ _) = </span><a href="#loc_369_11_369_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_11_369_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
</span><a href="#loc_369_1_369_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_1_369_7&#39;)"><span class="hl_fundecl"><span class="mpre">lineNo</span></span></a><span class="mpre"> (</span><a href="#loc_346_7_346_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_7_346_14&#39;)"><span class="hl_conref"><span class="mpre">Section</span></span></a><span class="mpre"> </span><a name="loc_370_17_370_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_17_370_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ _ _) = </span><a href="#loc_370_17_370_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_17_370_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
</span><a href="#loc_369_1_369_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_1_369_7&#39;)"><span class="hl_fundecl"><span class="mpre">lineNo</span></span></a><span class="mpre"> (</span><a href="#loc_355_7_355_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_7_355_14&#39;)"><span class="hl_conref"><span class="mpre">IfBlock</span></span></a><span class="mpre"> </span><a name="loc_371_17_371_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_17_371_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ _ _) = </span><a href="#loc_371_17_371_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_17_371_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><a href="#loc_374_1_374_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_6&#39;)"><span class="mpre">fName</span></a><span class="mpre"> :: </span><a href="#loc_343_6_343_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_6_343_11&#39;)"><span class="hl_tyconref"><span class="mpre">Field</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_374_1_374_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_6&#39;)"><span class="hl_fundecl"><span class="mpre">fName</span></span></a><span class="mpre"> (</span><a href="#loc_344_7_344_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_7_344_8&#39;)"><span class="hl_conref"><span class="mpre">F</span></span></a><span class="mpre"> _ </span><a name="loc_374_12_374_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_12_374_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _) = </span><a href="#loc_374_12_374_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_12_374_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
</span><a href="#loc_374_1_374_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_6&#39;)"><span class="hl_fundecl"><span class="mpre">fName</span></span></a><span class="mpre"> (</span><a href="#loc_346_7_346_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_7_346_14&#39;)"><span class="hl_conref"><span class="mpre">Section</span></span></a><span class="mpre"> _ </span><a name="loc_375_18_375_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_18_375_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ _) = </span><a href="#loc_375_18_375_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_18_375_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
</span><a href="#loc_374_1_374_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_6&#39;)"><span class="hl_fundecl"><span class="mpre">fName</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;fname: not a field or section&quot;</span></span><span class="mpre">

</span><a href="#loc_379_1_379_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_1_379_11&#39;)"><span class="mpre">readFields</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> [</span><a href="#loc_343_6_343_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_6_343_11&#39;)"><span class="hl_tyconref"><span class="mpre">Field</span></span></a><span class="mpre">]
</span><a name="loc_379_1_379_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_1_379_11&#39;)"><span class="hl_fundecl"><span class="mpre">readFields</span></span></a><span class="mpre"> </span><a name="loc_379_12_379_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_12_379_17&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = </span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_varref"><span class="mpre">ifelse</span></span></a><span class="mpre">
               </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> (</span><a href="#loc_551_1_551_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_8&#39;)"><span class="hl_varref"><span class="mpre">mkField</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
               </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><a href="#loc_481_1_481_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_1_481_7&#39;)"><span class="hl_varref"><span class="mpre">mkTree</span></span></a><span class="mpre"> </span><a href="#loc_384_9_384_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_9_384_15&#39;)"><span class="hl_varref"><span class="mpre">tokens</span></span></a><span class="mpre">

  where </span><a name="loc_383_9_383_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_9_383_11&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">lines</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Distribution.Simple.Utils.html#loc_1264_1_1264_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_1264_1_1264_21&#39;)"><span class="hl_varref"><span class="mpre">normaliseLineEndings</span></span></a><span class="mpre">) </span><a href="#loc_379_12_379_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_12_379_17&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
        </span><a name="loc_384_9_384_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_9_384_15&#39;)"><span class="hl_vardecl"><span class="mpre">tokens</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_450_1_450_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_1_450_13&#39;)"><span class="hl_varref"><span class="mpre">tokeniseLine</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_394_1_394_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_10&#39;)"><span class="hl_varref"><span class="mpre">trimLines</span></span></a><span class="mpre">) </span><a href="#loc_383_9_383_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_9_383_11&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">

</span><a href="#loc_387_1_387_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_15&#39;)"><span class="mpre">readFieldsFlat</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> [</span><a href="#loc_343_6_343_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_6_343_11&#39;)"><span class="hl_tyconref"><span class="mpre">Field</span></span></a><span class="mpre">]
</span><a name="loc_387_1_387_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_15&#39;)"><span class="hl_fundecl"><span class="mpre">readFieldsFlat</span></span></a><span class="mpre"> </span><a name="loc_387_16_387_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_16_387_21&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> (</span><a href="#loc_551_1_551_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_8&#39;)"><span class="hl_varref"><span class="mpre">mkField</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
                   </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><a href="#loc_481_1_481_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_1_481_7&#39;)"><span class="hl_varref"><span class="mpre">mkTree</span></span></a><span class="mpre"> </span><a href="#loc_390_9_390_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_9_390_15&#39;)"><span class="hl_varref"><span class="mpre">tokens</span></span></a><span class="mpre">
  where </span><a name="loc_389_9_389_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_9_389_11&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">lines</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Distribution.Simple.Utils.html#loc_1264_1_1264_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_1264_1_1264_21&#39;)"><span class="hl_varref"><span class="mpre">normaliseLineEndings</span></span></a><span class="mpre">) </span><a href="#loc_387_16_387_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_16_387_21&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
        </span><a name="loc_390_9_390_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_9_390_15&#39;)"><span class="hl_vardecl"><span class="mpre">tokens</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_466_1_466_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_1_466_17&#39;)"><span class="hl_varref"><span class="mpre">tokeniseLineFlat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_394_1_394_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_10&#39;)"><span class="hl_varref"><span class="mpre">trimLines</span></span></a><span class="mpre">) </span><a href="#loc_389_9_389_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_9_389_11&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- attach line number and determine indentation</span></span><span class="mpre">
</span><a href="#loc_394_1_394_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_10&#39;)"><span class="mpre">trimLines</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [(</span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Indent</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">HasTabs</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
</span><a name="loc_394_1_394_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_10&#39;)"><span class="hl_fundecl"><span class="mpre">trimLines</span></span></a><span class="mpre"> </span><a name="loc_394_11_394_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_11_394_13&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> = [ (</span><a href="#loc_395_19_395_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_19_395_25&#39;)"><span class="hl_varref"><span class="mpre">lineno</span></span></a><span class="mpre">, </span><a href="#loc_397_22_397_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_22_397_28&#39;)"><span class="hl_varref"><span class="mpre">indent</span></span></a><span class="mpre">, </span><a href="#loc_398_22_398_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_22_398_29&#39;)"><span class="hl_varref"><span class="mpre">hastabs</span></span></a><span class="mpre">, </span><a href="#loc_474_1_474_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_13&#39;)"><span class="hl_varref"><span class="mpre">trimTrailing</span></span></a><span class="mpre"> </span><a href="#loc_396_28_396_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_28_396_30&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">)
               | (</span><a name="loc_395_19_395_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_19_395_25&#39;)"><span class="hl_vardecl"><span class="mpre">lineno</span></span></a><span class="mpre">, </span><a name="loc_395_27_395_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_27_395_28&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">zip</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 395, srcSpanStartColumn = 37, srcSpanEndLine = 395, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 395, srcSpanStartColumn = 37, srcSpanEndLine = 395, srcSpanEndColumn = 38},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtil"><span class="mpre">[1..]</span></span><span class="mpre"> </span><a href="#loc_394_11_394_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_11_394_13&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">
               , let (</span><a name="loc_396_23_396_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_23_396_26&#39;)"><span class="hl_vardecl"><span class="mpre">sps</span></span></a><span class="mpre">, </span><a name="loc_396_28_396_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_28_396_30&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><a href="#loc_395_27_395_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_27_395_28&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
                     </span><a name="loc_397_22_397_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_22_397_28&#39;)"><span class="hl_vardecl"><span class="mpre">indent</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_396_23_396_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_23_396_26&#39;)"><span class="hl_varref"><span class="mpre">sps</span></span></a><span class="mpre">
                     </span><a name="loc_398_22_398_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_22_398_29&#39;)"><span class="hl_vardecl"><span class="mpre">hastabs</span></span></a><span class="mpre">   = </span><span class="hl_char"><span class="mpre">&#39;\t&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_396_23_396_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_23_396_26&#39;)"><span class="hl_varref"><span class="mpre">sps</span></span></a><span class="mpre">
               , </span><a href="#loc_400_9_400_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_9_400_18&#39;)"><span class="hl_varref"><span class="mpre">validLine</span></span></a><span class="mpre"> </span><a href="#loc_396_28_396_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_28_396_30&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> ]
  where </span><a name="loc_400_9_400_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_9_400_18&#39;)"><span class="hl_fundecl"><span class="mpre">validLine</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- Comment</span></span><span class="mpre">
        </span><a href="#loc_400_9_400_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_9_400_18&#39;)"><span class="hl_fundecl"><span class="mpre">validLine</span></span></a><span class="mpre"> []          = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- blank line</span></span><span class="mpre">
        </span><a href="#loc_400_9_400_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_9_400_18&#39;)"><span class="hl_fundecl"><span class="mpre">validLine</span></span></a><span class="mpre"> _           = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | We parse generically based on indent level and braces &#39;{&#39; &#39;}&#39;. To do that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- we split into lines and then &#39;{&#39; &#39;}&#39; tokens and other spans within a line.</span></span><span class="mpre">
data </span><a name="loc_406_6_406_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_6_406_11&#39;)"><span class="hl_tycondecl"><span class="mpre">Token</span></span></a><span class="mpre"> =
       </span><span class="hl_comment"><span class="mpre">-- | The &#39;Line&#39; token is for bits that /start/ a line, eg:</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- &gt; &quot;\n  blah blah { blah&quot;</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- tokenises to:</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- &gt; [Line n 2 False &quot;blah blah&quot;, OpenBracket, Span n &quot;blah&quot;]</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- so lines are the only ones that can have nested layout, since they</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- have a known indentation level.</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- eg: we can&#39;t have this:</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- &gt; if ... {</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- &gt; } else</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- &gt;     other</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- because other cannot nest under else, since else doesn&#39;t start a line</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- so cannot have nested layout. It&#39;d have to be:</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- &gt; if ... {</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- &gt; }</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- &gt;   else</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- &gt;     other</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- but that&#39;s not so common, people would normally use layout or</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- brackets not both in a single @if else@ construct.</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- &gt; if ... { foo : bar }</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- &gt; else</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- &gt;    other</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- this is ok</span></span><span class="mpre">
       </span><a name="loc_440_8_440_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_8_440_12&#39;)"><span class="hl_condecl"><span class="mpre">Line</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Indent</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HasTabs</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
     | </span><a name="loc_441_8_441_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_8_441_12&#39;)"><span class="hl_condecl"><span class="mpre">Span</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre">                </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ span in a line, following brackets</span></span><span class="mpre">
     | </span><a name="loc_442_8_442_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_8_442_19&#39;)"><span class="hl_condecl"><span class="mpre">OpenBracket</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre"> | </span><a name="loc_442_29_442_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_29_442_41&#39;)"><span class="hl_condecl"><span class="mpre">CloseBracket</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 444, srcSpanStartColumn = 1, srcSpanEndLine = 444, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 444, srcSpanStartColumn = 1, srcSpanEndLine = 444, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.h"><span class="mpre">type Indent = Int</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 445, srcSpanStartColumn = 1, srcSpanEndLine = 445, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 445, srcSpanStartColumn = 1, srcSpanEndLine = 445, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.h"><span class="mpre">type HasTabs = Bool</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Tokenise a single line, splitting on &#39;{&#39; &#39;}&#39; and the spans inbetween.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Also trims leading &amp; trailing space on those spans within the line.</span></span><span class="mpre">
</span><a href="#loc_450_1_450_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_1_450_13&#39;)"><span class="mpre">tokeniseLine</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Indent</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">HasTabs</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) -&gt; [</span><a href="#loc_406_6_406_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_6_406_11&#39;)"><span class="hl_tyconref"><span class="mpre">Token</span></span></a><span class="mpre">]
</span><a name="loc_450_1_450_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_1_450_13&#39;)"><span class="hl_fundecl"><span class="mpre">tokeniseLine</span></span></a><span class="mpre"> (</span><a name="loc_450_15_450_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_15_450_17&#39;)"><span class="hl_vardecl"><span class="mpre">n0</span></span></a><span class="mpre">, </span><a name="loc_450_19_450_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_19_450_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">, </span><a name="loc_450_22_450_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_22_450_23&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">, </span><a name="loc_450_25_450_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_25_450_26&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = case </span><a href="#loc_453_9_453_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_9_453_14&#39;)"><span class="hl_varref"><span class="mpre">split</span></span></a><span class="mpre"> </span><a href="#loc_450_15_450_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_15_450_17&#39;)"><span class="hl_varref"><span class="mpre">n0</span></span></a><span class="mpre"> </span><a href="#loc_450_25_450_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_25_450_26&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> of
                            (</span><a href="#loc_441_8_441_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_8_441_12&#39;)"><span class="hl_conref"><span class="mpre">Span</span></span></a><span class="mpre"> _ </span><a name="loc_451_37_451_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_37_451_39&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_451_40_451_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_40_451_42&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_440_8_440_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_8_440_12&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre"> </span><a href="#loc_450_15_450_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_15_450_17&#39;)"><span class="hl_varref"><span class="mpre">n0</span></span></a><span class="mpre"> </span><a href="#loc_450_19_450_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_19_450_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_450_22_450_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_22_450_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_451_37_451_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_37_451_39&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_451_40_451_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_40_451_42&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
                            </span><a name="loc_452_29_452_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_29_452_31&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">              -&gt; </span><a href="#loc_452_29_452_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_29_452_31&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  where </span><a name="loc_453_9_453_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_9_453_14&#39;)"><span class="hl_fundecl"><span class="mpre">split</span></span></a><span class="mpre"> _ </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> = []
        </span><a href="#loc_453_9_453_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_9_453_14&#39;)"><span class="hl_fundecl"><span class="mpre">split</span></span></a><span class="mpre"> </span><a name="loc_454_15_454_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_15_454_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_454_17_454_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_17_454_18&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">  = case </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> (\</span><a name="loc_454_34_454_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_34_454_35&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_454_34_454_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_34_454_35&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="hl_char"><span class="mpre">&#39;}&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_454_34_454_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_34_454_35&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="mpre">) </span><a href="#loc_454_17_454_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_17_454_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
          (</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, </span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_455_22_455_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_455_22_455_24&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) -&gt;             </span><a href="#loc_442_8_442_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_8_442_19&#39;)"><span class="hl_conref"><span class="mpre">OpenBracket</span></span></a><span class="mpre">  </span><a href="#loc_454_15_454_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_15_454_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_453_9_453_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_9_453_14&#39;)"><span class="hl_varref"><span class="mpre">split</span></span></a><span class="mpre"> </span><a href="#loc_454_15_454_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_15_454_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_455_22_455_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_455_22_455_24&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
          (</span><a name="loc_456_12_456_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_12_456_13&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> , </span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_456_22_456_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_22_456_24&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_461_9_461_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_9_461_15&#39;)"><span class="hl_varref"><span class="mpre">mkspan</span></span></a><span class="mpre"> </span><a href="#loc_454_15_454_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_15_454_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_456_12_456_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_12_456_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> (</span><a href="#loc_442_8_442_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_8_442_19&#39;)"><span class="hl_conref"><span class="mpre">OpenBracket</span></span></a><span class="mpre">  </span><a href="#loc_454_15_454_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_15_454_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_453_9_453_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_9_453_14&#39;)"><span class="hl_varref"><span class="mpre">split</span></span></a><span class="mpre"> </span><a href="#loc_454_15_454_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_15_454_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_456_22_456_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_22_456_24&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">)
          (</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, </span><span class="hl_char"><span class="mpre">&#39;}&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_457_22_457_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_457_22_457_24&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) -&gt;             </span><a href="#loc_442_29_442_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_29_442_41&#39;)"><span class="hl_conref"><span class="mpre">CloseBracket</span></span></a><span class="mpre"> </span><a href="#loc_454_15_454_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_15_454_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_453_9_453_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_9_453_14&#39;)"><span class="hl_varref"><span class="mpre">split</span></span></a><span class="mpre"> </span><a href="#loc_454_15_454_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_15_454_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_457_22_457_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_457_22_457_24&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
          (</span><a name="loc_458_12_458_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_12_458_13&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> , </span><span class="hl_char"><span class="mpre">&#39;}&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_458_22_458_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_22_458_24&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_461_9_461_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_9_461_15&#39;)"><span class="hl_varref"><span class="mpre">mkspan</span></span></a><span class="mpre"> </span><a href="#loc_454_15_454_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_15_454_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_458_12_458_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_12_458_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> (</span><a href="#loc_442_29_442_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_29_442_41&#39;)"><span class="hl_conref"><span class="mpre">CloseBracket</span></span></a><span class="mpre"> </span><a href="#loc_454_15_454_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_15_454_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_453_9_453_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_9_453_14&#39;)"><span class="hl_varref"><span class="mpre">split</span></span></a><span class="mpre"> </span><a href="#loc_454_15_454_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_15_454_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_458_22_458_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_22_458_24&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">)
          (</span><a name="loc_459_12_459_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_12_459_13&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> ,        _) -&gt; </span><a href="#loc_461_9_461_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_9_461_15&#39;)"><span class="hl_varref"><span class="mpre">mkspan</span></span></a><span class="mpre"> </span><a href="#loc_454_15_454_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_15_454_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_459_12_459_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_12_459_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> []

        </span><a name="loc_461_9_461_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_9_461_15&#39;)"><span class="hl_fundecl"><span class="mpre">mkspan</span></span></a><span class="mpre"> </span><a name="loc_461_16_461_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_16_461_17&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_461_18_461_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_18_461_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_461_20_461_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_20_461_22&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_463_17_463_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_463_17_463_19&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">   =             </span><a href="#loc_461_20_461_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_20_461_22&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
                      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_441_8_441_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_8_441_12&#39;)"><span class="hl_conref"><span class="mpre">Span</span></span></a><span class="mpre"> </span><a href="#loc_461_16_461_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_16_461_17&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_463_17_463_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_463_17_463_19&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_461_20_461_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_20_461_22&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
          where </span><a name="loc_463_17_463_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_463_17_463_19&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_474_1_474_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_13&#39;)"><span class="hl_varref"><span class="mpre">trimTrailing</span></span></a><span class="mpre"> (</span><a href="#loc_473_1_473_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_1_473_12&#39;)"><span class="hl_varref"><span class="mpre">trimLeading</span></span></a><span class="mpre"> </span><a href="#loc_461_18_461_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_18_461_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><a href="#loc_466_1_466_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_1_466_17&#39;)"><span class="mpre">tokeniseLineFlat</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Indent</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">HasTabs</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) -&gt; [</span><a href="#loc_406_6_406_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_6_406_11&#39;)"><span class="hl_tyconref"><span class="mpre">Token</span></span></a><span class="mpre">]
</span><a name="loc_466_1_466_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_1_466_17&#39;)"><span class="hl_fundecl"><span class="mpre">tokeniseLineFlat</span></span></a><span class="mpre"> (</span><a name="loc_466_19_466_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_19_466_21&#39;)"><span class="hl_vardecl"><span class="mpre">n0</span></span></a><span class="mpre">, </span><a name="loc_466_23_466_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_23_466_24&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">, </span><a name="loc_466_26_466_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_26_466_27&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">, </span><a name="loc_466_29_466_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_29_466_30&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">)
  | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_470_5_470_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_5_470_7&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">   = []
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = [</span><a href="#loc_440_8_440_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_8_440_12&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre"> </span><a href="#loc_466_19_466_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_19_466_21&#39;)"><span class="hl_varref"><span class="mpre">n0</span></span></a><span class="mpre"> </span><a href="#loc_466_23_466_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_23_466_24&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_466_26_466_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_26_466_27&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_470_5_470_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_5_470_7&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">]
  where
    </span><a name="loc_470_5_470_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_5_470_7&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_474_1_474_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_13&#39;)"><span class="hl_varref"><span class="mpre">trimTrailing</span></span></a><span class="mpre"> (</span><a href="#loc_473_1_473_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_1_473_12&#39;)"><span class="hl_varref"><span class="mpre">trimLeading</span></span></a><span class="mpre"> </span><a href="#loc_466_29_466_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_29_466_30&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)

</span><a href="#loc_473_1_473_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_1_473_12&#39;)"><span class="mpre">trimLeading</span></a><span class="mpre">, </span><a href="#loc_474_1_474_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_13&#39;)"><span class="mpre">trimTrailing</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_473_1_473_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_1_473_12&#39;)"><span class="hl_vardecl"><span class="mpre">trimLeading</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre">
</span><a name="loc_474_1_474_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_13&#39;)"><span class="hl_vardecl"><span class="mpre">trimTrailing</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre">


</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 477, srcSpanStartColumn = 1, srcSpanEndLine = 477, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 477, srcSpanStartColumn = 1, srcSpanEndLine = 477, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.h"><span class="mpre">type SyntaxTree = Tree (LineNo, HasTabs, String)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Parse the stream of tokens into a tree of them, based on indent \/ layout</span></span><span class="mpre">
</span><a href="#loc_481_1_481_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_1_481_7&#39;)"><span class="mpre">mkTree</span></a><span class="mpre"> :: [</span><a href="#loc_406_6_406_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_6_406_11&#39;)"><span class="hl_tyconref"><span class="mpre">Token</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">SyntaxTree</span></span><span class="mpre">]
</span><a name="loc_481_1_481_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_1_481_7&#39;)"><span class="hl_fundecl"><span class="mpre">mkTree</span></span></a><span class="mpre"> </span><a name="loc_481_8_481_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_8_481_12&#39;)"><span class="hl_vardecl"><span class="mpre">toks</span></span></a><span class="mpre"> =
  </span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> [] </span><a href="#loc_481_8_481_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_8_481_12&#39;)"><span class="hl_varref"><span class="mpre">toks</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \(</span><a name="loc_482_26_482_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_26_482_31&#39;)"><span class="hl_vardecl"><span class="mpre">trees</span></span></a><span class="mpre">, </span><a name="loc_482_33_482_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_33_482_41&#39;)"><span class="hl_vardecl"><span class="mpre">trailing</span></span></a><span class="mpre">) -&gt; case </span><a href="#loc_482_33_482_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_33_482_41&#39;)"><span class="hl_varref"><span class="mpre">trailing</span></span></a><span class="mpre"> of
    []               -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_482_26_482_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_26_482_31&#39;)"><span class="hl_varref"><span class="mpre">trees</span></span></a><span class="mpre">
    </span><a href="#loc_442_8_442_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_8_442_19&#39;)"><span class="hl_conref"><span class="mpre">OpenBracket</span></span></a><span class="mpre">  </span><a name="loc_484_18_484_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_484_18_484_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_ -&gt; </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_484_18_484_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_484_18_484_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;mismatched backets, unexpected {&quot;</span></span><span class="mpre">
    </span><a href="#loc_442_29_442_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_29_442_41&#39;)"><span class="hl_conref"><span class="mpre">CloseBracket</span></span></a><span class="mpre"> </span><a name="loc_485_18_485_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_18_485_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_ -&gt; </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_485_18_485_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_18_485_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;mismatched backets, unexpected }&quot;</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- the following two should never happen:</span></span><span class="mpre">
    </span><a href="#loc_441_8_441_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_8_441_12&#39;)"><span class="hl_conref"><span class="mpre">Span</span></span></a><span class="mpre"> </span><a name="loc_487_10_487_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_10_487_11&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">     </span><a name="loc_487_16_487_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_16_487_17&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_ -&gt; </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_487_10_487_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_10_487_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unexpected span: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_487_16_487_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_16_487_17&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
    </span><a href="#loc_440_8_440_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_8_440_12&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre"> </span><a name="loc_488_10_488_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_10_488_11&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ _ </span><a name="loc_488_16_488_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_16_488_17&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_ -&gt; </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_488_10_488_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_10_488_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unexpected line: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_488_16_488_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_16_488_17&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Parse the stream of tokens into a tree of them, based on indent</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This parse state expect to be in a layout context, though possibly</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- nested within a braces context so we may still encounter closing braces.</span></span><span class="mpre">
</span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="mpre">layout</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Indent</span></span><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ indent level of the parent\/previous line</span></span><span class="mpre">
       -&gt; [</span><span class="hl_tyconref"><span class="mpre">SyntaxTree</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ accumulating param, trees in this level</span></span><span class="mpre">
       -&gt; [</span><a href="#loc_406_6_406_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_6_406_11&#39;)"><span class="hl_tyconref"><span class="mpre">Token</span></span></a><span class="mpre">]      </span><span class="hl_comment"><span class="mpre">-- ^ remaining tokens</span></span><span class="mpre">
       -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> ([</span><span class="hl_tyconref"><span class="mpre">SyntaxTree</span></span><span class="mpre">], [</span><a href="#loc_406_6_406_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_6_406_11&#39;)"><span class="hl_tyconref"><span class="mpre">Token</span></span></a><span class="mpre">])
                       </span><span class="hl_comment"><span class="mpre">-- ^ collected trees on this level and trailing tokens</span></span><span class="mpre">
</span><a name="loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_fundecl"><span class="mpre">layout</span></span></a><span class="mpre"> _ </span><a name="loc_499_10_499_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_10_499_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> []                               = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_499_10_499_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_10_499_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, [])
</span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_fundecl"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a name="loc_500_8_500_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_8_500_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_500_10_500_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_10_500_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a name="loc_500_13_500_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_13_500_14&#39;)"><span class="hl_specname"><span class="mpre">s</span></span></a><span class="mpre">@(</span><a href="#loc_440_8_440_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_8_440_12&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre"> _ </span><a name="loc_500_23_500_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_23_500_25&#39;)"><span class="hl_vardecl"><span class="mpre">i&#39;</span></span></a><span class="mpre"> _ _)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_500_31_500_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_31_500_33&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) | </span><a href="#loc_500_23_500_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_23_500_25&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_500_8_500_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_8_500_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_500_10_500_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_10_500_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_500_13_500_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_13_500_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_500_31_500_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_31_500_33&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">)
</span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_fundecl"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a name="loc_501_8_501_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_8_501_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_501_10_501_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_10_501_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_440_8_440_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_8_440_12&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre"> </span><a name="loc_501_18_501_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_18_501_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ </span><a name="loc_501_22_501_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_22_501_23&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_501_24_501_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_24_501_25&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_442_8_442_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_8_442_19&#39;)"><span class="hl_conref"><span class="mpre">OpenBracket</span></span></a><span class="mpre"> </span><a name="loc_501_38_501_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_38_501_40&#39;)"><span class="hl_vardecl"><span class="mpre">n&#39;</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_501_41_501_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_41_501_43&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) = do
    (</span><a name="loc_502_6_502_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_6_502_9&#39;)"><span class="hl_vardecl"><span class="mpre">sub</span></span></a><span class="mpre">, </span><a name="loc_502_11_502_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_11_502_14&#39;)"><span class="hl_vardecl"><span class="mpre">ss&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_varref"><span class="mpre">braces</span></span></a><span class="mpre"> </span><a href="#loc_501_38_501_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_38_501_40&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> [] </span><a href="#loc_501_41_501_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_41_501_43&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
    </span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_501_8_501_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_8_501_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a href="#loc_501_18_501_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_18_501_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">,</span><a href="#loc_501_22_501_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_22_501_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">,</span><a href="#loc_501_24_501_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_24_501_25&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_502_6_502_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_6_502_9&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_501_10_501_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_10_501_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_502_11_502_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_11_502_14&#39;)"><span class="hl_varref"><span class="mpre">ss&#39;</span></span></a><span class="mpre">

</span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_fundecl"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a name="loc_505_8_505_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_8_505_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_505_10_505_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_10_505_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_441_8_441_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_8_441_12&#39;)"><span class="hl_conref"><span class="mpre">Span</span></span></a><span class="mpre"> </span><a name="loc_505_18_505_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_18_505_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">     </span><a name="loc_505_24_505_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_24_505_25&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_442_8_442_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_8_442_19&#39;)"><span class="hl_conref"><span class="mpre">OpenBracket</span></span></a><span class="mpre"> </span><a name="loc_505_38_505_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_38_505_40&#39;)"><span class="hl_vardecl"><span class="mpre">n&#39;</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_505_41_505_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_41_505_43&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) = do
    (</span><a name="loc_506_6_506_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_6_506_9&#39;)"><span class="hl_vardecl"><span class="mpre">sub</span></span></a><span class="mpre">, </span><a name="loc_506_11_506_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_11_506_14&#39;)"><span class="hl_vardecl"><span class="mpre">ss&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_varref"><span class="mpre">braces</span></span></a><span class="mpre"> </span><a href="#loc_505_38_505_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_38_505_40&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> [] </span><a href="#loc_505_41_505_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_41_505_43&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
    </span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_505_8_505_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_8_505_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a href="#loc_505_18_505_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_18_505_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">,</span><a href="#loc_505_24_505_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_24_505_25&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_506_6_506_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_6_506_9&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_505_10_505_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_10_505_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_506_11_506_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_11_506_14&#39;)"><span class="hl_varref"><span class="mpre">ss&#39;</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- look ahead to see if following lines are more indented, giving a sub-tree</span></span><span class="mpre">
</span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_fundecl"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a name="loc_510_8_510_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_8_510_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_510_10_510_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_10_510_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_440_8_440_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_8_440_12&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre"> </span><a name="loc_510_18_510_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_18_510_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_510_20_510_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_20_510_22&#39;)"><span class="hl_vardecl"><span class="mpre">i&#39;</span></span></a><span class="mpre"> </span><a name="loc_510_23_510_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_23_510_24&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_510_25_510_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_25_510_26&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_510_27_510_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_27_510_29&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) = do
    </span><a name="loc_511_5_511_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_5_511_14&#39;)"><span class="hl_vardecl"><span class="mpre">lookahead</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> (</span><a href="#loc_510_20_510_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_20_510_22&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) [] </span><a href="#loc_510_27_510_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_27_510_29&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
    case </span><a href="#loc_511_5_511_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_5_511_14&#39;)"><span class="hl_varref"><span class="mpre">lookahead</span></span></a><span class="mpre"> of
        ([], _)   -&gt; </span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_510_8_510_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_8_510_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a href="#loc_510_18_510_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_18_510_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">,</span><a href="#loc_510_23_510_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_23_510_24&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">,</span><a href="#loc_510_25_510_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_25_510_26&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) [] </span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_510_10_510_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_10_510_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_510_27_510_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_27_510_29&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
        (</span><a name="loc_514_10_514_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_10_514_12&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">, </span><a name="loc_514_14_514_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_14_514_17&#39;)"><span class="hl_vardecl"><span class="mpre">ss&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> </span><a href="#loc_510_8_510_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_8_510_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a href="#loc_510_18_510_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_18_510_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">,</span><a href="#loc_510_23_510_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_23_510_24&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">,</span><a href="#loc_510_25_510_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_25_510_26&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_514_10_514_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_10_514_12&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_510_10_510_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_10_510_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_514_14_514_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_14_514_17&#39;)"><span class="hl_varref"><span class="mpre">ss&#39;</span></span></a><span class="mpre">

</span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_fundecl"><span class="mpre">layout</span></span></a><span class="mpre"> _ _ (   </span><a href="#loc_442_8_442_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_8_442_19&#39;)"><span class="hl_conref"><span class="mpre">OpenBracket</span></span></a><span class="mpre">  </span><a name="loc_516_29_516_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_29_516_30&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)  = </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_516_29_516_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_29_516_30&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unexpected &#39;{&#39;&quot;</span></span><span class="mpre">
</span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_fundecl"><span class="mpre">layout</span></span></a><span class="mpre"> _ </span><a name="loc_517_10_517_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_10_517_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a name="loc_517_13_517_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_13_517_14&#39;)"><span class="hl_specname"><span class="mpre">s</span></span></a><span class="mpre">@(</span><a href="#loc_442_29_442_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_29_442_41&#39;)"><span class="hl_conref"><span class="mpre">CloseBracket</span></span></a><span class="mpre"> _)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_517_32_517_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_32_517_34&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_517_10_517_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_10_517_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_517_13_517_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_13_517_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_517_32_517_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_32_517_34&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">)
</span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_fundecl"><span class="mpre">layout</span></span></a><span class="mpre"> _ _ (   </span><a href="#loc_441_8_441_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_8_441_12&#39;)"><span class="hl_conref"><span class="mpre">Span</span></span></a><span class="mpre"> </span><a name="loc_518_21_518_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_21_518_22&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_518_23_518_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_23_518_24&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">       </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> _) = </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_518_21_518_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_21_518_22&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unexpected span: &quot;</span></span><span class="mpre">
                                                  </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_518_23_518_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_23_518_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Parse the stream of tokens into a tree of them, based on explicit braces</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This parse state expects to find a closing bracket.</span></span><span class="mpre">
</span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="mpre">braces</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">LineNo</span></span><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ line of the &#39;{&#39;, used for error messages</span></span><span class="mpre">
       -&gt; [</span><span class="hl_tyconref"><span class="mpre">SyntaxTree</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ accumulating param, trees in this level</span></span><span class="mpre">
       -&gt; [</span><a href="#loc_406_6_406_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_6_406_11&#39;)"><span class="hl_tyconref"><span class="mpre">Token</span></span></a><span class="mpre">]      </span><span class="hl_comment"><span class="mpre">-- ^ remaining tokens</span></span><span class="mpre">
       -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> ([</span><span class="hl_tyconref"><span class="mpre">SyntaxTree</span></span><span class="mpre">],[</span><a href="#loc_406_6_406_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_6_406_11&#39;)"><span class="hl_tyconref"><span class="mpre">Token</span></span></a><span class="mpre">])
                       </span><span class="hl_comment"><span class="mpre">-- ^ collected trees on this level and trailing tokens</span></span><span class="mpre">
</span><a name="loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_fundecl"><span class="mpre">braces</span></span></a><span class="mpre"> </span><a name="loc_528_8_528_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_8_528_9&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_528_10_528_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_10_528_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_440_8_440_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_8_440_12&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre"> </span><a name="loc_528_18_528_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_18_528_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ </span><a name="loc_528_22_528_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_22_528_23&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_528_24_528_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_24_528_25&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_442_8_442_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_8_442_19&#39;)"><span class="hl_conref"><span class="mpre">OpenBracket</span></span></a><span class="mpre"> </span><a name="loc_528_38_528_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_38_528_40&#39;)"><span class="hl_vardecl"><span class="mpre">n&#39;</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_528_41_528_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_41_528_43&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) = do
    (</span><a name="loc_529_6_529_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_6_529_9&#39;)"><span class="hl_vardecl"><span class="mpre">sub</span></span></a><span class="mpre">, </span><a name="loc_529_11_529_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_11_529_14&#39;)"><span class="hl_vardecl"><span class="mpre">ss&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_varref"><span class="mpre">braces</span></span></a><span class="mpre"> </span><a href="#loc_528_38_528_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_38_528_40&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> [] </span><a href="#loc_528_41_528_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_41_528_43&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
    </span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_varref"><span class="mpre">braces</span></span></a><span class="mpre"> </span><a href="#loc_528_8_528_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_8_528_9&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a href="#loc_528_18_528_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_18_528_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">,</span><a href="#loc_528_22_528_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_22_528_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">,</span><a href="#loc_528_24_528_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_24_528_25&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_529_6_529_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_6_529_9&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_528_10_528_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_10_528_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_529_11_529_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_11_529_14&#39;)"><span class="hl_varref"><span class="mpre">ss&#39;</span></span></a><span class="mpre">

</span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_fundecl"><span class="mpre">braces</span></span></a><span class="mpre"> </span><a name="loc_532_8_532_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_8_532_9&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_532_10_532_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_10_532_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_441_8_441_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_8_441_12&#39;)"><span class="hl_conref"><span class="mpre">Span</span></span></a><span class="mpre"> </span><a name="loc_532_18_532_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_18_532_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">     </span><a name="loc_532_24_532_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_24_532_25&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_442_8_442_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_8_442_19&#39;)"><span class="hl_conref"><span class="mpre">OpenBracket</span></span></a><span class="mpre"> </span><a name="loc_532_38_532_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_38_532_40&#39;)"><span class="hl_vardecl"><span class="mpre">n&#39;</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_532_41_532_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_41_532_43&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) = do
    (</span><a name="loc_533_6_533_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_6_533_9&#39;)"><span class="hl_vardecl"><span class="mpre">sub</span></span></a><span class="mpre">, </span><a name="loc_533_11_533_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_11_533_14&#39;)"><span class="hl_vardecl"><span class="mpre">ss&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_varref"><span class="mpre">braces</span></span></a><span class="mpre"> </span><a href="#loc_532_38_532_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_38_532_40&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> [] </span><a href="#loc_532_41_532_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_41_532_43&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
    </span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_varref"><span class="mpre">braces</span></span></a><span class="mpre"> </span><a href="#loc_532_8_532_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_8_532_9&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a href="#loc_532_18_532_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_18_532_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">,</span><a href="#loc_532_24_532_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_24_532_25&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_533_6_533_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_6_533_9&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_532_10_532_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_10_532_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_533_11_533_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_11_533_14&#39;)"><span class="hl_varref"><span class="mpre">ss&#39;</span></span></a><span class="mpre">

</span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_fundecl"><span class="mpre">braces</span></span></a><span class="mpre"> </span><a name="loc_536_8_536_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_8_536_9&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_536_10_536_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_10_536_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_440_8_440_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_8_440_12&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre"> </span><a name="loc_536_18_536_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_18_536_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_536_20_536_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_20_536_21&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_536_22_536_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_22_536_23&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_536_24_536_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_24_536_25&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_536_26_536_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_26_536_28&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) = do
    </span><a name="loc_537_5_537_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_537_5_537_14&#39;)"><span class="hl_vardecl"><span class="mpre">lookahead</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_499_1_499_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_1_499_7&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> (</span><a href="#loc_536_20_536_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_20_536_21&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) [] </span><a href="#loc_536_26_536_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_26_536_28&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
    case </span><a href="#loc_537_5_537_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_537_5_537_14&#39;)"><span class="hl_varref"><span class="mpre">lookahead</span></span></a><span class="mpre"> of
        ([], _)   -&gt; </span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_varref"><span class="mpre">braces</span></span></a><span class="mpre"> </span><a href="#loc_536_8_536_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_8_536_9&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a href="#loc_536_18_536_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_18_536_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">,</span><a href="#loc_536_22_536_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_22_536_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">,</span><a href="#loc_536_24_536_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_24_536_25&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) [] </span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_536_10_536_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_10_536_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_536_26_536_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_26_536_28&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
        (</span><a name="loc_540_10_540_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_10_540_12&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">, </span><a name="loc_540_14_540_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_14_540_17&#39;)"><span class="hl_vardecl"><span class="mpre">ss&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_varref"><span class="mpre">braces</span></span></a><span class="mpre"> </span><a href="#loc_536_8_536_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_8_536_9&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a href="#loc_536_18_536_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_18_536_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">,</span><a href="#loc_536_22_536_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_22_536_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">,</span><a href="#loc_536_24_536_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_24_536_25&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_540_10_540_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_10_540_12&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_536_10_536_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_10_536_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_540_14_540_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_14_540_17&#39;)"><span class="hl_varref"><span class="mpre">ss&#39;</span></span></a><span class="mpre">

</span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_fundecl"><span class="mpre">braces</span></span></a><span class="mpre"> </span><a name="loc_542_8_542_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_8_542_9&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_542_10_542_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_10_542_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_441_8_441_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_8_441_12&#39;)"><span class="hl_conref"><span class="mpre">Span</span></span></a><span class="mpre"> </span><a name="loc_542_18_542_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_18_542_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">       </span><a name="loc_542_26_542_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_26_542_27&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_542_28_542_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_28_542_30&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) = </span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_varref"><span class="mpre">braces</span></span></a><span class="mpre"> </span><a href="#loc_542_8_542_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_8_542_9&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a href="#loc_542_18_542_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_18_542_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">,</span><a href="#loc_542_26_542_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_26_542_27&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) []</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_542_10_542_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_10_542_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_542_28_542_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_28_542_30&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
</span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_fundecl"><span class="mpre">braces</span></span></a><span class="mpre"> _ </span><a name="loc_543_10_543_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_10_543_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_442_29_442_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_29_442_41&#39;)"><span class="hl_conref"><span class="mpre">CloseBracket</span></span></a><span class="mpre"> _</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_543_28_543_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_28_543_30&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_543_10_543_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_10_543_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_543_28_543_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_28_543_30&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">)
</span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_fundecl"><span class="mpre">braces</span></span></a><span class="mpre"> </span><a name="loc_544_8_544_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_8_544_9&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ []                  = </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_544_8_544_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_8_544_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;opening brace &#39;{&#39;&quot;</span></span><span class="mpre">
                              </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;has no matching closing brace &#39;}&#39;&quot;</span></span><span class="mpre">
</span><a href="#loc_528_1_528_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_7&#39;)"><span class="hl_fundecl"><span class="mpre">braces</span></span></a><span class="mpre"> _ _ (</span><a href="#loc_442_8_442_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_8_442_19&#39;)"><span class="hl_conref"><span class="mpre">OpenBracket</span></span></a><span class="mpre">  </span><a name="loc_546_26_546_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_26_546_27&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)  = </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_546_26_546_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_26_546_27&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unexpected &#39;{&#39;&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert the parse tree into the Field AST</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Also check for dodgy uses of tabs in indentation.</span></span><span class="mpre">
</span><a href="#loc_551_1_551_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_8&#39;)"><span class="mpre">mkField</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">SyntaxTree</span></span><span class="mpre"> -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> </span><a href="#loc_343_6_343_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_6_343_11&#39;)"><span class="hl_tyconref"><span class="mpre">Field</span></span></a><span class="mpre">
</span><a name="loc_551_1_551_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_8&#39;)"><span class="hl_fundecl"><span class="mpre">mkField</span></span></a><span class="mpre"> </span><a name="loc_551_9_551_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_9_551_10&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a name="loc_551_18_551_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_18_551_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">,</span><a name="loc_551_20_551_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_20_551_21&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">,_) _) | </span><a href="#loc_551_9_551_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_9_551_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_551_20_551_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_20_551_21&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_182_1_182_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_10&#39;)"><span class="hl_varref"><span class="mpre">tabsError</span></span></a><span class="mpre"> </span><a href="#loc_551_18_551_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_18_551_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
</span><a href="#loc_551_1_551_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_8&#39;)"><span class="hl_fundecl"><span class="mpre">mkField</span></span></a><span class="mpre"> </span><a name="loc_552_9_552_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_9_552_10&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a name="loc_552_18_552_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_18_552_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">,_,</span><a name="loc_552_22_552_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_22_552_23&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) </span><a name="loc_552_25_552_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_25_552_27&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">) = case </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> (\</span><a name="loc_552_43_552_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_43_552_44&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.Unicode.html#loc_136_1_136_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_136_1_136_11&#39;)"><span class="hl_varref"><span class="mpre">isAlphaNum</span></span></a><span class="mpre"> </span><a href="#loc_552_43_552_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_43_552_44&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_552_43_552_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_43_552_44&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="mpre">) </span><a href="#loc_552_22_552_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_22_552_23&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> of
  ([], _)       -&gt; </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_552_18_552_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_18_552_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unrecognised field or section: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_552_22_552_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_22_552_23&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
  (</span><a name="loc_554_4_554_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_4_554_8&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">, </span><a name="loc_554_10_554_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_10_554_14&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">)  -&gt; case </span><a href="#loc_473_1_473_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_1_473_12&#39;)"><span class="hl_varref"><span class="mpre">trimLeading</span></span></a><span class="mpre"> </span><a href="#loc_554_10_554_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_10_554_14&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> of
    (</span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_555_10_555_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_10_555_15&#39;)"><span class="hl_vardecl"><span class="mpre">rest&#39;</span></span></a><span class="mpre">) -&gt; do let </span><a name="loc_555_27_555_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_27_555_41&#39;)"><span class="hl_vardecl"><span class="mpre">followingLines</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Tree.flatten</span></span><span class="mpre"> </span><a href="#loc_552_25_552_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_25_552_27&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
                          </span><a name="loc_556_27_556_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_27_556_31&#39;)"><span class="hl_vardecl"><span class="mpre">tabs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">| (_,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,_) &lt;- </span><a href="#loc_555_27_555_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_27_555_41&#39;)"><span class="hl_varref"><span class="mpre">followingLines</span></span></a><span class="mpre"> ])
                      if </span><a href="#loc_556_27_556_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_27_556_31&#39;)"><span class="hl_varref"><span class="mpre">tabs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_552_9_552_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_9_552_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                        then </span><a href="#loc_182_1_182_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_10&#39;)"><span class="hl_varref"><span class="mpre">tabsError</span></span></a><span class="mpre"> </span><a href="#loc_552_18_552_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_18_552_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
                        else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_344_7_344_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_7_344_8&#39;)"><span class="hl_conref"><span class="mpre">F</span></span></a><span class="mpre"> </span><a href="#loc_552_18_552_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_18_552_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><a href="#loc_554_4_554_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_4_554_8&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">)
                                          (</span><a href="#loc_563_11_563_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_11_563_21&#39;)"><span class="hl_varref"><span class="mpre">fieldValue</span></span></a><span class="mpre"> </span><a href="#loc_555_10_555_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_10_555_15&#39;)"><span class="hl_varref"><span class="mpre">rest&#39;</span></span></a><span class="mpre"> </span><a href="#loc_555_27_555_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_27_555_41&#39;)"><span class="hl_varref"><span class="mpre">followingLines</span></span></a><span class="mpre">)
    </span><a name="loc_561_5_561_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_5_561_10&#39;)"><span class="hl_vardecl"><span class="mpre">rest&#39;</span></span></a><span class="mpre">       -&gt; do </span><a name="loc_561_23_561_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_23_561_26&#39;)"><span class="hl_vardecl"><span class="mpre">ts&#39;</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> (</span><a href="#loc_551_1_551_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_1_551_8&#39;)"><span class="hl_varref"><span class="mpre">mkField</span></span></a><span class="mpre"> (</span><a href="#loc_552_9_552_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_9_552_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)) </span><a href="#loc_552_25_552_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_25_552_27&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
                      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_346_7_346_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_7_346_14&#39;)"><span class="hl_conref"><span class="mpre">Section</span></span></a><span class="mpre"> </span><a href="#loc_552_18_552_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_18_552_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><a href="#loc_554_4_554_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_4_554_8&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">) </span><a href="#loc_561_5_561_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_5_561_10&#39;)"><span class="hl_varref"><span class="mpre">rest&#39;</span></span></a><span class="mpre"> </span><a href="#loc_561_23_561_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_23_561_26&#39;)"><span class="hl_varref"><span class="mpre">ts&#39;</span></span></a><span class="mpre">)
 where    </span><a name="loc_563_11_563_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_11_563_21&#39;)"><span class="hl_fundecl"><span class="mpre">fieldValue</span></span></a><span class="mpre"> </span><a name="loc_563_22_563_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_22_563_31&#39;)"><span class="hl_vardecl"><span class="mpre">firstLine</span></span></a><span class="mpre"> </span><a name="loc_563_32_563_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_32_563_46&#39;)"><span class="hl_vardecl"><span class="mpre">followingLines</span></span></a><span class="mpre"> =
            let </span><a name="loc_564_17_564_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_564_17_564_27&#39;)"><span class="hl_vardecl"><span class="mpre">firstLine&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_473_1_473_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_1_473_12&#39;)"><span class="hl_varref"><span class="mpre">trimLeading</span></span></a><span class="mpre"> </span><a href="#loc_563_22_563_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_22_563_31&#39;)"><span class="hl_varref"><span class="mpre">firstLine</span></span></a><span class="mpre">
                </span><a name="loc_565_17_565_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_17_565_32&#39;)"><span class="hl_vardecl"><span class="mpre">followingLines&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(_,_,</span><a name="loc_565_46_565_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_46_565_47&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_569_11_569_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_11_569_19&#39;)"><span class="hl_varref"><span class="mpre">stripDot</span></span></a><span class="mpre"> </span><a href="#loc_565_46_565_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_46_565_47&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_563_32_563_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_32_563_46&#39;)"><span class="hl_varref"><span class="mpre">followingLines</span></span></a><span class="mpre">
                </span><a name="loc_566_17_566_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_566_17_566_25&#39;)"><span class="hl_vardecl"><span class="mpre">allLines</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_564_17_564_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_564_17_564_27&#39;)"><span class="hl_varref"><span class="mpre">firstLine&#39;</span></span></a><span class="mpre"> =              </span><a href="#loc_565_17_565_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_17_565_32&#39;)"><span class="hl_varref"><span class="mpre">followingLines&#39;</span></span></a><span class="mpre">
                         | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       = </span><a href="#loc_564_17_564_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_564_17_564_27&#39;)"><span class="hl_varref"><span class="mpre">firstLine&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_565_17_565_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_17_565_32&#39;)"><span class="hl_varref"><span class="mpre">followingLines&#39;</span></span></a><span class="mpre">
             in </span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="hl_varref"><span class="mpre">intercalate</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre"> </span><a href="#loc_566_17_566_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_566_17_566_25&#39;)"><span class="hl_varref"><span class="mpre">allLines</span></span></a><span class="mpre">
          </span><a name="loc_569_11_569_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_11_569_19&#39;)"><span class="hl_fundecl"><span class="mpre">stripDot</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
          </span><a href="#loc_569_11_569_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_11_569_19&#39;)"><span class="hl_fundecl"><span class="mpre">stripDot</span></span></a><span class="mpre"> </span><a name="loc_570_20_570_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_20_570_21&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">   = </span><a href="#loc_570_20_570_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_20_570_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert if/then/else &#39;Section&#39;s to &#39;IfBlock&#39;s</span></span><span class="mpre">
</span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="mpre">ifelse</span></a><span class="mpre"> :: [</span><a href="#loc_343_6_343_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_6_343_11&#39;)"><span class="hl_tyconref"><span class="mpre">Field</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_116_6_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseResult</span></span></a><span class="mpre"> [</span><a href="#loc_343_6_343_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_6_343_11&#39;)"><span class="hl_tyconref"><span class="mpre">Field</span></span></a><span class="mpre">]
</span><a name="loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_fundecl"><span class="mpre">ifelse</span></span></a><span class="mpre"> [] = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
</span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_fundecl"><span class="mpre">ifelse</span></span></a><span class="mpre"> (</span><a href="#loc_346_7_346_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_7_346_14&#39;)"><span class="hl_conref"><span class="mpre">Section</span></span></a><span class="mpre"> </span><a name="loc_575_17_575_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_17_575_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;if&quot;</span></span><span class="mpre">   </span><a name="loc_575_26_575_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_26_575_30&#39;)"><span class="hl_vardecl"><span class="mpre">cond</span></span></a><span class="mpre"> </span><a name="loc_575_31_575_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_31_575_39&#39;)"><span class="hl_vardecl"><span class="mpre">thenpart</span></span></a><span class="mpre">
       </span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_346_7_346_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_7_346_14&#39;)"><span class="hl_conref"><span class="mpre">Section</span></span></a><span class="mpre"> _ </span><span class="hl_string"><span class="mpre">&quot;else&quot;</span></span><span class="mpre"> </span><a name="loc_576_26_576_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_26_576_28&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre">   </span><a name="loc_576_31_576_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_31_576_39&#39;)"><span class="hl_vardecl"><span class="mpre">elsepart</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_576_40_576_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_40_576_42&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre">)
       | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_575_26_575_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_26_575_30&#39;)"><span class="hl_varref"><span class="mpre">cond</span></span></a><span class="mpre">     = </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_575_17_575_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_17_575_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;if&#39; with missing condition&quot;</span></span><span class="mpre">
       | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_575_31_575_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_31_575_39&#39;)"><span class="hl_varref"><span class="mpre">thenpart</span></span></a><span class="mpre"> = </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_575_17_575_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_17_575_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;then&#39; branch of &#39;if&#39; is empty&quot;</span></span><span class="mpre">
       | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_576_26_576_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_26_576_28&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre">) = </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_575_17_575_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_17_575_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;else&#39; takes no arguments&quot;</span></span><span class="mpre">
       | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_576_31_576_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_31_576_39&#39;)"><span class="hl_varref"><span class="mpre">elsepart</span></span></a><span class="mpre"> = </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_575_17_575_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_17_575_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;else&#39; branch of &#39;if&#39; is empty&quot;</span></span><span class="mpre">
       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = do </span><a name="loc_581_29_581_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_581_29_581_31&#39;)"><span class="hl_vardecl"><span class="mpre">tp</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_varref"><span class="mpre">ifelse</span></span></a><span class="mpre"> </span><a href="#loc_575_31_575_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_31_575_39&#39;)"><span class="hl_varref"><span class="mpre">thenpart</span></span></a><span class="mpre">
                            </span><a name="loc_582_29_582_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_582_29_582_31&#39;)"><span class="hl_vardecl"><span class="mpre">ep</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_varref"><span class="mpre">ifelse</span></span></a><span class="mpre"> </span><a href="#loc_576_31_576_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_31_576_39&#39;)"><span class="hl_varref"><span class="mpre">elsepart</span></span></a><span class="mpre">
                            </span><a name="loc_583_29_583_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_29_583_32&#39;)"><span class="hl_vardecl"><span class="mpre">fs&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_varref"><span class="mpre">ifelse</span></span></a><span class="mpre"> </span><a href="#loc_576_40_576_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_40_576_42&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre">
                            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_355_7_355_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_7_355_14&#39;)"><span class="hl_conref"><span class="mpre">IfBlock</span></span></a><span class="mpre"> </span><a href="#loc_575_17_575_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_17_575_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_575_26_575_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_26_575_30&#39;)"><span class="hl_varref"><span class="mpre">cond</span></span></a><span class="mpre"> </span><a href="#loc_581_29_581_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_581_29_581_31&#39;)"><span class="hl_varref"><span class="mpre">tp</span></span></a><span class="mpre"> </span><a href="#loc_582_29_582_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_582_29_582_31&#39;)"><span class="hl_varref"><span class="mpre">ep</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_583_29_583_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_29_583_32&#39;)"><span class="hl_varref"><span class="mpre">fs&#39;</span></span></a><span class="mpre">)
</span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_fundecl"><span class="mpre">ifelse</span></span></a><span class="mpre"> (</span><a href="#loc_346_7_346_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_7_346_14&#39;)"><span class="hl_conref"><span class="mpre">Section</span></span></a><span class="mpre"> </span><a name="loc_585_17_585_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_17_585_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;if&quot;</span></span><span class="mpre">   </span><a name="loc_585_26_585_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_26_585_30&#39;)"><span class="hl_vardecl"><span class="mpre">cond</span></span></a><span class="mpre"> </span><a name="loc_585_31_585_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_31_585_39&#39;)"><span class="hl_vardecl"><span class="mpre">thenpart</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_585_40_585_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_40_585_42&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre">)
       | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_585_26_585_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_26_585_30&#39;)"><span class="hl_varref"><span class="mpre">cond</span></span></a><span class="mpre">     = </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_585_17_585_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_17_585_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;if&#39; with missing condition&quot;</span></span><span class="mpre">
       | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_585_31_585_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_31_585_39&#39;)"><span class="hl_varref"><span class="mpre">thenpart</span></span></a><span class="mpre"> = </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_585_17_585_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_17_585_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;then&#39; branch of &#39;if&#39; is empty&quot;</span></span><span class="mpre">
       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = do </span><a name="loc_588_29_588_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_29_588_31&#39;)"><span class="hl_vardecl"><span class="mpre">tp</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_varref"><span class="mpre">ifelse</span></span></a><span class="mpre"> </span><a href="#loc_585_31_585_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_31_585_39&#39;)"><span class="hl_varref"><span class="mpre">thenpart</span></span></a><span class="mpre">
                            </span><a name="loc_589_29_589_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_589_29_589_32&#39;)"><span class="hl_vardecl"><span class="mpre">fs&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_varref"><span class="mpre">ifelse</span></span></a><span class="mpre"> </span><a href="#loc_585_40_585_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_40_585_42&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre">
                            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_355_7_355_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_7_355_14&#39;)"><span class="hl_conref"><span class="mpre">IfBlock</span></span></a><span class="mpre"> </span><a href="#loc_585_17_585_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_17_585_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_585_26_585_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_26_585_30&#39;)"><span class="hl_varref"><span class="mpre">cond</span></span></a><span class="mpre"> </span><a href="#loc_588_29_588_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_29_588_31&#39;)"><span class="hl_varref"><span class="mpre">tp</span></span></a><span class="mpre"> []</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_589_29_589_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_589_29_589_32&#39;)"><span class="hl_varref"><span class="mpre">fs&#39;</span></span></a><span class="mpre">)
</span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_fundecl"><span class="mpre">ifelse</span></span></a><span class="mpre"> (</span><a href="#loc_346_7_346_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_7_346_14&#39;)"><span class="hl_conref"><span class="mpre">Section</span></span></a><span class="mpre"> </span><a name="loc_591_17_591_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_17_591_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;else&quot;</span></span><span class="mpre"> _ _</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><a href="#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">syntaxError</span></span></a><span class="mpre"> </span><a href="#loc_591_17_591_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_591_17_591_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
                                  </span><span class="hl_string"><span class="mpre">&quot;stray &#39;else&#39; with no preceding &#39;if&#39;&quot;</span></span><span class="mpre">
</span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_fundecl"><span class="mpre">ifelse</span></span></a><span class="mpre"> (</span><a href="#loc_346_7_346_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_7_346_14&#39;)"><span class="hl_conref"><span class="mpre">Section</span></span></a><span class="mpre"> </span><a name="loc_593_17_593_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_17_593_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_593_19_593_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_19_593_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_593_21_593_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_21_593_22&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_593_23_593_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_23_593_26&#39;)"><span class="hl_vardecl"><span class="mpre">fs&#39;</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_593_27_593_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_27_593_29&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre">) = do </span><a name="loc_593_36_593_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_36_593_40&#39;)"><span class="hl_vardecl"><span class="mpre">fs&#39;&#39;</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_varref"><span class="mpre">ifelse</span></span></a><span class="mpre"> </span><a href="#loc_593_23_593_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_23_593_26&#39;)"><span class="hl_varref"><span class="mpre">fs&#39;</span></span></a><span class="mpre">
                                   </span><a name="loc_594_36_594_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_36_594_41&#39;)"><span class="hl_vardecl"><span class="mpre">fs&#39;&#39;&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_varref"><span class="mpre">ifelse</span></span></a><span class="mpre"> </span><a href="#loc_593_27_593_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_27_593_29&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre">
                                   </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_346_7_346_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_7_346_14&#39;)"><span class="hl_conref"><span class="mpre">Section</span></span></a><span class="mpre"> </span><a href="#loc_593_17_593_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_17_593_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_593_19_593_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_19_593_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_593_21_593_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_21_593_22&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_593_36_593_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_36_593_40&#39;)"><span class="hl_varref"><span class="mpre">fs&#39;&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_594_36_594_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_36_594_41&#39;)"><span class="hl_varref"><span class="mpre">fs&#39;&#39;&#39;</span></span></a><span class="mpre">)
</span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_fundecl"><span class="mpre">ifelse</span></span></a><span class="mpre"> (</span><a name="loc_596_9_596_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_9_596_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_596_11_596_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_11_596_13&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre">) = do </span><a name="loc_596_20_596_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_20_596_23&#39;)"><span class="hl_vardecl"><span class="mpre">fs&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_574_1_574_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_7&#39;)"><span class="hl_varref"><span class="mpre">ifelse</span></span></a><span class="mpre"> </span><a href="#loc_596_11_596_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_11_596_13&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre">
                   </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_596_9_596_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_9_596_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_596_20_596_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_20_596_23&#39;)"><span class="hl_varref"><span class="mpre">fs&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |parse a module name</span></span><span class="mpre">
</span><a href="#loc_603_1_603_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_603_1_603_17&#39;)"><span class="mpre">parseModuleNameQ</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><a href="Distribution.ModuleName.html#loc_67_9_67_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.ModuleName.html#loc_67_9_67_19&#39;)"><span class="hl_tyconref"><span class="mpre">ModuleName</span></span></a><span class="mpre">
</span><a name="loc_603_1_603_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_603_1_603_17&#39;)"><span class="hl_vardecl"><span class="mpre">parseModuleNameQ</span></span></a><span class="mpre"> = </span><a href="#loc_705_1_705_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_12&#39;)"><span class="hl_varref"><span class="mpre">parseQuoted</span></span></a><span class="mpre"> </span><a href="Distribution.Text.html#loc_28_3_28_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_28_3_28_8&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><a href="Distribution.Text.html#loc_28_3_28_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_28_3_28_8&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre">

</span><a href="#loc_606_1_606_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_1_606_15&#39;)"><span class="mpre">parseFilePathQ</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_606_1_606_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_1_606_15&#39;)"><span class="hl_vardecl"><span class="mpre">parseFilePathQ</span></span></a><span class="mpre"> = </span><a href="#loc_681_1_681_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_1_681_12&#39;)"><span class="hl_varref"><span class="mpre">parseTokenQ</span></span></a><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- removed until normalise is no longer broken, was:</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">--   liftM normalise parseTokenQ</span></span><span class="mpre">

</span><a href="#loc_611_1_611_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_1_611_14&#39;)"><span class="mpre">betweenSpaces</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_611_1_611_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_1_611_14&#39;)"><span class="hl_fundecl"><span class="mpre">betweenSpaces</span></span></a><span class="mpre"> </span><a name="loc_611_15_611_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_15_611_18&#39;)"><span class="hl_vardecl"><span class="mpre">act</span></span></a><span class="mpre"> = do </span><a href="Distribution.Compat.ReadP.html#loc_277_1_277_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_277_1_277_11&#39;)"><span class="hl_varref"><span class="mpre">skipSpaces</span></span></a><span class="mpre">
                       </span><a name="loc_612_24_612_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_612_24_612_27&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_611_15_611_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_15_611_18&#39;)"><span class="hl_varref"><span class="mpre">act</span></span></a><span class="mpre">
                       </span><a href="Distribution.Compat.ReadP.html#loc_277_1_277_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_277_1_277_11&#39;)"><span class="hl_varref"><span class="mpre">skipSpaces</span></span></a><span class="mpre">
                       </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_612_24_612_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_612_24_612_27&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">

</span><a href="#loc_617_1_617_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_617_1_617_15&#39;)"><span class="mpre">parseBuildTool</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><a href="Distribution.Package.html#loc_145_6_145_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_145_6_145_16&#39;)"><span class="hl_tyconref"><span class="mpre">Dependency</span></span></a><span class="mpre">
</span><a name="loc_617_1_617_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_617_1_617_15&#39;)"><span class="hl_vardecl"><span class="mpre">parseBuildTool</span></span></a><span class="mpre"> = do </span><a name="loc_617_21_617_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_617_21_617_25&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_623_1_623_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_1_623_20&#39;)"><span class="hl_varref"><span class="mpre">parseBuildToolNameQ</span></span></a><span class="mpre">
                    </span><a name="loc_618_21_618_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_21_618_24&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_611_1_611_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_1_611_14&#39;)"><span class="hl_varref"><span class="mpre">betweenSpaces</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                           </span><a href="#loc_647_1_647_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_1_647_19&#39;)"><span class="hl_varref"><span class="mpre">parseVersionRangeQ</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Distribution.Version.html#loc_143_1_143_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Version.html#loc_143_1_143_11&#39;)"><span class="hl_varref"><span class="mpre">anyVersion</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Package.html#loc_145_19_145_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_145_19_145_29&#39;)"><span class="hl_conref"><span class="mpre">Dependency</span></span></a><span class="mpre"> </span><a href="#loc_617_21_617_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_617_21_617_25&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_618_21_618_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_21_618_24&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre">

</span><a href="#loc_623_1_623_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_1_623_20&#39;)"><span class="mpre">parseBuildToolNameQ</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><a href="Distribution.Package.html#loc_80_9_80_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_80_9_80_20&#39;)"><span class="hl_tyconref"><span class="mpre">PackageName</span></span></a><span class="mpre">
</span><a name="loc_623_1_623_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_1_623_20&#39;)"><span class="hl_vardecl"><span class="mpre">parseBuildToolNameQ</span></span></a><span class="mpre"> = </span><a href="#loc_705_1_705_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_12&#39;)"><span class="hl_varref"><span class="mpre">parseQuoted</span></span></a><span class="mpre"> </span><a href="#loc_627_1_627_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_1_627_19&#39;)"><span class="hl_varref"><span class="mpre">parseBuildToolName</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><a href="#loc_627_1_627_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_1_627_19&#39;)"><span class="hl_varref"><span class="mpre">parseBuildToolName</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- like parsePackageName but accepts symbols in components</span></span><span class="mpre">
</span><a href="#loc_627_1_627_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_1_627_19&#39;)"><span class="mpre">parseBuildToolName</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><a href="Distribution.Package.html#loc_80_9_80_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_80_9_80_20&#39;)"><span class="hl_tyconref"><span class="mpre">PackageName</span></span></a><span class="mpre">
</span><a name="loc_627_1_627_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_1_627_19&#39;)"><span class="hl_vardecl"><span class="mpre">parseBuildToolName</span></span></a><span class="mpre"> = do </span><a name="loc_627_25_627_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_25_627_27&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre"> &lt;- </span><a href="Distribution.Compat.ReadP.html#loc_330_1_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_330_1_330_7&#39;)"><span class="hl_varref"><span class="mpre">sepBy1</span></span></a><span class="mpre"> </span><a href="#loc_629_9_629_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_9_629_18&#39;)"><span class="hl_varref"><span class="mpre">component</span></span></a><span class="mpre"> (</span><a href="Distribution.Compat.ReadP.html#loc_243_1_243_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_243_1_243_5&#39;)"><span class="hl_varref"><span class="mpre">ReadP.char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="mpre">)
                        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Distribution.Package.html#loc_80_23_80_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_80_23_80_34&#39;)"><span class="hl_conref"><span class="mpre">PackageName</span></span></a><span class="mpre"> (</span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="hl_varref"><span class="mpre">intercalate</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;-&quot;</span></span><span class="mpre"> </span><a href="#loc_627_25_627_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_25_627_27&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">))
  where </span><a name="loc_629_9_629_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_9_629_18&#39;)"><span class="hl_vardecl"><span class="mpre">component</span></span></a><span class="mpre"> = do
          </span><a name="loc_630_11_630_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_11_630_13&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> &lt;- </span><a href="Distribution.Compat.ReadP.html#loc_264_1_264_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_264_1_264_7&#39;)"><span class="hl_varref"><span class="mpre">munch1</span></span></a><span class="mpre"> (\</span><a name="loc_630_26_630_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_26_630_27&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.Unicode.html#loc_136_1_136_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_136_1_136_11&#39;)"><span class="hl_varref"><span class="mpre">isAlphaNum</span></span></a><span class="mpre"> </span><a href="#loc_630_26_630_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_26_630_27&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_630_26_630_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_26_630_27&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;+&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_630_26_630_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_26_630_27&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="mpre">)
          if </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_103_1_103_8&#39;)"><span class="hl_varref"><span class="mpre">isDigit</span></span></a><span class="mpre"> </span><a href="#loc_630_11_630_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_11_630_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> then </span><a href="Distribution.Compat.ReadP.html#loc_196_1_196_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_196_1_196_6&#39;)"><span class="hl_varref"><span class="mpre">pfail</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_630_11_630_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_11_630_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- pkg-config allows versions and other letters in package names,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- eg &quot;gtk+-2.0&quot; is a valid pkg-config package _name_.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It then has a package version number like 2.10.13</span></span><span class="mpre">
</span><a href="#loc_637_1_637_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_1_637_25&#39;)"><span class="mpre">parsePkgconfigDependency</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><a href="Distribution.Package.html#loc_145_6_145_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_145_6_145_16&#39;)"><span class="hl_tyconref"><span class="mpre">Dependency</span></span></a><span class="mpre">
</span><a name="loc_637_1_637_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_1_637_25&#39;)"><span class="hl_vardecl"><span class="mpre">parsePkgconfigDependency</span></span></a><span class="mpre"> = do </span><a name="loc_637_31_637_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_31_637_35&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> &lt;- </span><a href="Distribution.Compat.ReadP.html#loc_264_1_264_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_264_1_264_7&#39;)"><span class="hl_varref"><span class="mpre">munch1</span></span></a><span class="mpre">
                                      (\</span><a name="loc_638_41_638_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_638_41_638_42&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.Unicode.html#loc_136_1_136_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_136_1_136_11&#39;)"><span class="hl_varref"><span class="mpre">isAlphaNum</span></span></a><span class="mpre"> </span><a href="#loc_638_41_638_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_638_41_638_42&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_638_41_638_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_638_41_638_42&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;+-._&quot;</span></span><span class="mpre">)
                              </span><a name="loc_639_31_639_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_31_639_34&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_611_1_611_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_1_611_14&#39;)"><span class="hl_varref"><span class="mpre">betweenSpaces</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                     </span><a href="#loc_647_1_647_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_1_647_19&#39;)"><span class="hl_varref"><span class="mpre">parseVersionRangeQ</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Distribution.Version.html#loc_143_1_143_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Version.html#loc_143_1_143_11&#39;)"><span class="hl_varref"><span class="mpre">anyVersion</span></span></a><span class="mpre">
                              </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Package.html#loc_145_19_145_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_145_19_145_29&#39;)"><span class="hl_conref"><span class="mpre">Dependency</span></span></a><span class="mpre"> (</span><a href="Distribution.Package.html#loc_80_23_80_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_80_23_80_34&#39;)"><span class="hl_conref"><span class="mpre">PackageName</span></span></a><span class="mpre"> </span><a href="#loc_637_31_637_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_31_637_35&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">) </span><a href="#loc_639_31_639_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_31_639_34&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre">

</span><a href="#loc_644_1_644_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_1_644_18&#39;)"><span class="mpre">parsePackageNameQ</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><a href="Distribution.Package.html#loc_80_9_80_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_80_9_80_20&#39;)"><span class="hl_tyconref"><span class="mpre">PackageName</span></span></a><span class="mpre">
</span><a name="loc_644_1_644_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_1_644_18&#39;)"><span class="hl_vardecl"><span class="mpre">parsePackageNameQ</span></span></a><span class="mpre"> = </span><a href="#loc_705_1_705_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_12&#39;)"><span class="hl_varref"><span class="mpre">parseQuoted</span></span></a><span class="mpre"> </span><a href="Distribution.Text.html#loc_28_3_28_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_28_3_28_8&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><a href="Distribution.Text.html#loc_28_3_28_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_28_3_28_8&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre">

</span><a href="#loc_647_1_647_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_1_647_19&#39;)"><span class="mpre">parseVersionRangeQ</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><a href="Distribution.Version.html#loc_113_6_113_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Version.html#loc_113_6_113_18&#39;)"><span class="hl_tyconref"><span class="mpre">VersionRange</span></span></a><span class="mpre">
</span><a name="loc_647_1_647_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_1_647_19&#39;)"><span class="hl_vardecl"><span class="mpre">parseVersionRangeQ</span></span></a><span class="mpre"> = </span><a href="#loc_705_1_705_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_12&#39;)"><span class="hl_varref"><span class="mpre">parseQuoted</span></span></a><span class="mpre"> </span><a href="Distribution.Text.html#loc_28_3_28_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_28_3_28_8&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><a href="Distribution.Text.html#loc_28_3_28_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_28_3_28_8&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre">

</span><a href="#loc_650_1_650_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_1_650_16&#39;)"><span class="mpre">parseOptVersion</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><a href="Data.Version.html#loc_68_6_68_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Version.html#loc_68_6_68_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">
</span><a name="loc_650_1_650_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_1_650_16&#39;)"><span class="hl_vardecl"><span class="mpre">parseOptVersion</span></span></a><span class="mpre"> = </span><a href="#loc_705_1_705_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_12&#39;)"><span class="hl_varref"><span class="mpre">parseQuoted</span></span></a><span class="mpre"> </span><a href="#loc_652_9_652_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_9_652_12&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><a href="#loc_652_9_652_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_9_652_12&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre">
  where </span><a href="#loc_652_9_652_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_9_652_12&#39;)"><span class="mpre">ver</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><a href="Data.Version.html#loc_68_6_68_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Version.html#loc_68_6_68_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">
        </span><a name="loc_652_9_652_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_9_652_12&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> = </span><a href="Distribution.Text.html#loc_28_3_28_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_28_3_28_8&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_653_9_653_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_9_653_18&#39;)"><span class="hl_varref"><span class="mpre">noVersion</span></span></a><span class="mpre">
        </span><a name="loc_653_9_653_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_653_9_653_18&#39;)"><span class="hl_vardecl"><span class="mpre">noVersion</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 653, srcSpanStartColumn = 21, srcSpanEndLine = 653, srcSpanEndColumn = 64}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUtils.hs&quot;, srcSpanStartLine = 653, srcSpanStartColumn = 28, srcSpanEndLine = 653, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/ParseUti"><span class="mpre">Version{ versionBranch=[], versionTags=[] }</span></span><span class="mpre">

</span><a href="#loc_656_1_656_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_656_1_656_17&#39;)"><span class="mpre">parseTestedWithQ</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> (</span><a href="Distribution.Compiler.html#loc_81_6_81_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compiler.html#loc_81_6_81_20&#39;)"><span class="hl_tyconref"><span class="mpre">CompilerFlavor</span></span></a><span class="mpre">,</span><a href="Distribution.Version.html#loc_113_6_113_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Version.html#loc_113_6_113_18&#39;)"><span class="hl_tyconref"><span class="mpre">VersionRange</span></span></a><span class="mpre">)
</span><a name="loc_656_1_656_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_656_1_656_17&#39;)"><span class="hl_vardecl"><span class="mpre">parseTestedWithQ</span></span></a><span class="mpre"> = </span><a href="#loc_705_1_705_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_12&#39;)"><span class="hl_varref"><span class="mpre">parseQuoted</span></span></a><span class="mpre"> </span><a href="#loc_659_5_659_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_659_5_659_7&#39;)"><span class="hl_varref"><span class="mpre">tw</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><a href="#loc_659_5_659_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_659_5_659_7&#39;)"><span class="hl_varref"><span class="mpre">tw</span></span></a><span class="mpre">
  where
    </span><a href="#loc_659_5_659_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_659_5_659_7&#39;)"><span class="mpre">tw</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> (</span><a href="Distribution.Compiler.html#loc_81_6_81_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compiler.html#loc_81_6_81_20&#39;)"><span class="hl_tyconref"><span class="mpre">CompilerFlavor</span></span></a><span class="mpre">,</span><a href="Distribution.Version.html#loc_113_6_113_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Version.html#loc_113_6_113_18&#39;)"><span class="hl_tyconref"><span class="mpre">VersionRange</span></span></a><span class="mpre">)
    </span><a name="loc_659_5_659_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_659_5_659_7&#39;)"><span class="hl_vardecl"><span class="mpre">tw</span></span></a><span class="mpre"> = do </span><a name="loc_659_13_659_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_659_13_659_21&#39;)"><span class="hl_vardecl"><span class="mpre">compiler</span></span></a><span class="mpre"> &lt;- </span><a href="Distribution.Compiler.html#loc_119_1_119_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compiler.html#loc_119_1_119_26&#39;)"><span class="hl_varref"><span class="mpre">parseCompilerFlavorCompat</span></span></a><span class="mpre">
            </span><a name="loc_660_13_660_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_13_660_20&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_611_1_611_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_1_611_14&#39;)"><span class="hl_varref"><span class="mpre">betweenSpaces</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Text.html#loc_28_3_28_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_28_3_28_8&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Distribution.Version.html#loc_143_1_143_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Version.html#loc_143_1_143_11&#39;)"><span class="hl_varref"><span class="mpre">anyVersion</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_659_13_659_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_659_13_659_21&#39;)"><span class="hl_varref"><span class="mpre">compiler</span></span></a><span class="mpre">,</span><a href="#loc_660_13_660_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_13_660_20&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre">)

</span><a href="#loc_664_1_664_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_1_664_14&#39;)"><span class="mpre">parseLicenseQ</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><a href="Distribution.License.html#loc_75_6_75_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.License.html#loc_75_6_75_13&#39;)"><span class="hl_tyconref"><span class="mpre">License</span></span></a><span class="mpre">
</span><a name="loc_664_1_664_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_1_664_14&#39;)"><span class="hl_vardecl"><span class="mpre">parseLicenseQ</span></span></a><span class="mpre"> = </span><a href="#loc_705_1_705_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_12&#39;)"><span class="hl_varref"><span class="mpre">parseQuoted</span></span></a><span class="mpre"> </span><a href="Distribution.Text.html#loc_28_3_28_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_28_3_28_8&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><a href="Distribution.Text.html#loc_28_3_28_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_28_3_28_8&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- urgh, we can&#39;t define optQuotes :: ReadP r a -&gt; ReadP r a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- because the &quot;compat&quot; version of ReadP isn&#39;t quite powerful enough.  In</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- particular, the type of &lt;++ is ReadP r r -&gt; ReadP r a -&gt; ReadP r a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Hence the trick above to make &#39;lic&#39; polymorphic.</span></span><span class="mpre">

</span><a href="#loc_672_1_672_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_672_1_672_15&#39;)"><span class="mpre">parseLanguageQ</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><a href="Language.Haskell.Extension.html#loc_69_6_69_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.Extension.html#loc_69_6_69_14&#39;)"><span class="hl_tyconref"><span class="mpre">Language</span></span></a><span class="mpre">
</span><a name="loc_672_1_672_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_672_1_672_15&#39;)"><span class="hl_vardecl"><span class="mpre">parseLanguageQ</span></span></a><span class="mpre"> = </span><a href="#loc_705_1_705_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_12&#39;)"><span class="hl_varref"><span class="mpre">parseQuoted</span></span></a><span class="mpre"> </span><a href="Distribution.Text.html#loc_28_3_28_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_28_3_28_8&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><a href="Distribution.Text.html#loc_28_3_28_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_28_3_28_8&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre">

</span><a href="#loc_675_1_675_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_675_1_675_16&#39;)"><span class="mpre">parseExtensionQ</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><a href="Language.Haskell.Extension.html#loc_118_6_118_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.Extension.html#loc_118_6_118_15&#39;)"><span class="hl_tyconref"><span class="mpre">Extension</span></span></a><span class="mpre">
</span><a name="loc_675_1_675_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_675_1_675_16&#39;)"><span class="hl_vardecl"><span class="mpre">parseExtensionQ</span></span></a><span class="mpre"> = </span><a href="#loc_705_1_705_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_12&#39;)"><span class="hl_varref"><span class="mpre">parseQuoted</span></span></a><span class="mpre"> </span><a href="Distribution.Text.html#loc_28_3_28_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_28_3_28_8&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><a href="Distribution.Text.html#loc_28_3_28_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_28_3_28_8&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre">

</span><a href="#loc_678_1_678_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_1_678_19&#39;)"><span class="mpre">parseHaskellString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_678_1_678_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_1_678_19&#39;)"><span class="hl_vardecl"><span class="mpre">parseHaskellString</span></span></a><span class="mpre"> = </span><a href="Distribution.Compat.ReadP.html#loc_393_1_393_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_393_1_393_11&#39;)"><span class="hl_varref"><span class="mpre">readS_to_P</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reads</span></span><span class="mpre">

</span><a href="#loc_681_1_681_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_1_681_12&#39;)"><span class="mpre">parseTokenQ</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_681_1_681_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_1_681_12&#39;)"><span class="hl_vardecl"><span class="mpre">parseTokenQ</span></span></a><span class="mpre"> = </span><a href="#loc_678_1_678_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_1_678_19&#39;)"><span class="hl_varref"><span class="mpre">parseHaskellString</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_264_1_264_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_264_1_264_7&#39;)"><span class="hl_varref"><span class="mpre">munch1</span></span></a><span class="mpre"> (\</span><a name="loc_681_47_681_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_47_681_48&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><a href="#loc_681_47_681_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_47_681_48&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_681_47_681_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_47_681_48&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;,&#39;</span></span><span class="mpre">)

</span><a href="#loc_684_1_684_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_1_684_13&#39;)"><span class="mpre">parseTokenQ&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_684_1_684_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_1_684_13&#39;)"><span class="hl_vardecl"><span class="mpre">parseTokenQ&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_678_1_678_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_1_678_19&#39;)"><span class="hl_varref"><span class="mpre">parseHaskellString</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_206_5_206_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_206_5_206_8&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_264_1_264_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_264_1_264_7&#39;)"><span class="hl_varref"><span class="mpre">munch1</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre">)

</span><a href="#loc_689_1_689_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_689_1_689_13&#39;)"><span class="mpre">parseSepList</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^The parser for the stuff between commas</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_689_1_689_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_689_1_689_13&#39;)"><span class="hl_fundecl"><span class="mpre">parseSepList</span></span></a><span class="mpre"> </span><a name="loc_689_14_689_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_689_14_689_18&#39;)"><span class="hl_vardecl"><span class="mpre">sepr</span></span></a><span class="mpre"> </span><a name="loc_689_19_689_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_689_19_689_20&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="Distribution.Compat.ReadP.html#loc_325_1_325_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_325_1_325_6&#39;)"><span class="hl_varref"><span class="mpre">sepBy</span></span></a><span class="mpre"> </span><a href="#loc_689_19_689_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_689_19_689_20&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_690_11_690_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_11_690_20&#39;)"><span class="hl_varref"><span class="mpre">separator</span></span></a><span class="mpre">
    where </span><a name="loc_690_11_690_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_11_690_20&#39;)"><span class="hl_vardecl"><span class="mpre">separator</span></span></a><span class="mpre"> = </span><a href="#loc_611_1_611_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_1_611_14&#39;)"><span class="hl_varref"><span class="mpre">betweenSpaces</span></span></a><span class="mpre"> </span><a href="#loc_689_14_689_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_689_14_689_18&#39;)"><span class="hl_varref"><span class="mpre">sepr</span></span></a><span class="mpre">

</span><a href="#loc_694_1_694_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_694_1_694_15&#39;)"><span class="mpre">parseSpaceList</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^The parser for the stuff between commas</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_694_1_694_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_694_1_694_15&#39;)"><span class="hl_fundecl"><span class="mpre">parseSpaceList</span></span></a><span class="mpre"> </span><a name="loc_694_16_694_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_694_16_694_17&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="Distribution.Compat.ReadP.html#loc_325_1_325_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_325_1_325_6&#39;)"><span class="hl_varref"><span class="mpre">sepBy</span></span></a><span class="mpre"> </span><a href="#loc_694_16_694_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_694_16_694_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Distribution.Compat.ReadP.html#loc_277_1_277_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_277_1_277_11&#39;)"><span class="hl_varref"><span class="mpre">skipSpaces</span></span></a><span class="mpre">

</span><a href="#loc_698_1_698_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_698_1_698_15&#39;)"><span class="mpre">parseCommaList</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^The parser for the stuff between commas</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_698_1_698_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_698_1_698_15&#39;)"><span class="hl_vardecl"><span class="mpre">parseCommaList</span></span></a><span class="mpre"> = </span><a href="#loc_689_1_689_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_689_1_689_13&#39;)"><span class="hl_varref"><span class="mpre">parseSepList</span></span></a><span class="mpre"> (</span><a href="Distribution.Compat.ReadP.html#loc_243_1_243_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_243_1_243_5&#39;)"><span class="hl_varref"><span class="mpre">ReadP.char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;,&#39;</span></span><span class="mpre">)

</span><a href="#loc_702_1_702_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_702_1_702_18&#39;)"><span class="mpre">parseOptCommaList</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^The parser for the stuff between commas</span></span><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_702_1_702_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_702_1_702_18&#39;)"><span class="hl_vardecl"><span class="mpre">parseOptCommaList</span></span></a><span class="mpre"> = </span><a href="#loc_689_1_689_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_689_1_689_13&#39;)"><span class="hl_varref"><span class="mpre">parseSepList</span></span></a><span class="mpre"> (</span><a href="Distribution.Compat.ReadP.html#loc_304_1_304_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_304_1_304_9&#39;)"><span class="hl_varref"><span class="mpre">optional</span></span></a><span class="mpre"> (</span><a href="Distribution.Compat.ReadP.html#loc_243_1_243_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_243_1_243_5&#39;)"><span class="hl_varref"><span class="mpre">ReadP.char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;,&#39;</span></span><span class="mpre">))

</span><a href="#loc_705_1_705_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_12&#39;)"><span class="mpre">parseQuoted</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_705_1_705_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_12&#39;)"><span class="hl_vardecl"><span class="mpre">parseQuoted</span></span></a><span class="mpre"> = </span><a href="Distribution.Compat.ReadP.html#loc_292_1_292_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_292_1_292_8&#39;)"><span class="hl_varref"><span class="mpre">between</span></span></a><span class="mpre"> (</span><a href="Distribution.Compat.ReadP.html#loc_243_1_243_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_243_1_243_5&#39;)"><span class="hl_varref"><span class="mpre">ReadP.char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;&quot;&#39;</span></span><span class="mpre">) (</span><a href="Distribution.Compat.ReadP.html#loc_243_1_243_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_243_1_243_5&#39;)"><span class="hl_varref"><span class="mpre">ReadP.char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;&quot;&#39;</span></span><span class="mpre">)

</span><a href="#loc_708_1_708_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_1_708_14&#39;)"><span class="mpre">parseFreeText</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ReadP.ReadP</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_708_1_708_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_1_708_14&#39;)"><span class="hl_vardecl"><span class="mpre">parseFreeText</span></span></a><span class="mpre"> = </span><a href="Distribution.Compat.ReadP.html#loc_255_1_255_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.ReadP.html#loc_255_1_255_6&#39;)"><span class="hl_varref"><span class="mpre">ReadP.munch</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- --------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ** Pretty printing</span></span><span class="mpre">

</span><a href="#loc_714_1_714_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_1_714_13&#39;)"><span class="mpre">showFilePath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_714_1_714_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_1_714_13&#39;)"><span class="hl_vardecl"><span class="mpre">showFilePath</span></span></a><span class="mpre"> = </span><a href="#loc_717_1_717_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_1_717_10&#39;)"><span class="hl_varref"><span class="mpre">showToken</span></span></a><span class="mpre">

</span><a href="#loc_717_1_717_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_1_717_10&#39;)"><span class="mpre">showToken</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_717_1_717_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_1_717_10&#39;)"><span class="hl_fundecl"><span class="mpre">showToken</span></span></a><span class="mpre"> </span><a name="loc_717_11_717_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_11_717_14&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">
 | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">any</span></span><span class="mpre"> </span><a href="#loc_721_9_721_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_721_9_721_14&#39;)"><span class="hl_varref"><span class="mpre">dodgy</span></span></a><span class="mpre"> </span><a href="#loc_717_11_717_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_11_717_14&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
   </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_717_11_717_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_11_717_14&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)       = </span><a href="Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> </span><a href="#loc_717_11_717_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_11_717_14&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
 | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">            = </span><a href="Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_717_11_717_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_11_717_14&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)
  where </span><a name="loc_721_9_721_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_721_9_721_14&#39;)"><span class="hl_fundecl"><span class="mpre">dodgy</span></span></a><span class="mpre"> </span><a name="loc_721_15_721_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_721_15_721_16&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><a href="#loc_721_15_721_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_721_15_721_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_721_15_721_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_721_15_721_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;,&#39;</span></span><span class="mpre">

</span><a href="#loc_724_1_724_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_1_724_15&#39;)"><span class="mpre">showTestedWith</span></a><span class="mpre"> :: (</span><a href="Distribution.Compiler.html#loc_81_6_81_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compiler.html#loc_81_6_81_20&#39;)"><span class="hl_tyconref"><span class="mpre">CompilerFlavor</span></span></a><span class="mpre">,</span><a href="Distribution.Version.html#loc_113_6_113_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Version.html#loc_113_6_113_18&#39;)"><span class="hl_tyconref"><span class="mpre">VersionRange</span></span></a><span class="mpre">) -&gt; </span><a href="Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_724_1_724_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_1_724_15&#39;)"><span class="hl_fundecl"><span class="mpre">showTestedWith</span></span></a><span class="mpre"> (</span><a name="loc_724_17_724_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_17_724_25&#39;)"><span class="hl_vardecl"><span class="mpre">compiler</span></span></a><span class="mpre">, </span><a name="loc_724_27_724_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_27_724_34&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="mpre">) = </span><a href="Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_724_17_724_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_17_724_25&#39;)"><span class="hl_varref"><span class="mpre">compiler</span></span></a><span class="mpre">) </span><a href="Text.PrettyPrint.HughesPJ.html#loc_551_3_551_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_551_3_551_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;+&gt;</span></span></a><span class="mpre"> </span><a href="Distribution.Text.html#loc_27_3_27_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_27_3_27_7&#39;)"><span class="hl_varref"><span class="mpre">disp</span></span></a><span class="mpre"> </span><a href="#loc_724_27_724_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_27_724_34&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Pretty-print free-format text, ensuring that it is vertically aligned,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and with blank lines replaced by dots for correct re-parsing.</span></span><span class="mpre">
</span><a href="#loc_729_1_729_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_729_1_729_13&#39;)"><span class="mpre">showFreeText</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_169_6_169_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_729_1_729_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_729_1_729_13&#39;)"><span class="hl_fundecl"><span class="mpre">showFreeText</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> = </span><a href="Text.PrettyPrint.HughesPJ.html#loc_275_1_275_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_275_1_275_6&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">
</span><a href="#loc_729_1_729_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_729_1_729_13&#39;)"><span class="hl_fundecl"><span class="mpre">showFreeText</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_730_21_730_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_21_730_22&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">)  = </span><a href="Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><a href="Text.PrettyPrint.HughesPJ.html#loc_490_3_490_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_490_3_490_6&#39;)"><span class="hl_infix"><span class="mpre">$+$</span></span></a><span class="mpre"> </span><a href="Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> </span><a href="Text.PrettyPrint.HughesPJ.html#loc_490_3_490_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_490_3_490_6&#39;)"><span class="hl_infix"><span class="mpre">$+$</span></span></a><span class="mpre"> </span><a href="#loc_729_1_729_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_729_1_729_13&#39;)"><span class="hl_varref"><span class="mpre">showFreeText</span></span></a><span class="mpre"> </span><a href="#loc_730_21_730_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_21_730_22&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><a href="#loc_729_1_729_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_729_1_729_13&#39;)"><span class="hl_fundecl"><span class="mpre">showFreeText</span></span></a><span class="mpre"> </span><a name="loc_731_14_731_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_731_14_731_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">  = </span><a href="Text.PrettyPrint.HughesPJ.html#loc_388_1_388_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_388_1_388_5&#39;)"><span class="hl_varref"><span class="mpre">vcat</span></span></a><span class="mpre"> [</span><a href="Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.PrettyPrint.HughesPJ.html#loc_256_1_256_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> (if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_731_60_731_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_731_60_731_61&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> else </span><a href="#loc_731_60_731_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_731_60_731_61&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) | </span><a name="loc_731_60_731_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_731_60_731_61&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_736_1_736_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_1_736_7&#39;)"><span class="hl_varref"><span class="mpre">lines_</span></span></a><span class="mpre"> </span><a href="#loc_731_14_731_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_731_14_731_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | &#39;lines_&#39; breaks a string up into a list of strings at newline</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- characters.  The resulting strings do not contain newlines.</span></span><span class="mpre">
</span><a href="#loc_736_1_736_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_1_736_7&#39;)"><span class="mpre">lines_</span></a><span class="mpre">                   :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
</span><a name="loc_736_1_736_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_1_736_7&#39;)"><span class="hl_fundecl"><span class="mpre">lines_</span></span></a><span class="mpre"> []                =  [</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">]
</span><a href="#loc_736_1_736_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_1_736_7&#39;)"><span class="hl_fundecl"><span class="mpre">lines_</span></span></a><span class="mpre"> </span><a name="loc_737_8_737_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_8_737_9&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">                 =  let (</span><a name="loc_737_34_737_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_34_737_35&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">, </span><a name="loc_737_37_737_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_37_737_39&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">) </span><a href="#loc_737_8_737_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_8_737_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
                            in  </span><a href="#loc_737_34_737_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_34_737_35&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> case </span><a href="#loc_737_37_737_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_37_737_39&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> of
                                        []    -&gt; []
                                        (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_740_44_740_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_44_740_47&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_736_1_736_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_1_736_7&#39;)"><span class="hl_varref"><span class="mpre">lines_</span></span></a><span class="mpre"> </span><a href="#loc_740_44_740_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_44_740_47&#39;)"><span class="hl_varref"><span class="mpre">s&#39;&#39;</span></span></a><span class="mpre">
</span></div></body></html>