<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}
module Certificate
    ( arbitraryX509
    , arbitraryX509WithKey
    , simpleCertificate
    , simpleX509
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Tests/Certificate.hs&quot;, srcSpanStartLine = 9, srcSpanStartColumn = 8, srcSpanEndLine = 9, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Test.QuickCheck&quot;"><span class="mpre">Test.QuickCheck</span></span><span class="mpre">
import Data.X509
import Data.Time.Calendar (</span><a href="Data.Time.Calendar.Gregorian.html#loc_32_1_32_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Gregorian.html#loc_32_1_32_14&#39;)"><span class="mpre">fromGregorian</span></a><span class="mpre">)
import Data.Time.Clock (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="mpre">secondsToDiffTime</span></a><span class="mpre">, </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="mpre">UTCTime</span></a><span class="mpre">(..))
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Tests/Certificate.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 18, srcSpanEndLine = 13, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B

import PubKey

</span><span class="hl_fundecl"><span class="mpre">testExtensionEncode</span></span><span class="mpre"> </span><a name="loc_17_21_17_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_21_17_29&#39;)"><span class="hl_vardecl"><span class="mpre">critical</span></span></a><span class="mpre"> </span><a name="loc_17_30_17_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_30_17_33&#39;)"><span class="hl_vardecl"><span class="mpre">ext</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">ExtensionRaw</span></span><span class="mpre"> (</span><a href="Data.X509.Ext.html#loc_67_5_67_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_67_5_67_11&#39;)"><span class="hl_varref"><span class="mpre">extOID</span></span></a><span class="mpre"> </span><a href="#loc_17_30_17_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_30_17_33&#39;)"><span class="hl_varref"><span class="mpre">ext</span></span></a><span class="mpre">) </span><a href="#loc_17_21_17_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_21_17_29&#39;)"><span class="hl_varref"><span class="mpre">critical</span></span></a><span class="mpre"> (</span><a href="Data.X509.Ext.html#loc_68_5_68_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Ext.html#loc_68_5_68_14&#39;)"><span class="hl_varref"><span class="mpre">extEncode</span></span></a><span class="mpre"> </span><a href="#loc_17_30_17_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_30_17_33&#39;)"><span class="hl_varref"><span class="mpre">ext</span></span></a><span class="mpre">)

</span><a name="loc_19_1_19_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_12&#39;)"><span class="hl_vardecl"><span class="mpre">arbitraryDN</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">DistinguishedName</span></span><span class="mpre"> []

</span><a name="loc_21_1_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_14&#39;)"><span class="hl_vardecl"><span class="mpre">arbitraryTime</span></span></a><span class="mpre"> = do
    </span><a name="loc_22_5_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_9&#39;)"><span class="hl_vardecl"><span class="mpre">year</span></span></a><span class="mpre">   &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1951</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">2050</span></span><span class="mpre">)
    </span><a name="loc_23_5_23_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_5_23_10&#39;)"><span class="hl_vardecl"><span class="mpre">month</span></span></a><span class="mpre">  &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">)
    </span><a name="loc_24_5_24_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_5_24_8&#39;)"><span class="hl_vardecl"><span class="mpre">day</span></span></a><span class="mpre">    &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">)
    </span><a name="loc_25_5_25_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_9&#39;)"><span class="hl_vardecl"><span class="mpre">hour</span></span></a><span class="mpre">   &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre">)
    </span><a name="loc_26_5_26_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_5_26_11&#39;)"><span class="hl_vardecl"><span class="mpre">minute</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre">)
    </span><a name="loc_27_5_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_11&#39;)"><span class="hl_vardecl"><span class="mpre">second</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre">)
    </span><span class="hl_comment"><span class="mpre">--z      &lt;- arbitrary</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Gregorian.html#loc_32_1_32_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Gregorian.html#loc_32_1_32_14&#39;)"><span class="hl_varref"><span class="mpre">fromGregorian</span></span></a><span class="mpre"> </span><a href="#loc_22_5_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_9&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><a href="#loc_23_5_23_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_5_23_10&#39;)"><span class="hl_varref"><span class="mpre">month</span></span></a><span class="mpre"> </span><a href="#loc_24_5_24_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_5_24_8&#39;)"><span class="hl_varref"><span class="mpre">day</span></span></a><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> (</span><a href="#loc_25_5_25_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_9&#39;)"><span class="hl_varref"><span class="mpre">hour</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3600</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_26_5_26_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_5_26_11&#39;)"><span class="hl_varref"><span class="mpre">minute</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">60</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_27_5_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_11&#39;)"><span class="hl_varref"><span class="mpre">second</span></span></a><span class="mpre">))

</span><a name="loc_31_1_31_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_10&#39;)"><span class="hl_vardecl"><span class="mpre">maxSerial</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">16777216</span></span><span class="mpre">

</span><a name="loc_33_1_33_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_21&#39;)"><span class="hl_fundecl"><span class="mpre">arbitraryCertificate</span></span></a><span class="mpre"> </span><a name="loc_33_22_33_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_28&#39;)"><span class="hl_vardecl"><span class="mpre">pubKey</span></span></a><span class="mpre"> = do
    </span><span class="hl_vardecl"><span class="mpre">serial</span></span><span class="mpre">    &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><a href="#loc_31_1_31_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_10&#39;)"><span class="hl_varref"><span class="mpre">maxSerial</span></span></a><span class="mpre">)
    </span><span class="hl_vardecl"><span class="mpre">issuerdn</span></span><span class="mpre">  &lt;- </span><a href="#loc_19_1_19_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_12&#39;)"><span class="hl_varref"><span class="mpre">arbitraryDN</span></span></a><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">subjectdn</span></span><span class="mpre"> &lt;- </span><a href="#loc_19_1_19_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_12&#39;)"><span class="hl_varref"><span class="mpre">arbitraryDN</span></span></a><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">time1</span></span><span class="mpre">     &lt;- </span><a href="#loc_21_1_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_14&#39;)"><span class="hl_varref"><span class="mpre">arbitraryTime</span></span></a><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">time2</span></span><span class="mpre">     &lt;- </span><a href="#loc_21_1_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_14&#39;)"><span class="hl_varref"><span class="mpre">arbitraryTime</span></span></a><span class="mpre">
    let </span><span class="hl_vardecl"><span class="mpre">sigalg</span></span><span class="mpre"> = </span><a href="Data.X509.AlgorithmIdentifier.html#loc_40_7_40_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_40_7_40_19&#39;)"><span class="hl_conref"><span class="mpre">SignatureALG</span></span></a><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_21_7_21_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_21_7_21_15&#39;)"><span class="hl_conref"><span class="mpre">HashSHA1</span></span></a><span class="mpre"> (</span><a href="Data.X509.PublicKey.html#loc_91_1_91_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.PublicKey.html#loc_91_1_91_12&#39;)"><span class="hl_varref"><span class="mpre">pubkeyToAlg</span></span></a><span class="mpre"> </span><a href="#loc_33_22_33_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_28&#39;)"><span class="hl_varref"><span class="mpre">pubKey</span></span></a><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Tests/Certificate.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 14, srcSpanEndLine = 51, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Tests/Certificate.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 13, srcSpanEndLine = 41, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Tests/Certificate.hs&quot;, srcSpanStartLine = 42, srcSpa"><span class="mpre">Certificate
            { certVersion      = 3
            , certSerial       = serial
            , certSignatureAlg = sigalg
            , certIssuerDN     = issuerdn
            , certSubjectDN    = subjectdn
            , certValidity     = (time1, time2)
            , certPubKey       = pubKey
            , certExtensions   = Extensions $ Just
                [ testExtensionEncode True $ ExtKeyUsage [KeyUsage_digitalSignature,KeyUsage_keyEncipherment,KeyUsage_keyCertSign]
                ]
            }</span></span><span class="mpre">

</span><a name="loc_53_1_53_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_18&#39;)"><span class="hl_fundecl"><span class="mpre">simpleCertificate</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">pubKey</span></span><span class="mpre"> =
    </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Tests/Certificate.hs&quot;, srcSpanStartLine = 54, srcSpanStartColumn = 5, srcSpanEndLine = 65, srcSpanEndColumn = 10}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Tests/Certificate.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 9, srcSpanEndLine = 55, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Tests/Certificate.hs&quot;, srcSpanStartLine = 56, srcSpanS"><span class="mpre">Certificate
        { certVersion = 3
        , certSerial = 0
        , certSignatureAlg = SignatureALG HashSHA1 (pubkeyToAlg pubKey)
        , certIssuerDN     = simpleDN
        , certSubjectDN    = simpleDN
        , certValidity     = (time1, time2)
        , certPubKey       = pubKey
        , certExtensions   = Extensions $ Just
                [ testExtensionEncode True $ ExtKeyUsage [KeyUsage_digitalSignature,KeyUsage_keyEncipherment]
                ]
        }</span></span><span class="mpre">
  where </span><span class="hl_vardecl"><span class="mpre">time1</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Gregorian.html#loc_32_1_32_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Gregorian.html#loc_32_1_32_14&#39;)"><span class="hl_varref"><span class="mpre">fromGregorian</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1999</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
        </span><span class="hl_vardecl"><span class="mpre">time2</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Gregorian.html#loc_32_1_32_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Gregorian.html#loc_32_1_32_14&#39;)"><span class="hl_varref"><span class="mpre">fromGregorian</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2901</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
        </span><span class="hl_vardecl"><span class="mpre">simpleDN</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">DistinguishedName</span></span><span class="mpre"> []

</span><a name="loc_70_1_70_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_11&#39;)"><span class="hl_fundecl"><span class="mpre">simpleX509</span></span></a><span class="mpre"> </span><a name="loc_70_12_70_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_12_70_18&#39;)"><span class="hl_vardecl"><span class="mpre">pubKey</span></span></a><span class="mpre"> = do
    let </span><a name="loc_71_9_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_13&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre"> = </span><a href="#loc_53_1_53_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_18&#39;)"><span class="hl_varref"><span class="mpre">simpleCertificate</span></span></a><span class="mpre"> </span><a href="#loc_70_12_70_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_12_70_18&#39;)"><span class="hl_varref"><span class="mpre">pubKey</span></span></a><span class="mpre">
        </span><a name="loc_72_9_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_12&#39;)"><span class="hl_vardecl"><span class="mpre">sig</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a name="loc_73_9_73_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_15&#39;)"><span class="hl_vardecl"><span class="mpre">sigalg</span></span></a><span class="mpre"> = </span><a href="Data.X509.AlgorithmIdentifier.html#loc_40_7_40_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_40_7_40_19&#39;)"><span class="hl_conref"><span class="mpre">SignatureALG</span></span></a><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_21_7_21_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_21_7_21_15&#39;)"><span class="hl_conref"><span class="mpre">HashSHA1</span></span></a><span class="mpre"> (</span><a href="Data.X509.PublicKey.html#loc_91_1_91_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.PublicKey.html#loc_91_1_91_12&#39;)"><span class="hl_varref"><span class="mpre">pubkeyToAlg</span></span></a><span class="mpre"> </span><a href="#loc_70_12_70_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_12_70_18&#39;)"><span class="hl_varref"><span class="mpre">pubKey</span></span></a><span class="mpre">)
        (</span><a name="loc_74_10_74_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_10_74_21&#39;)"><span class="hl_vardecl"><span class="mpre">signedExact</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) = </span><a href="Data.X509.Signed.html#loc_96_1_96_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_96_1_96_20&#39;)"><span class="hl_varref"><span class="mpre">objectToSignedExact</span></span></a><span class="mpre"> (\_ -&gt; (</span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><a href="#loc_72_9_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_12&#39;)"><span class="hl_varref"><span class="mpre">sig</span></span></a><span class="mpre">,</span><a href="#loc_73_9_73_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_15&#39;)"><span class="hl_varref"><span class="mpre">sigalg</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)) </span><a href="#loc_71_9_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_13&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">
     in </span><a href="#loc_74_10_74_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_10_74_21&#39;)"><span class="hl_varref"><span class="mpre">signedExact</span></span></a><span class="mpre">

</span><a name="loc_77_1_77_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_21&#39;)"><span class="hl_fundecl"><span class="mpre">arbitraryX509WithKey</span></span></a><span class="mpre"> (</span><a name="loc_77_23_77_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_23_77_29&#39;)"><span class="hl_vardecl"><span class="mpre">pubKey</span></span></a><span class="mpre">, _) = do
    </span><a name="loc_78_5_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_9&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_33_1_33_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_21&#39;)"><span class="hl_varref"><span class="mpre">arbitraryCertificate</span></span></a><span class="mpre"> </span><a href="#loc_77_23_77_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_23_77_29&#39;)"><span class="hl_varref"><span class="mpre">pubKey</span></span></a><span class="mpre">
    </span><a name="loc_79_5_79_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_5_79_8&#39;)"><span class="hl_vardecl"><span class="mpre">sig</span></span></a><span class="mpre">  &lt;- </span><span class="hl_varref"><span class="mpre">resize</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">listOf1</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre">
    let </span><a name="loc_80_9_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">sigalg</span></span></a><span class="mpre"> = </span><a href="Data.X509.AlgorithmIdentifier.html#loc_40_7_40_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_40_7_40_19&#39;)"><span class="hl_conref"><span class="mpre">SignatureALG</span></span></a><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_21_7_21_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_21_7_21_15&#39;)"><span class="hl_conref"><span class="mpre">HashSHA1</span></span></a><span class="mpre"> (</span><a href="Data.X509.PublicKey.html#loc_91_1_91_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.PublicKey.html#loc_91_1_91_12&#39;)"><span class="hl_varref"><span class="mpre">pubkeyToAlg</span></span></a><span class="mpre"> </span><a href="#loc_77_23_77_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_23_77_29&#39;)"><span class="hl_varref"><span class="mpre">pubKey</span></span></a><span class="mpre">)
    let (</span><a name="loc_81_10_81_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_10_81_21&#39;)"><span class="hl_vardecl"><span class="mpre">signedExact</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) = </span><a href="Data.X509.Signed.html#loc_96_1_96_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_96_1_96_20&#39;)"><span class="hl_varref"><span class="mpre">objectToSignedExact</span></span></a><span class="mpre"> (\(!(_)) -&gt; (</span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><a href="#loc_79_5_79_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_5_79_8&#39;)"><span class="hl_varref"><span class="mpre">sig</span></span></a><span class="mpre">,</span><a href="#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">sigalg</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)) </span><a href="#loc_78_5_78_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_9&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_81_10_81_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_10_81_21&#39;)"><span class="hl_varref"><span class="mpre">signedExact</span></span></a><span class="mpre">

</span><a name="loc_84_1_84_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_14&#39;)"><span class="hl_vardecl"><span class="mpre">arbitraryX509</span></span></a><span class="mpre"> = do
    let (</span><a name="loc_85_10_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_10_85_16&#39;)"><span class="hl_vardecl"><span class="mpre">pubKey</span></span></a><span class="mpre">, </span><a name="loc_85_18_85_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_18_85_25&#39;)"><span class="hl_vardecl"><span class="mpre">privKey</span></span></a><span class="mpre">) = </span><a href="PubKey.html#loc_37_1_37_17" onmouseover="nemnem.highlightLocalToRemote(&#39;PubKey.html#loc_37_1_37_17&#39;)"><span class="hl_varref"><span class="mpre">getGlobalRSAPair</span></span></a><span class="mpre">
    </span><a href="#loc_77_1_77_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_21&#39;)"><span class="hl_varref"><span class="mpre">arbitraryX509WithKey</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">PubKeyRSA</span></span><span class="mpre"> </span><a href="#loc_85_10_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_10_85_16&#39;)"><span class="hl_varref"><span class="mpre">pubKey</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">PrivKeyRSA</span></span><span class="mpre"> </span><a href="#loc_85_18_85_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_18_85_25&#39;)"><span class="hl_varref"><span class="mpre">privKey</span></span></a><span class="mpre">)
</span></div></body></html>