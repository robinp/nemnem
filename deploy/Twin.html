<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS -fglasgow-exts #-}
 
module Twin (tests) where

</span><span class="hl_comment"><span class="mpre">{-

For the discussion in the 2nd boilerplate paper,
we favour some simplified development of twin traversal.
So the full general, stepwise story is in Data.Generics.Twin,
but the short version from the paper is turned into a test
case below. 

See the paper for an explanation.
 
-}</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 8, srcSpanEndLine = 17, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">

import Data.Generics hiding (GQ,</span><a href="Data.Generics.Twins.html#loc_222_1_222_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Twins.html#loc_222_1_222_10&#39;)"><span class="mpre">gzipWithQ</span></a><span class="mpre">,</span><a href="Data.Generics.Twins.html#loc_255_1_255_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Twins.html#loc_255_1_255_4&#39;)"><span class="mpre">geq</span></a><span class="mpre">)

</span><a href="#loc_22_1_22_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_5&#39;)"><span class="mpre">geq&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)
</span><a name="loc_22_1_22_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_5&#39;)"><span class="hl_fundecl"><span class="mpre">geq&#39;</span></span></a><span class="mpre"> </span><a name="loc_22_6_22_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_6_22_7&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_22_8_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_8_22_9&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> =  </span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_22_6_22_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_6_22_7&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_22_8_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_8_22_9&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
         </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">and</span></span><span class="mpre"> (</span><a href="#loc_32_1_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_10&#39;)"><span class="hl_varref"><span class="mpre">gzipWithQ</span></span></a><span class="mpre"> </span><a href="#loc_22_1_22_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_5&#39;)"><span class="hl_varref"><span class="mpre">geq&#39;</span></span></a><span class="mpre"> </span><a href="#loc_22_6_22_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_6_22_7&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_22_8_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_8_22_9&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)

</span><a href="#loc_26_1_26_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_4&#39;)"><span class="mpre">geq</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 8, srcSpanEndLine = 25, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 15, srcSpanEndLine = 25, srcSpanEndColumn = 17}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStartL"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_26_1_26_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_4&#39;)"><span class="hl_vardecl"><span class="mpre">geq</span></span></a><span class="mpre"> = </span><a href="#loc_22_1_22_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_5&#39;)"><span class="hl_varref"><span class="mpre">geq&#39;</span></span></a><span class="mpre">

newtype </span><a name="loc_28_9_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_11&#39;)"><span class="hl_tycondecl"><span class="mpre">GQ</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> = </span><a name="loc_28_16_28_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_16_28_18&#39;)"><span class="hl_condecl"><span class="mpre">GQ</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)

</span><a href="#loc_32_1_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_10&#39;)"><span class="mpre">gzipWithQ</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
          -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">])
</span><a name="loc_32_1_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_10&#39;)"><span class="hl_fundecl"><span class="mpre">gzipWithQ</span></span></a><span class="mpre"> </span><a name="loc_32_11_32_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_32_13_32_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_13_32_15&#39;)"><span class="hl_vardecl"><span class="mpre">t1</span></span></a><span class="mpre"> </span><a name="loc_32_16_32_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_18&#39;)"><span class="hl_vardecl"><span class="mpre">t2</span></span></a><span class="mpre"> 
    = </span><a href="#loc_36_1_36_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_8&#39;)"><span class="hl_varref"><span class="mpre">gApplyQ</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> (\</span><a name="loc_33_24_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_24_33_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_28_16_28_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_16_28_18&#39;)"><span class="hl_conref"><span class="mpre">GQ</span></span></a><span class="mpre"> (</span><a href="#loc_32_11_32_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_33_24_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_24_33_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)) </span><a href="#loc_32_13_32_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_13_32_15&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre">) </span><a href="#loc_32_16_32_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_18&#39;)"><span class="hl_varref"><span class="mpre">t2</span></span></a><span class="mpre">

</span><a href="#loc_36_1_36_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_8&#39;)"><span class="mpre">gApplyQ</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 12, srcSpanEndLine = 35, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 19, srcSpanEndLine = 35, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStart"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> [</span><a href="#loc_28_9_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_11&#39;)"><span class="hl_tyconref"><span class="mpre">GQ</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">]
</span><a name="loc_36_1_36_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_8&#39;)"><span class="hl_fundecl"><span class="mpre">gApplyQ</span></span></a><span class="mpre"> </span><a name="loc_36_9_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_11&#39;)"><span class="hl_vardecl"><span class="mpre">qs</span></span></a><span class="mpre"> </span><a name="loc_36_12_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_12_36_13&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> (</span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">gfoldlQ</span></span></a><span class="mpre"> </span><a href="#loc_39_7_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_7_39_8&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_40_7_40_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_7_40_8&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_36_12_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_12_36_13&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">))
    where
      </span><a href="#loc_39_7_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_7_39_8&#39;)"><span class="mpre">k</span></a><span class="mpre"> :: ([</span><a href="#loc_28_9_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_11&#39;)"><span class="hl_tyconref"><span class="mpre">GQ</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">], [</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">]) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> ([</span><a href="#loc_28_9_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_11&#39;)"><span class="hl_tyconref"><span class="mpre">GQ</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">], [</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">])
      </span><a name="loc_39_7_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_7_39_8&#39;)"><span class="hl_fundecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_28_16_28_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_16_28_18&#39;)"><span class="hl_conref"><span class="mpre">GQ</span></span></a><span class="mpre"> </span><a name="loc_39_13_39_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_13_39_14&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_39_17_39_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_17_39_19&#39;)"><span class="hl_vardecl"><span class="mpre">qs</span></span></a><span class="mpre">, </span><a name="loc_39_21_39_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_21_39_23&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">) </span><a name="loc_39_25_39_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_25_39_30&#39;)"><span class="hl_vardecl"><span class="mpre">child</span></span></a><span class="mpre"> = (</span><a href="#loc_39_17_39_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_17_39_19&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">, </span><a href="#loc_39_13_39_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_13_39_14&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><a href="#loc_39_25_39_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_25_39_30&#39;)"><span class="hl_varref"><span class="mpre">child</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_39_21_39_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_21_39_23&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">)
      </span><a name="loc_40_7_40_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_7_40_8&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = (</span><a href="#loc_36_9_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_11&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">, [])

newtype </span><span class="hl_tycondecl"><span class="mpre">R</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> = </span><a name="loc_42_17_42_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_18&#39;)"><span class="hl_condecl"><span class="mpre">R</span></span></a><span class="mpre"> { </span><a name="loc_42_21_42_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_21_42_24&#39;)"><span class="hl_fielddecl"><span class="mpre">unR</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> }

</span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="mpre">gfoldlQ</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
        -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> 
        -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">

</span><a name="loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_fundecl"><span class="mpre">gfoldlQ</span></span></a><span class="mpre"> </span><a name="loc_48_9_48_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_48_11_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_12&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> </span><a name="loc_48_13_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_14&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_42_21_42_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_21_42_24&#39;)"><span class="hl_varref"><span class="mpre">unR</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">gfoldl</span></span><span class="mpre"> </span><a href="#loc_51_7_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_7_51_9&#39;)"><span class="hl_varref"><span class="mpre">k&#39;</span></span></a><span class="mpre"> </span><a href="#loc_50_7_50_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_9&#39;)"><span class="hl_varref"><span class="mpre">z&#39;</span></span></a><span class="mpre"> </span><a href="#loc_48_13_48_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_14&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
    where
      </span><a name="loc_50_7_50_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_9&#39;)"><span class="hl_fundecl"><span class="mpre">z&#39;</span></span></a><span class="mpre"> _ = </span><a href="#loc_42_17_42_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_18&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a href="#loc_48_11_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_12&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
      </span><a name="loc_51_7_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_7_51_9&#39;)"><span class="hl_fundecl"><span class="mpre">k&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_42_17_42_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_18&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> </span><a name="loc_51_13_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_14&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) </span><a name="loc_51_16_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_16_51_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_42_17_42_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_18&#39;)"><span class="hl_conref"><span class="mpre">R</span></span></a><span class="mpre"> (</span><a href="#loc_48_9_48_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_51_13_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_14&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_51_16_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_16_51_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- A dependently polymorphic geq</span></span><span class="mpre">
</span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="mpre">geq&#39;&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 10, srcSpanEndLine = 56, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 17, srcSpanEndLine = 56, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStart"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_fundecl"><span class="mpre">geq&#39;&#39;</span></span></a><span class="mpre"> </span><a name="loc_57_7_57_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_57_9_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_9_57_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> =  </span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_57_7_57_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_57_9_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_9_57_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
          </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">and</span></span><span class="mpre"> (</span><a href="#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_11&#39;)"><span class="hl_varref"><span class="mpre">gzipWithQ&#39;</span></span></a><span class="mpre"> </span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_varref"><span class="mpre">geq&#39;&#39;</span></span></a><span class="mpre"> </span><a href="#loc_57_7_57_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_57_9_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_9_57_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- A helper type for existentially quantified queries</span></span><span class="mpre">
data </span><a name="loc_61_6_61_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_8&#39;)"><span class="hl_tycondecl"><span class="mpre">XQ</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> = forall a. Data a =&gt; </span><a name="loc_61_33_61_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_33_61_35&#39;)"><span class="hl_condecl"><span class="mpre">XQ</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- A dependently polymorphic gzipWithQ</span></span><span class="mpre">
</span><a href="#loc_66_1_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_11&#39;)"><span class="mpre">gzipWithQ&#39;</span></a><span class="mpre"> :: (forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 26, srcSpanEndLine = 64, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 33, srcSpanEndLine = 64, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStart"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
           -&gt; (forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 26, srcSpanEndLine = 65, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 33, srcSpanEndLine = 65, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStart"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">])
</span><a name="loc_66_1_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">gzipWithQ&#39;</span></span></a><span class="mpre"> </span><a name="loc_66_12_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_12_66_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_66_14_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_14_66_16&#39;)"><span class="hl_vardecl"><span class="mpre">t1</span></span></a><span class="mpre"> </span><a name="loc_66_17_66_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_17_66_19&#39;)"><span class="hl_vardecl"><span class="mpre">t2</span></span></a><span class="mpre">
    = </span><a href="#loc_73_1_73_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_9&#39;)"><span class="hl_varref"><span class="mpre">gApplyQ&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> (\</span><a name="loc_67_25_67_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_25_67_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_61_33_61_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_33_61_35&#39;)"><span class="hl_conref"><span class="mpre">XQ</span></span></a><span class="mpre"> (</span><a href="#loc_66_12_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_12_66_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_67_25_67_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_25_67_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)) </span><a href="#loc_66_14_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_14_66_16&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre">) </span><a href="#loc_66_17_66_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_17_66_19&#39;)"><span class="hl_varref"><span class="mpre">t2</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Apply existentially quantified queries</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Insist on equal types!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_73_1_73_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_9&#39;)"><span class="mpre">gApplyQ&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 13, srcSpanEndLine = 72, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 20, srcSpanEndLine = 72, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Twin.hs&quot;, srcSpanStart"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> [</span><a href="#loc_61_6_61_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_8&#39;)"><span class="hl_tyconref"><span class="mpre">XQ</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">]
</span><a name="loc_73_1_73_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_9&#39;)"><span class="hl_fundecl"><span class="mpre">gApplyQ&#39;</span></span></a><span class="mpre"> </span><a name="loc_73_10_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_12&#39;)"><span class="hl_vardecl"><span class="mpre">qs</span></span></a><span class="mpre"> </span><a name="loc_73_13_73_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_13_73_14&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> (</span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">gfoldlQ</span></span></a><span class="mpre"> </span><a href="#loc_77_7_77_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_7_77_8&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_75_7_75_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_7_75_8&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_73_13_73_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_13_73_14&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">))
    where
      </span><a name="loc_75_7_75_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_7_75_8&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = (</span><a href="#loc_73_10_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_12&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">, [])
      </span><a href="#loc_77_7_77_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_7_77_8&#39;)"><span class="mpre">k</span></a><span class="mpre"> :: ([</span><a href="#loc_61_6_61_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_8&#39;)"><span class="hl_tyconref"><span class="mpre">XQ</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">], [</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">]) -&gt; </span><span class="hl_tyconref"><span class="mpre">GenericQ</span></span><span class="mpre"> ([</span><a href="#loc_61_6_61_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_8&#39;)"><span class="hl_tyconref"><span class="mpre">XQ</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">], [</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">])
      </span><a name="loc_77_7_77_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_7_77_8&#39;)"><span class="hl_fundecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_61_33_61_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_33_61_35&#39;)"><span class="hl_conref"><span class="mpre">XQ</span></span></a><span class="mpre"> </span><a name="loc_77_13_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_13_77_14&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_77_17_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_17_77_19&#39;)"><span class="hl_vardecl"><span class="mpre">qs</span></span></a><span class="mpre">, </span><a name="loc_77_21_77_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_23&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">) </span><a name="loc_77_25_77_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_25_77_30&#39;)"><span class="hl_vardecl"><span class="mpre">child</span></span></a><span class="mpre"> = (</span><a href="#loc_77_17_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_17_77_19&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">, </span><a href="#loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_varref"><span class="mpre">q&#39;</span></span></a><span class="mpre"> </span><a href="#loc_77_25_77_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_25_77_30&#39;)"><span class="hl_varref"><span class="mpre">child</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_77_21_77_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_23&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">)
        where
          </span><a name="loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_vardecl"><span class="mpre">q&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Twin mismatch&quot;</span></span><span class="mpre"> </span><a href="Data.Generics.Aliases.html#loc_177_1_177_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_177_1_177_5&#39;)"><span class="hl_infix"><span class="mpre">`extQ`</span></span></a><span class="mpre"> </span><a href="#loc_77_13_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_13_77_14&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

</span><a name="loc_84_1_84_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = ( </span><a href="#loc_26_1_26_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_4&#39;)"><span class="hl_varref"><span class="mpre">geq</span></span></a><span class="mpre">   [</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">] [</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">]
        , </span><a href="#loc_26_1_26_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_4&#39;)"><span class="hl_varref"><span class="mpre">geq</span></span></a><span class="mpre">   [</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">] [</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">]
        , </span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_varref"><span class="mpre">geq&#39;&#39;</span></span></a><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">] [</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">]
        , </span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_varref"><span class="mpre">geq&#39;&#39;</span></span></a><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">] [</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">]
        ) </span><span class="hl_infix"><span class="mpre">~=?</span></span><span class="mpre"> </span><a href="#loc_90_1_90_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_7&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">

</span><a name="loc_90_1_90_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_7&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">)
</span></div></body></html>