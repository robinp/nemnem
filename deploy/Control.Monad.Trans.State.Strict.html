<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Control.Monad.Trans.State.Strict</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) Andy Gill 2001,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                (c) Oregon Graduate Institute of Science and Technology, 2001</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  ross@soi.city.ac.uk</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Strict state monads, passing an updatable state through a computation.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- See below for examples.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Some computations may not require the full power of state transformers:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * For a read-only state, see &quot;Control.Monad.Trans.Reader&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * To accumulate a value without using it on the way, see</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &quot;Control.Monad.Trans.Writer&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In this version, sequencing of computations is strict (but computations</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- are not strict in the state unless you force it with &#39;seq&#39; or the like).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For a lazy version with the same interface, see</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;Control.Monad.Trans.State.Lazy&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Control.Monad.Trans.State.Strict (
    </span><span class="hl_comment"><span class="mpre">-- * The State monad</span></span><span class="mpre">
    State,
    state,
    runState,
    evalState,
    execState,
    mapState,
    withState,
    </span><span class="hl_comment"><span class="mpre">-- * The StateT monad transformer</span></span><span class="mpre">
    StateT(..),
    evalStateT,
    execStateT,
    mapStateT,
    withStateT,
    </span><span class="hl_comment"><span class="mpre">-- * State operations</span></span><span class="mpre">
    get,
    put,
    modify,
    modify&#39;,
    gets,
    </span><span class="hl_comment"><span class="mpre">-- * Lifting other operations</span></span><span class="mpre">
    liftCallCC,
    liftCallCC&#39;,
    liftCatch,
    liftListen,
    liftPass,
    </span><span class="hl_comment"><span class="mpre">-- * Examples</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ** State monads</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- $examples</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- ** Counting</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- $counting</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- ** Labelling trees</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- $labelling</span></span><span class="mpre">
  ) where

import Control.Monad.IO.Class
import Control.Monad.Signatures
import Control.Monad.Trans.Class
import Data.Functor.Identity

import Control.Applicative
import Control.Monad
import Control.Monad.Fix

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | A state monad parameterized by the type @s@ of the state to carry.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;return&#39; function leaves the state unchanged, while @&gt;&gt;=@ uses</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the final state of the first computation as the initial state of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the second.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 1, srcSpanEndLine = 81, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 1, srcSpanEndLine = 81, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0"><span class="mpre">type State s = StateT s Identity</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Construct a state monad computation from a function.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (The inverse of &#39;runState&#39;.)</span></span><span class="mpre">
</span><a href="#loc_88_1_88_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_6&#39;)"><span class="mpre">state</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 85, srcSpanStartColumn = 10, srcSpanEndLine = 86, srcSpanEndColumn = 9}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 85, srcSpanStartColumn = 10, srcSpanEndLine = 85, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-"><span class="mpre">(Monad m)
      =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">))  </span><span class="hl_comment"><span class="mpre">-- ^pure state transformer</span></span><span class="mpre">
      -&gt; </span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^equivalent state-passing computation</span></span><span class="mpre">
</span><a name="loc_88_1_88_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_6&#39;)"><span class="hl_fundecl"><span class="mpre">state</span></span></a><span class="mpre"> </span><a name="loc_88_7_88_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_8&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_88_7_88_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_7_88_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Unwrap a state monad computation as a function.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (The inverse of &#39;state&#39;.)</span></span><span class="mpre">
</span><a href="#loc_95_1_95_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_9&#39;)"><span class="mpre">runState</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">State</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^state-passing computation to execute</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^initial state</span></span><span class="mpre">
         -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)      </span><span class="hl_comment"><span class="mpre">-- ^return value and final state</span></span><span class="mpre">
</span><a name="loc_95_1_95_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_9&#39;)"><span class="hl_fundecl"><span class="mpre">runState</span></span></a><span class="mpre"> </span><a name="loc_95_10_95_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_10_95_11&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="Data.Functor.Identity.html#loc_35_33_35_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.Identity.html#loc_35_33_35_44&#39;)"><span class="hl_varref"><span class="mpre">runIdentity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> </span><a href="#loc_95_10_95_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_10_95_11&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Evaluate a state computation with the given initial state</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and return the final value, discarding the final state.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;evalState&#39; m s = &#39;fst&#39; (&#39;runState&#39; m s)@</span></span><span class="mpre">
</span><a href="#loc_104_1_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_10&#39;)"><span class="mpre">evalState</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">State</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^state-passing computation to execute</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- ^initial value</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- ^return value of the state computation</span></span><span class="mpre">
</span><a name="loc_104_1_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_10&#39;)"><span class="hl_fundecl"><span class="mpre">evalState</span></span></a><span class="mpre"> </span><a name="loc_104_11_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_11_104_12&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_104_13_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> (</span><a href="#loc_95_1_95_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_9&#39;)"><span class="hl_varref"><span class="mpre">runState</span></span></a><span class="mpre"> </span><a href="#loc_104_11_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_11_104_12&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_104_13_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Evaluate a state computation with the given initial state</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and return the final state, discarding the final value.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;execState&#39; m s = &#39;snd&#39; (&#39;runState&#39; m s)@</span></span><span class="mpre">
</span><a href="#loc_113_1_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_10&#39;)"><span class="mpre">execState</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">State</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^state-passing computation to execute</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- ^initial value</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- ^final state</span></span><span class="mpre">
</span><a name="loc_113_1_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_10&#39;)"><span class="hl_fundecl"><span class="mpre">execState</span></span></a><span class="mpre"> </span><a name="loc_113_11_113_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_11_113_12&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_113_13_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_13_113_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> (</span><a href="#loc_95_1_95_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_9&#39;)"><span class="hl_varref"><span class="mpre">runState</span></span></a><span class="mpre"> </span><a href="#loc_113_11_113_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_11_113_12&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_113_13_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_13_113_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Map both the return value and final state of a computation using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the given function.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;runState&#39; (&#39;mapState&#39; f m) = f . &#39;runState&#39; m@</span></span><span class="mpre">
</span><a href="#loc_120_1_120_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_9&#39;)"><span class="mpre">mapState</span></a><span class="mpre"> :: ((</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyconref"><span class="mpre">State</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">State</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_120_1_120_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_9&#39;)"><span class="hl_fundecl"><span class="mpre">mapState</span></span></a><span class="mpre"> </span><a name="loc_120_10_120_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_10_120_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_164_1_164_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_10&#39;)"><span class="hl_varref"><span class="mpre">mapStateT</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Identity</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_120_10_120_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_10_120_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Functor.Identity.html#loc_35_33_35_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.Identity.html#loc_35_33_35_44&#39;)"><span class="hl_varref"><span class="mpre">runIdentity</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;withState&#39; f m@ executes action @m@ on a state modified by</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- applying @f@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;withState&#39; f m = &#39;modify&#39; f &gt;&gt; m@</span></span><span class="mpre">
</span><a href="#loc_127_1_127_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_10&#39;)"><span class="mpre">withState</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">State</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">State</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_127_1_127_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_10&#39;)"><span class="hl_vardecl"><span class="mpre">withState</span></span></a><span class="mpre"> = </span><a href="#loc_171_1_171_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_11&#39;)"><span class="hl_varref"><span class="mpre">withStateT</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | A state transformer monad parameterized by:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   * @s@ - The state.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   * @m@ - The inner monad.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;return&#39; function leaves the state unchanged, while @&gt;&gt;=@ uses</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the final state of the first computation as the initial state of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the second.</span></span><span class="mpre">
newtype </span><a name="loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tycondecl"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_condecl"><span class="mpre">StateT</span></span></a><span class="mpre"> { </span><a name="loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_fielddecl"><span class="mpre">runStateT</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) }

</span><span class="hl_comment"><span class="mpre">-- | Evaluate a state computation with the given initial state</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and return the final value, discarding the final state.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;evalStateT&#39; m s = &#39;liftM&#39; &#39;fst&#39; (&#39;runStateT&#39; m s)@</span></span><span class="mpre">
</span><a href="#loc_146_1_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_11&#39;)"><span class="mpre">evalStateT</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 145, srcSpanStartColumn = 15, srcSpanEndLine = 145, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 145, srcSpanStartColumn = 15, srcSpanEndLine = 145, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transfor"><span class="mpre">(Monad m) =&gt;</span></span><span class="mpre"> </span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_146_1_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_11&#39;)"><span class="hl_fundecl"><span class="mpre">evalStateT</span></span></a><span class="mpre"> </span><a name="loc_146_12_146_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_12_146_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_146_14_146_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_14_146_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = do
    (</span><a name="loc_147_6_147_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_6_147_7&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, _) &lt;- </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> </span><a href="#loc_146_12_146_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_12_146_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_146_14_146_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_14_146_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_147_6_147_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_6_147_7&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Evaluate a state computation with the given initial state</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and return the final state, discarding the final value.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;execStateT&#39; m s = &#39;liftM&#39; &#39;snd&#39; (&#39;runStateT&#39; m s)@</span></span><span class="mpre">
</span><a href="#loc_155_1_155_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_11&#39;)"><span class="mpre">execStateT</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 154, srcSpanStartColumn = 15, srcSpanEndLine = 154, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 154, srcSpanStartColumn = 15, srcSpanEndLine = 154, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transfor"><span class="mpre">(Monad m) =&gt;</span></span><span class="mpre"> </span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_155_1_155_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_11&#39;)"><span class="hl_fundecl"><span class="mpre">execStateT</span></span></a><span class="mpre"> </span><a name="loc_155_12_155_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_12_155_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_155_14_155_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_14_155_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = do
    (_, </span><a name="loc_156_9_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_11&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> </span><a href="#loc_155_12_155_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_12_155_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_155_14_155_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_14_155_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_156_9_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_11&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Map both the return value and final state of a computation using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the given function.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;runStateT&#39; (&#39;mapStateT&#39; f m) = f . &#39;runStateT&#39; m@</span></span><span class="mpre">
</span><a href="#loc_164_1_164_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_10&#39;)"><span class="mpre">mapStateT</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">n</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)) -&gt; </span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">n</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_164_1_164_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_10&#39;)"><span class="hl_fundecl"><span class="mpre">mapStateT</span></span></a><span class="mpre"> </span><a name="loc_164_11_164_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_11_164_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_164_13_164_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_13_164_14&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_164_11_164_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_11_164_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> </span><a href="#loc_164_13_164_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_13_164_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;withStateT&#39; f m@ executes action @m@ on a state modified by</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- applying @f@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;withStateT&#39; f m = &#39;modify&#39; f &gt;&gt; m@</span></span><span class="mpre">
</span><a href="#loc_171_1_171_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_11&#39;)"><span class="mpre">withStateT</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_171_1_171_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_11&#39;)"><span class="hl_fundecl"><span class="mpre">withStateT</span></span></a><span class="mpre"> </span><a name="loc_171_12_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_12_171_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_171_14_171_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_14_171_15&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> </span><a href="#loc_171_14_171_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_14_171_15&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_171_12_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_12_171_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 173, srcSpanStartColumn = 10, srcSpanEndLine = 173, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 173, srcSpanStartColumn = 10, srcSpanEndLine = 173, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transfor"><span class="mpre">(Functor m) =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> (</span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
    </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_174_10_174_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_10_174_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_174_12_174_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_12_174_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_174_27_174_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_27_174_28&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt;
        </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (\ (</span><a name="loc_175_18_175_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_18_175_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_175_21_175_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_21_175_23&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_174_10_174_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_10_174_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_175_18_175_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_18_175_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_175_21_175_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_21_175_23&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> </span><a href="#loc_174_12_174_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_12_174_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_174_27_174_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_27_174_28&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 177, srcSpanStartColumn = 10, srcSpanEndLine = 177, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 177, srcSpanStartColumn = 10, srcSpanEndLine = 177, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transfor"><span class="mpre">(Functor m, Monad m) =&gt;</span></span><span class="mpre"> </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> (</span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
    </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_vardecl"><span class="mpre">pure</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">
    </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;*&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="hl_varref"><span class="mpre">ap</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 181, srcSpanStartColumn = 10, srcSpanEndLine = 181, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 181, srcSpanStartColumn = 10, srcSpanEndLine = 181, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transfor"><span class="mpre">(Functor m, MonadPlus m) =&gt;</span></span><span class="mpre"> </span><a href="Control.Applicative.html#loc_138_24_138_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_138_24_138_35&#39;)"><span class="hl_classref"><span class="mpre">Alternative</span></span></a><span class="mpre"> (</span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
    </span><a href="Control.Applicative.html#loc_140_5_140_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_140_5_140_10&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_varref"><span class="mpre">mzero</span></span></a><span class="mpre">
    </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;|&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_varref"><span class="mpre">mplus</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 185, srcSpanStartColumn = 10, srcSpanEndLine = 185, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 185, srcSpanStartColumn = 10, srcSpanEndLine = 185, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transfor"><span class="mpre">(Monad m) =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> (</span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
    </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_186_12_186_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_12_186_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_88_1_88_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_6&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_186_26_186_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_26_186_27&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_186_12_186_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_12_186_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_186_26_186_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_26_186_27&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
    </span><a name="loc_187_5_187_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_6&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_187_11_187_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_11_187_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">  = </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_187_27_187_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_27_187_28&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; do
        (</span><a name="loc_188_10_188_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_10_188_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_188_13_188_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_13_188_15&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> </span><a href="#loc_187_5_187_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_187_27_187_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_27_187_28&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
        </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> (</span><a href="#loc_187_11_187_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_11_187_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_188_10_188_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_10_188_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_188_13_188_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_13_188_15&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">fail</span></span><span class="mpre"> </span><a name="loc_190_10_190_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_10_190_13&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ _ -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><a href="#loc_190_10_190_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_10_190_13&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 192, srcSpanStartColumn = 10, srcSpanEndLine = 192, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 192, srcSpanStartColumn = 10, srcSpanEndLine = 192, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transfor"><span class="mpre">(MonadPlus m) =&gt;</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_122_18_122_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_122_18_122_27&#39;)"><span class="hl_classref"><span class="mpre">MonadPlus</span></span></a><span class="mpre"> (</span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
    </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_vardecl"><span class="mpre">mzero</span></span></a><span class="mpre">       = </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ _ -&gt; </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_varref"><span class="mpre">mzero</span></span></a><span class="mpre">
    </span><a name="loc_194_5_194_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_5_194_6&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a name="loc_194_15_194_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_15_194_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_194_30_194_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_30_194_31&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> </span><a href="#loc_194_5_194_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_5_194_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_194_30_194_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_30_194_31&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> </span><a href="#loc_194_15_194_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_15_194_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_194_30_194_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_30_194_31&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 196, srcSpanStartColumn = 10, srcSpanEndLine = 196, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 196, srcSpanStartColumn = 10, srcSpanEndLine = 196, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transfor"><span class="mpre">(MonadFix m) =&gt;</span></span><span class="mpre"> </span><a href="Control.Monad.Fix.html#loc_48_20_48_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Fix.html#loc_48_20_48_28&#39;)"><span class="hl_classref"><span class="mpre">MonadFix</span></span></a><span class="mpre"> (</span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
    </span><a href="Control.Monad.Fix.html#loc_53_9_53_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Fix.html#loc_53_9_53_13&#39;)"><span class="hl_fundecl"><span class="mpre">mfix</span></span></a><span class="mpre"> </span><a name="loc_197_10_197_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_10_197_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_197_25_197_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_25_197_26&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="Control.Monad.Fix.html#loc_53_9_53_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Fix.html#loc_53_9_53_13&#39;)"><span class="hl_varref"><span class="mpre">mfix</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><span class="warning" data-warning="PatPIrrPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 197, srcSpanStartColumn = 39, srcSpanEndLine = 197, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 197, srcSpanStartColumn = 39, srcSpanEndLine = 197, srcSpanEndColumn = 40}]}) (PTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilenam"><span class="mpre">~(a, _)</span></span><span class="mpre"> -&gt; </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> (</span><a href="#loc_197_10_197_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_10_197_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">a</span></span><span class="mpre">) </span><a href="#loc_197_25_197_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_25_197_26&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

instance </span><a href="Control.Monad.Trans.Class.html#loc_49_7_49_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_49_7_49_17&#39;)"><span class="hl_classref"><span class="mpre">MonadTrans</span></span></a><span class="mpre"> (</span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
    </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_fundecl"><span class="mpre">lift</span></span></a><span class="mpre"> </span><a name="loc_200_10_200_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_10_200_11&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_200_25_200_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_25_200_26&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_201_9_201_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_200_10_200_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_10_200_11&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_201_9_201_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_200_25_200_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_25_200_26&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

instance </span><span class="warning" data-warning="InstDecl ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 204, srcSpanStartColumn = 10, srcSpanEndLine = 204, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 204, srcSpanStartColumn = 10, srcSpanEndLine = 204, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transfor"><span class="mpre">(MonadIO m) =&gt;</span></span><span class="mpre"> </span><a href="Control.Monad.IO.Class.html#loc_30_20_30_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_30_20_30_27&#39;)"><span class="hl_classref"><span class="mpre">MonadIO</span></span></a><span class="mpre"> (</span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
    </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_vardecl"><span class="mpre">liftIO</span></span></a><span class="mpre"> = </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Fetch the current value of the state within the monad.</span></span><span class="mpre">
</span><a href="#loc_209_1_209_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_4&#39;)"><span class="mpre">get</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 208, srcSpanStartColumn = 8, srcSpanEndLine = 208, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 208, srcSpanStartColumn = 8, srcSpanEndLine = 208, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformer"><span class="mpre">(Monad m) =&gt;</span></span><span class="mpre"> </span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_209_1_209_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_4&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="mpre"> = </span><a href="#loc_88_1_88_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_6&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_209_17_209_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_17_209_18&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_209_17_209_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_17_209_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_209_17_209_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_17_209_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;put&#39; s@ sets the state within the monad to @s@.</span></span><span class="mpre">
</span><a href="#loc_213_1_213_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_4&#39;)"><span class="mpre">put</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 212, srcSpanStartColumn = 8, srcSpanEndLine = 212, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 212, srcSpanStartColumn = 8, srcSpanEndLine = 212, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformer"><span class="mpre">(Monad m) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_213_1_213_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_4&#39;)"><span class="hl_fundecl"><span class="mpre">put</span></span></a><span class="mpre"> </span><a name="loc_213_5_213_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_5_213_6&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_88_1_88_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_6&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ _ -&gt; (</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">, </span><a href="#loc_213_5_213_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_5_213_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;modify&#39; f@ is an action that updates the state to the result of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- applying @f@ to the current state.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;modify&#39; f = &#39;get&#39; &gt;&gt;= (&#39;put&#39; . f)@</span></span><span class="mpre">
</span><a href="#loc_220_1_220_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_7&#39;)"><span class="mpre">modify</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 219, srcSpanStartColumn = 11, srcSpanEndLine = 219, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 219, srcSpanStartColumn = 11, srcSpanEndLine = 219, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transfor"><span class="mpre">(Monad m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_220_1_220_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_7&#39;)"><span class="hl_fundecl"><span class="mpre">modify</span></span></a><span class="mpre"> </span><a name="loc_220_8_220_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_8_220_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_88_1_88_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_6&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_220_22_220_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_22_220_23&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">, </span><a href="#loc_220_8_220_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_8_220_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_220_22_220_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_22_220_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | A variant of &#39;modify&#39; in which the computation is strict in the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- new state.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;modify&#39;&#39; f = &#39;get&#39; &gt;&gt;= ((&#39;$!&#39;) &#39;put&#39; . f)@</span></span><span class="mpre">
</span><a href="#loc_227_1_227_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_8&#39;)"><span class="mpre">modify&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 226, srcSpanStartColumn = 12, srcSpanEndLine = 226, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 226, srcSpanStartColumn = 12, srcSpanEndLine = 226, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transfor"><span class="mpre">(Monad m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_227_1_227_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_8&#39;)"><span class="hl_fundecl"><span class="mpre">modify&#39;</span></span></a><span class="mpre"> </span><a name="loc_227_9_227_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
    </span><a name="loc_228_5_228_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_5_228_6&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_209_1_209_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_4&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre">
    </span><a href="#loc_213_1_213_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_4&#39;)"><span class="hl_varref"><span class="mpre">put</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_227_9_227_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_228_5_228_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_5_228_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get a specific component of the state, using a projection function</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- supplied.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;gets&#39; f = &#39;liftM&#39; f &#39;get&#39;@</span></span><span class="mpre">
</span><a href="#loc_236_1_236_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_5&#39;)"><span class="mpre">gets</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 235, srcSpanStartColumn = 9, srcSpanEndLine = 235, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 235, srcSpanStartColumn = 9, srcSpanEndLine = 235, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transforme"><span class="mpre">(Monad m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_236_1_236_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_5&#39;)"><span class="hl_fundecl"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a name="loc_236_6_236_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_6_236_7&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_88_1_88_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_6&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_236_20_236_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_20_236_21&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_236_6_236_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_6_236_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_236_20_236_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_20_236_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_236_20_236_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_20_236_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Uniform lifting of a @callCC@ operation to the new monad.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This version rolls back to the original state on entering the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- continuation.</span></span><span class="mpre">
</span><a href="#loc_242_1_242_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_11&#39;)"><span class="mpre">liftCallCC</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CallCC</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">CallCC</span></span><span class="mpre"> (</span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_242_1_242_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_11&#39;)"><span class="hl_fundecl"><span class="mpre">liftCallCC</span></span></a><span class="mpre"> </span><a name="loc_242_12_242_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_12_242_18&#39;)"><span class="hl_vardecl"><span class="mpre">callCC</span></span></a><span class="mpre"> </span><a name="loc_242_19_242_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_19_242_20&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_242_34_242_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_34_242_35&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt;
    </span><a href="#loc_242_12_242_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_12_242_18&#39;)"><span class="hl_varref"><span class="mpre">callCC</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_243_16_243_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_16_243_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt;
    </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> (</span><a href="#loc_242_19_242_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_19_242_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (\ </span><a name="loc_244_21_244_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_21_244_22&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ _ -&gt; </span><a href="#loc_243_16_243_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_16_243_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_244_21_244_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_21_244_22&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_242_34_242_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_34_242_35&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))) </span><a href="#loc_242_34_242_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_34_242_35&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | In-situ lifting of a @callCC@ operation to the new monad.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This version uses the current state on entering the continuation.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It does not satisfy the laws of a monad transformer.</span></span><span class="mpre">
</span><a href="#loc_250_1_250_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_1_250_12&#39;)"><span class="mpre">liftCallCC&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CallCC</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">CallCC</span></span><span class="mpre"> (</span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_250_1_250_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_1_250_12&#39;)"><span class="hl_fundecl"><span class="mpre">liftCallCC&#39;</span></span></a><span class="mpre"> </span><a name="loc_250_13_250_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_13_250_19&#39;)"><span class="hl_vardecl"><span class="mpre">callCC</span></span></a><span class="mpre"> </span><a name="loc_250_20_250_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_20_250_21&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_250_35_250_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_35_250_36&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt;
    </span><a href="#loc_250_13_250_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_13_250_19&#39;)"><span class="hl_varref"><span class="mpre">callCC</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_251_16_251_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_16_251_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt;
    </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> (</span><a href="#loc_250_20_250_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_20_250_21&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (\ </span><a name="loc_252_21_252_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_21_252_22&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_252_37_252_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_37_252_39&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_251_16_251_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_16_251_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_252_21_252_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_21_252_22&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_252_37_252_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_37_252_39&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">))) </span><a href="#loc_250_35_250_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_35_250_36&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Lift a @catchE@ operation to the new monad.</span></span><span class="mpre">
</span><a href="#loc_256_1_256_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_1_256_10&#39;)"><span class="mpre">liftCatch</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Catch</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Catch</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> (</span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_256_1_256_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_1_256_10&#39;)"><span class="hl_fundecl"><span class="mpre">liftCatch</span></span></a><span class="mpre"> </span><a name="loc_256_11_256_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_11_256_17&#39;)"><span class="hl_vardecl"><span class="mpre">catchE</span></span></a><span class="mpre"> </span><a name="loc_256_18_256_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_18_256_19&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_256_20_256_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_20_256_21&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> =
    </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_257_16_257_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_16_257_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> </span><a href="#loc_256_18_256_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_18_256_19&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_257_16_257_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_16_257_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_256_11_256_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_11_256_17&#39;)"><span class="hl_infix"><span class="mpre">`catchE`</span></span></a><span class="mpre"> \ </span><a name="loc_257_46_257_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_46_257_47&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> (</span><a href="#loc_256_20_256_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_20_256_21&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_257_46_257_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_46_257_47&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">) </span><a href="#loc_257_16_257_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_16_257_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Lift a @listen@ operation to the new monad.</span></span><span class="mpre">
</span><a href="#loc_261_1_261_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_11&#39;)"><span class="mpre">liftListen</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 260, srcSpanStartColumn = 15, srcSpanEndLine = 260, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 260, srcSpanStartColumn = 15, srcSpanEndLine = 260, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transfor"><span class="mpre">(Monad m) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Listen</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Listen</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> (</span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_261_1_261_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_11&#39;)"><span class="hl_fundecl"><span class="mpre">liftListen</span></span></a><span class="mpre"> </span><a name="loc_261_12_261_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_12_261_18&#39;)"><span class="hl_vardecl"><span class="mpre">listen</span></span></a><span class="mpre"> </span><a name="loc_261_19_261_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_19_261_20&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_261_34_261_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_34_261_35&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; do
    ((</span><a name="loc_262_7_262_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_7_262_8&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_262_10_262_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_10_262_12&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">), </span><a name="loc_262_15_262_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_15_262_16&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_261_12_261_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_12_261_18&#39;)"><span class="hl_varref"><span class="mpre">listen</span></span></a><span class="mpre"> (</span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> </span><a href="#loc_261_19_261_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_19_261_20&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_261_34_261_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_34_261_35&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> ((</span><a href="#loc_262_7_262_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_7_262_8&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_262_15_262_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_15_262_16&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">), </span><a href="#loc_262_10_262_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_10_262_12&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Lift a @pass@ operation to the new monad.</span></span><span class="mpre">
</span><a href="#loc_267_1_267_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_9&#39;)"><span class="mpre">liftPass</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 266, srcSpanStartColumn = 13, srcSpanEndLine = 266, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.4.1.0/Control/Monad/Trans/State/Strict.hs&quot;, srcSpanStartLine = 266, srcSpanStartColumn = 13, srcSpanEndLine = 266, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transfor"><span class="mpre">(Monad m) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Pass</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Pass</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> (</span><a href="#loc_139_9_139_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_15&#39;)"><span class="hl_tyconref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_267_1_267_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_9&#39;)"><span class="hl_fundecl"><span class="mpre">liftPass</span></span></a><span class="mpre"> </span><a name="loc_267_10_267_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_10_267_14&#39;)"><span class="hl_vardecl"><span class="mpre">pass</span></span></a><span class="mpre"> </span><a name="loc_267_15_267_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_15_267_16&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_139_24_139_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_30&#39;)"><span class="hl_conref"><span class="mpre">StateT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_267_30_267_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_30_267_31&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_267_10_267_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_10_267_14&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    ((</span><a name="loc_268_7_268_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_7_268_8&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_268_10_268_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_10_268_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">), </span><a name="loc_268_14_268_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_14_268_16&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_139_33_139_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_33_139_42&#39;)"><span class="hl_varref"><span class="mpre">runStateT</span></span></a><span class="mpre"> </span><a href="#loc_267_15_267_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_15_267_16&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_267_30_267_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_30_267_31&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> ((</span><a href="#loc_268_7_268_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_7_268_8&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_268_14_268_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_14_268_16&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">), </span><a href="#loc_268_10_268_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_10_268_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">{- $examples

Parser from ParseLib with Hugs:

&gt; type Parser a = StateT String [] a
&gt;    ==&gt; StateT (String -&gt; [(a,String)])

For example, item can be written as:

&gt; item = do (x:xs) &lt;- get
&gt;        put xs
&gt;        return x
&gt;
&gt; type BoringState s a = StateT s Identity a
&gt;      ==&gt; StateT (s -&gt; Identity (a,s))
&gt;
&gt; type StateWithIO s a = StateT s IO a
&gt;      ==&gt; StateT (s -&gt; IO (a,s))
&gt;
&gt; type StateWithErr s a = StateT s Maybe a
&gt;      ==&gt; StateT (s -&gt; Maybe (a,s))

-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- $counting

A function to increment a counter.
Taken from the paper \&quot;Generalising Monads to Arrows\&quot;,
John Hughes (&lt;http://www.cse.chalmers.se/~rjmh/&gt;), November 1998:

&gt; tick :: State Int Int
&gt; tick = do n &lt;- get
&gt;           put (n+1)
&gt;           return n

Add one to the given number using the state monad:

&gt; plusOne :: Int -&gt; Int
&gt; plusOne n = execState tick n

A contrived addition example. Works only with positive numbers:

&gt; plus :: Int -&gt; Int -&gt; Int
&gt; plus n x = execState (sequence $ replicate n tick) x

-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- $labelling

An example from /The Craft of Functional Programming/, Simon
Thompson (&lt;http://www.cs.kent.ac.uk/people/staff/sjt/&gt;),
Addison-Wesley 1999: \&quot;Given an arbitrary tree, transform it to a
tree of integers in which the original elements are replaced by
natural numbers, starting from 0.  The same element has to be
replaced by the same number at every occurrence, and when we meet
an as-yet-unvisited element we have to find a \&#39;new\&#39; number to match
it with:\&quot;

&gt; data Tree a = Nil | Node a (Tree a) (Tree a) deriving (Show, Eq)
&gt; type Table a = [a]

&gt; numberTree :: Eq a =&gt; Tree a -&gt; State (Table a) (Tree Int)
&gt; numberTree Nil = return Nil
&gt; numberTree (Node x t1 t2) = do
&gt;     num &lt;- numberNode x
&gt;     nt1 &lt;- numberTree t1
&gt;     nt2 &lt;- numberTree t2
&gt;     return (Node num nt1 nt2)
&gt;   where
&gt;     numberNode :: Eq a =&gt; a -&gt; State (Table a) Int
&gt;     numberNode x = do
&gt;         table &lt;- get
&gt;         case elemIndex x table of
&gt;             Nothing -&gt; do
&gt;                 put (table ++ [x])
&gt;                 return (length table)
&gt;             Just i -&gt; return i

numTree applies numberTree with an initial state:

&gt; numTree :: (Eq a) =&gt; Tree a -&gt; Tree Int
&gt; numTree t = evalState (numberTree t) []

&gt; testTree = Node &quot;Zero&quot; (Node &quot;One&quot; (Node &quot;Two&quot; Nil Nil) (Node &quot;One&quot; (Node &quot;Zero&quot; Nil Nil) Nil)) Nil
&gt; numTree testTree =&gt; Node 0 (Node 1 (Node 2 Nil Nil) (Node 1 (Node 0 Nil Nil) Nil)) Nil

-}</span></span><span class="mpre">
</span></div></body></html>