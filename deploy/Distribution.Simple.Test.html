<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Distribution.Simple.Test</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  Thomas Tuegel 2010</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  cabal-devel@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is the entry point into testing a built package. It performs the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- \&quot;@.\/setup test@\&quot; action. It runs test suites designated in the package</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- description and reports on the results.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.

    * Redistributions in binary form must reproduce the above
      copyright notice, this list of conditions and the following
      disclaimer in the documentation and/or other materials provided
      with the distribution.

    * Neither the name of Isaac Jones nor the names of other
      contributors may be used to endorse or promote products derived
      from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
&quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. -}</span></span><span class="mpre">

module Distribution.Simple.Test
    ( test
    , stubMain
    , writeSimpleTestStub
    , stubFilePath
    , stubName
    , PackageLog(..)
    , TestSuiteLog(..)
    , TestLogs(..)
    , suitePassed, suiteFailed, suiteError
    ) where

import Distribution.Compat.TempFile ( openTempFile )
import Distribution.ModuleName ( </span><a href="Distribution.ModuleName.html#loc_67_9_67_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.ModuleName.html#loc_67_9_67_19&#39;)"><span class="mpre">ModuleName</span></a><span class="mpre"> )
import Distribution.Package
    ( PackageId )
import qualified Distribution.PackageDescription as PD
         ( </span><a href="Distribution.PackageDescription.html#loc_161_6_161_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_161_6_161_24&#39;)"><span class="mpre">PackageDescription</span></a><span class="mpre">(..), </span><a href="Distribution.PackageDescription.html#loc_636_6_636_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_636_6_636_15&#39;)"><span class="mpre">BuildInfo</span></a><span class="mpre">(</span><a href="Distribution.PackageDescription.html#loc_637_9_637_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_637_9_637_18&#39;)"><span class="mpre">buildable</span></a><span class="mpre">)
         , </span><a href="Distribution.PackageDescription.html#loc_395_6_395_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_395_6_395_15&#39;)"><span class="mpre">TestSuite</span></a><span class="mpre">(..)
         , </span><a href="Distribution.PackageDescription.html#loc_414_6_414_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_414_6_414_24&#39;)"><span class="mpre">TestSuiteInterface</span></a><span class="mpre">(..), </span><a href="Distribution.PackageDescription.html#loc_520_1_520_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_520_1_520_9&#39;)"><span class="mpre">testType</span></a><span class="mpre">, </span><a href="Distribution.PackageDescription.html#loc_465_1_465_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_465_1_465_9&#39;)"><span class="mpre">hasTests</span></a><span class="mpre"> )
import Distribution.Simple.Build.PathsModule ( </span><a href="Distribution.Simple.Build.PathsModule.html#loc_192_1_192_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Build.PathsModule.html#loc_192_1_192_14&#39;)"><span class="mpre">pkgPathEnvVar</span></a><span class="mpre"> )
import Distribution.Simple.BuildPaths ( </span><a href="Distribution.Simple.BuildPaths.html#loc_135_1_135_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.BuildPaths.html#loc_135_1_135_13&#39;)"><span class="mpre">exeExtension</span></a><span class="mpre"> )
import Distribution.Simple.Compiler ( </span><a href="Distribution.Simple.Compiler.html#loc_85_6_85_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Compiler.html#loc_85_6_85_14&#39;)"><span class="mpre">Compiler</span></a><span class="mpre">(..), </span><a href="Distribution.Compiler.html#loc_154_6_154_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compiler.html#loc_154_6_154_16&#39;)"><a href="Distribution.Compiler.html#loc_154_19_154_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compiler.html#loc_154_19_154_29&#39;)"><span class="mpre">CompilerId</span></a></a><span class="mpre"> )
import Distribution.Simple.Hpc
    ( </span><a href="Distribution.Simple.Hpc.html#loc_166_1_166_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Hpc.html#loc_166_1_166_14&#39;)"><span class="mpre">markupPackage</span></a><span class="mpre">, </span><a href="Distribution.Simple.Hpc.html#loc_142_1_142_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Hpc.html#loc_142_1_142_11&#39;)"><span class="mpre">markupTest</span></a><span class="mpre">, </span><a href="Distribution.Simple.Hpc.html#loc_122_1_122_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Hpc.html#loc_122_1_122_7&#39;)"><span class="mpre">tixDir</span></a><span class="mpre">, </span><a href="Distribution.Simple.Hpc.html#loc_128_1_128_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Hpc.html#loc_128_1_128_12&#39;)"><span class="mpre">tixFilePath</span></a><span class="mpre"> )
import Distribution.Simple.InstallDirs
    ( </span><a href="Distribution.Simple.InstallDirs.html#loc_410_1_410_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_410_1_410_17&#39;)"><span class="mpre">fromPathTemplate</span></a><span class="mpre">, </span><a href="Distribution.Simple.InstallDirs.html#loc_429_1_429_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_429_1_429_23&#39;)"><span class="mpre">initialPathTemplateEnv</span></a><span class="mpre">, </span><a href="Distribution.Simple.InstallDirs.html#loc_378_6_378_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_378_6_378_26&#39;)"><span class="mpre">PathTemplateVariable</span></a><span class="mpre">(..)
    , </span><a href="Distribution.Simple.InstallDirs.html#loc_417_1_417_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_417_1_417_18&#39;)"><span class="mpre">substPathTemplate</span></a><span class="mpre"> , </span><a href="Distribution.Simple.InstallDirs.html#loc_405_1_405_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_405_1_405_15&#39;)"><span class="mpre">toPathTemplate</span></a><span class="mpre">, </span><a href="Distribution.Simple.InstallDirs.html#loc_371_9_371_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_371_9_371_21&#39;)"><span class="mpre">PathTemplate</span></a><span class="mpre"> )
import qualified Distribution.Simple.LocalBuildInfo as LBI
    ( </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20&#39;)"><span class="mpre">LocalBuildInfo</span></a><span class="mpre">(..) )
import Distribution.Simple.Setup ( </span><a href="Distribution.Simple.Setup.html#loc_1529_6_1529_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1529_6_1529_15&#39;)"><span class="mpre">TestFlags</span></a><span class="mpre">(..), </span><a href="Distribution.Simple.Setup.html#loc_1507_6_1507_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1507_6_1507_21&#39;)"><span class="mpre">TestShowDetails</span></a><span class="mpre">(..), </span><a href="Distribution.Simple.Setup.html#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_185_1_185_9&#39;)"><span class="mpre">fromFlag</span></a><span class="mpre"> )
import Distribution.Simple.Utils ( </span><a href="Distribution.Simple.Utils.html#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_251_1_251_4&#39;)"><span class="mpre">die</span></a><span class="mpre">, </span><a href="Distribution.Simple.Utils.html#loc_292_1_292_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_292_1_292_7&#39;)"><span class="mpre">notice</span></a><span class="mpre">, </span><a href="Distribution.Simple.Utils.html#loc_470_1_470_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_470_1_470_19&#39;)"><span class="mpre">rawSystemIOWithEnv</span></a><span class="mpre"> )
import Distribution.TestSuite
    ( </span><a href="Distribution.TestSuite.html#loc_68_6_68_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_68_6_68_17&#39;)"><span class="mpre">OptionDescr</span></a><span class="mpre">(..), Options, </span><a href="Distribution.TestSuite.html#loc_114_6_114_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_114_6_114_14&#39;)"><span class="mpre">Progress</span></a><span class="mpre">(..), </span><a href="Distribution.TestSuite.html#loc_117_6_117_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_117_6_117_12&#39;)"><span class="mpre">Result</span></a><span class="mpre">(..), </span><a href="Distribution.TestSuite.html#loc_53_6_53_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_53_6_53_18&#39;)"><span class="mpre">TestInstance</span></a><span class="mpre">(..)
    , </span><a href="Distribution.TestSuite.html#loc_96_6_96_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_96_6_96_10&#39;)"><span class="mpre">Test</span></a><span class="mpre">(..) )
import Distribution.Text
import Distribution.Verbosity ( </span><a href="Distribution.Verbosity.html#loc_67_1_67_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_67_1_67_7&#39;)"><span class="mpre">normal</span></a><span class="mpre">, </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="mpre">Verbosity</span></a><span class="mpre"> )
import Distribution.System ( </span><a href="Distribution.System.html#loc_164_6_164_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.System.html#loc_164_6_164_14&#39;)"><a href="Distribution.System.html#loc_164_17_164_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.System.html#loc_164_17_164_25&#39;)"><span class="mpre">Platform</span></a></a><span class="mpre"> )

import Control.Exception ( </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="mpre">bracket</span></a><span class="mpre"> )
import Control.Monad ( </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="mpre">unless</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_154_1_154_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_154_1_154_8&#39;)"><span class="mpre">filterM</span></a><span class="mpre"> )
import Data.Char ( </span><a href="GHC.Unicode.html#loc_144_1_144_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_144_1_144_8&#39;)"><span class="mpre">toUpper</span></a><span class="mpre"> )
import Data.Maybe ( </span><a href="Data.Maybe.html#loc_123_1_123_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_123_1_123_9&#39;)"><span class="mpre">mapMaybe</span></a><span class="mpre"> )
import System.Directory
    ( </span><a href="System.Directory.html#loc_267_1_267_25" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_267_1_267_25&#39;)"><span class="mpre">createDirectoryIfMissing</span></a><span class="mpre">, </span><a href="System.Directory.html#loc_717_1_717_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_717_1_717_19&#39;)"><span class="mpre">doesDirectoryExist</span></a><span class="mpre">, </span><a href="System.Directory.html#loc_726_1_726_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_726_1_726_14&#39;)"><span class="mpre">doesFileExist</span></a><span class="mpre">
    , </span><a href="System.Directory.html#loc_673_1_673_20" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_673_1_673_20&#39;)"><span class="mpre">getCurrentDirectory</span></a><span class="mpre">, </span><a href="System.Directory.html#loc_628_1_628_21" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_628_1_628_21&#39;)"><span class="mpre">getDirectoryContents</span></a><span class="mpre">, </span><a href="System.Directory.html#loc_351_1_351_25" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_351_1_351_25&#39;)"><span class="mpre">removeDirectoryRecursive</span></a><span class="mpre">
    , </span><a href="System.Directory.html#loc_400_1_400_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_400_1_400_11&#39;)"><span class="mpre">removeFile</span></a><span class="mpre">, </span><a href="System.Directory.html#loc_709_1_709_20" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_709_1_709_20&#39;)"><span class="mpre">setCurrentDirectory</span></a><span class="mpre"> )
import Distribution.Compat.Environment ( </span><a href="Distribution.Compat.Environment.html#loc_18_1_18_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Environment.html#loc_18_1_18_15&#39;)"><span class="mpre">getEnvironment</span></a><span class="mpre"> )
import System.Exit ( </span><a href="GHC.IO.Exception.html#loc_205_6_205_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_205_6_205_14&#39;)"><span class="mpre">ExitCode</span></a><span class="mpre">(..), </span><a href="System.Exit.html#loc_69_1_69_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Exit.html#loc_69_1_69_12&#39;)"><span class="mpre">exitFailure</span></a><span class="mpre">, </span><a href="System.Exit.html#loc_60_1_60_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Exit.html#loc_60_1_60_9&#39;)"><span class="mpre">exitWith</span></a><span class="mpre"> )
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 8, srcSpanEndLine = 92, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;System.FilePath&quot;"><span class="mpre">System.FilePath</span></span><span class="mpre"> ( (&lt;/&gt;), (&lt;.&gt;) )
import System.IO ( </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="mpre">hClose</span></a><span class="mpre">, </span><a href="GHC.IO.IOMode.html#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_6_28_12&#39;)"><span class="mpre">IOMode</span></a><span class="mpre">(..), </span><a href="GHC.IO.Handle.FD.html#loc_150_1_150_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_150_1_150_9&#39;)"><span class="mpre">openFile</span></a><span class="mpre"> )

</span><span class="hl_comment"><span class="mpre">-- | Logs all test results for a package, broken down first by test suite and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- then by test case.</span></span><span class="mpre">
data </span><a name="loc_97_6_97_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_16&#39;)"><span class="hl_tycondecl"><span class="mpre">PackageLog</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">PackageLog</span></span><span class="mpre">
    { </span><a name="loc_98_7_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_7_98_14&#39;)"><span class="hl_fielddecl"><span class="mpre">package</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">PackageId</span></span><span class="mpre">
    , </span><a name="loc_99_7_99_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_7_99_15&#39;)"><span class="hl_fielddecl"><span class="mpre">compiler</span></span></a><span class="mpre"> :: </span><a href="Distribution.Compiler.html#loc_154_6_154_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compiler.html#loc_154_6_154_16&#39;)"><span class="hl_tyconref"><span class="mpre">CompilerId</span></span></a><span class="mpre">
    , </span><a name="loc_100_7_100_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_7_100_15&#39;)"><span class="hl_fielddecl"><span class="mpre">platform</span></span></a><span class="mpre"> :: </span><a href="Distribution.System.html#loc_164_6_164_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.System.html#loc_164_6_164_14&#39;)"><span class="hl_tyconref"><span class="mpre">Platform</span></span></a><span class="mpre">
    , </span><a name="loc_101_7_101_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_7_101_17&#39;)"><span class="hl_fielddecl"><span class="mpre">testSuites</span></span></a><span class="mpre"> :: [</span><a href="#loc_115_6_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_18&#39;)"><span class="hl_tyconref"><span class="mpre">TestSuiteLog</span></span></a><span class="mpre">]
    }
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 103, srcSpanStartColumn = 5, srcSpanEndLine = 103, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 103, srcSpanStartColumn = 5, srcSpanEndLine = 103, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Te"><span class="mpre">deriving (Read, Show, Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A &#39;PackageLog&#39; with package and platform information specified.</span></span><span class="mpre">
</span><a href="#loc_107_1_107_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_16&#39;)"><span class="mpre">localPackageLog</span></a><span class="mpre"> :: </span><a href="Distribution.PackageDescription.html#loc_161_6_161_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_161_6_161_24&#39;)"><span class="hl_tyconref"><span class="mpre">PD.PackageDescription</span></span></a><span class="mpre"> -&gt; </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20&#39;)"><span class="hl_tyconref"><span class="mpre">LBI.LocalBuildInfo</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_97_6_97_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_16&#39;)"><span class="hl_tyconref"><span class="mpre">PackageLog</span></span></a><span class="mpre">
</span><a name="loc_107_1_107_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_16&#39;)"><span class="hl_fundecl"><span class="mpre">localPackageLog</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">pkg_descr</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">lbi</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 33, srcSpanEndLine = 112, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 108, srcSpanStartColumn = 5, srcSpanEndLine = 108, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Te"><span class="mpre">PackageLog
    { package = PD.package pkg_descr
    , compiler = compilerId $ LBI.compiler lbi
    , platform = LBI.hostPlatform lbi
    , testSuites = []
    }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Logs test suite results, itemized by test case.</span></span><span class="mpre">
data </span><a name="loc_115_6_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_18&#39;)"><span class="hl_tycondecl"><span class="mpre">TestSuiteLog</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">TestSuiteLog</span></span><span class="mpre">
    { </span><a name="loc_116_7_116_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_7_116_20&#39;)"><span class="hl_fielddecl"><span class="mpre">testSuiteName</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><a name="loc_117_7_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_7_117_15&#39;)"><span class="hl_fielddecl"><span class="mpre">testLogs</span></span></a><span class="mpre"> :: </span><a href="#loc_122_6_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_6_122_14&#39;)"><span class="hl_tyconref"><span class="mpre">TestLogs</span></span></a><span class="mpre">
    , </span><a name="loc_118_7_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_7_118_14&#39;)"><span class="hl_fielddecl"><span class="mpre">logFile</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- path to human-readable log file</span></span><span class="mpre">
    }
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 5, srcSpanEndLine = 120, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 5, srcSpanEndLine = 120, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Te"><span class="mpre">deriving (Read, Show, Eq)</span></span><span class="mpre">

data </span><a name="loc_122_6_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_6_122_14&#39;)"><span class="hl_tycondecl"><span class="mpre">TestLogs</span></span></a><span class="mpre">
    = </span><span class="hl_condecl"><span class="mpre">TestLog</span></span><span class="mpre">
        { </span><a name="loc_124_11_124_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_11_124_19&#39;)"><span class="hl_fielddecl"><span class="mpre">testName</span></span></a><span class="mpre">              :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
        , </span><a name="loc_125_11_125_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_11_125_30&#39;)"><span class="hl_fielddecl"><span class="mpre">testOptionsReturned</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Options</span></span><span class="mpre">
        , </span><a name="loc_126_11_126_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_21&#39;)"><span class="hl_fielddecl"><span class="mpre">testResult</span></span></a><span class="mpre">            :: </span><a href="Distribution.TestSuite.html#loc_117_6_117_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_117_6_117_12&#39;)"><span class="hl_tyconref"><span class="mpre">Result</span></span></a><span class="mpre">
        }
    | </span><a name="loc_128_7_128_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_7_128_16&#39;)"><span class="hl_condecl"><span class="mpre">GroupLogs</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> [</span><a href="#loc_122_6_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_6_122_14&#39;)"><span class="hl_tyconref"><span class="mpre">TestLogs</span></span></a><span class="mpre">]
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 129, srcSpanStartColumn = 5, srcSpanEndLine = 129, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 129, srcSpanStartColumn = 5, srcSpanEndLine = 129, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Te"><span class="mpre">deriving (Read, Show, Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Count the number of pass, fail, and error test results in a &#39;TestLogs&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- tree.</span></span><span class="mpre">
</span><a href="#loc_136_1_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_17&#39;)"><span class="mpre">countTestResults</span></a><span class="mpre"> :: </span><a href="#loc_122_6_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_6_122_14&#39;)"><span class="hl_tyconref"><span class="mpre">TestLogs</span></span></a><span class="mpre">
                 -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ Passes, fails, and errors,</span></span><span class="mpre">
                                    </span><span class="hl_comment"><span class="mpre">-- respectively.</span></span><span class="mpre">
</span><a name="loc_136_1_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_17&#39;)"><span class="hl_vardecl"><span class="mpre">countTestResults</span></span></a><span class="mpre"> = </span><a href="#loc_138_5_138_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
  where
    </span><a name="loc_138_5_138_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_138_9_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">, </span><a name="loc_138_12_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_12_138_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">, </span><a name="loc_138_15_138_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_15_138_16&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 138, srcSpanStartColumn = 19, srcSpanEndLine = 138, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 138, srcSpanStartColumn = 27, srcSpanEndLine = 138, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test"><span class="mpre">TestLog { testResult = r }</span></span><span class="mpre">) =
        case </span><span class="hl_varref"><span class="mpre">r</span></span><span class="mpre"> of
            </span><a href="Distribution.TestSuite.html#loc_117_15_117_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_117_15_117_19&#39;)"><span class="hl_conref"><span class="mpre">Pass</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_138_9_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><a href="#loc_138_12_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_12_138_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">, </span><a href="#loc_138_15_138_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_15_138_16&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
            </span><a href="Distribution.TestSuite.html#loc_118_15_118_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_118_15_118_19&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre"> _ -&gt; (</span><a href="#loc_138_9_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><a href="#loc_138_12_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_12_138_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><a href="#loc_138_15_138_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_15_138_16&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
            </span><a href="Distribution.TestSuite.html#loc_119_15_119_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_119_15_119_20&#39;)"><span class="hl_conref"><span class="mpre">Error</span></span></a><span class="mpre"> _ -&gt; (</span><a href="#loc_138_9_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><a href="#loc_138_12_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_12_138_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">, </span><a href="#loc_138_15_138_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_15_138_16&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
    </span><a href="#loc_138_5_138_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_143_9_143_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_9_143_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">, </span><a name="loc_143_12_143_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_12_143_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">, </span><a name="loc_143_15_143_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_15_143_16&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) (</span><a href="#loc_128_7_128_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_7_128_16&#39;)"><span class="hl_conref"><span class="mpre">GroupLogs</span></span></a><span class="mpre"> _ </span><a name="loc_143_31_143_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_31_143_33&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> </span><a href="#loc_138_5_138_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_143_9_143_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_9_143_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><a href="#loc_143_12_143_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_12_143_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">, </span><a href="#loc_143_15_143_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_15_143_16&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">) </span><a href="#loc_143_31_143_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_31_143_33&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | From a &#39;TestSuiteLog&#39;, determine if the test suite passed.</span></span><span class="mpre">
</span><a href="#loc_147_1_147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_12&#39;)"><span class="mpre">suitePassed</span></a><span class="mpre"> :: </span><a href="#loc_115_6_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_18&#39;)"><span class="hl_tyconref"><span class="mpre">TestSuiteLog</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_147_1_147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_12&#39;)"><span class="hl_fundecl"><span class="mpre">suitePassed</span></span></a><span class="mpre"> </span><a name="loc_147_13_147_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_13_147_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> =
    case </span><a href="#loc_136_1_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_17&#39;)"><span class="hl_varref"><span class="mpre">countTestResults</span></span></a><span class="mpre"> (</span><a href="#loc_117_7_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_7_117_15&#39;)"><span class="hl_varref"><span class="mpre">testLogs</span></span></a><span class="mpre"> </span><a href="#loc_147_13_147_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_13_147_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) of
        (_, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        _ -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | From a &#39;TestSuiteLog&#39;, determine if the test suite failed.</span></span><span class="mpre">
</span><a href="#loc_154_1_154_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_12&#39;)"><span class="mpre">suiteFailed</span></a><span class="mpre"> :: </span><a href="#loc_115_6_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_18&#39;)"><span class="hl_tyconref"><span class="mpre">TestSuiteLog</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_154_1_154_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_12&#39;)"><span class="hl_fundecl"><span class="mpre">suiteFailed</span></span></a><span class="mpre"> </span><a name="loc_154_13_154_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_13_154_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> =
    case </span><a href="#loc_136_1_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_17&#39;)"><span class="hl_varref"><span class="mpre">countTestResults</span></span></a><span class="mpre"> (</span><a href="#loc_117_7_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_7_117_15&#39;)"><span class="hl_varref"><span class="mpre">testLogs</span></span></a><span class="mpre"> </span><a href="#loc_154_13_154_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_13_154_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) of
        (_, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, _) -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
        _ -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | From a &#39;TestSuiteLog&#39;, determine if the test suite encountered errors.</span></span><span class="mpre">
</span><a href="#loc_161_1_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_11&#39;)"><span class="mpre">suiteError</span></a><span class="mpre"> :: </span><a href="#loc_115_6_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_18&#39;)"><span class="hl_tyconref"><span class="mpre">TestSuiteLog</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_161_1_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_11&#39;)"><span class="hl_fundecl"><span class="mpre">suiteError</span></span></a><span class="mpre"> </span><a name="loc_161_12_161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_12_161_13&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> =
    case </span><a href="#loc_136_1_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_17&#39;)"><span class="hl_varref"><span class="mpre">countTestResults</span></span></a><span class="mpre"> (</span><a href="#loc_117_7_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_7_117_15&#39;)"><span class="hl_varref"><span class="mpre">testLogs</span></span></a><span class="mpre"> </span><a href="#loc_161_12_161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_12_161_13&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) of
        (_, _, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
        _ -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Run a test executable, logging the output and generating the appropriate</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- summary messages.</span></span><span class="mpre">
</span><a href="#loc_184_1_184_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_1_184_15&#39;)"><span class="mpre">testController</span></a><span class="mpre"> :: </span><a href="Distribution.Simple.Setup.html#loc_1529_6_1529_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1529_6_1529_15&#39;)"><span class="hl_tyconref"><span class="mpre">TestFlags</span></span></a><span class="mpre">
               </span><span class="hl_comment"><span class="mpre">-- ^ flags Cabal was invoked with</span></span><span class="mpre">
               -&gt; </span><a href="Distribution.PackageDescription.html#loc_161_6_161_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_161_6_161_24&#39;)"><span class="hl_tyconref"><span class="mpre">PD.PackageDescription</span></span></a><span class="mpre">
               </span><span class="hl_comment"><span class="mpre">-- ^ description of package the test suite belongs to</span></span><span class="mpre">
               -&gt; </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20&#39;)"><span class="hl_tyconref"><span class="mpre">LBI.LocalBuildInfo</span></span></a><span class="mpre">
               </span><span class="hl_comment"><span class="mpre">-- ^ information from the configure step</span></span><span class="mpre">
               -&gt; </span><a href="Distribution.PackageDescription.html#loc_395_6_395_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_395_6_395_15&#39;)"><span class="hl_tyconref"><span class="mpre">PD.TestSuite</span></span></a><span class="mpre">
               </span><span class="hl_comment"><span class="mpre">-- ^ TestSuite being tested</span></span><span class="mpre">
               -&gt; (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
               </span><span class="hl_comment"><span class="mpre">-- ^ prepare standard input for test executable</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ executable name</span></span><span class="mpre">
               -&gt; (</span><a href="GHC.IO.Exception.html#loc_205_6_205_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_205_6_205_14&#39;)"><span class="hl_tyconref"><span class="mpre">ExitCode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_115_6_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_18&#39;)"><span class="hl_tyconref"><span class="mpre">TestSuiteLog</span></span></a><span class="mpre">)
               </span><span class="hl_comment"><span class="mpre">-- ^ generator for the TestSuiteLog</span></span><span class="mpre">
               -&gt; (</span><a href="#loc_115_6_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_18&#39;)"><span class="hl_tyconref"><span class="mpre">TestSuiteLog</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)
               </span><span class="hl_comment"><span class="mpre">-- ^ generator for final human-readable log filename</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_115_6_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_18&#39;)"><span class="hl_tyconref"><span class="mpre">TestSuiteLog</span></span></a><span class="mpre">
</span><a name="loc_184_1_184_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_1_184_15&#39;)"><span class="hl_fundecl"><span class="mpre">testController</span></span></a><span class="mpre"> </span><a name="loc_184_16_184_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_16_184_21&#39;)"><span class="hl_vardecl"><span class="mpre">flags</span></span></a><span class="mpre"> </span><a name="loc_184_22_184_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_22_184_31&#39;)"><span class="hl_vardecl"><span class="mpre">pkg_descr</span></span></a><span class="mpre"> </span><a name="loc_184_32_184_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_32_184_35&#39;)"><span class="hl_vardecl"><span class="mpre">lbi</span></span></a><span class="mpre"> </span><a name="loc_184_36_184_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_36_184_41&#39;)"><span class="hl_vardecl"><span class="mpre">suite</span></span></a><span class="mpre"> </span><a name="loc_184_42_184_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_42_184_49&#39;)"><span class="hl_vardecl"><span class="mpre">preTest</span></span></a><span class="mpre"> </span><a name="loc_184_50_184_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_50_184_53&#39;)"><span class="hl_vardecl"><span class="mpre">cmd</span></span></a><span class="mpre"> </span><a name="loc_184_54_184_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_54_184_62&#39;)"><span class="hl_vardecl"><span class="mpre">postTest</span></span></a><span class="mpre"> </span><a name="loc_184_63_184_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_63_184_71&#39;)"><span class="hl_vardecl"><span class="mpre">logNamer</span></span></a><span class="mpre"> = do
    let </span><a name="loc_185_9_185_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_9_185_17&#39;)"><span class="hl_vardecl"><span class="mpre">distPref</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.Setup.html#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_185_1_185_9&#39;)"><span class="hl_varref"><span class="mpre">fromFlag</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1530_5_1530_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1530_5_1530_17&#39;)"><span class="hl_varref"><span class="mpre">testDistPref</span></span></a><span class="mpre"> </span><a href="#loc_184_16_184_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_16_184_21&#39;)"><span class="hl_varref"><span class="mpre">flags</span></span></a><span class="mpre">
        </span><a name="loc_186_9_186_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_18&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.Setup.html#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_185_1_185_9&#39;)"><span class="hl_varref"><span class="mpre">fromFlag</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1531_5_1531_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1531_5_1531_18&#39;)"><span class="hl_varref"><span class="mpre">testVerbosity</span></span></a><span class="mpre"> </span><a href="#loc_184_16_184_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_16_184_21&#39;)"><span class="hl_varref"><span class="mpre">flags</span></span></a><span class="mpre">
        </span><a name="loc_187_9_187_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_19&#39;)"><span class="hl_vardecl"><span class="mpre">testLogDir</span></span></a><span class="mpre"> = </span><a href="#loc_185_9_185_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_9_185_17&#39;)"><span class="hl_varref"><span class="mpre">distPref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;test&quot;</span></span><span class="mpre">
        </span><a name="loc_188_9_188_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_13&#39;)"><span class="hl_vardecl"><span class="mpre">opts</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_446_1_446_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_11&#39;)"><span class="hl_varref"><span class="mpre">testOption</span></span></a><span class="mpre"> </span><a href="#loc_184_22_184_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_22_184_31&#39;)"><span class="hl_varref"><span class="mpre">pkg_descr</span></span></a><span class="mpre"> </span><a href="#loc_184_32_184_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_32_184_35&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre"> </span><a href="#loc_184_36_184_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_36_184_41&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1540_5_1540_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1540_5_1540_16&#39;)"><span class="hl_varref"><span class="mpre">testOptions</span></span></a><span class="mpre"> </span><a href="#loc_184_16_184_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_16_184_21&#39;)"><span class="hl_varref"><span class="mpre">flags</span></span></a><span class="mpre">

    </span><a name="loc_190_5_190_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_8&#39;)"><span class="hl_vardecl"><span class="mpre">pwd</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_673_1_673_20" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_673_1_673_20&#39;)"><span class="hl_varref"><span class="mpre">getCurrentDirectory</span></span></a><span class="mpre">
    </span><a name="loc_191_5_191_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_5_191_16&#39;)"><span class="hl_vardecl"><span class="mpre">existingEnv</span></span></a><span class="mpre"> &lt;- </span><a href="Distribution.Compat.Environment.html#loc_18_1_18_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Environment.html#loc_18_1_18_15&#39;)"><span class="hl_varref"><span class="mpre">getEnvironment</span></span></a><span class="mpre">
    let </span><a name="loc_192_9_192_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_9_192_20&#39;)"><span class="hl_vardecl"><span class="mpre">dataDirPath</span></span></a><span class="mpre"> = </span><a href="#loc_190_5_190_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_8&#39;)"><span class="hl_varref"><span class="mpre">pwd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="Distribution.PackageDescription.html#loc_195_9_195_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_195_9_195_16&#39;)"><span class="hl_varref"><span class="mpre">PD.dataDir</span></span></a><span class="mpre"> </span><a href="#loc_184_22_184_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_22_184_31&#39;)"><span class="hl_varref"><span class="mpre">pkg_descr</span></span></a><span class="mpre">
        </span><a name="loc_193_9_193_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_9_193_17&#39;)"><span class="hl_vardecl"><span class="mpre">shellEnv</span></span></a><span class="mpre"> = (</span><a href="Distribution.Simple.Build.PathsModule.html#loc_192_1_192_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Build.PathsModule.html#loc_192_1_192_14&#39;)"><span class="hl_varref"><span class="mpre">pkgPathEnvVar</span></span></a><span class="mpre"> </span><a href="#loc_184_22_184_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_22_184_31&#39;)"><span class="hl_varref"><span class="mpre">pkg_descr</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;datadir&quot;</span></span><span class="mpre">, </span><a href="#loc_192_9_192_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_9_192_20&#39;)"><span class="hl_varref"><span class="mpre">dataDirPath</span></span></a><span class="mpre">)
                   </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;HPCTIXFILE&quot;</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">(&lt;/&gt;)</span></span><span class="mpre"> </span><a href="#loc_190_5_190_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_8&#39;)"><span class="hl_varref"><span class="mpre">pwd</span></span></a><span class="mpre">
                       </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.Hpc.html#loc_128_1_128_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Hpc.html#loc_128_1_128_12&#39;)"><span class="hl_varref"><span class="mpre">tixFilePath</span></span></a><span class="mpre"> </span><a href="#loc_185_9_185_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_9_185_17&#39;)"><span class="hl_varref"><span class="mpre">distPref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.PackageDescription.html#loc_396_9_396_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_396_9_396_17&#39;)"><span class="hl_varref"><span class="mpre">PD.testName</span></span></a><span class="mpre"> </span><a href="#loc_184_36_184_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_36_184_41&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre">)
                   </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_191_5_191_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_5_191_16&#39;)"><span class="hl_varref"><span class="mpre">existingEnv</span></span></a><span class="mpre">

    </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">bracket</span></span></a><span class="mpre"> (</span><a href="#loc_268_9_268_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_9_268_22&#39;)"><span class="hl_varref"><span class="mpre">openCabalTemp</span></span></a><span class="mpre"> </span><a href="#loc_187_9_187_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_19&#39;)"><span class="hl_varref"><span class="mpre">testLogDir</span></span></a><span class="mpre">) </span><a href="#loc_264_9_264_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_9_264_23&#39;)"><span class="hl_varref"><span class="mpre">deleteIfExists</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_198_58_198_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_58_198_65&#39;)"><span class="hl_vardecl"><span class="mpre">tempLog</span></span></a><span class="mpre"> -&gt;
        </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">bracket</span></span></a><span class="mpre"> (</span><a href="#loc_268_9_268_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_9_268_22&#39;)"><span class="hl_varref"><span class="mpre">openCabalTemp</span></span></a><span class="mpre"> </span><a href="#loc_187_9_187_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_19&#39;)"><span class="hl_varref"><span class="mpre">testLogDir</span></span></a><span class="mpre">) </span><a href="#loc_264_9_264_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_9_264_23&#39;)"><span class="hl_varref"><span class="mpre">deleteIfExists</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_199_62_199_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_62_199_71&#39;)"><span class="hl_vardecl"><span class="mpre">tempInput</span></span></a><span class="mpre"> -&gt; do

            </span><span class="hl_comment"><span class="mpre">-- Check that the test executable exists.</span></span><span class="mpre">
            </span><a name="loc_202_13_202_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_13_202_19&#39;)"><span class="hl_vardecl"><span class="mpre">exists</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_726_1_726_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_726_1_726_14&#39;)"><span class="hl_varref"><span class="mpre">doesFileExist</span></span></a><span class="mpre"> </span><a href="#loc_184_50_184_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_50_184_53&#39;)"><span class="hl_varref"><span class="mpre">cmd</span></span></a><span class="mpre">
            </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> </span><a href="#loc_202_13_202_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_13_202_19&#39;)"><span class="hl_varref"><span class="mpre">exists</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.Utils.html#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_251_1_251_4&#39;)"><span class="hl_varref"><span class="mpre">die</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Error: Could not find test program \&quot;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_184_50_184_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_50_184_53&#39;)"><span class="hl_varref"><span class="mpre">cmd</span></span></a><span class="mpre">
                                  </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\&quot;. Did you build the package first?&quot;</span></span><span class="mpre">

            </span><span class="hl_comment"><span class="mpre">-- Remove old .tix files if appropriate.</span></span><span class="mpre">
            </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><a href="Distribution.Simple.Setup.html#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_185_1_185_9&#39;)"><span class="hl_varref"><span class="mpre">fromFlag</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1535_5_1535_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1535_5_1535_16&#39;)"><span class="hl_varref"><span class="mpre">testKeepTix</span></span></a><span class="mpre"> </span><a href="#loc_184_16_184_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_16_184_21&#39;)"><span class="hl_varref"><span class="mpre">flags</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
                let </span><a name="loc_208_21_208_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_21_208_25&#39;)"><span class="hl_vardecl"><span class="mpre">tDir</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.Hpc.html#loc_122_1_122_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Hpc.html#loc_122_1_122_7&#39;)"><span class="hl_varref"><span class="mpre">tixDir</span></span></a><span class="mpre"> </span><a href="#loc_185_9_185_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_9_185_17&#39;)"><span class="hl_varref"><span class="mpre">distPref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.PackageDescription.html#loc_396_9_396_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_396_9_396_17&#39;)"><span class="hl_varref"><span class="mpre">PD.testName</span></span></a><span class="mpre"> </span><a href="#loc_184_36_184_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_36_184_41&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre">
                </span><a name="loc_209_17_209_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_17_209_24&#39;)"><span class="hl_vardecl"><span class="mpre">exists&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_717_1_717_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_717_1_717_19&#39;)"><span class="hl_varref"><span class="mpre">doesDirectoryExist</span></span></a><span class="mpre"> </span><a href="#loc_208_21_208_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_21_208_25&#39;)"><span class="hl_varref"><span class="mpre">tDir</span></span></a><span class="mpre">
                </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> </span><a href="#loc_209_17_209_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_17_209_24&#39;)"><span class="hl_varref"><span class="mpre">exists&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.Directory.html#loc_351_1_351_25" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_351_1_351_25&#39;)"><span class="hl_varref"><span class="mpre">removeDirectoryRecursive</span></span></a><span class="mpre"> </span><a href="#loc_208_21_208_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_21_208_25&#39;)"><span class="hl_varref"><span class="mpre">tDir</span></span></a><span class="mpre">

            </span><span class="hl_comment"><span class="mpre">-- Create directory for HPC files.</span></span><span class="mpre">
            </span><a href="System.Directory.html#loc_267_1_267_25" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_267_1_267_25&#39;)"><span class="hl_varref"><span class="mpre">createDirectoryIfMissing</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.Hpc.html#loc_122_1_122_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Hpc.html#loc_122_1_122_7&#39;)"><span class="hl_varref"><span class="mpre">tixDir</span></span></a><span class="mpre"> </span><a href="#loc_185_9_185_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_9_185_17&#39;)"><span class="hl_varref"><span class="mpre">distPref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.PackageDescription.html#loc_396_9_396_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_396_9_396_17&#39;)"><span class="hl_varref"><span class="mpre">PD.testName</span></span></a><span class="mpre"> </span><a href="#loc_184_36_184_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_36_184_41&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre">

            </span><span class="hl_comment"><span class="mpre">-- Write summary notices indicating start of test suite</span></span><span class="mpre">
            </span><a href="Distribution.Simple.Utils.html#loc_292_1_292_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_292_1_292_7&#39;)"><span class="hl_varref"><span class="mpre">notice</span></span></a><span class="mpre"> </span><a href="#loc_186_9_186_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_18&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_416_1_416_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_1_416_20&#39;)"><span class="hl_varref"><span class="mpre">summarizeSuiteStart</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.PackageDescription.html#loc_396_9_396_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_396_9_396_17&#39;)"><span class="hl_varref"><span class="mpre">PD.testName</span></span></a><span class="mpre"> </span><a href="#loc_184_36_184_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_36_184_41&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre">

            </span><span class="hl_comment"><span class="mpre">-- Prepare standard input for test executable</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">appendFile</span></span><span class="mpre"> </span><a href="#loc_199_62_199_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_62_199_71&#39;)"><span class="hl_varref"><span class="mpre">tempInput</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_184_42_184_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_42_184_49&#39;)"><span class="hl_varref"><span class="mpre">preTest</span></span></a><span class="mpre"> </span><a href="#loc_199_62_199_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_62_199_71&#39;)"><span class="hl_varref"><span class="mpre">tempInput</span></span></a><span class="mpre">

            </span><span class="hl_comment"><span class="mpre">-- Run test executable</span></span><span class="mpre">
            </span><a name="loc_222_13_222_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_13_222_17&#39;)"><span class="hl_vardecl"><span class="mpre">exit</span></span></a><span class="mpre"> &lt;- do
              </span><a name="loc_223_15_223_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_15_223_19&#39;)"><span class="hl_vardecl"><span class="mpre">hLog</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Handle.FD.html#loc_150_1_150_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_150_1_150_9&#39;)"><span class="hl_varref"><span class="mpre">openFile</span></span></a><span class="mpre"> </span><a href="#loc_198_58_198_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_58_198_65&#39;)"><span class="hl_varref"><span class="mpre">tempLog</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">AppendMode</span></span><span class="mpre">
              </span><a name="loc_224_15_224_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_15_224_18&#39;)"><span class="hl_vardecl"><span class="mpre">hIn</span></span></a><span class="mpre">  &lt;- </span><a href="GHC.IO.Handle.FD.html#loc_150_1_150_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_150_1_150_9&#39;)"><span class="hl_varref"><span class="mpre">openFile</span></span></a><span class="mpre"> </span><a href="#loc_199_62_199_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_62_199_71&#39;)"><span class="hl_varref"><span class="mpre">tempInput</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ReadMode</span></span><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">-- these handles get closed by rawSystemIOWithEnv</span></span><span class="mpre">
              </span><a href="Distribution.Simple.Utils.html#loc_470_1_470_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_470_1_470_19&#39;)"><span class="hl_varref"><span class="mpre">rawSystemIOWithEnv</span></span></a><span class="mpre"> </span><a href="#loc_186_9_186_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_18&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_184_50_184_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_50_184_53&#39;)"><span class="hl_varref"><span class="mpre">cmd</span></span></a><span class="mpre"> </span><a href="#loc_188_9_188_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_13&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_193_9_193_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_9_193_17&#39;)"><span class="hl_varref"><span class="mpre">shellEnv</span></span></a><span class="mpre">)
                                 (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_224_15_224_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_15_224_18&#39;)"><span class="hl_varref"><span class="mpre">hIn</span></span></a><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_223_15_223_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_15_223_19&#39;)"><span class="hl_varref"><span class="mpre">hLog</span></span></a><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_223_15_223_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_15_223_19&#39;)"><span class="hl_varref"><span class="mpre">hLog</span></span></a><span class="mpre">)

            </span><span class="hl_comment"><span class="mpre">-- Generate TestSuiteLog from executable exit code and a machine-</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- readable test log</span></span><span class="mpre">
            </span><a name="loc_231_13_231_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_13_231_21&#39;)"><span class="hl_vardecl"><span class="mpre">suiteLog</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><a href="#loc_184_54_184_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_54_184_62&#39;)"><span class="hl_varref"><span class="mpre">postTest</span></span></a><span class="mpre"> </span><a href="#loc_222_13_222_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_13_222_17&#39;)"><span class="hl_varref"><span class="mpre">exit</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">readFile</span></span><span class="mpre"> </span><a href="#loc_199_62_199_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_62_199_71&#39;)"><span class="hl_varref"><span class="mpre">tempInput</span></span></a><span class="mpre">

            </span><span class="hl_comment"><span class="mpre">-- Generate final log file name</span></span><span class="mpre">
            let </span><span class="hl_vardecl"><span class="mpre">finalLogName</span></span><span class="mpre"> = </span><a href="#loc_187_9_187_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_19&#39;)"><span class="hl_varref"><span class="mpre">testLogDir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_184_63_184_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_63_184_71&#39;)"><span class="hl_varref"><span class="mpre">logNamer</span></span></a><span class="mpre"> </span><a href="#loc_231_13_231_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_13_231_21&#39;)"><span class="hl_varref"><span class="mpre">suiteLog</span></span></a><span class="mpre">
                </span><a name="loc_235_17_235_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_17_235_26&#39;)"><span class="hl_vardecl"><span class="mpre">suiteLog&#39;</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 235, srcSpanStartColumn = 29, srcSpanEndLine = 235, srcSpanEndColumn = 64}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 235, srcSpanStartColumn = 38, srcSpanEndLine = 235, srcSpanEndColumn = 39},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple"><span class="mpre">suiteLog { logFile = finalLogName }</span></span><span class="mpre">

            </span><span class="hl_comment"><span class="mpre">-- Write summary notice to log file indicating start of test suite</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">appendFile</span></span><span class="mpre"> (</span><a href="#loc_118_7_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_7_118_14&#39;)"><span class="hl_varref"><span class="mpre">logFile</span></span></a><span class="mpre"> </span><a href="#loc_235_17_235_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_17_235_26&#39;)"><span class="hl_varref"><span class="mpre">suiteLog&#39;</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_416_1_416_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_1_416_20&#39;)"><span class="hl_varref"><span class="mpre">summarizeSuiteStart</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.PackageDescription.html#loc_396_9_396_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_396_9_396_17&#39;)"><span class="hl_varref"><span class="mpre">PD.testName</span></span></a><span class="mpre"> </span><a href="#loc_184_36_184_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_36_184_41&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre">

            </span><span class="hl_comment"><span class="mpre">-- Append contents of temporary log file to the final human-</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- readable log file</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">readFile</span></span><span class="mpre"> </span><a href="#loc_198_58_198_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_58_198_65&#39;)"><span class="hl_varref"><span class="mpre">tempLog</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">appendFile</span></span><span class="mpre"> (</span><a href="#loc_118_7_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_7_118_14&#39;)"><span class="hl_varref"><span class="mpre">logFile</span></span></a><span class="mpre"> </span><a href="#loc_235_17_235_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_17_235_26&#39;)"><span class="hl_varref"><span class="mpre">suiteLog&#39;</span></span></a><span class="mpre">)

            </span><span class="hl_comment"><span class="mpre">-- Write end-of-suite summary notice to log file</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">appendFile</span></span><span class="mpre"> (</span><a href="#loc_118_7_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_7_118_14&#39;)"><span class="hl_varref"><span class="mpre">logFile</span></span></a><span class="mpre"> </span><a href="#loc_235_17_235_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_17_235_26&#39;)"><span class="hl_varref"><span class="mpre">suiteLog&#39;</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_409_1_409_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_1_409_21&#39;)"><span class="hl_varref"><span class="mpre">summarizeSuiteFinish</span></span></a><span class="mpre"> </span><a href="#loc_235_17_235_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_17_235_26&#39;)"><span class="hl_varref"><span class="mpre">suiteLog&#39;</span></span></a><span class="mpre">

            </span><span class="hl_comment"><span class="mpre">-- Show the contents of the human-readable log file on the terminal</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- if there is a failure and/or detailed output is requested</span></span><span class="mpre">
            let </span><a name="loc_249_17_249_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_17_249_24&#39;)"><span class="hl_vardecl"><span class="mpre">details</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.Setup.html#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_185_1_185_9&#39;)"><span class="hl_varref"><span class="mpre">fromFlag</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1534_5_1534_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1534_5_1534_20&#39;)"><span class="hl_varref"><span class="mpre">testShowDetails</span></span></a><span class="mpre"> </span><a href="#loc_184_16_184_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_16_184_21&#39;)"><span class="hl_varref"><span class="mpre">flags</span></span></a><span class="mpre">
                </span><a name="loc_250_17_250_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_17_250_29&#39;)"><span class="hl_vardecl"><span class="mpre">whenPrinting</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_249_17_249_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_17_249_24&#39;)"><span class="hl_varref"><span class="mpre">details</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1507_24_1507_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1507_24_1507_29&#39;)"><span class="hl_conref"><span class="mpre">Never</span></span></a><span class="mpre">)
                    </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_147_1_147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_12&#39;)"><span class="hl_varref"><span class="mpre">suitePassed</span></span></a><span class="mpre"> </span><a href="#loc_231_13_231_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_13_231_21&#39;)"><span class="hl_varref"><span class="mpre">suiteLog</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_249_17_249_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_17_249_24&#39;)"><span class="hl_varref"><span class="mpre">details</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1507_43_1507_49" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1507_43_1507_49&#39;)"><span class="hl_conref"><span class="mpre">Always</span></span></a><span class="mpre">)
                    </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_186_9_186_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_18&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="Distribution.Verbosity.html#loc_67_1_67_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_67_1_67_7&#39;)"><span class="hl_varref"><span class="mpre">normal</span></span></a><span class="mpre">
            </span><a href="#loc_250_17_250_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_17_250_29&#39;)"><span class="hl_varref"><span class="mpre">whenPrinting</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">readFile</span></span><span class="mpre"> </span><a href="#loc_198_58_198_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_58_198_65&#39;)"><span class="hl_varref"><span class="mpre">tempLog</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">putStr</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unlines</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">lines</span></span><span class="mpre">

            </span><span class="hl_comment"><span class="mpre">-- Write summary notice to terminal indicating end of test suite</span></span><span class="mpre">
            </span><a href="Distribution.Simple.Utils.html#loc_292_1_292_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_292_1_292_7&#39;)"><span class="hl_varref"><span class="mpre">notice</span></span></a><span class="mpre"> </span><a href="#loc_186_9_186_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_18&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_409_1_409_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_1_409_21&#39;)"><span class="hl_varref"><span class="mpre">summarizeSuiteFinish</span></span></a><span class="mpre"> </span><a href="#loc_235_17_235_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_17_235_26&#39;)"><span class="hl_varref"><span class="mpre">suiteLog&#39;</span></span></a><span class="mpre">

            </span><a href="Distribution.Simple.Hpc.html#loc_142_1_142_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Hpc.html#loc_142_1_142_11&#39;)"><span class="hl_varref"><span class="mpre">markupTest</span></span></a><span class="mpre"> </span><a href="#loc_186_9_186_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_18&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_184_32_184_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_32_184_35&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre"> </span><a href="#loc_185_9_185_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_9_185_17&#39;)"><span class="hl_varref"><span class="mpre">distPref</span></span></a><span class="mpre">
                (</span><a href="Distribution.Text.html#loc_31_1_31_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_31_1_31_8&#39;)"><span class="hl_varref"><span class="mpre">display</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.PackageDescription.html#loc_164_9_164_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_164_9_164_16&#39;)"><span class="hl_varref"><span class="mpre">PD.package</span></span></a><span class="mpre"> </span><a href="#loc_184_22_184_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_22_184_31&#39;)"><span class="hl_varref"><span class="mpre">pkg_descr</span></span></a><span class="mpre">) </span><a href="#loc_184_36_184_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_36_184_41&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre">

            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_235_17_235_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_17_235_26&#39;)"><span class="hl_varref"><span class="mpre">suiteLog&#39;</span></span></a><span class="mpre">
    where
        </span><a name="loc_264_9_264_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_9_264_23&#39;)"><span class="hl_fundecl"><span class="mpre">deleteIfExists</span></span></a><span class="mpre"> </span><a name="loc_264_24_264_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_24_264_28&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre"> = do
            </span><a name="loc_265_13_265_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_13_265_19&#39;)"><span class="hl_vardecl"><span class="mpre">exists</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_726_1_726_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_726_1_726_14&#39;)"><span class="hl_varref"><span class="mpre">doesFileExist</span></span></a><span class="mpre"> </span><a href="#loc_264_24_264_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_24_264_28&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">
            </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> </span><a href="#loc_265_13_265_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_13_265_19&#39;)"><span class="hl_varref"><span class="mpre">exists</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.Directory.html#loc_400_1_400_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_400_1_400_11&#39;)"><span class="hl_varref"><span class="mpre">removeFile</span></span></a><span class="mpre"> </span><a href="#loc_264_24_264_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_24_264_28&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">

        </span><a name="loc_268_9_268_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_9_268_22&#39;)"><span class="hl_fundecl"><span class="mpre">openCabalTemp</span></span></a><span class="mpre"> </span><a name="loc_268_23_268_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_23_268_33&#39;)"><span class="hl_vardecl"><span class="mpre">testLogDir</span></span></a><span class="mpre"> = do
            (</span><a name="loc_269_14_269_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_14_269_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">, </span><a name="loc_269_17_269_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_17_269_18&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">openTempFile</span></span><span class="mpre"> </span><a href="#loc_268_23_268_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_23_268_33&#39;)"><span class="hl_varref"><span class="mpre">testLogDir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;cabal-test-&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;.&gt;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;log&quot;</span></span><span class="mpre">
            </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre"> </span><a href="#loc_269_17_269_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_17_269_18&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_269_14_269_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_14_269_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- |Perform the \&quot;@.\/setup test@\&quot; action.</span></span><span class="mpre">
</span><a href="#loc_278_1_278_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_5&#39;)"><span class="mpre">test</span></a><span class="mpre"> :: </span><a href="Distribution.PackageDescription.html#loc_161_6_161_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_161_6_161_24&#39;)"><span class="hl_tyconref"><span class="mpre">PD.PackageDescription</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^information from the .cabal file</span></span><span class="mpre">
     -&gt; </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20&#39;)"><span class="hl_tyconref"><span class="mpre">LBI.LocalBuildInfo</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^information from the configure step</span></span><span class="mpre">
     -&gt; </span><a href="Distribution.Simple.Setup.html#loc_1529_6_1529_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1529_6_1529_15&#39;)"><span class="hl_tyconref"><span class="mpre">TestFlags</span></span></a><span class="mpre">               </span><span class="hl_comment"><span class="mpre">-- ^flags sent to test</span></span><span class="mpre">
     -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_278_1_278_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_5&#39;)"><span class="hl_fundecl"><span class="mpre">test</span></span></a><span class="mpre"> </span><a name="loc_278_6_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_15&#39;)"><span class="hl_vardecl"><span class="mpre">pkg_descr</span></span></a><span class="mpre"> </span><a name="loc_278_16_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_16_278_19&#39;)"><span class="hl_vardecl"><span class="mpre">lbi</span></span></a><span class="mpre"> </span><a name="loc_278_20_278_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_20_278_25&#39;)"><span class="hl_vardecl"><span class="mpre">flags</span></span></a><span class="mpre"> = do
    let </span><a name="loc_279_9_279_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_9_279_18&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.Setup.html#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_185_1_185_9&#39;)"><span class="hl_varref"><span class="mpre">fromFlag</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1531_5_1531_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1531_5_1531_18&#39;)"><span class="hl_varref"><span class="mpre">testVerbosity</span></span></a><span class="mpre"> </span><a href="#loc_278_20_278_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_20_278_25&#39;)"><span class="hl_varref"><span class="mpre">flags</span></span></a><span class="mpre">
        </span><a name="loc_280_9_280_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_9_280_22&#39;)"><span class="hl_vardecl"><span class="mpre">humanTemplate</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.Setup.html#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_185_1_185_9&#39;)"><span class="hl_varref"><span class="mpre">fromFlag</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1532_5_1532_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1532_5_1532_17&#39;)"><span class="hl_varref"><span class="mpre">testHumanLog</span></span></a><span class="mpre"> </span><a href="#loc_278_20_278_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_20_278_25&#39;)"><span class="hl_varref"><span class="mpre">flags</span></span></a><span class="mpre">
        </span><a name="loc_281_9_281_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_9_281_24&#39;)"><span class="hl_vardecl"><span class="mpre">machineTemplate</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.Setup.html#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_185_1_185_9&#39;)"><span class="hl_varref"><span class="mpre">fromFlag</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1533_5_1533_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1533_5_1533_19&#39;)"><span class="hl_varref"><span class="mpre">testMachineLog</span></span></a><span class="mpre"> </span><a href="#loc_278_20_278_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_20_278_25&#39;)"><span class="hl_varref"><span class="mpre">flags</span></span></a><span class="mpre">
        </span><a name="loc_282_9_282_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_9_282_17&#39;)"><span class="hl_vardecl"><span class="mpre">distPref</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.Setup.html#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_185_1_185_9&#39;)"><span class="hl_varref"><span class="mpre">fromFlag</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1530_5_1530_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1530_5_1530_17&#39;)"><span class="hl_varref"><span class="mpre">testDistPref</span></span></a><span class="mpre"> </span><a href="#loc_278_20_278_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_20_278_25&#39;)"><span class="hl_varref"><span class="mpre">flags</span></span></a><span class="mpre">
        </span><a name="loc_283_9_283_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_9_283_19&#39;)"><span class="hl_vardecl"><span class="mpre">testLogDir</span></span></a><span class="mpre"> = </span><a href="#loc_282_9_282_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_9_282_17&#39;)"><span class="hl_varref"><span class="mpre">distPref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;test&quot;</span></span><span class="mpre">
        </span><a name="loc_284_9_284_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_9_284_18&#39;)"><span class="hl_vardecl"><span class="mpre">testNames</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.Setup.html#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_185_1_185_9&#39;)"><span class="hl_varref"><span class="mpre">fromFlag</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1538_5_1538_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1538_5_1538_13&#39;)"><span class="hl_varref"><span class="mpre">testList</span></span></a><span class="mpre"> </span><a href="#loc_278_20_278_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_20_278_25&#39;)"><span class="hl_varref"><span class="mpre">flags</span></span></a><span class="mpre">
        </span><a name="loc_285_9_285_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_9_285_17&#39;)"><span class="hl_vardecl"><span class="mpre">pkgTests</span></span></a><span class="mpre"> = </span><a href="Distribution.PackageDescription.html#loc_192_9_192_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_192_9_192_19&#39;)"><span class="hl_varref"><span class="mpre">PD.testSuites</span></span></a><span class="mpre"> </span><a href="#loc_278_6_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_15&#39;)"><span class="hl_varref"><span class="mpre">pkg_descr</span></span></a><span class="mpre">
        </span><a name="loc_286_9_286_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_21&#39;)"><span class="hl_vardecl"><span class="mpre">enabledTests</span></span></a><span class="mpre"> = [ </span><a href="#loc_286_30_286_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_30_286_31&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> | </span><a name="loc_286_30_286_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_30_286_31&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_285_9_285_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_9_285_17&#39;)"><span class="hl_varref"><span class="mpre">pkgTests</span></span></a><span class="mpre">
                           , </span><a href="Distribution.PackageDescription.html#loc_399_9_399_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_399_9_399_20&#39;)"><span class="hl_varref"><span class="mpre">PD.testEnabled</span></span></a><span class="mpre"> </span><a href="#loc_286_30_286_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_30_286_31&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
                           , </span><a href="Distribution.PackageDescription.html#loc_637_9_637_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_637_9_637_18&#39;)"><span class="hl_varref"><span class="mpre">PD.buildable</span></span></a><span class="mpre"> (</span><a href="Distribution.PackageDescription.html#loc_398_9_398_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_398_9_398_22&#39;)"><span class="hl_varref"><span class="mpre">PD.testBuildInfo</span></span></a><span class="mpre"> </span><a href="#loc_286_30_286_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_30_286_31&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) ]

        </span><a href="#loc_291_9_291_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_15&#39;)"><span class="mpre">doTest</span></a><span class="mpre"> :: (</span><a href="Distribution.PackageDescription.html#loc_395_6_395_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_395_6_395_15&#39;)"><span class="hl_tyconref"><span class="mpre">PD.TestSuite</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_115_6_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_18&#39;)"><span class="hl_tyconref"><span class="mpre">TestSuiteLog</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_115_6_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_18&#39;)"><span class="hl_tyconref"><span class="mpre">TestSuiteLog</span></span></a><span class="mpre">
        </span><a name="loc_291_9_291_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_15&#39;)"><span class="hl_fundecl"><span class="mpre">doTest</span></span></a><span class="mpre"> (</span><a name="loc_291_17_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_17_291_22&#39;)"><span class="hl_vardecl"><span class="mpre">suite</span></span></a><span class="mpre">, _) = do
            let </span><a name="loc_292_17_292_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_17_292_28&#39;)"><span class="hl_vardecl"><span class="mpre">testLogPath</span></span></a><span class="mpre"> = </span><a href="#loc_428_1_428_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_17&#39;)"><span class="hl_varref"><span class="mpre">testSuiteLogPath</span></span></a><span class="mpre"> </span><a href="#loc_280_9_280_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_9_280_22&#39;)"><span class="hl_varref"><span class="mpre">humanTemplate</span></span></a><span class="mpre"> </span><a href="#loc_278_6_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_15&#39;)"><span class="hl_varref"><span class="mpre">pkg_descr</span></span></a><span class="mpre"> </span><a href="#loc_278_16_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_16_278_19&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre">
                </span><a name="loc_293_17_293_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_17_293_19&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_293_20_293_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_20_293_23&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre"> </span><a name="loc_293_24_293_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_24_293_27&#39;)"><span class="hl_vardecl"><span class="mpre">cmd</span></span></a><span class="mpre"> </span><a name="loc_293_28_293_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_28_293_32&#39;)"><span class="hl_vardecl"><span class="mpre">post</span></span></a><span class="mpre"> = </span><a href="#loc_184_1_184_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_1_184_15&#39;)"><span class="hl_varref"><span class="mpre">testController</span></span></a><span class="mpre"> </span><a href="#loc_278_20_278_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_20_278_25&#39;)"><span class="hl_varref"><span class="mpre">flags</span></span></a><span class="mpre"> </span><a href="#loc_278_6_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_15&#39;)"><span class="hl_varref"><span class="mpre">pkg_descr</span></span></a><span class="mpre"> </span><a href="#loc_278_16_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_16_278_19&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre"> </span><a href="#loc_291_17_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_17_291_22&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre">
                                                 </span><a href="#loc_293_20_293_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_20_293_23&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><a href="#loc_293_24_293_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_24_293_27&#39;)"><span class="hl_varref"><span class="mpre">cmd</span></span></a><span class="mpre"> </span><a href="#loc_293_28_293_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_28_293_32&#39;)"><span class="hl_varref"><span class="mpre">post</span></span></a><span class="mpre"> </span><a href="#loc_292_17_292_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_17_292_28&#39;)"><span class="hl_varref"><span class="mpre">testLogPath</span></span></a><span class="mpre">
            case </span><a href="Distribution.PackageDescription.html#loc_397_9_397_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_397_9_397_22&#39;)"><span class="hl_varref"><span class="mpre">PD.testInterface</span></span></a><span class="mpre"> </span><a href="#loc_291_17_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_17_291_22&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre"> of
              </span><a href="Distribution.PackageDescription.html#loc_421_6_421_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_421_6_421_21&#39;)"><span class="hl_conref"><span class="mpre">PD.TestSuiteExeV10</span></span></a><span class="mpre"> _ _ -&gt; do
                    let </span><a name="loc_297_25_297_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_25_297_28&#39;)"><span class="hl_vardecl"><span class="mpre">cmd</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_131_9_131_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_131_9_131_17&#39;)"><span class="hl_varref"><span class="mpre">LBI.buildDir</span></span></a><span class="mpre"> </span><a href="#loc_278_16_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_16_278_19&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="Distribution.PackageDescription.html#loc_396_9_396_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_396_9_396_17&#39;)"><span class="hl_varref"><span class="mpre">PD.testName</span></span></a><span class="mpre"> </span><a href="#loc_291_17_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_17_291_22&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre">
                            </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="Distribution.PackageDescription.html#loc_396_9_396_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_396_9_396_17&#39;)"><span class="hl_varref"><span class="mpre">PD.testName</span></span></a><span class="mpre"> </span><a href="#loc_291_17_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_17_291_22&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;.&gt;</span></span><span class="mpre"> </span><a href="Distribution.Simple.BuildPaths.html#loc_135_1_135_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.BuildPaths.html#loc_135_1_135_13&#39;)"><span class="hl_varref"><span class="mpre">exeExtension</span></span></a><span class="mpre">
                        </span><a name="loc_299_25_299_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_25_299_32&#39;)"><span class="hl_fundecl"><span class="mpre">preTest</span></span></a><span class="mpre"> _ = </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
                        </span><a name="loc_300_25_300_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_25_300_33&#39;)"><span class="hl_fundecl"><span class="mpre">postTest</span></span></a><span class="mpre"> </span><a name="loc_300_34_300_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_34_300_38&#39;)"><span class="hl_vardecl"><span class="mpre">exit</span></span></a><span class="mpre"> _ =
                            let </span><span class="hl_vardecl"><span class="mpre">r</span></span><span class="mpre"> = case </span><a href="#loc_300_34_300_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_34_300_38&#39;)"><span class="hl_varref"><span class="mpre">exit</span></span></a><span class="mpre"> of
                                    </span><span class="hl_conref"><span class="mpre">ExitSuccess</span></span><span class="mpre"> -&gt; </span><a href="Distribution.TestSuite.html#loc_117_15_117_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_117_15_117_19&#39;)"><span class="hl_conref"><span class="mpre">Pass</span></span></a><span class="mpre">
                                    </span><span class="hl_conref"><span class="mpre">ExitFailure</span></span><span class="mpre"> </span><a name="loc_303_49_303_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_49_303_50&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="Distribution.TestSuite.html#loc_118_15_118_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_118_15_118_19&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">
                                        </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;exit code: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_303_49_303_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_49_303_50&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                            in </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 305, srcSpanStartColumn = 32, srcSpanEndLine = 313, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 306, srcSpanStartColumn = 33, srcSpanEndLine = 306, srcSpanEndColumn = 34},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple"><span class="mpre">TestSuiteLog
                                { testSuiteName = PD.testName suite
                                , testLogs = TestLog
                                    { testName = PD.testName suite
                                    , testOptionsReturned = []
                                    , testResult = r
                                    }
                                , logFile = &quot;&quot;
                                }</span></span><span class="mpre">
                    </span><a href="#loc_293_17_293_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_17_293_19&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_299_25_299_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_25_299_32&#39;)"><span class="hl_varref"><span class="mpre">preTest</span></span></a><span class="mpre"> </span><a href="#loc_297_25_297_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_25_297_28&#39;)"><span class="hl_varref"><span class="mpre">cmd</span></span></a><span class="mpre"> </span><a href="#loc_300_25_300_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_25_300_33&#39;)"><span class="hl_varref"><span class="mpre">postTest</span></span></a><span class="mpre">

              </span><a href="Distribution.PackageDescription.html#loc_426_6_426_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_426_6_426_21&#39;)"><span class="hl_conref"><span class="mpre">PD.TestSuiteLibV09</span></span></a><span class="mpre"> _ _ -&gt; do
                    let </span><a name="loc_317_25_317_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_25_317_28&#39;)"><span class="hl_vardecl"><span class="mpre">cmd</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_131_9_131_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_131_9_131_17&#39;)"><span class="hl_varref"><span class="mpre">LBI.buildDir</span></span></a><span class="mpre"> </span><a href="#loc_278_16_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_16_278_19&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_472_1_472_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_472_1_472_9&#39;)"><span class="hl_varref"><span class="mpre">stubName</span></span></a><span class="mpre"> </span><a href="#loc_291_17_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_17_291_22&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre">
                            </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_472_1_472_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_472_1_472_9&#39;)"><span class="hl_varref"><span class="mpre">stubName</span></span></a><span class="mpre"> </span><a href="#loc_291_17_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_17_291_22&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;.&gt;</span></span><span class="mpre"> </span><a href="Distribution.Simple.BuildPaths.html#loc_135_1_135_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.BuildPaths.html#loc_135_1_135_13&#39;)"><span class="hl_varref"><span class="mpre">exeExtension</span></span></a><span class="mpre">
                        </span><a name="loc_319_25_319_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_25_319_32&#39;)"><span class="hl_fundecl"><span class="mpre">preTest</span></span></a><span class="mpre"> </span><a name="loc_319_33_319_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_33_319_34&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> ( </span><a href="#loc_319_33_319_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_33_319_34&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
                                         , </span><a href="Distribution.PackageDescription.html#loc_396_9_396_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_396_9_396_17&#39;)"><span class="hl_varref"><span class="mpre">PD.testName</span></span></a><span class="mpre"> </span><a href="#loc_291_17_291_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_17_291_22&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre">
                                         )
                        </span><a name="loc_322_25_322_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_25_322_33&#39;)"><span class="hl_fundecl"><span class="mpre">postTest</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">read</span></span><span class="mpre">
                    </span><a href="#loc_293_17_293_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_17_293_19&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_319_25_319_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_25_319_32&#39;)"><span class="hl_varref"><span class="mpre">preTest</span></span></a><span class="mpre"> </span><a href="#loc_317_25_317_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_25_317_28&#39;)"><span class="hl_varref"><span class="mpre">cmd</span></span></a><span class="mpre"> </span><a href="#loc_322_25_322_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_25_322_33&#39;)"><span class="hl_varref"><span class="mpre">postTest</span></span></a><span class="mpre">

              _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 325, srcSpanStartColumn = 27, srcSpanEndLine = 335, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 326, srcSpanStartColumn = 29, srcSpanEndLine = 326, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple"><span class="mpre">TestSuiteLog
                            { testSuiteName = PD.testName suite
                            , testLogs = TestLog
                                { testName = PD.testName suite
                                , testOptionsReturned = []
                                , testResult = Error $
                                    &quot;No support for running test suite type: &quot;
                                    ++ show (disp $ PD.testType suite)
                                }
                            , logFile = &quot;&quot;
                            }</span></span><span class="mpre">

    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.PackageDescription.html#loc_465_1_465_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_465_1_465_9&#39;)"><span class="hl_varref"><span class="mpre">PD.hasTests</span></span></a><span class="mpre"> </span><a href="#loc_278_6_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_15&#39;)"><span class="hl_varref"><span class="mpre">pkg_descr</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a href="Distribution.Simple.Utils.html#loc_292_1_292_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_292_1_292_7&#39;)"><span class="hl_varref"><span class="mpre">notice</span></span></a><span class="mpre"> </span><a href="#loc_279_9_279_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_9_279_18&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Package has no test suites.&quot;</span></span><span class="mpre">
        </span><a href="System.Exit.html#loc_60_1_60_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Exit.html#loc_60_1_60_9&#39;)"><span class="hl_varref"><span class="mpre">exitWith</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ExitSuccess</span></span><span class="mpre">

    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="Distribution.PackageDescription.html#loc_465_1_465_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_465_1_465_9&#39;)"><span class="hl_varref"><span class="mpre">PD.hasTests</span></span></a><span class="mpre"> </span><a href="#loc_278_6_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_15&#39;)"><span class="hl_varref"><span class="mpre">pkg_descr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_286_9_286_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_21&#39;)"><span class="hl_varref"><span class="mpre">enabledTests</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><a href="Distribution.Simple.Utils.html#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_251_1_251_4&#39;)"><span class="hl_varref"><span class="mpre">die</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;No test suites enabled. Did you remember to configure with &quot;</span></span><span class="mpre">
              </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\&#39;--enable-tests\&#39;?&quot;</span></span><span class="mpre">

    </span><a name="loc_345_5_345_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_5_345_15&#39;)"><span class="hl_vardecl"><span class="mpre">testsToRun</span></span></a><span class="mpre"> &lt;- case </span><a href="#loc_284_9_284_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_9_284_18&#39;)"><span class="hl_varref"><span class="mpre">testNames</span></span></a><span class="mpre"> of
            [] -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">zip</span></span><span class="mpre"> </span><a href="#loc_286_9_286_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_21&#39;)"><span class="hl_varref"><span class="mpre">enabledTests</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
            </span><a name="loc_347_13_347_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_13_347_18&#39;)"><span class="hl_vardecl"><span class="mpre">names</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> </span><a href="#loc_347_13_347_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_13_347_18&#39;)"><span class="hl_varref"><span class="mpre">names</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_347_41_347_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_41_347_46&#39;)"><span class="hl_vardecl"><span class="mpre">tName</span></span></a><span class="mpre"> -&gt;
                let </span><a name="loc_348_21_348_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_21_348_28&#39;)"><span class="hl_vardecl"><span class="mpre">testMap</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">zip</span></span><span class="mpre"> </span><a href="#loc_349_21_349_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_21_349_33&#39;)"><span class="hl_varref"><span class="mpre">enabledNames</span></span></a><span class="mpre"> </span><a href="#loc_286_9_286_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_21&#39;)"><span class="hl_varref"><span class="mpre">enabledTests</span></span></a><span class="mpre">
                    </span><a name="loc_349_21_349_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_21_349_33&#39;)"><span class="hl_vardecl"><span class="mpre">enabledNames</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Distribution.PackageDescription.html#loc_396_9_396_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_396_9_396_17&#39;)"><span class="hl_varref"><span class="mpre">PD.testName</span></span></a><span class="mpre"> </span><a href="#loc_286_9_286_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_21&#39;)"><span class="hl_varref"><span class="mpre">enabledTests</span></span></a><span class="mpre">
                    </span><a name="loc_350_21_350_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_21_350_29&#39;)"><span class="hl_vardecl"><span class="mpre">allNames</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Distribution.PackageDescription.html#loc_396_9_396_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_396_9_396_17&#39;)"><span class="hl_varref"><span class="mpre">PD.testName</span></span></a><span class="mpre"> </span><a href="#loc_285_9_285_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_9_285_17&#39;)"><span class="hl_varref"><span class="mpre">pkgTests</span></span></a><span class="mpre">
                in case </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><a href="#loc_347_41_347_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_41_347_46&#39;)"><span class="hl_varref"><span class="mpre">tName</span></span></a><span class="mpre"> </span><a href="#loc_348_21_348_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_21_348_28&#39;)"><span class="hl_varref"><span class="mpre">testMap</span></span></a><span class="mpre"> of
                    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_352_26_352_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_26_352_27&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_352_26_352_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_26_352_27&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)
                    _ | </span><a href="#loc_347_41_347_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_41_347_46&#39;)"><span class="hl_varref"><span class="mpre">tName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_350_21_350_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_21_350_29&#39;)"><span class="hl_varref"><span class="mpre">allNames</span></span></a><span class="mpre"> -&gt;
                          </span><a href="Distribution.Simple.Utils.html#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_251_1_251_4&#39;)"><span class="hl_varref"><span class="mpre">die</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Package configured with test suite &quot;</span></span><span class="mpre">
                                </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_347_41_347_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_41_347_46&#39;)"><span class="hl_varref"><span class="mpre">tName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; disabled.&quot;</span></span><span class="mpre">
                      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="Distribution.Simple.Utils.html#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_251_1_251_4&#39;)"><span class="hl_varref"><span class="mpre">die</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;no such test: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_347_41_347_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_41_347_46&#39;)"><span class="hl_varref"><span class="mpre">tName</span></span></a><span class="mpre">

    </span><a href="System.Directory.html#loc_267_1_267_25" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_267_1_267_25&#39;)"><span class="hl_varref"><span class="mpre">createDirectoryIfMissing</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_283_9_283_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_9_283_19&#39;)"><span class="hl_varref"><span class="mpre">testLogDir</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- Delete ordinary files from test log directory.</span></span><span class="mpre">
    </span><a href="System.Directory.html#loc_628_1_628_21" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_628_1_628_21&#39;)"><span class="hl_varref"><span class="mpre">getDirectoryContents</span></span></a><span class="mpre"> </span><a href="#loc_283_9_283_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_9_283_19&#39;)"><span class="hl_varref"><span class="mpre">testLogDir</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_154_1_154_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_154_1_154_8&#39;)"><span class="hl_varref"><span class="mpre">filterM</span></span></a><span class="mpre"> </span><a href="System.Directory.html#loc_726_1_726_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_726_1_726_14&#39;)"><span class="hl_varref"><span class="mpre">doesFileExist</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_283_9_283_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_9_283_19&#39;)"><span class="hl_varref"><span class="mpre">testLogDir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre">)
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> </span><a href="System.Directory.html#loc_400_1_400_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_400_1_400_11&#39;)"><span class="hl_varref"><span class="mpre">removeFile</span></span></a><span class="mpre">

    let </span><a name="loc_365_9_365_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_9_365_20&#39;)"><span class="hl_vardecl"><span class="mpre">totalSuites</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_345_5_345_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_5_345_15&#39;)"><span class="hl_varref"><span class="mpre">testsToRun</span></span></a><span class="mpre">
    </span><a href="Distribution.Simple.Utils.html#loc_292_1_292_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_292_1_292_7&#39;)"><span class="hl_varref"><span class="mpre">notice</span></span></a><span class="mpre"> </span><a href="#loc_279_9_279_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_9_279_18&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Running &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_365_9_365_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_9_365_20&#39;)"><span class="hl_varref"><span class="mpre">totalSuites</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; test suites...&quot;</span></span><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">suites</span></span><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> </span><a href="#loc_291_9_291_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_15&#39;)"><span class="hl_varref"><span class="mpre">doTest</span></span></a><span class="mpre"> </span><a href="#loc_345_5_345_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_5_345_15&#39;)"><span class="hl_varref"><span class="mpre">testsToRun</span></span></a><span class="mpre">
    let </span><a name="loc_368_9_368_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_9_368_19&#39;)"><span class="hl_vardecl"><span class="mpre">packageLog</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 368, srcSpanStartColumn = 22, srcSpanEndLine = 368, srcSpanEndColumn = 77}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 368, srcSpanStartColumn = 54, srcSpanEndLine = 368, srcSpanEndColumn = 55},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple"><span class="mpre">(localPackageLog pkg_descr lbi) { testSuites = suites }</span></span><span class="mpre">
        </span><a name="loc_369_9_369_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_9_369_23&#39;)"><span class="hl_vardecl"><span class="mpre">packageLogFile</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">(&lt;/&gt;)</span></span><span class="mpre"> </span><a href="#loc_283_9_283_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_9_283_19&#39;)"><span class="hl_varref"><span class="mpre">testLogDir</span></span></a><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_458_1_458_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_1_458_15&#39;)"><span class="hl_varref"><span class="mpre">packageLogPath</span></span></a><span class="mpre"> </span><a href="#loc_281_9_281_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_9_281_24&#39;)"><span class="hl_varref"><span class="mpre">machineTemplate</span></span></a><span class="mpre"> </span><a href="#loc_278_6_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_15&#39;)"><span class="hl_varref"><span class="mpre">pkg_descr</span></span></a><span class="mpre"> </span><a href="#loc_278_16_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_16_278_19&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre">
    </span><a name="loc_371_5_371_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_5_371_10&#39;)"><span class="hl_vardecl"><span class="mpre">allOk</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_383_1_383_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_1_383_17&#39;)"><span class="hl_varref"><span class="mpre">summarizePackage</span></span></a><span class="mpre"> </span><a href="#loc_279_9_279_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_9_279_18&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_368_9_368_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_9_368_19&#39;)"><span class="hl_varref"><span class="mpre">packageLog</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">writeFile</span></span><span class="mpre"> </span><a href="#loc_369_9_369_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_9_369_23&#39;)"><span class="hl_varref"><span class="mpre">packageLogFile</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_368_9_368_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_9_368_19&#39;)"><span class="hl_varref"><span class="mpre">packageLog</span></span></a><span class="mpre">

    </span><a href="Distribution.Simple.Hpc.html#loc_166_1_166_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Hpc.html#loc_166_1_166_14&#39;)"><span class="hl_varref"><span class="mpre">markupPackage</span></span></a><span class="mpre"> </span><a href="#loc_279_9_279_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_9_279_18&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_278_16_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_16_278_19&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre"> </span><a href="#loc_282_9_282_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_9_282_17&#39;)"><span class="hl_varref"><span class="mpre">distPref</span></span></a><span class="mpre"> (</span><a href="Distribution.Text.html#loc_31_1_31_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_31_1_31_8&#39;)"><span class="hl_varref"><span class="mpre">display</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.PackageDescription.html#loc_164_9_164_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_164_9_164_16&#39;)"><span class="hl_varref"><span class="mpre">PD.package</span></span></a><span class="mpre"> </span><a href="#loc_278_6_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_15&#39;)"><span class="hl_varref"><span class="mpre">pkg_descr</span></span></a><span class="mpre">)
        </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="#loc_345_5_345_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_5_345_15&#39;)"><span class="hl_varref"><span class="mpre">testsToRun</span></span></a><span class="mpre">

    </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> </span><a href="#loc_371_5_371_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_5_371_10&#39;)"><span class="hl_varref"><span class="mpre">allOk</span></span></a><span class="mpre"> </span><a href="System.Exit.html#loc_69_1_69_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Exit.html#loc_69_1_69_12&#39;)"><span class="hl_varref"><span class="mpre">exitFailure</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Print a summary to the console after all test suites have been run</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- indicating the number of successful test suites and cases.  Returns &#39;True&#39; if</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- all test suites passed and &#39;False&#39; otherwise.</span></span><span class="mpre">
</span><a href="#loc_383_1_383_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_1_383_17&#39;)"><span class="mpre">summarizePackage</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_97_6_97_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_16&#39;)"><span class="hl_tyconref"><span class="mpre">PackageLog</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_383_1_383_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_1_383_17&#39;)"><span class="hl_fundecl"><span class="mpre">summarizePackage</span></span></a><span class="mpre"> </span><a name="loc_383_18_383_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_18_383_27&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_383_28_383_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_28_383_38&#39;)"><span class="hl_vardecl"><span class="mpre">packageLog</span></span></a><span class="mpre"> = do
    let </span><a name="loc_384_9_384_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_9_384_15&#39;)"><span class="hl_vardecl"><span class="mpre">counts</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_136_1_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_17&#39;)"><span class="hl_varref"><span class="mpre">countTestResults</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_117_7_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_7_117_15&#39;)"><span class="hl_varref"><span class="mpre">testLogs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_101_7_101_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_7_101_17&#39;)"><span class="hl_varref"><span class="mpre">testSuites</span></span></a><span class="mpre"> </span><a href="#loc_383_28_383_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_28_383_38&#39;)"><span class="hl_varref"><span class="mpre">packageLog</span></span></a><span class="mpre">
        (</span><a name="loc_385_10_385_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_10_385_16&#39;)"><span class="hl_vardecl"><span class="mpre">passed</span></span></a><span class="mpre">, </span><a name="loc_385_18_385_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_18_385_24&#39;)"><span class="hl_vardecl"><span class="mpre">failed</span></span></a><span class="mpre">, </span><a name="loc_385_26_385_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_26_385_32&#39;)"><span class="hl_vardecl"><span class="mpre">errors</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">foldl1</span></span><span class="mpre"> </span><a href="#loc_394_5_394_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_5_394_14&#39;)"><span class="hl_varref"><span class="mpre">addTriple</span></span></a><span class="mpre"> </span><a href="#loc_384_9_384_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_9_384_15&#39;)"><span class="hl_varref"><span class="mpre">counts</span></span></a><span class="mpre">
        </span><a name="loc_386_9_386_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_9_386_19&#39;)"><span class="hl_vardecl"><span class="mpre">totalCases</span></span></a><span class="mpre"> = </span><a href="#loc_385_10_385_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_10_385_16&#39;)"><span class="hl_varref"><span class="mpre">passed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_385_18_385_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_18_385_24&#39;)"><span class="hl_varref"><span class="mpre">failed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_385_26_385_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_26_385_32&#39;)"><span class="hl_varref"><span class="mpre">errors</span></span></a><span class="mpre">
        </span><a name="loc_387_9_387_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_9_387_21&#39;)"><span class="hl_vardecl"><span class="mpre">passedSuites</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> </span><a href="#loc_147_1_147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_12&#39;)"><span class="hl_varref"><span class="mpre">suitePassed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_101_7_101_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_7_101_17&#39;)"><span class="hl_varref"><span class="mpre">testSuites</span></span></a><span class="mpre"> </span><a href="#loc_383_28_383_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_28_383_38&#39;)"><span class="hl_varref"><span class="mpre">packageLog</span></span></a><span class="mpre">
        </span><a name="loc_388_9_388_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_9_388_20&#39;)"><span class="hl_vardecl"><span class="mpre">totalSuites</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_101_7_101_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_7_101_17&#39;)"><span class="hl_varref"><span class="mpre">testSuites</span></span></a><span class="mpre"> </span><a href="#loc_383_28_383_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_28_383_38&#39;)"><span class="hl_varref"><span class="mpre">packageLog</span></span></a><span class="mpre">
    </span><a href="Distribution.Simple.Utils.html#loc_292_1_292_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_292_1_292_7&#39;)"><span class="hl_varref"><span class="mpre">notice</span></span></a><span class="mpre"> </span><a href="#loc_383_18_383_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_18_383_27&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_387_9_387_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_9_387_21&#39;)"><span class="hl_varref"><span class="mpre">passedSuites</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; of &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_388_9_388_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_9_388_20&#39;)"><span class="hl_varref"><span class="mpre">totalSuites</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; test suites (&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_385_10_385_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_10_385_16&#39;)"><span class="hl_varref"><span class="mpre">passed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; of &quot;</span></span><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_386_9_386_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_9_386_19&#39;)"><span class="hl_varref"><span class="mpre">totalCases</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; test cases) passed.&quot;</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_387_9_387_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_9_387_21&#39;)"><span class="hl_varref"><span class="mpre">passedSuites</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_388_9_388_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_9_388_20&#39;)"><span class="hl_varref"><span class="mpre">totalSuites</span></span></a><span class="mpre">
  where
    </span><a name="loc_394_5_394_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_5_394_14&#39;)"><span class="hl_fundecl"><span class="mpre">addTriple</span></span></a><span class="mpre"> (</span><a name="loc_394_16_394_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_16_394_18&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="mpre">, </span><a name="loc_394_20_394_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_20_394_22&#39;)"><span class="hl_vardecl"><span class="mpre">f1</span></span></a><span class="mpre">, </span><a name="loc_394_24_394_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_24_394_26&#39;)"><span class="hl_vardecl"><span class="mpre">e1</span></span></a><span class="mpre">) (</span><a name="loc_394_29_394_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_29_394_31&#39;)"><span class="hl_vardecl"><span class="mpre">p2</span></span></a><span class="mpre">, </span><a name="loc_394_33_394_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_33_394_35&#39;)"><span class="hl_vardecl"><span class="mpre">f2</span></span></a><span class="mpre">, </span><a name="loc_394_37_394_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_37_394_39&#39;)"><span class="hl_vardecl"><span class="mpre">e2</span></span></a><span class="mpre">) = (</span><a href="#loc_394_16_394_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_16_394_18&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_394_29_394_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_29_394_31&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre">, </span><a href="#loc_394_20_394_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_20_394_22&#39;)"><span class="hl_varref"><span class="mpre">f1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_394_33_394_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_33_394_35&#39;)"><span class="hl_varref"><span class="mpre">f2</span></span></a><span class="mpre">, </span><a href="#loc_394_24_394_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_24_394_26&#39;)"><span class="hl_varref"><span class="mpre">e1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_394_37_394_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_37_394_39&#39;)"><span class="hl_varref"><span class="mpre">e2</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Print a summary of a single test case&#39;s result to the console, supressing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- output for certain verbosity or test filter levels.</span></span><span class="mpre">
</span><a href="#loc_399_1_399_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_1_399_14&#39;)"><span class="mpre">summarizeTest</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><a href="Distribution.Simple.Setup.html#loc_1507_6_1507_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1507_6_1507_21&#39;)"><span class="hl_tyconref"><span class="mpre">TestShowDetails</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_122_6_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_6_122_14&#39;)"><span class="hl_tyconref"><span class="mpre">TestLogs</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_399_1_399_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_1_399_14&#39;)"><span class="hl_fundecl"><span class="mpre">summarizeTest</span></span></a><span class="mpre"> _ _ (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 399, srcSpanStartColumn = 20, srcSpanEndLine = 399, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 399, srcSpanStartColumn = 30, srcSpanEndLine = 399, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test"><span class="mpre">GroupLogs {}</span></span><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
</span><a href="#loc_399_1_399_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_1_399_14&#39;)"><span class="hl_fundecl"><span class="mpre">summarizeTest</span></span></a><span class="mpre"> </span><a name="loc_400_15_400_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_15_400_24&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_400_25_400_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_25_400_32&#39;)"><span class="hl_vardecl"><span class="mpre">details</span></span></a><span class="mpre"> </span><a name="loc_400_33_400_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_33_400_34&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> =
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> </span><a href="#loc_403_11_403_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_11_403_22&#39;)"><span class="hl_varref"><span class="mpre">shouldPrint</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.Utils.html#loc_292_1_292_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_292_1_292_7&#39;)"><span class="hl_varref"><span class="mpre">notice</span></span></a><span class="mpre"> </span><a href="#loc_400_15_400_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_15_400_24&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Test case &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_124_11_124_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_11_124_19&#39;)"><span class="hl_varref"><span class="mpre">testName</span></span></a><span class="mpre"> </span><a href="#loc_400_33_400_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_33_400_34&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_126_11_126_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_21&#39;)"><span class="hl_varref"><span class="mpre">testResult</span></span></a><span class="mpre"> </span><a href="#loc_400_33_400_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_33_400_34&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
    where </span><a name="loc_403_11_403_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_11_403_22&#39;)"><span class="hl_vardecl"><span class="mpre">shouldPrint</span></span></a><span class="mpre"> = (</span><a href="#loc_400_25_400_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_25_400_32&#39;)"><span class="hl_varref"><span class="mpre">details</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1507_24_1507_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1507_24_1507_29&#39;)"><span class="hl_conref"><span class="mpre">Never</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> (</span><a href="#loc_404_11_404_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_11_404_20&#39;)"><span class="hl_varref"><span class="mpre">notPassed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_400_25_400_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_25_400_32&#39;)"><span class="hl_varref"><span class="mpre">details</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1507_43_1507_49" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1507_43_1507_49&#39;)"><span class="hl_conref"><span class="mpre">Always</span></span></a><span class="mpre">)
          </span><a name="loc_404_11_404_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_11_404_20&#39;)"><span class="hl_vardecl"><span class="mpre">notPassed</span></span></a><span class="mpre"> = </span><a href="#loc_126_11_126_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_21&#39;)"><span class="hl_varref"><span class="mpre">testResult</span></span></a><span class="mpre"> </span><a href="#loc_400_33_400_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_33_400_34&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="Distribution.TestSuite.html#loc_117_15_117_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_117_15_117_19&#39;)"><span class="hl_conref"><span class="mpre">Pass</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Print a summary of the test suite&#39;s results on the console, suppressing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- output for certain verbosity or test filter levels.</span></span><span class="mpre">
</span><a href="#loc_409_1_409_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_1_409_21&#39;)"><span class="mpre">summarizeSuiteFinish</span></a><span class="mpre"> :: </span><a href="#loc_115_6_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_18&#39;)"><span class="hl_tyconref"><span class="mpre">TestSuiteLog</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_409_1_409_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_1_409_21&#39;)"><span class="hl_fundecl"><span class="mpre">summarizeSuiteFinish</span></span></a><span class="mpre"> </span><a name="loc_409_22_409_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_22_409_29&#39;)"><span class="hl_vardecl"><span class="mpre">testLog</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unlines</span></span><span class="mpre">
    [ </span><span class="hl_string"><span class="mpre">&quot;Test suite &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_116_7_116_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_7_116_20&#39;)"><span class="hl_varref"><span class="mpre">testSuiteName</span></span></a><span class="mpre"> </span><a href="#loc_409_22_409_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_22_409_29&#39;)"><span class="hl_varref"><span class="mpre">testLog</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_413_11_413_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_11_413_17&#39;)"><span class="hl_varref"><span class="mpre">resStr</span></span></a><span class="mpre">
    , </span><span class="hl_string"><span class="mpre">&quot;Test suite logged to: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_118_7_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_7_118_14&#39;)"><span class="hl_varref"><span class="mpre">logFile</span></span></a><span class="mpre"> </span><a href="#loc_409_22_409_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_22_409_29&#39;)"><span class="hl_varref"><span class="mpre">testLog</span></span></a><span class="mpre">
    ]
    where </span><a name="loc_413_11_413_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_11_413_17&#39;)"><span class="hl_vardecl"><span class="mpre">resStr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_144_1_144_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_144_1_144_8&#39;)"><span class="hl_varref"><span class="mpre">toUpper</span></span></a><span class="mpre"> (</span><a href="#loc_419_1_419_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_1_419_13&#39;)"><span class="hl_varref"><span class="mpre">resultString</span></span></a><span class="mpre"> </span><a href="#loc_409_22_409_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_22_409_29&#39;)"><span class="hl_varref"><span class="mpre">testLog</span></span></a><span class="mpre">)

</span><a href="#loc_416_1_416_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_1_416_20&#39;)"><span class="mpre">summarizeSuiteStart</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_416_1_416_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_1_416_20&#39;)"><span class="hl_fundecl"><span class="mpre">summarizeSuiteStart</span></span></a><span class="mpre"> </span><a name="loc_416_21_416_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_21_416_22&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;Test suite &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_416_21_416_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_21_416_22&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: RUNNING...\n&quot;</span></span><span class="mpre">

</span><a href="#loc_419_1_419_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_1_419_13&#39;)"><span class="mpre">resultString</span></a><span class="mpre"> :: </span><a href="#loc_115_6_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_18&#39;)"><span class="hl_tyconref"><span class="mpre">TestSuiteLog</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_419_1_419_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_1_419_13&#39;)"><span class="hl_fundecl"><span class="mpre">resultString</span></span></a><span class="mpre"> </span><a name="loc_419_14_419_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_14_419_15&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> | </span><a href="#loc_161_1_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_11&#39;)"><span class="hl_varref"><span class="mpre">suiteError</span></span></a><span class="mpre"> </span><a href="#loc_419_14_419_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_14_419_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;error&quot;</span></span><span class="mpre">
               | </span><a href="#loc_154_1_154_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_12&#39;)"><span class="hl_varref"><span class="mpre">suiteFailed</span></span></a><span class="mpre"> </span><a href="#loc_419_14_419_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_14_419_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;fail&quot;</span></span><span class="mpre">
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;pass&quot;</span></span><span class="mpre">

</span><a href="#loc_428_1_428_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_17&#39;)"><span class="mpre">testSuiteLogPath</span></a><span class="mpre"> :: </span><a href="Distribution.Simple.InstallDirs.html#loc_371_9_371_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_371_9_371_21&#39;)"><span class="hl_tyconref"><span class="mpre">PathTemplate</span></span></a><span class="mpre">
                 -&gt; </span><a href="Distribution.PackageDescription.html#loc_161_6_161_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_161_6_161_24&#39;)"><span class="hl_tyconref"><span class="mpre">PD.PackageDescription</span></span></a><span class="mpre">
                 -&gt; </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20&#39;)"><span class="hl_tyconref"><span class="mpre">LBI.LocalBuildInfo</span></span></a><span class="mpre">
                 -&gt; </span><a href="#loc_115_6_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_18&#39;)"><span class="hl_tyconref"><span class="mpre">TestSuiteLog</span></span></a><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_428_1_428_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_17&#39;)"><span class="hl_fundecl"><span class="mpre">testSuiteLogPath</span></span></a><span class="mpre"> </span><a name="loc_428_18_428_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_18_428_26&#39;)"><span class="hl_vardecl"><span class="mpre">template</span></span></a><span class="mpre"> </span><a name="loc_428_27_428_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_27_428_36&#39;)"><span class="hl_vardecl"><span class="mpre">pkg_descr</span></span></a><span class="mpre"> </span><a name="loc_428_37_428_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_37_428_40&#39;)"><span class="hl_vardecl"><span class="mpre">lbi</span></span></a><span class="mpre"> </span><a name="loc_428_41_428_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_41_428_48&#39;)"><span class="hl_vardecl"><span class="mpre">testLog</span></span></a><span class="mpre"> =
    </span><a href="Distribution.Simple.InstallDirs.html#loc_410_1_410_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_410_1_410_17&#39;)"><span class="hl_varref"><span class="mpre">fromPathTemplate</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.InstallDirs.html#loc_417_1_417_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_417_1_417_18&#39;)"><span class="hl_varref"><span class="mpre">substPathTemplate</span></span></a><span class="mpre"> </span><a href="#loc_431_9_431_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_9_431_12&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre"> </span><a href="#loc_428_18_428_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_18_428_26&#39;)"><span class="hl_varref"><span class="mpre">template</span></span></a><span class="mpre">
    where
        </span><a name="loc_431_9_431_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_9_431_12&#39;)"><span class="hl_vardecl"><span class="mpre">env</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.InstallDirs.html#loc_429_1_429_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_429_1_429_23&#39;)"><span class="hl_varref"><span class="mpre">initialPathTemplateEnv</span></span></a><span class="mpre">
                (</span><a href="Distribution.PackageDescription.html#loc_164_9_164_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_164_9_164_16&#39;)"><span class="hl_varref"><span class="mpre">PD.package</span></span></a><span class="mpre"> </span><a href="#loc_428_27_428_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_27_428_36&#39;)"><span class="hl_varref"><span class="mpre">pkg_descr</span></span></a><span class="mpre">) (</span><a href="Distribution.Simple.Compiler.html#loc_86_9_86_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Compiler.html#loc_86_9_86_19&#39;)"><span class="hl_varref"><span class="mpre">compilerId</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_127_9_127_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_127_9_127_17&#39;)"><span class="hl_varref"><span class="mpre">LBI.compiler</span></span></a><span class="mpre"> </span><a href="#loc_428_37_428_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_37_428_40&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre">)
                (</span><a href="Distribution.Simple.LocalBuildInfo.html#loc_129_9_129_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_129_9_129_21&#39;)"><span class="hl_varref"><span class="mpre">LBI.hostPlatform</span></span></a><span class="mpre"> </span><a href="#loc_428_37_428_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_37_428_40&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre">)
                </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">  [ (</span><a href="Distribution.Simple.InstallDirs.html#loc_394_8_394_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_394_8_394_24&#39;)"><span class="hl_conref"><span class="mpre">TestSuiteNameVar</span></span></a><span class="mpre">, </span><a href="Distribution.Simple.InstallDirs.html#loc_405_1_405_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_405_1_405_15&#39;)"><span class="hl_varref"><span class="mpre">toPathTemplate</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_116_7_116_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_7_116_20&#39;)"><span class="hl_varref"><span class="mpre">testSuiteName</span></span></a><span class="mpre"> </span><a href="#loc_428_41_428_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_41_428_48&#39;)"><span class="hl_varref"><span class="mpre">testLog</span></span></a><span class="mpre">)
                    , (</span><a href="Distribution.Simple.InstallDirs.html#loc_395_8_395_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_395_8_395_26&#39;)"><span class="hl_conref"><span class="mpre">TestSuiteResultVar</span></span></a><span class="mpre">, </span><a href="#loc_437_9_437_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_437_9_437_15&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre">)
                    ]
        </span><a name="loc_437_9_437_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_437_9_437_15&#39;)"><span class="hl_vardecl"><span class="mpre">result</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.InstallDirs.html#loc_405_1_405_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_405_1_405_15&#39;)"><span class="hl_varref"><span class="mpre">toPathTemplate</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_419_1_419_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_1_419_13&#39;)"><span class="hl_varref"><span class="mpre">resultString</span></span></a><span class="mpre"> </span><a href="#loc_428_41_428_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_41_428_48&#39;)"><span class="hl_varref"><span class="mpre">testLog</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- TODO: This is abusing the notion of a &#39;PathTemplate&#39;.  The result</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- isn&#39;t neccesarily a path.</span></span><span class="mpre">
</span><a href="#loc_446_1_446_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_11&#39;)"><span class="mpre">testOption</span></a><span class="mpre"> :: </span><a href="Distribution.PackageDescription.html#loc_161_6_161_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_161_6_161_24&#39;)"><span class="hl_tyconref"><span class="mpre">PD.PackageDescription</span></span></a><span class="mpre">
           -&gt; </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20&#39;)"><span class="hl_tyconref"><span class="mpre">LBI.LocalBuildInfo</span></span></a><span class="mpre">
           -&gt; </span><a href="Distribution.PackageDescription.html#loc_395_6_395_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_395_6_395_15&#39;)"><span class="hl_tyconref"><span class="mpre">PD.TestSuite</span></span></a><span class="mpre">
           -&gt; </span><a href="Distribution.Simple.InstallDirs.html#loc_371_9_371_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_371_9_371_21&#39;)"><span class="hl_tyconref"><span class="mpre">PathTemplate</span></span></a><span class="mpre">
           -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_446_1_446_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_11&#39;)"><span class="hl_fundecl"><span class="mpre">testOption</span></span></a><span class="mpre"> </span><a name="loc_446_12_446_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_12_446_21&#39;)"><span class="hl_vardecl"><span class="mpre">pkg_descr</span></span></a><span class="mpre"> </span><a name="loc_446_22_446_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_22_446_25&#39;)"><span class="hl_vardecl"><span class="mpre">lbi</span></span></a><span class="mpre"> </span><a name="loc_446_26_446_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_26_446_31&#39;)"><span class="hl_vardecl"><span class="mpre">suite</span></span></a><span class="mpre"> </span><a name="loc_446_32_446_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_32_446_40&#39;)"><span class="hl_vardecl"><span class="mpre">template</span></span></a><span class="mpre"> =
    </span><a href="Distribution.Simple.InstallDirs.html#loc_410_1_410_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_410_1_410_17&#39;)"><span class="hl_varref"><span class="mpre">fromPathTemplate</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.InstallDirs.html#loc_417_1_417_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_417_1_417_18&#39;)"><span class="hl_varref"><span class="mpre">substPathTemplate</span></span></a><span class="mpre"> </span><a href="#loc_449_5_449_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_5_449_8&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre"> </span><a href="#loc_446_32_446_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_32_446_40&#39;)"><span class="hl_varref"><span class="mpre">template</span></span></a><span class="mpre">
  where
    </span><a name="loc_449_5_449_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_5_449_8&#39;)"><span class="hl_vardecl"><span class="mpre">env</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.InstallDirs.html#loc_429_1_429_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_429_1_429_23&#39;)"><span class="hl_varref"><span class="mpre">initialPathTemplateEnv</span></span></a><span class="mpre">
          (</span><a href="Distribution.PackageDescription.html#loc_164_9_164_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_164_9_164_16&#39;)"><span class="hl_varref"><span class="mpre">PD.package</span></span></a><span class="mpre"> </span><a href="#loc_446_12_446_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_12_446_21&#39;)"><span class="hl_varref"><span class="mpre">pkg_descr</span></span></a><span class="mpre">) (</span><a href="Distribution.Simple.Compiler.html#loc_86_9_86_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Compiler.html#loc_86_9_86_19&#39;)"><span class="hl_varref"><span class="mpre">compilerId</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_127_9_127_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_127_9_127_17&#39;)"><span class="hl_varref"><span class="mpre">LBI.compiler</span></span></a><span class="mpre"> </span><a href="#loc_446_22_446_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_22_446_25&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre">)
          (</span><a href="Distribution.Simple.LocalBuildInfo.html#loc_129_9_129_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_129_9_129_21&#39;)"><span class="hl_varref"><span class="mpre">LBI.hostPlatform</span></span></a><span class="mpre"> </span><a href="#loc_446_22_446_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_22_446_25&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
          [(</span><a href="Distribution.Simple.InstallDirs.html#loc_394_8_394_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_394_8_394_24&#39;)"><span class="hl_conref"><span class="mpre">TestSuiteNameVar</span></span></a><span class="mpre">, </span><a href="Distribution.Simple.InstallDirs.html#loc_405_1_405_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_405_1_405_15&#39;)"><span class="hl_varref"><span class="mpre">toPathTemplate</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.PackageDescription.html#loc_396_9_396_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_396_9_396_17&#39;)"><span class="hl_varref"><span class="mpre">PD.testName</span></span></a><span class="mpre"> </span><a href="#loc_446_26_446_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_26_446_31&#39;)"><span class="hl_varref"><span class="mpre">suite</span></span></a><span class="mpre">)]

</span><a href="#loc_458_1_458_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_1_458_15&#39;)"><span class="mpre">packageLogPath</span></a><span class="mpre"> :: </span><a href="Distribution.Simple.InstallDirs.html#loc_371_9_371_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_371_9_371_21&#39;)"><span class="hl_tyconref"><span class="mpre">PathTemplate</span></span></a><span class="mpre">
               -&gt; </span><a href="Distribution.PackageDescription.html#loc_161_6_161_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_161_6_161_24&#39;)"><span class="hl_tyconref"><span class="mpre">PD.PackageDescription</span></span></a><span class="mpre">
               -&gt; </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20&#39;)"><span class="hl_tyconref"><span class="mpre">LBI.LocalBuildInfo</span></span></a><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_458_1_458_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_1_458_15&#39;)"><span class="hl_fundecl"><span class="mpre">packageLogPath</span></span></a><span class="mpre"> </span><a name="loc_458_16_458_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_16_458_24&#39;)"><span class="hl_vardecl"><span class="mpre">template</span></span></a><span class="mpre"> </span><a name="loc_458_25_458_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_25_458_34&#39;)"><span class="hl_vardecl"><span class="mpre">pkg_descr</span></span></a><span class="mpre"> </span><a name="loc_458_35_458_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_35_458_38&#39;)"><span class="hl_vardecl"><span class="mpre">lbi</span></span></a><span class="mpre"> =
    </span><a href="Distribution.Simple.InstallDirs.html#loc_410_1_410_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_410_1_410_17&#39;)"><span class="hl_varref"><span class="mpre">fromPathTemplate</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.InstallDirs.html#loc_417_1_417_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_417_1_417_18&#39;)"><span class="hl_varref"><span class="mpre">substPathTemplate</span></span></a><span class="mpre"> </span><a href="#loc_461_9_461_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_9_461_12&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre"> </span><a href="#loc_458_16_458_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_16_458_24&#39;)"><span class="hl_varref"><span class="mpre">template</span></span></a><span class="mpre">
    where
        </span><a name="loc_461_9_461_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_9_461_12&#39;)"><span class="hl_vardecl"><span class="mpre">env</span></span></a><span class="mpre"> = </span><a href="Distribution.Simple.InstallDirs.html#loc_429_1_429_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.InstallDirs.html#loc_429_1_429_23&#39;)"><span class="hl_varref"><span class="mpre">initialPathTemplateEnv</span></span></a><span class="mpre">
                (</span><a href="Distribution.PackageDescription.html#loc_164_9_164_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_164_9_164_16&#39;)"><span class="hl_varref"><span class="mpre">PD.package</span></span></a><span class="mpre"> </span><a href="#loc_458_25_458_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_25_458_34&#39;)"><span class="hl_varref"><span class="mpre">pkg_descr</span></span></a><span class="mpre">) (</span><a href="Distribution.Simple.Compiler.html#loc_86_9_86_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Compiler.html#loc_86_9_86_19&#39;)"><span class="hl_varref"><span class="mpre">compilerId</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_127_9_127_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_127_9_127_17&#39;)"><span class="hl_varref"><span class="mpre">LBI.compiler</span></span></a><span class="mpre"> </span><a href="#loc_458_35_458_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_35_458_38&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre">)
                (</span><a href="Distribution.Simple.LocalBuildInfo.html#loc_129_9_129_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_129_9_129_21&#39;)"><span class="hl_varref"><span class="mpre">LBI.hostPlatform</span></span></a><span class="mpre"> </span><a href="#loc_458_35_458_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_35_458_38&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The filename of the source file for the stub executable associated with a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- library &#39;TestSuite&#39;.</span></span><span class="mpre">
</span><a href="#loc_468_1_468_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_1_468_13&#39;)"><span class="mpre">stubFilePath</span></a><span class="mpre"> :: </span><a href="Distribution.PackageDescription.html#loc_395_6_395_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_395_6_395_15&#39;)"><span class="hl_tyconref"><span class="mpre">PD.TestSuite</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_468_1_468_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_1_468_13&#39;)"><span class="hl_fundecl"><span class="mpre">stubFilePath</span></span></a><span class="mpre"> </span><a name="loc_468_14_468_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_14_468_15&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_472_1_472_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_472_1_472_9&#39;)"><span class="hl_varref"><span class="mpre">stubName</span></span></a><span class="mpre"> </span><a href="#loc_468_14_468_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_14_468_15&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;.&gt;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;hs&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The name of the stub executable associated with a library &#39;TestSuite&#39;.</span></span><span class="mpre">
</span><a href="#loc_472_1_472_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_472_1_472_9&#39;)"><span class="mpre">stubName</span></a><span class="mpre"> :: </span><a href="Distribution.PackageDescription.html#loc_395_6_395_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_395_6_395_15&#39;)"><span class="hl_tyconref"><span class="mpre">PD.TestSuite</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_472_1_472_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_472_1_472_9&#39;)"><span class="hl_fundecl"><span class="mpre">stubName</span></span></a><span class="mpre"> </span><a name="loc_472_10_472_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_472_10_472_11&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="Distribution.PackageDescription.html#loc_396_9_396_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_396_9_396_17&#39;)"><span class="hl_varref"><span class="mpre">PD.testName</span></span></a><span class="mpre"> </span><a href="#loc_472_10_472_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_472_10_472_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Stub&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write the source file for a library &#39;TestSuite&#39; stub executable.</span></span><span class="mpre">
</span><a href="#loc_480_1_480_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_1_480_20&#39;)"><span class="mpre">writeSimpleTestStub</span></a><span class="mpre"> :: </span><a href="Distribution.PackageDescription.html#loc_395_6_395_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_395_6_395_15&#39;)"><span class="hl_tyconref"><span class="mpre">PD.TestSuite</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ library &#39;TestSuite&#39; for which a stub</span></span><span class="mpre">
                                    </span><span class="hl_comment"><span class="mpre">-- is being created</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ path to directory where stub source</span></span><span class="mpre">
                                    </span><span class="hl_comment"><span class="mpre">-- should be located</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_480_1_480_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_1_480_20&#39;)"><span class="hl_fundecl"><span class="mpre">writeSimpleTestStub</span></span></a><span class="mpre"> </span><a name="loc_480_21_480_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_21_480_22&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_480_23_480_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_23_480_26&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre"> = do
    </span><a href="System.Directory.html#loc_267_1_267_25" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_267_1_267_25&#39;)"><span class="hl_varref"><span class="mpre">createDirectoryIfMissing</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_480_23_480_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_23_480_26&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">
    let </span><a name="loc_482_9_482_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_9_482_17&#39;)"><span class="hl_vardecl"><span class="mpre">filename</span></span></a><span class="mpre"> = </span><a href="#loc_480_23_480_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_23_480_26&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_468_1_468_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_1_468_13&#39;)"><span class="hl_varref"><span class="mpre">stubFilePath</span></span></a><span class="mpre"> </span><a href="#loc_480_21_480_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_21_480_22&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
        </span><a href="Distribution.PackageDescription.html#loc_426_6_426_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_426_6_426_21&#39;)"><span class="hl_conref"><span class="mpre">PD.TestSuiteLibV09</span></span></a><span class="mpre"> _ </span><a name="loc_483_30_483_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_483_30_483_31&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="Distribution.PackageDescription.html#loc_397_9_397_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_397_9_397_22&#39;)"><span class="hl_varref"><span class="mpre">PD.testInterface</span></span></a><span class="mpre"> </span><a href="#loc_480_21_480_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_21_480_22&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">writeFile</span></span><span class="mpre"> </span><a href="#loc_482_9_482_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_9_482_17&#39;)"><span class="hl_varref"><span class="mpre">filename</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_488_1_488_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_1_488_15&#39;)"><span class="hl_varref"><span class="mpre">simpleTestStub</span></span></a><span class="mpre"> </span><a href="#loc_483_30_483_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_483_30_483_31&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Source code for library test suite stub executable</span></span><span class="mpre">
</span><a href="#loc_488_1_488_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_1_488_15&#39;)"><span class="mpre">simpleTestStub</span></a><span class="mpre"> :: </span><a href="Distribution.ModuleName.html#loc_67_9_67_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.ModuleName.html#loc_67_9_67_19&#39;)"><span class="hl_tyconref"><span class="mpre">ModuleName</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_488_1_488_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_1_488_15&#39;)"><span class="hl_fundecl"><span class="mpre">simpleTestStub</span></span></a><span class="mpre"> </span><a name="loc_488_16_488_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_16_488_17&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unlines</span></span><span class="mpre">
    [ </span><span class="hl_string"><span class="mpre">&quot;module Main ( main ) where&quot;</span></span><span class="mpre">
    , </span><span class="hl_string"><span class="mpre">&quot;import Distribution.Simple.Test ( stubMain )&quot;</span></span><span class="mpre">
    , </span><span class="hl_string"><span class="mpre">&quot;import &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="Distribution.Text.html#loc_27_3_27_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_27_3_27_7&#39;)"><span class="hl_varref"><span class="mpre">disp</span></span></a><span class="mpre"> </span><a href="#loc_488_16_488_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_16_488_17&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; ( tests )&quot;</span></span><span class="mpre">
    , </span><span class="hl_string"><span class="mpre">&quot;main :: IO ()&quot;</span></span><span class="mpre">
    , </span><span class="hl_string"><span class="mpre">&quot;main = stubMain tests&quot;</span></span><span class="mpre">
    ]

</span><span class="hl_comment"><span class="mpre">-- | Main function for test stubs. Once, it was written directly into the stub,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- but minimizing the amount of code actually in the stub maximizes the number</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of detectable errors when Cabal is compiled.</span></span><span class="mpre">
</span><a href="#loc_500_1_500_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_9&#39;)"><span class="mpre">stubMain</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><a href="Distribution.TestSuite.html#loc_96_6_96_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_96_6_96_10&#39;)"><span class="hl_tyconref"><span class="mpre">Test</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_500_1_500_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_9&#39;)"><span class="hl_fundecl"><span class="mpre">stubMain</span></span></a><span class="mpre"> </span><a name="loc_500_10_500_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_10_500_15&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = do
    (</span><a name="loc_501_6_501_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_6_501_7&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">, </span><a name="loc_501_9_501_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_9_501_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">read</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getContents</span></span><span class="mpre">
    </span><a name="loc_502_5_502_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_5_502_8&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_673_1_673_20" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_673_1_673_20&#39;)"><span class="hl_varref"><span class="mpre">getCurrentDirectory</span></span></a><span class="mpre">
    </span><a name="loc_503_5_503_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_5_503_12&#39;)"><span class="hl_vardecl"><span class="mpre">results</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_500_10_500_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_10_500_15&#39;)"><span class="hl_varref"><span class="mpre">tests</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_515_1_515_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_1_515_13&#39;)"><span class="hl_varref"><span class="mpre">stubRunTests</span></span></a><span class="mpre">
    </span><a href="System.Directory.html#loc_709_1_709_20" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_709_1_709_20&#39;)"><span class="hl_varref"><span class="mpre">setCurrentDirectory</span></span></a><span class="mpre"> </span><a href="#loc_502_5_502_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_5_502_8&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">
    </span><a href="#loc_542_1_542_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_1_542_13&#39;)"><span class="hl_varref"><span class="mpre">stubWriteLog</span></span></a><span class="mpre"> </span><a href="#loc_501_6_501_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_6_501_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_501_9_501_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_9_501_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_503_5_503_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_5_503_12&#39;)"><span class="hl_varref"><span class="mpre">results</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The test runner used in library &quot;TestSuite&quot; stub executables.  Runs a list</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of &#39;Test&#39;s.  An executable calling this function is meant to be invoked as</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the child of a Cabal process during @.\/setup test@.  A &#39;TestSuiteLog&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- provided by Cabal, is read from the standard input; it supplies the name of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the test suite and the location of the machine-readable test suite log file.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Human-readable log information is written to the standard output for capture</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- by the calling Cabal process.</span></span><span class="mpre">
</span><a href="#loc_515_1_515_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_1_515_13&#39;)"><span class="mpre">stubRunTests</span></a><span class="mpre"> :: [</span><a href="Distribution.TestSuite.html#loc_96_6_96_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_96_6_96_10&#39;)"><span class="hl_tyconref"><span class="mpre">Test</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_122_6_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_6_122_14&#39;)"><span class="hl_tyconref"><span class="mpre">TestLogs</span></span></a><span class="mpre">
</span><a name="loc_515_1_515_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_1_515_13&#39;)"><span class="hl_fundecl"><span class="mpre">stubRunTests</span></span></a><span class="mpre"> </span><a name="loc_515_14_515_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_14_515_19&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = do
    </span><a name="loc_516_5_516_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_5_516_9&#39;)"><span class="hl_vardecl"><span class="mpre">logs</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> </span><a href="#loc_519_5_519_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_5_519_18&#39;)"><span class="hl_varref"><span class="mpre">stubRunTests&#39;</span></span></a><span class="mpre"> </span><a href="#loc_515_14_515_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_14_515_19&#39;)"><span class="hl_varref"><span class="mpre">tests</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_128_7_128_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_7_128_16&#39;)"><span class="hl_conref"><span class="mpre">GroupLogs</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Default&quot;</span></span><span class="mpre"> </span><a href="#loc_516_5_516_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_5_516_9&#39;)"><span class="hl_varref"><span class="mpre">logs</span></span></a><span class="mpre">
  where
    </span><a name="loc_519_5_519_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_5_519_18&#39;)"><span class="hl_fundecl"><span class="mpre">stubRunTests&#39;</span></span></a><span class="mpre"> (</span><a href="Distribution.TestSuite.html#loc_97_7_97_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_97_7_97_11&#39;)"><span class="hl_conref"><span class="mpre">Test</span></span></a><span class="mpre"> </span><a name="loc_519_25_519_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_25_519_26&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) = do
        </span><a name="loc_520_9_520_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_9_520_10&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> &lt;- </span><a href="Distribution.TestSuite.html#loc_54_7_54_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_54_7_54_10&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> </span><a href="#loc_519_25_519_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_25_519_26&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_524_9_524_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_9_524_15&#39;)"><span class="hl_varref"><span class="mpre">finish</span></span></a><span class="mpre">
        </span><a href="#loc_399_1_399_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_1_399_14&#39;)"><span class="hl_varref"><span class="mpre">summarizeTest</span></span></a><span class="mpre"> </span><a href="Distribution.Verbosity.html#loc_67_1_67_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_67_1_67_7&#39;)"><span class="hl_varref"><span class="mpre">normal</span></span></a><span class="mpre"> </span><a href="Distribution.Simple.Setup.html#loc_1507_43_1507_49" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Setup.html#loc_1507_43_1507_49&#39;)"><span class="hl_conref"><span class="mpre">Always</span></span></a><span class="mpre"> </span><a href="#loc_520_9_520_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_9_520_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_520_9_520_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_9_520_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
      where
        </span><a name="loc_524_9_524_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_9_524_15&#39;)"><span class="hl_fundecl"><span class="mpre">finish</span></span></a><span class="mpre"> (</span><a href="Distribution.TestSuite.html#loc_114_17_114_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_114_17_114_25&#39;)"><span class="hl_conref"><span class="mpre">Finished</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">result</span></span><span class="mpre">) =
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 525, srcSpanStartColumn = 20, srcSpanEndLine = 529, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 526, srcSpanStartColumn = 17, srcSpanEndLine = 526, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple"><span class="mpre">TestLog
                { testName = name t
                , testOptionsReturned = defaultOptions t
                , testResult = result
                }</span></span><span class="mpre">
        </span><a href="#loc_524_9_524_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_9_524_15&#39;)"><span class="hl_fundecl"><span class="mpre">finish</span></span></a><span class="mpre"> (</span><a href="Distribution.TestSuite.html#loc_115_17_115_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_115_17_115_25&#39;)"><span class="hl_conref"><span class="mpre">Progress</span></span></a><span class="mpre"> _ </span><a name="loc_530_28_530_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_28_530_32&#39;)"><span class="hl_vardecl"><span class="mpre">next</span></span></a><span class="mpre">) = </span><a href="#loc_530_28_530_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_28_530_32&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_524_9_524_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_9_524_15&#39;)"><span class="hl_varref"><span class="mpre">finish</span></span></a><span class="mpre">
    </span><a href="#loc_519_5_519_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_5_519_18&#39;)"><span class="hl_fundecl"><span class="mpre">stubRunTests&#39;</span></span></a><span class="mpre"> </span><a name="loc_531_19_531_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_19_531_20&#39;)"><span class="hl_specname"><span class="mpre">g</span></span></a><span class="mpre">@(</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 531, srcSpanStartColumn = 22, srcSpanEndLine = 531, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 531, srcSpanStartColumn = 28, srcSpanEndLine = 531, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test"><span class="mpre">Group {}</span></span><span class="mpre">) = do
        </span><a name="loc_532_9_532_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_9_532_13&#39;)"><span class="hl_vardecl"><span class="mpre">logs</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> </span><a href="#loc_519_5_519_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_5_519_18&#39;)"><span class="hl_varref"><span class="mpre">stubRunTests&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.TestSuite.html#loc_108_11_108_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_108_11_108_21&#39;)"><span class="hl_varref"><span class="mpre">groupTests</span></span></a><span class="mpre"> </span><a href="#loc_531_19_531_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_19_531_20&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_128_7_128_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_7_128_16&#39;)"><span class="hl_conref"><span class="mpre">GroupLogs</span></span></a><span class="mpre"> (</span><a href="Distribution.TestSuite.html#loc_99_11_99_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_99_11_99_20&#39;)"><span class="hl_varref"><span class="mpre">groupName</span></span></a><span class="mpre"> </span><a href="#loc_531_19_531_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_19_531_20&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) </span><a href="#loc_532_9_532_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_9_532_13&#39;)"><span class="hl_varref"><span class="mpre">logs</span></span></a><span class="mpre">
    </span><a href="#loc_519_5_519_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_5_519_18&#39;)"><span class="hl_fundecl"><span class="mpre">stubRunTests&#39;</span></span></a><span class="mpre"> (</span><a href="Distribution.TestSuite.html#loc_110_7_110_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_110_7_110_19&#39;)"><span class="hl_conref"><span class="mpre">ExtraOptions</span></span></a><span class="mpre"> _ </span><a name="loc_534_35_534_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_534_35_534_36&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) = </span><a href="#loc_519_5_519_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_5_519_18&#39;)"><span class="hl_varref"><span class="mpre">stubRunTests&#39;</span></span></a><span class="mpre"> </span><a href="#loc_534_35_534_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_534_35_534_36&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
    </span><a name="loc_535_5_535_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_5_535_23&#39;)"><span class="hl_fundecl"><span class="mpre">maybeDefaultOption</span></span></a><span class="mpre"> </span><a name="loc_535_24_535_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_24_535_27&#39;)"><span class="hl_vardecl"><span class="mpre">opt</span></span></a><span class="mpre"> =
        </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> (\</span><a name="loc_536_25_536_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_25_536_26&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="Distribution.TestSuite.html#loc_69_7_69_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_69_7_69_17&#39;)"><span class="hl_varref"><span class="mpre">optionName</span></span></a><span class="mpre"> </span><a href="#loc_535_24_535_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_24_535_27&#39;)"><span class="hl_varref"><span class="mpre">opt</span></span></a><span class="mpre">, </span><a href="#loc_536_25_536_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_25_536_26&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.TestSuite.html#loc_73_7_73_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_73_7_73_20&#39;)"><span class="hl_varref"><span class="mpre">optionDefault</span></span></a><span class="mpre"> </span><a href="#loc_535_24_535_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_24_535_27&#39;)"><span class="hl_varref"><span class="mpre">opt</span></span></a><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">defaultOptions</span></span><span class="mpre"> </span><a name="loc_537_20_537_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_537_20_537_28&#39;)"><span class="hl_vardecl"><span class="mpre">testInst</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_123_1_123_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_123_1_123_9&#39;)"><span class="hl_varref"><span class="mpre">mapMaybe</span></span></a><span class="mpre"> </span><a href="#loc_535_5_535_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_5_535_23&#39;)"><span class="hl_varref"><span class="mpre">maybeDefaultOption</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Distribution.TestSuite.html#loc_59_7_59_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.TestSuite.html#loc_59_7_59_14&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre"> </span><a href="#loc_537_20_537_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_537_20_537_28&#39;)"><span class="hl_varref"><span class="mpre">testInst</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | From a test stub, write the &#39;TestSuiteLog&#39; to temporary file for the calling</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Cabal process to read.</span></span><span class="mpre">
</span><a href="#loc_542_1_542_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_1_542_13&#39;)"><span class="mpre">stubWriteLog</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_122_6_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_6_122_14&#39;)"><span class="hl_tyconref"><span class="mpre">TestLogs</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_542_1_542_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_1_542_13&#39;)"><span class="hl_fundecl"><span class="mpre">stubWriteLog</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">n</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">logs</span></span><span class="mpre"> = do
    let </span><a name="loc_543_9_543_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_9_543_16&#39;)"><span class="hl_vardecl"><span class="mpre">testLog</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 543, srcSpanStartColumn = 19, srcSpanEndLine = 543, srcSpanEndColumn = 83}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Test.hs&quot;, srcSpanStartLine = 543, srcSpanStartColumn = 32, srcSpanEndLine = 543, srcSpanEndColumn = 33},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple"><span class="mpre">TestSuiteLog { testSuiteName = n, testLogs = logs, logFile = f }</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">writeFile</span></span><span class="mpre"> (</span><a href="#loc_118_7_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_7_118_14&#39;)"><span class="hl_varref"><span class="mpre">logFile</span></span></a><span class="mpre"> </span><a href="#loc_543_9_543_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_9_543_16&#39;)"><span class="hl_varref"><span class="mpre">testLog</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_543_9_543_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_9_543_16&#39;)"><span class="hl_varref"><span class="mpre">testLog</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_161_1_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_11&#39;)"><span class="hl_varref"><span class="mpre">suiteError</span></span></a><span class="mpre"> </span><a href="#loc_543_9_543_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_9_543_16&#39;)"><span class="hl_varref"><span class="mpre">testLog</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.Exit.html#loc_60_1_60_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Exit.html#loc_60_1_60_9&#39;)"><span class="hl_varref"><span class="mpre">exitWith</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ExitFailure</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_154_1_154_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_12&#39;)"><span class="hl_varref"><span class="mpre">suiteFailed</span></span></a><span class="mpre"> </span><a href="#loc_543_9_543_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_9_543_16&#39;)"><span class="hl_varref"><span class="mpre">testLog</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.Exit.html#loc_60_1_60_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Exit.html#loc_60_1_60_9&#39;)"><span class="hl_varref"><span class="mpre">exitWith</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ExitFailure</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    </span><a href="System.Exit.html#loc_60_1_60_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Exit.html#loc_60_1_60_9&#39;)"><span class="hl_varref"><span class="mpre">exitWith</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ExitSuccess</span></span><span class="mpre">
</span></div></body></html>