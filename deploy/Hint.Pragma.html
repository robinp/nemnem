<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">{-
    Suggest better pragmas
    OPTIONS_GHC -cpp =&gt; LANGUAGE CPP
    OPTIONS_GHC -fglasgow-exts =&gt; LANGUAGE ... (in HSE)
    OPTIONS_GHC -XFoo =&gt; LANGUAGE Foo
    LANGUAGE A, A =&gt; LANGUAGE A
    -- do not do LANGUAGE A, LANGUAGE B to combine
&lt;TEST&gt;
{-# OPTIONS_GHC -cpp #-} -- {-# LANGUAGE CPP #-}
{-# OPTIONS     -cpp #-} -- {-# LANGUAGE CPP #-}
{-# OPTIONS_YHC -cpp #-}
{-# OPTIONS_GHC -XFoo #-} -- {-# LANGUAGE Foo #-}
{-# OPTIONS_GHC -fglasgow-exts #-} -- ???
{-# LANGUAGE A, B, C, A #-} -- {-# LANGUAGE A, B, C #-}
{-# LANGUAGE A #-}
{-# OPTIONS_GHC -cpp -foo #-} -- {-# LANGUAGE CPP #-} {-# OPTIONS_GHC -foo #-}
{-# OPTIONS_GHC -cpp #-} \
{-# LANGUAGE CPP, Text #-} --
{-# LANGUAGE A #-} \
{-# LANGUAGE B #-}
{-# LANGUAGE A #-} \
{-# LANGUAGE B, A #-} -- {-# LANGUAGE A, B #-}
&lt;/TEST&gt;
-}</span></span><span class="mpre">


module Hint.Pragma(pragmaHint) where

import Hint.Type
import Data.List
import Data.Maybe
import Util


</span><a href="#loc_36_1_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_11&#39;)"><span class="mpre">pragmaHint</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ModuHint</span></span><span class="mpre">
</span><a name="loc_36_1_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_11&#39;)"><span class="hl_fundecl"><span class="mpre">pragmaHint</span></span></a><span class="mpre"> _ </span><a name="loc_36_14_36_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_14_36_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_49_1_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_14&#39;)"><span class="hl_varref"><span class="mpre">languageDupes</span></span></a><span class="mpre"> </span><a href="#loc_38_9_38_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_13&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_44_1_44_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_11&#39;)"><span class="hl_varref"><span class="mpre">pragmaIdea</span></span></a><span class="mpre"> </span><a href="#loc_39_10_39_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_10_39_13&#39;)"><span class="hl_varref"><span class="mpre">old</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">LanguagePragma</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">an</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toNamed</span></span><span class="mpre"> </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_varref"><span class="mpre">ns2</span></span></a><span class="mpre">) | </span><a href="#loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_varref"><span class="mpre">ns2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> []] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_115_1_115_10&#39;)"><span class="hl_varref"><span class="mpre">catMaybes</span></span></a><span class="mpre"> </span><a href="#loc_39_14_39_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_14_39_17&#39;)"><span class="hl_varref"><span class="mpre">new</span></span></a><span class="mpre"> | </span><a href="#loc_39_10_39_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_10_39_13&#39;)"><span class="hl_varref"><span class="mpre">old</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> []]
    where
        </span><a name="loc_38_9_38_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_13&#39;)"><span class="hl_vardecl"><span class="mpre">lang</span></span></a><span class="mpre"> = [</span><a href="#loc_38_21_38_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a name="loc_38_21_38_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_22&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Pragma.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 23, srcSpanEndLine = 38, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Pragma.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 37, srcSpanEndLine = 38, srcSpanEndColumn = 38},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Hint/Pragma.hs&quot;, srcSpanStartLine = 38, srcSpanStartColum"><span class="mpre">LanguagePragma{}</span></span><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">modulePragmas</span></span><span class="mpre"> </span><a href="#loc_36_14_36_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_14_36_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]
        (</span><a name="loc_39_10_39_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_10_39_13&#39;)"><span class="hl_vardecl"><span class="mpre">old</span></span></a><span class="mpre">,</span><a name="loc_39_14_39_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_14_39_17&#39;)"><span class="hl_vardecl"><span class="mpre">new</span></span></a><span class="mpre">,</span><a name="loc_39_18_39_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_18_39_20&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">unzip3</span></span><span class="mpre"> [(</span><a href="#loc_39_47_39_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_47_39_50&#39;)"><span class="hl_varref"><span class="mpre">old</span></span></a><span class="mpre">,</span><a href="#loc_39_77_39_80" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_77_39_80&#39;)"><span class="hl_varref"><span class="mpre">new</span></span></a><span class="mpre">,</span><a href="#loc_39_81_39_83" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_81_39_83&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">) | </span><a name="loc_39_47_39_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_47_39_50&#39;)"><span class="hl_vardecl"><span class="mpre">old</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">modulePragmas</span></span><span class="mpre"> </span><a href="#loc_36_14_36_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_14_36_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_39_77_39_80" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_77_39_80&#39;)"><span class="hl_vardecl"><span class="mpre">new</span></span></a><span class="mpre">,</span><a name="loc_39_81_39_83" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_81_39_83&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre">) &lt;- [</span><a href="#loc_66_1_66_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_14&#39;)"><span class="hl_varref"><span class="mpre">optToLanguage</span></span></a><span class="mpre"> </span><a href="#loc_39_47_39_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_47_39_50&#39;)"><span class="hl_varref"><span class="mpre">old</span></span></a><span class="mpre">]]
        </span><a name="loc_40_9_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_12&#39;)"><span class="hl_vardecl"><span class="mpre">ns2</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_314_1_314_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_314_1_314_4&#39;)"><span class="hl_varref"><span class="mpre">nub</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_39_18_39_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_18_39_20&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">) </span><a href="Data.List.html#loc_378_1_378_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_378_1_378_5&#39;)"><span class="hl_infix"><span class="mpre">\\</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> [</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromNamed</span></span><span class="mpre"> </span><a href="#loc_40_77_40_78" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_77_40_78&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> | </span><span class="hl_conref"><span class="mpre">LanguagePragma</span></span><span class="mpre"> _ </span><a name="loc_40_77_40_78" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_77_40_78&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_38_9_38_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_13&#39;)"><span class="hl_varref"><span class="mpre">lang</span></span></a><span class="mpre">]


</span><a href="#loc_44_1_44_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_11&#39;)"><span class="mpre">pragmaIdea</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">ModulePragma</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">ModulePragma</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Idea</span></span><span class="mpre">
</span><a name="loc_44_1_44_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_11&#39;)"><span class="hl_fundecl"><span class="mpre">pragmaIdea</span></span></a><span class="mpre"> </span><a name="loc_44_12_44_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_12_44_14&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_44_15_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_15_44_17&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">rawIdea</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Use better pragmas&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toSrcSpan</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ann</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_44_12_44_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_12_44_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) (</span><a href="#loc_45_11_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_11_45_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_44_12_44_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_12_44_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_45_11_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_11_45_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_44_15_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_15_44_17&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">) []
    where </span><a name="loc_45_11_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_11_45_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_1060_1_1060_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1060_1_1060_8&#39;)"><span class="hl_varref"><span class="mpre">unlines</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">prettyPrint</span></span><span class="mpre">


</span><a href="#loc_49_1_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_14&#39;)"><span class="mpre">languageDupes</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">ModulePragma</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Idea</span></span><span class="mpre">]
</span><a name="loc_49_1_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_14&#39;)"><span class="hl_fundecl"><span class="mpre">languageDupes</span></span></a><span class="mpre"> [] = []
</span><a href="#loc_49_1_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_14&#39;)"><span class="hl_fundecl"><span class="mpre">languageDupes</span></span></a><span class="mpre"> (</span><a name="loc_50_16_50_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_16_50_17&#39;)"><span class="hl_specname"><span class="mpre">a</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">LanguagePragma</span></span><span class="mpre"> _ </span><a name="loc_50_36_50_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_36_50_37&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_50_39_50_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_39_50_41&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) =
    (if </span><span class="hl_varref"><span class="mpre">nub_</span></span><span class="mpre"> </span><a href="#loc_50_36_50_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_36_50_37&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`neqList`</span></span><span class="mpre"> </span><a href="#loc_50_36_50_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_36_50_37&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        then [</span><a href="#loc_44_1_44_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_11&#39;)"><span class="hl_varref"><span class="mpre">pragmaIdea</span></span></a><span class="mpre"> [</span><a href="#loc_50_16_50_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_16_50_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">] [</span><span class="hl_conref"><span class="mpre">LanguagePragma</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">an</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nub_</span></span><span class="mpre"> </span><a href="#loc_50_36_50_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_36_50_37&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]]
        else [</span><a href="#loc_44_1_44_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_11&#39;)"><span class="hl_varref"><span class="mpre">pragmaIdea</span></span></a><span class="mpre"> [</span><a href="#loc_50_16_50_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_16_50_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_53_70_53_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_70_53_71&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">] [</span><span class="hl_conref"><span class="mpre">LanguagePragma</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">an</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">nub_</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_50_36_50_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_36_50_37&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_53_90_53_91" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_90_53_91&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)] | </span><a name="loc_53_70_53_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_70_53_71&#39;)"><span class="hl_specname"><span class="mpre">b</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">LanguagePragma</span></span><span class="mpre"> _ </span><a name="loc_53_90_53_91" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_90_53_91&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_50_39_50_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_39_50_41&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">, </span><a href="Util.html#loc_64_1_64_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Util.html#loc_64_1_64_8&#39;)"><span class="hl_varref"><span class="mpre">notNull</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">intersect_</span></span><span class="mpre"> </span><a href="#loc_50_36_50_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_36_50_37&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_53_90_53_91" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_90_53_91&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">]) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
    </span><a href="#loc_49_1_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_14&#39;)"><span class="hl_varref"><span class="mpre">languageDupes</span></span></a><span class="mpre"> </span><a href="#loc_50_39_50_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_39_50_41&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Given a pragma, can you extract some language features out</span></span><span class="mpre">
</span><a href="#loc_59_1_59_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_14&#39;)"><span class="mpre">strToLanguage</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
</span><a name="loc_59_1_59_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_14&#39;)"><span class="hl_fundecl"><span class="mpre">strToLanguage</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;-cpp&quot;</span></span><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;CPP&quot;</span></span><span class="mpre">]
</span><a href="#loc_59_1_59_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_14&#39;)"><span class="hl_fundecl"><span class="mpre">strToLanguage</span></span></a><span class="mpre"> </span><a name="loc_60_15_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_15_60_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><span class="hl_string"><span class="mpre">&quot;-X&quot;</span></span><span class="mpre"> </span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="hl_infix"><span class="mpre">`isPrefixOf`</span></span></a><span class="mpre"> </span><a href="#loc_60_15_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_15_60_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> [</span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><a href="#loc_60_15_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_15_60_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]
</span><a href="#loc_59_1_59_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_14&#39;)"><span class="hl_fundecl"><span class="mpre">strToLanguage</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;-fglasgow-exts&quot;</span></span><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">glasgowExts</span></span><span class="mpre">
</span><a href="#loc_59_1_59_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_14&#39;)"><span class="hl_fundecl"><span class="mpre">strToLanguage</span></span></a><span class="mpre"> _ = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">


</span><a href="#loc_66_1_66_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_14&#39;)"><span class="mpre">optToLanguage</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ModulePragma</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ModulePragma</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S</span></span><span class="mpre">), [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">])
</span><a name="loc_66_1_66_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_14&#39;)"><span class="hl_fundecl"><span class="mpre">optToLanguage</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">OptionsPragma</span></span><span class="mpre"> </span><a name="loc_66_30_66_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_30_66_32&#39;)"><span class="hl_vardecl"><span class="mpre">sl</span></span></a><span class="mpre"> </span><a name="loc_66_33_66_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_33_66_37&#39;)"><span class="hl_vardecl"><span class="mpre">tool</span></span></a><span class="mpre"> </span><a name="loc_66_38_66_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_38_66_41&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre">)
    | </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">GHC</span></span><span class="mpre">) </span><a href="#loc_66_33_66_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_33_66_37&#39;)"><span class="hl_varref"><span class="mpre">tool</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">any</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> </span><a href="#loc_70_9_70_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_11&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="#loc_72_9_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_12&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_115_1_115_10&#39;)"><span class="hl_varref"><span class="mpre">catMaybes</span></span></a><span class="mpre"> </span><a href="#loc_70_9_70_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_11&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">)
    where
        </span><a name="loc_69_9_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_13&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_1071_1_1071_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1071_1_1071_6&#39;)"><span class="hl_varref"><span class="mpre">words</span></span></a><span class="mpre"> </span><a href="#loc_66_38_66_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_38_66_41&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre">
        </span><a name="loc_70_9_70_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_11&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_59_1_59_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_14&#39;)"><span class="hl_varref"><span class="mpre">strToLanguage</span></span></a><span class="mpre"> </span><a href="#loc_69_9_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_13&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">
        </span><a name="loc_71_9_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_13&#39;)"><span class="hl_vardecl"><span class="mpre">keep</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">zipWith</span></span><span class="mpre"> (\</span><a name="loc_71_35_71_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_35_71_36&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_71_37_71_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_37_71_38&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_71_37_71_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_37_71_38&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> | </span><a href="Data.Maybe.html#loc_85_1_85_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_85_1_85_10&#39;)"><span class="hl_varref"><span class="mpre">isNothing</span></span></a><span class="mpre"> </span><a href="#loc_71_35_71_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_35_71_36&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">]) </span><a href="#loc_70_9_70_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_11&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre"> </span><a href="#loc_69_9_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_13&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">
        </span><a name="loc_72_9_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_12&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_71_9_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_13&#39;)"><span class="hl_varref"><span class="mpre">keep</span></span></a><span class="mpre"> then </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> else </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">OptionsPragma</span></span><span class="mpre"> </span><a href="#loc_66_30_66_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_30_66_32&#39;)"><span class="hl_varref"><span class="mpre">sl</span></span></a><span class="mpre"> </span><a href="#loc_66_33_66_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_33_66_37&#39;)"><span class="hl_varref"><span class="mpre">tool</span></span></a><span class="mpre"> (</span><a href="Data.List.html#loc_1081_1_1081_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1081_1_1081_8&#39;)"><span class="hl_varref"><span class="mpre">unwords</span></span></a><span class="mpre"> </span><a href="#loc_71_9_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_13&#39;)"><span class="hl_varref"><span class="mpre">keep</span></span></a><span class="mpre">)
</span><a href="#loc_66_1_66_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_14&#39;)"><span class="hl_fundecl"><span class="mpre">optToLanguage</span></span></a><span class="mpre"> _ = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
</span></div></body></html>