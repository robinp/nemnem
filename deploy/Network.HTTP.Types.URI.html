<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
module Network.HTTP.Types.URI
(
  </span><span class="hl_comment"><span class="mpre">-- * Query string</span></span><span class="mpre">
  QueryItem
, Query
, SimpleQueryItem
, SimpleQuery
, simpleQueryToQuery
, renderQuery
, renderQueryBuilder
, renderSimpleQuery
, parseQuery
, parseSimpleQuery
  </span><span class="hl_comment"><span class="mpre">-- ** Text query string (UTF8 encoded)</span></span><span class="mpre">
, QueryText
, queryTextToQuery
, queryToQueryText
, renderQueryText
, parseQueryText
  </span><span class="hl_comment"><span class="mpre">-- * Path segments</span></span><span class="mpre">
, encodePathSegments
, decodePathSegments
, encodePathSegmentsRelative
  </span><span class="hl_comment"><span class="mpre">-- * Path (segments + query string)</span></span><span class="mpre">
, extractPath
, encodePath
, decodePath
  </span><span class="hl_comment"><span class="mpre">-- * URL encoding / decoding</span></span><span class="mpre">
, urlEncodeBuilder
, urlEncode
, urlDecode
)
where

import           Control.Arrow
import           Data.Bits
import           Data.Char
import           Data.List
import           Data.Maybe
import           Data.Monoid
import           Data.Text                      (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="mpre">Text</span></a><span class="mpre">)
import           Data.Text.Encoding             (</span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="mpre">encodeUtf8</span></a><span class="mpre">, </span><a href="Data.Text.Encoding.html#loc_142_1_142_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_142_1_142_15&#39;)"><span class="mpre">decodeUtf8With</span></a><span class="mpre">)
import           Data.Text.Encoding.Error       (</span><a href="Data.Text.Encoding.Error.html#loc_107_1_107_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.Error.html#loc_107_1_107_14&#39;)"><span class="mpre">lenientDecode</span></a><span class="mpre">)
import           Data.Word
import qualified Blaze.ByteString.Builder       as Blaze
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 18, srcSpanEndLine = 47, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">                as B
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs&quot;, srcSpanStartLine = 48, srcSpanStartColumn = 18, srcSpanEndLine = 48, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre">          () </span><span class="hl_comment"><span class="mpre">{-IsString-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Query item</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 1, srcSpanEndLine = 51, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 1, srcSpanEndLine = 51, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs"><span class="mpre">type QueryItem = (B.ByteString, Maybe B.ByteString)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Query.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- General form: a=b&amp;c=d, but if the value is Nothing, it becomes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a&amp;c=d.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 1, srcSpanEndLine = 57, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 1, srcSpanEndLine = 57, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs"><span class="mpre">type Query = [QueryItem]</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like Query, but with &#39;Text&#39; instead of &#39;B.ByteString&#39; (UTF8-encoded).</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs&quot;, srcSpanStartLine = 60, srcSpanStartColumn = 1, srcSpanEndLine = 60, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs&quot;, srcSpanStartLine = 60, srcSpanStartColumn = 1, srcSpanEndLine = 60, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs"><span class="mpre">type QueryText = [(Text, Maybe Text)]</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert &#39;QueryText&#39; to &#39;Query&#39;.</span></span><span class="mpre">
</span><a href="#loc_64_1_64_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_17&#39;)"><span class="mpre">queryTextToQuery</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">QueryText</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Query</span></span><span class="mpre">
</span><a name="loc_64_1_64_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_17&#39;)"><span class="hl_vardecl"><span class="mpre">queryTextToQuery</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">encodeUtf8</span></span></a><span class="mpre"> </span><a href="Control.Arrow.html#loc_107_5_107_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_107_5_107_10&#39;)"><span class="hl_infix"><span class="mpre">***</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">encodeUtf8</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert &#39;QueryText&#39; to a &#39;Blaze.Builder&#39;.</span></span><span class="mpre">
</span><a href="#loc_70_1_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_16&#39;)"><span class="mpre">renderQueryText</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ prepend a question mark?</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">QueryText</span></span><span class="mpre">
                -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Blaze.Builder</span></span></a><span class="mpre">
</span><a name="loc_70_1_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_16&#39;)"><span class="hl_fundecl"><span class="mpre">renderQueryText</span></span></a><span class="mpre"> </span><a name="loc_70_17_70_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_17_70_18&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_97_1_97_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_19&#39;)"><span class="hl_varref"><span class="mpre">renderQueryBuilder</span></span></a><span class="mpre"> </span><a href="#loc_70_17_70_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_17_70_18&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_64_1_64_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_17&#39;)"><span class="hl_varref"><span class="mpre">queryTextToQuery</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert &#39;Query&#39; to &#39;QueryText&#39; (leniently decoding the UTF-8).</span></span><span class="mpre">
</span><a href="#loc_74_1_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_17&#39;)"><span class="mpre">queryToQueryText</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Query</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">QueryText</span></span><span class="mpre">
</span><a name="loc_74_1_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_17&#39;)"><span class="hl_vardecl"><span class="mpre">queryToQueryText</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_77_5_77_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="Control.Arrow.html#loc_107_5_107_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_107_5_107_10&#39;)"><span class="hl_infix"><span class="mpre">***</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_77_5_77_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
    </span><a name="loc_77_5_77_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_7&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre"> = </span><a href="Data.Text.Encoding.html#loc_142_1_142_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_142_1_142_15&#39;)"><span class="hl_varref"><span class="mpre">decodeUtf8With</span></span></a><span class="mpre"> </span><a href="Data.Text.Encoding.Error.html#loc_107_1_107_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.Error.html#loc_107_1_107_14&#39;)"><span class="hl_varref"><span class="mpre">lenientDecode</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Parse &#39;QueryText&#39; from a &#39;B.ByteString&#39;. See &#39;parseQuery&#39; for details.</span></span><span class="mpre">
</span><a href="#loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="mpre">parseQueryText</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">QueryText</span></span><span class="mpre">
</span><a name="loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="hl_vardecl"><span class="mpre">parseQueryText</span></span></a><span class="mpre"> = </span><a href="#loc_74_1_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_17&#39;)"><span class="hl_varref"><span class="mpre">queryToQueryText</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_134_1_134_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_11&#39;)"><span class="hl_varref"><span class="mpre">parseQuery</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Simplified Query item type without support for parameter-less items.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 1, srcSpanEndLine = 84, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 1, srcSpanEndLine = 84, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs"><span class="mpre">type SimpleQueryItem = (B.ByteString, B.ByteString)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Simplified Query type without support for parameter-less items.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 1, srcSpanEndLine = 87, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 1, srcSpanEndLine = 87, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-types-0.8.5/Network/HTTP/Types/URI.hs"><span class="mpre">type SimpleQuery = [SimpleQueryItem]</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert &#39;SimpleQuery&#39; to &#39;Query&#39;.</span></span><span class="mpre">
</span><a href="#loc_91_1_91_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_19&#39;)"><span class="mpre">simpleQueryToQuery</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">SimpleQuery</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Query</span></span><span class="mpre">
</span><a name="loc_91_1_91_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_19&#39;)"><span class="hl_vardecl"><span class="mpre">simpleQueryToQuery</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(</span><a name="loc_91_29_91_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_29_91_30&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_91_32_91_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_32_91_33&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_91_29_91_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_29_91_30&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_91_32_91_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_32_91_33&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | Convert &#39;Query&#39; to a &#39;Builder&#39;.</span></span><span class="mpre">
</span><a href="#loc_97_1_97_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_19&#39;)"><span class="mpre">renderQueryBuilder</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ prepend a question mark?</span></span><span class="mpre">
                   -&gt; </span><span class="hl_tyconref"><span class="mpre">Query</span></span><span class="mpre">
                   -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Blaze.Builder</span></span></a><span class="mpre">
</span><a name="loc_97_1_97_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_19&#39;)"><span class="hl_fundecl"><span class="mpre">renderQueryBuilder</span></span></a><span class="mpre"> _ [] = </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- FIXME replace mconcat + map with foldr</span></span><span class="mpre">
</span><a href="#loc_97_1_97_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_19&#39;)"><span class="hl_fundecl"><span class="mpre">renderQueryBuilder</span></span></a><span class="mpre"> </span><a name="loc_99_20_99_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_20_99_26&#39;)"><span class="hl_vardecl"><span class="mpre">qmark&#39;</span></span></a><span class="mpre"> (</span><a name="loc_99_28_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_28_99_29&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_99_30_99_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_30_99_32&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">) = </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre">
    </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_106_5_106_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_5_106_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (if </span><a href="#loc_99_20_99_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_20_99_26&#39;)"><span class="hl_varref"><span class="mpre">qmark&#39;</span></span></a><span class="mpre"> then </span><a href="#loc_103_5_103_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_10&#39;)"><span class="hl_varref"><span class="mpre">qmark</span></span></a><span class="mpre"> else </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">) </span><a href="#loc_99_28_99_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_28_99_29&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_106_5_106_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_5_106_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_104_5_104_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_8&#39;)"><span class="hl_varref"><span class="mpre">amp</span></span></a><span class="mpre">) </span><a href="#loc_99_30_99_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_30_99_32&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">
  where
    </span><a name="loc_103_5_103_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_10&#39;)"><span class="hl_vardecl"><span class="mpre">qmark</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">Blaze.copyByteString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;?&quot;</span></span><span class="mpre">
    </span><a name="loc_104_5_104_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_8&#39;)"><span class="hl_vardecl"><span class="mpre">amp</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">Blaze.copyByteString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&amp;&quot;</span></span><span class="mpre">
    </span><a name="loc_105_5_105_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_10&#39;)"><span class="hl_vardecl"><span class="mpre">equal</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">Blaze.copyByteString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;=&quot;</span></span><span class="mpre">
    </span><a name="loc_106_5_106_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_5_106_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_106_8_106_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_8_106_11&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre"> (</span><a name="loc_106_13_106_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_13_106_14&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">, </span><a name="loc_106_16_106_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_16_106_18&#39;)"><span class="hl_vardecl"><span class="mpre">mv</span></span></a><span class="mpre">) = </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> [
                      </span><a href="#loc_106_8_106_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_8_106_11&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre">
                     , </span><a href="#loc_195_1_195_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_17&#39;)"><span class="hl_varref"><span class="mpre">urlEncodeBuilder</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_106_13_106_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_13_106_14&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
                     , case </span><a href="#loc_106_16_106_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_16_106_18&#39;)"><span class="hl_varref"><span class="mpre">mv</span></span></a><span class="mpre"> of
                         </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
                         </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_111_31_111_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_31_111_32&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_105_5_105_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_10&#39;)"><span class="hl_varref"><span class="mpre">equal</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_195_1_195_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_17&#39;)"><span class="hl_varref"><span class="mpre">urlEncodeBuilder</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_111_31_111_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_31_111_32&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
                     ]

</span><span class="hl_comment"><span class="mpre">-- | Convert &#39;Query&#39; to &#39;ByteString&#39;.</span></span><span class="mpre">
</span><a href="#loc_117_1_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_12&#39;)"><span class="mpre">renderQuery</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ prepend question mark?</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">Query</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_117_1_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_12&#39;)"><span class="hl_fundecl"><span class="mpre">renderQuery</span></span></a><span class="mpre"> </span><a name="loc_117_13_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_13_117_15&#39;)"><span class="hl_vardecl"><span class="mpre">qm</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.html#loc_299_1_299_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_299_1_299_13&#39;)"><span class="hl_varref"><span class="mpre">Blaze.toByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_97_1_97_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_19&#39;)"><span class="hl_varref"><span class="mpre">renderQueryBuilder</span></span></a><span class="mpre"> </span><a href="#loc_117_13_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_13_117_15&#39;)"><span class="hl_varref"><span class="mpre">qm</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert &#39;SimpleQuery&#39; to &#39;ByteString&#39;.</span></span><span class="mpre">
</span><a href="#loc_122_1_122_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_18&#39;)"><span class="mpre">renderSimpleQuery</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ prepend question mark?</span></span><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">SimpleQuery</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_122_1_122_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_18&#39;)"><span class="hl_fundecl"><span class="mpre">renderSimpleQuery</span></span></a><span class="mpre"> </span><a name="loc_122_19_122_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_19_122_34&#39;)"><span class="hl_vardecl"><span class="mpre">useQuestionMark</span></span></a><span class="mpre"> = </span><a href="#loc_117_1_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_12&#39;)"><span class="hl_varref"><span class="mpre">renderQuery</span></span></a><span class="mpre"> </span><a href="#loc_122_19_122_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_19_122_34&#39;)"><span class="hl_varref"><span class="mpre">useQuestionMark</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_91_1_91_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_19&#39;)"><span class="hl_varref"><span class="mpre">simpleQueryToQuery</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Split out the query string into a list of keys and values. A few</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- importants points:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * The result returned is still bytestrings, since we perform no character</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- decoding here. Most likely, you will want to use UTF-8 decoding, but this is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- left to the user of the library.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Percent decoding errors are ignored. In particular, &quot;%Q&quot; will be output as</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;%Q&quot;.</span></span><span class="mpre">
</span><a href="#loc_134_1_134_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_11&#39;)"><span class="mpre">parseQuery</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Query</span></span><span class="mpre">
</span><a name="loc_134_1_134_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_11&#39;)"><span class="hl_vardecl"><span class="mpre">parseQuery</span></span></a><span class="mpre"> = </span><a href="#loc_140_5_140_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_5_140_22&#39;)"><span class="hl_varref"><span class="mpre">parseQueryString&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_136_5_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_5_136_17&#39;)"><span class="hl_varref"><span class="mpre">dropQuestion</span></span></a><span class="mpre">
  where
    </span><a name="loc_136_5_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_5_136_17&#39;)"><span class="hl_fundecl"><span class="mpre">dropQuestion</span></span></a><span class="mpre"> </span><a name="loc_136_18_136_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_18_136_19&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> =
        case </span><span class="hl_varref"><span class="mpre">B.uncons</span></span><span class="mpre"> </span><a href="#loc_136_18_136_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_18_136_19&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">63</span></span><span class="mpre">, </span><a name="loc_138_23_138_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_23_138_25&#39;)"><span class="hl_vardecl"><span class="mpre">q&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_138_23_138_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_23_138_25&#39;)"><span class="hl_varref"><span class="mpre">q&#39;</span></span></a><span class="mpre">
            _ -&gt; </span><a href="#loc_136_18_136_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_18_136_19&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
    </span><a name="loc_140_5_140_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_5_140_22&#39;)"><span class="hl_fundecl"><span class="mpre">parseQueryString&#39;</span></span></a><span class="mpre"> </span><a name="loc_140_23_140_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_23_140_24&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_140_23_140_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_23_140_24&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> = []
    </span><a href="#loc_140_5_140_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_5_140_22&#39;)"><span class="hl_fundecl"><span class="mpre">parseQueryString&#39;</span></span></a><span class="mpre"> </span><a name="loc_141_23_141_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_23_141_24&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> =
        let (</span><a name="loc_142_14_142_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_14_142_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_142_17_142_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_17_142_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_159_1_159_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_13&#39;)"><span class="hl_varref"><span class="mpre">breakDiscard</span></span></a><span class="mpre"> </span><a href="#loc_154_1_154_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_22&#39;)"><span class="hl_varref"><span class="mpre">queryStringSeparators</span></span></a><span class="mpre"> </span><a href="#loc_141_23_141_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_23_141_24&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
         in </span><a href="#loc_145_9_145_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_18&#39;)"><span class="hl_varref"><span class="mpre">parsePair</span></span></a><span class="mpre"> </span><a href="#loc_142_14_142_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_14_142_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_140_5_140_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_5_140_22&#39;)"><span class="hl_varref"><span class="mpre">parseQueryString&#39;</span></span></a><span class="mpre"> </span><a href="#loc_142_17_142_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_17_142_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
      where
        </span><a name="loc_145_9_145_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_18&#39;)"><span class="hl_fundecl"><span class="mpre">parsePair</span></span></a><span class="mpre"> </span><a name="loc_145_19_145_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_19_145_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> =
            let (</span><a name="loc_146_18_146_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_19&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">, </span><a name="loc_146_21_146_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_21_146_22&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.breakByte</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">61</span></span><span class="mpre"> </span><a href="#loc_145_19_145_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_19_145_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- equal sign</span></span><span class="mpre">
                </span><a name="loc_147_17_147_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_17_147_20&#39;)"><span class="hl_vardecl"><span class="mpre">v&#39;&#39;</span></span></a><span class="mpre"> =
                    case </span><span class="hl_varref"><span class="mpre">B.uncons</span></span><span class="mpre"> </span><a href="#loc_146_21_146_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_21_146_22&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> of
                        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (_, </span><a name="loc_149_34_149_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_34_149_36&#39;)"><span class="hl_vardecl"><span class="mpre">v&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_205_1_205_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_10&#39;)"><span class="hl_varref"><span class="mpre">urlDecode</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_149_34_149_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_34_149_36&#39;)"><span class="hl_varref"><span class="mpre">v&#39;</span></span></a><span class="mpre">
                        _ -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
             in (</span><a href="#loc_205_1_205_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_10&#39;)"><span class="hl_varref"><span class="mpre">urlDecode</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_146_18_146_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_19&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">, </span><a href="#loc_147_17_147_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_17_147_20&#39;)"><span class="hl_varref"><span class="mpre">v&#39;&#39;</span></span></a><span class="mpre">)

</span><a href="#loc_154_1_154_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_22&#39;)"><span class="mpre">queryStringSeparators</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_154_1_154_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_22&#39;)"><span class="hl_vardecl"><span class="mpre">queryStringSeparators</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> [</span><span class="hl_num"><span class="mpre">38</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ampersand, semicolon</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Break the second bytestring at the first occurence of any bytes from</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the first bytestring, discarding that byte.</span></span><span class="mpre">
</span><a href="#loc_159_1_159_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_13&#39;)"><span class="mpre">breakDiscard</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
</span><a name="loc_159_1_159_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_13&#39;)"><span class="hl_fundecl"><span class="mpre">breakDiscard</span></span></a><span class="mpre"> </span><a name="loc_159_14_159_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_14_159_18&#39;)"><span class="hl_vardecl"><span class="mpre">seps</span></span></a><span class="mpre"> </span><a name="loc_159_19_159_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_19_159_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
    let (</span><a name="loc_160_10_160_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_10_160_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_160_13_160_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_13_160_14&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`B.elem`</span></span><span class="mpre"> </span><a href="#loc_159_14_159_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_14_159_18&#39;)"><span class="hl_varref"><span class="mpre">seps</span></span></a><span class="mpre">) </span><a href="#loc_159_19_159_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_19_159_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
     in (</span><a href="#loc_160_10_160_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_10_160_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_160_13_160_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_13_160_14&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Parse &#39;SimpleQuery&#39; from a &#39;ByteString&#39;.</span></span><span class="mpre">
</span><a href="#loc_165_1_165_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_17&#39;)"><span class="mpre">parseSimpleQuery</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">SimpleQuery</span></span><span class="mpre">
</span><a name="loc_165_1_165_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_17&#39;)"><span class="hl_vardecl"><span class="mpre">parseSimpleQuery</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Control.Arrow.html#loc_96_5_96_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_96_5_96_11&#39;)"><span class="hl_varref"><span class="mpre">second</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_134_1_134_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_11&#39;)"><span class="hl_varref"><span class="mpre">parseQuery</span></span></a><span class="mpre">

</span><a href="#loc_168_1_168_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_5&#39;)"><span class="mpre">ord8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
</span><a name="loc_168_1_168_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_5&#39;)"><span class="hl_vardecl"><span class="mpre">ord8</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre">

</span><a href="#loc_171_1_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_13&#39;)"><span class="mpre">unreservedQS</span></a><span class="mpre">, </span><a href="#loc_172_1_172_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_1_172_13&#39;)"><span class="mpre">unreservedPI</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_171_1_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_13&#39;)"><span class="hl_vardecl"><span class="mpre">unreservedQS</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_168_1_168_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_5&#39;)"><span class="hl_varref"><span class="mpre">ord8</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;-_.~&quot;</span></span><span class="mpre">
</span><a name="loc_172_1_172_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_1_172_13&#39;)"><span class="hl_vardecl"><span class="mpre">unreservedPI</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_168_1_168_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_5&#39;)"><span class="hl_varref"><span class="mpre">ord8</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;-_.~:@&amp;=+$,&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Percent-encoding for URLs.</span></span><span class="mpre">
</span><a href="#loc_176_1_176_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_18&#39;)"><span class="mpre">urlEncodeBuilder&#39;</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Blaze.Builder</span></span></a><span class="mpre">
</span><a name="loc_176_1_176_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_18&#39;)"><span class="hl_fundecl"><span class="mpre">urlEncodeBuilder&#39;</span></span></a><span class="mpre"> </span><a name="loc_176_19_176_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_19_176_34&#39;)"><span class="hl_vardecl"><span class="mpre">extraUnreserved</span></span></a><span class="mpre"> = </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_178_7_178_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_7_178_17&#39;)"><span class="hl_varref"><span class="mpre">encodeChar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.unpack</span></span><span class="mpre">
    where
      </span><a name="loc_178_7_178_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_7_178_17&#39;)"><span class="hl_fundecl"><span class="mpre">encodeChar</span></span></a><span class="mpre"> </span><a name="loc_178_18_178_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_18_178_20&#39;)"><span class="hl_vardecl"><span class="mpre">ch</span></span></a><span class="mpre"> | </span><a href="#loc_181_7_181_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_7_181_17&#39;)"><span class="hl_varref"><span class="mpre">unreserved</span></span></a><span class="mpre"> </span><a href="#loc_178_18_178_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_18_178_20&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Word.html#loc_269_1_269_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Word.html#loc_269_1_269_10&#39;)"><span class="hl_varref"><span class="mpre">Blaze.fromWord8</span></span></a><span class="mpre"> </span><a href="#loc_178_18_178_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_18_178_20&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre">
                    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><a href="#loc_186_7_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_7_186_9&#39;)"><span class="hl_varref"><span class="mpre">h2</span></span></a><span class="mpre"> </span><a href="#loc_178_18_178_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_18_178_20&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre">
      
      </span><a name="loc_181_7_181_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_7_181_17&#39;)"><span class="hl_fundecl"><span class="mpre">unreserved</span></span></a><span class="mpre"> </span><a name="loc_181_18_181_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_18_181_20&#39;)"><span class="hl_vardecl"><span class="mpre">ch</span></span></a><span class="mpre"> | </span><a href="#loc_181_18_181_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_18_181_20&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">65</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_181_18_181_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_18_181_20&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">90</span></span><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- A-Z</span></span><span class="mpre">
                    | </span><a href="#loc_181_18_181_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_18_181_20&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">97</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_181_18_181_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_18_181_20&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">122</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- a-z</span></span><span class="mpre">
                    | </span><a href="#loc_181_18_181_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_18_181_20&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_181_18_181_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_18_181_20&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">57</span></span><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- 0-9</span></span><span class="mpre">
      </span><a href="#loc_181_7_181_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_7_181_17&#39;)"><span class="hl_fundecl"><span class="mpre">unreserved</span></span></a><span class="mpre"> </span><a name="loc_184_18_184_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_18_184_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_184_18_184_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_18_184_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_176_19_176_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_19_176_34&#39;)"><span class="hl_varref"><span class="mpre">extraUnreserved</span></span></a><span class="mpre">
      
      </span><a name="loc_186_7_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_7_186_9&#39;)"><span class="hl_fundecl"><span class="mpre">h2</span></span></a><span class="mpre"> </span><a name="loc_186_10_186_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_10_186_11&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = let (</span><a name="loc_186_19_186_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_19_186_20&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_186_22_186_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_22_186_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_186_10_186_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_10_186_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`divMod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre"> in </span><a href="Blaze.ByteString.Builder.Word.html#loc_274_1_274_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Word.html#loc_274_1_274_11&#39;)"><span class="hl_varref"><span class="mpre">Blaze.fromWord8s</span></span></a><span class="mpre"> [</span><span class="hl_num"><span class="mpre">37</span></span><span class="mpre">, </span><a href="#loc_187_7_187_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_7_187_8&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_186_19_186_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_19_186_20&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_187_7_187_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_7_187_8&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_186_22_186_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_22_186_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- percent (%)</span></span><span class="mpre">
      </span><a name="loc_187_7_187_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_7_187_8&#39;)"><span class="hl_fundecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_187_9_187_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_10&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> | </span><a href="#loc_187_9_187_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_10&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">    = </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_187_9_187_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_10&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- zero (0)</span></span><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_num"><span class="mpre">65</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_187_9_187_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_10&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- 65: A</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Percent-encoding for URLs (using &#39;Blaze.Builder&#39;).</span></span><span class="mpre">
</span><a href="#loc_195_1_195_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_17&#39;)"><span class="mpre">urlEncodeBuilder</span></a><span class="mpre">
    :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Whether input is in query string. True: Query string, False: Path element</span></span><span class="mpre">
    -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
    -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Blaze.Builder</span></span></a><span class="mpre">
</span><a name="loc_195_1_195_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_17&#39;)"><span class="hl_fundecl"><span class="mpre">urlEncodeBuilder</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">  = </span><a href="#loc_176_1_176_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_18&#39;)"><span class="hl_varref"><span class="mpre">urlEncodeBuilder&#39;</span></span></a><span class="mpre"> </span><a href="#loc_171_1_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_13&#39;)"><span class="hl_varref"><span class="mpre">unreservedQS</span></span></a><span class="mpre">
</span><a href="#loc_195_1_195_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_17&#39;)"><span class="hl_fundecl"><span class="mpre">urlEncodeBuilder</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> = </span><a href="#loc_176_1_176_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_18&#39;)"><span class="hl_varref"><span class="mpre">urlEncodeBuilder&#39;</span></span></a><span class="mpre"> </span><a href="#loc_172_1_172_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_1_172_13&#39;)"><span class="hl_varref"><span class="mpre">unreservedPI</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Percent-encoding for URLs.</span></span><span class="mpre">
</span><a href="#loc_200_1_200_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_10&#39;)"><span class="mpre">urlEncode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_200_1_200_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_1_200_10&#39;)"><span class="hl_fundecl"><span class="mpre">urlEncode</span></span></a><span class="mpre"> </span><a name="loc_200_11_200_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_11_200_12&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.html#loc_299_1_299_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_299_1_299_13&#39;)"><span class="hl_varref"><span class="mpre">Blaze.toByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_195_1_195_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_17&#39;)"><span class="hl_varref"><span class="mpre">urlEncodeBuilder</span></span></a><span class="mpre"> </span><a href="#loc_200_11_200_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_11_200_12&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Percent-decoding.</span></span><span class="mpre">
</span><a href="#loc_205_1_205_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_10&#39;)"><span class="mpre">urlDecode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Whether to decode &#39;+&#39; to &#39; &#39;</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_205_1_205_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_10&#39;)"><span class="hl_fundecl"><span class="mpre">urlDecode</span></span></a><span class="mpre"> </span><a name="loc_205_11_205_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_11_205_22&#39;)"><span class="hl_vardecl"><span class="mpre">replacePlus</span></span></a><span class="mpre"> </span><a name="loc_205_23_205_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_23_205_24&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.unfoldrN</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_205_23_205_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_23_205_24&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">) </span><a href="#loc_207_5_207_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_5_207_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_205_23_205_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_23_205_24&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
  where
    </span><a name="loc_207_5_207_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_5_207_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_207_8_207_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_8_207_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
        case </span><span class="hl_varref"><span class="mpre">B.uncons</span></span><span class="mpre"> </span><a href="#loc_207_8_207_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_8_207_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">43</span></span><span class="mpre">, </span><a name="loc_210_23_210_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_23_210_25&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">) | </span><a href="#loc_205_11_205_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_11_205_22&#39;)"><span class="hl_varref"><span class="mpre">replacePlus</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">, </span><a href="#loc_210_23_210_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_23_210_25&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- plus to space</span></span><span class="mpre">
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">37</span></span><span class="mpre">, </span><a name="loc_211_23_211_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_23_211_25&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">) -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">37</span></span><span class="mpre">, </span><a href="#loc_211_23_211_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_23_211_25&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do </span><span class="hl_comment"><span class="mpre">-- percent</span></span><span class="mpre">
                (</span><a name="loc_212_18_212_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_18_212_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_212_21_212_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_21_212_23&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">B.uncons</span></span><span class="mpre"> </span><a href="#loc_211_23_211_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_23_211_25&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
                </span><a name="loc_213_17_213_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_17_213_19&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_218_5_218_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_5_218_11&#39;)"><span class="hl_varref"><span class="mpre">hexVal</span></span></a><span class="mpre"> </span><a href="#loc_212_18_212_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_18_212_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                (</span><a name="loc_214_18_214_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_18_214_19&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">, </span><a name="loc_214_21_214_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_21_214_23&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">B.uncons</span></span><span class="mpre"> </span><a href="#loc_212_21_212_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_21_212_23&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
                </span><a name="loc_215_17_215_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_17_215_19&#39;)"><span class="hl_vardecl"><span class="mpre">y&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_218_5_218_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_5_218_11&#39;)"><span class="hl_varref"><span class="mpre">hexVal</span></span></a><span class="mpre"> </span><a href="#loc_214_18_214_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_18_214_19&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_224_5_224_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_12&#39;)"><span class="hl_varref"><span class="mpre">combine</span></span></a><span class="mpre"> </span><a href="#loc_213_17_213_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_17_213_19&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre"> </span><a href="#loc_215_17_215_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_17_215_19&#39;)"><span class="hl_varref"><span class="mpre">y&#39;</span></span></a><span class="mpre">, </span><a href="#loc_214_21_214_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_21_214_23&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">)
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_217_19_217_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_19_217_20&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">, </span><a name="loc_217_22_217_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_22_217_24&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">) -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="#loc_217_19_217_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_19_217_20&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">, </span><a href="#loc_217_22_217_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_22_217_24&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">)
    </span><a name="loc_218_5_218_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_5_218_11&#39;)"><span class="hl_fundecl"><span class="mpre">hexVal</span></span></a><span class="mpre"> </span><a name="loc_218_12_218_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_12_218_13&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">
        | </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_218_12_218_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_12_218_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_218_12_218_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_12_218_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">57</span></span><span class="mpre">  = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_218_12_218_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_12_218_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- 0 - 9</span></span><span class="mpre">
        | </span><span class="hl_num"><span class="mpre">65</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_218_12_218_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_12_218_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_218_12_218_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_12_218_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">70</span></span><span class="mpre">  = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_218_12_218_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_12_218_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">55</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- A - F</span></span><span class="mpre">
        | </span><span class="hl_num"><span class="mpre">97</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_218_12_218_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_12_218_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_218_12_218_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_12_218_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">102</span></span><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_218_12_218_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_12_218_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">87</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- a - f</span></span><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
    </span><a href="#loc_224_5_224_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_12&#39;)"><span class="mpre">combine</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
    </span><a name="loc_224_5_224_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_12&#39;)"><span class="hl_fundecl"><span class="mpre">combine</span></span></a><span class="mpre"> </span><a name="loc_224_13_224_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_13_224_14&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_224_15_224_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_15_224_16&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_varref"><span class="mpre">shiftL</span></span></a><span class="mpre"> </span><a href="#loc_224_13_224_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_13_224_14&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><a href="#loc_224_15_224_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_15_224_16&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encodes a list of path segments into a valid URL fragment.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function takes the following three steps:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * UTF-8 encodes the characters.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Performs percent encoding on all unreserved characters, as well as \:\@\=\+\$,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Prepends each segment with a slash.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; encodePathSegments [\&quot;foo\&quot;, \&quot;bar\&quot;, \&quot;baz\&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- \&quot;\/foo\/bar\/baz\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; encodePathSegments [\&quot;foo bar\&quot;, \&quot;baz\/bin\&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- \&quot;\/foo\%20bar\/baz\%2Fbin\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; encodePathSegments [\&quot;שלום\&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- \&quot;\/%D7%A9%D7%9C%D7%95%D7%9D\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Huge thanks to Jeremy Shaw who created the original implementation of this</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- function in web-routes and did such thorough research to determine all</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- correct escaping procedures.</span></span><span class="mpre">
</span><a href="#loc_254_1_254_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_19&#39;)"><span class="mpre">encodePathSegments</span></a><span class="mpre"> :: [</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">] -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Blaze.Builder</span></span></a><span class="mpre">
</span><a name="loc_254_1_254_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_19&#39;)"><span class="hl_fundecl"><span class="mpre">encodePathSegments</span></span></a><span class="mpre"> [] = </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
</span><a href="#loc_254_1_254_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_19&#39;)"><span class="hl_fundecl"><span class="mpre">encodePathSegments</span></span></a><span class="mpre"> (</span><a name="loc_255_21_255_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_21_255_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_255_23_255_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_23_255_25&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) =
    </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">Blaze.copyByteString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">
    </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_265_1_265_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_1_265_18&#39;)"><span class="hl_varref"><span class="mpre">encodePathSegment</span></span></a><span class="mpre"> </span><a href="#loc_255_21_255_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_21_255_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_254_1_254_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_19&#39;)"><span class="hl_varref"><span class="mpre">encodePathSegments</span></span></a><span class="mpre"> </span><a href="#loc_255_23_255_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_23_255_25&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like encodePathSegments, but without the initial slash.</span></span><span class="mpre">
</span><a href="#loc_262_1_262_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_27&#39;)"><span class="mpre">encodePathSegmentsRelative</span></a><span class="mpre"> :: [</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">] -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Blaze.Builder</span></span></a><span class="mpre">
</span><a name="loc_262_1_262_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_27&#39;)"><span class="hl_fundecl"><span class="mpre">encodePathSegmentsRelative</span></span></a><span class="mpre"> </span><a name="loc_262_28_262_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_28_262_30&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_varref"><span class="mpre">mconcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.List.html#loc_427_1_427_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_427_1_427_12&#39;)"><span class="hl_varref"><span class="mpre">intersperse</span></span></a><span class="mpre"> (</span><a href="Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">Blaze.copyByteString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_265_1_265_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_1_265_18&#39;)"><span class="hl_varref"><span class="mpre">encodePathSegment</span></span></a><span class="mpre"> </span><a href="#loc_262_28_262_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_28_262_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

</span><a href="#loc_265_1_265_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_1_265_18&#39;)"><span class="mpre">encodePathSegment</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Blaze.Builder</span></span></a><span class="mpre">
</span><a name="loc_265_1_265_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_1_265_18&#39;)"><span class="hl_vardecl"><span class="mpre">encodePathSegment</span></span></a><span class="mpre"> = </span><a href="#loc_195_1_195_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_17&#39;)"><span class="hl_varref"><span class="mpre">urlEncodeBuilder</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">encodeUtf8</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Parse a list of path segments from a valid URL fragment.</span></span><span class="mpre">
</span><a href="#loc_269_1_269_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_1_269_19&#39;)"><span class="mpre">decodePathSegments</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; [</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">]
</span><a name="loc_269_1_269_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_1_269_19&#39;)"><span class="hl_fundecl"><span class="mpre">decodePathSegments</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> = []
</span><a href="#loc_269_1_269_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_1_269_19&#39;)"><span class="hl_fundecl"><span class="mpre">decodePathSegments</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre"> = []
</span><a href="#loc_269_1_269_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_1_269_19&#39;)"><span class="hl_fundecl"><span class="mpre">decodePathSegments</span></span></a><span class="mpre"> </span><a name="loc_271_20_271_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_20_271_21&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> =
    </span><a href="#loc_278_5_278_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_5_278_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_274_5_274_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_5_274_15&#39;)"><span class="hl_varref"><span class="mpre">drop1Slash</span></span></a><span class="mpre"> </span><a href="#loc_271_20_271_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_20_271_21&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
  where
    </span><a name="loc_274_5_274_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_5_274_15&#39;)"><span class="hl_fundecl"><span class="mpre">drop1Slash</span></span></a><span class="mpre"> </span><a name="loc_274_16_274_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_16_274_18&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
        case </span><span class="hl_varref"><span class="mpre">B.uncons</span></span><span class="mpre"> </span><a href="#loc_274_16_274_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_16_274_18&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">47</span></span><span class="mpre">, </span><a name="loc_276_23_276_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_23_276_26&#39;)"><span class="hl_vardecl"><span class="mpre">bs&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_276_23_276_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_23_276_26&#39;)"><span class="hl_varref"><span class="mpre">bs&#39;</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- 47 == /</span></span><span class="mpre">
            _ -&gt; </span><a href="#loc_274_16_274_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_16_274_18&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
    </span><a name="loc_278_5_278_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_5_278_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_278_8_278_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_8_278_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
        let (</span><a name="loc_279_14_279_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_14_279_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_279_17_279_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_17_279_18&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.breakByte</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">47</span></span><span class="mpre"> </span><a href="#loc_278_8_278_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_8_278_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
         in </span><a href="#loc_286_1_286_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_1_286_18&#39;)"><span class="hl_varref"><span class="mpre">decodePathSegment</span></span></a><span class="mpre"> </span><a href="#loc_279_14_279_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_14_279_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">
            if </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_279_17_279_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_17_279_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                then []
                else </span><a href="#loc_278_5_278_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_5_278_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_279_17_279_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_17_279_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><a href="#loc_286_1_286_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_1_286_18&#39;)"><span class="mpre">decodePathSegment</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_286_1_286_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_1_286_18&#39;)"><span class="hl_vardecl"><span class="mpre">decodePathSegment</span></span></a><span class="mpre"> = </span><a href="Data.Text.Encoding.html#loc_142_1_142_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_142_1_142_15&#39;)"><span class="hl_varref"><span class="mpre">decodeUtf8With</span></span></a><span class="mpre"> </span><a href="Data.Text.Encoding.Error.html#loc_107_1_107_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.Error.html#loc_107_1_107_14&#39;)"><span class="hl_varref"><span class="mpre">lenientDecode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_205_1_205_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_10&#39;)"><span class="hl_varref"><span class="mpre">urlDecode</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Extract whole path (path segments + query) from a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://tools.ietf.org/html/rfc2616#section-5.1.2 RFC 2616 Request-URI&gt;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; extractPath &quot;/path&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;/path&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; extractPath &quot;http://example.com:8080/path&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;/path&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; extractPath &quot;http://example.com&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;/&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; extractPath &quot;&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;/&quot;</span></span><span class="mpre">
</span><a href="#loc_303_1_303_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_1_303_12&#39;)"><span class="mpre">extractPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_303_1_303_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_1_303_12&#39;)"><span class="hl_vardecl"><span class="mpre">extractPath</span></span></a><span class="mpre"> = </span><a href="#loc_310_5_310_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_5_310_19&#39;)"><span class="hl_varref"><span class="mpre">ensureNonEmpty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_305_5_305_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_5_305_12&#39;)"><span class="hl_varref"><span class="mpre">extract</span></span></a><span class="mpre">
  where
    </span><a name="loc_305_5_305_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_5_305_12&#39;)"><span class="hl_fundecl"><span class="mpre">extract</span></span></a><span class="mpre"> </span><a name="loc_305_13_305_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_13_305_17&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre">
      | </span><span class="hl_string"><span class="mpre">&quot;http://&quot;</span></span><span class="mpre">  </span><span class="hl_infix"><span class="mpre">`B.isPrefixOf`</span></span><span class="mpre"> </span><a href="#loc_305_13_305_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_13_305_17&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_309_5_309_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_5_309_17&#39;)"><span class="hl_varref"><span class="mpre">breakOnSlash</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">) </span><a href="#loc_305_13_305_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_13_305_17&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">
      | </span><span class="hl_string"><span class="mpre">&quot;https://&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.isPrefixOf`</span></span><span class="mpre"> </span><a href="#loc_305_13_305_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_13_305_17&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_309_5_309_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_5_309_17&#39;)"><span class="hl_varref"><span class="mpre">breakOnSlash</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><a href="#loc_305_13_305_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_13_305_17&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                      = </span><a href="#loc_305_13_305_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_13_305_17&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">
    </span><a name="loc_309_5_309_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_5_309_17&#39;)"><span class="hl_vardecl"><span class="mpre">breakOnSlash</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.breakByte</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">47</span></span><span class="mpre">
    </span><a name="loc_310_5_310_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_5_310_19&#39;)"><span class="hl_fundecl"><span class="mpre">ensureNonEmpty</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">
    </span><a href="#loc_310_5_310_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_5_310_19&#39;)"><span class="hl_fundecl"><span class="mpre">ensureNonEmpty</span></span></a><span class="mpre"> </span><a name="loc_311_20_311_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_20_311_21&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">  = </span><a href="#loc_311_20_311_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_20_311_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encode a whole path (path segments + query).</span></span><span class="mpre">
</span><a href="#loc_315_1_315_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_1_315_11&#39;)"><span class="mpre">encodePath</span></a><span class="mpre"> :: [</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Query</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Blaze.Builder</span></span></a><span class="mpre">
</span><a name="loc_315_1_315_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_1_315_11&#39;)"><span class="hl_fundecl"><span class="mpre">encodePath</span></span></a><span class="mpre"> </span><a name="loc_315_12_315_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_12_315_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> [] = </span><a href="#loc_254_1_254_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_19&#39;)"><span class="hl_varref"><span class="mpre">encodePathSegments</span></span></a><span class="mpre"> </span><a href="#loc_315_12_315_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_12_315_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_315_1_315_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_1_315_11&#39;)"><span class="hl_fundecl"><span class="mpre">encodePath</span></span></a><span class="mpre"> </span><a name="loc_316_12_316_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_12_316_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_316_14_316_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_14_316_15&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_254_1_254_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_19&#39;)"><span class="hl_varref"><span class="mpre">encodePathSegments</span></span></a><span class="mpre"> </span><a href="#loc_316_12_316_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_12_316_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_97_1_97_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_19&#39;)"><span class="hl_varref"><span class="mpre">renderQueryBuilder</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_316_14_316_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_14_316_15&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Decode a whole path (path segments + query).</span></span><span class="mpre">
</span><a href="#loc_320_1_320_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_11&#39;)"><span class="mpre">decodePath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; ([</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">], </span><span class="hl_tyconref"><span class="mpre">Query</span></span><span class="mpre">)
</span><a name="loc_320_1_320_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_11&#39;)"><span class="hl_fundecl"><span class="mpre">decodePath</span></span></a><span class="mpre"> </span><a name="loc_320_12_320_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_12_320_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> =
    let (</span><a name="loc_321_10_321_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_10_321_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_321_13_321_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_13_321_14&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.breakByte</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">63</span></span><span class="mpre"> </span><a href="#loc_320_12_320_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_12_320_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- question mark</span></span><span class="mpre">
    in (</span><a href="#loc_269_1_269_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_1_269_19&#39;)"><span class="hl_varref"><span class="mpre">decodePathSegments</span></span></a><span class="mpre"> </span><a href="#loc_321_10_321_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_10_321_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_134_1_134_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_11&#39;)"><span class="hl_varref"><span class="mpre">parseQuery</span></span></a><span class="mpre"> </span><a href="#loc_321_13_321_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_13_321_14&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
</span></div></body></html>