<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}
module Network.HTTP.Date.Converter (epochTimeToHTTPDate) where

import Control.Applicative
import Data.ByteString.Internal
import Data.Word
import Foreign.Marshal.Array
import Foreign.Ptr
import Foreign.Storable
import Network.HTTP.Date.Types
import System.IO.Unsafe (</span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="mpre">unsafePerformIO</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-date-0.0.4/Network/HTTP/Date/Converter.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 8, srcSpanEndLine = 12, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;System.Posix.Types&quot;"><span class="mpre">System.Posix.Types</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-|
  Translating &#39;EpochTime&#39; to &#39;HTTPDate&#39;.
-}</span></span><span class="mpre">
</span><a href="#loc_18_1_18_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_20&#39;)"><span class="mpre">epochTimeToHTTPDate</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">EpochTime</span></span><span class="mpre"> -&gt; </span><a href="Network.HTTP.Date.Types.html#loc_17_6_17_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Date.Types.html#loc_17_6_17_14&#39;)"><span class="hl_tyconref"><span class="mpre">HTTPDate</span></span></a><span class="mpre">
</span><a name="loc_18_1_18_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_20&#39;)"><span class="hl_fundecl"><span class="mpre">epochTimeToHTTPDate</span></span></a><span class="mpre"> </span><a name="loc_18_21_18_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_21_18_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-date-0.0.4/Network/HTTP/Date/Converter.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 25, srcSpanEndLine = 26, srcSpanEndColumn = 4}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-date-0.0.4/Network/HTTP/Date/Converter.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 41, srcSpanEndLine = 18, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-date-0.0.4/Network/HTTP/Da"><span class="mpre">defaultHTTPDate {
    hdYear   = y
  , hdMonth  = m
  , hdDay    = d
  , hdHour   = h
  , hdMinute = n
  , hdSecond = s
  , hdWkday  = w
  }</span></span><span class="mpre">
  where
    </span><a href="#loc_29_5_29_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_5_29_8&#39;)"><span class="mpre">w64</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">
    </span><a name="loc_29_5_29_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_5_29_8&#39;)"><span class="hl_vardecl"><span class="mpre">w64</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_18_21_18_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_21_18_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    (</span><a name="loc_30_6_30_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_11&#39;)"><span class="hl_vardecl"><span class="mpre">days&#39;</span></span></a><span class="mpre">,</span><a name="loc_30_12_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_12_30_17&#39;)"><span class="hl_vardecl"><span class="mpre">secs&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_29_5_29_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_5_29_8&#39;)"><span class="hl_varref"><span class="mpre">w64</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quotRem`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">86400</span></span><span class="mpre">
    </span><a name="loc_31_5_31_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_5_31_9&#39;)"><span class="hl_vardecl"><span class="mpre">days</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_30_6_30_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_11&#39;)"><span class="hl_varref"><span class="mpre">days&#39;</span></span></a><span class="mpre">
    </span><a name="loc_32_5_32_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_5_32_9&#39;)"><span class="hl_vardecl"><span class="mpre">secs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_30_12_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_12_30_17&#39;)"><span class="hl_varref"><span class="mpre">secs&#39;</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- 1970/1/1 is Thu (4)</span></span><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">w</span></span><span class="mpre"> = (</span><a href="#loc_31_5_31_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_5_31_9&#39;)"><span class="hl_varref"><span class="mpre">days</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`rem`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    (</span><span class="hl_vardecl"><span class="mpre">y</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">m</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">d</span></span><span class="mpre">) = </span><a href="#loc_39_1_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_9&#39;)"><span class="hl_varref"><span class="mpre">toYYMMDD</span></span></a><span class="mpre"> </span><a href="#loc_31_5_31_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_5_31_9&#39;)"><span class="hl_varref"><span class="mpre">days</span></span></a><span class="mpre">
    (</span><span class="hl_vardecl"><span class="mpre">h</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">n</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">s</span></span><span class="mpre">) = </span><a href="#loc_92_1_92_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_9&#39;)"><span class="hl_varref"><span class="mpre">toHHMMSS</span></span></a><span class="mpre"> </span><a href="#loc_32_5_32_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_5_32_9&#39;)"><span class="hl_varref"><span class="mpre">secs</span></span></a><span class="mpre">

</span><a href="#loc_39_1_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_9&#39;)"><span class="mpre">toYYMMDD</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_39_1_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_9&#39;)"><span class="hl_fundecl"><span class="mpre">toYYMMDD</span></span></a><span class="mpre"> </span><a name="loc_39_10_39_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_10_39_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><a href="#loc_45_6_45_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_6_45_8&#39;)"><span class="hl_varref"><span class="mpre">yy</span></span></a><span class="mpre">, </span><a href="#loc_46_6_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_6_46_8&#39;)"><span class="hl_varref"><span class="mpre">mm</span></span></a><span class="mpre">, </span><a href="#loc_46_9_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_11&#39;)"><span class="hl_varref"><span class="mpre">dd</span></span></a><span class="mpre">)
  where
    (</span><a name="loc_41_6_41_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_7&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_41_8_41_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_8_41_9&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = </span><a href="#loc_39_10_39_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_10_39_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quotRem`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre">
    </span><a name="loc_42_5_42_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_5_42_7&#39;)"><span class="hl_vardecl"><span class="mpre">cy</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">1970</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_41_6_41_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_7&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
    </span><a name="loc_43_5_43_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_5_43_8&#39;)"><span class="hl_vardecl"><span class="mpre">cy&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_42_5_42_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_5_42_7&#39;)"><span class="hl_varref"><span class="mpre">cy</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    </span><a name="loc_44_5_44_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_5_44_9&#39;)"><span class="hl_vardecl"><span class="mpre">leap</span></span></a><span class="mpre"> = </span><a href="#loc_43_5_43_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_5_43_8&#39;)"><span class="hl_varref"><span class="mpre">cy&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quot`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_43_5_43_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_5_43_8&#39;)"><span class="hl_varref"><span class="mpre">cy&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quot`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_43_5_43_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_5_43_8&#39;)"><span class="hl_varref"><span class="mpre">cy&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quot`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">400</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">477</span></span><span class="mpre">
    (</span><a name="loc_45_6_45_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_6_45_8&#39;)"><span class="hl_vardecl"><span class="mpre">yy</span></span></a><span class="mpre">,</span><a name="loc_45_9_45_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_13&#39;)"><span class="hl_vardecl"><span class="mpre">days</span></span></a><span class="mpre">) = </span><a href="#loc_47_5_47_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_11&#39;)"><span class="hl_varref"><span class="mpre">adjust</span></span></a><span class="mpre"> </span><a href="#loc_42_5_42_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_5_42_7&#39;)"><span class="hl_varref"><span class="mpre">cy</span></span></a><span class="mpre"> </span><a href="#loc_41_8_41_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_8_41_9&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_44_5_44_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_5_44_9&#39;)"><span class="hl_varref"><span class="mpre">leap</span></span></a><span class="mpre">
    (</span><a name="loc_46_6_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_6_46_8&#39;)"><span class="hl_vardecl"><span class="mpre">mm</span></span></a><span class="mpre">,</span><a name="loc_46_9_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_11&#39;)"><span class="hl_vardecl"><span class="mpre">dd</span></span></a><span class="mpre">) = </span><a href="#loc_61_5_61_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_14&#39;)"><span class="hl_varref"><span class="mpre">findMonth</span></span></a><span class="mpre"> </span><a href="#loc_45_9_45_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_13&#39;)"><span class="hl_varref"><span class="mpre">days</span></span></a><span class="mpre">
    </span><a name="loc_47_5_47_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_11&#39;)"><span class="hl_fundecl"><span class="mpre">adjust</span></span></a><span class="mpre"> !</span><a name="loc_47_13_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_15&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre"> </span><a name="loc_47_16_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_16_47_18&#39;)"><span class="hl_vardecl"><span class="mpre">td</span></span></a><span class="mpre"> </span><a name="loc_47_19_47_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_21&#39;)"><span class="hl_vardecl"><span class="mpre">aj</span></span></a><span class="mpre">
      | </span><a href="#loc_47_16_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_16_47_18&#39;)"><span class="hl_varref"><span class="mpre">td</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_47_19_47_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_21&#39;)"><span class="hl_varref"><span class="mpre">aj</span></span></a><span class="mpre">        = (</span><a href="#loc_47_13_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_15&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre">, </span><a href="#loc_47_16_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_16_47_18&#39;)"><span class="hl_varref"><span class="mpre">td</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_47_19_47_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_21&#39;)"><span class="hl_varref"><span class="mpre">aj</span></span></a><span class="mpre">)
      | </span><a href="#loc_55_5_55_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_5_55_11&#39;)"><span class="hl_varref"><span class="mpre">isLeap</span></span></a><span class="mpre"> (</span><a href="#loc_47_13_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_15&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) = if </span><a href="#loc_47_16_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_16_47_18&#39;)"><span class="hl_varref"><span class="mpre">td</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">366</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_47_19_47_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_21&#39;)"><span class="hl_varref"><span class="mpre">aj</span></span></a><span class="mpre">
                          then (</span><a href="#loc_47_13_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_15&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><a href="#loc_47_16_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_16_47_18&#39;)"><span class="hl_varref"><span class="mpre">td</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">366</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_47_19_47_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_21&#39;)"><span class="hl_varref"><span class="mpre">aj</span></span></a><span class="mpre">)
                          else </span><a href="#loc_47_5_47_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_11&#39;)"><span class="hl_varref"><span class="mpre">adjust</span></span></a><span class="mpre"> (</span><a href="#loc_47_13_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_15&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_47_16_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_16_47_18&#39;)"><span class="hl_varref"><span class="mpre">td</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">366</span></span><span class="mpre">) </span><a href="#loc_47_19_47_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_21&#39;)"><span class="hl_varref"><span class="mpre">aj</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       = if </span><a href="#loc_47_16_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_16_47_18&#39;)"><span class="hl_varref"><span class="mpre">td</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_47_19_47_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_21&#39;)"><span class="hl_varref"><span class="mpre">aj</span></span></a><span class="mpre">
                          then (</span><a href="#loc_47_13_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_15&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><a href="#loc_47_16_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_16_47_18&#39;)"><span class="hl_varref"><span class="mpre">td</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_47_19_47_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_21&#39;)"><span class="hl_varref"><span class="mpre">aj</span></span></a><span class="mpre">)
                          else </span><a href="#loc_47_5_47_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_11&#39;)"><span class="hl_varref"><span class="mpre">adjust</span></span></a><span class="mpre"> (</span><a href="#loc_47_13_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_15&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_47_16_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_16_47_18&#39;)"><span class="hl_varref"><span class="mpre">td</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">365</span></span><span class="mpre">) </span><a href="#loc_47_19_47_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_21&#39;)"><span class="hl_varref"><span class="mpre">aj</span></span></a><span class="mpre">
    </span><a name="loc_55_5_55_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_5_55_11&#39;)"><span class="hl_fundecl"><span class="mpre">isLeap</span></span></a><span class="mpre"> </span><a name="loc_55_12_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_12_55_16&#39;)"><span class="hl_vardecl"><span class="mpre">year</span></span></a><span class="mpre"> = </span><a href="#loc_55_12_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_12_55_16&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`rem`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
              </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> (</span><a href="#loc_55_12_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_12_55_16&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`rem`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">400</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre">
                  </span><a href="#loc_55_12_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_12_55_16&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`rem`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
    (</span><a name="loc_58_6_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_12&#39;)"><span class="hl_vardecl"><span class="mpre">months</span></span></a><span class="mpre">, </span><a name="loc_58_14_58_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_14_58_21&#39;)"><span class="hl_vardecl"><span class="mpre">daysArr</span></span></a><span class="mpre">) = if </span><a href="#loc_55_5_55_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_5_55_11&#39;)"><span class="hl_varref"><span class="mpre">isLeap</span></span></a><span class="mpre"> </span><a href="#loc_45_6_45_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_6_45_8&#39;)"><span class="hl_varref"><span class="mpre">yy</span></span></a><span class="mpre">
      then (</span><a href="#loc_84_1_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_10&#39;)"><span class="hl_varref"><span class="mpre">leapMonth</span></span></a><span class="mpre">, </span><a href="#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_15&#39;)"><span class="hl_varref"><span class="mpre">leapDayInMonth</span></span></a><span class="mpre">)
      else (</span><a href="#loc_78_1_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_12&#39;)"><span class="hl_varref"><span class="mpre">normalMonth</span></span></a><span class="mpre">, </span><a href="#loc_81_1_81_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_17&#39;)"><span class="hl_varref"><span class="mpre">normalDayInMonth</span></span></a><span class="mpre">)
    </span><a name="loc_61_5_61_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_14&#39;)"><span class="hl_fundecl"><span class="mpre">findMonth</span></span></a><span class="mpre"> </span><a name="loc_61_15_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_15_61_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Internal.html#loc_592_1_592_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_592_1_592_16&#39;)"><span class="hl_varref"><span class="mpre">inlinePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">peekElemOff</span></span><span class="mpre"> </span><a href="#loc_58_6_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_12&#39;)"><span class="hl_varref"><span class="mpre">months</span></span></a><span class="mpre"> </span><a href="#loc_61_15_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_15_61_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">peekElemOff</span></span><span class="mpre"> </span><a href="#loc_58_14_58_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_14_58_21&#39;)"><span class="hl_varref"><span class="mpre">daysArr</span></span></a><span class="mpre"> </span><a href="#loc_61_15_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_15_61_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_66_1_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_16&#39;)"><span class="mpre">normalMonthDays</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">]
</span><a name="loc_66_1_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_16&#39;)"><span class="hl_vardecl"><span class="mpre">normalMonthDays</span></span></a><span class="mpre"> = [</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">28</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">]

</span><a href="#loc_69_1_69_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_14&#39;)"><span class="mpre">leapMonthDays</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">]
</span><a name="loc_69_1_69_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_14&#39;)"><span class="hl_vardecl"><span class="mpre">leapMonthDays</span></span></a><span class="mpre">   = [</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">29</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">]

</span><a href="#loc_72_1_72_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_9&#39;)"><span class="mpre">mkPtrInt</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_72_1_72_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_9&#39;)"><span class="hl_vardecl"><span class="mpre">mkPtrInt</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Foreign.Marshal.Array.html#loc_170_1_170_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Array.html#loc_170_1_170_9&#39;)"><span class="hl_varref"><span class="mpre">newArray</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">zipWith</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre">) </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-date-0.0.4/Network/HTTP/Date/Converter.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 75, srcSpanEndLine = 72, srcSpanEndColumn = 80}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-date-0.0.4/Network/HTTP/Date/Converter.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 75, srcSpanEndLine = 72, srcSpanEndColumn = 76},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-date-0.0.4/Network/HTTP/Da"><span class="mpre">[1..]</span></span><span class="mpre">

</span><a href="#loc_75_1_75_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_10&#39;)"><span class="mpre">mkPtrInt2</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_75_1_75_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_10&#39;)"><span class="hl_vardecl"><span class="mpre">mkPtrInt2</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Foreign.Marshal.Array.html#loc_170_1_170_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Array.html#loc_170_1_170_9&#39;)"><span class="hl_varref"><span class="mpre">newArray</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">enumFromTo</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

</span><a href="#loc_78_1_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_12&#39;)"><span class="mpre">normalMonth</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_78_1_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_12&#39;)"><span class="hl_vardecl"><span class="mpre">normalMonth</span></span></a><span class="mpre"> = </span><a href="#loc_72_1_72_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_9&#39;)"><span class="hl_varref"><span class="mpre">mkPtrInt</span></span></a><span class="mpre"> </span><a href="#loc_66_1_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_16&#39;)"><span class="hl_varref"><span class="mpre">normalMonthDays</span></span></a><span class="mpre">

</span><a href="#loc_81_1_81_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_17&#39;)"><span class="mpre">normalDayInMonth</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_81_1_81_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_17&#39;)"><span class="hl_vardecl"><span class="mpre">normalDayInMonth</span></span></a><span class="mpre"> = </span><a href="#loc_75_1_75_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_10&#39;)"><span class="hl_varref"><span class="mpre">mkPtrInt2</span></span></a><span class="mpre"> </span><a href="#loc_66_1_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_16&#39;)"><span class="hl_varref"><span class="mpre">normalMonthDays</span></span></a><span class="mpre">

</span><a href="#loc_84_1_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_10&#39;)"><span class="mpre">leapMonth</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_84_1_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_10&#39;)"><span class="hl_vardecl"><span class="mpre">leapMonth</span></span></a><span class="mpre"> = </span><a href="#loc_72_1_72_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_9&#39;)"><span class="hl_varref"><span class="mpre">mkPtrInt</span></span></a><span class="mpre"> </span><a href="#loc_69_1_69_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_14&#39;)"><span class="hl_varref"><span class="mpre">leapMonthDays</span></span></a><span class="mpre">

</span><a href="#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_15&#39;)"><span class="mpre">leapDayInMonth</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_87_1_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_15&#39;)"><span class="hl_vardecl"><span class="mpre">leapDayInMonth</span></span></a><span class="mpre"> = </span><a href="#loc_75_1_75_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_10&#39;)"><span class="hl_varref"><span class="mpre">mkPtrInt2</span></span></a><span class="mpre"> </span><a href="#loc_69_1_69_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_14&#39;)"><span class="hl_varref"><span class="mpre">leapMonthDays</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_92_1_92_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_9&#39;)"><span class="mpre">toHHMMSS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_92_1_92_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_9&#39;)"><span class="hl_fundecl"><span class="mpre">toHHMMSS</span></span></a><span class="mpre"> </span><a name="loc_92_10_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_10_92_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><a href="#loc_95_6_95_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_6_95_8&#39;)"><span class="hl_varref"><span class="mpre">hh</span></span></a><span class="mpre">,</span><a href="#loc_95_9_95_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_11&#39;)"><span class="hl_varref"><span class="mpre">mm</span></span></a><span class="mpre">,</span><a href="#loc_94_11_94_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_13&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">)
  where
    (</span><a name="loc_94_6_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_6_94_10&#39;)"><span class="hl_vardecl"><span class="mpre">hhmm</span></span></a><span class="mpre">,</span><a name="loc_94_11_94_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_13&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) = </span><a href="#loc_92_10_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_10_92_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quotRem`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">60</span></span><span class="mpre">
    (</span><a name="loc_95_6_95_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_6_95_8&#39;)"><span class="hl_vardecl"><span class="mpre">hh</span></span></a><span class="mpre">,</span><a name="loc_95_9_95_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_11&#39;)"><span class="hl_vardecl"><span class="mpre">mm</span></span></a><span class="mpre">) = </span><a href="#loc_94_6_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_6_94_10&#39;)"><span class="hl_varref"><span class="mpre">hhmm</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quotRem`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">60</span></span><span class="mpre">
</span></div></body></html>