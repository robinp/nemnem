<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Cipher.DES</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : good</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Crypto.Cipher.DES
    ( DES
    ) where

import Data.Byteable
import Data.Word
import Crypto.Cipher.Types
import Crypto.Cipher.DES.Primitive
import Crypto.Cipher.DES.Serialization

</span><span class="hl_comment"><span class="mpre">-- | DES Context</span></span><span class="mpre">
data </span><a name="loc_19_6_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_6_19_9&#39;)"><span class="hl_tycondecl"><span class="mpre">DES</span></span></a><span class="mpre"> = </span><a name="loc_19_12_19_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_12_19_15&#39;)"><span class="hl_condecl"><span class="mpre">DES</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 5, srcSpanEndLine = 20, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 5, srcSpanEndLine = 20, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES.hs&quot;, srcSpanStar"><span class="mpre">deriving (Eq)</span></span><span class="mpre">

instance </span><a href="Crypto.Cipher.Types.Base.html#loc_76_7_76_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_76_7_76_13&#39;)"><span class="hl_classref"><span class="mpre">Cipher</span></span></a><span class="mpre"> </span><a href="#loc_19_6_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_6_19_9&#39;)"><span class="hl_tyconref"><span class="mpre">DES</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">cipherName</span></span><span class="mpre">    _ = </span><span class="hl_string"><span class="mpre">&quot;DES&quot;</span></span><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">cipherKeySize</span></span><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">KeySizeFixed</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">cipherInit</span></span><span class="mpre"> </span><a name="loc_25_16_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_16_25_17&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">    = </span><a href="#loc_33_1_33_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_8&#39;)"><span class="hl_varref"><span class="mpre">initDES</span></span></a><span class="mpre"> </span><a href="#loc_25_16_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_16_25_17&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">

instance </span><a href="Crypto.Cipher.Types.Block.html#loc_52_24_52_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Block.html#loc_52_24_52_35&#39;)"><span class="hl_classref"><span class="mpre">BlockCipher</span></span></a><span class="mpre"> </span><a href="#loc_19_6_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_6_19_9&#39;)"><span class="hl_tyconref"><span class="mpre">DES</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">blockSize</span></span><span class="mpre"> _ = </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">ecbEncrypt</span></span><span class="mpre"> (</span><a href="#loc_19_12_19_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_12_19_15&#39;)"><span class="hl_conref"><span class="mpre">DES</span></span></a><span class="mpre"> </span><a name="loc_29_21_29_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_21_29_24&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre">) = </span><a href="Crypto.Cipher.DES.Serialization.html#loc_43_1_43_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Serialization.html#loc_43_1_43_11&#39;)"><span class="hl_varref"><span class="mpre">unblockify</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Crypto.Cipher.DES.Primitive.html#loc_199_1_199_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_199_1_199_8&#39;)"><span class="hl_varref"><span class="mpre">encrypt</span></span></a><span class="mpre"> </span><a href="#loc_29_21_29_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_21_29_24&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Cipher.DES.Serialization.html#loc_76_1_76_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Serialization.html#loc_76_1_76_9&#39;)"><span class="hl_varref"><span class="mpre">blockify</span></span></a><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">ecbDecrypt</span></span><span class="mpre"> (</span><a href="#loc_19_12_19_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_12_19_15&#39;)"><span class="hl_conref"><span class="mpre">DES</span></span></a><span class="mpre"> </span><a name="loc_30_21_30_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_21_30_24&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre">) = </span><a href="Crypto.Cipher.DES.Serialization.html#loc_43_1_43_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Serialization.html#loc_43_1_43_11&#39;)"><span class="hl_varref"><span class="mpre">unblockify</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Crypto.Cipher.DES.Primitive.html#loc_205_1_205_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_205_1_205_8&#39;)"><span class="hl_varref"><span class="mpre">decrypt</span></span></a><span class="mpre"> </span><a href="#loc_30_21_30_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_21_30_24&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Cipher.DES.Serialization.html#loc_76_1_76_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Serialization.html#loc_76_1_76_9&#39;)"><span class="hl_varref"><span class="mpre">blockify</span></span></a><span class="mpre">

</span><a href="#loc_33_1_33_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_8&#39;)"><span class="mpre">initDES</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 12, srcSpanEndLine = 32, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 23, srcSpanEndLine = 32, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des"><span class="mpre">Byteable b =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="#loc_19_6_19_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_6_19_9&#39;)"><span class="hl_tyconref"><span class="mpre">DES</span></span></a><span class="mpre">
</span><a name="loc_33_1_33_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_8&#39;)"><span class="hl_fundecl"><span class="mpre">initDES</span></span></a><span class="mpre"> </span><a name="loc_33_9_33_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">
    | </span><a href="#loc_36_9_36_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_12&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">  = </span><a href="#loc_19_12_19_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_12_19_15&#39;)"><span class="hl_conref"><span class="mpre">DES</span></span></a><span class="mpre"> </span><a href="#loc_37_16_37_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_16_37_19&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;DES: not a valid key length (valid=8)&quot;</span></span><span class="mpre">
  where </span><a name="loc_36_9_36_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_12&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">  = </span><a href="Data.Byteable.html#loc_27_5_27_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_27_5_27_19&#39;)"><span class="hl_varref"><span class="mpre">byteableLength</span></span></a><span class="mpre"> </span><a href="#loc_33_9_33_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
        (</span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_17_19_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_17_19_22&#39;)"><span class="hl_conref"><span class="mpre">Block</span></span></a><span class="mpre"> </span><a name="loc_37_16_37_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_16_37_19&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre">) = </span><a href="Crypto.Cipher.DES.Serialization.html#loc_35_1_35_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Serialization.html#loc_35_1_35_6&#39;)"><span class="hl_varref"><span class="mpre">toW64</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Byteable.html#loc_24_5_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_24_5_24_12&#39;)"><span class="hl_varref"><span class="mpre">toBytes</span></span></a><span class="mpre"> </span><a href="#loc_33_9_33_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
</span></div></body></html>