<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns      #-}
{-# LANGUAGE OverloadedStrings #-}

module System.IO.Streams.Tests.Debug (tests) where

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Debug.hs&quot;, srcSpanStartLine = 7, srcSpanStartColumn = 18, srcSpanEndLine = 7, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre">          as S
import qualified System.IO.Streams              as Streams
import qualified System.IO.Streams.Debug        as Streams
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Debug.hs&quot;, srcSpanStartLine = 10, srcSpanStartColumn = 18, srcSpanEndLine = 10, srcSpanEndColumn = 32}, srcInfoPoints = []}) &quot;Test.Framework&quot;"><span class="mpre">Test.Framework</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Debug.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 18, srcSpanEndLine = 11, srcSpanEndColumn = 48}, srcInfoPoints = []}) &quot;Test.Framework.Providers.HUnit&quot;"><span class="mpre">Test.Framework.Providers.HUnit</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Debug.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 18, srcSpanEndLine = 12, srcSpanEndColumn = 28}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">                     hiding (Test)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_17_1_17_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_6&#39;)"><span class="mpre">tests</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">]
</span><a name="loc_17_1_17_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = [ </span><a href="#loc_24_1_24_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_1_24_15&#39;)"><span class="hl_varref"><span class="mpre">testDebugInput</span></span></a><span class="mpre">
        , </span><a href="#loc_46_1_46_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_16&#39;)"><span class="hl_varref"><span class="mpre">testDebugOutput</span></span></a><span class="mpre">
        ]


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_24_1_24_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_1_24_15&#39;)"><span class="mpre">testDebugInput</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_24_1_24_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_1_24_15&#39;)"><span class="hl_vardecl"><span class="mpre">testDebugInput</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;debug/input&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_25_5_25_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_6&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">Streams.fromList</span></span></a><span class="mpre"> [</span><span class="hl_varref"><span class="mpre">S.replicate</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;a&#39;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">]
    (</span><a name="loc_26_6_26_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_6_26_8&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">, </span><a name="loc_26_10_26_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_10_26_24&#39;)"><span class="hl_vardecl"><span class="mpre">getDebugOutput</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.List.html#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">Streams.listOutputStream</span></span></a><span class="mpre">
    </span><a name="loc_27_5_27_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_7&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Debug.html#loc_57_1_57_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Debug.html#loc_57_1_57_13&#39;)"><span class="hl_varref"><span class="mpre">Streams.debugInputBS</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre"> </span><a href="#loc_26_6_26_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_6_26_8&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre"> </span><a href="#loc_25_5_25_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">Streams.unRead</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;blah&quot;</span></span><span class="mpre"> </span><a href="#loc_27_5_27_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_7&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
    </span><a href="System.IO.Streams.Combinators.html#loc_423_1_423_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Combinators.html#loc_423_1_423_10&#39;)"><span class="hl_varref"><span class="mpre">Streams.skipToEof</span></span></a><span class="mpre"> </span><a href="#loc_27_5_27_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_7&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">

    </span><a name="loc_31_5_31_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_5_31_6&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_26_10_26_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_10_26_24&#39;)"><span class="hl_varref"><span class="mpre">getDebugOutput</span></span></a><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;debugInput&quot;</span></span><span class="mpre"> </span><a href="#loc_35_5_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_5_35_13&#39;)"><span class="hl_varref"><span class="mpre">expected</span></span></a><span class="mpre"> </span><a href="#loc_31_5_31_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_5_31_6&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
  where
    </span><a name="loc_35_5_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_5_35_13&#39;)"><span class="hl_vardecl"><span class="mpre">expected</span></span></a><span class="mpre"> = [
        </span><span class="hl_string"><span class="mpre">&quot;foo: pushback: \&quot;blah\&quot;\n&quot;</span></span><span class="mpre">
      , </span><span class="hl_string"><span class="mpre">&quot;foo: got chunk: \&quot;blah\&quot;\n&quot;</span></span><span class="mpre">
      , </span><span class="hl_string"><span class="mpre">&quot;foo: got chunk: \&quot;aaaaaaaaaaaaaa ... aaaaaaaaaaaaaa\&quot; (100 bytes)\n&quot;</span></span><span class="mpre">
      , </span><span class="hl_string"><span class="mpre">&quot;foo: got chunk: \&quot;foo\&quot;\n&quot;</span></span><span class="mpre">
      , </span><span class="hl_string"><span class="mpre">&quot;foo: got EOF\n&quot;</span></span><span class="mpre">
      ]


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_46_1_46_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_16&#39;)"><span class="mpre">testDebugOutput</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_46_1_46_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_16&#39;)"><span class="hl_vardecl"><span class="mpre">testDebugOutput</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;debug/output&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_47_5_47_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_7&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">Streams.fromList</span></span></a><span class="mpre"> [</span><span class="hl_varref"><span class="mpre">S.replicate</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;a&#39;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">]
    </span><a name="loc_48_5_48_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_5_48_6&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">Streams.makeOutputStream</span></span></a><span class="mpre"> </span><a href="#loc_57_5_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
    (</span><a name="loc_49_6_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_6_49_8&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">, </span><a name="loc_49_10_49_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_10_49_24&#39;)"><span class="hl_vardecl"><span class="mpre">getDebugOutput</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.List.html#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">Streams.listOutputStream</span></span></a><span class="mpre">
    </span><a name="loc_50_5_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_7&#39;)"><span class="hl_vardecl"><span class="mpre">o&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Debug.html#loc_88_1_88_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Debug.html#loc_88_1_88_14&#39;)"><span class="hl_varref"><span class="mpre">Streams.debugOutputBS</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre"> </span><a href="#loc_49_6_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_6_49_8&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre"> </span><a href="#loc_48_5_48_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_5_48_6&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">
    </span><a href="System.IO.Streams.Internal.html#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_188_1_188_8&#39;)"><span class="hl_varref"><span class="mpre">Streams.connect</span></span></a><span class="mpre"> </span><a href="#loc_47_5_47_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><a href="#loc_50_5_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_7&#39;)"><span class="hl_varref"><span class="mpre">o&#39;</span></span></a><span class="mpre">

    </span><a name="loc_53_5_53_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_6&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_49_10_49_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_10_49_24&#39;)"><span class="hl_varref"><span class="mpre">getDebugOutput</span></span></a><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;debugInput&quot;</span></span><span class="mpre"> </span><a href="#loc_59_5_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_13&#39;)"><span class="hl_varref"><span class="mpre">expected</span></span></a><span class="mpre"> </span><a href="#loc_53_5_53_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_6&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
  where
    </span><a name="loc_57_5_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> !_ = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

    </span><a name="loc_59_5_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_13&#39;)"><span class="hl_vardecl"><span class="mpre">expected</span></span></a><span class="mpre"> = [
        </span><span class="hl_string"><span class="mpre">&quot;foo: got chunk: \&quot;aaaaaaaaaaaaaa ... aaaaaaaaaaaaaa\&quot; (100 bytes)\n&quot;</span></span><span class="mpre">
      , </span><span class="hl_string"><span class="mpre">&quot;foo: got chunk: \&quot;foo\&quot;\n&quot;</span></span><span class="mpre">
      , </span><span class="hl_string"><span class="mpre">&quot;foo: got EOF\n&quot;</span></span><span class="mpre">
      ]

</span></div></body></html>