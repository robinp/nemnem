<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.X509.Validation.Fingerprint</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.X509.Validation.Fingerprint
    ( Fingerprint(..)
    , getFingerprint
    , toDescr
    ) where

import Crypto.PubKey.HashDescr
import Data.X509
import Data.ASN1.Types
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Fingerprint.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 8, srcSpanEndLine = 17, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import Data.Byteable

</span><span class="hl_comment"><span class="mpre">-- | Fingerprint of a certificate</span></span><span class="mpre">
newtype </span><a name="loc_21_9_21_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_9_21_20&#39;)"><span class="hl_tycondecl"><span class="mpre">Fingerprint</span></span></a><span class="mpre"> = </span><a name="loc_21_23_21_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_23_21_34&#39;)"><span class="hl_condecl"><span class="mpre">Fingerprint</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Fingerprint.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 5, srcSpanEndLine = 22, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Fingerprint.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 5, srcSpanEndLine = 22, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-valida"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

instance </span><a href="Data.Byteable.html#loc_22_7_22_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_22_7_22_15&#39;)"><span class="hl_classref"><span class="mpre">Byteable</span></span></a><span class="mpre"> </span><a href="#loc_21_9_21_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_9_21_20&#39;)"><span class="hl_tyconref"><span class="mpre">Fingerprint</span></span></a><span class="mpre"> where
    </span><a href="Data.Byteable.html#loc_24_5_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_24_5_24_12&#39;)"><span class="hl_fundecl"><span class="mpre">toBytes</span></span></a><span class="mpre"> (</span><a href="#loc_21_23_21_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_23_21_34&#39;)"><span class="hl_conref"><span class="mpre">Fingerprint</span></span></a><span class="mpre"> </span><a name="loc_25_26_25_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_26_25_28&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) = </span><a href="#loc_25_26_25_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_26_25_28&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get the fingerprint of the whole signed object</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- using the hashing algorithm specified</span></span><span class="mpre">
</span><a href="#loc_33_1_33_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_15&#39;)"><span class="mpre">getFingerprint</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Fingerprint.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 19, srcSpanEndLine = 30, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Fingerprint.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 19, srcSpanEndLine = 29, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-valid"><span class="mpre">(Show a, Eq a, ASN1Object a)
               =&gt;</span></span><span class="mpre"> </span><a href="Data.X509.Signed.html#loc_65_38_65_49" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_65_38_65_49&#39;)"><span class="hl_tyconref"><span class="mpre">SignedExact</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ object to fingerprint</span></span><span class="mpre">
               -&gt; </span><a href="Data.X509.AlgorithmIdentifier.html#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">HashALG</span></span></a><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ algorithm to compute the fingerprint</span></span><span class="mpre">
               -&gt; </span><a href="#loc_21_9_21_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_9_21_20&#39;)"><span class="hl_tyconref"><span class="mpre">Fingerprint</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ fingerprint in binary form</span></span><span class="mpre">
</span><a name="loc_33_1_33_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_15&#39;)"><span class="hl_fundecl"><span class="mpre">getFingerprint</span></span></a><span class="mpre"> </span><a name="loc_33_16_33_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_16_33_20&#39;)"><span class="hl_vardecl"><span class="mpre">sobj</span></span></a><span class="mpre"> </span><a name="loc_33_21_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_21_33_25&#39;)"><span class="hl_vardecl"><span class="mpre">halg</span></span></a><span class="mpre"> = </span><a href="#loc_21_23_21_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_23_21_34&#39;)"><span class="hl_conref"><span class="mpre">Fingerprint</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_35_9_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_14&#39;)"><span class="hl_varref"><span class="mpre">hashF</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.X509.Signed.html#loc_69_7_69_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_69_7_69_25&#39;)"><span class="hl_varref"><span class="mpre">encodeSignedObject</span></span></a><span class="mpre"> </span><a href="#loc_33_16_33_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_16_33_20&#39;)"><span class="hl_varref"><span class="mpre">sobj</span></span></a><span class="mpre">
  where </span><a name="loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_vardecl"><span class="mpre">hashDescr</span></span></a><span class="mpre"> = </span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_varref"><span class="mpre">toDescr</span></span></a><span class="mpre"> </span><a href="#loc_33_21_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_21_33_25&#39;)"><span class="hl_varref"><span class="mpre">halg</span></span></a><span class="mpre">
        </span><a name="loc_35_9_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_14&#39;)"><span class="hl_vardecl"><span class="mpre">hashF</span></span></a><span class="mpre">     = </span><a href="Crypto.PubKey.HashDescr.html#loc_37_30_37_42" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_37_30_37_42&#39;)"><span class="hl_varref"><span class="mpre">hashFunction</span></span></a><span class="mpre"> </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_varref"><span class="mpre">hashDescr</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert a hash algorithm into a Hash Description</span></span><span class="mpre">
</span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="mpre">toDescr</span></a><span class="mpre"> :: </span><a href="Data.X509.AlgorithmIdentifier.html#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">HashALG</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.PubKey.HashDescr.html#loc_37_6_37_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_37_6_37_15&#39;)"><span class="hl_tyconref"><span class="mpre">HashDescr</span></span></a><span class="mpre">
</span><a name="loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_fundecl"><span class="mpre">toDescr</span></span></a><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_19_7_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_19_7_19_14&#39;)"><span class="hl_conref"><span class="mpre">HashMD2</span></span></a><span class="mpre">    = </span><a href="Crypto.PubKey.HashDescr.html#loc_43_1_43_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_43_1_43_13&#39;)"><span class="hl_varref"><span class="mpre">hashDescrMD2</span></span></a><span class="mpre">
</span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_fundecl"><span class="mpre">toDescr</span></span></a><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_20_7_20_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_20_7_20_14&#39;)"><span class="hl_conref"><span class="mpre">HashMD5</span></span></a><span class="mpre">    = </span><a href="Crypto.PubKey.HashDescr.html#loc_49_1_49_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_49_1_49_13&#39;)"><span class="hl_varref"><span class="mpre">hashDescrMD5</span></span></a><span class="mpre">
</span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_fundecl"><span class="mpre">toDescr</span></span></a><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_21_7_21_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_21_7_21_15&#39;)"><span class="hl_conref"><span class="mpre">HashSHA1</span></span></a><span class="mpre">   = </span><a href="Crypto.PubKey.HashDescr.html#loc_55_1_55_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_55_1_55_14&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA1</span></span></a><span class="mpre">
</span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_fundecl"><span class="mpre">toDescr</span></span></a><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_22_7_22_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_22_7_22_17&#39;)"><span class="hl_conref"><span class="mpre">HashSHA224</span></span></a><span class="mpre"> = </span><a href="Crypto.PubKey.HashDescr.html#loc_61_1_61_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_61_1_61_16&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA224</span></span></a><span class="mpre">
</span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_fundecl"><span class="mpre">toDescr</span></span></a><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_23_7_23_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_23_7_23_17&#39;)"><span class="hl_conref"><span class="mpre">HashSHA256</span></span></a><span class="mpre"> = </span><a href="Crypto.PubKey.HashDescr.html#loc_67_1_67_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_67_1_67_16&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA256</span></span></a><span class="mpre">
</span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_fundecl"><span class="mpre">toDescr</span></span></a><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_24_7_24_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_24_7_24_17&#39;)"><span class="hl_conref"><span class="mpre">HashSHA384</span></span></a><span class="mpre"> = </span><a href="Crypto.PubKey.HashDescr.html#loc_73_1_73_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_73_1_73_16&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA384</span></span></a><span class="mpre">
</span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_fundecl"><span class="mpre">toDescr</span></span></a><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_25_7_25_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_25_7_25_17&#39;)"><span class="hl_conref"><span class="mpre">HashSHA512</span></span></a><span class="mpre"> = </span><a href="Crypto.PubKey.HashDescr.html#loc_79_1_79_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_79_1_79_16&#39;)"><span class="hl_varref"><span class="mpre">hashDescrSHA512</span></span></a><span class="mpre">
</span></div></body></html>