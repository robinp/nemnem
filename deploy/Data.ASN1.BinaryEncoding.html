<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.ASN1.BinaryEncoding</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A module containing ASN1 BER and DER specification encoding/decoding.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
{-# LANGUAGE EmptyDataDecls #-}
module Data.ASN1.BinaryEncoding
    ( BER(..)
    , DER(..)
    ) where

import Data.ASN1.Stream
import Data.ASN1.Types
import Data.ASN1.Types.Lowlevel
import Data.ASN1.Error
import Data.ASN1.Encoding
import Data.ASN1.BinaryEncoding.Parse
import Data.ASN1.BinaryEncoding.Writer
import Data.ASN1.Prim
import qualified Control.Exception as E

</span><span class="hl_comment"><span class="mpre">-- | Basic Encoding Rules (BER)</span></span><span class="mpre">
data </span><a name="loc_27_6_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_6_27_9&#39;)"><span class="hl_tycondecl"><span class="mpre">BER</span></span></a><span class="mpre"> = </span><a name="loc_27_12_27_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_12_27_15&#39;)"><span class="hl_condecl"><span class="mpre">BER</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Distinguished Encoding Rules (DER)</span></span><span class="mpre">
data </span><a name="loc_30_6_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_9&#39;)"><span class="hl_tycondecl"><span class="mpre">DER</span></span></a><span class="mpre"> = </span><a name="loc_30_12_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_12_30_15&#39;)"><span class="hl_condecl"><span class="mpre">DER</span></span></a><span class="mpre">

instance </span><a href="Data.ASN1.Encoding.html#loc_32_7_32_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_32_7_32_23&#39;)"><span class="hl_classref"><span class="mpre">ASN1DecodingRepr</span></span></a><span class="mpre"> </span><a href="#loc_27_6_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_6_27_9&#39;)"><span class="hl_tyconref"><span class="mpre">BER</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Encoding.html#loc_34_5_34_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_34_5_34_19&#39;)"><span class="hl_fundecl"><span class="mpre">decodeASN1Repr</span></span></a><span class="mpre"> _ </span><a name="loc_33_22_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_25&#39;)"><span class="hl_vardecl"><span class="mpre">lbs</span></span></a><span class="mpre"> = </span><a href="#loc_53_1_53_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_20&#39;)"><span class="hl_varref"><span class="mpre">decodeEventASN1Repr</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.Parse.html#loc_145_1_145_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.Parse.html#loc_145_1_145_9&#39;)"><span class="hl_varref"><span class="mpre">parseLBS</span></span></a><span class="mpre"> </span><a href="#loc_33_22_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_22_33_25&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre">

instance </span><a href="Data.ASN1.Encoding.html#loc_27_7_27_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_27_7_27_19&#39;)"><span class="hl_classref"><span class="mpre">ASN1Decoding</span></span></a><span class="mpre"> </span><a href="#loc_27_6_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_6_27_9&#39;)"><span class="hl_tyconref"><span class="mpre">BER</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Encoding.html#loc_29_5_29_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_29_5_29_15&#39;)"><span class="hl_fundecl"><span class="mpre">decodeASN1</span></span></a><span class="mpre"> _ </span><a name="loc_36_18_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_18_36_21&#39;)"><span class="hl_vardecl"><span class="mpre">lbs</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_53_1_53_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_20&#39;)"><span class="hl_varref"><span class="mpre">decodeEventASN1Repr</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.Parse.html#loc_145_1_145_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.Parse.html#loc_145_1_145_9&#39;)"><span class="hl_varref"><span class="mpre">parseLBS</span></span></a><span class="mpre"> </span><a href="#loc_36_18_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_18_36_21&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre">

instance </span><a href="Data.ASN1.Encoding.html#loc_32_7_32_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_32_7_32_23&#39;)"><span class="hl_classref"><span class="mpre">ASN1DecodingRepr</span></span></a><span class="mpre"> </span><a href="#loc_30_6_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_9&#39;)"><span class="hl_tyconref"><span class="mpre">DER</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Encoding.html#loc_34_5_34_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_34_5_34_19&#39;)"><span class="hl_fundecl"><span class="mpre">decodeASN1Repr</span></span></a><span class="mpre"> _ </span><a name="loc_39_22_39_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_22_39_25&#39;)"><span class="hl_vardecl"><span class="mpre">lbs</span></span></a><span class="mpre"> = </span><a href="#loc_53_1_53_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_20&#39;)"><span class="hl_varref"><span class="mpre">decodeEventASN1Repr</span></span></a><span class="mpre"> </span><a href="#loc_71_1_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_9&#39;)"><span class="hl_varref"><span class="mpre">checkDER</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.Parse.html#loc_145_1_145_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.Parse.html#loc_145_1_145_9&#39;)"><span class="hl_varref"><span class="mpre">parseLBS</span></span></a><span class="mpre"> </span><a href="#loc_39_22_39_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_22_39_25&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre">

instance </span><a href="Data.ASN1.Encoding.html#loc_27_7_27_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_27_7_27_19&#39;)"><span class="hl_classref"><span class="mpre">ASN1Decoding</span></span></a><span class="mpre"> </span><a href="#loc_30_6_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_9&#39;)"><span class="hl_tyconref"><span class="mpre">DER</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Encoding.html#loc_29_5_29_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_29_5_29_15&#39;)"><span class="hl_fundecl"><span class="mpre">decodeASN1</span></span></a><span class="mpre"> _ </span><a name="loc_42_18_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_18_42_21&#39;)"><span class="hl_vardecl"><span class="mpre">lbs</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_53_1_53_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_20&#39;)"><span class="hl_varref"><span class="mpre">decodeEventASN1Repr</span></span></a><span class="mpre"> </span><a href="#loc_71_1_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_9&#39;)"><span class="hl_varref"><span class="mpre">checkDER</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.Parse.html#loc_145_1_145_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.Parse.html#loc_145_1_145_9&#39;)"><span class="hl_varref"><span class="mpre">parseLBS</span></span></a><span class="mpre"> </span><a href="#loc_42_18_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_18_42_21&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre">

instance </span><a href="Data.ASN1.Encoding.html#loc_37_7_37_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_37_7_37_19&#39;)"><span class="hl_classref"><span class="mpre">ASN1Encoding</span></span></a><span class="mpre"> </span><a href="#loc_30_6_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_9&#39;)"><span class="hl_tyconref"><span class="mpre">DER</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Encoding.html#loc_39_5_39_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_39_5_39_15&#39;)"><span class="hl_fundecl"><span class="mpre">encodeASN1</span></span></a><span class="mpre"> _ </span><a name="loc_45_18_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_18_45_19&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="Data.ASN1.BinaryEncoding.Writer.html#loc_27_1_27_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.Writer.html#loc_27_1_27_17&#39;)"><span class="hl_varref"><span class="mpre">toLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_12&#39;)"><span class="hl_varref"><span class="mpre">encodeToRaw</span></span></a><span class="mpre"> </span><a href="#loc_45_18_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_18_45_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="mpre">decodeConstruction</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_6_39_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_6_39_16&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Header</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ASN1.Types.html#loc_32_6_32_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_6_32_26&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1ConstructionType</span></span></a><span class="mpre">
</span><a name="loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_fundecl"><span class="mpre">decodeConstruction</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29&#39;)"><span class="hl_conref"><span class="mpre">ASN1Header</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.Lowlevel.html#loc_23_18_23_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_23_18_23_27&#39;)"><span class="hl_conref"><span class="mpre">Universal</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10</span></span><span class="mpre"> _ _) = </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre">
</span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_fundecl"><span class="mpre">decodeConstruction</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29&#39;)"><span class="hl_conref"><span class="mpre">ASN1Header</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.Lowlevel.html#loc_23_18_23_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_23_18_23_27&#39;)"><span class="hl_conref"><span class="mpre">Universal</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x11</span></span><span class="mpre"> _ _) = </span><a href="Data.ASN1.Types.html#loc_33_29_33_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_33_29_33_32&#39;)"><span class="hl_conref"><span class="mpre">Set</span></span></a><span class="mpre">
</span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_fundecl"><span class="mpre">decodeConstruction</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29&#39;)"><span class="hl_conref"><span class="mpre">ASN1Header</span></span></a><span class="mpre"> </span><a name="loc_50_32_50_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_32_50_33&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_50_34_50_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_34_50_35&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> _ _)            = </span><a href="Data.ASN1.Types.html#loc_34_29_34_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_34_29_34_38&#39;)"><span class="hl_conref"><span class="mpre">Container</span></span></a><span class="mpre"> </span><a href="#loc_50_32_50_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_32_50_33&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_50_34_50_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_34_50_35&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><a href="#loc_53_1_53_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_20&#39;)"><span class="mpre">decodeEventASN1Repr</span></a><span class="mpre"> :: (</span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_6_39_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_6_39_16&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Header</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_6_20_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_6_20_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Error</span></span></a><span class="mpre">) -&gt; [</span><a href="Data.ASN1.Types.Lowlevel.html#loc_43_6_43_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_43_6_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Event</span></span></a><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">ASN1Repr</span></span><span class="mpre">]
</span><a name="loc_53_1_53_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_20&#39;)"><span class="hl_fundecl"><span class="mpre">decodeEventASN1Repr</span></span></a><span class="mpre"> </span><a name="loc_53_21_53_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_21_53_32&#39;)"><span class="hl_vardecl"><span class="mpre">checkHeader</span></span></a><span class="mpre"> </span><a name="loc_53_33_53_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_33_53_34&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_54_11_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_11_54_15&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> [] </span><a href="#loc_53_33_53_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_33_53_34&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
    where </span><a name="loc_54_11_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_11_54_15&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> _ []     = []
          </span><a href="#loc_54_11_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_11_54_15&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_55_16_55_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_16_55_19&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> (</span><a name="loc_55_21_55_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_21_55_22&#39;)"><span class="hl_specname"><span class="mpre">h</span></span></a><span class="mpre">@(</span><a href="Data.ASN1.Types.Lowlevel.html#loc_43_18_43_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_43_18_43_24&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a name="loc_55_31_55_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_31_55_34&#39;)"><span class="hl_specname"><span class="mpre">hdr</span></span></a><span class="mpre">@(</span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29&#39;)"><span class="hl_conref"><span class="mpre">ASN1Header</span></span></a><span class="mpre"> _ _ </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> _))</span><span class="hl_infix"><span class="mpre">:</span></span><a href="Data.ASN1.Types.Lowlevel.html#loc_45_18_45_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_45_18_45_35&#39;)"><span class="hl_conref"><span class="mpre">ConstructionBegin</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_55_78_55_80" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_78_55_80&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) =
                let </span><a name="loc_56_21_56_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_21_56_26&#39;)"><span class="hl_vardecl"><span class="mpre">ctype</span></span></a><span class="mpre"> = </span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_varref"><span class="mpre">decodeConstruction</span></span></a><span class="mpre"> </span><a href="#loc_55_31_55_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_31_55_34&#39;)"><span class="hl_varref"><span class="mpre">hdr</span></span></a><span class="mpre"> in
                case </span><a href="#loc_53_21_53_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_21_53_32&#39;)"><span class="hl_varref"><span class="mpre">checkHeader</span></span></a><span class="mpre"> </span><a href="#loc_55_31_55_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_31_55_34&#39;)"><span class="hl_varref"><span class="mpre">hdr</span></span></a><span class="mpre"> of
                    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  -&gt; (</span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="#loc_56_21_56_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_21_56_26&#39;)"><span class="hl_varref"><span class="mpre">ctype</span></span></a><span class="mpre">,[</span><a href="#loc_55_21_55_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_21_55_22&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">,</span><a href="Data.ASN1.Types.Lowlevel.html#loc_45_18_45_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_45_18_45_35&#39;)"><span class="hl_conref"><span class="mpre">ConstructionBegin</span></span></a><span class="mpre">]) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_54_11_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_11_54_15&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_56_21_56_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_21_56_26&#39;)"><span class="hl_varref"><span class="mpre">ctype</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_55_16_55_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_16_55_19&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">) </span><a href="#loc_55_78_55_80" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_78_55_80&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
                    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_59_26_59_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_26_59_29&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">E.throw</span></span><span class="mpre"> </span><a href="#loc_59_26_59_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_26_59_29&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
          </span><a href="#loc_54_11_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_11_54_15&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_60_16_60_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_16_60_19&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> (</span><a name="loc_60_21_60_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_21_60_22&#39;)"><span class="hl_specname"><span class="mpre">h</span></span></a><span class="mpre">@(</span><a href="Data.ASN1.Types.Lowlevel.html#loc_43_18_43_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_43_18_43_24&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a name="loc_60_31_60_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_31_60_34&#39;)"><span class="hl_specname"><span class="mpre">hdr</span></span></a><span class="mpre">@(</span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29&#39;)"><span class="hl_conref"><span class="mpre">ASN1Header</span></span></a><span class="mpre"> _ _ </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> _))</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_60_61_60_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_61_60_62&#39;)"><span class="hl_specname"><span class="mpre">p</span></span></a><span class="mpre">@(</span><a href="Data.ASN1.Types.Lowlevel.html#loc_44_18_44_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_44_18_44_27&#39;)"><span class="hl_conref"><span class="mpre">Primitive</span></span></a><span class="mpre"> </span><a name="loc_60_74_60_78" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_74_60_78&#39;)"><span class="hl_vardecl"><span class="mpre">prim</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_60_80_60_82" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_80_60_82&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) =
                case </span><a href="#loc_53_21_53_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_21_53_32&#39;)"><span class="hl_varref"><span class="mpre">checkHeader</span></span></a><span class="mpre"> </span><a href="#loc_60_31_60_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_31_60_34&#39;)"><span class="hl_varref"><span class="mpre">hdr</span></span></a><span class="mpre"> of
                    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; case </span><a href="Data.ASN1.Prim.html#loc_160_1_160_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Prim.html#loc_160_1_160_16&#39;)"><span class="hl_varref"><span class="mpre">decodePrimitive</span></span></a><span class="mpre"> </span><a href="#loc_60_31_60_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_31_60_34&#39;)"><span class="hl_varref"><span class="mpre">hdr</span></span></a><span class="mpre"> </span><a href="#loc_60_74_60_78" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_74_60_78&#39;)"><span class="hl_varref"><span class="mpre">prim</span></span></a><span class="mpre"> of
                        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_63_30_63_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_30_63_33&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">  -&gt; </span><span class="hl_varref"><span class="mpre">E.throw</span></span><span class="mpre"> </span><a href="#loc_63_30_63_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_30_63_33&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
                        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_64_31_64_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_31_64_34&#39;)"><span class="hl_vardecl"><span class="mpre">obj</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_64_31_64_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_31_64_34&#39;)"><span class="hl_varref"><span class="mpre">obj</span></span></a><span class="mpre">, [</span><a href="#loc_60_21_60_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_21_60_22&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">,</span><a href="#loc_60_61_60_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_61_60_62&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">]) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_54_11_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_11_54_15&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_60_16_60_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_16_60_19&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="#loc_60_80_60_82" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_80_60_82&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
                    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_65_26_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_26_65_29&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">E.throw</span></span><span class="mpre"> </span><a href="#loc_65_26_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_26_65_29&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
          </span><a href="#loc_54_11_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_11_54_15&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a name="loc_66_17_66_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_17_66_22&#39;)"><span class="hl_vardecl"><span class="mpre">ctype</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_66_23_66_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_23_66_26&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre">) (</span><a href="Data.ASN1.Types.Lowlevel.html#loc_46_18_46_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_46_18_46_33&#39;)"><span class="hl_conref"><span class="mpre">ConstructionEnd</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_66_45_66_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_45_66_47&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = (</span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="#loc_66_17_66_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_17_66_22&#39;)"><span class="hl_varref"><span class="mpre">ctype</span></span></a><span class="mpre">, [</span><a href="Data.ASN1.Types.Lowlevel.html#loc_46_18_46_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_46_18_46_33&#39;)"><span class="hl_conref"><span class="mpre">ConstructionEnd</span></span></a><span class="mpre">]) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_54_11_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_11_54_15&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_66_23_66_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_23_66_26&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="#loc_66_45_66_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_45_66_47&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
          </span><a href="#loc_54_11_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_11_54_15&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> _ (</span><a name="loc_67_19_67_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_19_67_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_varref"><span class="mpre">E.throw</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_23_18_23_43" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_23_18_23_43&#39;)"><span class="hl_conref"><span class="mpre">StreamUnexpectedSituation</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_67_19_67_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_19_67_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | DER header need to be all of finite size and of minimum possible size.</span></span><span class="mpre">
</span><a href="#loc_71_1_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_9&#39;)"><span class="mpre">checkDER</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_6_39_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_6_39_16&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Header</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_6_20_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_6_20_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Error</span></span></a><span class="mpre">
</span><a name="loc_71_1_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_9&#39;)"><span class="hl_fundecl"><span class="mpre">checkDER</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29&#39;)"><span class="hl_conref"><span class="mpre">ASN1Header</span></span></a><span class="mpre"> _ _ _ </span><a name="loc_71_28_71_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_28_71_31&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) = </span><a href="#loc_73_11_73_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_11_73_22&#39;)"><span class="hl_varref"><span class="mpre">checkLength</span></span></a><span class="mpre"> </span><a href="#loc_71_28_71_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_28_71_31&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
    where </span><a href="#loc_73_11_73_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_11_73_22&#39;)"><span class="mpre">checkLength</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Types.Lowlevel.html#loc_33_6_33_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_33_6_33_16&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Length</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_6_20_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_6_20_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Error</span></span></a><span class="mpre">
          </span><a name="loc_73_11_73_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_11_73_22&#39;)"><span class="hl_fundecl"><span class="mpre">checkLength</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.Lowlevel.html#loc_35_19_35_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_35_19_35_32&#39;)"><span class="hl_conref"><span class="mpre">LenIndefinite</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_28_18_28_30" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_28_18_28_30&#39;)"><span class="hl_conref"><span class="mpre">PolicyFailed</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;DER&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;indefinite length not allowed&quot;</span></span><span class="mpre">
          </span><a href="#loc_73_11_73_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_11_73_22&#39;)"><span class="hl_fundecl"><span class="mpre">checkLength</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.Lowlevel.html#loc_33_19_33_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_33_19_33_27&#39;)"><span class="hl_conref"><span class="mpre">LenShort</span></span></a><span class="mpre"> _)  = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
          </span><a href="#loc_73_11_73_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_11_73_22&#39;)"><span class="hl_fundecl"><span class="mpre">checkLength</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.Lowlevel.html#loc_34_19_34_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_34_19_34_26&#39;)"><span class="hl_conref"><span class="mpre">LenLong</span></span></a><span class="mpre"> </span><a name="loc_75_32_75_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_32_75_33&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_75_34_75_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_34_75_35&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">)
              | </span><a href="#loc_75_32_75_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_32_75_33&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_75_34_75_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_34_75_35&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_28_18_28_30" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_28_18_28_30&#39;)"><span class="hl_conref"><span class="mpre">PolicyFailed</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;DER&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;long length should be a short length&quot;</span></span><span class="mpre">
              | </span><a href="#loc_75_32_75_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_32_75_33&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_75_34_75_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_34_75_35&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">           = if </span><a href="#loc_75_34_75_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_34_75_35&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">^</span></span><span class="mpre">((</span><a href="#loc_75_32_75_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_32_75_33&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">*</span></span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_75_34_75_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_34_75_35&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">^</span></span><span class="mpre">(</span><a href="#loc_75_32_75_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_32_75_33&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)
                  then </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                  else </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_28_18_28_30" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_28_18_28_30&#39;)"><span class="hl_conref"><span class="mpre">PolicyFailed</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;DER&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;long length is not shortest&quot;</span></span><span class="mpre">

</span><a href="#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_12&#39;)"><span class="mpre">encodeToRaw</span></a><span class="mpre"> :: [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">] -&gt; [</span><a href="Data.ASN1.Types.Lowlevel.html#loc_43_6_43_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_43_6_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Event</span></span></a><span class="mpre">]
</span><a name="loc_83_1_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_12&#39;)"><span class="hl_vardecl"><span class="mpre">encodeToRaw</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_84_11_84_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_11_84_20&#39;)"><span class="hl_varref"><span class="mpre">writeTree</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_87_11_87_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_17&#39;)"><span class="hl_varref"><span class="mpre">mkTree</span></span></a><span class="mpre">
    where </span><a name="loc_84_11_84_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_11_84_20&#39;)"><span class="hl_fundecl"><span class="mpre">writeTree</span></span></a><span class="mpre"> (</span><a name="loc_84_22_84_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_22_84_23&#39;)"><span class="hl_specname"><span class="mpre">p</span></span></a><span class="mpre">@(</span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> _),</span><a name="loc_84_34_84_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_34_84_42&#39;)"><span class="hl_vardecl"><span class="mpre">children</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.Prim.html#loc_142_1_142_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Prim.html#loc_142_1_142_18&#39;)"><span class="hl_varref"><span class="mpre">encodeConstructed</span></span></a><span class="mpre"> </span><a href="#loc_84_22_84_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_22_84_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_84_34_84_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_34_84_42&#39;)"><span class="hl_varref"><span class="mpre">children</span></span></a><span class="mpre">
          </span><a href="#loc_84_11_84_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_11_84_20&#39;)"><span class="hl_fundecl"><span class="mpre">writeTree</span></span></a><span class="mpre"> (</span><a name="loc_85_22_85_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_22_85_23&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,_)                  = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.Prim.html#loc_111_1_111_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Prim.html#loc_111_1_111_16&#39;)"><span class="hl_varref"><span class="mpre">encodePrimitive</span></span></a><span class="mpre"> </span><a href="#loc_85_22_85_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_22_85_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

          </span><a name="loc_87_11_87_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_17&#39;)"><span class="hl_fundecl"><span class="mpre">mkTree</span></span></a><span class="mpre"> []           = []
          </span><a href="#loc_87_11_87_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_17&#39;)"><span class="hl_fundecl"><span class="mpre">mkTree</span></span></a><span class="mpre"> (</span><a name="loc_88_19_88_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_19_88_20&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@(</span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> _)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_88_31_88_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_31_88_33&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) =
              let (</span><a name="loc_89_20_89_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_20_89_24&#39;)"><span class="hl_vardecl"><span class="mpre">tree</span></span></a><span class="mpre">, </span><a name="loc_89_26_89_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_26_89_27&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_94_11_94_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_18&#39;)"><span class="hl_varref"><span class="mpre">spanEnd</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_88_31_88_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_31_88_33&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
               in (</span><a href="#loc_88_19_88_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_19_88_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_89_20_89_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_20_89_24&#39;)"><span class="hl_varref"><span class="mpre">tree</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_87_11_87_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_17&#39;)"><span class="hl_varref"><span class="mpre">mkTree</span></span></a><span class="mpre"> </span><a href="#loc_89_26_89_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_26_89_27&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
          </span><a href="#loc_87_11_87_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_17&#39;)"><span class="hl_fundecl"><span class="mpre">mkTree</span></span></a><span class="mpre"> (</span><a name="loc_91_19_91_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_19_91_20&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_91_21_91_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_21_91_23&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)       = (</span><a href="#loc_91_19_91_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_19_91_20&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,[]) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_87_11_87_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_17&#39;)"><span class="hl_varref"><span class="mpre">mkTree</span></span></a><span class="mpre"> </span><a href="#loc_91_21_91_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_21_91_23&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

          </span><a href="#loc_94_11_94_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_18&#39;)"><span class="mpre">spanEnd</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">] -&gt; ([</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">], [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">])
          </span><a name="loc_94_11_94_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_18&#39;)"><span class="hl_fundecl"><span class="mpre">spanEnd</span></span></a><span class="mpre"> _ []             = ([], [])
          </span><a href="#loc_94_11_94_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_18&#39;)"><span class="hl_fundecl"><span class="mpre">spanEnd</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><a name="loc_95_22_95_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_22_95_23&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@(</span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> _)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_95_32_95_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_32_95_34&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = ([</span><a href="#loc_95_22_95_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_22_95_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">], </span><a href="#loc_95_32_95_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_32_95_34&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
          </span><a href="#loc_94_11_94_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_18&#39;)"><span class="hl_fundecl"><span class="mpre">spanEnd</span></span></a><span class="mpre"> </span><a name="loc_96_19_96_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_19_96_22&#39;)"><span class="hl_vardecl"><span class="mpre">lvl</span></span></a><span class="mpre"> (</span><a name="loc_96_24_96_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_24_96_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_96_26_96_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_26_96_28&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)       = case </span><a href="#loc_96_24_96_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_24_96_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
                    </span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> _ -&gt; let (</span><a name="loc_97_37_97_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_37_97_39&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">, </span><a name="loc_97_41_97_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_41_97_43&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre">) = </span><a href="#loc_94_11_94_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_18&#39;)"><span class="hl_varref"><span class="mpre">spanEnd</span></span></a><span class="mpre"> (</span><a href="#loc_96_19_96_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_19_96_22&#39;)"><span class="hl_varref"><span class="mpre">lvl</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_96_26_96_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_26_96_28&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> in (</span><a href="#loc_96_24_96_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_24_96_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_97_37_97_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_37_97_39&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">, </span><a href="#loc_97_41_97_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_41_97_43&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">)
                    </span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> _   -&gt; let (</span><a name="loc_98_37_98_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_37_98_39&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">, </span><a name="loc_98_41_98_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_41_98_43&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre">) = </span><a href="#loc_94_11_94_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_18&#39;)"><span class="hl_varref"><span class="mpre">spanEnd</span></span></a><span class="mpre"> (</span><a href="#loc_96_19_96_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_19_96_22&#39;)"><span class="hl_varref"><span class="mpre">lvl</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_96_26_96_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_26_96_28&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> in (</span><a href="#loc_96_24_96_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_24_96_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_98_37_98_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_37_98_39&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">, </span><a href="#loc_98_41_98_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_41_98_43&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">)
                    _       -&gt; let (</span><a name="loc_99_37_99_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_37_99_39&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">, </span><a name="loc_99_41_99_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_41_99_43&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre">) = </span><a href="#loc_94_11_94_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_11_94_18&#39;)"><span class="hl_varref"><span class="mpre">spanEnd</span></span></a><span class="mpre"> </span><a href="#loc_96_19_96_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_19_96_22&#39;)"><span class="hl_varref"><span class="mpre">lvl</span></span></a><span class="mpre"> </span><a href="#loc_96_26_96_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_26_96_28&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> in (</span><a href="#loc_96_24_96_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_24_96_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_99_37_99_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_37_99_39&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">, </span><a href="#loc_99_41_99_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_41_99_43&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre">)
</span></div></body></html>