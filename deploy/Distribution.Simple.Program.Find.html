<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Distribution.Simple.Program.Types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  Duncan Coutts 2013</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  cabal-devel@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A somewhat extended notion of the normal program search path concept.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Usually when finding executables we just want to look in the usual places</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- using the OS&#39;s usual method for doing so. In Haskell the normal OS-specific</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- method is captured by &#39;findExecutable&#39;. On all common OSs that makes use of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a @PATH@ environment variable, (though on Windows it is not just the @PATH@).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- However it is sometimes useful to be able to look in additional locations</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- without having to change the process-global @PATH@ environment variable.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- So we need an extension of the usual &#39;findExecutable&#39; that can look in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- additional locations, either before, after or instead of the normal OS</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- locations.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Distribution.Simple.Program.Find (
    </span><span class="hl_comment"><span class="mpre">-- * Program search path</span></span><span class="mpre">
    ProgramSearchPath,
    ProgramSearchPathEntry(..),
    defaultProgramSearchPath,
    findProgramOnSearchPath,
    programSearchPathAsPATHVar,
  ) where

import Distribution.Verbosity
         ( </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="mpre">Verbosity</span></a><span class="mpre"> )
import Distribution.Simple.Utils
         ( </span><a href="Distribution.Simple.Utils.html#loc_314_1_314_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_314_1_314_6&#39;)"><span class="mpre">debug</span></a><span class="mpre"> )
import Distribution.System
         ( </span><a href="Distribution.System.html#loc_66_6_66_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.System.html#loc_66_6_66_8&#39;)"><span class="mpre">OS</span></a><span class="mpre">(..), </span><a href="Distribution.System.html#loc_112_1_112_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.System.html#loc_112_1_112_8&#39;)"><span class="mpre">buildOS</span></a><span class="mpre"> )
import System.Directory
         ( </span><a href="System.Directory.html#loc_592_1_592_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_592_1_592_15&#39;)"><span class="mpre">findExecutable</span></a><span class="mpre">, </span><a href="System.Directory.html#loc_726_1_726_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_726_1_726_14&#39;)"><span class="mpre">doesFileExist</span></a><span class="mpre">, </span><a href="System.Directory.html#loc_134_6_134_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_134_6_134_17&#39;)"><span class="mpre">Permissions</span></a><span class="mpre">(..), </span><a href="System.Directory.html#loc_153_1_153_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_153_1_153_15&#39;)"><span class="mpre">getPermissions</span></a><span class="mpre"> )
import Distribution.Compat.Environment
         ( </span><a href="Distribution.Compat.Environment.html#loc_18_1_18_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Environment.html#loc_18_1_18_15&#39;)"><span class="mpre">getEnvironment</span></a><span class="mpre"> )
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Find.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 8, srcSpanEndLine = 41, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;System.FilePath&quot;"><span class="mpre">System.FilePath</span></span><span class="mpre">
         ( (&lt;/&gt;), (&lt;.&gt;), splitSearchPath, searchPathSeparator )
import Data.List
         ( </span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="mpre">intercalate</span></a><span class="mpre"> )


</span><span class="hl_comment"><span class="mpre">-- | A search path to use when locating executables. This is analogous</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to the unix @$PATH@ or win32 @%PATH%@ but with the ability to use</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the system default method for finding executables (&#39;findExecutable&#39; which</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- on unix is simply looking on the @$PATH@ but on win32 is a bit more</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- complicated).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The default to use is @[ProgSearchPathDefault]@ but you can add extra dirs</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- either before, after or instead of the default, e.g. here we add an extra</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- dir to search after the usual ones.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; [&#39;ProgramSearchPathDefault&#39;, &#39;ProgramSearchPathDir&#39; dir]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Find.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 1, srcSpanEndLine = 59, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Find.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 1, srcSpanEndLine = 59, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distributio"><span class="mpre">type ProgramSearchPath = [ProgramSearchPathEntry]</span></span><span class="mpre">
data </span><a name="loc_60_6_60_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_6_60_28&#39;)"><span class="hl_tycondecl"><span class="mpre">ProgramSearchPathEntry</span></span></a><span class="mpre"> =
         </span><a name="loc_61_10_61_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_10_61_30&#39;)"><span class="hl_condecl"><span class="mpre">ProgramSearchPathDir</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ A specific dir</span></span><span class="mpre">
       | </span><a name="loc_62_10_62_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_10_62_34&#39;)"><span class="hl_condecl"><span class="mpre">ProgramSearchPathDefault</span></span></a><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ The system default</span></span><span class="mpre">

</span><a href="#loc_65_1_65_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_25&#39;)"><span class="mpre">defaultProgramSearchPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ProgramSearchPath</span></span><span class="mpre">
</span><a name="loc_65_1_65_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_25&#39;)"><span class="hl_vardecl"><span class="mpre">defaultProgramSearchPath</span></span></a><span class="mpre"> = [</span><a href="#loc_62_10_62_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_10_62_34&#39;)"><span class="hl_conref"><span class="mpre">ProgramSearchPathDefault</span></span></a><span class="mpre">]

</span><a href="#loc_69_1_69_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_24&#39;)"><span class="mpre">findProgramOnSearchPath</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ProgramSearchPath</span></span><span class="mpre">
                        -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)
</span><a name="loc_69_1_69_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_24&#39;)"><span class="hl_fundecl"><span class="mpre">findProgramOnSearchPath</span></span></a><span class="mpre"> </span><a name="loc_69_25_69_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_25_69_34&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_69_35_69_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_35_69_45&#39;)"><span class="hl_vardecl"><span class="mpre">searchpath</span></span></a><span class="mpre"> </span><a name="loc_69_46_69_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_46_69_50&#39;)"><span class="hl_vardecl"><span class="mpre">prog</span></span></a><span class="mpre"> = do
    </span><a href="Distribution.Simple.Utils.html#loc_314_1_314_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_314_1_314_6&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_69_25_69_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_25_69_34&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Searching for &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_69_46_69_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_46_69_50&#39;)"><span class="hl_varref"><span class="mpre">prog</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; in path.&quot;</span></span><span class="mpre">
    </span><a name="loc_71_5_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_8&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_77_5_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_17&#39;)"><span class="hl_varref"><span class="mpre">tryPathElems</span></span></a><span class="mpre"> </span><a href="#loc_69_35_69_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_35_69_45&#39;)"><span class="hl_varref"><span class="mpre">searchpath</span></span></a><span class="mpre">
    case </span><a href="#loc_71_5_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_8&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> of
      </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">   -&gt; </span><a href="Distribution.Simple.Utils.html#loc_314_1_314_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_314_1_314_6&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_69_25_69_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_25_69_34&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Cannot find &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_69_46_69_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_46_69_50&#39;)"><span class="hl_varref"><span class="mpre">prog</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; on the path&quot;</span></span><span class="mpre">)
      </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_74_12_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_12_74_16&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> -&gt; </span><a href="Distribution.Simple.Utils.html#loc_314_1_314_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_314_1_314_6&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_69_25_69_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_25_69_34&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Found &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_69_46_69_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_46_69_50&#39;)"><span class="hl_varref"><span class="mpre">prog</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; at &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_74_12_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_12_74_16&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_71_5_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_8&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">
  where
    </span><a name="loc_77_5_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_17&#39;)"><span class="hl_fundecl"><span class="mpre">tryPathElems</span></span></a><span class="mpre"> []       = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    </span><a href="#loc_77_5_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_17&#39;)"><span class="hl_fundecl"><span class="mpre">tryPathElems</span></span></a><span class="mpre"> (</span><a name="loc_78_19_78_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_19_78_21&#39;)"><span class="hl_vardecl"><span class="mpre">pe</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_78_22_78_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_22_78_25&#39;)"><span class="hl_vardecl"><span class="mpre">pes</span></span></a><span class="mpre">) = do
      </span><a name="loc_79_7_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_7_79_10&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_84_5_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_16&#39;)"><span class="hl_varref"><span class="mpre">tryPathElem</span></span></a><span class="mpre"> </span><a href="#loc_78_19_78_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_19_78_21&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre">
      case </span><a href="#loc_79_7_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_7_79_10&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_77_5_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_17&#39;)"><span class="hl_varref"><span class="mpre">tryPathElems</span></span></a><span class="mpre"> </span><a href="#loc_78_22_78_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_22_78_25&#39;)"><span class="hl_varref"><span class="mpre">pes</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> _  -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_79_7_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_7_79_10&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">

    </span><a name="loc_84_5_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_16&#39;)"><span class="hl_fundecl"><span class="mpre">tryPathElem</span></span></a><span class="mpre"> (</span><a href="#loc_61_10_61_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_10_61_30&#39;)"><span class="hl_conref"><span class="mpre">ProgramSearchPathDir</span></span></a><span class="mpre"> </span><a name="loc_84_39_84_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_39_84_42&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre">) =
        </span><a href="#loc_97_5_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_17&#39;)"><span class="hl_varref"><span class="mpre">findFirstExe</span></span></a><span class="mpre"> [ </span><a href="#loc_84_39_84_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_39_84_42&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_69_46_69_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_46_69_50&#39;)"><span class="hl_varref"><span class="mpre">prog</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;.&gt;</span></span><span class="mpre"> </span><a href="#loc_85_47_85_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_47_85_50&#39;)"><span class="hl_varref"><span class="mpre">ext</span></span></a><span class="mpre"> | </span><a name="loc_85_47_85_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_47_85_50&#39;)"><span class="hl_vardecl"><span class="mpre">ext</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_90_9_90_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_9_90_19&#39;)"><span class="hl_varref"><span class="mpre">extensions</span></span></a><span class="mpre"> ]
      where
        </span><span class="hl_comment"><span class="mpre">-- Possible improvement: on Windows, read the list of extensions from</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- the PATHEXT environment variable. By default PATHEXT is &quot;.com; .exe;</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- .bat; .cmd&quot;.</span></span><span class="mpre">
        </span><a name="loc_90_9_90_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_9_90_19&#39;)"><span class="hl_vardecl"><span class="mpre">extensions</span></span></a><span class="mpre"> = case </span><a href="Distribution.System.html#loc_112_1_112_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.System.html#loc_112_1_112_8&#39;)"><span class="hl_varref"><span class="mpre">buildOS</span></span></a><span class="mpre"> of
                       </span><a href="Distribution.System.html#loc_66_19_66_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.System.html#loc_66_19_66_26&#39;)"><span class="hl_conref"><span class="mpre">Windows</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;exe&quot;</span></span><span class="mpre">]
                       _       -&gt; [</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">]

    </span><a href="#loc_84_5_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_16&#39;)"><span class="hl_fundecl"><span class="mpre">tryPathElem</span></span></a><span class="mpre"> </span><a href="#loc_62_10_62_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_10_62_34&#39;)"><span class="hl_conref"><span class="mpre">ProgramSearchPathDefault</span></span></a><span class="mpre"> =
      </span><a href="System.Directory.html#loc_592_1_592_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_592_1_592_15&#39;)"><span class="hl_varref"><span class="mpre">findExecutable</span></span></a><span class="mpre"> </span><a href="#loc_69_46_69_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_46_69_50&#39;)"><span class="hl_varref"><span class="mpre">prog</span></span></a><span class="mpre">

    </span><a name="loc_97_5_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_17&#39;)"><span class="hl_fundecl"><span class="mpre">findFirstExe</span></span></a><span class="mpre"> []     = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    </span><a href="#loc_97_5_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_17&#39;)"><span class="hl_fundecl"><span class="mpre">findFirstExe</span></span></a><span class="mpre"> (</span><a name="loc_98_19_98_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_19_98_20&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_98_21_98_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_21_98_23&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre">) = do
      </span><a name="loc_99_7_99_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_7_99_13&#39;)"><span class="hl_vardecl"><span class="mpre">exists</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_726_1_726_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_726_1_726_14&#39;)"><span class="hl_varref"><span class="mpre">doesFileExist</span></span></a><span class="mpre"> </span><a href="#loc_98_19_98_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_19_98_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
      if </span><a href="#loc_99_7_99_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_7_99_13&#39;)"><span class="hl_varref"><span class="mpre">exists</span></span></a><span class="mpre">
        then do </span><a name="loc_101_17_101_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_17_101_22&#39;)"><span class="hl_vardecl"><span class="mpre">perms</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_153_1_153_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_153_1_153_15&#39;)"><span class="hl_varref"><span class="mpre">getPermissions</span></span></a><span class="mpre"> </span><a href="#loc_98_19_98_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_19_98_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
                if </span><a href="System.Directory.html#loc_137_5_137_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_137_5_137_15&#39;)"><span class="hl_varref"><span class="mpre">executable</span></span></a><span class="mpre"> </span><a href="#loc_101_17_101_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_17_101_22&#39;)"><span class="hl_varref"><span class="mpre">perms</span></span></a><span class="mpre">
                  then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_98_19_98_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_19_98_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
                  else </span><a href="#loc_97_5_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_17&#39;)"><span class="hl_varref"><span class="mpre">findFirstExe</span></span></a><span class="mpre"> </span><a href="#loc_98_21_98_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_21_98_23&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre">
        else </span><a href="#loc_97_5_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_17&#39;)"><span class="hl_varref"><span class="mpre">findFirstExe</span></span></a><span class="mpre"> </span><a href="#loc_98_21_98_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_21_98_23&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Interpret a &#39;ProgramSearchPath&#39; to construct a new @$PATH@ env var.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that this is close but not perfect because on Windows the search</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- algorithm looks at more than just the @%PATH%@.</span></span><span class="mpre">
</span><a href="#loc_112_1_112_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_27&#39;)"><span class="mpre">programSearchPathAsPATHVar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ProgramSearchPath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_112_1_112_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_27&#39;)"><span class="hl_fundecl"><span class="mpre">programSearchPathAsPATHVar</span></span></a><span class="mpre"> </span><a name="loc_112_28_112_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_28_112_38&#39;)"><span class="hl_vardecl"><span class="mpre">searchpath</span></span></a><span class="mpre"> = do
    </span><a name="loc_113_5_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_8&#39;)"><span class="hl_vardecl"><span class="mpre">ess</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> </span><a href="#loc_116_5_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_5_116_15&#39;)"><span class="hl_varref"><span class="mpre">getEntries</span></span></a><span class="mpre"> </span><a href="#loc_112_28_112_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_28_112_38&#39;)"><span class="hl_varref"><span class="mpre">searchpath</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="hl_varref"><span class="mpre">intercalate</span></span></a><span class="mpre"> [</span><span class="hl_varref"><span class="mpre">searchPathSeparator</span></span><span class="mpre">] (</span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_113_5_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_8&#39;)"><span class="hl_varref"><span class="mpre">ess</span></span></a><span class="mpre">))
  where
    </span><a name="loc_116_5_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_5_116_15&#39;)"><span class="hl_fundecl"><span class="mpre">getEntries</span></span></a><span class="mpre"> (</span><a href="#loc_61_10_61_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_10_61_30&#39;)"><span class="hl_conref"><span class="mpre">ProgramSearchPathDir</span></span></a><span class="mpre"> </span><a name="loc_116_38_116_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_38_116_41&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_116_38_116_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_38_116_41&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">]
    </span><a href="#loc_116_5_116_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_5_116_15&#39;)"><span class="hl_fundecl"><span class="mpre">getEntries</span></span></a><span class="mpre"> </span><a href="#loc_62_10_62_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_10_62_34&#39;)"><span class="hl_conref"><span class="mpre">ProgramSearchPathDefault</span></span></a><span class="mpre">   = do
      </span><a name="loc_118_7_118_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_7_118_10&#39;)"><span class="hl_vardecl"><span class="mpre">env</span></span></a><span class="mpre"> &lt;- </span><a href="Distribution.Compat.Environment.html#loc_18_1_18_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Environment.html#loc_18_1_18_15&#39;)"><span class="hl_varref"><span class="mpre">getEnvironment</span></span></a><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> [] </span><span class="hl_varref"><span class="mpre">splitSearchPath</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;PATH&quot;</span></span><span class="mpre"> </span><a href="#loc_118_7_118_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_7_118_10&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre">))
</span></div></body></html>