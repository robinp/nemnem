<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.ASN1.BinaryEncoding.Parse</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Generic parsing facility for ASN1.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.ASN1.BinaryEncoding.Parse
    (
    </span><span class="hl_comment"><span class="mpre">-- * incremental parsing interfaces</span></span><span class="mpre">
      runParseState
    , isParseDone
    , newParseState
    , ParseState
    , ParseCursor
    </span><span class="hl_comment"><span class="mpre">-- * simple parsing interfaces</span></span><span class="mpre">
    , parseLBS
    , parseBS
    ) where

import Control.Arrow (</span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="mpre">first</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/BinaryEncoding/Parse.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 8, srcSpanEndLine = 24, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/BinaryEncoding/Parse.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 18, srcSpanEndLine = 25, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/BinaryEncoding/Parse.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 18, srcSpanEndLine = 26, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import Data.ASN1.Error
import Data.ASN1.Types
import Data.ASN1.Types.Lowlevel
import Data.ASN1.Get
import Data.ASN1.Serialize
import Data.Word
import Data.Maybe (</span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="mpre">fromJust</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | nothing means the parser stop this construction on</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- an ASN1 end tag, otherwise specify the position</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- where the construction terminate.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/BinaryEncoding/Parse.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 1, srcSpanEndLine = 38, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/BinaryEncoding/Parse.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 1, srcSpanEndLine = 38, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0."><span class="mpre">type ConstructionEndAt = Maybe Word64</span></span><span class="mpre">

data </span><a name="loc_40_6_40_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_17&#39;)"><span class="hl_tycondecl"><span class="mpre">ParseExpect</span></span></a><span class="mpre"> = </span><a name="loc_40_20_40_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_20_40_32&#39;)"><span class="hl_condecl"><span class="mpre">ExpectHeader</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Data.ASN1.Get.html#loc_39_6_39_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Get.html#loc_39_6_39_12&#39;)"><span class="hl_tyconref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_6_39_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_6_39_16&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Header</span></span></a><span class="mpre">))
                 | </span><a name="loc_41_20_41_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_35&#39;)"><span class="hl_condecl"><span class="mpre">ExpectPrimitive</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Data.ASN1.Get.html#loc_39_6_39_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Get.html#loc_39_6_39_12&#39;)"><span class="hl_tyconref"><span class="mpre">Result</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">))

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/BinaryEncoding/Parse.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 1, srcSpanEndLine = 43, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/BinaryEncoding/Parse.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 1, srcSpanEndLine = 43, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0."><span class="mpre">type ParsePosition = Word64</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | represent the parsing state of an ASN1 stream.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * the stack of constructed elements.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * the next expected type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * the position in the stream.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
data </span><a name="loc_51_6_51_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_16&#39;)"><span class="hl_tycondecl"><span class="mpre">ParseState</span></span></a><span class="mpre"> = </span><a name="loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_condecl"><span class="mpre">ParseState</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">ConstructionEndAt</span></span><span class="mpre">] </span><a href="#loc_40_6_40_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_17&#39;)"><span class="hl_tyconref"><span class="mpre">ParseExpect</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ParsePosition</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | create a new empty parse state. position is 0</span></span><span class="mpre">
</span><a href="#loc_55_1_55_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_14&#39;)"><span class="mpre">newParseState</span></a><span class="mpre"> :: </span><a href="#loc_51_6_51_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_16&#39;)"><span class="hl_tyconref"><span class="mpre">ParseState</span></span></a><span class="mpre">
</span><a name="loc_55_1_55_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_14&#39;)"><span class="hl_vardecl"><span class="mpre">newParseState</span></span></a><span class="mpre"> = </span><a href="#loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_conref"><span class="mpre">ParseState</span></span></a><span class="mpre"> [] (</span><a href="#loc_40_20_40_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_20_40_32&#39;)"><span class="hl_conref"><span class="mpre">ExpectHeader</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><a href="#loc_58_1_58_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_6&#39;)"><span class="mpre">isEOC</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_6_39_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_6_39_16&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Header</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_58_1_58_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_6&#39;)"><span class="hl_fundecl"><span class="mpre">isEOC</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29&#39;)"><span class="hl_conref"><span class="mpre">ASN1Header</span></span></a><span class="mpre"> </span><a name="loc_58_19_58_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_19_58_21&#39;)"><span class="hl_vardecl"><span class="mpre">cl</span></span></a><span class="mpre"> </span><a name="loc_58_22_58_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_22_58_23&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> _ _) = </span><a href="#loc_58_19_58_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_19_58_21&#39;)"><span class="hl_varref"><span class="mpre">cl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.Lowlevel.html#loc_23_18_23_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_23_18_23_27&#39;)"><span class="hl_conref"><span class="mpre">Universal</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_58_22_58_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_22_58_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><a href="#loc_61_1_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_18&#39;)"><span class="mpre">asn1LengthToConst</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Types.Lowlevel.html#loc_33_6_33_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_33_6_33_16&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Length</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">
</span><a name="loc_61_1_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_18&#39;)"><span class="hl_fundecl"><span class="mpre">asn1LengthToConst</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.Lowlevel.html#loc_33_19_33_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_33_19_33_27&#39;)"><span class="hl_conref"><span class="mpre">LenShort</span></span></a><span class="mpre"> </span><a name="loc_61_29_61_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_29_61_30&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">)  = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_61_29_61_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_29_61_30&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
</span><a href="#loc_61_1_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_18&#39;)"><span class="hl_fundecl"><span class="mpre">asn1LengthToConst</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.Lowlevel.html#loc_34_19_34_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_34_19_34_26&#39;)"><span class="hl_conref"><span class="mpre">LenLong</span></span></a><span class="mpre"> _ </span><a name="loc_62_30_62_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_30_62_31&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_62_30_62_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_30_62_31&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
</span><a href="#loc_61_1_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_18&#39;)"><span class="hl_fundecl"><span class="mpre">asn1LengthToConst</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.Lowlevel.html#loc_35_19_35_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_35_19_35_32&#39;)"><span class="hl_conref"><span class="mpre">LenIndefinite</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- in the future, drop this for the `mplus` with Either.</span></span><span class="mpre">
</span><a href="#loc_67_1_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_12&#39;)"><span class="mpre">mplusEither</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">
</span><a name="loc_67_1_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_12&#39;)"><span class="hl_fundecl"><span class="mpre">mplusEither</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_67_19_67_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_19_67_20&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) _  = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_67_19_67_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_19_67_20&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
</span><a href="#loc_67_1_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_12&#39;)"><span class="hl_fundecl"><span class="mpre">mplusEither</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_68_20_68_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_20_68_21&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) </span><a name="loc_68_23_68_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_23_68_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_68_23_68_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_23_68_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_68_20_68_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_20_68_21&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Represent the events and state thus far.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/BinaryEncoding/Parse.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 1, srcSpanEndLine = 71, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0.8.1.3/Data/ASN1/BinaryEncoding/Parse.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 1, srcSpanEndLine = 71, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-encoding-0."><span class="mpre">type ParseCursor = ([ASN1Event], ParseState)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | run incrementally the ASN1 parser on a bytestring.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the result can be either an error, or on success a list</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of events, and the new parsing state.</span></span><span class="mpre">
</span><a href="#loc_79_1_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_14&#39;)"><span class="mpre">runParseState</span></a><span class="mpre"> :: </span><a href="#loc_51_6_51_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_16&#39;)"><span class="hl_tyconref"><span class="mpre">ParseState</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ parser state</span></span><span class="mpre">
              -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ input data as bytes</span></span><span class="mpre">
              -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_6_20_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_6_20_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Error</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ParseCursor</span></span><span class="mpre">
</span><a name="loc_79_1_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_14&#39;)"><span class="hl_vardecl"><span class="mpre">runParseState</span></span></a><span class="mpre"> = </span><a href="#loc_81_12_81_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_12_81_16&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
     where
           </span><a name="loc_81_12_81_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_12_81_16&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_81_17_81_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_25&#39;)"><span class="hl_vardecl"><span class="mpre">iniState</span></span></a><span class="mpre"> </span><a name="loc_81_26_81_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_26_81_28&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">
                | </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_81_26_81_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_26_81_28&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_87_12_87_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_28&#39;)"><span class="hl_varref"><span class="mpre">terminateAugment</span></span></a><span class="mpre"> (([], </span><a href="#loc_81_17_81_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_25&#39;)"><span class="hl_varref"><span class="mpre">iniState</span></span></a><span class="mpre">), </span><a href="#loc_81_26_81_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_26_81_28&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><a href="#loc_67_1_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_12&#39;)"><span class="hl_infix"><span class="mpre">`mplusEither`</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">)
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_98_12_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_14&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_81_17_81_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_25&#39;)"><span class="hl_varref"><span class="mpre">iniState</span></span></a><span class="mpre"> </span><a href="#loc_81_26_81_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_26_81_28&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_67_1_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_12&#39;)"><span class="hl_infix"><span class="mpre">`mplusEither`</span></span></a><span class="mpre"> </span><a href="#loc_87_12_87_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_28&#39;)"><span class="hl_varref"><span class="mpre">terminateAugment</span></span></a><span class="mpre">
                                             </span><a href="#loc_67_1_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_12&#39;)"><span class="hl_infix"><span class="mpre">`mplusEither`</span></span></a><span class="mpre"> \((</span><a name="loc_84_63_84_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_63_84_66&#39;)"><span class="hl_vardecl"><span class="mpre">evs</span></span></a><span class="mpre">, </span><a name="loc_84_68_84_76" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_68_84_76&#39;)"><span class="hl_vardecl"><span class="mpre">newState</span></span></a><span class="mpre">), </span><a name="loc_84_79_84_82" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_79_84_82&#39;)"><span class="hl_vardecl"><span class="mpre">nbs</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_81_12_81_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_12_81_16&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_84_68_84_76" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_68_84_76&#39;)"><span class="hl_varref"><span class="mpre">newState</span></span></a><span class="mpre"> </span><a href="#loc_84_79_84_82" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_79_84_82&#39;)"><span class="hl_varref"><span class="mpre">nbs</span></span></a><span class="mpre">
                                             </span><a href="#loc_67_1_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_12&#39;)"><span class="hl_infix"><span class="mpre">`mplusEither`</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="mpre"> (</span><a href="#loc_84_63_84_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_63_84_66&#39;)"><span class="hl_varref"><span class="mpre">evs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">))

           </span><a name="loc_87_12_87_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_28&#39;)"><span class="hl_fundecl"><span class="mpre">terminateAugment</span></span></a><span class="mpre"> </span><a name="loc_87_29_87_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_29_87_32&#39;)"><span class="hl_specname"><span class="mpre">ret</span></span></a><span class="mpre">@((</span><a name="loc_87_35_87_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_35_87_38&#39;)"><span class="hl_vardecl"><span class="mpre">evs</span></span></a><span class="mpre">, </span><a href="#loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_conref"><span class="mpre">ParseState</span></span></a><span class="mpre"> </span><a name="loc_87_51_87_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_51_87_59&#39;)"><span class="hl_vardecl"><span class="mpre">stackEnd</span></span></a><span class="mpre"> </span><a name="loc_87_60_87_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_60_87_62&#39;)"><span class="hl_vardecl"><span class="mpre">pe</span></span></a><span class="mpre"> </span><a name="loc_87_63_87_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_63_87_66&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre">), </span><a name="loc_87_69_87_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_69_87_70&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) =
                case </span><a href="#loc_87_51_87_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_51_87_59&#39;)"><span class="hl_varref"><span class="mpre">stackEnd</span></span></a><span class="mpre"> of
                    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_89_26_89_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_26_89_32&#39;)"><span class="hl_vardecl"><span class="mpre">endPos</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_89_33_89_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_33_89_35&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">
                         | </span><a href="#loc_87_63_87_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_63_87_66&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_89_26_89_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_26_89_32&#39;)"><span class="hl_varref"><span class="mpre">endPos</span></span></a><span class="mpre">  -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_22_18_22_45" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_22_18_22_45&#39;)"><span class="hl_conref"><span class="mpre">StreamConstructionWrongSize</span></span></a><span class="mpre">
                         | </span><a href="#loc_87_63_87_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_63_87_66&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_89_26_89_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_26_89_32&#39;)"><span class="hl_varref"><span class="mpre">endPos</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_87_12_87_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_12_87_28&#39;)"><span class="hl_varref"><span class="mpre">terminateAugment</span></span></a><span class="mpre"> ((</span><a href="#loc_87_35_87_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_35_87_38&#39;)"><span class="hl_varref"><span class="mpre">evs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="Data.ASN1.Types.Lowlevel.html#loc_46_18_46_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_46_18_46_33&#39;)"><span class="hl_conref"><span class="mpre">ConstructionEnd</span></span></a><span class="mpre">], </span><a href="#loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_conref"><span class="mpre">ParseState</span></span></a><span class="mpre"> </span><a href="#loc_89_33_89_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_33_89_35&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_87_60_87_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_60_87_62&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre"> </span><a href="#loc_87_63_87_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_63_87_66&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre">), </span><a href="#loc_87_69_87_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_69_87_70&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
                         | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_87_29_87_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_29_87_32&#39;)"><span class="hl_varref"><span class="mpre">ret</span></span></a><span class="mpre"> 
                    _                    -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_87_29_87_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_29_87_32&#39;)"><span class="hl_varref"><span class="mpre">ret</span></span></a><span class="mpre">

           </span><span class="hl_comment"><span class="mpre">-- go get one element (either a primitive or a header) from the bytes</span></span><span class="mpre">
           </span><span class="hl_comment"><span class="mpre">-- and returns the new cursor and the remaining byte.</span></span><span class="mpre">
           </span><a href="#loc_98_12_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_14&#39;)"><span class="mpre">go</span></a><span class="mpre"> :: </span><a href="#loc_51_6_51_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_16&#39;)"><span class="hl_tyconref"><span class="mpre">ParseState</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_6_20_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_6_20_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Error</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ParseCursor</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
           </span><a name="loc_98_12_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_14&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_conref"><span class="mpre">ParseState</span></span></a><span class="mpre"> </span><a name="loc_98_27_98_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_27_98_35&#39;)"><span class="hl_vardecl"><span class="mpre">stackEnd</span></span></a><span class="mpre"> (</span><a href="#loc_40_20_40_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_20_40_32&#39;)"><span class="hl_conref"><span class="mpre">ExpectHeader</span></span></a><span class="mpre"> </span><a name="loc_98_50_98_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_50_98_54&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre">) </span><a name="loc_98_56_98_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_56_98_59&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre">) </span><a name="loc_98_61_98_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_61_98_63&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
                case </span><a href="#loc_131_12_131_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_12_131_24&#39;)"><span class="hl_varref"><span class="mpre">runGetHeader</span></span></a><span class="mpre"> </span><a href="#loc_98_50_98_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_50_98_54&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><a href="#loc_98_56_98_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_56_98_59&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_98_61_98_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_61_98_63&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
                     </span><a href="Data.ASN1.Get.html#loc_39_17_39_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Get.html#loc_39_17_39_21&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre"> </span><a name="loc_100_27_100_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_27_100_28&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">                 -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_24_18_24_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_24_18_24_35&#39;)"><span class="hl_conref"><span class="mpre">ParsingHeaderFail</span></span></a><span class="mpre"> </span><a href="#loc_100_27_100_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_27_100_28&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
                     </span><a href="Data.ASN1.Get.html#loc_42_17_42_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Get.html#loc_42_17_42_24&#39;)"><span class="hl_conref"><span class="mpre">Partial</span></span></a><span class="mpre"> </span><a name="loc_101_30_101_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_30_101_31&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">              -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (([], </span><a href="#loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_conref"><span class="mpre">ParseState</span></span></a><span class="mpre"> </span><a href="#loc_98_27_98_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_27_98_35&#39;)"><span class="hl_varref"><span class="mpre">stackEnd</span></span></a><span class="mpre"> (</span><a href="#loc_40_20_40_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_20_40_32&#39;)"><span class="hl_conref"><span class="mpre">ExpectHeader</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_101_30_101_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_30_101_31&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_98_56_98_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_56_98_59&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre">), </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">)
                     </span><a href="Data.ASN1.Get.html#loc_46_17_46_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Get.html#loc_46_17_46_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre"> </span><a name="loc_102_27_102_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_27_102_30&#39;)"><span class="hl_vardecl"><span class="mpre">hdr</span></span></a><span class="mpre"> </span><a name="loc_102_31_102_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_31_102_35&#39;)"><span class="hl_vardecl"><span class="mpre">nPos</span></span></a><span class="mpre"> </span><a name="loc_102_36_102_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_36_102_44&#39;)"><span class="hl_vardecl"><span class="mpre">remBytes</span></span></a><span class="mpre">
                        | </span><a href="#loc_58_1_58_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_6&#39;)"><span class="hl_varref"><span class="mpre">isEOC</span></span></a><span class="mpre"> </span><a href="#loc_102_27_102_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_27_102_30&#39;)"><span class="hl_varref"><span class="mpre">hdr</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_98_27_98_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_27_98_35&#39;)"><span class="hl_varref"><span class="mpre">stackEnd</span></span></a><span class="mpre"> of
                                           []                  -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (([], </span><a href="#loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_conref"><span class="mpre">ParseState</span></span></a><span class="mpre"> [] (</span><a href="#loc_40_20_40_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_20_40_32&#39;)"><span class="hl_conref"><span class="mpre">ExpectHeader</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) </span><a href="#loc_102_31_102_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_31_102_35&#39;)"><span class="hl_varref"><span class="mpre">nPos</span></span></a><span class="mpre">), </span><a href="#loc_102_36_102_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_36_102_44&#39;)"><span class="hl_varref"><span class="mpre">remBytes</span></span></a><span class="mpre">)
                                           </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> _</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_            -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_18_20_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_18_20_37&#39;)"><span class="hl_conref"><span class="mpre">StreamUnexpectedEOC</span></span></a><span class="mpre">
                                           </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_106_52_106_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_52_106_63&#39;)"><span class="hl_vardecl"><span class="mpre">newStackEnd</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> ( ( [</span><a href="Data.ASN1.Types.Lowlevel.html#loc_46_18_46_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_46_18_46_33&#39;)"><span class="hl_conref"><span class="mpre">ConstructionEnd</span></span></a><span class="mpre">]
                                                                          , </span><a href="#loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_conref"><span class="mpre">ParseState</span></span></a><span class="mpre"> </span><a href="#loc_106_52_106_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_52_106_63&#39;)"><span class="hl_varref"><span class="mpre">newStackEnd</span></span></a><span class="mpre"> (</span><a href="#loc_40_20_40_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_20_40_32&#39;)"><span class="hl_conref"><span class="mpre">ExpectHeader</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) </span><a href="#loc_102_31_102_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_31_102_35&#39;)"><span class="hl_varref"><span class="mpre">nPos</span></span></a><span class="mpre">)
                                                                        , </span><a href="#loc_102_36_102_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_36_102_44&#39;)"><span class="hl_varref"><span class="mpre">remBytes</span></span></a><span class="mpre">)
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; case </span><a href="#loc_102_27_102_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_27_102_30&#39;)"><span class="hl_varref"><span class="mpre">hdr</span></span></a><span class="mpre"> of
                                       (</span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29&#39;)"><span class="hl_conref"><span class="mpre">ASN1Header</span></span></a><span class="mpre"> _ _ </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a name="loc_110_61_110_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_61_110_64&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">)  -&gt;
                                           let </span><a name="loc_111_48_111_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_48_111_52&#39;)"><span class="hl_vardecl"><span class="mpre">nEnd</span></span></a><span class="mpre"> = (</span><a href="#loc_102_31_102_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_31_102_35&#39;)"><span class="hl_varref"><span class="mpre">nPos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="#loc_61_1_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_18&#39;)"><span class="hl_varref"><span class="mpre">asn1LengthToConst</span></span></a><span class="mpre"> </span><a href="#loc_110_61_110_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_61_110_64&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
                                           in </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> ( ( [</span><a href="Data.ASN1.Types.Lowlevel.html#loc_43_18_43_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_43_18_43_24&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="#loc_102_27_102_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_27_102_30&#39;)"><span class="hl_varref"><span class="mpre">hdr</span></span></a><span class="mpre">,</span><a href="Data.ASN1.Types.Lowlevel.html#loc_45_18_45_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_45_18_45_35&#39;)"><span class="hl_conref"><span class="mpre">ConstructionBegin</span></span></a><span class="mpre">]
                                                      , </span><a href="#loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_conref"><span class="mpre">ParseState</span></span></a><span class="mpre"> (</span><a href="#loc_111_48_111_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_48_111_52&#39;)"><span class="hl_varref"><span class="mpre">nEnd</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_98_27_98_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_27_98_35&#39;)"><span class="hl_varref"><span class="mpre">stackEnd</span></span></a><span class="mpre">) (</span><a href="#loc_40_20_40_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_20_40_32&#39;)"><span class="hl_conref"><span class="mpre">ExpectHeader</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) </span><a href="#loc_102_31_102_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_31_102_35&#39;)"><span class="hl_varref"><span class="mpre">nPos</span></span></a><span class="mpre">)
                                                    , </span><a href="#loc_102_36_102_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_36_102_44&#39;)"><span class="hl_varref"><span class="mpre">remBytes</span></span></a><span class="mpre">)
                                       (</span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29&#39;)"><span class="hl_conref"><span class="mpre">ASN1Header</span></span></a><span class="mpre"> _ _ </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.Lowlevel.html#loc_35_19_35_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_35_19_35_32&#39;)"><span class="hl_conref"><span class="mpre">LenIndefinite</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_21_18_21_41" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_21_18_21_41&#39;)"><span class="hl_conref"><span class="mpre">StreamInfinitePrimitive</span></span></a><span class="mpre">
                                       (</span><a href="Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_39_19_39_29&#39;)"><span class="hl_conref"><span class="mpre">ASN1Header</span></span></a><span class="mpre"> _ _ </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a name="loc_116_62_116_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_62_116_65&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) -&gt;
                                           let </span><a name="loc_117_48_117_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_48_117_55&#39;)"><span class="hl_vardecl"><span class="mpre">pLength</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_61_1_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_18&#39;)"><span class="hl_varref"><span class="mpre">asn1LengthToConst</span></span></a><span class="mpre"> </span><a href="#loc_116_62_116_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_62_116_65&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
                                           in if </span><a href="#loc_117_48_117_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_48_117_55&#39;)"><span class="hl_varref"><span class="mpre">pLength</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                                                 then </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> ( ( [</span><a href="Data.ASN1.Types.Lowlevel.html#loc_43_18_43_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_43_18_43_24&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="#loc_102_27_102_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_27_102_30&#39;)"><span class="hl_varref"><span class="mpre">hdr</span></span></a><span class="mpre">,</span><a href="Data.ASN1.Types.Lowlevel.html#loc_44_18_44_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_44_18_44_27&#39;)"><span class="hl_conref"><span class="mpre">Primitive</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">]
                                                              , </span><a href="#loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_conref"><span class="mpre">ParseState</span></span></a><span class="mpre"> </span><a href="#loc_98_27_98_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_27_98_35&#39;)"><span class="hl_varref"><span class="mpre">stackEnd</span></span></a><span class="mpre"> (</span><a href="#loc_40_20_40_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_20_40_32&#39;)"><span class="hl_conref"><span class="mpre">ExpectHeader</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) </span><a href="#loc_102_31_102_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_31_102_35&#39;)"><span class="hl_varref"><span class="mpre">nPos</span></span></a><span class="mpre">)
                                                            , </span><a href="#loc_102_36_102_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_36_102_44&#39;)"><span class="hl_varref"><span class="mpre">remBytes</span></span></a><span class="mpre">)
                                                 else </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> ( ( [</span><a href="Data.ASN1.Types.Lowlevel.html#loc_43_18_43_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_43_18_43_24&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="#loc_102_27_102_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_27_102_30&#39;)"><span class="hl_varref"><span class="mpre">hdr</span></span></a><span class="mpre">]
                                                              , </span><a href="#loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_conref"><span class="mpre">ParseState</span></span></a><span class="mpre"> </span><a href="#loc_98_27_98_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_27_98_35&#39;)"><span class="hl_varref"><span class="mpre">stackEnd</span></span></a><span class="mpre"> (</span><a href="#loc_41_20_41_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_35&#39;)"><span class="hl_conref"><span class="mpre">ExpectPrimitive</span></span></a><span class="mpre"> </span><a href="#loc_117_48_117_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_48_117_55&#39;)"><span class="hl_varref"><span class="mpre">pLength</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) </span><a href="#loc_102_31_102_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_31_102_35&#39;)"><span class="hl_varref"><span class="mpre">nPos</span></span></a><span class="mpre">)
                                                            , </span><a href="#loc_102_36_102_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_36_102_44&#39;)"><span class="hl_varref"><span class="mpre">remBytes</span></span></a><span class="mpre">)
           </span><a href="#loc_98_12_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_14&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_conref"><span class="mpre">ParseState</span></span></a><span class="mpre"> </span><a name="loc_125_27_125_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_27_125_35&#39;)"><span class="hl_vardecl"><span class="mpre">stackEnd</span></span></a><span class="mpre"> (</span><a href="#loc_41_20_41_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_35&#39;)"><span class="hl_conref"><span class="mpre">ExpectPrimitive</span></span></a><span class="mpre"> </span><a name="loc_125_53_125_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_53_125_56&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> </span><a name="loc_125_57_125_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_57_125_61&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre">) </span><a name="loc_125_63_125_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_63_125_66&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre">) </span><a name="loc_125_68_125_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_68_125_70&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
                case </span><a href="#loc_134_12_134_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_12_134_27&#39;)"><span class="hl_varref"><span class="mpre">runGetPrimitive</span></span></a><span class="mpre"> </span><a href="#loc_125_57_125_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_57_125_61&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><a href="#loc_125_53_125_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_53_125_56&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_125_63_125_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_63_125_66&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="#loc_125_68_125_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_68_125_70&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
                     </span><a href="Data.ASN1.Get.html#loc_39_17_39_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Get.html#loc_39_17_39_21&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre"> _               -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;primitive parsing failed&quot;</span></span><span class="mpre">
                     </span><a href="Data.ASN1.Get.html#loc_42_17_42_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Get.html#loc_42_17_42_24&#39;)"><span class="hl_conref"><span class="mpre">Partial</span></span></a><span class="mpre"> </span><a name="loc_128_30_128_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_30_128_31&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">            -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (([], </span><a href="#loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_conref"><span class="mpre">ParseState</span></span></a><span class="mpre"> </span><a href="#loc_125_27_125_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_27_125_35&#39;)"><span class="hl_varref"><span class="mpre">stackEnd</span></span></a><span class="mpre"> (</span><a href="#loc_41_20_41_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_35&#39;)"><span class="hl_conref"><span class="mpre">ExpectPrimitive</span></span></a><span class="mpre"> </span><a href="#loc_125_53_125_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_53_125_56&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_128_30_128_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_30_128_31&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_125_63_125_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_63_125_66&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre">), </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">)
                     </span><a href="Data.ASN1.Get.html#loc_46_17_46_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Get.html#loc_46_17_46_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre"> </span><a name="loc_129_27_129_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_27_129_28&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_129_29_129_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_29_129_33&#39;)"><span class="hl_vardecl"><span class="mpre">nPos</span></span></a><span class="mpre"> </span><a name="loc_129_34_129_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_34_129_42&#39;)"><span class="hl_vardecl"><span class="mpre">remBytes</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (([</span><a href="Data.ASN1.Types.Lowlevel.html#loc_44_18_44_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_44_18_44_27&#39;)"><span class="hl_conref"><span class="mpre">Primitive</span></span></a><span class="mpre"> </span><a href="#loc_129_27_129_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_27_129_28&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">], </span><a href="#loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_conref"><span class="mpre">ParseState</span></span></a><span class="mpre"> </span><a href="#loc_125_27_125_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_27_125_35&#39;)"><span class="hl_varref"><span class="mpre">stackEnd</span></span></a><span class="mpre"> (</span><a href="#loc_40_20_40_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_20_40_32&#39;)"><span class="hl_conref"><span class="mpre">ExpectHeader</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) </span><a href="#loc_129_29_129_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_29_129_33&#39;)"><span class="hl_varref"><span class="mpre">nPos</span></span></a><span class="mpre">), </span><a href="#loc_129_34_129_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_34_129_42&#39;)"><span class="hl_varref"><span class="mpre">remBytes</span></span></a><span class="mpre">)

           </span><a name="loc_131_12_131_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_12_131_24&#39;)"><span class="hl_fundecl"><span class="mpre">runGetHeader</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  = \</span><a name="loc_131_37_131_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_37_131_40&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ASN1.Get.html#loc_131_1_131_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Get.html#loc_131_1_131_10&#39;)"><span class="hl_varref"><span class="mpre">runGetPos</span></span></a><span class="mpre"> </span><a href="#loc_131_37_131_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_37_131_40&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Serialize.html#loc_22_1_22_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Serialize.html#loc_22_1_22_10&#39;)"><span class="hl_varref"><span class="mpre">getHeader</span></span></a><span class="mpre">
           </span><a href="#loc_131_12_131_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_12_131_24&#39;)"><span class="hl_fundecl"><span class="mpre">runGetHeader</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_132_31_132_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_31_132_32&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="#loc_132_31_132_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_31_132_32&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

           </span><a name="loc_134_12_134_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_12_134_27&#39;)"><span class="hl_fundecl"><span class="mpre">runGetPrimitive</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  </span><a name="loc_134_37_134_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_37_134_38&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = \</span><a name="loc_134_42_134_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_42_134_45&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ASN1.Get.html#loc_131_1_131_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Get.html#loc_131_1_131_10&#39;)"><span class="hl_varref"><span class="mpre">runGetPos</span></span></a><span class="mpre"> </span><a href="#loc_134_42_134_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_42_134_45&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Get.html#loc_188_1_188_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Get.html#loc_188_1_188_9&#39;)"><span class="hl_varref"><span class="mpre">getBytes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_134_37_134_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_37_134_38&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
           </span><a href="#loc_134_12_134_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_12_134_27&#39;)"><span class="hl_fundecl"><span class="mpre">runGetPrimitive</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_135_34_135_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_34_135_35&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) _ = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="#loc_135_34_135_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_34_135_35&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | when no more input is available, it&#39;s important to check that the parser is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in a finish state too.</span></span><span class="mpre">
</span><a href="#loc_140_1_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_12&#39;)"><span class="mpre">isParseDone</span></a><span class="mpre"> :: </span><a href="#loc_51_6_51_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_16&#39;)"><span class="hl_tyconref"><span class="mpre">ParseState</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_140_1_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_12&#39;)"><span class="hl_fundecl"><span class="mpre">isParseDone</span></span></a><span class="mpre"> (</span><a href="#loc_51_19_51_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_29&#39;)"><span class="hl_conref"><span class="mpre">ParseState</span></span></a><span class="mpre"> [] (</span><a href="#loc_40_20_40_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_20_40_32&#39;)"><span class="hl_conref"><span class="mpre">ExpectHeader</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) _) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_140_1_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_12&#39;)"><span class="hl_fundecl"><span class="mpre">isParseDone</span></span></a><span class="mpre"> _                                        = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Parse one lazy bytestring and returns on success all ASN1 events associated.</span></span><span class="mpre">
</span><a href="#loc_145_1_145_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_9&#39;)"><span class="mpre">parseLBS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_6_20_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_6_20_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Error</span></span></a><span class="mpre"> [</span><a href="Data.ASN1.Types.Lowlevel.html#loc_43_6_43_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_43_6_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Event</span></span></a><span class="mpre">]
</span><a name="loc_145_1_145_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_9&#39;)"><span class="hl_fundecl"><span class="mpre">parseLBS</span></span></a><span class="mpre"> </span><a name="loc_145_10_145_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_10_145_13&#39;)"><span class="hl_vardecl"><span class="mpre">lbs</span></span></a><span class="mpre"> = </span><a href="#loc_155_11_155_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_22&#39;)"><span class="hl_varref"><span class="mpre">foldrEither</span></span></a><span class="mpre"> </span><a href="#loc_152_11_152_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_11_152_18&#39;)"><span class="hl_varref"><span class="mpre">process</span></span></a><span class="mpre"> ([], </span><a href="#loc_55_1_55_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_14&#39;)"><span class="hl_varref"><span class="mpre">newParseState</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_145_10_145_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_10_145_13&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre">) </span><a href="#loc_67_1_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_12&#39;)"><span class="hl_infix"><span class="mpre">`mplusEither`</span></span></a><span class="mpre"> </span><a href="#loc_147_11_147_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_11_147_20&#39;)"><span class="hl_varref"><span class="mpre">onSuccess</span></span></a><span class="mpre">
    where 
          </span><a name="loc_147_11_147_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_11_147_20&#39;)"><span class="hl_fundecl"><span class="mpre">onSuccess</span></span></a><span class="mpre"> (</span><a name="loc_147_22_147_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_22_147_28&#39;)"><span class="hl_vardecl"><span class="mpre">allEvs</span></span></a><span class="mpre">, </span><a name="loc_147_30_147_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_30_147_40&#39;)"><span class="hl_vardecl"><span class="mpre">finalState</span></span></a><span class="mpre">)
                  | </span><a href="#loc_140_1_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_12&#39;)"><span class="hl_varref"><span class="mpre">isParseDone</span></span></a><span class="mpre"> </span><a href="#loc_147_30_147_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_30_147_40&#39;)"><span class="hl_varref"><span class="mpre">finalState</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_147_22_147_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_22_147_28&#39;)"><span class="hl_varref"><span class="mpre">allEvs</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">              = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_25_18_25_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_25_18_25_32&#39;)"><span class="hl_conref"><span class="mpre">ParsingPartial</span></span></a><span class="mpre">

          </span><a href="#loc_152_11_152_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_11_152_18&#39;)"><span class="mpre">process</span></a><span class="mpre"> :: ([[</span><a href="Data.ASN1.Types.Lowlevel.html#loc_43_6_43_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_43_6_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Event</span></span></a><span class="mpre">]], </span><a href="#loc_51_6_51_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_16&#39;)"><span class="hl_tyconref"><span class="mpre">ParseState</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_6_20_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_6_20_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Error</span></span></a><span class="mpre"> ([[</span><a href="Data.ASN1.Types.Lowlevel.html#loc_43_6_43_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_43_6_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Event</span></span></a><span class="mpre">]], </span><a href="#loc_51_6_51_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_16&#39;)"><span class="hl_tyconref"><span class="mpre">ParseState</span></span></a><span class="mpre">)
          </span><a name="loc_152_11_152_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_11_152_18&#39;)"><span class="hl_fundecl"><span class="mpre">process</span></span></a><span class="mpre"> (</span><a name="loc_152_20_152_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_20_152_24&#39;)"><span class="hl_vardecl"><span class="mpre">pevs</span></span></a><span class="mpre">, </span><a name="loc_152_26_152_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_26_152_32&#39;)"><span class="hl_vardecl"><span class="mpre">cState</span></span></a><span class="mpre">) </span><a name="loc_152_34_152_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_34_152_36&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_79_1_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_14&#39;)"><span class="hl_varref"><span class="mpre">runParseState</span></span></a><span class="mpre"> </span><a href="#loc_152_26_152_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_26_152_32&#39;)"><span class="hl_varref"><span class="mpre">cState</span></span></a><span class="mpre"> </span><a href="#loc_152_34_152_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_34_152_36&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_67_1_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_12&#39;)"><span class="hl_infix"><span class="mpre">`mplusEither`</span></span></a><span class="mpre"> \(</span><a name="loc_152_79_152_81" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_79_152_81&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">, </span><a name="loc_152_83_152_90" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_83_152_90&#39;)"><span class="hl_vardecl"><span class="mpre">cState&#39;</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_152_79_152_81" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_79_152_81&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_152_20_152_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_20_152_24&#39;)"><span class="hl_varref"><span class="mpre">pevs</span></span></a><span class="mpre">, </span><a href="#loc_152_83_152_90" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_83_152_90&#39;)"><span class="hl_varref"><span class="mpre">cState&#39;</span></span></a><span class="mpre">)

          </span><a href="#loc_155_11_155_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_22&#39;)"><span class="mpre">foldrEither</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_6_20_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_6_20_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Error</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_6_20_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_6_20_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Error</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
          </span><a name="loc_155_11_155_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_22&#39;)"><span class="hl_fundecl"><span class="mpre">foldrEither</span></span></a><span class="mpre"> _ </span><a name="loc_155_25_155_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_25_155_28&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> []     = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_155_25_155_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_25_155_28&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">
          </span><a href="#loc_155_11_155_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_22&#39;)"><span class="hl_fundecl"><span class="mpre">foldrEither</span></span></a><span class="mpre"> </span><a name="loc_156_23_156_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_23_156_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_156_25_156_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_25_156_28&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> (</span><a name="loc_156_30_156_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_30_156_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_156_32_156_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_32_156_34&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_156_23_156_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_23_156_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_156_25_156_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_25_156_28&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="#loc_156_30_156_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_30_156_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_67_1_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_12&#39;)"><span class="hl_infix"><span class="mpre">`mplusEither`</span></span></a><span class="mpre"> \</span><a name="loc_156_61_156_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_61_156_65&#39;)"><span class="hl_vardecl"><span class="mpre">nacc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_155_11_155_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_22&#39;)"><span class="hl_varref"><span class="mpre">foldrEither</span></span></a><span class="mpre"> </span><a href="#loc_156_23_156_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_23_156_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_156_61_156_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_61_156_65&#39;)"><span class="hl_varref"><span class="mpre">nacc</span></span></a><span class="mpre"> </span><a href="#loc_156_32_156_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_32_156_34&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Parse one strict bytestring and returns on success all ASN1 events associated.</span></span><span class="mpre">
</span><a href="#loc_160_1_160_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_8&#39;)"><span class="mpre">parseBS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_20_6_20_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_20_6_20_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Error</span></span></a><span class="mpre"> [</span><a href="Data.ASN1.Types.Lowlevel.html#loc_43_6_43_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.Lowlevel.html#loc_43_6_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1Event</span></span></a><span class="mpre">]
</span><a name="loc_160_1_160_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_8&#39;)"><span class="hl_fundecl"><span class="mpre">parseBS</span></span></a><span class="mpre"> </span><a name="loc_160_9_160_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_79_1_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_1_79_14&#39;)"><span class="hl_varref"><span class="mpre">runParseState</span></span></a><span class="mpre"> </span><a href="#loc_55_1_55_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_14&#39;)"><span class="hl_varref"><span class="mpre">newParseState</span></span></a><span class="mpre"> </span><a href="#loc_160_9_160_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_67_1_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_12&#39;)"><span class="hl_infix"><span class="mpre">`mplusEither`</span></span></a><span class="mpre"> </span><a href="#loc_161_11_161_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_11_161_20&#39;)"><span class="hl_varref"><span class="mpre">onSuccess</span></span></a><span class="mpre">
    where </span><a name="loc_161_11_161_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_11_161_20&#39;)"><span class="hl_fundecl"><span class="mpre">onSuccess</span></span></a><span class="mpre"> (</span><a name="loc_161_22_161_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_22_161_25&#39;)"><span class="hl_vardecl"><span class="mpre">evs</span></span></a><span class="mpre">, </span><a name="loc_161_27_161_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_27_161_33&#39;)"><span class="hl_vardecl"><span class="mpre">pstate</span></span></a><span class="mpre">)
                    | </span><a href="#loc_140_1_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_12&#39;)"><span class="hl_varref"><span class="mpre">isParseDone</span></span></a><span class="mpre"> </span><a href="#loc_161_27_161_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_27_161_33&#39;)"><span class="hl_varref"><span class="mpre">pstate</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_161_22_161_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_22_161_25&#39;)"><span class="hl_varref"><span class="mpre">evs</span></span></a><span class="mpre">
                    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">          = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Data.ASN1.Error.html#loc_25_18_25_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Error.html#loc_25_18_25_32&#39;)"><span class="hl_conref"><span class="mpre">ParsingPartial</span></span></a><span class="mpre">
</span></div></body></html>