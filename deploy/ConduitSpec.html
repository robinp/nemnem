<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
module ConduitSpec (main, spec) where

import Network.Wai.Handler.Warp.Conduit
import Network.Wai.Handler.Warp.Types
import Control.Monad (</span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="mpre">replicateM</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ConduitSpec.hs&quot;, srcSpanStartLine = 7, srcSpanStartColumn = 8, srcSpanEndLine = 7, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.Hspec&quot;"><span class="mpre">Test.Hspec</span></span><span class="mpre">
import Data.IORef as I
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ConduitSpec.hs&quot;, srcSpanStartLine = 9, srcSpanStartColumn = 18, srcSpanEndLine = 9, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S

</span><a href="#loc_12_1_12_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_5&#39;)"><span class="mpre">main</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_12_1_12_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_5&#39;)"><span class="hl_vardecl"><span class="mpre">main</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">hspec</span></span><span class="mpre"> </span><a href="#loc_15_1_15_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_5&#39;)"><span class="hl_varref"><span class="mpre">spec</span></span></a><span class="mpre">

</span><a href="#loc_15_1_15_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_5&#39;)"><span class="mpre">spec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_15_1_15_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_5&#39;)"><span class="hl_vardecl"><span class="mpre">spec</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;conduit&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;IsolatedBSSource&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_17_9_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_12&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.singleton</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ConduitSpec.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 43, srcSpanEndLine = 17, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ConduitSpec.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 43, srcSpanEndLine = 17, srcSpanEndColumn = 44},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ConduitSpec.hs&quot;, srcSpanStartLine = 17,"><span class="mpre">[1..50]</span></span><span class="mpre">
        </span><a name="loc_18_9_18_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_12&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Types.html#loc_99_1_99_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_99_1_99_9&#39;)"><span class="hl_varref"><span class="mpre">mkSource</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><a name="loc_19_13_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_13_19_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_17_9_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_12&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
            case </span><a href="#loc_19_13_19_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_13_19_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
                [] -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
                </span><a name="loc_22_17_22_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_17_22_18&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_22_19_22_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_19_22_20&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> -&gt; do
                    </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_17_9_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_12&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_22_19_22_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_19_22_20&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_22_17_22_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_17_22_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
        </span><a name="loc_25_9_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_13&#39;)"><span class="hl_vardecl"><span class="mpre">isrc</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Conduit.html#loc_21_1_21_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Conduit.html#loc_21_1_21_10&#39;)"><span class="hl_varref"><span class="mpre">mkISource</span></span></a><span class="mpre"> </span><a href="#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_12&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre">
        </span><a name="loc_26_9_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">20</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.Conduit.html#loc_30_1_30_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Conduit.html#loc_30_1_30_12&#39;)"><span class="hl_varref"><span class="mpre">readISource</span></span></a><span class="mpre"> </span><a href="#loc_25_9_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_13&#39;)"><span class="hl_varref"><span class="mpre">isrc</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_26_9_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.pack</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ConduitSpec.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 38, srcSpanEndLine = 27, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ConduitSpec.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 38, srcSpanEndLine = 27, srcSpanEndColumn = 39},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ConduitSpec.hs&quot;, srcSpanStartLine = 27,"><span class="mpre">[1..20]</span></span><span class="mpre">

        </span><a name="loc_29_9_29_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.Conduit.html#loc_30_1_30_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Conduit.html#loc_30_1_30_12&#39;)"><span class="hl_varref"><span class="mpre">readISource</span></span></a><span class="mpre"> </span><a href="#loc_25_9_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_13&#39;)"><span class="hl_varref"><span class="mpre">isrc</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_29_9_29_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.pack</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ConduitSpec.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 38, srcSpanEndLine = 30, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ConduitSpec.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 38, srcSpanEndLine = 30, srcSpanEndColumn = 39},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ConduitSpec.hs&quot;, srcSpanStartLine = 30,"><span class="mpre">[21..40]</span></span><span class="mpre">

        </span><a name="loc_32_9_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_9_32_10&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">readSource</span></span></a><span class="mpre"> </span><a href="#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_12&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_32_9_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_9_32_10&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.pack</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ConduitSpec.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 38, srcSpanEndLine = 33, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ConduitSpec.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 38, srcSpanEndLine = 33, srcSpanEndColumn = 39},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ConduitSpec.hs&quot;, srcSpanStartLine = 33,"><span class="mpre">[41..50]</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;chunkedSource&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_35_9_35_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_12&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;5\r\n12345\r\n3\r\n678\r\n0\r\n\r\nBLAH&quot;</span></span><span class="mpre">
        </span><a name="loc_36_9_36_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_12&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Types.html#loc_99_1_99_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_99_1_99_9&#39;)"><span class="hl_varref"><span class="mpre">mkSource</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><a name="loc_37_13_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_13_37_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_35_9_35_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_12&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
            </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_35_9_35_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_12&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_37_13_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_13_37_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a name="loc_40_9_40_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_13&#39;)"><span class="hl_vardecl"><span class="mpre">csrc</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Conduit.html#loc_85_1_85_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Conduit.html#loc_85_1_85_10&#39;)"><span class="hl_varref"><span class="mpre">mkCSource</span></span></a><span class="mpre"> </span><a href="#loc_36_9_36_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_12&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">

        </span><a name="loc_42_9_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.Conduit.html#loc_90_1_90_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Conduit.html#loc_90_1_90_12&#39;)"><span class="hl_varref"><span class="mpre">readCSource</span></span></a><span class="mpre"> </span><a href="#loc_40_9_40_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_13&#39;)"><span class="hl_varref"><span class="mpre">csrc</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_42_9_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;12345678&quot;</span></span><span class="mpre">

        </span><a name="loc_45_9_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">readSource</span></span></a><span class="mpre"> </span><a href="#loc_36_9_36_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_12&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_45_9_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;BLAH&quot;</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;chunk boundaries&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_48_9_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_12&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre">
            [ </span><span class="hl_string"><span class="mpre">&quot;5\r\n&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;12345\r\n3\r&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;\n678\r\n0\r\n&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;\r\nBLAH&quot;</span></span><span class="mpre">
            ]
        </span><a name="loc_54_9_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_12&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Types.html#loc_99_1_99_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_99_1_99_9&#39;)"><span class="hl_varref"><span class="mpre">mkSource</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><a name="loc_55_13_55_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_13_55_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_48_9_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_12&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
            case </span><a href="#loc_55_13_55_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_13_55_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
                [] -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
                </span><a name="loc_58_17_58_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_17_58_18&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_58_19_58_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_19_58_20&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> -&gt; do
                    </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_48_9_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_12&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_58_19_58_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_19_58_20&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_58_17_58_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_17_58_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
        </span><a name="loc_61_9_61_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_9_61_13&#39;)"><span class="hl_vardecl"><span class="mpre">csrc</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Conduit.html#loc_85_1_85_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Conduit.html#loc_85_1_85_10&#39;)"><span class="hl_varref"><span class="mpre">mkCSource</span></span></a><span class="mpre"> </span><a href="#loc_54_9_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_12&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">

        </span><a name="loc_63_9_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.Conduit.html#loc_90_1_90_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Conduit.html#loc_90_1_90_12&#39;)"><span class="hl_varref"><span class="mpre">readCSource</span></span></a><span class="mpre"> </span><a href="#loc_61_9_61_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_9_61_13&#39;)"><span class="hl_varref"><span class="mpre">csrc</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_63_9_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;12345678&quot;</span></span><span class="mpre">

        </span><a name="loc_66_9_66_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_9_66_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">readSource</span></span></a><span class="mpre"> </span><a href="#loc_54_9_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_9_54_12&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_66_9_66_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_9_66_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;BLAH&quot;</span></span><span class="mpre">
</span></div></body></html>