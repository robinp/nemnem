<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.Vector.Fusion.Util</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) Roman Leshchinskiy 2009</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Roman Leshchinskiy &lt;rl@cse.unsw.edu.au&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Fusion-related utility types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

module Data.Vector.Fusion.Util (
  Id(..), Box(..),

  delay_inline, delayed_min
) where

</span><span class="hl_comment"><span class="mpre">-- | Identity monad</span></span><span class="mpre">
newtype </span><a name="loc_20_9_20_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_9_20_11&#39;)"><span class="hl_tycondecl"><span class="mpre">Id</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_20_16_20_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_16_20_18&#39;)"><span class="hl_condecl"><span class="mpre">Id</span></span></a><span class="mpre"> { </span><a name="loc_20_21_20_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_21_20_25&#39;)"><span class="hl_fielddecl"><span class="mpre">unId</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> }

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_20_9_20_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_9_20_11&#39;)"><span class="hl_tyconref"><span class="mpre">Id</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_23_8_23_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_8_23_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_20_16_20_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_16_20_18&#39;)"><span class="hl_conref"><span class="mpre">Id</span></span></a><span class="mpre"> </span><a name="loc_23_14_23_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_14_23_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_20_16_20_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_16_20_18&#39;)"><span class="hl_conref"><span class="mpre">Id</span></span></a><span class="mpre"> (</span><a href="#loc_23_8_23_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_8_23_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_23_14_23_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_14_23_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> </span><a href="#loc_20_9_20_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_9_20_11&#39;)"><span class="hl_tyconref"><span class="mpre">Id</span></span></a><span class="mpre"> where
  </span><span class="hl_vardecl"><span class="mpre">return</span></span><span class="mpre">     = </span><a href="#loc_20_16_20_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_16_20_18&#39;)"><span class="hl_conref"><span class="mpre">Id</span></span></a><span class="mpre">
  </span><a href="#loc_20_16_20_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_16_20_18&#39;)"><span class="hl_conref"><span class="mpre">Id</span></span></a><span class="mpre"> </span><a name="loc_27_6_27_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_6_27_7&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_27_12_27_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_12_27_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_27_12_27_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_12_27_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_27_6_27_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_6_27_7&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Box monad</span></span><span class="mpre">
data </span><a name="loc_30_6_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_9&#39;)"><span class="hl_tycondecl"><span class="mpre">Box</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_30_14_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_17&#39;)"><span class="hl_condecl"><span class="mpre">Box</span></span></a><span class="mpre"> { </span><a name="loc_30_20_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_20_30_25&#39;)"><span class="hl_fielddecl"><span class="mpre">unBox</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> }

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_30_6_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_9&#39;)"><span class="hl_tyconref"><span class="mpre">Box</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_33_8_33_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_8_33_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_30_14_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_17&#39;)"><span class="hl_conref"><span class="mpre">Box</span></span></a><span class="mpre"> </span><a name="loc_33_15_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_15_33_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_30_14_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_17&#39;)"><span class="hl_conref"><span class="mpre">Box</span></span></a><span class="mpre"> (</span><a href="#loc_33_8_33_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_8_33_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_33_15_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_15_33_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> </span><a href="#loc_30_6_30_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_9&#39;)"><span class="hl_tyconref"><span class="mpre">Box</span></span></a><span class="mpre"> where
  </span><span class="hl_vardecl"><span class="mpre">return</span></span><span class="mpre">      = </span><a href="#loc_30_14_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_17&#39;)"><span class="hl_conref"><span class="mpre">Box</span></span></a><span class="mpre">
  </span><a href="#loc_30_14_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_17&#39;)"><span class="hl_conref"><span class="mpre">Box</span></span></a><span class="mpre"> </span><a name="loc_37_7_37_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_37_13_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_13_37_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_37_13_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_13_37_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_37_7_37_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Delay inlining a function until late in the game (simplifier phase 0).</span></span><span class="mpre">
</span><a href="#loc_42_1_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_13&#39;)"><span class="mpre">delay_inline</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_42_1_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_13&#39;)"><span class="mpre">delay_inline</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_42_1_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_13&#39;)"><span class="hl_fundecl"><span class="mpre">delay_inline</span></span></a><span class="mpre"> </span><a name="loc_42_14_42_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_14_42_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_42_14_42_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_14_42_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | `min` inlined in phase 0</span></span><span class="mpre">
</span><a href="#loc_47_1_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_12&#39;)"><span class="mpre">delayed_min</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_47_1_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_12&#39;)"><span class="mpre">delayed_min</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_47_1_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_12&#39;)"><span class="hl_fundecl"><span class="mpre">delayed_min</span></span></a><span class="mpre"> </span><a name="loc_47_13_47_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_14&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_47_15_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_15_47_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> </span><a href="#loc_47_13_47_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_47_15_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_15_47_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span></div></body></html>