<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE DeriveDataTypeable #-}
{-# LANGUAGE CPP #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.TLS.IO</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.TLS.IO
    ( checkValid
    , sendPacket
    , recvPacket
    ) where

import Network.TLS.Context.Internal
import Network.TLS.Struct
import Network.TLS.Record
import Network.TLS.Packet
import Network.TLS.Hooks
import Network.TLS.Sending
import Network.TLS.Receiving
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/IO.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 18, srcSpanEndLine = 23, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/IO.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 8, srcSpanEndLine = 24, srcSpanEndColumn = 29}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> ()

import Data.IORef
import Control.Monad.State
import Control.Exception (</span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="mpre">throwIO</span></a><span class="mpre">)
import System.IO.Error (</span><a href="System.IO.Error.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_115_1_115_10&#39;)"><span class="mpre">mkIOError</span></a><span class="mpre">, </span><a href="System.IO.Error.html#loc_198_1_198_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_198_1_198_13&#39;)"><span class="mpre">eofErrorType</span></a><span class="mpre">)

</span><a href="#loc_32_1_32_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_11&#39;)"><span class="mpre">checkValid</span></a><span class="mpre"> :: </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_32_1_32_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_11&#39;)"><span class="hl_fundecl"><span class="mpre">checkValid</span></span></a><span class="mpre"> </span><a name="loc_32_12_32_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_12_32_15&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> = do
    </span><a name="loc_33_5_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_5_33_16&#39;)"><span class="hl_vardecl"><span class="mpre">established</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Context.Internal.html#loc_152_1_152_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_152_1_152_15&#39;)"><span class="hl_varref"><span class="mpre">ctxEstablished</span></span></a><span class="mpre"> </span><a href="#loc_32_12_32_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_12_32_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> </span><a href="#loc_33_5_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_5_33_16&#39;)"><span class="hl_varref"><span class="mpre">established</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_144_7_144_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_144_7_144_31&#39;)"><span class="hl_conref"><span class="mpre">ConnectionNotEstablished</span></span></a><span class="mpre">
    </span><a name="loc_35_5_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_5_35_10&#39;)"><span class="hl_vardecl"><span class="mpre">eofed</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Context.Internal.html#loc_140_1_140_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_140_1_140_7&#39;)"><span class="hl_varref"><span class="mpre">ctxEOF</span></span></a><span class="mpre"> </span><a href="#loc_32_12_32_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_12_32_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> </span><a href="#loc_35_5_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_5_35_10&#39;)"><span class="hl_varref"><span class="mpre">eofed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Error.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_115_1_115_10&#39;)"><span class="hl_varref"><span class="mpre">mkIOError</span></span></a><span class="mpre"> </span><a href="System.IO.Error.html#loc_198_1_198_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_198_1_198_13&#39;)"><span class="hl_varref"><span class="mpre">eofErrorType</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;data&quot;</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="mpre">readExact</span></a><span class="mpre"> :: </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_fundecl"><span class="mpre">readExact</span></span></a><span class="mpre"> </span><a name="loc_39_11_39_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_14&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_39_15_39_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_15_39_17&#39;)"><span class="hl_vardecl"><span class="mpre">sz</span></span></a><span class="mpre"> = do
    </span><a name="loc_40_5_40_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_5_40_10&#39;)"><span class="hl_vardecl"><span class="mpre">hdrbs</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Context.Internal.html#loc_137_1_137_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_137_1_137_12&#39;)"><span class="hl_varref"><span class="mpre">contextRecv</span></span></a><span class="mpre"> </span><a href="#loc_39_11_39_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_14&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_39_15_39_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_15_39_17&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_40_5_40_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_5_40_10&#39;)"><span class="hl_varref"><span class="mpre">hdrbs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_39_15_39_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_15_39_17&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a href="Network.TLS.Context.Internal.html#loc_149_1_149_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_149_1_149_7&#39;)"><span class="hl_varref"><span class="mpre">setEOF</span></span></a><span class="mpre"> </span><a href="#loc_39_11_39_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_14&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre">
        if </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_40_5_40_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_5_40_10&#39;)"><span class="hl_varref"><span class="mpre">hdrbs</span></span></a><span class="mpre">
            then </span><a href="Network.TLS.Context.Internal.html#loc_167_1_167_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_167_1_167_10&#39;)"><span class="hl_varref"><span class="mpre">throwCore</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_126_7_126_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_126_7_126_16&#39;)"><span class="hl_conref"><span class="mpre">Error_EOF</span></span></a><span class="mpre">
            else </span><a href="Network.TLS.Context.Internal.html#loc_167_1_167_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_167_1_167_10&#39;)"><span class="hl_varref"><span class="mpre">throwCore</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_127_7_127_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_127_7_127_19&#39;)"><span class="hl_conref"><span class="mpre">Error_Packet</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;partial packet: expecting &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_39_15_39_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_15_39_17&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; bytes, got: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_40_5_40_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_5_40_10&#39;)"><span class="hl_varref"><span class="mpre">hdrbs</span></span></a><span class="mpre">)))
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_40_5_40_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_5_40_10&#39;)"><span class="hl_varref"><span class="mpre">hdrbs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | recvRecord receive a full TLS record (header + data), from the other side.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The record is disengaged from the record layer</span></span><span class="mpre">
</span><a href="#loc_54_1_54_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_11&#39;)"><span class="mpre">recvRecord</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ flag to enable SSLv2 compat ClientHello reception</span></span><span class="mpre">
           -&gt; </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ TLS context</span></span><span class="mpre">
           -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_121_6_121_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_121_6_121_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSError</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Record.Types.html#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a href="Network.TLS.Record.Types.html#loc_51_6_51_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_51_6_51_15&#39;)"><span class="hl_tyconref"><span class="mpre">Plaintext</span></span></a><span class="mpre">))
</span><a name="loc_54_1_54_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_11&#39;)"><span class="hl_fundecl"><span class="mpre">recvRecord</span></span></a><span class="mpre"> </span><a name="loc_54_12_54_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_12_54_23&#39;)"><span class="hl_vardecl"><span class="mpre">compatSSLv2</span></span></a><span class="mpre"> </span><a name="loc_54_24_54_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_24_54_27&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre">
#ifdef SSLV2_COMPATIBLE
    | </span><a href="#loc_54_12_54_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_12_54_23&#39;)"><span class="hl_varref"><span class="mpre">compatSSLv2</span></span></a><span class="mpre"> = do
        </span><a name="loc_57_9_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_9_57_15&#39;)"><span class="hl_vardecl"><span class="mpre">header</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_varref"><span class="mpre">readExact</span></span></a><span class="mpre"> </span><a href="#loc_54_24_54_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_24_54_27&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
        if </span><span class="hl_varref"><span class="mpre">B.head</span></span><span class="mpre"> </span><a href="#loc_57_9_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_9_57_15&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">
            then </span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_varref"><span class="mpre">readExact</span></span></a><span class="mpre"> </span><a href="#loc_54_24_54_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_24_54_27&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">) </span><a href="#loc_63_15_63_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_15_63_25&#39;)"><span class="hl_varref"><span class="mpre">recvLength</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.TLS.Packet.html#loc_117_1_117_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Packet.html#loc_117_1_117_13&#39;)"><span class="hl_varref"><span class="mpre">decodeHeader</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.append</span></span><span class="mpre"> </span><a href="#loc_57_9_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_9_57_15&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="mpre">
            else </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">) </span><a href="#loc_67_15_67_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_15_67_35&#39;)"><span class="hl_varref"><span class="mpre">recvDeprecatedLength</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Packet.html#loc_120_1_120_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Packet.html#loc_120_1_120_29&#39;)"><span class="hl_varref"><span class="mpre">decodeDeprecatedHeaderLength</span></span></a><span class="mpre"> </span><a href="#loc_57_9_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_9_57_15&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="mpre">
#endif
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_varref"><span class="mpre">readExact</span></span></a><span class="mpre"> </span><a href="#loc_54_24_54_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_24_54_27&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">) </span><a href="#loc_63_15_63_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_15_63_25&#39;)"><span class="hl_varref"><span class="mpre">recvLength</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.TLS.Packet.html#loc_117_1_117_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Packet.html#loc_117_1_117_13&#39;)"><span class="hl_varref"><span class="mpre">decodeHeader</span></span></a><span class="mpre">
        where </span><a name="loc_63_15_63_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_15_63_25&#39;)"><span class="hl_fundecl"><span class="mpre">recvLength</span></span></a><span class="mpre"> </span><a name="loc_63_26_63_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_26_63_32&#39;)"><span class="hl_specname"><span class="mpre">header</span></span></a><span class="mpre">@(</span><a href="Network.TLS.Struct.html#loc_157_15_157_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_15_157_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> _ _ </span><a name="loc_63_45_63_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_45_63_52&#39;)"><span class="hl_vardecl"><span class="mpre">readlen</span></span></a><span class="mpre">)
                | </span><a href="#loc_63_45_63_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_45_63_52&#39;)"><span class="hl_varref"><span class="mpre">readlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">16384</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2048</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_75_15_75_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_34&#39;)"><span class="hl_varref"><span class="mpre">maximumSizeExceeded</span></span></a><span class="mpre">
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">              = </span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_varref"><span class="mpre">readExact</span></span></a><span class="mpre"> </span><a href="#loc_54_24_54_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_24_54_27&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_63_45_63_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_45_63_52&#39;)"><span class="hl_varref"><span class="mpre">readlen</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_77_15_77_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_15_77_24&#39;)"><span class="hl_varref"><span class="mpre">getRecord</span></span></a><span class="mpre"> </span><a href="#loc_63_26_63_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_26_63_32&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="mpre">
#ifdef SSLV2_COMPATIBLE
              </span><a name="loc_67_15_67_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_15_67_35&#39;)"><span class="hl_fundecl"><span class="mpre">recvDeprecatedLength</span></span></a><span class="mpre"> </span><a name="loc_67_36_67_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_36_67_43&#39;)"><span class="hl_vardecl"><span class="mpre">readlen</span></span></a><span class="mpre">
                | </span><a href="#loc_67_36_67_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_36_67_43&#39;)"><span class="hl_varref"><span class="mpre">readlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1024</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">     = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_75_15_75_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_34&#39;)"><span class="hl_varref"><span class="mpre">maximumSizeExceeded</span></span></a><span class="mpre">
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">              = do
                    </span><a name="loc_70_21_70_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_21_70_28&#39;)"><span class="hl_vardecl"><span class="mpre">content</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_10&#39;)"><span class="hl_varref"><span class="mpre">readExact</span></span></a><span class="mpre"> </span><a href="#loc_54_24_54_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_24_54_27&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_67_36_67_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_36_67_43&#39;)"><span class="hl_varref"><span class="mpre">readlen</span></span></a><span class="mpre">)
                    case </span><a href="Network.TLS.Packet.html#loc_123_1_123_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Packet.html#loc_123_1_123_23&#39;)"><span class="hl_varref"><span class="mpre">decodeDeprecatedHeader</span></span></a><span class="mpre"> </span><a href="#loc_67_36_67_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_36_67_43&#39;)"><span class="hl_varref"><span class="mpre">readlen</span></span></a><span class="mpre"> </span><a href="#loc_70_21_70_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_21_70_28&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre"> of
                        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_72_30_72_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_30_72_33&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">     -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_72_30_72_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_30_72_33&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
                        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_73_31_73_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_31_73_37&#39;)"><span class="hl_vardecl"><span class="mpre">header</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_77_15_77_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_15_77_24&#39;)"><span class="hl_varref"><span class="mpre">getRecord</span></span></a><span class="mpre"> </span><a href="#loc_73_31_73_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_31_73_37&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="mpre"> </span><a href="#loc_70_21_70_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_21_70_28&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre">
#endif
              </span><a name="loc_75_15_75_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_34&#39;)"><span class="hl_vardecl"><span class="mpre">maximumSizeExceeded</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Struct.html#loc_123_7_123_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_123_7_123_21&#39;)"><span class="hl_conref"><span class="mpre">Error_Protocol</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;record exceeding maximum size&quot;</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_186_7_186_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_186_7_186_21&#39;)"><span class="hl_conref"><span class="mpre">RecordOverflow</span></span></a><span class="mpre">)
              </span><a href="#loc_77_15_77_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_15_77_24&#39;)"><span class="mpre">getRecord</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_157_6_157_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_6_157_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_121_6_121_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_121_6_121_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSError</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Record.Types.html#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a href="Network.TLS.Record.Types.html#loc_51_6_51_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_51_6_51_15&#39;)"><span class="hl_tyconref"><span class="mpre">Plaintext</span></span></a><span class="mpre">))
              </span><a name="loc_77_15_77_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_15_77_24&#39;)"><span class="hl_fundecl"><span class="mpre">getRecord</span></span></a><span class="mpre"> </span><a name="loc_77_25_77_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_25_77_31&#39;)"><span class="hl_vardecl"><span class="mpre">header</span></span></a><span class="mpre"> </span><a name="loc_77_32_77_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_32_77_39&#39;)"><span class="hl_vardecl"><span class="mpre">content</span></span></a><span class="mpre"> = do
                    </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Context.Internal.html#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_164_1_164_8&#39;)"><span class="hl_varref"><span class="mpre">withLog</span></span></a><span class="mpre"> </span><a href="#loc_54_24_54_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_24_54_27&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_78_45_78_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_45_78_52&#39;)"><span class="hl_vardecl"><span class="mpre">logging</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Hooks.html#loc_26_7_26_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Hooks.html#loc_26_7_26_20&#39;)"><span class="hl_varref"><span class="mpre">loggingIORecv</span></span></a><span class="mpre"> </span><a href="#loc_78_45_78_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_45_78_52&#39;)"><span class="hl_varref"><span class="mpre">logging</span></span></a><span class="mpre"> </span><a href="#loc_77_25_77_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_25_77_31&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="mpre"> </span><a href="#loc_77_32_77_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_32_77_39&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre">
                    </span><a href="Network.TLS.Context.Internal.html#loc_203_1_203_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_203_1_203_11&#39;)"><span class="hl_varref"><span class="mpre">runRxState</span></span></a><span class="mpre"> </span><a href="#loc_54_24_54_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_24_54_27&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Record.Disengage.html#loc_29_1_29_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Disengage.html#loc_29_1_29_16&#39;)"><span class="hl_varref"><span class="mpre">disengageRecord</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Record.Types.html#loc_92_1_92_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_92_1_92_12&#39;)"><span class="hl_varref"><span class="mpre">rawToRecord</span></span></a><span class="mpre"> </span><a href="#loc_77_25_77_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_25_77_31&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Record.Types.html#loc_59_1_59_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.Types.html#loc_59_1_59_19&#39;)"><span class="hl_varref"><span class="mpre">fragmentCiphertext</span></span></a><span class="mpre"> </span><a href="#loc_77_32_77_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_32_77_39&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | receive one packet from the context that contains 1 or</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- many messages (many only in case of handshake). if will returns a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- TLSError if the packet is unexpected or malformed</span></span><span class="mpre">
</span><a href="#loc_86_1_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_11&#39;)"><span class="mpre">recvPacket</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/IO.hs&quot;, srcSpanStartLine = 85, srcSpanStartColumn = 15, srcSpanEndLine = 85, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/IO.hs&quot;, srcSpanStartLine = 85, srcSpanStartColumn = 25, srcSpanEndLine = 85, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/IO.hs&quot;, "><span class="mpre">MonadIO m =&gt;</span></span><span class="mpre"> </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_121_6_121_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_121_6_121_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSError</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_150_6_150_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_150_6_150_12&#39;)"><span class="hl_tyconref"><span class="mpre">Packet</span></span></a><span class="mpre">)
</span><a name="loc_86_1_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_11&#39;)"><span class="hl_fundecl"><span class="mpre">recvPacket</span></span></a><span class="mpre"> </span><a name="loc_86_12_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_15&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> = </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_87_5_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_16&#39;)"><span class="hl_vardecl"><span class="mpre">compatSSLv2</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Context.Internal.html#loc_143_1_143_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_143_1_143_23&#39;)"><span class="hl_varref"><span class="mpre">ctxHasSSLv2ClientHello</span></span></a><span class="mpre"> </span><a href="#loc_86_12_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre">
    </span><a name="loc_88_5_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_5_88_12&#39;)"><span class="hl_vardecl"><span class="mpre">erecord</span></span></a><span class="mpre">     &lt;- </span><a href="#loc_54_1_54_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_11&#39;)"><span class="hl_varref"><span class="mpre">recvRecord</span></span></a><span class="mpre"> </span><a href="#loc_87_5_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_16&#39;)"><span class="hl_varref"><span class="mpre">compatSSLv2</span></span></a><span class="mpre"> </span><a href="#loc_86_12_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre">
    case </span><a href="#loc_88_5_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_5_88_12&#39;)"><span class="hl_varref"><span class="mpre">erecord</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_90_14_90_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_14_90_17&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">     -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_90_14_90_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_14_90_17&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_91_15_91_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_15_91_21&#39;)"><span class="hl_vardecl"><span class="mpre">record</span></span></a><span class="mpre"> -&gt; do
            </span><a name="loc_92_13_92_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_13_92_20&#39;)"><span class="hl_vardecl"><span class="mpre">pktRecv</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Receiving.html#loc_33_1_33_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Receiving.html#loc_33_1_33_14&#39;)"><span class="hl_varref"><span class="mpre">processPacket</span></span></a><span class="mpre"> </span><a href="#loc_86_12_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_91_15_91_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_15_91_21&#39;)"><span class="hl_varref"><span class="mpre">record</span></span></a><span class="mpre">
            </span><a name="loc_93_13_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_13_93_16&#39;)"><span class="hl_vardecl"><span class="mpre">pkt</span></span></a><span class="mpre"> &lt;- case </span><a href="#loc_92_13_92_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_13_92_20&#39;)"><span class="hl_varref"><span class="mpre">pktRecv</span></span></a><span class="mpre"> of
                    </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_151_7_151_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_151_7_151_16&#39;)"><span class="hl_conref"><span class="mpre">Handshake</span></span></a><span class="mpre"> </span><a name="loc_94_38_94_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_38_94_41&#39;)"><span class="hl_vardecl"><span class="mpre">hss</span></span></a><span class="mpre">) -&gt;
                        </span><a href="Network.TLS.Context.Internal.html#loc_155_1_155_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_155_1_155_13&#39;)"><span class="hl_varref"><span class="mpre">ctxWithHooks</span></span></a><span class="mpre"> </span><a href="#loc_86_12_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_95_45_95_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_45_95_50&#39;)"><span class="hl_vardecl"><span class="mpre">hooks</span></span></a><span class="mpre"> -&gt;
                            (</span><a href="Control.Monad.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_111_1_111_5&#39;)"><span class="hl_varref"><span class="mpre">mapM</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Hooks.html#loc_43_7_43_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Hooks.html#loc_43_7_43_24&#39;)"><span class="hl_varref"><span class="mpre">hookRecvHandshake</span></span></a><span class="mpre"> </span><a href="#loc_95_45_95_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_45_95_50&#39;)"><span class="hl_varref"><span class="mpre">hooks</span></span></a><span class="mpre">) </span><a href="#loc_94_38_94_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_38_94_41&#39;)"><span class="hl_varref"><span class="mpre">hss</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_151_7_151_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_151_7_151_16&#39;)"><span class="hl_conref"><span class="mpre">Handshake</span></span></a><span class="mpre">
                    _                     -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_92_13_92_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_13_92_20&#39;)"><span class="hl_varref"><span class="mpre">pktRecv</span></span></a><span class="mpre">
            case </span><a href="#loc_93_13_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_13_93_16&#39;)"><span class="hl_varref"><span class="mpre">pkt</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_99_23_99_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_23_99_24&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Context.Internal.html#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_164_1_164_8&#39;)"><span class="hl_varref"><span class="mpre">withLog</span></span></a><span class="mpre"> </span><a href="#loc_86_12_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_99_43_99_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_43_99_50&#39;)"><span class="hl_vardecl"><span class="mpre">logging</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Hooks.html#loc_24_7_24_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Hooks.html#loc_24_7_24_24&#39;)"><span class="hl_varref"><span class="mpre">loggingPacketRecv</span></span></a><span class="mpre"> </span><a href="#loc_99_43_99_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_43_99_50&#39;)"><span class="hl_varref"><span class="mpre">logging</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_99_23_99_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_23_99_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                _       -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
            </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> </span><a href="#loc_87_5_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_16&#39;)"><span class="hl_varref"><span class="mpre">compatSSLv2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Context.Internal.html#loc_146_1_146_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_146_1_146_27&#39;)"><span class="hl_varref"><span class="mpre">ctxDisableSSLv2ClientHello</span></span></a><span class="mpre"> </span><a href="#loc_86_12_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_93_13_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_13_93_16&#39;)"><span class="hl_varref"><span class="mpre">pkt</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Send one packet to the context</span></span><span class="mpre">
</span><a href="#loc_106_1_106_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_11&#39;)"><span class="mpre">sendPacket</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/IO.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 15, srcSpanEndLine = 105, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/IO.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 25, srcSpanEndLine = 105, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/IO.h"><span class="mpre">MonadIO m =&gt;</span></span><span class="mpre"> </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">Context</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_150_6_150_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_150_6_150_12&#39;)"><span class="hl_tyconref"><span class="mpre">Packet</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_106_1_106_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_11&#39;)"><span class="hl_fundecl"><span class="mpre">sendPacket</span></span></a><span class="mpre"> </span><a name="loc_106_12_106_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_12_106_15&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_106_16_106_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_16_106_19&#39;)"><span class="hl_vardecl"><span class="mpre">pkt</span></span></a><span class="mpre"> = do
    </span><span class="hl_comment"><span class="mpre">-- in ver &lt;= TLS1.0, block ciphers using CBC are using CBC residue as IV, which can be guessed</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- by an attacker. Hence, an empty packet is sent before a normal data packet, to</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- prevent guessability.</span></span><span class="mpre">
    </span><a name="loc_110_5_110_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_5_110_20&#39;)"><span class="hl_vardecl"><span class="mpre">withEmptyPacket</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Context.Internal.html#loc_94_7_94_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_94_7_94_25&#39;)"><span class="hl_varref"><span class="mpre">ctxNeedEmptyPacket</span></span></a><span class="mpre"> </span><a href="#loc_106_12_106_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_12_106_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_121_9_121_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_25&#39;)"><span class="hl_varref"><span class="mpre">isNonNullAppData</span></span></a><span class="mpre"> </span><a href="#loc_106_16_106_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_16_106_19&#39;)"><span class="hl_varref"><span class="mpre">pkt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_110_5_110_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_5_110_20&#39;)"><span class="hl_varref"><span class="mpre">withEmptyPacket</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_106_1_106_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_11&#39;)"><span class="hl_varref"><span class="mpre">sendPacket</span></span></a><span class="mpre"> </span><a href="#loc_106_12_106_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_12_106_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_154_7_154_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_154_7_154_14&#39;)"><span class="hl_conref"><span class="mpre">AppData</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">

    </span><a name="loc_113_5_113_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_16&#39;)"><span class="hl_vardecl"><span class="mpre">edataToSend</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
                        </span><a href="Network.TLS.Context.Internal.html#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_164_1_164_8&#39;)"><span class="hl_varref"><span class="mpre">withLog</span></span></a><span class="mpre"> </span><a href="#loc_106_12_106_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_12_106_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_114_40_114_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_40_114_47&#39;)"><span class="hl_vardecl"><span class="mpre">logging</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Hooks.html#loc_23_7_23_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Hooks.html#loc_23_7_23_24&#39;)"><span class="hl_varref"><span class="mpre">loggingPacketSent</span></span></a><span class="mpre"> </span><a href="#loc_114_40_114_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_40_114_47&#39;)"><span class="hl_varref"><span class="mpre">logging</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_106_16_106_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_16_106_19&#39;)"><span class="hl_varref"><span class="mpre">pkt</span></span></a><span class="mpre">)
                        </span><a href="Network.TLS.Sending.html#loc_52_1_52_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Sending.html#loc_52_1_52_12&#39;)"><span class="hl_varref"><span class="mpre">writePacket</span></span></a><span class="mpre"> </span><a href="#loc_106_12_106_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_12_106_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_106_16_106_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_16_106_19&#39;)"><span class="hl_varref"><span class="mpre">pkt</span></span></a><span class="mpre">
    case </span><a href="#loc_113_5_113_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_16&#39;)"><span class="hl_varref"><span class="mpre">edataToSend</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_117_14_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_14_117_17&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">         -&gt; </span><a href="Network.TLS.Context.Internal.html#loc_167_1_167_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_167_1_167_10&#39;)"><span class="hl_varref"><span class="mpre">throwCore</span></span></a><span class="mpre"> </span><a href="#loc_117_14_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_14_117_17&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_118_15_118_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_15_118_25&#39;)"><span class="hl_vardecl"><span class="mpre">dataToSend</span></span></a><span class="mpre"> -&gt; </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><a href="Network.TLS.Context.Internal.html#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_164_1_164_8&#39;)"><span class="hl_varref"><span class="mpre">withLog</span></span></a><span class="mpre"> </span><a href="#loc_106_12_106_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_12_106_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_119_28_119_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_28_119_35&#39;)"><span class="hl_vardecl"><span class="mpre">logging</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Hooks.html#loc_25_7_25_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Hooks.html#loc_25_7_25_20&#39;)"><span class="hl_varref"><span class="mpre">loggingIOSent</span></span></a><span class="mpre"> </span><a href="#loc_119_28_119_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_28_119_35&#39;)"><span class="hl_varref"><span class="mpre">logging</span></span></a><span class="mpre"> </span><a href="#loc_118_15_118_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_15_118_25&#39;)"><span class="hl_varref"><span class="mpre">dataToSend</span></span></a><span class="mpre">
            </span><a href="Network.TLS.Context.Internal.html#loc_134_1_134_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_134_1_134_12&#39;)"><span class="hl_varref"><span class="mpre">contextSend</span></span></a><span class="mpre"> </span><a href="#loc_106_12_106_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_12_106_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_118_15_118_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_15_118_25&#39;)"><span class="hl_varref"><span class="mpre">dataToSend</span></span></a><span class="mpre">
  where </span><a name="loc_121_9_121_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_25&#39;)"><span class="hl_fundecl"><span class="mpre">isNonNullAppData</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_154_7_154_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_154_7_154_14&#39;)"><span class="hl_conref"><span class="mpre">AppData</span></span></a><span class="mpre"> </span><a name="loc_121_35_121_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_35_121_36&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_121_35_121_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_35_121_36&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
        </span><a href="#loc_121_9_121_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_25&#39;)"><span class="hl_fundecl"><span class="mpre">isNonNullAppData</span></span></a><span class="mpre"> _           = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span></div></body></html>