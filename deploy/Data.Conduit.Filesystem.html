<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE RankNTypes #-}
module Data.Conduit.Filesystem
    ( sourceDirectory
    , sourceDirectoryDeep
    ) where

import Data.Conduit
import Control.Monad.Trans.Resource (MonadResource)
import Control.Monad.IO.Class (</span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="mpre">liftIO</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Filesystem.hs&quot;, srcSpanStartLine = 10, srcSpanStartColumn = 8, srcSpanEndLine = 10, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;System.FilePath&quot;"><span class="mpre">System.FilePath</span></span><span class="mpre"> ((&lt;/&gt;))
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Filesystem.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 18, srcSpanEndLine = 11, srcSpanEndColumn = 43}, srcInfoPoints = []}) &quot;Data.Streaming.Filesystem&quot;"><span class="mpre">Data.Streaming.Filesystem</span></span><span class="mpre"> as F

</span><span class="hl_comment"><span class="mpre">-- | Stream the contents of the given directory, without traversing deeply.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function will return /all/ of the contents of the directory, whether</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- they be files, directories, etc.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that the generated filepaths will be the complete path, not just the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- filename. In other words, if you have a directory @foo@ containing files</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @bar@ and @baz@, and you use @sourceDirectory@ on @foo@, the results will be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @foo/bar@ and @foo/baz@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 1.1.0</span></span><span class="mpre">
</span><a href="#loc_25_1_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_16&#39;)"><span class="mpre">sourceDirectory</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Filesystem.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 20, srcSpanEndLine = 24, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Filesystem.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 36, srcSpanEndLine = 24, srcSpanEndColumn = 38}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemn"><span class="mpre">MonadResource m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_25_1_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_16&#39;)"><span class="hl_fundecl"><span class="mpre">sourceDirectory</span></span></a><span class="mpre"> </span><a name="loc_25_17_25_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_17_25_20&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre"> =
    </span><a href="Data.Conduit.html#loc_226_1_226_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_226_1_226_9&#39;)"><span class="hl_varref"><span class="mpre">bracketP</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">F.openDirStream</span></span><span class="mpre"> </span><a href="#loc_25_17_25_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_17_25_20&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">) </span><span class="hl_varref"><span class="mpre">F.closeDirStream</span></span><span class="mpre"> </span><a href="#loc_28_5_28_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
    </span><a name="loc_28_5_28_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_28_8_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_8_28_10&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre"> =
        </span><a href="#loc_31_9_31_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
      where
        </span><a name="loc_31_9_31_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_13&#39;)"><span class="hl_vardecl"><span class="mpre">loop</span></span></a><span class="mpre"> = do
            </span><a name="loc_32_13_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_13_32_16&#39;)"><span class="hl_vardecl"><span class="mpre">mfp</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">F.readDirStream</span></span><span class="mpre"> </span><a href="#loc_28_8_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_8_28_10&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
            case </span><a href="#loc_32_13_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_13_32_16&#39;)"><span class="hl_varref"><span class="mpre">mfp</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
                </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_35_22_35_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_22_35_24&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> -&gt; do
                    </span><a href="Data.Conduit.html#loc_180_1_180_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_180_1_180_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_25_17_25_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_17_25_20&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_35_22_35_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_22_35_24&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">
                    </span><a href="#loc_31_9_31_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Deeply stream the contents of the given directory.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This works the same as @sourceDirectory@, but will not return directories at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- all. This function also takes an extra parameter to indicate whether</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- symlinks will be followed.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 1.1.0</span></span><span class="mpre">
</span><a href="#loc_50_1_50_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_20&#39;)"><span class="mpre">sourceDirectoryDeep</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Filesystem.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 24, srcSpanEndLine = 47, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Filesystem.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 21, srcSpanEndLine = 47, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemn"><span class="mpre">MonadResource m
                    =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Follow directory symlinks</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Root directory</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_50_1_50_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_20&#39;)"><span class="hl_fundecl"><span class="mpre">sourceDirectoryDeep</span></span></a><span class="mpre"> </span><a name="loc_50_21_50_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_21_50_35&#39;)"><span class="hl_vardecl"><span class="mpre">followSymlinks</span></span></a><span class="mpre"> =
    </span><a href="#loc_54_5_54_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_10&#39;)"><span class="hl_varref"><span class="mpre">start</span></span></a><span class="mpre">
  where
    </span><a href="#loc_54_5_54_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_10&#39;)"><span class="mpre">start</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Filesystem.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 14, srcSpanEndLine = 53, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Filesystem.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 30, srcSpanEndLine = 53, srcSpanEndColumn = 32}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemn"><span class="mpre">MonadResource m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
    </span><a name="loc_54_5_54_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_10&#39;)"><span class="hl_fundecl"><span class="mpre">start</span></span></a><span class="mpre"> </span><a name="loc_54_11_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_11_54_14&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre"> = </span><a href="#loc_25_1_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_16&#39;)"><span class="hl_varref"><span class="mpre">sourceDirectory</span></span></a><span class="mpre"> </span><a href="#loc_54_11_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_11_54_14&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> </span><a href="Data.Conduit.html#loc_160_15_160_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_160_15_160_18&#39;)"><span class="hl_infix"><span class="mpre">=$=</span></span></a><span class="mpre"> </span><a href="Data.Conduit.html#loc_263_1_263_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_263_1_263_13&#39;)"><span class="hl_varref"><span class="mpre">awaitForever</span></span></a><span class="mpre"> </span><a href="#loc_57_5_57_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">

    </span><a href="#loc_57_5_57_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_7&#39;)"><span class="mpre">go</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Filesystem.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 11, srcSpanEndLine = 56, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Filesystem.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 27, srcSpanEndLine = 56, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemn"><span class="mpre">MonadResource m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Producer</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
    </span><a name="loc_57_5_57_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_57_8_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_8_57_10&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> = do
        </span><a name="loc_58_9_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_11&#39;)"><span class="hl_vardecl"><span class="mpre">ft</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">F.getFileType</span></span><span class="mpre"> </span><a href="#loc_57_8_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_8_57_10&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">
        case </span><a href="#loc_58_9_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_11&#39;)"><span class="hl_varref"><span class="mpre">ft</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">F.FTFile</span></span><span class="mpre"> -&gt; </span><a href="Data.Conduit.html#loc_180_1_180_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_180_1_180_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> </span><a href="#loc_57_8_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_8_57_10&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">F.FTFileSym</span></span><span class="mpre"> -&gt; </span><a href="Data.Conduit.html#loc_180_1_180_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_180_1_180_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> </span><a href="#loc_57_8_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_8_57_10&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">F.FTDirectory</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_5_54_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_10&#39;)"><span class="hl_varref"><span class="mpre">start</span></span></a><span class="mpre"> </span><a href="#loc_57_8_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_8_57_10&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">F.FTDirectorySym</span></span><span class="mpre">
                | </span><a href="#loc_50_21_50_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_21_50_35&#39;)"><span class="hl_varref"><span class="mpre">followSymlinks</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_54_5_54_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_10&#39;)"><span class="hl_varref"><span class="mpre">start</span></span></a><span class="mpre"> </span><a href="#loc_57_8_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_8_57_10&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">F.FTOther</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
</span></div></body></html>