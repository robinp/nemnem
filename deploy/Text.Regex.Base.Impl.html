<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Text.Regex.Impl</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) Chris Kuklewicz 2006</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org, textregexlazy@personal.mightyreason.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (Text.Regex.Base needs MPTC+FD)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Helper functions for defining certain instances of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- RegexContext. These help when defining instances of RegexContext</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with repeated types:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instance (RegexLike regex source) =&gt; RegexContext regex source source where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- runs into overlapping restrictions. To avoid this I have each backend</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- define, for its own Regex type:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instance RegexContext Regex String String where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   match = polymatch</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   matchM = polymatchM</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instance RegexContext Regex ByteString ByteString where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   match = polymatch</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   matchM = polymatchM</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-------------------------------------------------------------------------------</span></span><span class="mpre">

module Text.Regex.Base.Impl(polymatch,polymatchM) where

import Text.Regex.Base
import Data.Array((!))

</span><a href="#loc_42_1_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_12&#39;)"><span class="mpre">regexFailed</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/Impl.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 16, srcSpanEndLine = 40, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/Impl.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 16, srcSpanEndLine = 40, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/Impl.hs&quot;"><span class="mpre">(Monad m) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_42_1_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_12&#39;)"><span class="mpre">regexFailed</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_42_1_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_12&#39;)"><span class="hl_vardecl"><span class="mpre">regexFailed</span></span></a><span class="mpre"> =  </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;regex failed to match&quot;</span></span><span class="mpre">

</span><a href="#loc_46_1_46_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_6&#39;)"><span class="mpre">actOn</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/Impl.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 10, srcSpanEndLine = 44, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/Impl.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 10, srcSpanEndLine = 44, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/Impl.hs&quot;"><span class="mpre">(RegexLike r s,Monad m) =&gt;</span></span><span class="mpre"> ((</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">MatchText</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)-&gt;</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_46_1_46_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_6&#39;)"><span class="mpre">actOn</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_46_1_46_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_6&#39;)"><span class="hl_fundecl"><span class="mpre">actOn</span></span></a><span class="mpre"> </span><a name="loc_46_7_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_7_46_8&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_46_9_46_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_10&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_46_11_46_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_11_46_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = case </span><a href="Text.Regex.Base.RegexLike.html#loc_154_3_154_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_154_3_154_16&#39;)"><span class="hl_varref"><span class="mpre">matchOnceText</span></span></a><span class="mpre"> </span><a href="#loc_46_9_46_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_46_11_46_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_11_46_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_42_1_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_12&#39;)"><span class="hl_varref"><span class="mpre">regexFailed</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_48_10_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_10_48_19&#39;)"><span class="hl_vardecl"><span class="mpre">preMApost</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_46_7_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_7_46_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_48_10_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_10_48_19&#39;)"><span class="hl_varref"><span class="mpre">preMApost</span></span></a><span class="mpre">)

</span><a href="#loc_52_1_52_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_10&#39;)"><span class="mpre">polymatch</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/Impl.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 14, srcSpanEndLine = 50, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/Impl.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 14, srcSpanEndLine = 50, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/Impl.hs&quot;"><span class="mpre">(RegexLike a b) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_52_1_52_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_10&#39;)"><span class="mpre">polymatch</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_52_1_52_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_10&#39;)"><span class="hl_fundecl"><span class="mpre">polymatch</span></span></a><span class="mpre"> </span><a name="loc_52_11_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_11_52_12&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_52_13_52_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_13_52_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = case </span><a href="Text.Regex.Base.RegexLike.html#loc_154_3_154_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_154_3_154_16&#39;)"><span class="hl_varref"><span class="mpre">matchOnceText</span></span></a><span class="mpre"> </span><a href="#loc_52_11_52_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_11_52_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_52_13_52_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_13_52_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="Text.Regex.Base.RegexLike.html#loc_202_3_202_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_202_3_202_8&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (_,</span><a name="loc_54_13_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_13_54_15&#39;)"><span class="hl_vardecl"><span class="mpre">ma</span></span></a><span class="mpre">,_) -&gt; </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> (</span><a href="#loc_54_13_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_13_54_15&#39;)"><span class="hl_varref"><span class="mpre">ma</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)

</span><a href="#loc_58_1_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_11&#39;)"><span class="mpre">polymatchM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/Impl.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 15, srcSpanEndLine = 56, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/Impl.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 15, srcSpanEndLine = 56, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/Impl.hs&quot;"><span class="mpre">(RegexLike a b,Monad m) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_58_1_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_11&#39;)"><span class="mpre">polymatchM</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_58_1_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_11&#39;)"><span class="hl_vardecl"><span class="mpre">polymatchM</span></span></a><span class="mpre"> =  </span><a href="#loc_46_1_46_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_6&#39;)"><span class="hl_varref"><span class="mpre">actOn</span></span></a><span class="mpre"> (\(_,</span><a name="loc_58_26_58_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_26_58_28&#39;)"><span class="hl_vardecl"><span class="mpre">ma</span></span></a><span class="mpre">,_)-&gt;</span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> (</span><a href="#loc_58_26_58_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_26_58_28&#39;)"><span class="hl_varref"><span class="mpre">ma</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">))
</span></div></body></html>