<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE RecordWildCards, OverloadedStrings #-}
</span><span class="hl_comment"><span class="mpre">-- | Implements HTTP Basic Authentication.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module may add digest authentication in the future.</span></span><span class="mpre">
module Network.Wai.Middleware.HttpAuth
    ( basicAuth
    , CheckCreds
    , AuthSettings
    , authRealm
    , authOnNoAuth
    , authIsProtected
    ) where

import Network.Wai
import Network.HTTP.Types (</span><a href="Network.HTTP.Types.Status.html#loc_313_1_313_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_313_1_313_10&#39;)"><span class="mpre">status401</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Middleware/HttpAuth.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 8, srcSpanEndLine = 16, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Middleware/HttpAuth.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 18, srcSpanEndLine = 17, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import Data.String (</span><a href="Data.String.html#loc_34_7_34_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.String.html#loc_34_7_34_15&#39;)"><span class="mpre">IsString</span></a><span class="mpre"> (..))
import Data.Word8 (</span><a href="Data.Word8.html#loc_44_1_44_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Word8.html#loc_44_1_44_8&#39;)"><span class="mpre">isSpace</span></a><span class="mpre">, </span><a href="Data.Word8.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Word8.html#loc_189_1_189_7&#39;)"><span class="mpre">_colon</span></a><span class="mpre">, </span><a href="Data.Word8.html#loc_140_1_140_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Word8.html#loc_140_1_140_8&#39;)"><span class="mpre">toLower</span></a><span class="mpre">)
import Data.ByteString.Base64 (</span><a href="Data.ByteString.Base64.html#loc_47_1_47_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Base64.html#loc_47_1_47_14&#39;)"><span class="mpre">decodeLenient</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Check if a given username and password is valid.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Middleware/HttpAuth.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 1, srcSpanEndLine = 25, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Middleware/HttpAuth.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 1, srcSpanEndLine = 23, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Netw"><span class="mpre">type CheckCreds = ByteString
               -&gt; ByteString
               -&gt; IO Bool</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Perform basic authentication.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; basicAuth (\u p -&gt; return $ u == &quot;michael&quot; &amp;&amp; p == &quot;mypass&quot;) &quot;My Realm&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 1.3.4</span></span><span class="mpre">
</span><a href="#loc_35_1_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_10&#39;)"><span class="mpre">basicAuth</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CheckCreds</span></span><span class="mpre">
          -&gt; </span><a href="#loc_65_6_65_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_6_65_18&#39;)"><span class="hl_tyconref"><span class="mpre">AuthSettings</span></span></a><span class="mpre">
          -&gt; </span><span class="hl_tyconref"><span class="mpre">Middleware</span></span><span class="mpre">
</span><a name="loc_35_1_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_10&#39;)"><span class="hl_fundecl"><span class="mpre">basicAuth</span></span></a><span class="mpre"> </span><a name="loc_35_11_35_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_11_35_21&#39;)"><span class="hl_vardecl"><span class="mpre">checkCreds</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Middleware/HttpAuth.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 22, srcSpanEndLine = 35, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Middleware/HttpAuth.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 35, srcSpanEndLine = 35, srcSpanEndColumn = 36},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Netwo"><span class="mpre">AuthSettings {..}</span></span><span class="mpre"> </span><a name="loc_35_40_35_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_40_35_43&#39;)"><span class="hl_vardecl"><span class="mpre">app</span></span></a><span class="mpre"> </span><a name="loc_35_44_35_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_44_35_47&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> </span><a name="loc_35_48_35_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_48_35_60&#39;)"><span class="hl_vardecl"><span class="mpre">sendResponse</span></span></a><span class="mpre"> = do
    </span><a name="loc_36_5_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_5_36_16&#39;)"><span class="hl_vardecl"><span class="mpre">isProtected</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_75_7_75_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_7_75_22&#39;)"><span class="hl_varref"><span class="mpre">authIsProtected</span></span></a><span class="mpre"> </span><a href="#loc_35_44_35_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_44_35_47&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
    </span><a name="loc_37_5_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_12&#39;)"><span class="hl_vardecl"><span class="mpre">allowed</span></span></a><span class="mpre"> &lt;- if </span><a href="#loc_36_5_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_5_36_16&#39;)"><span class="hl_varref"><span class="mpre">isProtected</span></span></a><span class="mpre"> then </span><a href="#loc_42_5_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_5_42_10&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    if </span><a href="#loc_37_5_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_12&#39;)"><span class="hl_varref"><span class="mpre">allowed</span></span></a><span class="mpre">
        then </span><a href="#loc_35_40_35_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_40_35_43&#39;)"><span class="hl_varref"><span class="mpre">app</span></span></a><span class="mpre"> </span><a href="#loc_35_44_35_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_44_35_47&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><a href="#loc_35_48_35_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_48_35_60&#39;)"><span class="hl_varref"><span class="mpre">sendResponse</span></span></a><span class="mpre">
        else </span><a href="#loc_70_7_70_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_7_70_19&#39;)"><span class="hl_varref"><span class="mpre">authOnNoAuth</span></span></a><span class="mpre"> </span><a href="#loc_66_7_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_7_66_16&#39;)"><span class="hl_varref"><span class="mpre">authRealm</span></span></a><span class="mpre"> </span><a href="#loc_35_44_35_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_44_35_47&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><a href="#loc_35_48_35_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_48_35_60&#39;)"><span class="hl_varref"><span class="mpre">sendResponse</span></span></a><span class="mpre">
  where
    </span><a name="loc_42_5_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_5_42_10&#39;)"><span class="hl_vardecl"><span class="mpre">check</span></span></a><span class="mpre"> =
        case </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Authorization&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Internal.html#loc_36_6_36_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_36_6_36_20&#39;)"><span class="hl_varref"><span class="mpre">requestHeaders</span></span></a><span class="mpre"> </span><a href="#loc_35_44_35_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_44_35_47&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_45_18_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_18_45_20&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> -&gt;
                let (</span><a name="loc_46_22_46_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_22_46_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_46_25_46_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_25_46_26&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.break</span></span><span class="mpre"> </span><a href="Data.Word8.html#loc_44_1_44_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Word8.html#loc_44_1_44_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><a href="#loc_45_18_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_18_45_20&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                 in if </span><span class="hl_varref"><span class="mpre">S.map</span></span><span class="mpre"> </span><a href="Data.Word8.html#loc_140_1_140_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Word8.html#loc_140_1_140_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><a href="#loc_46_22_46_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_22_46_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;basic&quot;</span></span><span class="mpre">
                        then </span><a href="#loc_50_5_50_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_13&#39;)"><span class="hl_varref"><span class="mpre">checkB64</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.dropWhile</span></span><span class="mpre"> </span><a href="Data.Word8.html#loc_44_1_44_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Word8.html#loc_44_1_44_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><a href="#loc_46_25_46_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_25_46_26&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                        else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    </span><a name="loc_50_5_50_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_13&#39;)"><span class="hl_fundecl"><span class="mpre">checkB64</span></span></a><span class="mpre"> </span><a name="loc_50_14_50_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_14_50_21&#39;)"><span class="hl_vardecl"><span class="mpre">encoded</span></span></a><span class="mpre"> =
        case </span><span class="hl_varref"><span class="mpre">S.uncons</span></span><span class="mpre"> </span><a href="#loc_56_20_56_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_20_56_29&#39;)"><span class="hl_varref"><span class="mpre">password&#39;</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (_, </span><a name="loc_52_22_52_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_22_52_30&#39;)"><span class="hl_vardecl"><span class="mpre">password</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_35_11_35_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_11_35_21&#39;)"><span class="hl_varref"><span class="mpre">checkCreds</span></span></a><span class="mpre"> </span><a href="#loc_56_10_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_10_56_18&#39;)"><span class="hl_varref"><span class="mpre">username</span></span></a><span class="mpre"> </span><a href="#loc_52_22_52_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_22_52_30&#39;)"><span class="hl_varref"><span class="mpre">password</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
      where
        </span><a name="loc_55_9_55_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_9_55_12&#39;)"><span class="hl_vardecl"><span class="mpre">raw</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Base64.html#loc_47_1_47_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Base64.html#loc_47_1_47_14&#39;)"><span class="hl_varref"><span class="mpre">decodeLenient</span></span></a><span class="mpre"> </span><a href="#loc_50_14_50_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_14_50_21&#39;)"><span class="hl_varref"><span class="mpre">encoded</span></span></a><span class="mpre">
        (</span><a name="loc_56_10_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_10_56_18&#39;)"><span class="hl_vardecl"><span class="mpre">username</span></span></a><span class="mpre">, </span><a name="loc_56_20_56_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_20_56_29&#39;)"><span class="hl_vardecl"><span class="mpre">password&#39;</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.breakByte</span></span><span class="mpre"> </span><a href="Data.Word8.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Word8.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">_colon</span></span></a><span class="mpre"> </span><a href="#loc_55_9_55_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_9_55_12&#39;)"><span class="hl_varref"><span class="mpre">raw</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Authentication settings. This value is an instance of @IsString@, so the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- recommended approach to create a value is to provide a string literal (which</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will be the realm) and then overriding individual fields.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; &quot;My Realm&quot; { authIsProtected = someFunc } :: AuthSettings</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 1.3.4</span></span><span class="mpre">
data </span><a name="loc_65_6_65_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_6_65_18&#39;)"><span class="hl_tycondecl"><span class="mpre">AuthSettings</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">AuthSettings</span></span><span class="mpre">
    { </span><a name="loc_66_7_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_7_66_16&#39;)"><span class="hl_fielddecl"><span class="mpre">authRealm</span></span></a><span class="mpre"> :: !</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ^</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Since 1.3.4</span></span><span class="mpre">
    , </span><a name="loc_70_7_70_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_7_70_19&#39;)"><span class="hl_fielddecl"><span class="mpre">authOnNoAuth</span></span></a><span class="mpre"> :: !(</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">)
    </span><span class="hl_comment"><span class="mpre">-- ^ Takes the realm and returns an appropriate 401 response when</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- authentication is not provided.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Since 1.3.4</span></span><span class="mpre">
    , </span><a name="loc_75_7_75_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_7_75_22&#39;)"><span class="hl_fielddecl"><span class="mpre">authIsProtected</span></span></a><span class="mpre"> :: !(</span><a href="Network.Wai.Internal.html#loc_20_6_20_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_20_6_20_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)
    </span><span class="hl_comment"><span class="mpre">-- ^ Determine if access to the requested resource is restricted.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Default: always returns @True@.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Since 1.3.4</span></span><span class="mpre">
    }

instance </span><a href="Data.String.html#loc_34_7_34_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.String.html#loc_34_7_34_15&#39;)"><span class="hl_classref"><span class="mpre">IsString</span></span></a><span class="mpre"> </span><a href="#loc_65_6_65_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_6_65_18&#39;)"><span class="hl_tyconref"><span class="mpre">AuthSettings</span></span></a><span class="mpre"> where
    </span><a href="Data.String.html#loc_35_5_35_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.String.html#loc_35_5_35_15&#39;)"><span class="hl_fundecl"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">s</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Middleware/HttpAuth.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 20, srcSpanEndLine = 97, srcSpanEndColumn = 10}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Middleware/HttpAuth.hs&quot;, srcSpanStartLine = 85, srcSpanStartColumn = 9, srcSpanEndLine = 85, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/N"><span class="mpre">AuthSettings
        { authRealm = fromString s
        , authOnNoAuth = \realm _req f -&gt; f $ responseLBS
            status401
            [ (&quot;Content-Type&quot;, &quot;text/plain&quot;)
            , (&quot;WWW-Authenticate&quot;, S.concat
                [ &quot;Basic realm=\&quot;&quot;
                , realm
                , &quot;\&quot;&quot;
                ])
            ]
            &quot;Basic authentication is required&quot;
        , authIsProtected = const $ return True
        }</span></span><span class="mpre">
</span></div></body></html>