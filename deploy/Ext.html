<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS -fglasgow-exts #-}

module Ext () where

</span><span class="hl_comment"><span class="mpre">-- There were typos in these definitions in the ICFP 2004 paper.</span></span><span class="mpre">

import Data.Generics

</span><span class="hl_fundecl"><span class="mpre">extQ</span></span><span class="mpre"> </span><a name="loc_9_6_9_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_6_9_8&#39;)"><span class="hl_vardecl"><span class="mpre">fn</span></span></a><span class="mpre"> </span><a name="loc_9_9_9_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_9_9_16&#39;)"><span class="hl_vardecl"><span class="mpre">spec_fn</span></span></a><span class="mpre"> </span><a name="loc_9_17_9_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_17_9_20&#39;)"><span class="hl_vardecl"><span class="mpre">arg</span></span></a><span class="mpre">
  = case </span><span class="hl_varref"><span class="mpre">gcast</span></span><span class="mpre"> (</span><a href="#loc_14_17_14_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_17_14_18&#39;)"><span class="hl_conref"><span class="mpre">Q</span></span></a><span class="mpre"> </span><a href="#loc_9_9_9_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_9_9_16&#39;)"><span class="hl_varref"><span class="mpre">spec_fn</span></span></a><span class="mpre">) of
      </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_14_17_14_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_17_14_18&#39;)"><span class="hl_conref"><span class="mpre">Q</span></span></a><span class="mpre"> </span><a name="loc_11_15_11_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_15_11_23&#39;)"><span class="hl_vardecl"><span class="mpre">spec_fn&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_11_15_11_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_15_11_23&#39;)"><span class="hl_varref"><span class="mpre">spec_fn&#39;</span></span></a><span class="mpre"> </span><a href="#loc_9_17_9_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_17_9_20&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre">
      </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">           -&gt; </span><a href="#loc_9_6_9_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_6_9_8&#39;)"><span class="hl_varref"><span class="mpre">fn</span></span></a><span class="mpre">       </span><a href="#loc_9_17_9_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_17_9_20&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre">
                                                                                
newtype </span><span class="hl_tycondecl"><span class="mpre">Q</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_14_17_14_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_17_14_18&#39;)"><span class="hl_condecl"><span class="mpre">Q</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
                                                                                
</span><span class="hl_fundecl"><span class="mpre">extT</span></span><span class="mpre"> </span><a name="loc_16_6_16_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_6_16_8&#39;)"><span class="hl_vardecl"><span class="mpre">fn</span></span></a><span class="mpre"> </span><a name="loc_16_9_16_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_9_16_16&#39;)"><span class="hl_vardecl"><span class="mpre">spec_fn</span></span></a><span class="mpre"> </span><a name="loc_16_17_16_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_17_16_20&#39;)"><span class="hl_vardecl"><span class="mpre">arg</span></span></a><span class="mpre">
  = case </span><span class="hl_varref"><span class="mpre">gcast</span></span><span class="mpre"> (</span><a href="#loc_21_15_21_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_15_21_16&#39;)"><span class="hl_conref"><span class="mpre">T</span></span></a><span class="mpre"> </span><a href="#loc_16_9_16_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_9_16_16&#39;)"><span class="hl_varref"><span class="mpre">spec_fn</span></span></a><span class="mpre">) of
      </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_21_15_21_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_15_21_16&#39;)"><span class="hl_conref"><span class="mpre">T</span></span></a><span class="mpre"> </span><a name="loc_18_15_18_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_15_18_23&#39;)"><span class="hl_vardecl"><span class="mpre">spec_fn&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_18_15_18_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_15_18_23&#39;)"><span class="hl_varref"><span class="mpre">spec_fn&#39;</span></span></a><span class="mpre"> </span><a href="#loc_16_17_16_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_17_16_20&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre">
      </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">           -&gt; </span><a href="#loc_16_6_16_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_6_16_8&#39;)"><span class="hl_varref"><span class="mpre">fn</span></span></a><span class="mpre">       </span><a href="#loc_16_17_16_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_17_16_20&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre">
                                                                                
newtype </span><span class="hl_tycondecl"><span class="mpre">T</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_21_15_21_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_15_21_16&#39;)"><span class="hl_condecl"><span class="mpre">T</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)

</span><a href="#loc_25_1_25_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_5&#39;)"><span class="mpre">extM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Ext.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 9, srcSpanEndLine = 24, srcSpanEndColumn = 8}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Ext.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 9, srcSpanEndLine = 23, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Ext.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 20, srcSpanEnd"><span class="mpre">(Typeable a, Typeable b)
     =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_25_1_25_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_5&#39;)"><span class="hl_fundecl"><span class="mpre">extM</span></span></a><span class="mpre"> </span><a name="loc_25_6_25_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_8&#39;)"><span class="hl_vardecl"><span class="mpre">fn</span></span></a><span class="mpre"> </span><a name="loc_25_9_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_16&#39;)"><span class="hl_vardecl"><span class="mpre">spec_fn</span></span></a><span class="mpre">
  = case </span><span class="hl_varref"><span class="mpre">gcast</span></span><span class="mpre"> (</span><a href="#loc_30_17_30_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_17_30_18&#39;)"><span class="hl_conref"><span class="mpre">M</span></span></a><span class="mpre"> </span><a href="#loc_25_9_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_16&#39;)"><span class="hl_varref"><span class="mpre">spec_fn</span></span></a><span class="mpre">) of
      </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_30_17_30_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_17_30_18&#39;)"><span class="hl_conref"><span class="mpre">M</span></span></a><span class="mpre"> </span><a name="loc_27_15_27_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_15_27_23&#39;)"><span class="hl_vardecl"><span class="mpre">spec_fn&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_27_15_27_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_15_27_23&#39;)"><span class="hl_varref"><span class="mpre">spec_fn&#39;</span></span></a><span class="mpre">
      </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">           -&gt; </span><a href="#loc_25_6_25_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_8&#39;)"><span class="hl_varref"><span class="mpre">fn</span></span></a><span class="mpre">

newtype </span><span class="hl_tycondecl"><span class="mpre">M</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_30_17_30_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_17_30_18&#39;)"><span class="hl_condecl"><span class="mpre">M</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span></div></body></html>