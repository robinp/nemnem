<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
#if __GLASGOW_HASKELL__ &gt;= 701
{-# LANGUAGE Trustworthy #-}
#endif
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Codec.Binary.UTF8.String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) Eric Mertens 2007</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD3-style (see LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer:    emertens@galois.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Support for encoding UTF8 Strings to and from @[Word8]@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

module Codec.Binary.UTF8.String (
      encode
    , decode
    , encodeString
    , decodeString
    , encodeChar
    
    , isUTF8Encoded
    , utf8Encode
  ) where

import Data.Word        (Word8,Word32)
import Data.Bits        ((.|.),(.&amp;.),shiftL,shiftR)
import Data.Char        (chr,ord)

</span><span class="warning" data-warning="DeclDefaultDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/utf8-string-0.3.8/Codec/Binary/UTF8/String.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 1, srcSpanEndLine = 33, srcSpanEndColumn = 13}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/utf8-string-0.3.8/Codec/Binary/UTF8/String.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 1, srcSpanEndLine = 33, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/utf8-string-0.3.8/Codec/Binary/UT"><span class="mpre">default(Int)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encode a string using &#39;encode&#39; and store the result in a &#39;String&#39;.</span></span><span class="mpre">
</span><a href="#loc_37_1_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_13&#39;)"><span class="mpre">encodeString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_37_1_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_13&#39;)"><span class="hl_fundecl"><span class="mpre">encodeString</span></span></a><span class="mpre"> </span><a name="loc_37_14_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_14_37_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre">) (</span><a href="#loc_72_1_72_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_7&#39;)"><span class="hl_varref"><span class="mpre">encode</span></span></a><span class="mpre"> </span><a href="#loc_37_14_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_14_37_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Decode a string using &#39;decode&#39; using a &#39;String&#39; as input.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | This is not safe but it is necessary if UTF-8 encoded text</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | has been loaded into a &#39;String&#39; prior to being decoded.</span></span><span class="mpre">
</span><a href="#loc_43_1_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_13&#39;)"><span class="mpre">decodeString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_43_1_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_13&#39;)"><span class="hl_fundecl"><span class="mpre">decodeString</span></span></a><span class="mpre"> </span><a name="loc_43_14_43_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_14_43_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre">) </span><a href="#loc_43_14_43_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_14_43_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

</span><a href="#loc_46_1_46_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_22&#39;)"><span class="mpre">replacement_character</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_46_1_46_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_22&#39;)"><span class="hl_vardecl"><span class="mpre">replacement_character</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;\xfffd&#39;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encode a single Haskell Char to a list of Word8 values, in UTF8 format.</span></span><span class="mpre">
</span><a href="#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_11&#39;)"><span class="mpre">encodeChar</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_50_1_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_11&#39;)"><span class="hl_vardecl"><span class="mpre">encodeChar</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_52_3_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_3_52_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre">
 where
  </span><a name="loc_52_3_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_3_52_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_52_6_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_8&#39;)"><span class="hl_vardecl"><span class="mpre">oc</span></span></a><span class="mpre">
   | </span><a href="#loc_52_6_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7f</span></span><span class="mpre">       = [</span><a href="#loc_52_6_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre">]

   | </span><a href="#loc_52_6_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7ff</span></span><span class="mpre">      = [ </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_52_6_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shiftR`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_52_6_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">
                        ]

   | </span><a href="#loc_52_6_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xffff</span></span><span class="mpre">     = [ </span><span class="hl_num"><span class="mpre">0xe0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_52_6_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shiftR`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> ((</span><a href="#loc_52_6_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shiftR`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_52_6_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">
                        ]
   | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">        = [ </span><span class="hl_num"><span class="mpre">0xf0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_52_6_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shiftR`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> ((</span><a href="#loc_52_6_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shiftR`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> ((</span><a href="#loc_52_6_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shiftR`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
                        , </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_52_6_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_8&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">
                        ]


</span><span class="hl_comment"><span class="mpre">-- | Encode a Haskell String to a list of Word8 values, in UTF8 format.</span></span><span class="mpre">
</span><a href="#loc_72_1_72_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_7&#39;)"><span class="mpre">encode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_72_1_72_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_7&#39;)"><span class="hl_vardecl"><span class="mpre">encode</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">encodeChar</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Decode a UTF8 string packed into a list of Word8 values, directly to String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="mpre">decode</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_fundecl"><span class="mpre">decode</span></span></a><span class="mpre"> [    ] = </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
</span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_fundecl"><span class="mpre">decode</span></span></a><span class="mpre"> (</span><a name="loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)
  | </span><a href="#loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">chr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  | </span><a href="#loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre">  = </span><a href="#loc_46_1_46_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_22&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  | </span><a href="#loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xe0</span></span><span class="mpre">  = </span><a href="#loc_89_5_89_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_11&#39;)"><span class="hl_varref"><span class="mpre">multi1</span></span></a><span class="mpre">
  | </span><a href="#loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf0</span></span><span class="mpre">  = </span><a href="#loc_97_5_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_15&#39;)"><span class="hl_varref"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf</span></span><span class="mpre">  </span><span class="hl_num"><span class="mpre">0x800</span></span><span class="mpre">
  | </span><a href="#loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf8</span></span><span class="mpre">  = </span><a href="#loc_97_5_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_15&#39;)"><span class="hl_varref"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7</span></span><span class="mpre">  </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre">
  | </span><a href="#loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xfc</span></span><span class="mpre">  = </span><a href="#loc_97_5_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_15&#39;)"><span class="hl_varref"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3</span></span><span class="mpre">  </span><span class="hl_num"><span class="mpre">0x200000</span></span><span class="mpre">
  | </span><a href="#loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xfe</span></span><span class="mpre">  = </span><a href="#loc_97_5_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_15&#39;)"><span class="hl_varref"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x1</span></span><span class="mpre">  </span><span class="hl_num"><span class="mpre">0x4000000</span></span><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_46_1_46_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_22&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  where
    </span><a name="loc_89_5_89_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_11&#39;)"><span class="hl_vardecl"><span class="mpre">multi1</span></span></a><span class="mpre"> = case </span><a href="#loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
      </span><a name="loc_90_7_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_9&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_90_12_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_12_90_14&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre"> | </span><a href="#loc_90_7_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_9&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> -&gt;
        let </span><a name="loc_91_13_91_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_13_91_14&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = ((</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x1f</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`shiftL`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre">  </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> (</span><a href="#loc_90_7_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_9&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)
        in if </span><a href="#loc_91_13_91_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_13_91_14&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x000080</span></span><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_91_13_91_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_13_91_14&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_90_12_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_12_90_14&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
                            else </span><a href="#loc_46_1_46_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_22&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_90_12_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_12_90_14&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
      _ -&gt; </span><a href="#loc_46_1_46_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_22&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

    </span><a href="#loc_97_5_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_15&#39;)"><span class="mpre">multi_byte</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]
    </span><a name="loc_97_5_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_15&#39;)"><span class="hl_fundecl"><span class="mpre">multi_byte</span></span></a><span class="mpre"> </span><a name="loc_97_16_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_16_97_17&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_97_18_97_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_18_97_22&#39;)"><span class="hl_vardecl"><span class="mpre">mask</span></span></a><span class="mpre"> </span><a name="loc_97_23_97_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_23_97_31&#39;)"><span class="hl_vardecl"><span class="mpre">overlong</span></span></a><span class="mpre"> = </span><a href="#loc_99_9_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_12&#39;)"><span class="hl_varref"><span class="mpre">aux</span></span></a><span class="mpre"> </span><a href="#loc_97_16_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_16_97_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_79_11_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> (</span><a href="#loc_79_9_79_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_9_79_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><a href="#loc_97_18_97_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_18_97_22&#39;)"><span class="hl_varref"><span class="mpre">mask</span></span></a><span class="mpre">))
      where
        </span><a name="loc_99_9_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_12&#39;)"><span class="hl_fundecl"><span class="mpre">aux</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_99_15_99_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_17&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> </span><a name="loc_99_18_99_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_18_99_21&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre">
          | </span><a href="#loc_97_23_97_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_23_97_31&#39;)"><span class="hl_varref"><span class="mpre">overlong</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_99_18_99_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_18_99_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_99_18_99_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_18_99_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10ffff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
            (</span><a href="#loc_99_18_99_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_18_99_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xd800</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xdfff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_99_18_99_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_18_99_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)     </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
            (</span><a href="#loc_99_18_99_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_18_99_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xfffe</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xffff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_99_18_99_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_18_99_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)      = </span><span class="hl_varref"><span class="mpre">chr</span></span><span class="mpre"> </span><a href="#loc_99_18_99_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_18_99_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_99_15_99_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_46_1_46_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_22&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_99_15_99_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">

        </span><a href="#loc_99_9_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_12&#39;)"><span class="hl_fundecl"><span class="mpre">aux</span></span></a><span class="mpre"> </span><a name="loc_105_13_105_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_13_105_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a name="loc_105_16_105_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_16_105_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_105_18_105_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_18_105_20&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">) </span><a name="loc_105_22_105_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_22_105_25&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre">
          | </span><a href="#loc_105_16_105_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_16_105_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> = </span><a href="#loc_99_9_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_12&#39;)"><span class="hl_varref"><span class="mpre">aux</span></span></a><span class="mpre"> (</span><a href="#loc_105_13_105_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_13_105_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_105_18_105_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_18_105_20&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
                               </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">shiftL</span></span><span class="mpre"> </span><a href="#loc_105_22_105_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_22_105_25&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> (</span><a href="#loc_105_16_105_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_16_105_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)

        </span><a href="#loc_99_9_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_12&#39;)"><span class="hl_fundecl"><span class="mpre">aux</span></span></a><span class="mpre"> _ </span><a name="loc_109_15_109_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_15_109_17&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">     _ = </span><a href="#loc_46_1_46_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_22&#39;)"><span class="hl_varref"><span class="mpre">replacement_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_78_1_78_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_109_15_109_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_15_109_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @utf8Encode str@ is a convenience function; checks to see if</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @str@ isn&#39;t UTF-8 encoded before doing so. Sometimes useful, but</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- you are better off keeping track of the encoding so as to avoid</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the cost of checking.</span></span><span class="mpre">
</span><a href="#loc_117_1_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_11&#39;)"><span class="mpre">utf8Encode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_117_1_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_11&#39;)"><span class="hl_fundecl"><span class="mpre">utf8Encode</span></span></a><span class="mpre"> </span><a name="loc_117_12_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_12_117_15&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">
 | </span><a href="#loc_124_1_124_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_14&#39;)"><span class="hl_varref"><span class="mpre">isUTF8Encoded</span></span></a><span class="mpre"> </span><a href="#loc_117_12_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_12_117_15&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> = </span><a href="#loc_117_12_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_12_117_15&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
 | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         = </span><a href="#loc_37_1_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_13&#39;)"><span class="hl_varref"><span class="mpre">encodeString</span></span></a><span class="mpre"> </span><a href="#loc_117_12_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_12_117_15&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @isUTF8Encoded str@ tries to recognize input string as being in UTF-8 form.</span></span><span class="mpre">
</span><a href="#loc_124_1_124_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_14&#39;)"><span class="mpre">isUTF8Encoded</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_124_1_124_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_14&#39;)"><span class="hl_fundecl"><span class="mpre">isUTF8Encoded</span></span></a><span class="mpre"> [] = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_124_1_124_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_14&#39;)"><span class="hl_fundecl"><span class="mpre">isUTF8Encoded</span></span></a><span class="mpre"> (</span><a name="loc_125_16_125_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_16_125_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_125_18_125_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_18_125_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = 
  case </span><a href="#loc_137_4_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_4_137_6&#39;)"><span class="hl_varref"><span class="mpre">ox</span></span></a><span class="mpre"> of
    _ | </span><a href="#loc_137_4_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_4_137_6&#39;)"><span class="hl_varref"><span class="mpre">ox</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">  -&gt; </span><a href="#loc_124_1_124_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_14&#39;)"><span class="hl_varref"><span class="mpre">isUTF8Encoded</span></span></a><span class="mpre"> </span><a href="#loc_125_18_125_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_18_125_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
      | </span><a href="#loc_137_4_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_4_137_6&#39;)"><span class="hl_varref"><span class="mpre">ox</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre">  -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
      | </span><a href="#loc_137_4_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_4_137_6&#39;)"><span class="hl_varref"><span class="mpre">ox</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre">  -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
      | </span><a href="#loc_137_4_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_4_137_6&#39;)"><span class="hl_varref"><span class="mpre">ox</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xe0</span></span><span class="mpre">  -&gt; </span><a href="#loc_142_4_142_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_4_142_10&#39;)"><span class="hl_varref"><span class="mpre">check1</span></span></a><span class="mpre">
      | </span><a href="#loc_137_4_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_4_137_6&#39;)"><span class="hl_varref"><span class="mpre">ox</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf0</span></span><span class="mpre">  -&gt; </span><a href="#loc_153_4_153_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_4_153_14&#39;)"><span class="hl_varref"><span class="mpre">check_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
      | </span><a href="#loc_137_4_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_4_137_6&#39;)"><span class="hl_varref"><span class="mpre">ox</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf8</span></span><span class="mpre">  -&gt; </span><a href="#loc_153_4_153_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_4_153_14&#39;)"><span class="hl_varref"><span class="mpre">check_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7</span></span><span class="mpre">  </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre">
      | </span><a href="#loc_137_4_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_4_137_6&#39;)"><span class="hl_varref"><span class="mpre">ox</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xfc</span></span><span class="mpre">  -&gt; </span><a href="#loc_153_4_153_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_4_153_14&#39;)"><span class="hl_varref"><span class="mpre">check_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3</span></span><span class="mpre">  </span><span class="hl_num"><span class="mpre">0x200000</span></span><span class="mpre">
      | </span><a href="#loc_137_4_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_4_137_6&#39;)"><span class="hl_varref"><span class="mpre">ox</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xfe</span></span><span class="mpre">  -&gt; </span><a href="#loc_153_4_153_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_4_153_14&#39;)"><span class="hl_varref"><span class="mpre">check_byte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x1</span></span><span class="mpre">  </span><span class="hl_num"><span class="mpre">0x4000000</span></span><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
 where
   </span><a name="loc_137_4_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_4_137_6&#39;)"><span class="hl_vardecl"><span class="mpre">ox</span></span></a><span class="mpre"> = </span><a href="#loc_140_4_140_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_4_140_9&#39;)"><span class="hl_varref"><span class="mpre">toW32</span></span></a><span class="mpre"> </span><a href="#loc_125_16_125_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_16_125_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
   
   </span><a href="#loc_140_4_140_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_4_140_9&#39;)"><span class="mpre">toW32</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">
   </span><a name="loc_140_4_140_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_4_140_9&#39;)"><span class="hl_fundecl"><span class="mpre">toW32</span></span></a><span class="mpre"> </span><a name="loc_140_10_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_10_140_12&#39;)"><span class="hl_vardecl"><span class="mpre">ch</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_140_10_140_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_10_140_12&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre">)

   </span><a name="loc_142_4_142_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_4_142_10&#39;)"><span class="hl_vardecl"><span class="mpre">check1</span></span></a><span class="mpre"> = 
    case </span><a href="#loc_125_18_125_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_18_125_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
     [] -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
     </span><a name="loc_145_6_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_8&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_145_11_145_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_13&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre"> 
      | </span><a href="#loc_149_8_149_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_8_149_10&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_150_8_150_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_8_150_9&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x000080</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="#loc_124_1_124_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_14&#39;)"><span class="hl_varref"><span class="mpre">isUTF8Encoded</span></span></a><span class="mpre"> </span><a href="#loc_145_11_145_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_13&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
      where
       </span><a name="loc_149_8_149_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_8_149_10&#39;)"><span class="hl_vardecl"><span class="mpre">oc</span></span></a><span class="mpre"> = </span><a href="#loc_140_4_140_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_4_140_9&#39;)"><span class="hl_varref"><span class="mpre">toW32</span></span></a><span class="mpre"> </span><a href="#loc_145_6_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_8&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre">
       </span><a name="loc_150_8_150_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_8_150_9&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = ((</span><a href="#loc_137_4_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_4_137_6&#39;)"><span class="hl_varref"><span class="mpre">ox</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x1f</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`shiftL`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre">  (</span><a href="#loc_149_8_149_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_8_149_10&#39;)"><span class="hl_varref"><span class="mpre">oc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)

   </span><a href="#loc_153_4_153_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_4_153_14&#39;)"><span class="mpre">check_byte</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
   </span><a name="loc_153_4_153_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_4_153_14&#39;)"><span class="hl_fundecl"><span class="mpre">check_byte</span></span></a><span class="mpre"> </span><a name="loc_153_15_153_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_15_153_16&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_153_17_153_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_21&#39;)"><span class="hl_vardecl"><span class="mpre">mask</span></span></a><span class="mpre"> </span><a name="loc_153_22_153_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_22_153_30&#39;)"><span class="hl_vardecl"><span class="mpre">overlong</span></span></a><span class="mpre"> = </span><a href="#loc_155_9_155_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_9_155_12&#39;)"><span class="hl_varref"><span class="mpre">aux</span></span></a><span class="mpre"> </span><a href="#loc_153_15_153_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_15_153_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_125_18_125_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_18_125_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> (</span><a href="#loc_137_4_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_4_137_6&#39;)"><span class="hl_varref"><span class="mpre">ox</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><a href="#loc_153_17_153_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_21&#39;)"><span class="hl_varref"><span class="mpre">mask</span></span></a><span class="mpre">)
      where
        </span><a name="loc_155_9_155_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_9_155_12&#39;)"><span class="hl_fundecl"><span class="mpre">aux</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_155_15_155_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_15_155_17&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> </span><a name="loc_155_18_155_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_18_155_21&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre">
         | </span><a href="#loc_153_22_153_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_22_153_30&#39;)"><span class="hl_varref"><span class="mpre">overlong</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_155_18_155_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_18_155_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> 
           </span><a href="#loc_155_18_155_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_18_155_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10ffff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
           (</span><a href="#loc_155_18_155_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_18_155_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xd800</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xdfff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_155_18_155_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_18_155_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
           (</span><a href="#loc_155_18_155_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_18_155_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xfffe</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xffff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_155_18_155_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_18_155_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">) = </span><a href="#loc_124_1_124_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_14&#39;)"><span class="hl_varref"><span class="mpre">isUTF8Encoded</span></span></a><span class="mpre"> </span><a href="#loc_155_15_155_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_15_155_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
         | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

        </span><a href="#loc_155_9_155_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_9_155_12&#39;)"><span class="hl_fundecl"><span class="mpre">aux</span></span></a><span class="mpre"> </span><a name="loc_162_13_162_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_13_162_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a name="loc_162_16_162_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_16_162_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_162_18_162_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_18_162_20&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">) </span><a name="loc_162_22_162_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_22_162_25&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre">
         | </span><a href="#loc_140_4_140_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_4_140_9&#39;)"><span class="hl_varref"><span class="mpre">toW32</span></span></a><span class="mpre"> </span><a href="#loc_162_16_162_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_16_162_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> = 
            </span><a href="#loc_155_9_155_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_9_155_12&#39;)"><span class="hl_varref"><span class="mpre">aux</span></span></a><span class="mpre"> (</span><a href="#loc_162_13_162_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_13_162_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_162_18_162_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_18_162_20&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">  (</span><a href="#loc_162_22_162_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_22_162_25&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shiftL`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> (</span><a href="#loc_140_4_140_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_4_140_9&#39;)"><span class="hl_varref"><span class="mpre">toW32</span></span></a><span class="mpre"> </span><a href="#loc_162_16_162_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_16_162_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">))

        </span><a href="#loc_155_9_155_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_9_155_12&#39;)"><span class="hl_fundecl"><span class="mpre">aux</span></span></a><span class="mpre"> _ _  _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span></div></body></html>