<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE Trustworthy #-}
{-# LANGUAGE CPP #-}
{-# LANGUAGE DeriveDataTypeable, StandaloneDeriving #-}

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Control.Concurrent.Chan</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The University of Glasgow 2001</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (concurrency)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Unbounded channels.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Control.Concurrent.Chan
  ( 
          </span><span class="hl_comment"><span class="mpre">-- * The &#39;Chan&#39; type</span></span><span class="mpre">
        Chan,                   </span><span class="hl_comment"><span class="mpre">-- abstract</span></span><span class="mpre">

          </span><span class="hl_comment"><span class="mpre">-- * Operations</span></span><span class="mpre">
        newChan,
        writeChan,
        readChan,
        dupChan,
        unGetChan,
        isEmptyChan,

          </span><span class="hl_comment"><span class="mpre">-- * Stream interface</span></span><span class="mpre">
        getChanContents,
        writeList2Chan,
   ) where

import Prelude

import System.IO.Unsafe         ( </span><a href="GHC.IO.html#loc_213_1_213_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_213_1_213_19&#39;)"><span class="mpre">unsafeInterleaveIO</span></a><span class="mpre"> )
import Control.Concurrent.MVar
import Control.Exception (</span><a href="GHC.IO.html#loc_426_1_426_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_426_1_426_6&#39;)"><span class="mpre">mask_</span></a><span class="mpre">)
import Data.Typeable

#define _UPK_(x) {-# UNPACK #-} !(x)

</span><span class="hl_comment"><span class="mpre">-- A channel is represented by two @MVar@s keeping track of the two ends</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of the channel contents,i.e.,  the read- and write ends. Empty @MVar@s</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- are used to handle consumers trying to read from an empty channel.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |&#39;Chan&#39; is an abstract type representing an unbounded FIFO channel.</span></span><span class="mpre">
data </span><a name="loc_51_6_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_10&#39;)"><span class="hl_tycondecl"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
 = </span><a name="loc_52_4_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_4_52_8&#39;)"><span class="hl_condecl"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">_UPK_</span></span><span class="mpre">(</span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="hl_tyconref"><span class="mpre">MVar</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Stream</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))
        </span><span class="hl_tyvar"><span class="mpre">_UPK_</span></span><span class="mpre">(</span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="hl_tyconref"><span class="mpre">MVar</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Stream</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)) </span><span class="hl_comment"><span class="mpre">-- Invariant: the Stream a is always an empty MVar</span></span><span class="mpre">
   </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Control/Concurrent/Chan.hs&quot;, srcSpanStartLine = 54, srcSpanStartColumn = 4, srcSpanEndLine = 54, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Control/Concurrent/Chan.hs&quot;, srcSpanStartLine = 54, srcSpanStartColumn = 4, srcSpanEndLine = 54, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Control/Concurrent/Chan.hs&quot;, srcSp"><span class="mpre">deriving (Eq,Typeable)</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Control/Concurrent/Chan.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 1, srcSpanEndLine = 56, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Control/Concurrent/Chan.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 1, srcSpanEndLine = 56, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Control/Concurrent/Chan.hs&quot;, srcSpa"><span class="mpre">type Stream a = MVar (ChItem a)</span></span><span class="mpre">

data </span><span class="hl_tycondecl"><span class="mpre">ChItem</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_58_17_58_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_17_58_23&#39;)"><span class="hl_condecl"><span class="mpre">ChItem</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">_UPK_</span></span><span class="mpre">(</span><span class="hl_tyconref"><span class="mpre">Stream</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
  </span><span class="hl_comment"><span class="mpre">-- benchmarks show that unboxing the MVar here is worthwhile, because</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- although it leads to higher allocation, the channel data takes up</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- less space and is therefore quicker to GC.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- See the Concurrent Haskell paper for a diagram explaining the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- how the different channel operations proceed.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- @newChan@ sets up the read and write end of a channel by initialising</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- these two @MVar@s with an empty @MVar@.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Build and returns a new instance of &#39;Chan&#39;.</span></span><span class="mpre">
</span><a href="#loc_71_1_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_8&#39;)"><span class="mpre">newChan</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_51_6_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_10&#39;)"><span class="hl_tyconref"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_71_1_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_8&#39;)"><span class="hl_vardecl"><span class="mpre">newChan</span></span></a><span class="mpre"> = do
   </span><a name="loc_72_4_72_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_4_72_8&#39;)"><span class="hl_vardecl"><span class="mpre">hole</span></span></a><span class="mpre">  &lt;- </span><a href="GHC.MVar.html#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_64_1_64_13&#39;)"><span class="hl_varref"><span class="mpre">newEmptyMVar</span></span></a><span class="mpre">
   </span><a name="loc_73_4_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_4_73_11&#39;)"><span class="hl_vardecl"><span class="mpre">readVar</span></span></a><span class="mpre">  &lt;- </span><a href="GHC.MVar.html#loc_70_1_70_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_70_1_70_8&#39;)"><span class="hl_varref"><span class="mpre">newMVar</span></span></a><span class="mpre"> </span><a href="#loc_72_4_72_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_4_72_8&#39;)"><span class="hl_varref"><span class="mpre">hole</span></span></a><span class="mpre">
   </span><a name="loc_74_4_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_4_74_12&#39;)"><span class="hl_vardecl"><span class="mpre">writeVar</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_70_1_70_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_70_1_70_8&#39;)"><span class="hl_varref"><span class="mpre">newMVar</span></span></a><span class="mpre"> </span><a href="#loc_72_4_72_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_4_72_8&#39;)"><span class="hl_varref"><span class="mpre">hole</span></span></a><span class="mpre">
   </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_52_4_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_4_52_8&#39;)"><span class="hl_conref"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><a href="#loc_73_4_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_4_73_11&#39;)"><span class="hl_varref"><span class="mpre">readVar</span></span></a><span class="mpre"> </span><a href="#loc_74_4_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_4_74_12&#39;)"><span class="hl_varref"><span class="mpre">writeVar</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- To put an element on a channel, a new hole at the write end is created.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- What was previously the empty @MVar@ at the back of the channel is then</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- filled in with a new stream element holding the entered value and the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- new hole.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Write a value to a &#39;Chan&#39;.</span></span><span class="mpre">
</span><a href="#loc_84_1_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_10&#39;)"><span class="mpre">writeChan</span></a><span class="mpre"> :: </span><a href="#loc_51_6_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_10&#39;)"><span class="hl_tyconref"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_84_1_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_10&#39;)"><span class="hl_fundecl"><span class="mpre">writeChan</span></span></a><span class="mpre"> (</span><a href="#loc_52_4_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_4_52_8&#39;)"><span class="hl_conref"><span class="mpre">Chan</span></span></a><span class="mpre"> _ </span><a name="loc_84_19_84_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_19_84_27&#39;)"><span class="hl_vardecl"><span class="mpre">writeVar</span></span></a><span class="mpre">) </span><a name="loc_84_29_84_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_29_84_32&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre"> = do
  </span><a name="loc_85_3_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_3_85_11&#39;)"><span class="hl_vardecl"><span class="mpre">new_hole</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_64_1_64_13&#39;)"><span class="hl_varref"><span class="mpre">newEmptyMVar</span></span></a><span class="mpre">
  </span><a href="GHC.IO.html#loc_426_1_426_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_426_1_426_6&#39;)"><span class="hl_varref"><span class="mpre">mask_</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_87_5_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_13&#39;)"><span class="hl_vardecl"><span class="mpre">old_hole</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">takeMVar</span></span></a><span class="mpre"> </span><a href="#loc_84_19_84_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_19_84_27&#39;)"><span class="hl_varref"><span class="mpre">writeVar</span></span></a><span class="mpre">
    </span><a href="GHC.MVar.html#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_133_1_133_8&#39;)"><span class="hl_varref"><span class="mpre">putMVar</span></span></a><span class="mpre"> </span><a href="#loc_87_5_87_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_13&#39;)"><span class="hl_varref"><span class="mpre">old_hole</span></span></a><span class="mpre"> (</span><a href="#loc_58_17_58_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_17_58_23&#39;)"><span class="hl_conref"><span class="mpre">ChItem</span></span></a><span class="mpre"> </span><a href="#loc_84_29_84_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_29_84_32&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre"> </span><a href="#loc_85_3_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_3_85_11&#39;)"><span class="hl_varref"><span class="mpre">new_hole</span></span></a><span class="mpre">)
    </span><a href="GHC.MVar.html#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_133_1_133_8&#39;)"><span class="hl_varref"><span class="mpre">putMVar</span></span></a><span class="mpre"> </span><a href="#loc_84_19_84_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_19_84_27&#39;)"><span class="hl_varref"><span class="mpre">writeVar</span></span></a><span class="mpre"> </span><a href="#loc_85_3_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_3_85_11&#39;)"><span class="hl_varref"><span class="mpre">new_hole</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- The reason we don&#39;t simply do this:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    modifyMVar_ writeVar $ \old_hole -&gt; do</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      putMVar old_hole (ChItem val new_hole)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      return new_hole</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is because if an asynchronous exception is received after the &#39;putMVar&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- completes and before modifyMVar_ installs the new value, it will set the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Chan&#39;s write end to a filled hole.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Read the next value from the &#39;Chan&#39;.</span></span><span class="mpre">
</span><a href="#loc_103_1_103_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_9&#39;)"><span class="mpre">readChan</span></a><span class="mpre"> :: </span><a href="#loc_51_6_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_10&#39;)"><span class="hl_tyconref"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_103_1_103_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_9&#39;)"><span class="hl_fundecl"><span class="mpre">readChan</span></span></a><span class="mpre"> (</span><a href="#loc_52_4_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_4_52_8&#39;)"><span class="hl_conref"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><a name="loc_103_16_103_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_16_103_23&#39;)"><span class="hl_vardecl"><span class="mpre">readVar</span></span></a><span class="mpre"> _) = do
  </span><a href="Control.Concurrent.MVar.html#loc_257_1_257_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Concurrent.MVar.html#loc_257_1_257_17&#39;)"><span class="hl_varref"><span class="mpre">modifyMVarMasked</span></span></a><span class="mpre"> </span><a href="#loc_103_16_103_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_16_103_23&#39;)"><span class="hl_varref"><span class="mpre">readVar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_104_31_104_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_31_104_39&#39;)"><span class="hl_vardecl"><span class="mpre">read_end</span></span></a><span class="mpre"> -&gt; do </span><span class="hl_comment"><span class="mpre">-- Note [modifyMVarMasked]</span></span><span class="mpre">
    (</span><a href="#loc_58_17_58_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_17_58_23&#39;)"><span class="hl_conref"><span class="mpre">ChItem</span></span></a><span class="mpre"> </span><a name="loc_105_13_105_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_13_105_16&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre"> </span><a name="loc_105_17_105_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_29&#39;)"><span class="hl_vardecl"><span class="mpre">new_read_end</span></span></a><span class="mpre">) &lt;- </span><a href="GHC.MVar.html#loc_116_1_116_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_116_1_116_9&#39;)"><span class="hl_varref"><span class="mpre">readMVar</span></span></a><span class="mpre"> </span><a href="#loc_104_31_104_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_31_104_39&#39;)"><span class="hl_varref"><span class="mpre">read_end</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- Use readMVar here, not takeMVar,</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- else dupChan doesn&#39;t work</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_105_17_105_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_29&#39;)"><span class="hl_varref"><span class="mpre">new_read_end</span></span></a><span class="mpre">, </span><a href="#loc_105_13_105_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_13_105_16&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Note [modifyMVarMasked]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This prevents a theoretical deadlock if an asynchronous exception</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- happens during the readMVar while the MVar is empty.  In that case</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the read_end MVar will be left empty, and subsequent readers will</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- deadlock.  Using modifyMVarMasked prevents this.  The deadlock can</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- be reproduced, but only by expanding readMVar and inserting an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- artificial yield between its takeMVar and putMVar operations.</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- |Duplicate a &#39;Chan&#39;: the duplicate channel begins empty, but data written to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- either channel from then on will be available from both.  Hence this creates</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a kind of broadcast channel, where data written by anyone is seen by</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- everyone else.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (Note that a duplicated channel is not equal to its original.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- So: @fmap (c /=) $ dupChan c@ returns @True@ for all @c@.)</span></span><span class="mpre">
</span><a href="#loc_127_1_127_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_8&#39;)"><span class="mpre">dupChan</span></a><span class="mpre"> :: </span><a href="#loc_51_6_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_10&#39;)"><span class="hl_tyconref"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_51_6_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_10&#39;)"><span class="hl_tyconref"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_127_1_127_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_8&#39;)"><span class="hl_fundecl"><span class="mpre">dupChan</span></span></a><span class="mpre"> (</span><a href="#loc_52_4_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_4_52_8&#39;)"><span class="hl_conref"><span class="mpre">Chan</span></span></a><span class="mpre"> _ </span><a name="loc_127_17_127_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_17_127_25&#39;)"><span class="hl_vardecl"><span class="mpre">writeVar</span></span></a><span class="mpre">) = do
   </span><a name="loc_128_4_128_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_4_128_8&#39;)"><span class="hl_vardecl"><span class="mpre">hole</span></span></a><span class="mpre">       &lt;- </span><a href="GHC.MVar.html#loc_116_1_116_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_116_1_116_9&#39;)"><span class="hl_varref"><span class="mpre">readMVar</span></span></a><span class="mpre"> </span><a href="#loc_127_17_127_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_17_127_25&#39;)"><span class="hl_varref"><span class="mpre">writeVar</span></span></a><span class="mpre">
   </span><a name="loc_129_4_129_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_4_129_14&#39;)"><span class="hl_vardecl"><span class="mpre">newReadVar</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_70_1_70_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_70_1_70_8&#39;)"><span class="hl_varref"><span class="mpre">newMVar</span></span></a><span class="mpre"> </span><a href="#loc_128_4_128_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_4_128_8&#39;)"><span class="hl_varref"><span class="mpre">hole</span></span></a><span class="mpre">
   </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_52_4_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_4_52_8&#39;)"><span class="hl_conref"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><a href="#loc_129_4_129_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_4_129_14&#39;)"><span class="hl_varref"><span class="mpre">newReadVar</span></span></a><span class="mpre"> </span><a href="#loc_127_17_127_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_17_127_25&#39;)"><span class="hl_varref"><span class="mpre">writeVar</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |Put a data item back onto a channel, where it will be the next item read.</span></span><span class="mpre">
</span><a href="#loc_134_1_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_10&#39;)"><span class="mpre">unGetChan</span></a><span class="mpre"> :: </span><a href="#loc_51_6_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_10&#39;)"><span class="hl_tyconref"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_134_1_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_10&#39;)"><span class="hl_fundecl"><span class="mpre">unGetChan</span></span></a><span class="mpre"> (</span><a href="#loc_52_4_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_4_52_8&#39;)"><span class="hl_conref"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><a name="loc_134_17_134_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_17_134_24&#39;)"><span class="hl_vardecl"><span class="mpre">readVar</span></span></a><span class="mpre"> _) </span><a name="loc_134_28_134_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_28_134_31&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre"> = do
   </span><a name="loc_135_4_135_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_4_135_16&#39;)"><span class="hl_vardecl"><span class="mpre">new_read_end</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_64_1_64_13&#39;)"><span class="hl_varref"><span class="mpre">newEmptyMVar</span></span></a><span class="mpre">
   </span><a href="Control.Concurrent.MVar.html#loc_216_1_216_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Concurrent.MVar.html#loc_216_1_216_12&#39;)"><span class="hl_varref"><span class="mpre">modifyMVar_</span></span></a><span class="mpre"> </span><a href="#loc_134_17_134_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_17_134_24&#39;)"><span class="hl_varref"><span class="mpre">readVar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_136_27_136_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_27_136_35&#39;)"><span class="hl_vardecl"><span class="mpre">read_end</span></span></a><span class="mpre"> -&gt; do
     </span><a href="GHC.MVar.html#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_133_1_133_8&#39;)"><span class="hl_varref"><span class="mpre">putMVar</span></span></a><span class="mpre"> </span><a href="#loc_135_4_135_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_4_135_16&#39;)"><span class="hl_varref"><span class="mpre">new_read_end</span></span></a><span class="mpre"> (</span><a href="#loc_58_17_58_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_17_58_23&#39;)"><span class="hl_conref"><span class="mpre">ChItem</span></span></a><span class="mpre"> </span><a href="#loc_134_28_134_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_28_134_31&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre"> </span><a href="#loc_136_27_136_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_27_136_35&#39;)"><span class="hl_varref"><span class="mpre">read_end</span></span></a><span class="mpre">)
     </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_135_4_135_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_4_135_16&#39;)"><span class="hl_varref"><span class="mpre">new_read_end</span></span></a><span class="mpre">
</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Control/Concurrent/Chan.hs&quot;, srcSpanStartLine = 139, srcSpanStartColumn = 1, srcSpanEndLine = 139, srcSpanEndColumn = 164}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Control/Concurrent/Chan.hs&quot;, srcSpanStartLine = 139, srcSpanStartColumn = 1, srcSpanEndLine = 139, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Control/Concurrent/Chan"><span class="mpre">{-# DEPRECATED unGetChan &quot;if you need this operation, use Control.Concurrent.STM.TChan instead.  See &lt;http://ghc.haskell.org/trac/ghc/ticket/4154&gt; for details&quot; #-}</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- deprecated in 7.0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Returns &#39;True&#39; if the supplied &#39;Chan&#39; is empty.</span></span><span class="mpre">
</span><a href="#loc_143_1_143_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_12&#39;)"><span class="mpre">isEmptyChan</span></a><span class="mpre"> :: </span><a href="#loc_51_6_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_10&#39;)"><span class="hl_tyconref"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_143_1_143_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_12&#39;)"><span class="hl_fundecl"><span class="mpre">isEmptyChan</span></span></a><span class="mpre"> (</span><a href="#loc_52_4_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_4_52_8&#39;)"><span class="hl_conref"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><a name="loc_143_19_143_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_19_143_26&#39;)"><span class="hl_vardecl"><span class="mpre">readVar</span></span></a><span class="mpre"> </span><a name="loc_143_27_143_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_27_143_35&#39;)"><span class="hl_vardecl"><span class="mpre">writeVar</span></span></a><span class="mpre">) = do
   </span><a href="Control.Concurrent.MVar.html#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Concurrent.MVar.html#loc_185_1_185_9&#39;)"><span class="hl_varref"><span class="mpre">withMVar</span></span></a><span class="mpre"> </span><a href="#loc_143_19_143_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_19_143_26&#39;)"><span class="hl_varref"><span class="mpre">readVar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_144_24_144_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_24_144_25&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> -&gt; do
     </span><a name="loc_145_6_145_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_7&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_116_1_116_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_116_1_116_9&#39;)"><span class="hl_varref"><span class="mpre">readMVar</span></span></a><span class="mpre"> </span><a href="#loc_143_27_143_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_27_143_35&#39;)"><span class="hl_varref"><span class="mpre">writeVar</span></span></a><span class="mpre">
     let </span><a name="loc_146_10_146_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_10_146_12&#39;)"><span class="hl_vardecl"><span class="mpre">eq</span></span></a><span class="mpre"> = </span><a href="#loc_144_24_144_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_24_144_25&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_145_6_145_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_7&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">
     </span><a href="#loc_146_10_146_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_10_146_12&#39;)"><span class="hl_varref"><span class="mpre">eq</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_167_1_167_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_167_1_167_4&#39;)"><span class="hl_infix"><span class="mpre">`seq`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_146_10_146_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_10_146_12&#39;)"><span class="hl_varref"><span class="mpre">eq</span></span></a><span class="mpre">
</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Control/Concurrent/Chan.hs&quot;, srcSpanStartLine = 148, srcSpanStartColumn = 1, srcSpanEndLine = 148, srcSpanEndColumn = 166}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Control/Concurrent/Chan.hs&quot;, srcSpanStartLine = 148, srcSpanStartColumn = 1, srcSpanEndLine = 148, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Control/Concurrent/Chan"><span class="mpre">{-# DEPRECATED isEmptyChan &quot;if you need this operation, use Control.Concurrent.STM.TChan instead.  See &lt;http://ghc.haskell.org/trac/ghc/ticket/4154&gt; for details&quot; #-}</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- deprecated in 7.0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Operators for interfacing with functional streams.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Return a lazy list representing the contents of the supplied</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Chan&#39;, much like &#39;System.IO.hGetContents&#39;.</span></span><span class="mpre">
</span><a href="#loc_155_1_155_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_16&#39;)"><span class="mpre">getChanContents</span></a><span class="mpre"> :: </span><a href="#loc_51_6_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_10&#39;)"><span class="hl_tyconref"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_155_1_155_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_16&#39;)"><span class="hl_fundecl"><span class="mpre">getChanContents</span></span></a><span class="mpre"> </span><a name="loc_155_17_155_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_17_155_19&#39;)"><span class="hl_vardecl"><span class="mpre">ch</span></span></a><span class="mpre">
  = </span><a href="GHC.IO.html#loc_213_1_213_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_213_1_213_19&#39;)"><span class="hl_varref"><span class="mpre">unsafeInterleaveIO</span></span></a><span class="mpre"> (do
        </span><a name="loc_157_9_157_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_103_1_103_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_9&#39;)"><span class="hl_varref"><span class="mpre">readChan</span></span></a><span class="mpre"> </span><a href="#loc_155_17_155_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_17_155_19&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre">
        </span><a name="loc_158_9_158_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_9_158_11&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_155_1_155_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_16&#39;)"><span class="hl_varref"><span class="mpre">getChanContents</span></span></a><span class="mpre"> </span><a href="#loc_155_17_155_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_17_155_19&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_157_9_157_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_158_9_158_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_9_158_11&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
    )

</span><span class="hl_comment"><span class="mpre">-- |Write an entire list of items to a &#39;Chan&#39;.</span></span><span class="mpre">
</span><a href="#loc_164_1_164_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_15&#39;)"><span class="mpre">writeList2Chan</span></a><span class="mpre"> :: </span><a href="#loc_51_6_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_10&#39;)"><span class="hl_tyconref"><span class="mpre">Chan</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_164_1_164_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_15&#39;)"><span class="hl_fundecl"><span class="mpre">writeList2Chan</span></span></a><span class="mpre"> </span><a name="loc_164_16_164_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_16_164_18&#39;)"><span class="hl_vardecl"><span class="mpre">ch</span></span></a><span class="mpre"> </span><a name="loc_164_19_164_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_19_164_21&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_106_1_106_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_106_1_106_10&#39;)"><span class="hl_varref"><span class="mpre">sequence_</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_84_1_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_10&#39;)"><span class="hl_varref"><span class="mpre">writeChan</span></span></a><span class="mpre"> </span><a href="#loc_164_16_164_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_16_164_18&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre">) </span><a href="#loc_164_19_164_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_19_164_21&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">)
</span></div></body></html>