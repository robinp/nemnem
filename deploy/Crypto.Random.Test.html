<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Random.Test</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Good</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Provide way to test usual simple statisticals test for randomness</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Crypto.Random.Test
    ( RandomTestState
    , RandomTestResult(..)
    , randomTestInitialize
    , randomTestAppend
    , randomTestFinalize
    ) where

import Data.Word
import Data.Int (</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="mpre">Int64</span></a><span class="mpre">)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Test.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 18, srcSpanEndLine = 20, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import Control.Applicative
import Data.List (</span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="mpre">foldl&#39;</span></a><span class="mpre">)

import qualified Data.Vector.Mutable as M
import qualified Data.Vector as V

</span><span class="hl_comment"><span class="mpre">-- | Randomness various result relative to random bytes</span></span><span class="mpre">
data </span><a name="loc_28_6_28_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_22&#39;)"><span class="hl_tycondecl"><span class="mpre">RandomTestResult</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">RandomTestResult</span></span><span class="mpre">
    { </span><a name="loc_29_7_29_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_7_29_21&#39;)"><span class="hl_fielddecl"><span class="mpre">res_totalChars</span></span></a><span class="mpre">         :: </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Total number of characters</span></span><span class="mpre">
    , </span><a name="loc_30_7_30_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_7_30_18&#39;)"><span class="hl_fielddecl"><span class="mpre">res_entropy</span></span></a><span class="mpre">            :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Entropy per byte</span></span><span class="mpre">
    , </span><a name="loc_31_7_31_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_7_31_21&#39;)"><span class="hl_fielddecl"><span class="mpre">res_chi_square</span></span></a><span class="mpre">         :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Chi Square</span></span><span class="mpre">
    , </span><a name="loc_32_7_32_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_15&#39;)"><span class="hl_fielddecl"><span class="mpre">res_mean</span></span></a><span class="mpre">               :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Arithmetic Mean</span></span><span class="mpre">
    , </span><a name="loc_33_7_33_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_29&#39;)"><span class="hl_fielddecl"><span class="mpre">res_compressionPercent</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Theorical Compression percent</span></span><span class="mpre">
    , </span><a name="loc_34_7_34_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_16&#39;)"><span class="hl_fielddecl"><span class="mpre">res_probs</span></span></a><span class="mpre">              :: [</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ Probability of every bucket</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Test.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 7, srcSpanEndLine = 35, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Test.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 7, srcSpanEndLine = 35, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Test.hs&quot;,"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Mutable random test State</span></span><span class="mpre">
newtype </span><a name="loc_38_9_38_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_24&#39;)"><span class="hl_tycondecl"><span class="mpre">RandomTestState</span></span></a><span class="mpre"> = </span><a name="loc_38_27_38_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_27_38_42&#39;)"><span class="hl_condecl"><span class="mpre">RandomTestState</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">M.IOVector</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Initialize new state to run tests</span></span><span class="mpre">
</span><a href="#loc_42_1_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_21&#39;)"><span class="mpre">randomTestInitialize</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_38_9_38_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_24&#39;)"><span class="hl_tyconref"><span class="mpre">RandomTestState</span></span></a><span class="mpre">
</span><a name="loc_42_1_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_21&#39;)"><span class="hl_vardecl"><span class="mpre">randomTestInitialize</span></span></a><span class="mpre"> = </span><a href="#loc_38_27_38_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_27_38_42&#39;)"><span class="hl_conref"><span class="mpre">RandomTestState</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Data.Vector.Mutable.html#loc_279_1_279_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Mutable.html#loc_279_1_279_10&#39;)"><span class="hl_varref"><span class="mpre">M.replicate</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">256</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Append random data to the test state</span></span><span class="mpre">
</span><a href="#loc_46_1_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_17&#39;)"><span class="mpre">randomTestAppend</span></a><span class="mpre"> :: </span><a href="#loc_38_9_38_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_24&#39;)"><span class="hl_tyconref"><span class="mpre">RandomTestState</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_46_1_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_17&#39;)"><span class="hl_fundecl"><span class="mpre">randomTestAppend</span></span></a><span class="mpre"> (</span><a href="#loc_38_27_38_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_27_38_42&#39;)"><span class="hl_conref"><span class="mpre">RandomTestState</span></span></a><span class="mpre"> </span><a name="loc_46_35_46_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_35_46_42&#39;)"><span class="hl_vardecl"><span class="mpre">buckets</span></span></a><span class="mpre">) = </span><a href="#loc_47_9_47_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
  where </span><a name="loc_47_9_47_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_47_14_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_14_47_16&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">L.null</span></span><span class="mpre"> </span><a href="#loc_47_14_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_14_47_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
                let (</span><a name="loc_50_22_50_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_22_50_24&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre">,</span><a name="loc_50_25_50_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_25_50_27&#39;)"><span class="hl_vardecl"><span class="mpre">b2</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">L.splitAt</span></span><span class="mpre"> </span><a href="#loc_60_1_60_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_7&#39;)"><span class="hl_varref"><span class="mpre">monteN</span></span></a><span class="mpre"> </span><a href="#loc_47_14_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_14_47_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> (</span><a href="#loc_53_9_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_15&#39;)"><span class="hl_varref"><span class="mpre">addVec</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.unpack</span></span><span class="mpre"> </span><a href="#loc_50_22_50_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_22_50_24&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre">
                </span><a href="#loc_47_9_47_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_50_25_50_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_25_50_27&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">
        </span><a name="loc_53_9_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_15&#39;)"><span class="hl_fundecl"><span class="mpre">addVec</span></span></a><span class="mpre"> </span><a name="loc_53_16_53_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_16_53_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_53_18_53_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_18_53_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.Vector.Mutable.html#loc_324_1_324_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Mutable.html#loc_324_1_324_5&#39;)"><span class="hl_varref"><span class="mpre">M.read</span></span></a><span class="mpre"> </span><a href="#loc_46_35_46_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_35_46_42&#39;)"><span class="hl_varref"><span class="mpre">buckets</span></span></a><span class="mpre"> </span><a href="#loc_53_18_53_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_18_53_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_53_44_53_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_44_53_45&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Vector.Mutable.html#loc_329_1_329_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.Mutable.html#loc_329_1_329_6&#39;)"><span class="hl_varref"><span class="mpre">M.write</span></span></a><span class="mpre"> </span><a href="#loc_46_35_46_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_35_46_42&#39;)"><span class="hl_varref"><span class="mpre">buckets</span></span></a><span class="mpre"> </span><a href="#loc_53_18_53_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_18_53_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_53_44_53_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_44_53_45&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_53_16_53_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_16_53_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Finalize random test state into some result</span></span><span class="mpre">
</span><a href="#loc_57_1_57_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_19&#39;)"><span class="mpre">randomTestFinalize</span></a><span class="mpre"> :: </span><a href="#loc_38_9_38_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_24&#39;)"><span class="hl_tyconref"><span class="mpre">RandomTestState</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_28_6_28_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_22&#39;)"><span class="hl_tyconref"><span class="mpre">RandomTestResult</span></span></a><span class="mpre">
</span><a name="loc_57_1_57_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_19&#39;)"><span class="hl_fundecl"><span class="mpre">randomTestFinalize</span></span></a><span class="mpre"> (</span><a href="#loc_38_27_38_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_27_38_42&#39;)"><span class="hl_conref"><span class="mpre">RandomTestState</span></span></a><span class="mpre"> </span><a name="loc_57_37_57_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_37_57_44&#39;)"><span class="hl_vardecl"><span class="mpre">buckets</span></span></a><span class="mpre">) = (</span><a href="#loc_63_1_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_10&#39;)"><span class="hl_varref"><span class="mpre">calculate</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Vector.html#loc_1471_1_1471_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_1471_1_1471_7&#39;)"><span class="hl_varref"><span class="mpre">V.toList</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="Data.Vector.html#loc_1510_1_1510_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_1510_1_1510_7&#39;)"><span class="hl_varref"><span class="mpre">V.freeze</span></span></a><span class="mpre"> </span><a href="#loc_57_37_57_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_37_57_44&#39;)"><span class="hl_varref"><span class="mpre">buckets</span></span></a><span class="mpre">

</span><a href="#loc_60_1_60_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_7&#39;)"><span class="mpre">monteN</span></a><span class="mpre"> :: </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">
</span><a name="loc_60_1_60_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_7&#39;)"><span class="hl_vardecl"><span class="mpre">monteN</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">

</span><a href="#loc_63_1_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_10&#39;)"><span class="mpre">calculate</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">] -&gt; </span><a href="#loc_28_6_28_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_22&#39;)"><span class="hl_tyconref"><span class="mpre">RandomTestResult</span></span></a><span class="mpre">
</span><a name="loc_63_1_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_10&#39;)"><span class="hl_fundecl"><span class="mpre">calculate</span></span></a><span class="mpre"> </span><a name="loc_63_11_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_11_63_18&#39;)"><span class="hl_vardecl"><span class="mpre">buckets</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Test.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 21, srcSpanEndLine = 70, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Test.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 5, srcSpanEndLine = 64, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Test.hs&quot;,"><span class="mpre">RandomTestResult
    { res_totalChars = totalChars
    , res_entropy    = entropy
    , res_chi_square = chisq
    , res_mean       = fromIntegral datasum / fromIntegral totalChars
    , res_compressionPercent = 100.0 * (8 - entropy) / 8.0
    , res_probs      = probs
    }</span></span><span class="mpre">
  where </span><a name="loc_71_9_71_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_19&#39;)"><span class="hl_vardecl"><span class="mpre">totalChars</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">sum</span></span><span class="mpre"> </span><a href="#loc_63_11_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_11_63_18&#39;)"><span class="hl_varref"><span class="mpre">buckets</span></span></a><span class="mpre">
        </span><a name="loc_72_9_72_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_14&#39;)"><span class="hl_vardecl"><span class="mpre">probs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\</span><a name="loc_72_23_72_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_23_72_24&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_72_23_72_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_23_72_24&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_71_9_71_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_19&#39;)"><span class="hl_varref"><span class="mpre">totalChars</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">) </span><a href="#loc_63_11_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_11_63_18&#39;)"><span class="hl_varref"><span class="mpre">buckets</span></span></a><span class="mpre">
        </span><span class="hl_vardecl"><span class="mpre">entropy</span></span><span class="mpre"> = </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> </span><a href="#loc_78_9_78_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_9_78_15&#39;)"><span class="hl_varref"><span class="mpre">accEnt</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0.0</span></span><span class="mpre"> </span><a href="#loc_72_9_72_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_14&#39;)"><span class="hl_varref"><span class="mpre">probs</span></span></a><span class="mpre">
        </span><a name="loc_74_9_74_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_13&#39;)"><span class="hl_vardecl"><span class="mpre">cexp</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_71_9_71_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_19&#39;)"><span class="hl_varref"><span class="mpre">totalChars</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">256.0</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
        (</span><span class="hl_vardecl"><span class="mpre">datasum</span></span><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">chisq</span></span><span class="mpre">) = </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> </span><a href="#loc_84_9_84_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_19&#39;)"><span class="hl_varref"><span class="mpre">accMeanChi</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0.0</span></span><span class="mpre">) </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Test.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 55, srcSpanEndLine = 75, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Test.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 55, srcSpanEndLine = 75, srcSpanEndColumn = 56},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Test."><span class="mpre">[0..255]</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">--chip&#39; = abs (sqrt (2.0 * chisq) - sqrt (2.0 * 255.0 - 1.0))</span></span><span class="mpre">

        </span><a name="loc_78_9_78_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_9_78_15&#39;)"><span class="hl_fundecl"><span class="mpre">accEnt</span></span></a><span class="mpre"> </span><a name="loc_78_16_78_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_16_78_19&#39;)"><span class="hl_vardecl"><span class="mpre">ent</span></span></a><span class="mpre"> </span><a name="loc_78_20_78_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_20_78_22&#39;)"><span class="hl_vardecl"><span class="mpre">pr</span></span></a><span class="mpre">
            | </span><a href="#loc_78_20_78_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_20_78_22&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0.0</span></span><span class="mpre">  = </span><a href="#loc_78_16_78_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_16_78_19&#39;)"><span class="hl_varref"><span class="mpre">ent</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_78_20_78_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_20_78_22&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_81_9_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_13&#39;)"><span class="hl_varref"><span class="mpre">xlog</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><a href="#loc_78_20_78_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_20_78_22&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre">))
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_78_16_78_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_16_78_19&#39;)"><span class="hl_varref"><span class="mpre">ent</span></span></a><span class="mpre">
        </span><a name="loc_81_9_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_13&#39;)"><span class="hl_fundecl"><span class="mpre">xlog</span></span></a><span class="mpre"> </span><a name="loc_81_14_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_14_81_15&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">logBase</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><a href="#loc_81_14_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_14_81_15&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">log</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">log</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)

        </span><a href="#loc_84_9_84_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_19&#39;)"><span class="mpre">accMeanChi</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)
        </span><a name="loc_84_9_84_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_19&#39;)"><span class="hl_fundecl"><span class="mpre">accMeanChi</span></span></a><span class="mpre"> (</span><a name="loc_84_21_84_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_21_84_28&#39;)"><span class="hl_vardecl"><span class="mpre">dataSum</span></span></a><span class="mpre">, </span><a name="loc_84_30_84_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_30_84_35&#39;)"><span class="hl_vardecl"><span class="mpre">chiSq</span></span></a><span class="mpre">) </span><a name="loc_84_37_84_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_37_84_38&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> =
            let </span><a name="loc_85_17_85_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_17_85_23&#39;)"><span class="hl_vardecl"><span class="mpre">ccount</span></span></a><span class="mpre"> = </span><a href="#loc_63_11_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_11_63_18&#39;)"><span class="hl_varref"><span class="mpre">buckets</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!!</span></span><span class="mpre"> </span><a href="#loc_84_37_84_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_37_84_38&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
                </span><a name="loc_86_17_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_18&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">      = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_85_17_85_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_17_85_23&#39;)"><span class="hl_varref"><span class="mpre">ccount</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_13&#39;)"><span class="hl_varref"><span class="mpre">cexp</span></span></a><span class="mpre">
             in (</span><a href="#loc_84_21_84_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_21_84_28&#39;)"><span class="hl_varref"><span class="mpre">dataSum</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_84_37_84_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_37_84_38&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_85_17_85_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_17_85_23&#39;)"><span class="hl_varref"><span class="mpre">ccount</span></span></a><span class="mpre">, </span><a href="#loc_84_30_84_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_30_84_35&#39;)"><span class="hl_varref"><span class="mpre">chiSq</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_86_17_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_86_17_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><a href="#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_13&#39;)"><span class="hl_varref"><span class="mpre">cexp</span></span></a><span class="mpre">))
</span></div></body></html>