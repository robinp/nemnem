<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module Test.TestParseDAT where

import Data.Time
import Data.Time.Clock.TAI
import Test.TestUtil
import Test.TestParseDAT_Ref
import Test.TAI_UTC_DAT

</span><a href="#loc_10_1_10_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_5&#39;)"><span class="mpre">tods</span></a><span class="mpre"> :: [</span><a href="Data.Time.LocalTime.TimeOfDay.html#loc_24_6_24_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.LocalTime.TimeOfDay.html#loc_24_6_24_15&#39;)"><span class="hl_tyconref"><span class="mpre">TimeOfDay</span></span></a><span class="mpre">]
</span><a name="loc_10_1_10_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_5&#39;)"><span class="hl_vardecl"><span class="mpre">tods</span></span></a><span class="mpre"> = [
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0.5</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1.5</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">28</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">28.5</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">29</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">29.5</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">30.5</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">31.5</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59.5</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">60</span></span><span class="mpre">,
        </span><span class="hl_conref"><span class="mpre">TimeOfDay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">60.5</span></span><span class="mpre">
        ]

</span><a href="#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_6&#39;)"><span class="mpre">times</span></a><span class="mpre"> :: [</span><a href="Data.Time.LocalTime.LocalTime.html#loc_30_6_30_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.LocalTime.LocalTime.html#loc_30_6_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">LocalTime</span></span></a><span class="mpre">]
</span><a name="loc_32_1_32_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_6&#39;)"><span class="hl_vardecl"><span class="mpre">times</span></span></a><span class="mpre"> =
        </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">LocalTime</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Gregorian.html#loc_32_1_32_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Gregorian.html#loc_32_1_32_14&#39;)"><span class="hl_varref"><span class="mpre">fromGregorian</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1998</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">04</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">02</span></span><span class="mpre">)) </span><a href="#loc_10_1_10_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_5&#39;)"><span class="hl_varref"><span class="mpre">tods</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">LocalTime</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Gregorian.html#loc_32_1_32_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Gregorian.html#loc_32_1_32_14&#39;)"><span class="hl_varref"><span class="mpre">fromGregorian</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1998</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">)) </span><a href="#loc_10_1_10_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_5&#39;)"><span class="hl_varref"><span class="mpre">tods</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">LocalTime</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Gregorian.html#loc_32_1_32_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Gregorian.html#loc_32_1_32_14&#39;)"><span class="hl_varref"><span class="mpre">fromGregorian</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1998</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">)) </span><a href="#loc_10_1_10_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_5&#39;)"><span class="hl_varref"><span class="mpre">tods</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">LocalTime</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Gregorian.html#loc_32_1_32_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Gregorian.html#loc_32_1_32_14&#39;)"><span class="hl_varref"><span class="mpre">fromGregorian</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1999</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">01</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">01</span></span><span class="mpre">)) </span><a href="#loc_10_1_10_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_5&#39;)"><span class="hl_varref"><span class="mpre">tods</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">LocalTime</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Gregorian.html#loc_32_1_32_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Gregorian.html#loc_32_1_32_14&#39;)"><span class="hl_varref"><span class="mpre">fromGregorian</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1999</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">01</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">02</span></span><span class="mpre">)) </span><a href="#loc_10_1_10_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_5&#39;)"><span class="hl_varref"><span class="mpre">tods</span></span></a><span class="mpre">

</span><a href="#loc_40_1_40_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_13&#39;)"><span class="mpre">testParseDAT</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_40_1_40_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_13&#39;)"><span class="hl_vardecl"><span class="mpre">testParseDAT</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">pureTest</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;testParseDAT&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">diff</span></span><span class="mpre"> </span><a href="Test.TestParseDAT_Ref.html#loc_4_1_4_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Test.TestParseDAT_Ref.html#loc_4_1_4_17&#39;)"><span class="hl_varref"><span class="mpre">testParseDAT_Ref</span></span></a><span class="mpre"> </span><a href="#loc_41_5_41_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_13&#39;)"><span class="hl_varref"><span class="mpre">parseDAT</span></span></a><span class="mpre"> where
    </span><a name="loc_41_5_41_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_13&#39;)"><span class="hl_vardecl"><span class="mpre">parseDAT</span></span></a><span class="mpre"> = 
        let </span><a name="loc_42_13_42_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_13_42_16&#39;)"><span class="hl_vardecl"><span class="mpre">lst</span></span></a><span class="mpre"> = </span><a href="Data.Time.Clock.TAI.html#loc_83_1_83_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.TAI.html#loc_83_1_83_19&#39;)"><span class="hl_varref"><span class="mpre">parseTAIUTCDATFile</span></span></a><span class="mpre"> </span><a href="Test.TAI_UTC_DAT.html#loc_4_1_4_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Test.TAI_UTC_DAT.html#loc_4_1_4_11&#39;)"><span class="hl_varref"><span class="mpre">taiUTC_DAT</span></span></a><span class="mpre"> in 
        </span><span class="hl_varref"><span class="mpre">unlines</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre">
        (\</span><a name="loc_44_11_44_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_11_44_13&#39;)"><span class="hl_vardecl"><span class="mpre">lt</span></span></a><span class="mpre"> -&gt;
            let
                </span><a name="loc_46_17_46_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_24&#39;)"><span class="hl_vardecl"><span class="mpre">utcTime</span></span></a><span class="mpre">  = </span><a href="Data.Time.LocalTime.LocalTime.html#loc_56_1_56_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.LocalTime.LocalTime.html#loc_56_1_56_15&#39;)"><span class="hl_varref"><span class="mpre">localTimeToUTC</span></span></a><span class="mpre"> </span><a href="Data.Time.LocalTime.TimeZone.html#loc_73_1_73_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.LocalTime.TimeZone.html#loc_73_1_73_4&#39;)"><span class="hl_varref"><span class="mpre">utc</span></span></a><span class="mpre"> </span><a href="#loc_44_11_44_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_11_44_13&#39;)"><span class="hl_varref"><span class="mpre">lt</span></span></a><span class="mpre">
                </span><a name="loc_47_17_47_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_24&#39;)"><span class="hl_vardecl"><span class="mpre">taiTime</span></span></a><span class="mpre">  = </span><a href="Data.Time.Clock.TAI.html#loc_69_1_69_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.TAI.html#loc_69_1_69_13&#39;)"><span class="hl_varref"><span class="mpre">utcToTAITime</span></span></a><span class="mpre"> </span><a href="#loc_42_13_42_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_13_42_16&#39;)"><span class="hl_varref"><span class="mpre">lst</span></span></a><span class="mpre"> </span><a href="#loc_46_17_46_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_24&#39;)"><span class="hl_varref"><span class="mpre">utcTime</span></span></a><span class="mpre">
                </span><a name="loc_48_17_48_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_25&#39;)"><span class="hl_vardecl"><span class="mpre">utcTime&#39;</span></span></a><span class="mpre"> = </span><a href="Data.Time.Clock.TAI.html#loc_73_1_73_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.TAI.html#loc_73_1_73_13&#39;)"><span class="hl_varref"><span class="mpre">taiToUTCTime</span></span></a><span class="mpre"> </span><a href="#loc_42_13_42_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_13_42_16&#39;)"><span class="hl_varref"><span class="mpre">lst</span></span></a><span class="mpre"> </span><a href="#loc_47_17_47_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_24&#39;)"><span class="hl_varref"><span class="mpre">taiTime</span></span></a><span class="mpre">
            in if </span><a href="#loc_46_17_46_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_24&#39;)"><span class="hl_varref"><span class="mpre">utcTime</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_48_17_48_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_25&#39;)"><span class="hl_varref"><span class="mpre">utcTime&#39;</span></span></a><span class="mpre">
                then </span><span class="hl_varref"><span class="mpre">unwords</span></span><span class="mpre"> [</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_46_17_46_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_24&#39;)"><span class="hl_varref"><span class="mpre">utcTime</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;==&quot;</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_47_17_47_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_24&#39;)"><span class="hl_varref"><span class="mpre">taiTime</span></span></a><span class="mpre">]
                else </span><span class="hl_varref"><span class="mpre">unwords</span></span><span class="mpre"> [ </span><span class="hl_string"><span class="mpre">&quot;correction:&quot;</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_46_17_46_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_24&#39;)"><span class="hl_varref"><span class="mpre">utcTime</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;-&gt;&quot;</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_47_17_47_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_24&#39;)"><span class="hl_varref"><span class="mpre">taiTime</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;-&gt;&quot;</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_48_17_48_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_25&#39;)"><span class="hl_varref"><span class="mpre">utcTime&#39;</span></span></a><span class="mpre">]
        )
        </span><a href="#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_6&#39;)"><span class="hl_varref"><span class="mpre">times</span></span></a><span class="mpre">
</span></div></body></html>