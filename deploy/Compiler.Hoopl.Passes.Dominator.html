<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, GADTs #-}
{-# OPTIONS_GHC -Wall -fno-warn-name-shadowing #-}
#if __GLASGOW_HASKELL__ &gt;= 701
{-# LANGUAGE Safe #-}
#endif

module Compiler.Hoopl.Passes.Dominator
  ( Doms, DPath(..), domPath, domEntry, domLattice, extendDom
  , DominatorNode(..), DominatorTree(..), tree
  , immediateDominators
  , domPass
  )
where

import Data.Maybe

import Compiler.Hoopl


</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Passes/Dominator.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 1, srcSpanEndLine = 20, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Passes/Dominator.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 1, srcSpanEndLine = 20, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/C"><span class="mpre">type Doms = WithBot DPath</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ List of labels, extended with a standard bottom element</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The fact that goes into the entry of a dominator analysis: the first node</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is dominated only by the entry point, which is represented by the empty list</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of labels.</span></span><span class="mpre">
</span><a href="#loc_27_1_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_9&#39;)"><span class="mpre">domEntry</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Doms</span></span><span class="mpre">
</span><a name="loc_27_1_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_9&#39;)"><span class="hl_vardecl"><span class="mpre">domEntry</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">PElem</span></span><span class="mpre"> (</span><a href="#loc_29_17_29_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_22&#39;)"><span class="hl_conref"><span class="mpre">DPath</span></span></a><span class="mpre"> [])

newtype </span><a name="loc_29_9_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_14&#39;)"><span class="hl_tycondecl"><span class="mpre">DPath</span></span></a><span class="mpre"> = </span><a name="loc_29_17_29_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_22&#39;)"><span class="hl_condecl"><span class="mpre">DPath</span></span></a><span class="mpre"> [</span><a href="Compiler.Hoopl.Label.html#loc_25_9_25_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_25_9_25_14&#39;)"><span class="hl_tyconref"><span class="mpre">Label</span></span></a><span class="mpre">]
  </span><span class="hl_comment"><span class="mpre">-- ^ represents part of the domination relation: each label</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- in a list is dominated by all its successors.  This is a newtype only so</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- we can give it a fancy Show instance.</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_29_9_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">DPath</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_29_17_29_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_22&#39;)"><span class="hl_conref"><span class="mpre">DPath</span></span></a><span class="mpre"> </span><a name="loc_35_15_35_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_15_35_17&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (\</span><a name="loc_35_37_35_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_37_35_38&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_35_39_35_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_39_35_43&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_35_37_35_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_37_35_38&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; -&gt; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_35_39_35_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_39_35_43&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">) [</span><span class="hl_string"><span class="mpre">&quot;entry&quot;</span></span><span class="mpre">] </span><a href="#loc_35_15_35_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_15_35_17&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">)

</span><a href="#loc_38_1_38_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_8&#39;)"><span class="mpre">domPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Doms</span></span><span class="mpre"> -&gt; [</span><a href="Compiler.Hoopl.Label.html#loc_25_9_25_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_25_9_25_14&#39;)"><span class="hl_tyconref"><span class="mpre">Label</span></span></a><span class="mpre">]
</span><a name="loc_38_1_38_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_8&#39;)"><span class="hl_fundecl"><span class="mpre">domPath</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Bot</span></span><span class="mpre"> = [] </span><span class="hl_comment"><span class="mpre">-- lies: an unreachable node appears to be dominated by the entry</span></span><span class="mpre">
</span><a href="#loc_38_1_38_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_8&#39;)"><span class="hl_fundecl"><span class="mpre">domPath</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">PElem</span></span><span class="mpre"> (</span><a href="#loc_29_17_29_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_22&#39;)"><span class="hl_conref"><span class="mpre">DPath</span></span></a><span class="mpre"> </span><a name="loc_39_23_39_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_23_39_25&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre">)) = </span><a href="#loc_39_23_39_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_23_39_25&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">

</span><a href="#loc_42_1_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_10&#39;)"><span class="mpre">extendDom</span></a><span class="mpre"> :: </span><a href="Compiler.Hoopl.Label.html#loc_25_9_25_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_25_9_25_14&#39;)"><span class="hl_tyconref"><span class="mpre">Label</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_29_9_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">DPath</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_29_9_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">DPath</span></span></a><span class="mpre">
</span><a name="loc_42_1_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_10&#39;)"><span class="hl_fundecl"><span class="mpre">extendDom</span></span></a><span class="mpre"> </span><a name="loc_42_11_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_11_42_12&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_29_17_29_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_22&#39;)"><span class="hl_conref"><span class="mpre">DPath</span></span></a><span class="mpre"> </span><a name="loc_42_20_42_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_20_42_22&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre">) = </span><a href="#loc_29_17_29_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_22&#39;)"><span class="hl_conref"><span class="mpre">DPath</span></span></a><span class="mpre"> (</span><a href="#loc_42_11_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_11_42_12&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_42_20_42_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_20_42_22&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">)

</span><a href="#loc_45_1_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_11&#39;)"><span class="mpre">domLattice</span></a><span class="mpre"> :: </span><a href="Compiler.Hoopl.Dataflow.html#loc_50_6_50_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Dataflow.html#loc_50_6_50_21&#39;)"><span class="hl_tyconref"><span class="mpre">DataflowLattice</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Doms</span></span><span class="mpre">
</span><a name="loc_45_1_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_11&#39;)"><span class="hl_vardecl"><span class="mpre">domLattice</span></span></a><span class="mpre"> = </span><a href="Compiler.Hoopl.Pointed.html#loc_73_1_73_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Pointed.html#loc_73_1_73_10&#39;)"><span class="hl_varref"><span class="mpre">addPoints</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;dominators&quot;</span></span><span class="mpre"> </span><a href="#loc_48_1_48_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_7&#39;)"><span class="hl_varref"><span class="mpre">extend</span></span></a><span class="mpre">

</span><a href="#loc_48_1_48_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_7&#39;)"><span class="mpre">extend</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">JoinFun</span></span><span class="mpre"> </span><a href="#loc_29_9_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">DPath</span></span></a><span class="mpre">
</span><a name="loc_48_1_48_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_7&#39;)"><span class="hl_fundecl"><span class="mpre">extend</span></span></a><span class="mpre"> _ (</span><a href="Compiler.Hoopl.Dataflow.html#loc_63_21_63_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Dataflow.html#loc_63_21_63_28&#39;)"><span class="hl_conref"><span class="mpre">OldFact</span></span></a><span class="mpre"> (</span><a href="#loc_29_17_29_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_22&#39;)"><span class="hl_conref"><span class="mpre">DPath</span></span></a><span class="mpre"> </span><a name="loc_48_26_48_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_26_48_27&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">)) (</span><a href="Compiler.Hoopl.Dataflow.html#loc_64_21_64_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Dataflow.html#loc_64_21_64_28&#39;)"><span class="hl_conref"><span class="mpre">NewFact</span></span></a><span class="mpre"> (</span><a href="#loc_29_17_29_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_22&#39;)"><span class="hl_conref"><span class="mpre">DPath</span></span></a><span class="mpre"> </span><a name="loc_48_46_48_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_46_48_48&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre">)) =
                                (</span><a href="Compiler.Hoopl.Dataflow.html#loc_68_1_68_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Dataflow.html#loc_68_1_68_9&#39;)"><span class="hl_varref"><span class="mpre">changeIf</span></span></a><span class="mpre"> (</span><a href="#loc_48_26_48_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_26_48_27&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_60_11_60_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_11_60_24&#39;)"><span class="hl_infix"><span class="mpre">`lengthDiffers`</span></span></a><span class="mpre"> </span><a href="#loc_50_11_50_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_11_50_12&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">), </span><a href="#loc_29_17_29_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_22&#39;)"><span class="hl_conref"><span class="mpre">DPath</span></span></a><span class="mpre"> </span><a href="#loc_50_11_50_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_11_50_12&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">)
    where </span><a name="loc_50_11_50_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_11_50_12&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> = </span><a href="#loc_52_11_52_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_11_52_14&#39;)"><span class="hl_varref"><span class="mpre">lcs</span></span></a><span class="mpre"> </span><a href="#loc_48_26_48_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_26_48_27&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_48_46_48_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_46_48_48&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">
          </span><a href="#loc_52_11_52_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_11_52_14&#39;)"><span class="mpre">lcs</span></a><span class="mpre"> :: [</span><a href="Compiler.Hoopl.Label.html#loc_25_9_25_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_25_9_25_14&#39;)"><span class="hl_tyconref"><span class="mpre">Label</span></span></a><span class="mpre">] -&gt; [</span><a href="Compiler.Hoopl.Label.html#loc_25_9_25_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_25_9_25_14&#39;)"><span class="hl_tyconref"><span class="mpre">Label</span></span></a><span class="mpre">] -&gt; [</span><a href="Compiler.Hoopl.Label.html#loc_25_9_25_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_25_9_25_14&#39;)"><span class="hl_tyconref"><span class="mpre">Label</span></span></a><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- longest common suffix</span></span><span class="mpre">
          </span><a name="loc_52_11_52_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_11_52_14&#39;)"><span class="hl_fundecl"><span class="mpre">lcs</span></span></a><span class="mpre"> </span><a name="loc_52_15_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_15_52_16&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_52_17_52_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_19&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_52_15_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_15_52_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_52_17_52_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_19&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_52_11_52_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_11_52_14&#39;)"><span class="hl_varref"><span class="mpre">lcs</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_52_15_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_15_52_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_52_17_52_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_19&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">) </span><a href="#loc_52_15_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_15_52_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_52_17_52_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_19&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">
                   | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_52_15_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_15_52_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_52_17_52_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_19&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_52_11_52_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_11_52_14&#39;)"><span class="hl_varref"><span class="mpre">lcs</span></span></a><span class="mpre"> </span><a href="#loc_52_17_52_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_19&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> </span><a href="#loc_52_15_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_15_52_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
                   | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_55_11_55_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_11_55_21&#39;)"><span class="hl_varref"><span class="mpre">dropUnlike</span></span></a><span class="mpre"> </span><a href="#loc_52_15_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_15_52_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_52_17_52_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_19&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> </span><a href="#loc_52_15_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_15_52_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
          </span><a name="loc_55_11_55_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_11_55_21&#39;)"><span class="hl_fundecl"><span class="mpre">dropUnlike</span></span></a><span class="mpre"> [] [] </span><a name="loc_55_28_55_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_28_55_38&#39;)"><span class="hl_vardecl"><span class="mpre">maybe_like</span></span></a><span class="mpre"> = </span><a href="#loc_55_28_55_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_28_55_38&#39;)"><span class="hl_varref"><span class="mpre">maybe_like</span></span></a><span class="mpre">
          </span><a href="#loc_55_11_55_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_11_55_21&#39;)"><span class="hl_fundecl"><span class="mpre">dropUnlike</span></span></a><span class="mpre"> (</span><a name="loc_56_23_56_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_23_56_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_56_25_56_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_25_56_27&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) (</span><a name="loc_56_30_56_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_30_56_31&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_56_32_56_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_32_56_34&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) </span><a name="loc_56_36_56_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_36_56_46&#39;)"><span class="hl_vardecl"><span class="mpre">maybe_like</span></span></a><span class="mpre"> =
              </span><a href="#loc_55_11_55_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_11_55_21&#39;)"><span class="hl_varref"><span class="mpre">dropUnlike</span></span></a><span class="mpre"> </span><a href="#loc_56_25_56_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_25_56_27&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_56_32_56_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_32_56_34&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre"> (if </span><a href="#loc_56_23_56_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_23_56_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_56_30_56_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_30_56_31&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> then </span><a href="#loc_56_36_56_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_36_56_46&#39;)"><span class="hl_varref"><span class="mpre">maybe_like</span></span></a><span class="mpre"> else </span><a href="#loc_56_25_56_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_25_56_27&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
          </span><a href="#loc_55_11_55_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_11_55_21&#39;)"><span class="hl_fundecl"><span class="mpre">dropUnlike</span></span></a><span class="mpre"> _ _ _ = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;this can&#39;t happen&quot;</span></span><span class="mpre">

          </span><a name="loc_60_11_60_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_11_60_24&#39;)"><span class="hl_fundecl"><span class="mpre">lengthDiffers</span></span></a><span class="mpre"> [] [] = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
          </span><a href="#loc_60_11_60_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_11_60_24&#39;)"><span class="hl_fundecl"><span class="mpre">lengthDiffers</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_61_28_61_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_28_61_30&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_61_35_61_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_35_61_37&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_60_11_60_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_11_60_24&#39;)"><span class="hl_varref"><span class="mpre">lengthDiffers</span></span></a><span class="mpre"> </span><a href="#loc_61_28_61_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_28_61_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_61_35_61_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_35_61_37&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
          </span><a href="#loc_60_11_60_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_11_60_24&#39;)"><span class="hl_fundecl"><span class="mpre">lengthDiffers</span></span></a><span class="mpre"> [] (_</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
          </span><a href="#loc_60_11_60_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_11_60_24&#39;)"><span class="hl_fundecl"><span class="mpre">lengthDiffers</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) [] = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">



</span><span class="hl_comment"><span class="mpre">-- | Dominator pass</span></span><span class="mpre">
</span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="mpre">domPass</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Passes/Dominator.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 12, srcSpanEndLine = 68, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src/Compiler/Hoopl/Passes/Dominator.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 12, srcSpanEndLine = 68, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hoopl-3.10.0.1/src"><span class="mpre">(NonLocal n, Monad m) =&gt;</span></span><span class="mpre"> </span><a href="Compiler.Hoopl.Dataflow.html#loc_89_6_89_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Dataflow.html#loc_89_6_89_13&#39;)"><span class="hl_tyconref"><span class="mpre">FwdPass</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">n</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Doms</span></span><span class="mpre">
</span><a name="loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_vardecl"><span class="mpre">domPass</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">FwdPass</span></span><span class="mpre"> </span><a href="#loc_45_1_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_11&#39;)"><span class="hl_varref"><span class="mpre">domLattice</span></span></a><span class="mpre"> (</span><a href="Compiler.Hoopl.Dataflow.html#loc_137_1_137_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Dataflow.html#loc_137_1_137_13&#39;)"><span class="hl_varref"><span class="mpre">mkFTransfer3</span></span></a><span class="mpre"> </span><a href="#loc_70_9_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_14&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">) </span><a href="Compiler.Hoopl.XUtil.html#loc_127_1_127_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.XUtil.html#loc_127_1_127_15&#39;)"><span class="hl_varref"><span class="mpre">distributeFact</span></span></a><span class="mpre">) </span><a href="Compiler.Hoopl.Dataflow.html#loc_156_1_156_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Dataflow.html#loc_156_1_156_13&#39;)"><span class="hl_varref"><span class="mpre">noFwdRewrite</span></span></a><span class="mpre">
  where </span><a name="loc_70_9_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_14&#39;)"><span class="hl_fundecl"><span class="mpre">first</span></span></a><span class="mpre"> </span><a name="loc_70_15_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_15_70_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><a href="#loc_42_1_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_10&#39;)"><span class="hl_varref"><span class="mpre">extendDom</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Compiler.Hoopl.Graph.html#loc_104_3_104_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Graph.html#loc_104_3_104_13&#39;)"><span class="hl_varref"><span class="mpre">entryLabel</span></span></a><span class="mpre"> </span><a href="#loc_70_15_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_15_70_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

data </span><a name="loc_74_6_74_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_6_74_19&#39;)"><span class="hl_tycondecl"><span class="mpre">DominatorNode</span></span></a><span class="mpre"> = </span><a name="loc_74_22_74_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_22_74_27&#39;)"><span class="hl_condecl"><span class="mpre">Entry</span></span></a><span class="mpre"> | </span><a name="loc_74_30_74_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_30_74_38&#39;)"><span class="hl_condecl"><span class="mpre">Labelled</span></span></a><span class="mpre"> </span><a href="Compiler.Hoopl.Label.html#loc_25_9_25_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_25_9_25_14&#39;)"><span class="hl_tyconref"><span class="mpre">Label</span></span></a><span class="mpre">
data </span><a name="loc_75_6_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_19&#39;)"><span class="hl_tycondecl"><span class="mpre">DominatorTree</span></span></a><span class="mpre"> = </span><a name="loc_75_22_75_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_22_75_31&#39;)"><span class="hl_condecl"><span class="mpre">Dominates</span></span></a><span class="mpre"> </span><a href="#loc_74_6_74_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_6_74_19&#39;)"><span class="hl_tyconref"><span class="mpre">DominatorNode</span></span></a><span class="mpre"> [</span><a href="#loc_75_6_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_19&#39;)"><span class="hl_tyconref"><span class="mpre">DominatorTree</span></span></a><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">-- ^ This data structure is a *rose tree* in which each node may have</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  arbitrarily many children.  Each node dominates all its descendants.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Map from a FactBase for dominator lists into a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- dominator tree.  </span></span><span class="mpre">
</span><a href="#loc_82_1_82_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_5&#39;)"><span class="mpre">tree</span></a><span class="mpre"> :: [(</span><a href="Compiler.Hoopl.Label.html#loc_25_9_25_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_25_9_25_14&#39;)"><span class="hl_tyconref"><span class="mpre">Label</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Doms</span></span><span class="mpre">)] -&gt; </span><a href="#loc_75_6_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_19&#39;)"><span class="hl_tyconref"><span class="mpre">DominatorTree</span></span></a><span class="mpre">
</span><a name="loc_82_1_82_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_5&#39;)"><span class="hl_fundecl"><span class="mpre">tree</span></span></a><span class="mpre"> </span><a name="loc_82_6_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_11&#39;)"><span class="hl_vardecl"><span class="mpre">facts</span></span></a><span class="mpre"> = </span><a href="#loc_75_22_75_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_22_75_31&#39;)"><span class="hl_conref"><span class="mpre">Dominates</span></span></a><span class="mpre"> </span><a href="#loc_74_22_74_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_22_74_27&#39;)"><span class="hl_conref"><span class="mpre">Entry</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_88_9_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_9_88_14&#39;)"><span class="hl_varref"><span class="mpre">merge</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_97_9_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_15&#39;)"><span class="hl_varref"><span class="mpre">mkList</span></span></a><span class="mpre"> </span><a href="#loc_82_6_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_11&#39;)"><span class="hl_varref"><span class="mpre">facts</span></span></a><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- This code has been lightly tested.  The key insight is this: to</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- find lists that all have the same head, convert from a list of</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- lists to a finite map, in &#39;children&#39;.  Then, to convert from the</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- finite map to list of dominator trees, use the invariant that</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- each key dominates all the lists of values.</span></span><span class="mpre">
  where </span><a name="loc_88_9_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_9_88_14&#39;)"><span class="hl_fundecl"><span class="mpre">merge</span></span></a><span class="mpre"> </span><a name="loc_88_15_88_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_15_88_20&#39;)"><span class="hl_vardecl"><span class="mpre">lists</span></span></a><span class="mpre"> = </span><a href="#loc_95_9_95_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_16&#39;)"><span class="hl_varref"><span class="mpre">mapTree</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_89_9_89_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_9_89_17&#39;)"><span class="hl_varref"><span class="mpre">children</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre">) </span><a href="#loc_88_15_88_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_15_88_20&#39;)"><span class="hl_varref"><span class="mpre">lists</span></span></a><span class="mpre">
        </span><a name="loc_89_9_89_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_9_89_17&#39;)"><span class="hl_vardecl"><span class="mpre">children</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> </span><a href="#loc_91_9_91_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_9_91_16&#39;)"><span class="hl_varref"><span class="mpre">addList</span></span></a><span class="mpre"> </span><a href="Compiler.Hoopl.Label.html#loc_108_1_108_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_108_1_108_8&#39;)"><span class="hl_varref"><span class="mpre">noFacts</span></span></a><span class="mpre">
        </span><a href="#loc_91_9_91_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_9_91_16&#39;)"><span class="mpre">addList</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FactBase</span></span><span class="mpre"> [[</span><a href="Compiler.Hoopl.Label.html#loc_25_9_25_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_25_9_25_14&#39;)"><span class="hl_tyconref"><span class="mpre">Label</span></span></a><span class="mpre">]] -&gt; [</span><a href="Compiler.Hoopl.Label.html#loc_25_9_25_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_25_9_25_14&#39;)"><span class="hl_tyconref"><span class="mpre">Label</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">FactBase</span></span><span class="mpre"> [[</span><a href="Compiler.Hoopl.Label.html#loc_25_9_25_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_25_9_25_14&#39;)"><span class="hl_tyconref"><span class="mpre">Label</span></span></a><span class="mpre">]]
        </span><a name="loc_91_9_91_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_9_91_16&#39;)"><span class="hl_fundecl"><span class="mpre">addList</span></span></a><span class="mpre"> </span><a name="loc_91_17_91_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_17_91_20&#39;)"><span class="hl_vardecl"><span class="mpre">map</span></span></a><span class="mpre"> (</span><a name="loc_91_22_91_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_22_91_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_91_24_91_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_24_91_26&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="Compiler.Hoopl.Collections.html#loc_61_3_61_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Collections.html#loc_61_3_61_12&#39;)"><span class="hl_varref"><span class="mpre">mapInsert</span></span></a><span class="mpre"> </span><a href="#loc_91_22_91_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_22_91_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><a href="#loc_91_24_91_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_24_91_26&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_92_19_92_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_27&#39;)"><span class="hl_varref"><span class="mpre">existing</span></span></a><span class="mpre">) </span><a href="#loc_91_17_91_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_17_91_20&#39;)"><span class="hl_varref"><span class="mpre">map</span></span></a><span class="mpre">
            where </span><a name="loc_92_19_92_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_27&#39;)"><span class="hl_vardecl"><span class="mpre">existing</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> [] </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Compiler.Hoopl.Label.html#loc_111_1_111_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_111_1_111_11&#39;)"><span class="hl_varref"><span class="mpre">lookupFact</span></span></a><span class="mpre"> </span><a href="#loc_91_22_91_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_22_91_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_91_17_91_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_17_91_20&#39;)"><span class="hl_varref"><span class="mpre">map</span></span></a><span class="mpre">
        </span><a href="#loc_91_9_91_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_9_91_16&#39;)"><span class="hl_fundecl"><span class="mpre">addList</span></span></a><span class="mpre"> _ [] = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;this can&#39;t happen&quot;</span></span><span class="mpre">
        </span><a href="#loc_95_9_95_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_16&#39;)"><span class="mpre">mapTree</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FactBase</span></span><span class="mpre"> [[</span><a href="Compiler.Hoopl.Label.html#loc_25_9_25_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_25_9_25_14&#39;)"><span class="hl_tyconref"><span class="mpre">Label</span></span></a><span class="mpre">]] -&gt; [</span><a href="#loc_75_6_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_19&#39;)"><span class="hl_tyconref"><span class="mpre">DominatorTree</span></span></a><span class="mpre">]
        </span><a name="loc_95_9_95_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_16&#39;)"><span class="hl_fundecl"><span class="mpre">mapTree</span></span></a><span class="mpre"> </span><a name="loc_95_17_95_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_17_95_20&#39;)"><span class="hl_vardecl"><span class="mpre">map</span></span></a><span class="mpre"> = [</span><a href="#loc_75_22_75_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_22_75_31&#39;)"><span class="hl_conref"><span class="mpre">Dominates</span></span></a><span class="mpre"> (</span><a href="#loc_74_30_74_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_30_74_38&#39;)"><span class="hl_conref"><span class="mpre">Labelled</span></span></a><span class="mpre"> </span><a href="#loc_96_54_96_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_54_96_55&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><a href="#loc_88_9_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_9_88_14&#39;)"><span class="hl_varref"><span class="mpre">merge</span></span></a><span class="mpre"> </span><a href="#loc_96_57_96_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_57_96_62&#39;)"><span class="hl_varref"><span class="mpre">lists</span></span></a><span class="mpre">) |
                                                    (</span><a name="loc_96_54_96_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_54_96_55&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_96_57_96_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_57_96_62&#39;)"><span class="hl_vardecl"><span class="mpre">lists</span></span></a><span class="mpre">) &lt;- </span><a href="Compiler.Hoopl.Collections.html#loc_79_3_79_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Collections.html#loc_79_3_79_12&#39;)"><span class="hl_varref"><span class="mpre">mapToList</span></span></a><span class="mpre"> </span><a href="#loc_95_17_95_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_17_95_20&#39;)"><span class="hl_varref"><span class="mpre">map</span></span></a><span class="mpre">]
        </span><a name="loc_97_9_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_15&#39;)"><span class="hl_fundecl"><span class="mpre">mkList</span></span></a><span class="mpre"> (</span><a name="loc_97_17_97_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_17_97_18&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">, </span><a name="loc_97_20_97_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_20_97_24&#39;)"><span class="hl_vardecl"><span class="mpre">doms</span></span></a><span class="mpre">) = </span><a href="#loc_97_17_97_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_17_97_18&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_38_1_38_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_8&#39;)"><span class="hl_varref"><span class="mpre">domPath</span></span></a><span class="mpre"> </span><a href="#loc_97_20_97_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_20_97_24&#39;)"><span class="hl_varref"><span class="mpre">doms</span></span></a><span class="mpre">


instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_75_6_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_19&#39;)"><span class="hl_tyconref"><span class="mpre">DominatorTree</span></span></a><span class="mpre"> where
  </span><span class="hl_vardecl"><span class="mpre">show</span></span><span class="mpre"> = </span><a href="#loc_109_1_109_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_9&#39;)"><span class="hl_varref"><span class="mpre">tree2dot</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Given a dominator tree, produce a string representation, in the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- input language of dot, that will enable dot to produce a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- visualization of the tree.  For more info about dot see</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- http://www.graphviz.org.</span></span><span class="mpre">

</span><a href="#loc_109_1_109_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_9&#39;)"><span class="mpre">tree2dot</span></a><span class="mpre"> :: </span><a href="#loc_75_6_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_19&#39;)"><span class="hl_tyconref"><span class="mpre">DominatorTree</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_109_1_109_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_9&#39;)"><span class="hl_fundecl"><span class="mpre">tree2dot</span></span></a><span class="mpre"> </span><a name="loc_109_10_109_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_10_109_11&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;digraph {\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_112_5_112_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_5_112_8&#39;)"><span class="hl_varref"><span class="mpre">dot</span></span></a><span class="mpre"> </span><a href="#loc_109_10_109_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_10_109_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;}\n&quot;</span></span><span class="mpre">]
  where
    </span><a href="#loc_112_5_112_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_5_112_8&#39;)"><span class="mpre">dot</span></a><span class="mpre"> :: </span><a href="#loc_75_6_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_19&#39;)"><span class="hl_tyconref"><span class="mpre">DominatorTree</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
    </span><a name="loc_112_5_112_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_5_112_8&#39;)"><span class="hl_fundecl"><span class="mpre">dot</span></span></a><span class="mpre"> (</span><a href="#loc_75_22_75_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_22_75_31&#39;)"><span class="hl_conref"><span class="mpre">Dominates</span></span></a><span class="mpre"> </span><a name="loc_112_20_112_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_20_112_24&#39;)"><span class="hl_vardecl"><span class="mpre">root</span></span></a><span class="mpre"> </span><a name="loc_112_25_112_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_25_112_30&#39;)"><span class="hl_vardecl"><span class="mpre">trees</span></span></a><span class="mpre">) = 
                   (</span><a href="#loc_117_13_117_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_13_117_20&#39;)"><span class="hl_varref"><span class="mpre">dotnode</span></span></a><span class="mpre"> </span><a href="#loc_112_20_112_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_20_112_24&#39;)"><span class="hl_varref"><span class="mpre">root</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_114_13_114_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_13_114_21&#39;)"><span class="hl_varref"><span class="mpre">outedges</span></span></a><span class="mpre"> </span><a href="#loc_112_25_112_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_25_112_30&#39;)"><span class="hl_varref"><span class="mpre">trees</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> </span><a href="#loc_119_13_119_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_13_119_20&#39;)"><span class="hl_varref"><span class="mpre">subtree</span></span></a><span class="mpre">) </span><a href="#loc_112_25_112_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_25_112_30&#39;)"><span class="hl_varref"><span class="mpre">trees</span></span></a><span class="mpre">
      where </span><a name="loc_114_13_114_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_13_114_21&#39;)"><span class="hl_fundecl"><span class="mpre">outedges</span></span></a><span class="mpre"> [] = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
            </span><a href="#loc_114_13_114_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_13_114_21&#39;)"><span class="hl_fundecl"><span class="mpre">outedges</span></span></a><span class="mpre"> (</span><a href="#loc_75_22_75_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_22_75_31&#39;)"><span class="hl_conref"><span class="mpre">Dominates</span></span></a><span class="mpre"> </span><a name="loc_115_33_115_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_33_115_34&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_115_39_115_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_39_115_41&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">) =
                \</span><a name="loc_116_18_116_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_18_116_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_string"><span class="mpre">&quot;  &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_112_20_112_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_20_112_24&#39;)"><span class="hl_varref"><span class="mpre">root</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; -&gt; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_115_33_115_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_33_115_34&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_114_13_114_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_13_114_21&#39;)"><span class="hl_varref"><span class="mpre">outedges</span></span></a><span class="mpre"> </span><a href="#loc_115_39_115_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_39_115_41&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre"> </span><a href="#loc_116_18_116_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_18_116_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
            </span><a name="loc_117_13_117_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_13_117_20&#39;)"><span class="hl_fundecl"><span class="mpre">dotnode</span></span></a><span class="mpre"> </span><a href="#loc_74_22_74_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_22_74_27&#39;)"><span class="hl_conref"><span class="mpre">Entry</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;  entryNode [shape=plaintext, label=\&quot;entry\&quot;]\n&quot;</span></span><span class="mpre">
            </span><a href="#loc_117_13_117_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_13_117_20&#39;)"><span class="hl_fundecl"><span class="mpre">dotnode</span></span></a><span class="mpre"> (</span><a href="#loc_74_30_74_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_30_74_38&#39;)"><span class="hl_conref"><span class="mpre">Labelled</span></span></a><span class="mpre"> </span><a name="loc_118_31_118_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_31_118_32&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = </span><span class="hl_string"><span class="mpre">&quot;  &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_118_31_118_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_31_118_32&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">
            </span><a name="loc_119_13_119_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_13_119_20&#39;)"><span class="hl_vardecl"><span class="mpre">subtree</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="#loc_112_5_112_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_5_112_8&#39;)"><span class="hl_varref"><span class="mpre">dot</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_74_6_74_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_6_74_19&#39;)"><span class="hl_tyconref"><span class="mpre">DominatorNode</span></span></a><span class="mpre"> where
  </span><a name="loc_122_3_122_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_3_122_7&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> </span><a href="#loc_74_22_74_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_22_74_27&#39;)"><span class="hl_conref"><span class="mpre">Entry</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;entryNode&quot;</span></span><span class="mpre">
  </span><a href="#loc_122_3_122_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_3_122_7&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> (</span><a href="#loc_74_30_74_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_30_74_38&#39;)"><span class="hl_conref"><span class="mpre">Labelled</span></span></a><span class="mpre"> </span><a name="loc_123_18_123_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_18_123_19&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_123_18_123_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_18_123_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Takes FactBase from dominator analysis and returns a map from each </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- label to its immediate dominator, if any</span></span><span class="mpre">
</span><a href="#loc_130_1_130_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_20&#39;)"><span class="mpre">immediateDominators</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FactBase</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Doms</span></span><span class="mpre"> -&gt; </span><a href="Compiler.Hoopl.Label.html#loc_67_9_67_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_67_9_67_17&#39;)"><span class="hl_tyconref"><span class="mpre">LabelMap</span></span></a><span class="mpre"> </span><a href="Compiler.Hoopl.Label.html#loc_25_9_25_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Label.html#loc_25_9_25_14&#39;)"><span class="hl_tyconref"><span class="mpre">Label</span></span></a><span class="mpre">
</span><a name="loc_130_1_130_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_20&#39;)"><span class="hl_vardecl"><span class="mpre">immediateDominators</span></span></a><span class="mpre"> = </span><a href="Compiler.Hoopl.Collections.html#loc_74_3_74_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Collections.html#loc_74_3_74_17&#39;)"><span class="hl_varref"><span class="mpre">mapFoldWithKey</span></span></a><span class="mpre"> </span><a href="#loc_131_11_131_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_11_131_14&#39;)"><span class="hl_varref"><span class="mpre">add</span></span></a><span class="mpre"> </span><a href="Compiler.Hoopl.Collections.html#loc_59_3_59_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Collections.html#loc_59_3_59_11&#39;)"><span class="hl_varref"><span class="mpre">mapEmpty</span></span></a><span class="mpre">
    where </span><a name="loc_131_11_131_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_11_131_14&#39;)"><span class="hl_fundecl"><span class="mpre">add</span></span></a><span class="mpre"> </span><a name="loc_131_15_131_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_15_131_16&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">PElem</span></span><span class="mpre"> (</span><a href="#loc_29_17_29_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_22&#39;)"><span class="hl_conref"><span class="mpre">DPath</span></span></a><span class="mpre"> (</span><a name="loc_131_32_131_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_32_131_36&#39;)"><span class="hl_vardecl"><span class="mpre">idom</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_))) = </span><a href="Compiler.Hoopl.Collections.html#loc_61_3_61_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Compiler.Hoopl.Collections.html#loc_61_3_61_12&#39;)"><span class="hl_varref"><span class="mpre">mapInsert</span></span></a><span class="mpre"> </span><a href="#loc_131_15_131_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_15_131_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_131_32_131_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_32_131_36&#39;)"><span class="hl_varref"><span class="mpre">idom</span></span></a><span class="mpre"> 
          </span><a href="#loc_131_11_131_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_11_131_14&#39;)"><span class="hl_fundecl"><span class="mpre">add</span></span></a><span class="mpre"> _ _ = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">

</span></div></body></html>