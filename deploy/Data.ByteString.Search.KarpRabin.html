<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module         : Data.ByteString.Search.KarpRabin</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright      : (c) 2010 Daniel Fischer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Licence        : BSD3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer     : Daniel Fischer &lt;daniel.is.fischer@googlemail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability      : Provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability    : non-portable (BangPatterns)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Simultaneous search for multiple patterns in a strict &#39;S.ByteString&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- using the Karp-Rabin algorithm.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A description of the algorithm for a single pattern can be found at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://www-igm.univ-mlv.fr/~lecroq/string/node5.html#SECTION0050&gt;.</span></span><span class="mpre">
module Data.ByteString.Search.KarpRabin ( </span><span class="hl_comment"><span class="mpre">-- * Overview</span></span><span class="mpre">
                                          </span><span class="hl_comment"><span class="mpre">-- $overview</span></span><span class="mpre">

                                          </span><span class="hl_comment"><span class="mpre">-- ** Caution</span></span><span class="mpre">
                                          </span><span class="hl_comment"><span class="mpre">-- $caution</span></span><span class="mpre">

                                          </span><span class="hl_comment"><span class="mpre">-- * Function</span></span><span class="mpre">
                                          indicesOfAny
                                        ) where

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/KarpRabin.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 18, srcSpanEndLine = 25, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import Data.ByteString.Unsafe (</span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="mpre">unsafeIndex</span></a><span class="mpre">)

import qualified Data.IntMap as IM

import Data.Array
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/KarpRabin.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 8, srcSpanEndLine = 31, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.Array.Base&quot;"><span class="mpre">Data.Array.Base</span></span><span class="mpre"> (unsafeAt)

import Data.Word (Word8)
import Data.Bits
import Data.List (</span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="mpre">foldl&#39;</span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- $overview</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The Karp-Rabin algorithm works by calculating a hash of the pattern and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- comparing that hash with the hash of a slice of the target string with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the same length as the pattern. If the hashes are equal, the slice of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- target is compared to the pattern byte for byte (since the hash</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- function generally isn&#39;t injective).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For a single pattern, this tends to be more efficient than the na&amp;#239;ve</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- algorithm, but it cannot compete with algorithms like</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Knuth-Morris-Pratt or Boyer-Moore.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- However, the algorithm can be generalised to search for multiple patterns</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- simultaneously. If the shortest pattern has length @k@, hash the prefix of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- length @k@ of all patterns and compare the hash of the target&#39;s slices of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- length @k@ to them. If there&#39;s a match, check whether the slice is part</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of an occurrence of the corresponding pattern.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- With a hash-function that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   * allows to compute the hash of one slice in constant time from the hash</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     of the previous slice, the new and the dropped character, and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   * produces few spurious matches,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- searching for occurrences of any of @n@ patterns has a best-case complexity</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of /O/(@targetLength@ * @lookup n@). The worst-case complexity is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /O/(@targetLength@ * @lookup n@ * @sum patternLengths@), the average is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- not much worse than the best case.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The functions in this module store the hashes of the patterns in an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;IM.IntMap&#39;, so the lookup is /O/(@log n@). Re-hashing is done in constant</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- time and spurious matches of the hashes /should be/ sufficiently rare.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The maximal length of the prefixes to be hashed is 32.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- $caution</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Unfortunately, the constant factors are high, so these functions are slow.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Unless the number of patterns to search for is high (larger than 50 at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- least), repeated search for single patterns using Boyer-Moore or DFA and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- manual merging of the indices is faster. /Much/ faster for less than 40</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- or so patterns.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In summary, this module is more of an interesting curiosity than anything</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- else.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;indicesOfAny&#39;@ finds all occurrences of any of several non-empty patterns</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   in a strict target string. If no non-empty patterns are given,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   the result is an empty list. Otherwise the result list contains</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   the pairs of all indices where any of the (non-empty) patterns start</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   and the list of all patterns starting at that index, the patterns being</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   represented by their (zero-based) position in the pattern list.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Empty patterns are filtered out before processing begins.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_95_1_95_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_13&#39;)"><span class="mpre">indicesOfAny</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_95_1_95_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_13&#39;)"><span class="mpre">indicesOfAny</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]  </span><span class="hl_comment"><span class="mpre">-- ^ List of non-empty patterns</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ String to search</span></span><span class="mpre">
             -&gt; [(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">])]   </span><span class="hl_comment"><span class="mpre">-- ^ List of matches</span></span><span class="mpre">
</span><a name="loc_95_1_95_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_13&#39;)"><span class="hl_fundecl"><span class="mpre">indicesOfAny</span></span></a><span class="mpre"> </span><a name="loc_95_14_95_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_14_95_18&#39;)"><span class="hl_vardecl"><span class="mpre">pats</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_99_9_99_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_15&#39;)"><span class="hl_varref"><span class="mpre">nepats</span></span></a><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> []
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><a href="#loc_127_1_127_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_14&#39;)"><span class="hl_varref"><span class="mpre">strictMatcher</span></span></a><span class="mpre"> </span><a href="#loc_99_9_99_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_15&#39;)"><span class="hl_varref"><span class="mpre">nepats</span></span></a><span class="mpre">
      where
        </span><a name="loc_99_9_99_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_15&#39;)"><span class="hl_vardecl"><span class="mpre">nepats</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre">) </span><a href="#loc_95_14_95_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_14_95_18&#39;)"><span class="hl_varref"><span class="mpre">pats</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                 Workers                                 --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_108_1_108_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_8&#39;)"><span class="mpre">rehash1</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_108_1_108_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_8&#39;)"><span class="mpre">rehash1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_108_1_108_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_8&#39;)"><span class="hl_fundecl"><span class="mpre">rehash1</span></span></a><span class="mpre"> </span><a name="loc_108_9_108_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_12&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> </span><a name="loc_108_13_108_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_13_108_14&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_108_15_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_15_108_16&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_108_17_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
    (</span><a href="#loc_108_13_108_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_13_108_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_108_15_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_15_108_16&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><a href="#loc_108_9_108_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_108_17_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_113_1_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_8&#39;)"><span class="mpre">rehash2</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_113_1_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_8&#39;)"><span class="mpre">rehash2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_113_1_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_8&#39;)"><span class="hl_fundecl"><span class="mpre">rehash2</span></span></a><span class="mpre"> </span><a name="loc_113_9_113_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_12&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> </span><a name="loc_113_13_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_13_113_14&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_113_15_113_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_15_113_16&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_113_17_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
    (</span><a href="#loc_113_13_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_13_113_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_113_15_113_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_15_113_16&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><a href="#loc_113_9_113_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_113_17_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_118_1_118_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_8&#39;)"><span class="mpre">rehash3</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_118_1_118_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_8&#39;)"><span class="mpre">rehash3</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_118_1_118_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_8&#39;)"><span class="hl_fundecl"><span class="mpre">rehash3</span></span></a><span class="mpre"> </span><a name="loc_118_9_118_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_12&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> </span><a name="loc_118_13_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_13_118_14&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_118_15_118_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_15_118_16&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_118_17_118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_17_118_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
    (</span><a href="#loc_118_13_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_13_118_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_118_15_118_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_15_118_16&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><a href="#loc_118_9_118_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_118_17_118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_17_118_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_123_1_123_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_8&#39;)"><span class="mpre">rehash4</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_123_1_123_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_8&#39;)"><span class="mpre">rehash4</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_123_1_123_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_8&#39;)"><span class="hl_fundecl"><span class="mpre">rehash4</span></span></a><span class="mpre"> </span><a name="loc_123_9_123_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_9_123_12&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> </span><a name="loc_123_13_123_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_14&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_123_15_123_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_15_123_16&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_123_17_123_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_17_123_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
    (</span><a href="#loc_123_13_123_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_123_15_123_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_15_123_16&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><a href="#loc_123_9_123_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_9_123_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_123_17_123_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_17_123_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><a href="#loc_127_1_127_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_14&#39;)"><span class="mpre">strictMatcher</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">])]
</span><a name="loc_127_1_127_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_14&#39;)"><span class="hl_fundecl"><span class="mpre">strictMatcher</span></span></a><span class="mpre"> </span><a name="loc_127_15_127_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_15_127_19&#39;)"><span class="hl_vardecl"><span class="mpre">pats</span></span></a><span class="mpre"> = </span><a href="#loc_148_5_148_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_5_148_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre">
  where
    !</span><a name="loc_129_6_129_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_6_129_10&#39;)"><span class="hl_vardecl"><span class="mpre">hLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">minimum</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_127_15_127_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_15_127_19&#39;)"><span class="hl_varref"><span class="mpre">pats</span></span></a><span class="mpre">)
    !</span><a name="loc_130_6_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_6_130_10&#39;)"><span class="hl_vardecl"><span class="mpre">shDi</span></span></a><span class="mpre"> = case </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quot`</span></span><span class="mpre"> </span><a href="#loc_129_6_129_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_6_129_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre"> of
              </span><a name="loc_131_15_131_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_15_131_16&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> | </span><a href="#loc_131_15_131_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_15_131_16&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> -&gt; </span><a href="#loc_131_15_131_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_15_131_16&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">
    !</span><a name="loc_133_6_133_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_6_133_10&#39;)"><span class="hl_vardecl"><span class="mpre">outS</span></span></a><span class="mpre"> = </span><a href="#loc_130_6_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_6_130_10&#39;)"><span class="hl_varref"><span class="mpre">shDi</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_129_6_129_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_6_129_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">
    !</span><a name="loc_134_6_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_12&#39;)"><span class="hl_vardecl"><span class="mpre">patNum</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_127_15_127_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_15_127_19&#39;)"><span class="hl_varref"><span class="mpre">pats</span></span></a><span class="mpre">
    !</span><a name="loc_135_6_135_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_6_135_12&#39;)"><span class="hl_vardecl"><span class="mpre">patArr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">listArray</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><a href="#loc_134_6_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_12&#39;)"><span class="hl_varref"><span class="mpre">patNum</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_127_15_127_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_15_127_19&#39;)"><span class="hl_varref"><span class="mpre">pats</span></span></a><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_138_5_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_11&#39;)"><span class="mpre">rehash</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a href="#loc_138_5_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_11&#39;)"><span class="mpre">rehash</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    </span><a name="loc_138_5_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_11&#39;)"><span class="hl_vardecl"><span class="mpre">rehash</span></span></a><span class="mpre"> = case </span><a href="#loc_130_6_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_6_130_10&#39;)"><span class="hl_varref"><span class="mpre">shDi</span></span></a><span class="mpre"> of
                </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> -&gt; </span><a href="#loc_108_1_108_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_8&#39;)"><span class="hl_varref"><span class="mpre">rehash1</span></span></a><span class="mpre"> </span><a href="#loc_129_6_129_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_6_129_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">
                </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> -&gt; </span><a href="#loc_113_1_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_8&#39;)"><span class="hl_varref"><span class="mpre">rehash2</span></span></a><span class="mpre"> </span><a href="#loc_133_6_133_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_6_133_10&#39;)"><span class="hl_varref"><span class="mpre">outS</span></span></a><span class="mpre">
                </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> -&gt; </span><a href="#loc_118_1_118_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_8&#39;)"><span class="hl_varref"><span class="mpre">rehash3</span></span></a><span class="mpre"> </span><a href="#loc_133_6_133_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_6_133_10&#39;)"><span class="hl_varref"><span class="mpre">outS</span></span></a><span class="mpre">
                _ -&gt; </span><a href="#loc_123_1_123_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_8&#39;)"><span class="hl_varref"><span class="mpre">rehash4</span></span></a><span class="mpre"> </span><a href="#loc_133_6_133_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_6_133_10&#39;)"><span class="hl_varref"><span class="mpre">outS</span></span></a><span class="mpre">
    </span><a href="#loc_144_5_144_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_5_144_9&#39;)"><span class="mpre">hash</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    </span><a name="loc_144_5_144_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_5_144_9&#39;)"><span class="hl_vardecl"><span class="mpre">hash</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.foldl&#39;</span></span><span class="mpre"> (\</span><a name="loc_144_23_144_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_23_144_24&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_144_25_144_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_25_144_26&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_144_23_144_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_23_144_24&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><a href="#loc_130_6_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_6_130_10&#39;)"><span class="hl_varref"><span class="mpre">shDi</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_144_25_144_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_25_144_26&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_129_6_129_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_6_129_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">
    !</span><a name="loc_145_6_145_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_13&#39;)"><span class="hl_vardecl"><span class="mpre">hashMap</span></span></a><span class="mpre"> =
        </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> (\</span><a name="loc_146_18_146_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_20&#39;)"><span class="hl_vardecl"><span class="mpre">mp</span></span></a><span class="mpre"> (</span><a name="loc_146_22_146_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_22_146_23&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">,</span><a name="loc_146_24_146_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_24_146_25&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">IM.insertWith</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(++)</span></span><span class="mpre">) </span><a href="#loc_146_22_146_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_22_146_23&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> [</span><a href="#loc_146_24_146_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_24_146_25&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">] </span><a href="#loc_146_18_146_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_18_146_20&#39;)"><span class="hl_varref"><span class="mpre">mp</span></span></a><span class="mpre">) </span><span class="hl_varref"><span class="mpre">IM.empty</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                </span><span class="hl_varref"><span class="mpre">zip</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_144_5_144_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_5_144_9&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_127_15_127_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_15_127_19&#39;)"><span class="hl_varref"><span class="mpre">pats</span></span></a><span class="mpre">) </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/KarpRabin.hs&quot;, srcSpanStartLine = 147, srcSpanStartColumn = 53, srcSpanEndLine = 147, srcSpanEndColumn = 67}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/KarpRabin.hs&quot;, srcSpanStartLine = 147, srcSpanStartColumn = 53, srcSpanEndLine = 147, srcSpanEndColumn = 54},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/strings"><span class="mpre">[0 :: Int .. ]</span></span><span class="mpre">
    </span><a name="loc_148_5_148_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_5_148_11&#39;)"><span class="hl_fundecl"><span class="mpre">search</span></span></a><span class="mpre"> </span><a name="loc_148_12_148_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_12_148_15&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">
        | </span><a href="#loc_152_14_152_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_14_152_20&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_129_6_129_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_6_129_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">   = []
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_157_13_157_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_13_157_15&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_156_14_156_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_14_156_19&#39;)"><span class="hl_varref"><span class="mpre">shash</span></span></a><span class="mpre">
          where
            !</span><a name="loc_152_14_152_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_14_152_20&#39;)"><span class="hl_vardecl"><span class="mpre">strLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_148_12_148_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_12_148_15&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
            !</span><a name="loc_153_14_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_14_153_20&#39;)"><span class="hl_vardecl"><span class="mpre">maxIdx</span></span></a><span class="mpre"> = </span><a href="#loc_152_14_152_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_14_152_20&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_129_6_129_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_6_129_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">
            </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_155_13_155_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_13_155_18&#39;)"><span class="mpre">strAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
            </span><a name="loc_155_13_155_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_13_155_18&#39;)"><span class="hl_fundecl"><span class="mpre">strAt</span></span></a><span class="mpre"> !</span><a name="loc_155_20_155_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_20_155_21&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_148_12_148_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_12_148_15&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_155_20_155_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_20_155_21&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
            !</span><a name="loc_156_14_156_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_14_156_19&#39;)"><span class="hl_vardecl"><span class="mpre">shash</span></span></a><span class="mpre"> = </span><a href="#loc_144_5_144_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_5_144_9&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_148_12_148_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_12_148_15&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
            </span><a name="loc_157_13_157_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_13_157_15&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_157_17_157_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_17_157_19&#39;)"><span class="hl_vardecl"><span class="mpre">sI</span></span></a><span class="mpre"> !</span><a name="loc_157_21_157_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_21_157_22&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> =
              case </span><span class="hl_varref"><span class="mpre">IM.lookup</span></span><span class="mpre"> </span><a href="#loc_157_21_157_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_21_157_22&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_145_6_145_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_13&#39;)"><span class="hl_varref"><span class="mpre">hashMap</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt;
                  if </span><a href="#loc_157_17_157_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_17_157_19&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_153_14_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_14_153_20&#39;)"><span class="hl_varref"><span class="mpre">maxIdx</span></span></a><span class="mpre">
                    then []
                    else </span><a href="#loc_157_13_157_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_13_157_15&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_157_17_157_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_17_157_19&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_138_5_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_11&#39;)"><span class="hl_varref"><span class="mpre">rehash</span></span></a><span class="mpre"> </span><a href="#loc_157_21_157_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_21_157_22&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> (</span><a href="#loc_155_13_155_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_13_155_18&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_157_17_157_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_17_157_19&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre">) (</span><a href="#loc_155_13_155_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_13_155_18&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> (</span><a href="#loc_157_17_157_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_17_157_19&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_129_6_129_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_6_129_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">)))
                </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_163_22_163_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_22_163_24&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> -&gt;
                  let !</span><a name="loc_164_24_164_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_24_164_27&#39;)"><span class="hl_vardecl"><span class="mpre">rst</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_157_17_157_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_17_157_19&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><a href="#loc_148_12_148_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_12_148_15&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
                      </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_166_23_166_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_23_166_25&#39;)"><span class="mpre">hd</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                      </span><a name="loc_166_23_166_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_23_166_25&#39;)"><span class="hl_vardecl"><span class="mpre">hd</span></span></a><span class="mpre">  = </span><a href="#loc_155_13_155_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_13_155_18&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_157_17_157_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_17_157_19&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre">
                      </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_168_23_168_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_23_168_27&#39;)"><span class="mpre">more</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                      </span><a name="loc_168_23_168_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_23_168_27&#39;)"><span class="hl_vardecl"><span class="mpre">more</span></span></a><span class="mpre"> = if </span><a href="#loc_157_17_157_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_17_157_19&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_153_14_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_14_153_20&#39;)"><span class="hl_varref"><span class="mpre">maxIdx</span></span></a><span class="mpre"> then [] else
                                </span><a href="#loc_157_13_157_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_13_157_15&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_157_17_157_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_17_157_19&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_138_5_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_11&#39;)"><span class="hl_varref"><span class="mpre">rehash</span></span></a><span class="mpre"> </span><a href="#loc_157_21_157_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_21_157_22&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_166_23_166_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_23_166_25&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre"> (</span><a href="#loc_155_13_155_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_13_155_18&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> (</span><a href="#loc_157_17_157_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_17_157_19&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_129_6_129_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_6_129_10&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">)))
                      </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_171_23_171_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_23_171_27&#39;)"><span class="mpre">okay</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                      </span><a name="loc_171_23_171_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_23_171_27&#39;)"><span class="hl_fundecl"><span class="mpre">okay</span></span></a><span class="mpre"> </span><a name="loc_171_28_171_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_28_171_30&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.isPrefixOf</span></span><span class="mpre"> </span><a href="#loc_171_28_171_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_28_171_30&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_164_24_164_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_24_164_27&#39;)"><span class="hl_varref"><span class="mpre">rst</span></span></a><span class="mpre">
                  in case </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><a href="#loc_171_23_171_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_23_171_27&#39;)"><span class="hl_varref"><span class="mpre">okay</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_135_6_135_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_6_135_12&#39;)"><span class="hl_varref"><span class="mpre">patArr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`unsafeAt`</span></span><span class="mpre">)) </span><a href="#loc_163_22_163_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_22_163_24&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> of
                           [] -&gt; </span><a href="#loc_168_23_168_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_23_168_27&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre">
                           </span><a name="loc_174_28_174_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_28_174_30&#39;)"><span class="hl_vardecl"><span class="mpre">qs</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">seq</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_174_28_174_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_28_174_30&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                (</span><a href="#loc_157_17_157_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_17_157_19&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre">,</span><a href="#loc_174_28_174_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_28_174_30&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_168_23_168_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_23_168_27&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre">
</span></div></body></html>