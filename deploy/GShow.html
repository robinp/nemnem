<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS -fglasgow-exts #-}
 
module GShow (tests) where

</span><span class="hl_comment"><span class="mpre">{-
 
The generic show example from the 2nd boilerplate paper.
(There were some typos in the ICFP 2004 paper.)
Also check out Data.Generics.Text.
 
-}</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/GShow.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 8, srcSpanEndLine = 13, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">

import Data.Generics hiding (</span><a href="Data.Generics.Text.html#loc_43_1_43_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Text.html#loc_43_1_43_6&#39;)"><span class="mpre">gshow</span></a><span class="mpre">)
import Prelude hiding (showString)

 
</span><a href="#loc_20_1_20_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_6&#39;)"><span class="mpre">gshow</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/GShow.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 10, srcSpanEndLine = 19, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/GShow.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 17, srcSpanEndLine = 19, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/GShow.hs&quot;, srcSpanSt"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_20_1_20_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_6&#39;)"><span class="hl_vardecl"><span class="mpre">gshow</span></span></a><span class="mpre"> = </span><a href="#loc_23_1_23_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_11&#39;)"><span class="hl_varref"><span class="mpre">gshow_help</span></span></a><span class="mpre"> </span><a href="Data.Generics.Aliases.html#loc_177_1_177_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_177_1_177_5&#39;)"><span class="hl_infix"><span class="mpre">`extQ`</span></span></a><span class="mpre"> </span><a href="#loc_30_1_30_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_11&#39;)"><span class="hl_varref"><span class="mpre">showString</span></span></a><span class="mpre">

</span><a href="#loc_23_1_23_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_11&#39;)"><span class="mpre">gshow_help</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/GShow.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 15, srcSpanEndLine = 22, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/GShow.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 22, srcSpanEndLine = 22, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/GShow.hs&quot;, srcSpanSt"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_23_1_23_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_11&#39;)"><span class="hl_fundecl"><span class="mpre">gshow_help</span></span></a><span class="mpre"> </span><a name="loc_23_12_23_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_12_23_13&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> 
     =  </span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="mpre">
     </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showConstr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_23_12_23_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_12_23_13&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
     </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> (</span><a href="#loc_44_1_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_12&#39;)"><span class="hl_varref"><span class="mpre">intersperse</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> </span><a href="#loc_20_1_20_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_6&#39;)"><span class="hl_varref"><span class="mpre">gshow</span></span></a><span class="mpre"> </span><a href="#loc_23_12_23_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_12_23_13&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">))
     </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="mpre">

</span><a href="#loc_30_1_30_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_11&#39;)"><span class="mpre">showString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_30_1_30_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_11&#39;)"><span class="hl_fundecl"><span class="mpre">showString</span></span></a><span class="mpre"> </span><a name="loc_30_12_30_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_12_30_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;\&quot;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_32_18_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_18_32_24&#39;)"><span class="hl_varref"><span class="mpre">escape</span></span></a><span class="mpre"> </span><a href="#loc_30_12_30_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_12_30_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\&quot;&quot;</span></span><span class="mpre"> 
               where
                 </span><a name="loc_32_18_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_18_32_24&#39;)"><span class="hl_fundecl"><span class="mpre">escape</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;\\n&quot;</span></span><span class="mpre">
                 </span><a href="#loc_32_18_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_18_32_24&#39;)"><span class="hl_fundecl"><span class="mpre">escape</span></span></a><span class="mpre"> </span><a name="loc_33_25_33_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_25_33_35&#39;)"><span class="hl_vardecl"><span class="mpre">other_char</span></span></a><span class="mpre"> = [</span><a href="#loc_33_25_33_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_25_33_35&#39;)"><span class="hl_varref"><span class="mpre">other_char</span></span></a><span class="mpre">]

</span><a href="#loc_36_1_36_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_10&#39;)"><span class="mpre">gshowList</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/GShow.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 14, srcSpanEndLine = 35, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/GShow.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 21, srcSpanEndLine = 35, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/GShow.hs&quot;, srcSpanSt"><span class="mpre">Data b =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_36_1_36_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_10&#39;)"><span class="hl_fundecl"><span class="mpre">gshowList</span></span></a><span class="mpre"> </span><a name="loc_36_11_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_11_36_13&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">
    = </span><span class="hl_string"><span class="mpre">&quot;[&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> (</span><a href="#loc_44_1_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_12&#39;)"><span class="hl_varref"><span class="mpre">intersperse</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;,&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_20_1_20_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_6&#39;)"><span class="hl_varref"><span class="mpre">gshow</span></span></a><span class="mpre"> </span><a href="#loc_36_11_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_11_36_13&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;]&quot;</span></span><span class="mpre">

</span><a href="#loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="mpre">gshow&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/GShow.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 11, srcSpanEndLine = 39, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/GShow.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 18, srcSpanEndLine = 39, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/GShow.hs&quot;, srcSpanSt"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="hl_vardecl"><span class="mpre">gshow&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_23_1_23_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_11&#39;)"><span class="hl_varref"><span class="mpre">gshow_help</span></span></a><span class="mpre"> </span><a href="Data.Generics.Aliases.html#loc_350_1_350_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_350_1_350_6&#39;)"><span class="hl_infix"><span class="mpre">`ext1Q`</span></span></a><span class="mpre"> </span><a href="#loc_36_1_36_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_10&#39;)"><span class="hl_varref"><span class="mpre">gshowList</span></span></a><span class="mpre"> 
                    </span><a href="Data.Generics.Aliases.html#loc_177_1_177_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_177_1_177_5&#39;)"><span class="hl_infix"><span class="mpre">`extQ`</span></span></a><span class="mpre">  </span><a href="#loc_30_1_30_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_11&#39;)"><span class="hl_varref"><span class="mpre">showString</span></span></a><span class="mpre">

</span><a href="#loc_44_1_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_12&#39;)"><span class="mpre">intersperse</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_44_1_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_12&#39;)"><span class="hl_fundecl"><span class="mpre">intersperse</span></span></a><span class="mpre"> _ []     = []
</span><a href="#loc_44_1_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_12&#39;)"><span class="hl_fundecl"><span class="mpre">intersperse</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">x</span></span><span class="mpre"> [</span><a name="loc_45_16_45_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_16_45_17&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">]    = [</span><a href="#loc_45_16_45_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_16_45_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">]
</span><a href="#loc_44_1_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_12&#39;)"><span class="hl_fundecl"><span class="mpre">intersperse</span></span></a><span class="mpre"> </span><a name="loc_46_13_46_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_13_46_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> (</span><a name="loc_46_16_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_16_46_17&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_46_18_46_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_18_46_20&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">) = (</span><a href="#loc_46_16_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_16_46_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><a href="#loc_46_13_46_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_13_46_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_44_1_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_12&#39;)"><span class="hl_varref"><span class="mpre">intersperse</span></span></a><span class="mpre"> </span><a href="#loc_46_13_46_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_13_46_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_46_18_46_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_18_46_20&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">))

</span><a name="loc_48_1_48_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = ( </span><a href="#loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="hl_varref"><span class="mpre">gshow&#39;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">
        , </span><a href="#loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="hl_varref"><span class="mpre">gshow&#39;</span></span></a><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">]
        ) </span><span class="hl_infix"><span class="mpre">~=?</span></span><span class="mpre"> </span><a href="#loc_52_1_52_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_7&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">

</span><a name="loc_52_1_52_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_7&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = (</span><span class="hl_string"><span class="mpre">&quot;\&quot;foo\&quot;&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;[(True),(False)]&quot;</span></span><span class="mpre">)
</span></div></body></html>