<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
{-# LANGUAGE ForeignFunctionInterface #-}

</span><span class="hl_comment"><span class="mpre">{-|
This module makes the operations exported by @System.Posix.Unistd@
available on all platforms. On POSIX systems it re-exports operations from
@System.Posix.Unistd@, on other platforms it emulates the operations as far
as possible.
-}</span></span><span class="mpre">
module System.PosixCompat.Unistd (
    </span><span class="hl_comment"><span class="mpre">-- * System environment</span></span><span class="mpre">
      SystemID(..)
    , getSystemID
    </span><span class="hl_comment"><span class="mpre">-- * Sleeping</span></span><span class="mpre">
    , sleep
    , usleep
    , nanosleep
    ) where

#ifndef mingw32_HOST_OS

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/System/PosixCompat/Unistd.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 8, srcSpanEndLine = 22, srcSpanEndColumn = 27}, srcInfoPoints = []}) &quot;System.Posix.Unistd&quot;"><span class="mpre">System.Posix.Unistd</span></span><span class="mpre">

#else

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/System/PosixCompat/Unistd.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 8, srcSpanEndLine = 26, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;Control.Concurrent&quot;"><span class="mpre">Control.Concurrent</span></span><span class="mpre"> (threadDelay)
import Foreign.C.String (CString, peekCString)
import Foreign.C.Types (CInt(..), CSize(..))
import Foreign.Marshal.Array (</span><a href="Foreign.Marshal.Array.html#loc_98_1_98_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Array.html#loc_98_1_98_12&#39;)"><span class="mpre">allocaArray</span></a><span class="mpre">)

data </span><a name="loc_31_6_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_6_31_14&#39;)"><span class="hl_tycondecl"><span class="mpre">SystemID</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">SystemID</span></span><span class="mpre"> {
      </span><a name="loc_32_7_32_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_17&#39;)"><span class="hl_fielddecl"><span class="mpre">systemName</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><a name="loc_33_7_33_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_15&#39;)"><span class="hl_fielddecl"><span class="mpre">nodeName</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><a name="loc_34_7_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_14&#39;)"><span class="hl_fielddecl"><span class="mpre">release</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><a name="loc_35_7_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_7_35_14&#39;)"><span class="hl_fielddecl"><span class="mpre">version</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><a name="loc_36_7_36_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_14&#39;)"><span class="hl_fielddecl"><span class="mpre">machine</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/System/PosixCompat/Unistd.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 7, srcSpanEndLine = 37, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/System/PosixCompat/Unistd.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 7, srcSpanEndLine = 37, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/s"><span class="mpre">deriving (Eq, Read, Show)</span></span><span class="mpre">

</span><a href="#loc_40_1_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_12&#39;)"><span class="mpre">getSystemID</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_31_6_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_6_31_14&#39;)"><span class="hl_tyconref"><span class="mpre">SystemID</span></span></a><span class="mpre">
</span><a name="loc_40_1_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_12&#39;)"><span class="hl_vardecl"><span class="mpre">getSystemID</span></span></a><span class="mpre"> = do
  let </span><a name="loc_41_7_41_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_14&#39;)"><span class="hl_vardecl"><span class="mpre">bufSize</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">256</span></span><span class="mpre">
  let </span><a name="loc_42_7_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_11&#39;)"><span class="hl_fundecl"><span class="mpre">call</span></span></a><span class="mpre"> </span><a name="loc_42_12_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_12_42_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="Foreign.Marshal.Array.html#loc_98_1_98_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Array.html#loc_98_1_98_12&#39;)"><span class="hl_varref"><span class="mpre">allocaArray</span></span></a><span class="mpre"> </span><a href="#loc_41_7_41_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_14&#39;)"><span class="hl_varref"><span class="mpre">bufSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_42_39_42_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_39_42_42&#39;)"><span class="hl_vardecl"><span class="mpre">buf</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_43_9_43_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_11&#39;)"><span class="hl_vardecl"><span class="mpre">ok</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_42_12_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_12_42_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_42_39_42_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_39_42_42&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_41_7_41_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_14&#39;)"><span class="hl_varref"><span class="mpre">bufSize</span></span></a><span class="mpre">)
        if </span><a href="#loc_43_9_43_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_11&#39;)"><span class="hl_varref"><span class="mpre">ok</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
          then </span><span class="hl_varref"><span class="mpre">peekCString</span></span><span class="mpre"> </span><a href="#loc_42_39_42_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_39_42_42&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre">
          else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
  </span><span class="hl_vardecl"><span class="mpre">display</span></span><span class="mpre"> &lt;- </span><a href="#loc_42_7_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_11&#39;)"><span class="hl_varref"><span class="mpre">call</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">c_os_display_string</span></span><span class="mpre">
  </span><span class="hl_vardecl"><span class="mpre">vers</span></span><span class="mpre"> &lt;- </span><a href="#loc_42_7_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_11&#39;)"><span class="hl_varref"><span class="mpre">call</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">c_os_version_string</span></span><span class="mpre">
  </span><span class="hl_vardecl"><span class="mpre">arch</span></span><span class="mpre"> &lt;- </span><a href="#loc_42_7_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_11&#39;)"><span class="hl_varref"><span class="mpre">call</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">c_os_arch_string</span></span><span class="mpre">
  </span><span class="hl_vardecl"><span class="mpre">node</span></span><span class="mpre"> &lt;- </span><a href="#loc_42_7_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_11&#39;)"><span class="hl_varref"><span class="mpre">call</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">c_os_node_name</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/System/PosixCompat/Unistd.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 10, srcSpanEndLine = 57, srcSpanEndColumn = 11}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/System/PosixCompat/Unistd.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 19, srcSpanEndLine = 51, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1."><span class="mpre">SystemID {
           systemName = &quot;Windows&quot;
         , nodeName = node
         , release = display
         , version = vers
         , machine = arch
         }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Sleep for the specified duration (in seconds). Returns the time</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- remaining (if the sleep was interrupted by a signal, for example).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- On non-Unix systems, this is implemented in terms of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Control.Concurrent.threadDelay&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- GHC Note: the comment for &#39;usleep&#39; also applies here.</span></span><span class="mpre">
</span><a href="#loc_67_1_67_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_6&#39;)"><span class="mpre">sleep</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_67_1_67_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_6&#39;)"><span class="hl_fundecl"><span class="mpre">sleep</span></span></a><span class="mpre"> </span><a name="loc_67_7_67_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_7_67_11&#39;)"><span class="hl_vardecl"><span class="mpre">secs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">threadDelay</span></span><span class="mpre"> (</span><a href="#loc_67_7_67_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_7_67_11&#39;)"><span class="hl_varref"><span class="mpre">secs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1000000</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Sleep for the specified duration (in microseconds).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- On non-Unix systems, this is implemented in terms of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Control.Concurrent.threadDelay&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- GHC Note: &#39;Control.Concurrent.threadDelay&#39; is a better</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- choice. Without the @-threaded@ option, &#39;usleep&#39; will block all other</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- user threads. Even with the @-threaded@ option, &#39;usleep&#39; requires a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- full OS thread to itself. &#39;Control.Concurrent.threadDelay&#39; has</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- neither of these shortcomings.</span></span><span class="mpre">
</span><a href="#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_7&#39;)"><span class="mpre">usleep</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_80_1_80_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_7&#39;)"><span class="hl_vardecl"><span class="mpre">usleep</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">threadDelay</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Sleep for the specified duration (in nanoseconds).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- On non-Unix systems, this is implemented in terms of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Control.Concurrent.threadDelay&#39;.</span></span><span class="mpre">
</span><a href="#loc_87_1_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_10&#39;)"><span class="mpre">nanosleep</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_87_1_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_10&#39;)"><span class="hl_fundecl"><span class="mpre">nanosleep</span></span></a><span class="mpre"> </span><a name="loc_87_11_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_16&#39;)"><span class="hl_vardecl"><span class="mpre">nsecs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">threadDelay</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">round</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_87_11_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_11_87_16&#39;)"><span class="hl_varref"><span class="mpre">nsecs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1000</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">))

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/System/PosixCompat/Unistd.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 1, srcSpanEndLine = 90, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/System/PosixCompat/Unistd.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 1, srcSpanEndLine = 89, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/"><span class="mpre">foreign import ccall &quot;unixcompat_os_display_string&quot;
    c_os_display_string :: CString -&gt; CSize -&gt; IO CInt</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/System/PosixCompat/Unistd.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 1, srcSpanEndLine = 93, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/System/PosixCompat/Unistd.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 1, srcSpanEndLine = 92, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/"><span class="mpre">foreign import ccall &quot;unixcompat_os_version_string&quot;
    c_os_version_string :: CString -&gt; CSize -&gt; IO CInt</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/System/PosixCompat/Unistd.hs&quot;, srcSpanStartLine = 95, srcSpanStartColumn = 1, srcSpanEndLine = 96, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/System/PosixCompat/Unistd.hs&quot;, srcSpanStartLine = 95, srcSpanStartColumn = 1, srcSpanEndLine = 95, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/"><span class="mpre">foreign import ccall &quot;unixcompat_os_arch_string&quot;
    c_os_arch_string :: CString -&gt; CSize -&gt; IO CInt</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/System/PosixCompat/Unistd.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 1, srcSpanEndLine = 99, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/System/PosixCompat/Unistd.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 1, srcSpanEndLine = 98, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unix-compat-0.4.1.3/src/"><span class="mpre">foreign import ccall &quot;unixcompat_os_node_name&quot;
    c_os_node_name :: CString -&gt; CSize -&gt; IO CInt</span></span><span class="mpre">

#endif
</span></div></body></html>