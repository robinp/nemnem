<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">{-----------------------------------------------------------------------------

                 A LIBRARY OF MONADIC PARSER COMBINATORS

                              29th July 1996

                 Graham Hutton               Erik Meijer
            University of Nottingham    University of Utrecht

This Haskell 1.3 script defines a library of parser combinators, and is taken
from sections 1-6 of our article &quot;Monadic Parser Combinators&quot;.  Some changes
to the library have been made in the move from Gofer to Haskell:

   * Do notation is used in place of monad comprehension notation;

   * The parser datatype is defined using &quot;newtype&quot;, to avoid the overhead
     of tagging and untagging parsers with the P constructor.

------------------------------------------------------------------------------
** Extended to allow a symbol table/state to be threaded through the monad.
** Extended to allow a parameterised token type, rather than just strings.
** Extended to allow error-reporting.

(Extensions: 1998-2000 Malcolm.Wallace@cs.york.ac.uk)
(More extensions: 2004 gk-haskell@ninebynine.org)

------------------------------------------------------------------------------}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This library of monadic parser combinators is based on the ones</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   defined by Graham Hutton and Erik Meijer.  It has been extended by</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Malcolm Wallace to use an abstract token type (no longer just a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   string) as input, and to incorporate state in the monad, useful</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   for symbol tables, macros, and so on.  Basic facilities for error</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   reporting have also been added, and later extended by Graham Klyne</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   to return the errors through an @Either@ type, rather than just</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   calling @error@.</span></span><span class="mpre">

module Text.ParserCombinators.HuttonMeijerWallace
  (
  </span><span class="hl_comment"><span class="mpre">-- * The parser monad</span></span><span class="mpre">
    Parser(..)
  </span><span class="hl_comment"><span class="mpre">-- * Primitive parser combinators</span></span><span class="mpre">
  , item, eof, papply, papply&#39;
  </span><span class="hl_comment"><span class="mpre">-- * Derived combinators</span></span><span class="mpre">
  , (+++), </span><span class="hl_comment"><span class="mpre">{-sat,-}</span></span><span class="mpre"> tok, nottok, many, many1
  , sepby, sepby1, chainl, chainl1, chainr, chainr1, ops, bracket
  , toEOF
  </span><span class="hl_comment"><span class="mpre">-- * Error handling</span></span><span class="mpre">
  , elserror
  </span><span class="hl_comment"><span class="mpre">-- * State handling</span></span><span class="mpre">
  , stupd, stquery, stget
  </span><span class="hl_comment"><span class="mpre">-- * Re-parsing</span></span><span class="mpre">
  , reparse
  ) where

import Data.Char
import Control.Monad

</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 1, srcSpanEndLine = 59, srcSpanEndColumn = 13}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 8, srcSpanEndLine = 59, srcSpanEndColumn = 9}]}) (AssocRight (SrcSpanInfo {srcInfoSpan = SrcSpan {s"><span class="mpre">infixr 5 +++</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--- The parser monad ---------------------------------------------------------</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 1, srcSpanEndLine = 63, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 1, srcSpanEndLine = 63, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/"><span class="mpre">type ParseResult s t e a = Either e [(a,s,[Either e t])]</span></span><span class="mpre">

newtype </span><a name="loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tycondecl"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">   = </span><a name="loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_condecl"><span class="mpre">P</span></span></a><span class="mpre"> ( </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">ParseResult</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> )
    </span><span class="hl_comment"><span class="mpre">-- ^ The parser type is parametrised on the types of the state @s@,</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   the input tokens @t@, error-type @e@, and the result value @a@.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   The state and remaining input are threaded through the monad.</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> (</span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">) where
   </span><span class="hl_comment"><span class="mpre">-- fmap        :: (a -&gt; b) -&gt; (Parser s t e a -&gt; Parser s t e b)</span></span><span class="mpre">
   </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_72_9_72_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_72_14_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_14_72_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">)    = </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_72_26_72_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_26_72_28&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_72_29_72_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_29_72_32&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_72_14_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_14_72_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_72_26_72_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_26_72_28&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_72_29_72_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_29_72_32&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre"> of
                        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_73_31_73_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_31_73_34&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> [(</span><a href="#loc_72_9_72_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_73_62_73_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_62_73_63&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">, </span><a href="#loc_73_64_73_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_64_73_65&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_73_66_73_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_66_73_69&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">) | (</span><a name="loc_73_62_73_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_62_73_63&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_73_64_73_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_64_73_65&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">,</span><a name="loc_73_66_73_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_66_73_69&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_73_31_73_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_31_73_34&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">]
                        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_74_30_74_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_30_74_33&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">  -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_74_30_74_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_30_74_33&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
                       )

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> (</span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">) where
   </span><span class="hl_comment"><span class="mpre">-- return      :: a -&gt; Parser s t e a</span></span><span class="mpre">
   </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_79_11_79_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_12&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">        = </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_79_26_79_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_26_79_28&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_79_29_79_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_29_79_32&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> [(</span><a href="#loc_79_11_79_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_11_79_12&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_79_26_79_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_26_79_28&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">,</span><a href="#loc_79_29_79_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_29_79_32&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">)])
   </span><span class="hl_comment"><span class="mpre">-- &gt;&gt;=         :: Parser s t e a -&gt; (a -&gt; Parser s t e b) -&gt; Parser s t e b</span></span><span class="mpre">
   (</span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_81_7_81_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_7_81_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_81_14_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_14_81_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     = </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_81_26_81_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_26_81_28&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_81_29_81_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_29_81_32&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_81_7_81_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_7_81_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_81_26_81_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_26_81_28&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_81_29_81_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_29_81_32&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre"> of
                        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_82_31_82_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_31_82_34&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="#loc_107_1_107_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_12&#39;)"><span class="hl_varref"><span class="mpre">joinresults</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> [])
                            [ </span><a href="#loc_173_1_173_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_8&#39;)"><span class="hl_varref"><span class="mpre">papply&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_81_14_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_14_81_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_83_54_83_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_54_83_55&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) </span><a href="#loc_83_56_83_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_56_83_57&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_83_58_83_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_58_83_61&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre"> | (</span><a name="loc_83_54_83_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_54_83_55&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_83_56_83_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_56_83_57&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">,</span><a name="loc_83_58_83_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_58_83_61&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_82_31_82_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_31_82_34&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> ]
                        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_84_30_84_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_30_84_33&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">  -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_84_30_84_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_30_84_33&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
                       )
   </span><span class="hl_comment"><span class="mpre">-- fail        :: String -&gt; Parser s t e a</span></span><span class="mpre">
   </span><span class="hl_fundecl"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">err</span></span><span class="mpre">        = </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">inp</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> [])
  </span><span class="hl_comment"><span class="mpre">-- I know it&#39;s counterintuitive, but we want no-parse, not an error.</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">MonadPlus</span></span><span class="mpre"> (</span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre">) where
   </span><span class="hl_comment"><span class="mpre">-- mzero       :: Parser s t e a</span></span><span class="mpre">
   </span><span class="hl_vardecl"><span class="mpre">mzero</span></span><span class="mpre">           = </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">inp</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> [])
   </span><span class="hl_comment"><span class="mpre">-- mplus       :: Parser s t e a -&gt; Parser s t e a -&gt; Parser s t e a</span></span><span class="mpre">
   (</span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_94_7_94_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_7_94_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_fundecl"><span class="mpre">`mplus`</span></span><span class="mpre"> (</span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_94_21_94_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_21_94_22&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">) = </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_94_30_94_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_30_94_32&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_94_33_94_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_33_94_36&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_107_1_107_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_12&#39;)"><span class="hl_varref"><span class="mpre">joinresults</span></span></a><span class="mpre"> (</span><a href="#loc_94_7_94_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_7_94_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_94_30_94_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_30_94_32&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_94_33_94_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_33_94_36&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">) (</span><a href="#loc_94_21_94_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_21_94_22&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><a href="#loc_94_30_94_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_30_94_32&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_94_33_94_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_33_94_36&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- joinresults ensures that explicitly raised errors are dominant,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- provided no parse has yet been found.  The commented out code is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a slightly stricter specification of the real code.</span></span><span class="mpre">
</span><a href="#loc_107_1_107_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_12&#39;)"><span class="mpre">joinresults</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ParseResult</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ParseResult</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ParseResult</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-
joinresults (Left  p)  (Left  q)  = Left  p
joinresults (Left  p)  (Right _)  = Left  p
joinresults (Right []) (Left  q)  = Left  q
joinresults (Right p)  (Left  q)  = Right p
joinresults (Right p)  (Right q)  = Right (p++q)
-}</span></span><span class="mpre">
</span><a name="loc_107_1_107_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_12&#39;)"><span class="hl_fundecl"><span class="mpre">joinresults</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">  </span><a name="loc_107_20_107_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_20_107_21&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">)  </span><span class="hl_vardecl"><span class="mpre">q</span></span><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_107_20_107_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_20_107_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
</span><a href="#loc_107_1_107_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_12&#39;)"><span class="hl_fundecl"><span class="mpre">joinresults</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> []) </span><a name="loc_108_24_108_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_24_108_25&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">  = </span><a href="#loc_108_24_108_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_24_108_25&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
</span><a href="#loc_107_1_107_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_12&#39;)"><span class="hl_fundecl"><span class="mpre">joinresults</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_109_20_109_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_20_109_21&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">)  </span><a name="loc_109_24_109_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_24_109_25&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_109_20_109_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_20_109_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> case </span><a href="#loc_109_24_109_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_24_109_25&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> of </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> _  -&gt; []
                                                 </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_110_56_110_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_56_110_57&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_110_56_110_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_56_110_57&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">--- Primitive parser combinators ---------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Deliver the first remaining token.</span></span><span class="mpre">
</span><a href="#loc_117_1_117_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_5&#39;)"><span class="mpre">item</span></a><span class="mpre">              :: </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">
</span><a name="loc_117_1_117_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_5&#39;)"><span class="hl_vardecl"><span class="mpre">item</span></span></a><span class="mpre">               = </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_117_26_117_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_28&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_117_29_117_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_29_117_32&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_117_29_117_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_29_117_32&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre"> of
                        []            -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> []
                        (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_119_31_119_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_31_119_32&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> _)   -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_119_31_119_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_31_119_32&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
                        (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_120_32_120_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_32_120_33&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_120_35_120_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_35_120_37&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> [(</span><a href="#loc_120_32_120_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_32_120_33&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_117_26_117_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_28&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">,</span><a href="#loc_120_35_120_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_35_120_37&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)]
                       )

</span><span class="hl_comment"><span class="mpre">-- | Fail if end of input is not reached</span></span><span class="mpre">
</span><a href="#loc_125_1_125_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_4&#39;)"><span class="mpre">eof</span></a><span class="mpre">               :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 124, srcSpanStartColumn = 22, srcSpanEndLine = 124, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 124, srcSpanStartColumn = 29, srcSpanEndLine = 124, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan "><span class="mpre">Show p =&gt;</span></span><span class="mpre"> </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_125_1_125_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_4&#39;)"><span class="hl_vardecl"><span class="mpre">eof</span></span></a><span class="mpre">                = </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_125_26_125_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_26_125_28&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_125_29_125_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_29_125_32&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_125_29_125_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_29_125_32&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre"> of
                        []         -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> [(</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">,</span><a href="#loc_125_26_125_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_26_125_28&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">,[])]
                        (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_127_31_127_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_31_127_32&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_127_31_127_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_31_127_32&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
                        (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_128_33_128_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_33_128_34&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;End of input expected at &quot;</span></span><span class="mpre">
                                                 </span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_128_33_128_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_33_128_34&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;\n  but found text&quot;</span></span><span class="mpre">)
                       )

</span><span class="hl_comment"><span class="mpre">{-
-- | Ensure the value delivered by the parser is evaluated to WHNF.
force             :: Parser s t e a -&gt; Parser s t e a
force (P p)        = P (\st inp -&gt; let Right xs = p st inp
                                       h = head xs in
                                   h `seq` Right (h: tail xs)
                       )
--  [[[GK]]]  ^^^^^^
--  WHNF = Weak Head Normal Form, meaning that it has no top-level redex.
--  In this case, I think that means that the first element of the list
--  is fully evaluated.
--
--  NOTE:  the original form of this function fails if there is no parse
--  result for p st inp (head xs fails if xs is null), so the modified
--  form can assume a Right value only.
--
--  Why is this needed?
--  It&#39;s not exported, and the only use of this I see is commented out.
---------------------------------------
-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Deliver the first parse result only, eliminating any backtracking.</span></span><span class="mpre">
</span><a href="#loc_156_1_156_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_6&#39;)"><span class="mpre">first</span></a><span class="mpre">             :: </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_156_1_156_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_6&#39;)"><span class="hl_fundecl"><span class="mpre">first</span></span></a><span class="mpre"> (</span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_156_10_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_10_156_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">)        = </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_156_26_156_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_26_156_28&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_156_29_156_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_29_156_32&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_156_10_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_10_156_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_156_26_156_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_26_156_28&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_156_29_156_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_29_156_32&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre"> of
                                   </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_157_43_157_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_43_157_44&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_vardecl"><span class="mpre">xs</span></span><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> [</span><a href="#loc_157_43_157_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_43_157_44&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]
                                   </span><a name="loc_158_36_158_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_36_158_45&#39;)"><span class="hl_vardecl"><span class="mpre">otherwise</span></span></a><span class="mpre">    -&gt; </span><a href="#loc_158_36_158_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_36_158_45&#39;)"><span class="hl_varref"><span class="mpre">otherwise</span></span></a><span class="mpre">
                       )

</span><span class="hl_comment"><span class="mpre">-- | Apply the parser to some real input, given an initial state value.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   If the parser fails, raise &#39;error&#39; to halt the program.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   (This is the original exported behaviour - to allow the caller to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   deal with the error differently, see @papply&#39;@.)</span></span><span class="mpre">
</span><a href="#loc_167_1_167_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_7&#39;)"><span class="mpre">papply</span></a><span class="mpre">            :: </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">]
                                              -&gt; [(</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">])]
</span><a name="loc_167_1_167_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_7&#39;)"><span class="hl_fundecl"><span class="mpre">papply</span></span></a><span class="mpre"> (</span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_167_11_167_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_11_167_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><a name="loc_167_14_167_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_14_167_16&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_167_17_167_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_17_167_20&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> (</span><a href="#loc_167_11_167_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_11_167_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_167_14_167_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_14_167_16&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_167_17_167_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_17_167_20&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Apply the parser to some real input, given an initial state value.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   If the parser fails, return a diagnostic message to the caller.</span></span><span class="mpre">
</span><a href="#loc_173_1_173_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_8&#39;)"><span class="mpre">papply&#39;</span></a><span class="mpre">           :: </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">]
                                         -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> [(</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">])]
</span><a name="loc_173_1_173_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_8&#39;)"><span class="hl_fundecl"><span class="mpre">papply&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_173_12_173_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_12_173_13&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><a name="loc_173_15_173_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_15_173_17&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_173_18_173_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_18_173_21&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> = </span><a href="#loc_173_12_173_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_12_173_13&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_173_15_173_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_15_173_17&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_173_18_173_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_18_173_21&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--- Derived combinators ------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A choice between parsers.  Keep only the first success.</span></span><span class="mpre">
</span><a href="#loc_179_3_179_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_6&#39;)"><span class="mpre">(+++)</span></a><span class="mpre">             :: </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_179_1_179_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_2&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_179_3_179_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_6&#39;)"><span class="hl_fundecl"><span class="mpre">+++</span></span></a><span class="mpre"> </span><a name="loc_179_7_179_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_7_179_8&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">            = </span><a href="#loc_156_1_156_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_6&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="mpre"> (</span><a href="#loc_179_1_179_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mplus`</span></span><span class="mpre"> </span><a href="#loc_179_7_179_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_7_179_8&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Deliver the first token if it satisfies a predicate.</span></span><span class="mpre">
</span><a href="#loc_183_1_183_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_4&#39;)"><span class="mpre">sat</span></a><span class="mpre">               :: (</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">
</span><a name="loc_183_1_183_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_4&#39;)"><span class="hl_fundecl"><span class="mpre">sat</span></span></a><span class="mpre"> </span><a name="loc_183_5_183_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_5_183_6&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">              = do {(_,</span><a name="loc_183_29_183_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_29_183_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_117_1_117_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_5&#39;)"><span class="hl_varref"><span class="mpre">item</span></span></a><span class="mpre">; if </span><a href="#loc_183_5_183_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_5_183_6&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_183_29_183_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_29_183_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_183_29_183_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_29_183_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">mzero</span></span><span class="mpre">}

</span><span class="hl_comment"><span class="mpre">-- | Deliver the first token if it equals the argument.</span></span><span class="mpre">
</span><a href="#loc_187_1_187_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_4&#39;)"><span class="mpre">tok</span></a><span class="mpre">               :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 186, srcSpanStartColumn = 22, srcSpanEndLine = 186, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 186, srcSpanStartColumn = 27, srcSpanEndLine = 186, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan "><span class="mpre">Eq t =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">
</span><a name="loc_187_1_187_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_4&#39;)"><span class="hl_fundecl"><span class="mpre">tok</span></span></a><span class="mpre"> </span><a name="loc_187_5_187_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_6&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">              = do {(_,</span><a name="loc_187_29_187_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_29_187_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_117_1_117_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_5&#39;)"><span class="hl_varref"><span class="mpre">item</span></span></a><span class="mpre">; if </span><a href="#loc_187_29_187_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_29_187_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><a href="#loc_187_5_187_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_6&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_187_5_187_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_6&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">mzero</span></span><span class="mpre">}

</span><span class="hl_comment"><span class="mpre">-- | Deliver the first token if it does not equal the argument.</span></span><span class="mpre">
</span><a href="#loc_191_1_191_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_1_191_7&#39;)"><span class="mpre">nottok</span></a><span class="mpre">            :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 190, srcSpanStartColumn = 22, srcSpanEndLine = 190, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 190, srcSpanStartColumn = 27, srcSpanEndLine = 190, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan "><span class="mpre">Eq t =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">] -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">
</span><a name="loc_191_1_191_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_1_191_7&#39;)"><span class="hl_fundecl"><span class="mpre">nottok</span></span></a><span class="mpre"> </span><a name="loc_191_8_191_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_8_191_10&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">          = do {(_,</span><a name="loc_191_29_191_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_29_191_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_117_1_117_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_5&#39;)"><span class="hl_varref"><span class="mpre">item</span></span></a><span class="mpre">; if </span><a href="#loc_191_29_191_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_29_191_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`notElem`</span></span><span class="mpre"> </span><a href="#loc_191_8_191_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_8_191_10&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_191_29_191_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_29_191_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                                        else </span><span class="hl_varref"><span class="mpre">mzero</span></span><span class="mpre">}

</span><span class="hl_comment"><span class="mpre">-- | Deliver zero or more values of @a@.</span></span><span class="mpre">
</span><a href="#loc_196_1_196_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_5&#39;)"><span class="mpre">many</span></a><span class="mpre">              :: </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_196_1_196_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_5&#39;)"><span class="hl_fundecl"><span class="mpre">many</span></span></a><span class="mpre"> </span><a name="loc_196_6_196_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_6_196_7&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">             = </span><a href="#loc_201_1_201_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_6&#39;)"><span class="hl_varref"><span class="mpre">many1</span></span></a><span class="mpre"> </span><a href="#loc_196_6_196_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_6_196_7&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_179_3_179_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
</span><span class="hl_comment"><span class="mpre">--many p           = force (many1 p +++ return [])</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Deliver one or more values of @a@.</span></span><span class="mpre">
</span><a href="#loc_201_1_201_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_6&#39;)"><span class="mpre">many1</span></a><span class="mpre">             :: </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_201_1_201_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_6&#39;)"><span class="hl_fundecl"><span class="mpre">many1</span></span></a><span class="mpre"> </span><a name="loc_201_7_201_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_7_201_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">            = do {</span><a name="loc_201_26_201_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_26_201_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_201_7_201_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_7_201_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><a name="loc_201_34_201_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_34_201_36&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_196_1_196_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_201_7_201_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_7_201_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_201_26_201_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_26_201_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_201_34_201_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_34_201_36&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)}

</span><span class="hl_comment"><span class="mpre">-- | Deliver zero or more values of @a@ separated by @b@&#39;s.</span></span><span class="mpre">
</span><a href="#loc_205_3_205_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_3_205_10&#39;)"><span class="mpre">sepby</span></a><span class="mpre">             :: </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_205_1_205_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_2&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_205_3_205_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_3_205_10&#39;)"><span class="hl_fundecl"><span class="mpre">`sepby`</span></span></a><span class="mpre"> </span><a name="loc_205_11_205_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_11_205_14&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre">      = (</span><a href="#loc_205_1_205_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_209_3_209_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_3_209_11&#39;)"><span class="hl_infix"><span class="mpre">`sepby1`</span></span></a><span class="mpre"> </span><a href="#loc_205_11_205_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_11_205_14&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre">) </span><a href="#loc_179_3_179_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []

</span><span class="hl_comment"><span class="mpre">-- | Deliver one or more values of @a@ separated by @b@&#39;s.</span></span><span class="mpre">
</span><a href="#loc_209_3_209_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_3_209_11&#39;)"><span class="mpre">sepby1</span></a><span class="mpre">            :: </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_209_1_209_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_2&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_209_3_209_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_3_209_11&#39;)"><span class="hl_fundecl"><span class="mpre">`sepby1`</span></span></a><span class="mpre"> </span><a name="loc_209_12_209_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_12_209_15&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre">     = do {</span><a name="loc_209_26_209_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_26_209_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_209_1_209_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><a name="loc_209_34_209_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_34_209_36&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_196_1_196_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> (do {</span><a href="#loc_209_12_209_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_12_209_15&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre">; </span><a href="#loc_209_1_209_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">}); </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_209_26_209_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_26_209_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_209_34_209_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_34_209_36&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)}

</span><a href="#loc_213_1_213_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_7&#39;)"><span class="mpre">chainl</span></a><span class="mpre">            :: </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
                                                              -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_213_1_213_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_7&#39;)"><span class="hl_fundecl"><span class="mpre">chainl</span></span></a><span class="mpre"> </span><a name="loc_213_8_213_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_8_213_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_213_10_213_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_10_213_12&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> </span><a name="loc_213_13_213_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_13_213_14&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">      = (</span><a href="#loc_213_8_213_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_8_213_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_216_3_216_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_3_216_12&#39;)"><span class="hl_infix"><span class="mpre">`chainl1`</span></span></a><span class="mpre"> </span><a href="#loc_213_10_213_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_10_213_12&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">) </span><a href="#loc_179_3_179_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_213_13_213_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_13_213_14&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><a href="#loc_216_3_216_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_3_216_12&#39;)"><span class="mpre">chainl1</span></a><span class="mpre">           :: </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_216_1_216_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_2&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_216_3_216_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_3_216_12&#39;)"><span class="hl_fundecl"><span class="mpre">`chainl1`</span></span></a><span class="mpre"> </span><a name="loc_216_13_216_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_13_216_15&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre">     = do {</span><a name="loc_216_26_216_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_26_216_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_216_1_216_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><a href="#loc_218_25_218_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_25_218_29&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a href="#loc_216_26_216_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_26_216_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">}
                     where
                        </span><a name="loc_218_25_218_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_25_218_29&#39;)"><span class="hl_fundecl"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a name="loc_218_30_218_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_30_218_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do {</span><a name="loc_218_38_218_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_38_218_39&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_216_13_216_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_13_216_15&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">; </span><a name="loc_218_47_218_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_47_218_48&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_216_1_216_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><a href="#loc_218_25_218_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_25_218_29&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> (</span><a href="#loc_218_38_218_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_38_218_39&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_218_30_218_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_30_218_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_218_47_218_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_47_218_48&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)}
                                 </span><a href="#loc_179_3_179_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_218_30_218_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_30_218_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_223_1_223_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_7&#39;)"><span class="mpre">chainr</span></a><span class="mpre">            :: </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
                                                              -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_223_1_223_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_7&#39;)"><span class="hl_fundecl"><span class="mpre">chainr</span></span></a><span class="mpre"> </span><a name="loc_223_8_223_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_8_223_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_223_10_223_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_10_223_12&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> </span><a name="loc_223_13_223_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_13_223_14&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">      = (</span><a href="#loc_223_8_223_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_8_223_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_226_3_226_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_12&#39;)"><span class="hl_infix"><span class="mpre">`chainr1`</span></span></a><span class="mpre"> </span><a href="#loc_223_10_223_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_10_223_12&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">) </span><a href="#loc_179_3_179_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_223_13_223_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_13_223_14&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><a href="#loc_226_3_226_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_12&#39;)"><span class="mpre">chainr1</span></a><span class="mpre">           :: </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_226_1_226_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_2&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_226_3_226_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_12&#39;)"><span class="hl_fundecl"><span class="mpre">`chainr1`</span></span></a><span class="mpre"> </span><a name="loc_226_13_226_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_13_226_15&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre">     = do {</span><a name="loc_226_26_226_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_26_226_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_226_1_226_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><a href="#loc_228_25_228_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_25_228_29&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a href="#loc_226_26_226_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_26_226_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">}
                     where
                        </span><a name="loc_228_25_228_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_25_228_29&#39;)"><span class="hl_fundecl"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a name="loc_228_30_228_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_30_228_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do { </span><a name="loc_228_39_228_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_39_228_40&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_226_13_226_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_13_226_15&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">
                                    ; </span><a name="loc_229_39_229_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_39_229_40&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_226_1_226_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_226_3_226_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_3_226_12&#39;)"><span class="hl_infix"><span class="mpre">`chainr1`</span></span></a><span class="mpre"> </span><a href="#loc_226_13_226_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_13_226_15&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">
                                    ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_228_39_228_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_39_228_40&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_228_30_228_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_30_228_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_229_39_229_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_39_229_40&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
                                    }
                                 </span><a href="#loc_179_3_179_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_228_30_228_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_30_228_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_235_1_235_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_1_235_4&#39;)"><span class="mpre">ops</span></a><span class="mpre">               :: [(</span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)] -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_235_1_235_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_1_235_4&#39;)"><span class="hl_fundecl"><span class="mpre">ops</span></span></a><span class="mpre"> </span><a name="loc_235_5_235_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_5_235_7&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">             = </span><span class="hl_varref"><span class="mpre">foldr1</span></span><span class="mpre"> </span><a href="#loc_179_3_179_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_6&#39;)"><span class="hl_varref"><span class="mpre">(+++)</span></span></a><span class="mpre"> [do {</span><a href="#loc_235_57_235_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_57_235_58&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_235_59_235_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_59_235_61&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">} | (</span><a name="loc_235_57_235_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_57_235_58&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><a name="loc_235_59_235_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_59_235_61&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_235_5_235_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_5_235_7&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">]

</span><a href="#loc_240_1_240_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_1_240_8&#39;)"><span class="mpre">bracket</span></a><span class="mpre">           :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 237, srcSpanStartColumn = 22, srcSpanEndLine = 237, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 237, srcSpanStartColumn = 22, srcSpanEndLine = 237, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem"><span class="mpre">(Show p,Show t) =&gt;</span></span><span class="mpre">
                     </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt;
                               </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_240_1_240_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_1_240_8&#39;)"><span class="hl_fundecl"><span class="mpre">bracket</span></span></a><span class="mpre"> </span><a name="loc_240_9_240_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_9_240_13&#39;)"><span class="hl_vardecl"><span class="mpre">open</span></span></a><span class="mpre"> </span><a name="loc_240_14_240_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_240_16_240_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_16_240_21&#39;)"><span class="hl_vardecl"><span class="mpre">close</span></span></a><span class="mpre"> = do { </span><a href="#loc_240_9_240_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_9_240_13&#39;)"><span class="hl_varref"><span class="mpre">open</span></span></a><span class="mpre">
                          ; </span><a name="loc_241_29_241_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_29_241_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_240_14_240_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                          ; </span><a href="#loc_240_16_240_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_16_240_21&#39;)"><span class="hl_varref"><span class="mpre">close</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- `elserror` &quot;improperly matched construct&quot;;</span></span><span class="mpre">
                          ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_241_29_241_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_29_241_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                          }

</span><span class="hl_comment"><span class="mpre">-- | Accept a complete parse of the input only, no partial parses.</span></span><span class="mpre">
</span><a href="#loc_249_1_249_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_6&#39;)"><span class="mpre">toEOF</span></a><span class="mpre">             :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 247, srcSpanStartColumn = 22, srcSpanEndLine = 247, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 247, srcSpanStartColumn = 29, srcSpanEndLine = 247, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan "><span class="mpre">Show p =&gt;</span></span><span class="mpre">
                     </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_249_1_249_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_6&#39;)"><span class="hl_fundecl"><span class="mpre">toEOF</span></span></a><span class="mpre"> </span><a name="loc_249_7_249_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_7_249_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">            = do { </span><a name="loc_249_27_249_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_27_249_28&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_249_7_249_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_7_249_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><a href="#loc_125_1_125_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_4&#39;)"><span class="hl_varref"><span class="mpre">eof</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_249_27_249_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_27_249_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> }


</span><span class="hl_comment"><span class="mpre">--- Error handling -----------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Return an error using the supplied diagnostic string, and a token type</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   which includes position information.</span></span><span class="mpre">
</span><a href="#loc_257_1_257_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_11&#39;)"><span class="mpre">parseerror</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 256, srcSpanStartColumn = 15, srcSpanEndLine = 256, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 256, srcSpanStartColumn = 15, srcSpanEndLine = 256, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem"><span class="mpre">(Show p,Show t) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_257_1_257_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_11&#39;)"><span class="hl_fundecl"><span class="mpre">parseerror</span></span></a><span class="mpre"> </span><a name="loc_257_12_257_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_12_257_15&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> = </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> </span><a name="loc_257_25_257_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_25_257_28&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> -&gt;
                         case </span><a href="#loc_257_25_257_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_25_257_28&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre"> of
                           [] -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Parse error: unexpected EOF\n&quot;</span></span><span class="mpre">
                           (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_260_34_260_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_34_260_35&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Lexical error:  &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_260_34_260_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_34_260_35&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
                           (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_261_36_261_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_36_261_37&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><a name="loc_261_38_261_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_38_261_39&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)  -&gt;
                                 </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Parse error: in  &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_261_36_261_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_36_261_37&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;\n    &quot;</span></span><span class="mpre">
                                       </span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_257_12_257_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_12_257_15&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;\n  &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;Found &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_261_38_261_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_38_261_39&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
                   )


</span><span class="hl_comment"><span class="mpre">-- | If the parser fails, generate an error message.</span></span><span class="mpre">
</span><a href="#loc_270_3_270_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_3_270_13&#39;)"><span class="mpre">elserror</span></a><span class="mpre">          :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 268, srcSpanStartColumn = 22, srcSpanEndLine = 268, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/HuttonMeijerWallace.hs&quot;, srcSpanStartLine = 268, srcSpanStartColumn = 22, srcSpanEndLine = 268, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem"><span class="mpre">(Show p,Show t) =&gt;</span></span><span class="mpre"> </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                                        -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_270_1_270_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_1_270_2&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_270_3_270_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_3_270_13&#39;)"><span class="hl_fundecl"><span class="mpre">`elserror`</span></span></a><span class="mpre"> </span><a name="loc_270_14_270_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_14_270_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">     = </span><a href="#loc_270_1_270_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_1_270_2&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_179_3_179_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_6&#39;)"><span class="hl_infix"><span class="mpre">+++</span></span></a><span class="mpre"> </span><a href="#loc_257_1_257_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_11&#39;)"><span class="hl_varref"><span class="mpre">parseerror</span></span></a><span class="mpre"> </span><a href="#loc_270_14_270_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_14_270_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--- State handling -----------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Update the internal state.</span></span><span class="mpre">
</span><a href="#loc_276_1_276_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_1_276_6&#39;)"><span class="mpre">stupd</span></a><span class="mpre">      :: (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_276_1_276_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_1_276_6&#39;)"><span class="hl_fundecl"><span class="mpre">stupd</span></span></a><span class="mpre"> </span><a name="loc_276_7_276_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_7_276_8&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     = </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_276_19_276_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_19_276_21&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_276_22_276_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_22_276_25&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre">-&gt; </span><span class="hl_comment"><span class="mpre">{-let newst = f st in newst `seq`-}</span></span><span class="mpre">
                           </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> [(</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">, </span><a href="#loc_276_7_276_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_7_276_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_276_19_276_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_19_276_21&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">, </span><a href="#loc_276_22_276_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_22_276_25&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">)])

</span><span class="hl_comment"><span class="mpre">-- | Query the internal state.</span></span><span class="mpre">
</span><a href="#loc_281_1_281_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_1_281_8&#39;)"><span class="mpre">stquery</span></a><span class="mpre">    :: (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_281_1_281_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_1_281_8&#39;)"><span class="hl_fundecl"><span class="mpre">stquery</span></span></a><span class="mpre"> </span><a name="loc_281_9_281_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_9_281_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">   = </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_281_19_281_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_19_281_21&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_281_22_281_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_22_281_25&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre">-&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> [(</span><a href="#loc_281_9_281_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_9_281_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_281_19_281_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_19_281_21&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">, </span><a href="#loc_281_19_281_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_19_281_21&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">, </span><a href="#loc_281_22_281_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_22_281_25&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">)])

</span><span class="hl_comment"><span class="mpre">-- | Deliver the entire internal state.</span></span><span class="mpre">
</span><a href="#loc_285_1_285_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_1_285_6&#39;)"><span class="mpre">stget</span></a><span class="mpre">      :: </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_285_1_285_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_1_285_6&#39;)"><span class="hl_vardecl"><span class="mpre">stget</span></span></a><span class="mpre">       = </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_285_19_285_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_19_285_21&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_285_22_285_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_22_285_25&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre">-&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> [(</span><a href="#loc_285_19_285_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_19_285_21&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">, </span><a href="#loc_285_19_285_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_19_285_21&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">, </span><a href="#loc_285_22_285_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_22_285_25&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">)])


</span><span class="hl_comment"><span class="mpre">--- Push some tokens back onto the input stream and reparse ------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This is useful for recursively expanding macros.  When the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   user-parser recognises a macro use, it can lookup the macro</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   expansion from the parse state, lex it, and then stuff the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   lexed expansion back down into the parser.</span></span><span class="mpre">
</span><a href="#loc_295_1_295_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_1_295_8&#39;)"><span class="mpre">reparse</span></a><span class="mpre">    :: [</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">] -&gt; </span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_295_1_295_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_1_295_8&#39;)"><span class="hl_fundecl"><span class="mpre">reparse</span></span></a><span class="mpre"> </span><a name="loc_295_9_295_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_9_295_11&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">  = </span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (\</span><a name="loc_295_19_295_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_19_295_21&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_295_22_295_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_22_295_25&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre">-&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> [(</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">, </span><a href="#loc_295_19_295_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_19_295_21&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">, </span><a href="#loc_295_9_295_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_9_295_11&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_295_22_295_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_22_295_25&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">)])

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span></div></body></html>