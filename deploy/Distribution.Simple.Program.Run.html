<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Distribution.Simple.Program.Run</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  Duncan Coutts 2009</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  cabal-devel@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module provides a data type for program invocations and functions to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- run them.</span></span><span class="mpre">

module Distribution.Simple.Program.Run (
    ProgramInvocation(..),
    IOEncoding(..),
    emptyProgramInvocation,
    simpleProgramInvocation,
    programInvocation,
    multiStageProgramInvocation,

    runProgramInvocation,
    getProgramInvocationOutput,

    getEffectiveEnvironment,
  ) where

import Distribution.Simple.Program.Types
         ( </span><a href="Distribution.Simple.Program.Types.html#loc_77_6_77_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Types.html#loc_77_6_77_23&#39;)"><span class="mpre">ConfiguredProgram</span></a><span class="mpre">(..), </span><a href="Distribution.Simple.Program.Types.html#loc_115_1_115_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Types.html#loc_115_1_115_12&#39;)"><span class="mpre">programPath</span></a><span class="mpre"> )
import Distribution.Simple.Utils
         ( </span><a href="Distribution.Simple.Utils.html#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_251_1_251_4&#39;)"><span class="mpre">die</span></a><span class="mpre">, </span><a href="Distribution.Simple.Utils.html#loc_429_1_429_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_429_1_429_14&#39;)"><span class="mpre">rawSystemExit</span></a><span class="mpre">, </span><a href="Distribution.Simple.Utils.html#loc_470_1_470_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_470_1_470_19&#39;)"><span class="mpre">rawSystemIOWithEnv</span></a><span class="mpre">, </span><a href="Distribution.Simple.Utils.html#loc_520_1_520_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_520_1_520_18&#39;)"><span class="mpre">rawSystemStdInOut</span></a><span class="mpre">
         , </span><a href="Distribution.Simple.Utils.html#loc_1212_1_1212_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_1212_1_1212_7&#39;)"><span class="mpre">toUTF8</span></a><span class="mpre">, </span><a href="Distribution.Simple.Utils.html#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_1171_1_1171_9&#39;)"><span class="mpre">fromUTF8</span></a><span class="mpre">, </span><a href="Distribution.Simple.Utils.html#loc_1264_1_1264_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_1264_1_1264_21&#39;)"><span class="mpre">normaliseLineEndings</span></a><span class="mpre"> )
import Distribution.Verbosity
         ( </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="mpre">Verbosity</span></a><span class="mpre"> )

import Data.List
         ( </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="mpre">foldl&#39;</span></a><span class="mpre">, </span><a href="Data.List.html#loc_984_1_984_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_984_1_984_8&#39;)"><span class="mpre">unfoldr</span></a><span class="mpre"> )
import qualified Data.Map as Map
import Control.Monad
         ( </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre"> )
import System.Exit
         ( </span><a href="GHC.IO.Exception.html#loc_205_6_205_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_205_6_205_14&#39;)"><span class="mpre">ExitCode</span></a><span class="mpre">(..), </span><a href="System.Exit.html#loc_60_1_60_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Exit.html#loc_60_1_60_9&#39;)"><span class="mpre">exitWith</span></a><span class="mpre"> )
import Distribution.Compat.Environment
         ( </span><a href="Distribution.Compat.Environment.html#loc_18_1_18_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Environment.html#loc_18_1_18_15&#39;)"><span class="mpre">getEnvironment</span></a><span class="mpre"> )

</span><span class="hl_comment"><span class="mpre">-- | Represents a specific invocation of a specific program.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is used as an intermediate type between deciding how to call a program</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and actually doing it. This provides the opportunity to the caller to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- adjust how the program will be called. These invocations can either be run</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- directly or turned into shell or batch scripts.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
data </span><a name="loc_51_6_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_23&#39;)"><span class="hl_tycondecl"><span class="mpre">ProgramInvocation</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">ProgramInvocation</span></span><span class="mpre"> {
       </span><a name="loc_52_8_52_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_8_52_22&#39;)"><span class="hl_fielddecl"><span class="mpre">progInvokePath</span></span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">,
       </span><a name="loc_53_8_53_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_8_53_22&#39;)"><span class="hl_fielddecl"><span class="mpre">progInvokeArgs</span></span></a><span class="mpre">  :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">],
       </span><a name="loc_54_8_54_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_8_54_21&#39;)"><span class="hl_fielddecl"><span class="mpre">progInvokeEnv</span></span></a><span class="mpre">   :: [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)],
       </span><a name="loc_55_8_55_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_8_55_21&#39;)"><span class="hl_fielddecl"><span class="mpre">progInvokeCwd</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">,
       </span><a name="loc_56_8_56_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_8_56_23&#39;)"><span class="hl_fielddecl"><span class="mpre">progInvokeInput</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,
       </span><a name="loc_57_8_57_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_8_57_31&#39;)"><span class="hl_fielddecl"><span class="mpre">progInvokeInputEncoding</span></span></a><span class="mpre">  :: </span><a href="#loc_61_6_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_16&#39;)"><span class="hl_tyconref"><span class="mpre">IOEncoding</span></span></a><span class="mpre">,
       </span><a name="loc_58_8_58_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_8_58_32&#39;)"><span class="hl_fielddecl"><span class="mpre">progInvokeOutputEncoding</span></span></a><span class="mpre"> :: </span><a href="#loc_61_6_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_16&#39;)"><span class="hl_tyconref"><span class="mpre">IOEncoding</span></span></a><span class="mpre">
     }

data </span><a name="loc_61_6_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_16&#39;)"><span class="hl_tycondecl"><span class="mpre">IOEncoding</span></span></a><span class="mpre"> = </span><a name="loc_61_19_61_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_19_61_33&#39;)"><span class="hl_condecl"><span class="mpre">IOEncodingText</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- locale mode text</span></span><span class="mpre">
                | </span><a name="loc_62_19_62_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_19_62_33&#39;)"><span class="hl_condecl"><span class="mpre">IOEncodingUTF8</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- always utf8</span></span><span class="mpre">

</span><a href="#loc_65_1_65_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_23&#39;)"><span class="mpre">emptyProgramInvocation</span></a><span class="mpre"> :: </span><a href="#loc_51_6_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_23&#39;)"><span class="hl_tyconref"><span class="mpre">ProgramInvocation</span></span></a><span class="mpre">
</span><a name="loc_65_1_65_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_23&#39;)"><span class="hl_vardecl"><span class="mpre">emptyProgramInvocation</span></span></a><span class="mpre"> =
  </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 66, srcSpanStartColumn = 3, srcSpanEndLine = 74, srcSpanEndColumn = 4}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 66, srcSpanStartColumn = 21, srcSpanEndLine = 66, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distributio"><span class="mpre">ProgramInvocation {
    progInvokePath  = &quot;&quot;,
    progInvokeArgs  = [],
    progInvokeEnv   = [],
    progInvokeCwd   = Nothing,
    progInvokeInput = Nothing,
    progInvokeInputEncoding  = IOEncodingText,
    progInvokeOutputEncoding = IOEncodingText
  }</span></span><span class="mpre">

</span><a href="#loc_77_1_77_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_24&#39;)"><span class="mpre">simpleProgramInvocation</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><a href="#loc_51_6_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_23&#39;)"><span class="hl_tyconref"><span class="mpre">ProgramInvocation</span></span></a><span class="mpre">
</span><a name="loc_77_1_77_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_24&#39;)"><span class="hl_fundecl"><span class="mpre">simpleProgramInvocation</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">path</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">args</span></span><span class="mpre"> =
  </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 78, srcSpanStartColumn = 3, srcSpanEndLine = 81, srcSpanEndColumn = 4}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 78, srcSpanStartColumn = 26, srcSpanEndLine = 78, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distributio"><span class="mpre">emptyProgramInvocation {
    progInvokePath  = path,
    progInvokeArgs  = args
  }</span></span><span class="mpre">

</span><a href="#loc_84_1_84_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_18&#39;)"><span class="mpre">programInvocation</span></a><span class="mpre"> :: </span><a href="Distribution.Simple.Program.Types.html#loc_77_6_77_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Program.Types.html#loc_77_6_77_23&#39;)"><span class="hl_tyconref"><span class="mpre">ConfiguredProgram</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><a href="#loc_51_6_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_23&#39;)"><span class="hl_tyconref"><span class="mpre">ProgramInvocation</span></span></a><span class="mpre">
</span><a name="loc_84_1_84_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_18&#39;)"><span class="hl_fundecl"><span class="mpre">programInvocation</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">prog</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">args</span></span><span class="mpre"> =
  </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 85, srcSpanStartColumn = 3, srcSpanEndLine = 91, srcSpanEndColumn = 4}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 85, srcSpanStartColumn = 26, srcSpanEndLine = 85, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distributio"><span class="mpre">emptyProgramInvocation {
    progInvokePath = programPath prog,
    progInvokeArgs = programDefaultArgs prog
                  ++ args
                  ++ programOverrideArgs prog,
    progInvokeEnv  = programOverrideEnv prog
  }</span></span><span class="mpre">


</span><a href="#loc_95_1_95_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_21&#39;)"><span class="mpre">runProgramInvocation</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_51_6_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_23&#39;)"><span class="hl_tyconref"><span class="mpre">ProgramInvocation</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_95_1_95_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_21&#39;)"><span class="hl_fundecl"><span class="mpre">runProgramInvocation</span></span></a><span class="mpre"> </span><a name="loc_95_22_95_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_22_95_31&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre">
  </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 3, srcSpanEndLine = 102, srcSpanEndColumn = 4}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 21, srcSpanEndLine = 96, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Si"><span class="mpre">ProgramInvocation {
    progInvokePath  = path,
    progInvokeArgs  = args,
    progInvokeEnv   = [],
    progInvokeCwd   = Nothing,
    progInvokeInput = Nothing
  }</span></span><span class="mpre"> =
  </span><a href="Distribution.Simple.Utils.html#loc_429_1_429_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_429_1_429_14&#39;)"><span class="hl_varref"><span class="mpre">rawSystemExit</span></span></a><span class="mpre"> </span><a href="#loc_95_22_95_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_22_95_31&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">path</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">args</span></span><span class="mpre">

</span><a href="#loc_95_1_95_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_21&#39;)"><span class="hl_fundecl"><span class="mpre">runProgramInvocation</span></span></a><span class="mpre"> </span><a name="loc_105_22_105_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_22_105_31&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre">
  </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 3, srcSpanEndLine = 112, srcSpanEndColumn = 4}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 21, srcSpanEndLine = 106, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution"><span class="mpre">ProgramInvocation {
    progInvokePath  = path,
    progInvokeArgs  = args,
    progInvokeEnv   = envOverrides,
    progInvokeCwd   = mcwd,
    progInvokeInput = Nothing
  }</span></span><span class="mpre"> = do
    </span><a name="loc_113_5_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_9&#39;)"><span class="hl_vardecl"><span class="mpre">menv</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_179_1_179_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_24&#39;)"><span class="hl_varref"><span class="mpre">getEffectiveEnvironment</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">envOverrides</span></span><span class="mpre">
    </span><a name="loc_114_5_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_13&#39;)"><span class="hl_vardecl"><span class="mpre">exitCode</span></span></a><span class="mpre"> &lt;- </span><a href="Distribution.Simple.Utils.html#loc_470_1_470_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_470_1_470_19&#39;)"><span class="hl_varref"><span class="mpre">rawSystemIOWithEnv</span></span></a><span class="mpre"> </span><a href="#loc_105_22_105_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_22_105_31&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre">
                                   </span><span class="hl_varref"><span class="mpre">path</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">args</span></span><span class="mpre">
                                   </span><span class="hl_varref"><span class="mpre">mcwd</span></span><span class="mpre"> </span><a href="#loc_113_5_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_9&#39;)"><span class="hl_varref"><span class="mpre">menv</span></span></a><span class="mpre">
                                   </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_114_5_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_13&#39;)"><span class="hl_varref"><span class="mpre">exitCode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ExitSuccess</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
      </span><a href="System.Exit.html#loc_60_1_60_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Exit.html#loc_60_1_60_9&#39;)"><span class="hl_varref"><span class="mpre">exitWith</span></span></a><span class="mpre"> </span><a href="#loc_114_5_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_13&#39;)"><span class="hl_varref"><span class="mpre">exitCode</span></span></a><span class="mpre">

</span><a href="#loc_95_1_95_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_21&#39;)"><span class="hl_fundecl"><span class="mpre">runProgramInvocation</span></span></a><span class="mpre"> </span><a name="loc_121_22_121_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_22_121_31&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre">
  </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 3, srcSpanEndLine = 129, srcSpanEndColumn = 4}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 21, srcSpanEndLine = 122, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution"><span class="mpre">ProgramInvocation {
    progInvokePath  = path,
    progInvokeArgs  = args,
    progInvokeEnv   = envOverrides,
    progInvokeCwd   = mcwd,
    progInvokeInput = Just inputStr,
    progInvokeInputEncoding = encoding
  }</span></span><span class="mpre"> = do
    </span><a name="loc_130_5_130_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_5_130_9&#39;)"><span class="hl_vardecl"><span class="mpre">menv</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_179_1_179_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_24&#39;)"><span class="hl_varref"><span class="mpre">getEffectiveEnvironment</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">envOverrides</span></span><span class="mpre">
    (_, </span><a name="loc_131_9_131_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_9_131_15&#39;)"><span class="hl_vardecl"><span class="mpre">errors</span></span></a><span class="mpre">, </span><a name="loc_131_17_131_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_17_131_25&#39;)"><span class="hl_vardecl"><span class="mpre">exitCode</span></span></a><span class="mpre">) &lt;- </span><a href="Distribution.Simple.Utils.html#loc_520_1_520_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_520_1_520_18&#39;)"><span class="hl_varref"><span class="mpre">rawSystemStdInOut</span></span></a><span class="mpre"> </span><a href="#loc_121_22_121_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_22_121_31&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre">
                                    </span><span class="hl_varref"><span class="mpre">path</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">args</span></span><span class="mpre">
                                    </span><span class="hl_varref"><span class="mpre">mcwd</span></span><span class="mpre"> </span><a href="#loc_130_5_130_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_5_130_9&#39;)"><span class="hl_varref"><span class="mpre">menv</span></span></a><span class="mpre">
                                    (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_138_5_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_10&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_131_17_131_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_17_131_25&#39;)"><span class="hl_varref"><span class="mpre">exitCode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ExitSuccess</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
      </span><a href="Distribution.Simple.Utils.html#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_251_1_251_4&#39;)"><span class="hl_varref"><span class="mpre">die</span></span></a><span class="mpre"> </span><a href="#loc_131_9_131_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_9_131_15&#39;)"><span class="hl_varref"><span class="mpre">errors</span></span></a><span class="mpre">
  where
    </span><a name="loc_138_5_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_10&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">encoding</span></span><span class="mpre"> of
              </span><a href="#loc_61_19_61_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_19_61_33&#39;)"><span class="hl_conref"><span class="mpre">IOEncodingText</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">inputStr</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">)
              </span><a href="#loc_62_19_62_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_19_62_33&#39;)"><span class="hl_conref"><span class="mpre">IOEncodingUTF8</span></span></a><span class="mpre"> -&gt; (</span><a href="Distribution.Simple.Utils.html#loc_1212_1_1212_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_1212_1_1212_7&#39;)"><span class="hl_varref"><span class="mpre">toUTF8</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">inputStr</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- use binary mode for</span></span><span class="mpre">
                                                        </span><span class="hl_comment"><span class="mpre">-- utf8</span></span><span class="mpre">


</span><a href="#loc_145_1_145_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_27&#39;)"><span class="mpre">getProgramInvocationOutput</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_51_6_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_23&#39;)"><span class="hl_tyconref"><span class="mpre">ProgramInvocation</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_145_1_145_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_27&#39;)"><span class="hl_fundecl"><span class="mpre">getProgramInvocationOutput</span></span></a><span class="mpre"> </span><a name="loc_145_28_145_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_28_145_37&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre">
  </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 146, srcSpanStartColumn = 3, srcSpanEndLine = 153, srcSpanEndColumn = 4}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 146, srcSpanStartColumn = 21, srcSpanEndLine = 146, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution"><span class="mpre">ProgramInvocation {
    progInvokePath  = path,
    progInvokeArgs  = args,
    progInvokeEnv   = envOverrides,
    progInvokeCwd   = mcwd,
    progInvokeInput = minputStr,
    progInvokeOutputEncoding = encoding
  }</span></span><span class="mpre"> = do
    let </span><a name="loc_154_9_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_13&#39;)"><span class="hl_vardecl"><span class="mpre">utf8</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">encoding</span></span><span class="mpre"> of </span><a href="#loc_62_19_62_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_19_62_33&#39;)"><span class="hl_conref"><span class="mpre">IOEncodingUTF8</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">; _ -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
        </span><a name="loc_155_9_155_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_9_155_15&#39;)"><span class="hl_vardecl"><span class="mpre">decode</span></span></a><span class="mpre"> | </span><a href="#loc_154_9_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_13&#39;)"><span class="hl_varref"><span class="mpre">utf8</span></span></a><span class="mpre">      = </span><a href="Distribution.Simple.Utils.html#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_1171_1_1171_9&#39;)"><span class="hl_varref"><span class="mpre">fromUTF8</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Distribution.Simple.Utils.html#loc_1264_1_1264_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_1264_1_1264_21&#39;)"><span class="hl_varref"><span class="mpre">normaliseLineEndings</span></span></a><span class="mpre">
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
    </span><a name="loc_157_5_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_5_157_9&#39;)"><span class="hl_vardecl"><span class="mpre">menv</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_179_1_179_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_24&#39;)"><span class="hl_varref"><span class="mpre">getEffectiveEnvironment</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">envOverrides</span></span><span class="mpre">
    (</span><a name="loc_158_6_158_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_6_158_12&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre">, </span><a name="loc_158_14_158_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_14_158_20&#39;)"><span class="hl_vardecl"><span class="mpre">errors</span></span></a><span class="mpre">, </span><a name="loc_158_22_158_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_22_158_30&#39;)"><span class="hl_vardecl"><span class="mpre">exitCode</span></span></a><span class="mpre">) &lt;- </span><a href="Distribution.Simple.Utils.html#loc_520_1_520_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_520_1_520_18&#39;)"><span class="hl_varref"><span class="mpre">rawSystemStdInOut</span></span></a><span class="mpre"> </span><a href="#loc_145_28_145_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_28_145_37&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre">
                                    </span><span class="hl_varref"><span class="mpre">path</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">args</span></span><span class="mpre">
                                    </span><span class="hl_varref"><span class="mpre">mcwd</span></span><span class="mpre"> </span><a href="#loc_157_5_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_5_157_9&#39;)"><span class="hl_varref"><span class="mpre">menv</span></span></a><span class="mpre">
                                    </span><a href="#loc_166_5_166_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_5_166_10&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> </span><a href="#loc_154_9_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_13&#39;)"><span class="hl_varref"><span class="mpre">utf8</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_158_22_158_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_22_158_30&#39;)"><span class="hl_varref"><span class="mpre">exitCode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ExitSuccess</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
      </span><a href="Distribution.Simple.Utils.html#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_251_1_251_4&#39;)"><span class="hl_varref"><span class="mpre">die</span></span></a><span class="mpre"> </span><a href="#loc_158_14_158_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_14_158_20&#39;)"><span class="hl_varref"><span class="mpre">errors</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_155_9_155_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_9_155_15&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_158_6_158_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_6_158_12&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">)
  where
    </span><a name="loc_166_5_166_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_5_166_10&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> =
      case </span><span class="hl_varref"><span class="mpre">minputStr</span></span><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">       -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_169_14_169_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_14_169_22&#39;)"><span class="hl_vardecl"><span class="mpre">inputStr</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
          case </span><span class="hl_varref"><span class="mpre">encoding</span></span><span class="mpre"> of
            </span><a href="#loc_61_19_61_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_19_61_33&#39;)"><span class="hl_conref"><span class="mpre">IOEncodingText</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_169_14_169_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_14_169_22&#39;)"><span class="hl_varref"><span class="mpre">inputStr</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">)
            </span><a href="#loc_62_19_62_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_19_62_33&#39;)"><span class="hl_conref"><span class="mpre">IOEncodingUTF8</span></span></a><span class="mpre"> -&gt; (</span><a href="Distribution.Simple.Utils.html#loc_1212_1_1212_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.Utils.html#loc_1212_1_1212_7&#39;)"><span class="hl_varref"><span class="mpre">toUTF8</span></span></a><span class="mpre"> </span><a href="#loc_169_14_169_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_14_169_22&#39;)"><span class="hl_varref"><span class="mpre">inputStr</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- use binary mode for utf8</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Return the current environment extended with the given overrides.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_179_1_179_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_24&#39;)"><span class="mpre">getEffectiveEnvironment</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
                        -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)])
</span><a name="loc_179_1_179_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_24&#39;)"><span class="hl_fundecl"><span class="mpre">getEffectiveEnvironment</span></span></a><span class="mpre"> []        = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><a href="#loc_179_1_179_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_24&#39;)"><span class="hl_fundecl"><span class="mpre">getEffectiveEnvironment</span></span></a><span class="mpre"> </span><a name="loc_180_25_180_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_25_180_34&#39;)"><span class="hl_vardecl"><span class="mpre">overrides</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Map.toList</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_183_5_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_5_183_10&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a href="#loc_180_25_180_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_25_180_34&#39;)"><span class="hl_varref"><span class="mpre">overrides</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Map.fromList</span></span><span class="mpre">) </span><a href="Distribution.Compat.Environment.html#loc_18_1_18_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Environment.html#loc_18_1_18_15&#39;)"><span class="hl_varref"><span class="mpre">getEnvironment</span></span></a><span class="mpre">
  where
    </span><a name="loc_183_5_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_5_183_10&#39;)"><span class="hl_fundecl"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a name="loc_183_11_183_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_11_183_13&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre"> </span><a name="loc_183_14_183_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_14_183_17&#39;)"><span class="hl_vardecl"><span class="mpre">env</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="#loc_184_5_184_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_5_184_11&#39;)"><span class="hl_varref"><span class="mpre">update</span></span></a><span class="mpre">) </span><a href="#loc_183_14_183_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_14_183_17&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre"> </span><a href="#loc_183_11_183_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_11_183_13&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">
    </span><a name="loc_184_5_184_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_5_184_11&#39;)"><span class="hl_fundecl"><span class="mpre">update</span></span></a><span class="mpre"> (</span><a name="loc_184_13_184_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_13_184_16&#39;)"><span class="hl_vardecl"><span class="mpre">var</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)  = </span><span class="hl_varref"><span class="mpre">Map.delete</span></span><span class="mpre"> </span><a href="#loc_184_13_184_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_13_184_16&#39;)"><span class="hl_varref"><span class="mpre">var</span></span></a><span class="mpre">
    </span><a href="#loc_184_5_184_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_5_184_11&#39;)"><span class="hl_fundecl"><span class="mpre">update</span></span></a><span class="mpre"> (</span><a name="loc_185_13_185_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_13_185_16&#39;)"><span class="hl_vardecl"><span class="mpre">var</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_185_23_185_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_23_185_26&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">Map.insert</span></span><span class="mpre"> </span><a href="#loc_185_13_185_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_13_185_16&#39;)"><span class="hl_varref"><span class="mpre">var</span></span></a><span class="mpre"> </span><a href="#loc_185_23_185_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_23_185_26&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like the unix xargs program. Useful for when we&#39;ve got very long command</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- lines that might overflow an OS limit on command line length and so you</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- need to invoke a command multiple times to get all the args in.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It takes four template invocations corresponding to the simple, initial,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- middle and last invocations. If the number of args given is small enough</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that we can get away with just a single invocation then the simple one is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- used:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; $ simple args</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If the number of args given means that we need to use multiple invocations</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- then the templates for the initial, middle and last invocations are used:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; $ initial args_0</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; $ middle  args_1</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; $ middle  args_2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   ...</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; $ final   args_n</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_212_1_212_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_28&#39;)"><span class="mpre">multiStageProgramInvocation</span></a><span class="mpre">
  :: </span><a href="#loc_51_6_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_23&#39;)"><span class="hl_tyconref"><span class="mpre">ProgramInvocation</span></span></a><span class="mpre">
  -&gt; (</span><a href="#loc_51_6_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_23&#39;)"><span class="hl_tyconref"><span class="mpre">ProgramInvocation</span></span></a><span class="mpre">, </span><a href="#loc_51_6_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_23&#39;)"><span class="hl_tyconref"><span class="mpre">ProgramInvocation</span></span></a><span class="mpre">, </span><a href="#loc_51_6_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_23&#39;)"><span class="hl_tyconref"><span class="mpre">ProgramInvocation</span></span></a><span class="mpre">)
  -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
  -&gt; [</span><a href="#loc_51_6_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_23&#39;)"><span class="hl_tyconref"><span class="mpre">ProgramInvocation</span></span></a><span class="mpre">]
</span><a name="loc_212_1_212_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_28&#39;)"><span class="hl_fundecl"><span class="mpre">multiStageProgramInvocation</span></span></a><span class="mpre"> </span><a name="loc_212_29_212_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_29_212_35&#39;)"><span class="hl_vardecl"><span class="mpre">simple</span></span></a><span class="mpre"> (</span><a name="loc_212_37_212_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_37_212_44&#39;)"><span class="hl_vardecl"><span class="mpre">initial</span></span></a><span class="mpre">, </span><a name="loc_212_46_212_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_46_212_52&#39;)"><span class="hl_vardecl"><span class="mpre">middle</span></span></a><span class="mpre">, </span><a name="loc_212_54_212_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_54_212_59&#39;)"><span class="hl_vardecl"><span class="mpre">final</span></span></a><span class="mpre">) </span><a name="loc_212_61_212_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_61_212_65&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> =

  let </span><a name="loc_214_7_214_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_7_214_14&#39;)"><span class="hl_fundecl"><span class="mpre">argSize</span></span></a><span class="mpre"> </span><a name="loc_214_15_214_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_15_214_18&#39;)"><span class="hl_vardecl"><span class="mpre">inv</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> (</span><a href="#loc_52_8_52_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_8_52_22&#39;)"><span class="hl_varref"><span class="mpre">progInvokePath</span></span></a><span class="mpre"> </span><a href="#loc_214_15_214_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_15_214_18&#39;)"><span class="hl_varref"><span class="mpre">inv</span></span></a><span class="mpre">)
                   </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> (\</span><a name="loc_215_31_215_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_31_215_32&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_215_33_215_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_33_215_34&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_215_33_215_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_33_215_34&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_215_31_215_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_31_215_32&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (</span><a href="#loc_53_8_53_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_8_53_22&#39;)"><span class="hl_varref"><span class="mpre">progInvokeArgs</span></span></a><span class="mpre"> </span><a href="#loc_214_15_214_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_15_214_18&#39;)"><span class="hl_varref"><span class="mpre">inv</span></span></a><span class="mpre">)
      </span><a name="loc_216_7_216_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_7_216_19&#39;)"><span class="hl_vardecl"><span class="mpre">fixedArgSize</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maximum</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_214_7_214_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_7_214_14&#39;)"><span class="hl_varref"><span class="mpre">argSize</span></span></a><span class="mpre"> [</span><a href="#loc_212_29_212_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_29_212_35&#39;)"><span class="hl_varref"><span class="mpre">simple</span></span></a><span class="mpre">, </span><a href="#loc_212_37_212_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_37_212_44&#39;)"><span class="hl_varref"><span class="mpre">initial</span></span></a><span class="mpre">, </span><a href="#loc_212_46_212_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_46_212_52&#39;)"><span class="hl_varref"><span class="mpre">middle</span></span></a><span class="mpre">, </span><a href="#loc_212_54_212_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_54_212_59&#39;)"><span class="hl_varref"><span class="mpre">final</span></span></a><span class="mpre">])
      </span><a name="loc_217_7_217_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_7_217_16&#39;)"><span class="hl_vardecl"><span class="mpre">chunkSize</span></span></a><span class="mpre">    = </span><a href="#loc_257_1_257_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_19&#39;)"><span class="hl_varref"><span class="mpre">maxCommandLineSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_216_7_216_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_7_216_19&#39;)"><span class="hl_varref"><span class="mpre">fixedArgSize</span></span></a><span class="mpre">

   in case </span><a href="#loc_234_5_234_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_5_234_16&#39;)"><span class="hl_varref"><span class="mpre">splitChunks</span></span></a><span class="mpre"> </span><a href="#loc_217_7_217_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_7_217_16&#39;)"><span class="hl_varref"><span class="mpre">chunkSize</span></span></a><span class="mpre"> </span><a href="#loc_212_61_212_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_61_212_65&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> of
        []     -&gt; [ </span><a href="#loc_212_29_212_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_29_212_35&#39;)"><span class="hl_varref"><span class="mpre">simple</span></span></a><span class="mpre"> ]

        [</span><a name="loc_222_10_222_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_10_222_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">]    -&gt; [ </span><a href="#loc_212_29_212_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_29_212_35&#39;)"><span class="hl_varref"><span class="mpre">simple</span></span></a><span class="mpre">  </span><a href="#loc_232_9_232_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_9_232_21&#39;)"><span class="hl_infix"><span class="mpre">`appendArgs`</span></span></a><span class="mpre"> </span><a href="#loc_222_10_222_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_10_222_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> ]

        [</span><a name="loc_224_10_224_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_10_224_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_224_12_224_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_12_224_14&#39;)"><span class="hl_vardecl"><span class="mpre">c&#39;</span></span></a><span class="mpre">] -&gt; [ </span><a href="#loc_212_37_212_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_37_212_44&#39;)"><span class="hl_varref"><span class="mpre">initial</span></span></a><span class="mpre"> </span><a href="#loc_232_9_232_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_9_232_21&#39;)"><span class="hl_infix"><span class="mpre">`appendArgs`</span></span></a><span class="mpre"> </span><a href="#loc_224_10_224_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_10_224_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> ]
               </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [ </span><a href="#loc_212_54_212_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_54_212_59&#39;)"><span class="hl_varref"><span class="mpre">final</span></span></a><span class="mpre">   </span><a href="#loc_232_9_232_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_9_232_21&#39;)"><span class="hl_infix"><span class="mpre">`appendArgs`</span></span></a><span class="mpre"> </span><a href="#loc_224_12_224_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_12_224_14&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre">]

        (</span><a name="loc_227_10_227_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_10_227_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_227_12_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_12_227_14&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) -&gt; [ </span><a href="#loc_212_37_212_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_37_212_44&#39;)"><span class="hl_varref"><span class="mpre">initial</span></span></a><span class="mpre"> </span><a href="#loc_232_9_232_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_9_232_21&#39;)"><span class="hl_infix"><span class="mpre">`appendArgs`</span></span></a><span class="mpre"> </span><a href="#loc_227_10_227_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_10_227_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> ]
               </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [ </span><a href="#loc_212_46_212_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_46_212_52&#39;)"><span class="hl_varref"><span class="mpre">middle</span></span></a><span class="mpre">  </span><a href="#loc_232_9_232_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_9_232_21&#39;)"><span class="hl_infix"><span class="mpre">`appendArgs`</span></span></a><span class="mpre"> </span><a href="#loc_228_46_228_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_46_228_48&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre">| </span><a name="loc_228_46_228_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_46_228_48&#39;)"><span class="hl_vardecl"><span class="mpre">c&#39;</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">init</span></span><span class="mpre"> </span><a href="#loc_227_12_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_12_227_14&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> ]
               </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [ </span><a href="#loc_212_54_212_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_54_212_59&#39;)"><span class="hl_varref"><span class="mpre">final</span></span></a><span class="mpre">   </span><a href="#loc_232_9_232_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_9_232_21&#39;)"><span class="hl_infix"><span class="mpre">`appendArgs`</span></span></a><span class="mpre"> </span><a href="#loc_229_50_229_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_50_229_52&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre">| let </span><a name="loc_229_50_229_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_50_229_52&#39;)"><span class="hl_vardecl"><span class="mpre">c&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">last</span></span><span class="mpre"> </span><a href="#loc_227_12_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_12_227_14&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> ]

  where
    </span><span class="hl_vardecl"><span class="mpre">inv</span></span><span class="mpre"> </span><a name="loc_232_9_232_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_9_232_21&#39;)"><span class="hl_fundecl"><span class="mpre">`appendArgs`</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">as</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 232, srcSpanStartColumn = 27, srcSpanEndLine = 232, srcSpanEndColumn = 76}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Program/Run.hs&quot;, srcSpanStartLine = 232, srcSpanStartColumn = 31, srcSpanEndLine = 232, srcSpanEndColumn = 32},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distr"><span class="mpre">inv { progInvokeArgs = progInvokeArgs inv ++ as }</span></span><span class="mpre">

    </span><a name="loc_234_5_234_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_5_234_16&#39;)"><span class="hl_fundecl"><span class="mpre">splitChunks</span></span></a><span class="mpre"> </span><a name="loc_234_17_234_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_17_234_20&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_984_1_984_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_984_1_984_8&#39;)"><span class="hl_varref"><span class="mpre">unfoldr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_234_34_234_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_34_234_35&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt;
      if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_234_34_234_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_34_234_35&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> then </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                else </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_238_5_238_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_5_238_10&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a href="#loc_234_17_234_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_17_234_20&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_234_34_234_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_34_234_35&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

    </span><a name="loc_238_5_238_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_5_238_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_238_11_238_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_11_238_14&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> (</span><a name="loc_238_16_238_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_16_238_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_238_16_238_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_16_238_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_238_11_238_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_11_238_14&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><a href="#loc_247_5_247_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_5_247_12&#39;)"><span class="hl_varref"><span class="mpre">toolong</span></span></a><span class="mpre">
    </span><a href="#loc_238_5_238_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_5_238_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_239_11_239_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_11_239_14&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> </span><a name="loc_239_15_239_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_15_239_17&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">    = </span><a href="#loc_241_5_241_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_5_241_11&#39;)"><span class="hl_varref"><span class="mpre">chunk&#39;</span></span></a><span class="mpre"> [] </span><a href="#loc_239_11_239_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_11_239_14&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_239_15_239_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_15_239_17&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">

    </span><a name="loc_241_5_241_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_5_241_11&#39;)"><span class="hl_fundecl"><span class="mpre">chunk&#39;</span></span></a><span class="mpre"> </span><a name="loc_241_12_241_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_12_241_15&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> _   []     = (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_241_12_241_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_12_241_15&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">,[])
    </span><a href="#loc_241_5_241_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_5_241_11&#39;)"><span class="hl_fundecl"><span class="mpre">chunk&#39;</span></span></a><span class="mpre"> </span><a name="loc_242_12_242_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_12_242_15&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_242_16_242_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_16_242_19&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> (</span><a name="loc_242_21_242_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_21_242_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_242_23_242_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_23_242_25&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">)
      | </span><a href="#loc_245_13_245_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_13_245_17&#39;)"><span class="hl_varref"><span class="mpre">len&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_242_16_242_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_16_242_19&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> = </span><a href="#loc_241_5_241_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_5_241_11&#39;)"><span class="hl_varref"><span class="mpre">chunk&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_242_21_242_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_21_242_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_242_12_242_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_12_242_15&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">) (</span><a href="#loc_242_16_242_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_16_242_19&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_245_13_245_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_13_245_17&#39;)"><span class="hl_varref"><span class="mpre">len&#39;</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_242_23_242_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_23_242_25&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_242_12_242_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_12_242_15&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">, </span><a href="#loc_242_21_242_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_21_242_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_242_23_242_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_23_242_25&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">)
      where </span><a name="loc_245_13_245_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_13_245_17&#39;)"><span class="hl_vardecl"><span class="mpre">len&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_242_21_242_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_21_242_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

    </span><a name="loc_247_5_247_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_5_247_12&#39;)"><span class="hl_vardecl"><span class="mpre">toolong</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;multiStageProgramInvocation: a single program arg is larger &quot;</span></span><span class="mpre">
           </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;than the maximum command line length!&quot;</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">--FIXME: discover this at configure time or runtime on unix</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The value is 32k on Windows and posix specifies a minimum of 4k</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- but all sensible unixes use more than 4k.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- we could use getSysVar ArgumentLimit but that&#39;s in the unix lib</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_257_1_257_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_19&#39;)"><span class="mpre">maxCommandLineSize</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_257_1_257_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_19&#39;)"><span class="hl_vardecl"><span class="mpre">maxCommandLineSize</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1024</span></span><span class="mpre">
</span></div></body></html>