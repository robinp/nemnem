<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">
module System.Console.CmdArgs.Explicit.Type where

import Control.Arrow
import Control.Monad
import Data.Char
import Data.List
import Data.Maybe
import Data.Monoid


</span><span class="hl_comment"><span class="mpre">-- | A name, either the name of a flag (@--/foo/@) or the name of a mode.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 1, srcSpanEndLine = 13, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 1, srcSpanEndLine = 13, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/Sys"><span class="mpre">type Name = String</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A help message that goes with either a flag or a mode.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 1, srcSpanEndLine = 16, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 1, srcSpanEndLine = 16, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/Sys"><span class="mpre">type Help = String</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The type of a flag, i.e. @--foo=/TYPE/@.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 1, srcSpanEndLine = 19, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 1, srcSpanEndLine = 19, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/Sys"><span class="mpre">type FlagHelp = String</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- UTILITY</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Parse a boolean, accepts as True: true yes on enabled 1. </span></span><span class="mpre">
</span><a href="#loc_27_1_27_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_10&#39;)"><span class="mpre">parseBool</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_27_1_27_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_10&#39;)"><span class="hl_fundecl"><span class="mpre">parseBool</span></span></a><span class="mpre"> </span><a name="loc_27_11_27_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_11_27_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> | </span><a href="#loc_31_9_31_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_11&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_32_9_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_9_32_13&#39;)"><span class="hl_varref"><span class="mpre">true</span></span></a><span class="mpre">  = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
            | </span><a href="#loc_31_9_31_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_11&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_33_9_33_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_14&#39;)"><span class="hl_varref"><span class="mpre">false</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
    where
        </span><a name="loc_31_9_31_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_11&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><a href="#loc_27_11_27_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_11_27_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
        </span><a name="loc_32_9_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_9_32_13&#39;)"><span class="hl_vardecl"><span class="mpre">true</span></span></a><span class="mpre"> = [</span><span class="hl_string"><span class="mpre">&quot;true&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;yes&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;on&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;enabled&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;1&quot;</span></span><span class="mpre">]
        </span><a name="loc_33_9_33_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_9_33_14&#39;)"><span class="hl_vardecl"><span class="mpre">false</span></span></a><span class="mpre"> = [</span><span class="hl_string"><span class="mpre">&quot;false&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;no&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;off&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;disabled&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;0&quot;</span></span><span class="mpre">]


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- GROUPS</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A group of items (modes or flags). The items are treated as a list, but the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   group structure is used when displaying the help message.</span></span><span class="mpre">
data </span><a name="loc_41_6_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_11&#39;)"><span class="hl_tycondecl"><span class="mpre">Group</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_41_16_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_16_41_21&#39;)"><span class="hl_condecl"><span class="mpre">Group</span></span></a><span class="mpre">
    {</span><a name="loc_42_6_42_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_6_42_18&#39;)"><span class="hl_fielddecl"><span class="mpre">groupUnnamed</span></span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ Normal items.</span></span><span class="mpre">
    ,</span><a name="loc_43_6_43_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_6_43_17&#39;)"><span class="hl_fielddecl"><span class="mpre">groupHidden</span></span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ Items that are hidden (not displayed in the help message).</span></span><span class="mpre">
    ,</span><a name="loc_44_6_44_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_16&#39;)"><span class="hl_fielddecl"><span class="mpre">groupNamed</span></span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">Help</span></span><span class="mpre">, [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">])] </span><span class="hl_comment"><span class="mpre">-- ^ Items that have been grouped, along with a description of each group.</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 7, srcSpanEndLine = 45, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 7, srcSpanEndLine = 45, srcSpanEndColumn = 15}]}) [IHead (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home"><span class="mpre">deriving Show</span></span><span class="mpre"> 

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_41_6_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_11&#39;)"><span class="hl_tyconref"><span class="mpre">Group</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_48_10_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_10_48_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_41_16_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_16_41_21&#39;)"><span class="hl_conref"><span class="mpre">Group</span></span></a><span class="mpre"> </span><a name="loc_48_19_48_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_19_48_20&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_48_21_48_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_21_48_22&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_48_23_48_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_23_48_24&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) = </span><a href="#loc_41_16_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_16_41_21&#39;)"><span class="hl_conref"><span class="mpre">Group</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_48_10_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_10_48_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_48_19_48_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_19_48_20&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_48_10_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_10_48_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_48_21_48_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_21_48_22&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Control.Arrow.html#loc_96_5_96_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_96_5_96_11&#39;)"><span class="hl_varref"><span class="mpre">second</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_48_10_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_10_48_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_48_23_48_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_23_48_24&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)

instance </span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="hl_classref"><span class="mpre">Monoid</span></span></a><span class="mpre"> (</span><a href="#loc_41_6_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_11&#39;)"><span class="hl_tyconref"><span class="mpre">Group</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
    </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">mempty</span></span></a><span class="mpre"> = </span><a href="#loc_41_16_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_16_41_21&#39;)"><span class="hl_conref"><span class="mpre">Group</span></span></a><span class="mpre"> [] [] []
    </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">mappend</span></span></a><span class="mpre"> (</span><a href="#loc_41_16_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_16_41_21&#39;)"><span class="hl_conref"><span class="mpre">Group</span></span></a><span class="mpre"> </span><a name="loc_52_20_52_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_20_52_22&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a name="loc_52_23_52_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_23_52_25&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> </span><a name="loc_52_26_52_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_26_52_28&#39;)"><span class="hl_vardecl"><span class="mpre">x3</span></span></a><span class="mpre">) (</span><a href="#loc_41_16_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_16_41_21&#39;)"><span class="hl_conref"><span class="mpre">Group</span></span></a><span class="mpre"> </span><a name="loc_52_37_52_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_37_52_39&#39;)"><span class="hl_vardecl"><span class="mpre">y1</span></span></a><span class="mpre"> </span><a name="loc_52_40_52_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_40_52_42&#39;)"><span class="hl_vardecl"><span class="mpre">y2</span></span></a><span class="mpre"> </span><a name="loc_52_43_52_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_43_52_45&#39;)"><span class="hl_vardecl"><span class="mpre">y3</span></span></a><span class="mpre">) = </span><a href="#loc_41_16_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_16_41_21&#39;)"><span class="hl_conref"><span class="mpre">Group</span></span></a><span class="mpre"> (</span><a href="#loc_52_20_52_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_20_52_22&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_52_37_52_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_37_52_39&#39;)"><span class="hl_varref"><span class="mpre">y1</span></span></a><span class="mpre">) (</span><a href="#loc_52_23_52_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_23_52_25&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_52_40_52_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_40_52_42&#39;)"><span class="hl_varref"><span class="mpre">y2</span></span></a><span class="mpre">) (</span><a href="#loc_52_26_52_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_26_52_28&#39;)"><span class="hl_varref"><span class="mpre">x3</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_52_43_52_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_43_52_45&#39;)"><span class="hl_varref"><span class="mpre">y3</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Convert a group into a list.</span></span><span class="mpre">
</span><a href="#loc_56_1_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_10&#39;)"><span class="mpre">fromGroup</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_11&#39;)"><span class="hl_tyconref"><span class="mpre">Group</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_56_1_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_10&#39;)"><span class="hl_fundecl"><span class="mpre">fromGroup</span></span></a><span class="mpre"> (</span><a href="#loc_41_16_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_16_41_21&#39;)"><span class="hl_conref"><span class="mpre">Group</span></span></a><span class="mpre"> </span><a name="loc_56_18_56_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_18_56_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_56_20_56_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_20_56_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_56_22_56_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_22_56_23&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">) = </span><a href="#loc_56_18_56_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_18_56_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_56_20_56_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_20_56_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_56_22_56_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_22_56_23&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Convert a list into a group, placing all fields in &#39;groupUnnamed&#39;.</span></span><span class="mpre">
</span><a href="#loc_60_1_60_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_8&#39;)"><span class="mpre">toGroup</span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><a href="#loc_41_6_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_11&#39;)"><span class="hl_tyconref"><span class="mpre">Group</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_60_1_60_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_8&#39;)"><span class="hl_fundecl"><span class="mpre">toGroup</span></span></a><span class="mpre"> </span><a name="loc_60_9_60_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_9_60_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_41_16_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_16_41_21&#39;)"><span class="hl_conref"><span class="mpre">Group</span></span></a><span class="mpre"> </span><a href="#loc_60_9_60_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_9_60_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> [] []


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- TYPES</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A mode. Do not use the &#39;Mode&#39; constructor directly, instead</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   use &#39;mode&#39; to construct the &#39;Mode&#39; and then record updates.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Each mode has three main features:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   * A list of submodes (&#39;modeGroupModes&#39;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   * A list of flags (&#39;modeGroupFlags&#39;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   * Optionally an unnamed argument (&#39;modeArgs&#39;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  To produce the help information for a mode, either use &#39;helpText&#39; or &#39;show&#39;.</span></span><span class="mpre">
data </span><a name="loc_77_6_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_10&#39;)"><span class="hl_tycondecl"><span class="mpre">Mode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_77_15_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_15_77_19&#39;)"><span class="hl_condecl"><span class="mpre">Mode</span></span></a><span class="mpre">
    {</span><a name="loc_78_6_78_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_6_78_20&#39;)"><span class="hl_fielddecl"><span class="mpre">modeGroupModes</span></span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_11&#39;)"><span class="hl_tyconref"><span class="mpre">Group</span></span></a><span class="mpre"> (</span><a href="#loc_77_6_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_10&#39;)"><span class="hl_tyconref"><span class="mpre">Mode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ The available sub-modes</span></span><span class="mpre">
    ,</span><a name="loc_79_6_79_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_6_79_15&#39;)"><span class="hl_fielddecl"><span class="mpre">modeNames</span></span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ The names assigned to this mode (for the root mode, this name is used as the program name)</span></span><span class="mpre">
    ,</span><a name="loc_80_6_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_6_80_15&#39;)"><span class="hl_fielddecl"><span class="mpre">modeValue</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Value to start with</span></span><span class="mpre">
    ,</span><a name="loc_81_6_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_6_81_15&#39;)"><span class="hl_fielddecl"><span class="mpre">modeCheck</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Check the value reprsented by a mode is correct, after applying all flags</span></span><span class="mpre">
    ,</span><a name="loc_82_6_82_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_6_82_16&#39;)"><span class="hl_fielddecl"><span class="mpre">modeReform</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ Given a value, try to generate the input arguments.</span></span><span class="mpre">
    ,</span><a name="loc_83_6_83_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_6_83_18&#39;)"><span class="hl_fielddecl"><span class="mpre">modeExpandAt</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Expand @\@@ arguments with &#39;expandArgsAt&#39;, defaults to &#39;True&#39;, only applied if using an &#39;IO&#39; processing function.</span></span><span class="mpre">
                          </span><span class="hl_comment"><span class="mpre">--   Only the root &#39;Mode&#39;s value will be used.</span></span><span class="mpre">
    ,</span><a name="loc_85_6_85_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_6_85_14&#39;)"><span class="hl_fielddecl"><span class="mpre">modeHelp</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Help</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Help text</span></span><span class="mpre">
    ,</span><a name="loc_86_6_86_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_20&#39;)"><span class="hl_fielddecl"><span class="mpre">modeHelpSuffix</span></span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ A longer help suffix displayed after a mode</span></span><span class="mpre">
    ,</span><a name="loc_87_6_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_6_87_14&#39;)"><span class="hl_fielddecl"><span class="mpre">modeArgs</span></span></a><span class="mpre"> :: ([</span><a href="#loc_143_6_143_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_6_143_9&#39;)"><span class="hl_tyconref"><span class="mpre">Arg</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">], </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><a href="#loc_143_6_143_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_6_143_9&#39;)"><span class="hl_tyconref"><span class="mpre">Arg</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)) </span><span class="hl_comment"><span class="mpre">-- ^ The unnamed arguments, a series of arguments, followed optionally by one for all remaining slots</span></span><span class="mpre">
    ,</span><a name="loc_88_6_88_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_20&#39;)"><span class="hl_fielddecl"><span class="mpre">modeGroupFlags</span></span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_11&#39;)"><span class="hl_tyconref"><span class="mpre">Group</span></span></a><span class="mpre"> (</span><a href="#loc_125_6_125_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_6_125_10&#39;)"><span class="hl_tyconref"><span class="mpre">Flag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ Groups of flags</span></span><span class="mpre">
    }

</span><span class="hl_comment"><span class="mpre">-- | Extract the modes from a &#39;Mode&#39;</span></span><span class="mpre">
</span><a href="#loc_93_1_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_10&#39;)"><span class="mpre">modeModes</span></a><span class="mpre"> :: </span><a href="#loc_77_6_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_10&#39;)"><span class="hl_tyconref"><span class="mpre">Mode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><a href="#loc_77_6_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_10&#39;)"><span class="hl_tyconref"><span class="mpre">Mode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_93_1_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_10&#39;)"><span class="hl_vardecl"><span class="mpre">modeModes</span></span></a><span class="mpre"> = </span><a href="#loc_56_1_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_10&#39;)"><span class="hl_varref"><span class="mpre">fromGroup</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_78_6_78_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_6_78_20&#39;)"><span class="hl_varref"><span class="mpre">modeGroupModes</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Extract the flags from a &#39;Mode&#39;</span></span><span class="mpre">
</span><a href="#loc_97_1_97_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_10&#39;)"><span class="mpre">modeFlags</span></a><span class="mpre"> :: </span><a href="#loc_77_6_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_10&#39;)"><span class="hl_tyconref"><span class="mpre">Mode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><a href="#loc_125_6_125_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_6_125_10&#39;)"><span class="hl_tyconref"><span class="mpre">Flag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_97_1_97_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_10&#39;)"><span class="hl_vardecl"><span class="mpre">modeFlags</span></span></a><span class="mpre"> = </span><a href="#loc_56_1_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_10&#39;)"><span class="hl_varref"><span class="mpre">fromGroup</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_88_6_88_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_20&#39;)"><span class="hl_varref"><span class="mpre">modeGroupFlags</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The &#39;FlagInfo&#39; type has the following meaning:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;              FlagReq     FlagOpt      FlagOptRare/FlagNone</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; -xfoo        -x=foo      -x=foo       -x -foo</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; -x foo       -x=foo      -x foo       -x foo</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; -x=foo       -x=foo      -x=foo       -x=foo</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; --xx foo     --xx=foo    --xx foo     --xx foo</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; --xx=foo     --xx=foo    --xx=foo     --xx=foo</span></span><span class="mpre">
data </span><a name="loc_108_6_108_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_6_108_14&#39;)"><span class="hl_tycondecl"><span class="mpre">FlagInfo</span></span></a><span class="mpre">
    = </span><a name="loc_109_7_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_7_109_14&#39;)"><span class="hl_condecl"><span class="mpre">FlagReq</span></span></a><span class="mpre">             </span><span class="hl_comment"><span class="mpre">-- ^ Required argument</span></span><span class="mpre">
    | </span><a name="loc_110_7_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_7_110_14&#39;)"><span class="hl_condecl"><span class="mpre">FlagOpt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ Optional argument</span></span><span class="mpre">
    | </span><a name="loc_111_7_111_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_7_111_18&#39;)"><span class="hl_condecl"><span class="mpre">FlagOptRare</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Optional argument that requires an = before the value</span></span><span class="mpre">
    | </span><a name="loc_112_7_112_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_7_112_15&#39;)"><span class="hl_condecl"><span class="mpre">FlagNone</span></span></a><span class="mpre">            </span><span class="hl_comment"><span class="mpre">-- ^ No argument</span></span><span class="mpre">
      </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 113, srcSpanStartColumn = 7, srcSpanEndLine = 113, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 113, srcSpanStartColumn = 7, srcSpanEndLine = 113, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10."><span class="mpre">deriving (Eq,Ord,Show)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Extract the value from inside a &#39;FlagOpt&#39; or &#39;FlagOptRare&#39;, or raises an error.</span></span><span class="mpre">
</span><a href="#loc_117_1_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_12&#39;)"><span class="mpre">fromFlagOpt</span></a><span class="mpre"> :: </span><a href="#loc_108_6_108_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_6_108_14&#39;)"><span class="hl_tyconref"><span class="mpre">FlagInfo</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_117_1_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_12&#39;)"><span class="hl_fundecl"><span class="mpre">fromFlagOpt</span></span></a><span class="mpre"> (</span><a href="#loc_110_7_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_7_110_14&#39;)"><span class="hl_conref"><span class="mpre">FlagOpt</span></span></a><span class="mpre"> </span><a name="loc_117_22_117_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_22_117_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_117_22_117_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_22_117_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_117_1_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_12&#39;)"><span class="hl_fundecl"><span class="mpre">fromFlagOpt</span></span></a><span class="mpre"> (</span><a href="#loc_111_7_111_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_7_111_18&#39;)"><span class="hl_conref"><span class="mpre">FlagOptRare</span></span></a><span class="mpre"> </span><a name="loc_118_26_118_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_26_118_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_118_26_118_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_26_118_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A function to take a string, and a value, and either produce an error message</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   (@Left@), or a modified value (@Right@).</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 1, srcSpanEndLine = 122, srcSpanEndColumn = 47}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 1, srcSpanEndLine = 122, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7"><span class="mpre">type Update a = String -&gt; a -&gt; Either String a</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A flag, consisting of a list of flag names and other information.</span></span><span class="mpre">
data </span><a name="loc_125_6_125_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_6_125_10&#39;)"><span class="hl_tycondecl"><span class="mpre">Flag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_125_15_125_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_15_125_19&#39;)"><span class="hl_condecl"><span class="mpre">Flag</span></span></a><span class="mpre">
    {</span><a name="loc_126_6_126_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_6_126_15&#39;)"><span class="hl_fielddecl"><span class="mpre">flagNames</span></span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ The names for the flag.</span></span><span class="mpre">
    ,</span><a name="loc_127_6_127_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_6_127_14&#39;)"><span class="hl_fielddecl"><span class="mpre">flagInfo</span></span></a><span class="mpre"> :: </span><a href="#loc_108_6_108_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_6_108_14&#39;)"><span class="hl_tyconref"><span class="mpre">FlagInfo</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Information about a flag&#39;s arguments.</span></span><span class="mpre">
    ,</span><a name="loc_128_6_128_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_6_128_15&#39;)"><span class="hl_fielddecl"><span class="mpre">flagValue</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Update</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ The way of processing a flag.</span></span><span class="mpre">
    ,</span><a name="loc_129_6_129_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_6_129_14&#39;)"><span class="hl_fielddecl"><span class="mpre">flagType</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FlagHelp</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ The type of data for the flag argument, i.e. FILE\/DIR\/EXT</span></span><span class="mpre">
    ,</span><a name="loc_130_6_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_6_130_14&#39;)"><span class="hl_fielddecl"><span class="mpre">flagHelp</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Help</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ The help message associated with this flag.</span></span><span class="mpre">
    }


</span><span class="hl_comment"><span class="mpre">-- | An unnamed argument. Anything not starting with @-@ is considered an argument,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   apart from @\&quot;-\&quot;@ which is considered to be the argument @\&quot;-\&quot;@, and any arguments</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   following @\&quot;--\&quot;@. For example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; programname arg1 -j - --foo arg3 -- -arg4 --arg5=1 arg6</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Would have the arguments:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; [&quot;arg1&quot;,&quot;-&quot;,&quot;arg3&quot;,&quot;-arg4&quot;,&quot;--arg5=1&quot;,&quot;arg6&quot;]</span></span><span class="mpre">
data </span><a name="loc_143_6_143_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_6_143_9&#39;)"><span class="hl_tycondecl"><span class="mpre">Arg</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_143_14_143_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_14_143_17&#39;)"><span class="hl_condecl"><span class="mpre">Arg</span></span></a><span class="mpre">
    {</span><a name="loc_144_6_144_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_6_144_14&#39;)"><span class="hl_fielddecl"><span class="mpre">argValue</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Update</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ A way of processing the argument.</span></span><span class="mpre">
    ,</span><a name="loc_145_6_145_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_6_145_13&#39;)"><span class="hl_fielddecl"><span class="mpre">argType</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FlagHelp</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ The type of data for the argument, i.e. FILE\/DIR\/EXT</span></span><span class="mpre">
    ,</span><a name="loc_146_6_146_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_16&#39;)"><span class="hl_fielddecl"><span class="mpre">argRequire</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Is at least one of these arguments required, the command line will fail if none are set</span></span><span class="mpre">
    }


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- CHECK FLAGS</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Check that a mode is well formed.</span></span><span class="mpre">
</span><a href="#loc_155_1_155_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_10&#39;)"><span class="mpre">checkMode</span></a><span class="mpre"> :: </span><a href="#loc_77_6_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_10&#39;)"><span class="hl_tyconref"><span class="mpre">Mode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_155_1_155_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_10&#39;)"><span class="hl_fundecl"><span class="mpre">checkMode</span></span></a><span class="mpre"> </span><a name="loc_155_11_155_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_174_1_174_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_174_1_174_5&#39;)"><span class="hl_varref"><span class="mpre">msum</span></span></a><span class="mpre">
    [</span><a href="#loc_168_9_168_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_9_168_19&#39;)"><span class="hl_varref"><span class="mpre">checkNames</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;modes&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_79_6_79_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_6_79_15&#39;)"><span class="hl_varref"><span class="mpre">modeNames</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_93_1_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_10&#39;)"><span class="hl_varref"><span class="mpre">modeModes</span></span></a><span class="mpre"> </span><a href="#loc_155_11_155_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    ,</span><a href="Control.Monad.html#loc_174_1_174_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_174_1_174_5&#39;)"><span class="hl_varref"><span class="mpre">msum</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_155_1_155_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_10&#39;)"><span class="hl_varref"><span class="mpre">checkMode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_93_1_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_10&#39;)"><span class="hl_varref"><span class="mpre">modeModes</span></span></a><span class="mpre"> </span><a href="#loc_155_11_155_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    ,</span><a href="#loc_163_9_163_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_9_163_19&#39;)"><span class="hl_varref"><span class="mpre">checkGroup</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_78_6_78_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_6_78_20&#39;)"><span class="hl_varref"><span class="mpre">modeGroupModes</span></span></a><span class="mpre"> </span><a href="#loc_155_11_155_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    ,</span><a href="#loc_163_9_163_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_9_163_19&#39;)"><span class="hl_varref"><span class="mpre">checkGroup</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_88_6_88_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_20&#39;)"><span class="hl_varref"><span class="mpre">modeGroupFlags</span></span></a><span class="mpre"> </span><a href="#loc_155_11_155_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    ,</span><a href="#loc_168_9_168_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_9_168_19&#39;)"><span class="hl_varref"><span class="mpre">checkNames</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;flag names&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_126_6_126_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_6_126_15&#39;)"><span class="hl_varref"><span class="mpre">flagNames</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_97_1_97_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_10&#39;)"><span class="hl_varref"><span class="mpre">modeFlags</span></span></a><span class="mpre"> </span><a href="#loc_155_11_155_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]
    where
        </span><a href="#loc_163_9_163_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_9_163_19&#39;)"><span class="mpre">checkGroup</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_11&#39;)"><span class="hl_tyconref"><span class="mpre">Group</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
        </span><a name="loc_163_9_163_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_9_163_19&#39;)"><span class="hl_fundecl"><span class="mpre">checkGroup</span></span></a><span class="mpre"> </span><a name="loc_163_20_163_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_20_163_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_174_1_174_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_174_1_174_5&#39;)"><span class="hl_varref"><span class="mpre">msum</span></span></a><span class="mpre">
            [</span><a href="#loc_174_9_174_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_14&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Empty group name&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_44_6_44_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_16&#39;)"><span class="hl_varref"><span class="mpre">groupNamed</span></span></a><span class="mpre"> </span><a href="#loc_163_20_163_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_20_163_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
            ,</span><a href="#loc_174_9_174_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_14&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Empty group contents&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_44_6_44_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_16&#39;)"><span class="hl_varref"><span class="mpre">groupNamed</span></span></a><span class="mpre"> </span><a href="#loc_163_20_163_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_20_163_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]

        </span><a href="#loc_168_9_168_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_9_168_19&#39;)"><span class="mpre">checkNames</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">] -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
        </span><a name="loc_168_9_168_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_9_168_19&#39;)"><span class="hl_fundecl"><span class="mpre">checkNames</span></span></a><span class="mpre"> </span><a name="loc_168_20_168_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_20_168_23&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> </span><a name="loc_168_24_168_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_24_168_26&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_174_9_174_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_14&#39;)"><span class="hl_varref"><span class="mpre">check</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Empty names&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre">) </span><a href="#loc_168_24_168_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_24_168_26&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> do
            </span><a name="loc_169_13_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_13_169_16&#39;)"><span class="hl_vardecl"><span class="mpre">bad</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Maybe.html#loc_109_1_109_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_109_1_109_12&#39;)"><span class="hl_varref"><span class="mpre">listToMaybe</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_168_24_168_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_24_168_26&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="Data.List.html#loc_378_1_378_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_378_1_378_5&#39;)"><span class="hl_infix"><span class="mpre">\\</span></span></a><span class="mpre"> </span><a href="Data.List.html#loc_314_1_314_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_314_1_314_4&#39;)"><span class="hl_varref"><span class="mpre">nub</span></span></a><span class="mpre"> </span><a href="#loc_168_24_168_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_24_168_26&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
            let </span><a name="loc_170_17_170_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_17_170_21&#39;)"><span class="hl_vardecl"><span class="mpre">dupe</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_169_13_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_13_169_16&#39;)"><span class="hl_varref"><span class="mpre">bad</span></span></a><span class="mpre">) </span><a href="#loc_168_24_168_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_24_168_26&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Sanity check failed, multiple &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_168_20_168_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_20_168_23&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Data.List.html#loc_1081_1_1081_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1081_1_1081_8&#39;)"><span class="hl_varref"><span class="mpre">unwords</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_170_17_170_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_17_170_21&#39;)"><span class="hl_varref"><span class="mpre">dupe</span></span></a><span class="mpre">)

        </span><a href="#loc_174_9_174_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_14&#39;)"><span class="mpre">check</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
        </span><a name="loc_174_9_174_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_14&#39;)"><span class="hl_fundecl"><span class="mpre">check</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">msg</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
        </span><a href="#loc_174_9_174_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_14&#39;)"><span class="hl_fundecl"><span class="mpre">check</span></span></a><span class="mpre"> </span><a name="loc_175_15_175_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_15_175_18&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_175_15_175_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_15_175_18&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- REMAP</span></span><span class="mpre">

class </span><a name="loc_181_7_181_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_7_181_12&#39;)"><span class="hl_classdecl"><span class="mpre">Remap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> where
    </span><a name="loc_182_5_182_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_5_182_10&#39;)"><span class="mpre">remap</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ Embed a value</span></span><span class="mpre">
          -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)) </span><span class="hl_comment"><span class="mpre">-- ^ Extract the mode and give a way of re-embedding</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">

</span><a href="#loc_187_1_187_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_7&#39;)"><span class="mpre">remap2</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 186, srcSpanStartColumn = 11, srcSpanEndLine = 186, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 186, srcSpanStartColumn = 19, srcSpanEndLine = 186, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">Remap m =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_187_1_187_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_1_187_7&#39;)"><span class="hl_fundecl"><span class="mpre">remap2</span></span></a><span class="mpre"> </span><a name="loc_187_8_187_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_8_187_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_187_10_187_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_11&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_182_5_182_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_5_182_10&#39;)"><span class="hl_varref"><span class="mpre">remap</span></span></a><span class="mpre"> </span><a href="#loc_187_8_187_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_8_187_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (\</span><a name="loc_187_24_187_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_24_187_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_187_10_187_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_10_187_11&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_187_24_187_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_24_187_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_187_8_187_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_8_187_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">))

instance </span><a href="#loc_181_7_181_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_7_181_12&#39;)"><span class="hl_classref"><span class="mpre">Remap</span></span></a><span class="mpre"> </span><a href="#loc_77_6_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_10&#39;)"><span class="hl_tyconref"><span class="mpre">Mode</span></span></a><span class="mpre"> where
    </span><a href="#loc_182_5_182_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_5_182_10&#39;)"><span class="hl_fundecl"><span class="mpre">remap</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">g</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">x</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 190, srcSpanStartColumn = 19, srcSpanEndLine = 196, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 191, srcSpanStartColumn = 9, srcSpanEndLine = 191, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.1"><span class="mpre">x
        {modeGroupModes = fmap (remap f g) $ modeGroupModes x
        ,modeValue = f $ modeValue x
        ,modeCheck = \v -&gt; let (a,b) = g v in fmap b $ modeCheck x a
        ,modeReform = modeReform x . fst . g
        ,modeArgs = (fmap (remap f g) *** fmap (remap f g)) $ modeArgs x
        ,modeGroupFlags = fmap (remap f g) $ modeGroupFlags x}</span></span><span class="mpre">

instance </span><a href="#loc_181_7_181_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_7_181_12&#39;)"><span class="hl_classref"><span class="mpre">Remap</span></span></a><span class="mpre"> </span><a href="#loc_125_6_125_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_6_125_10&#39;)"><span class="hl_tyconref"><span class="mpre">Flag</span></span></a><span class="mpre"> where
    </span><a href="#loc_182_5_182_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_5_182_10&#39;)"><span class="hl_fundecl"><span class="mpre">remap</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">g</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">x</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 199, srcSpanStartColumn = 19, srcSpanEndLine = 199, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 199, srcSpanStartColumn = 20, srcSpanEndLine = 199, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0."><span class="mpre">x{flagValue = remapUpdate f g $ flagValue x}</span></span><span class="mpre">

instance </span><a href="#loc_181_7_181_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_7_181_12&#39;)"><span class="hl_classref"><span class="mpre">Remap</span></span></a><span class="mpre"> </span><a href="#loc_143_6_143_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_6_143_9&#39;)"><span class="hl_tyconref"><span class="mpre">Arg</span></span></a><span class="mpre"> where
    </span><a href="#loc_182_5_182_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_5_182_10&#39;)"><span class="hl_fundecl"><span class="mpre">remap</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">g</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">x</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 202, srcSpanStartColumn = 19, srcSpanEndLine = 202, srcSpanEndColumn = 61}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 202, srcSpanStartColumn = 20, srcSpanEndLine = 202, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0."><span class="mpre">x{argValue = remapUpdate f g $ argValue x}</span></span><span class="mpre">

</span><a name="loc_204_1_204_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_12&#39;)"><span class="hl_fundecl"><span class="mpre">remapUpdate</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">f</span></span><span class="mpre"> </span><a name="loc_204_15_204_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_15_204_16&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_204_17_204_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_17_204_20&#39;)"><span class="hl_vardecl"><span class="mpre">upd</span></span></a><span class="mpre"> = \</span><a name="loc_204_24_204_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_24_204_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_204_26_204_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_26_204_27&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; let (</span><a name="loc_204_36_204_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_36_204_37&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_204_38_204_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_38_204_39&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_204_15_204_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_15_204_16&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_204_26_204_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_26_204_27&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> in </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_204_38_204_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_38_204_39&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_204_17_204_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_17_204_20&#39;)"><span class="hl_varref"><span class="mpre">upd</span></span></a><span class="mpre"> </span><a href="#loc_204_24_204_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_24_204_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_204_36_204_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_36_204_37&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- MODE/MODES CREATORS</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create an empty mode specifying only &#39;modeValue&#39;. All other fields will usually be populated</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   using record updates.</span></span><span class="mpre">
</span><a href="#loc_213_1_213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_10&#39;)"><span class="mpre">modeEmpty</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_77_6_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_10&#39;)"><span class="hl_tyconref"><span class="mpre">Mode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_213_1_213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_10&#39;)"><span class="hl_fundecl"><span class="mpre">modeEmpty</span></span></a><span class="mpre"> </span><a name="loc_213_11_213_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_11_213_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_77_15_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_15_77_19&#39;)"><span class="hl_conref"><span class="mpre">Mode</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre"> [] </span><a href="#loc_213_11_213_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_11_213_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> [] ([],</span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">) </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create a mode with a name, an initial value, some help text, a way of processing arguments</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   and a list of flags.</span></span><span class="mpre">
</span><a href="#loc_218_1_218_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_1_218_5&#39;)"><span class="mpre">mode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Help</span></span><span class="mpre"> -&gt; </span><a href="#loc_143_6_143_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_6_143_9&#39;)"><span class="hl_tyconref"><span class="mpre">Arg</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><a href="#loc_125_6_125_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_6_125_10&#39;)"><span class="hl_tyconref"><span class="mpre">Flag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><a href="#loc_77_6_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_10&#39;)"><span class="hl_tyconref"><span class="mpre">Mode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_218_1_218_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_1_218_5&#39;)"><span class="hl_fundecl"><span class="mpre">mode</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">name</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">value</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">help</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">arg</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">flags</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 218, srcSpanStartColumn = 34, srcSpanEndLine = 218, srcSpanEndColumn = 138}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 218, srcSpanStartColumn = 51, srcSpanEndLine = 218, srcSpanEndColumn = 52},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0"><span class="mpre">(modeEmpty value){modeNames=[name], modeHelp=help, modeArgs=([],Just arg), modeGroupFlags=toGroup flags}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create a list of modes, with a program name, an initial value, some help text and the child modes.</span></span><span class="mpre">
</span><a href="#loc_222_1_222_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_6&#39;)"><span class="mpre">modes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Help</span></span><span class="mpre"> -&gt; [</span><a href="#loc_77_6_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_10&#39;)"><span class="hl_tyconref"><span class="mpre">Mode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><a href="#loc_77_6_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_10&#39;)"><span class="hl_tyconref"><span class="mpre">Mode</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_222_1_222_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_6&#39;)"><span class="hl_fundecl"><span class="mpre">modes</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">name</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">value</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">help</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">xs</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 222, srcSpanStartColumn = 28, srcSpanEndLine = 222, srcSpanEndColumn = 105}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/Type.hs&quot;, srcSpanStartLine = 222, srcSpanStartColumn = 45, srcSpanEndLine = 222, srcSpanEndColumn = 46},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0"><span class="mpre">(modeEmpty value){modeNames=[name], modeHelp=help, modeGroupModes=toGroup xs}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- FLAG CREATORS</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create a flag taking no argument value, with a list of flag names, an update function</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   and some help text.</span></span><span class="mpre">
</span><a href="#loc_231_1_231_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_1_231_9&#39;)"><span class="mpre">flagNone</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">] -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Help</span></span><span class="mpre"> -&gt; </span><a href="#loc_125_6_125_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_6_125_10&#39;)"><span class="hl_tyconref"><span class="mpre">Flag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_231_1_231_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_1_231_9&#39;)"><span class="hl_fundecl"><span class="mpre">flagNone</span></span></a><span class="mpre"> </span><a name="loc_231_10_231_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_10_231_15&#39;)"><span class="hl_vardecl"><span class="mpre">names</span></span></a><span class="mpre"> </span><a name="loc_231_16_231_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_16_231_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_231_18_231_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_18_231_22&#39;)"><span class="hl_vardecl"><span class="mpre">help</span></span></a><span class="mpre"> = </span><a href="#loc_125_15_125_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_15_125_19&#39;)"><span class="hl_conref"><span class="mpre">Flag</span></span></a><span class="mpre"> </span><a href="#loc_231_10_231_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_10_231_15&#39;)"><span class="hl_varref"><span class="mpre">names</span></span></a><span class="mpre"> </span><a href="#loc_112_7_112_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_7_112_15&#39;)"><span class="hl_conref"><span class="mpre">FlagNone</span></span></a><span class="mpre"> </span><a href="#loc_232_11_232_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_11_232_14&#39;)"><span class="hl_varref"><span class="mpre">upd</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_231_18_231_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_18_231_22&#39;)"><span class="hl_varref"><span class="mpre">help</span></span></a><span class="mpre">
    where </span><a name="loc_232_11_232_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_11_232_14&#39;)"><span class="hl_fundecl"><span class="mpre">upd</span></span></a><span class="mpre"> _ </span><a name="loc_232_17_232_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_17_232_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_231_16_231_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_16_231_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_232_17_232_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_17_232_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create a flag taking an optional argument value, with an optional value, a list of flag names,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   an update function, the type of the argument and some help text.</span></span><span class="mpre">
</span><a href="#loc_237_1_237_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_1_237_8&#39;)"><span class="mpre">flagOpt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Update</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FlagHelp</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Help</span></span><span class="mpre"> -&gt; </span><a href="#loc_125_6_125_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_6_125_10&#39;)"><span class="hl_tyconref"><span class="mpre">Flag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_237_1_237_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_1_237_8&#39;)"><span class="hl_fundecl"><span class="mpre">flagOpt</span></span></a><span class="mpre"> </span><a name="loc_237_9_237_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_9_237_12&#39;)"><span class="hl_vardecl"><span class="mpre">def</span></span></a><span class="mpre"> </span><a name="loc_237_13_237_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_13_237_18&#39;)"><span class="hl_vardecl"><span class="mpre">names</span></span></a><span class="mpre"> </span><a name="loc_237_19_237_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_19_237_22&#39;)"><span class="hl_vardecl"><span class="mpre">upd</span></span></a><span class="mpre"> </span><a name="loc_237_23_237_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_23_237_26&#39;)"><span class="hl_vardecl"><span class="mpre">typ</span></span></a><span class="mpre"> </span><a name="loc_237_27_237_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_27_237_31&#39;)"><span class="hl_vardecl"><span class="mpre">help</span></span></a><span class="mpre"> = </span><a href="#loc_125_15_125_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_15_125_19&#39;)"><span class="hl_conref"><span class="mpre">Flag</span></span></a><span class="mpre"> </span><a href="#loc_237_13_237_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_13_237_18&#39;)"><span class="hl_varref"><span class="mpre">names</span></span></a><span class="mpre"> (</span><a href="#loc_110_7_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_7_110_14&#39;)"><span class="hl_conref"><span class="mpre">FlagOpt</span></span></a><span class="mpre"> </span><a href="#loc_237_9_237_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_9_237_12&#39;)"><span class="hl_varref"><span class="mpre">def</span></span></a><span class="mpre">) </span><a href="#loc_237_19_237_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_19_237_22&#39;)"><span class="hl_varref"><span class="mpre">upd</span></span></a><span class="mpre"> </span><a href="#loc_237_23_237_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_23_237_26&#39;)"><span class="hl_varref"><span class="mpre">typ</span></span></a><span class="mpre"> </span><a href="#loc_237_27_237_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_27_237_31&#39;)"><span class="hl_varref"><span class="mpre">help</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create a flag taking a required argument value, with a list of flag names,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   an update function, the type of the argument and some help text.</span></span><span class="mpre">
</span><a href="#loc_242_1_242_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_8&#39;)"><span class="mpre">flagReq</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Update</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FlagHelp</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Help</span></span><span class="mpre"> -&gt; </span><a href="#loc_125_6_125_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_6_125_10&#39;)"><span class="hl_tyconref"><span class="mpre">Flag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_242_1_242_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_8&#39;)"><span class="hl_fundecl"><span class="mpre">flagReq</span></span></a><span class="mpre"> </span><a name="loc_242_9_242_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_9_242_14&#39;)"><span class="hl_vardecl"><span class="mpre">names</span></span></a><span class="mpre"> </span><a name="loc_242_15_242_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_15_242_18&#39;)"><span class="hl_vardecl"><span class="mpre">upd</span></span></a><span class="mpre"> </span><a name="loc_242_19_242_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_19_242_22&#39;)"><span class="hl_vardecl"><span class="mpre">typ</span></span></a><span class="mpre"> </span><a name="loc_242_23_242_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_23_242_27&#39;)"><span class="hl_vardecl"><span class="mpre">help</span></span></a><span class="mpre"> = </span><a href="#loc_125_15_125_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_15_125_19&#39;)"><span class="hl_conref"><span class="mpre">Flag</span></span></a><span class="mpre"> </span><a href="#loc_242_9_242_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_9_242_14&#39;)"><span class="hl_varref"><span class="mpre">names</span></span></a><span class="mpre"> </span><a href="#loc_109_7_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_7_109_14&#39;)"><span class="hl_conref"><span class="mpre">FlagReq</span></span></a><span class="mpre"> </span><a href="#loc_242_15_242_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_15_242_18&#39;)"><span class="hl_varref"><span class="mpre">upd</span></span></a><span class="mpre"> </span><a href="#loc_242_19_242_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_19_242_22&#39;)"><span class="hl_varref"><span class="mpre">typ</span></span></a><span class="mpre"> </span><a href="#loc_242_23_242_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_23_242_27&#39;)"><span class="hl_varref"><span class="mpre">help</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create an argument flag, with an update function and the type of the argument.</span></span><span class="mpre">
</span><a href="#loc_246_1_246_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_8&#39;)"><span class="mpre">flagArg</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Update</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FlagHelp</span></span><span class="mpre"> -&gt; </span><a href="#loc_143_6_143_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_6_143_9&#39;)"><span class="hl_tyconref"><span class="mpre">Arg</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_246_1_246_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_8&#39;)"><span class="hl_fundecl"><span class="mpre">flagArg</span></span></a><span class="mpre"> </span><a name="loc_246_9_246_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_9_246_12&#39;)"><span class="hl_vardecl"><span class="mpre">upd</span></span></a><span class="mpre"> </span><a name="loc_246_13_246_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_13_246_16&#39;)"><span class="hl_vardecl"><span class="mpre">typ</span></span></a><span class="mpre"> = </span><a href="#loc_143_14_143_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_14_143_17&#39;)"><span class="hl_conref"><span class="mpre">Arg</span></span></a><span class="mpre"> </span><a href="#loc_246_9_246_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_9_246_12&#39;)"><span class="hl_varref"><span class="mpre">upd</span></span></a><span class="mpre"> </span><a href="#loc_246_13_246_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_13_246_16&#39;)"><span class="hl_varref"><span class="mpre">typ</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create a boolean flag, with a list of flag names, an update function and some help text.</span></span><span class="mpre">
</span><a href="#loc_250_1_250_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_1_250_9&#39;)"><span class="mpre">flagBool</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">] -&gt; (</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Help</span></span><span class="mpre"> -&gt; </span><a href="#loc_125_6_125_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_6_125_10&#39;)"><span class="hl_tyconref"><span class="mpre">Flag</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_250_1_250_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_1_250_9&#39;)"><span class="hl_fundecl"><span class="mpre">flagBool</span></span></a><span class="mpre"> </span><a name="loc_250_10_250_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_10_250_15&#39;)"><span class="hl_vardecl"><span class="mpre">names</span></span></a><span class="mpre"> </span><a name="loc_250_16_250_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_16_250_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_250_18_250_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_18_250_22&#39;)"><span class="hl_vardecl"><span class="mpre">help</span></span></a><span class="mpre"> = </span><a href="#loc_125_15_125_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_15_125_19&#39;)"><span class="hl_conref"><span class="mpre">Flag</span></span></a><span class="mpre"> </span><a href="#loc_250_10_250_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_10_250_15&#39;)"><span class="hl_varref"><span class="mpre">names</span></span></a><span class="mpre"> (</span><a href="#loc_111_7_111_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_7_111_18&#39;)"><span class="hl_conref"><span class="mpre">FlagOptRare</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">) </span><a href="#loc_252_9_252_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_9_252_12&#39;)"><span class="hl_varref"><span class="mpre">upd</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_250_18_250_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_18_250_22&#39;)"><span class="hl_varref"><span class="mpre">help</span></span></a><span class="mpre">
    where
        </span><a name="loc_252_9_252_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_9_252_12&#39;)"><span class="hl_fundecl"><span class="mpre">upd</span></span></a><span class="mpre"> </span><a name="loc_252_13_252_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_13_252_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_252_15_252_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_15_252_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = case if </span><a href="#loc_252_13_252_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_13_252_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> then </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> else </span><a href="#loc_27_1_27_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_10&#39;)"><span class="hl_varref"><span class="mpre">parseBool</span></span></a><span class="mpre"> </span><a href="#loc_252_13_252_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_13_252_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_253_18_253_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_18_253_19&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_250_16_250_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_16_250_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_253_18_253_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_18_253_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_252_15_252_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_15_252_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;expected boolean value (true/false)&quot;</span></span><span class="mpre">
</span></div></body></html>