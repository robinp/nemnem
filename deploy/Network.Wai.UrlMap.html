<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings, TypeSynonymInstances, FlexibleInstances #-}
{-# LANGUAGE ExistentialQuantification #-}
</span><span class="hl_comment"><span class="mpre">{- | This module gives you a way to mount applications under sub-URIs.
For example:

&gt; bugsApp, helpdeskApp, apiV1, apiV2, mainApp :: Application
&gt;
&gt; myApp :: Application
&gt; myApp = mapUrls $
&gt;       mount &quot;bugs&quot;     bugsApp
&gt;   &lt;|&gt; mount &quot;helpdesk&quot; helpdeskApp
&gt;   &lt;|&gt; mount &quot;api&quot;
&gt;           (   mount &quot;v1&quot; apiV1
&gt;           &lt;|&gt; mount &quot;v2&quot; apiV2
&gt;           )
&gt;   &lt;|&gt; mountRoot mainApp

-}</span></span><span class="mpre">
module Network.Wai.UrlMap (
    UrlMap&#39;,
    UrlMap,
    mount&#39;,
    mount,
    mountRoot,
    mapUrls
) where

import Control.Applicative
import Data.List
import Data.Text (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="mpre">Text</span></a><span class="mpre">)
import qualified Data.Text as T
import qualified Data.Text.Encoding as T
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 18, srcSpanEndLine = 33, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Network.HTTP.Types
import Network.Wai

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 1, srcSpanEndLine = 37, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 1, srcSpanEndLine = 37, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpa"><span class="mpre">type Path = [Text]</span></span><span class="mpre">
newtype </span><a name="loc_38_9_38_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_16&#39;)"><span class="hl_tycondecl"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_38_21_38_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_28&#39;)"><span class="hl_condecl"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> { </span><a name="loc_38_31_38_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_31_38_39&#39;)"><span class="hl_fielddecl"><span class="mpre">unUrlMap</span></span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">Path</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)] }

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_38_9_38_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_16&#39;)"><span class="hl_tyconref"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_41_10_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_10_41_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_38_21_38_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_28&#39;)"><span class="hl_conref"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> </span><a name="loc_41_21_41_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_21_41_23&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_38_21_38_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_28&#39;)"><span class="hl_conref"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (\(</span><a name="loc_41_44_41_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_44_41_45&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">, </span><a name="loc_41_47_41_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_47_41_48&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_41_44_41_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_44_41_45&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><a href="#loc_41_10_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_10_41_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_41_47_41_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_47_41_48&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)) </span><a href="#loc_41_21_41_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_21_41_23&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

instance </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> </span><a href="#loc_38_9_38_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_16&#39;)"><span class="hl_tyconref"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> where
    </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_fundecl"><span class="mpre">pure</span></span></a><span class="mpre"> </span><a name="loc_44_10_44_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_10_44_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">                        = </span><a href="#loc_38_21_38_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_28&#39;)"><span class="hl_conref"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> [([], </span><a href="#loc_44_10_44_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_10_44_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)]
    (</span><a href="#loc_38_21_38_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_28&#39;)"><span class="hl_conref"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> </span><a name="loc_45_14_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> (</span><a href="#loc_38_21_38_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_28&#39;)"><span class="hl_conref"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> </span><a name="loc_45_31_45_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_31_45_33&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_38_21_38_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_28&#39;)"><span class="hl_conref"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> [ (</span><a href="#loc_46_48_46_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_48_46_49&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">, </span><a href="#loc_47_47_47_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_47_47_48&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_46_51_46_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_51_46_52&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) |
                                              (</span><a name="loc_46_48_46_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_48_46_49&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">, </span><a name="loc_46_51_46_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_51_46_52&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_45_31_45_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_31_45_33&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">,
                                              </span><a name="loc_47_47_47_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_47_47_48&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_45_14_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_14_45_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> ]

instance </span><a href="Control.Applicative.html#loc_138_24_138_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_138_24_138_35&#39;)"><span class="hl_classref"><span class="mpre">Alternative</span></span></a><span class="mpre"> </span><a href="#loc_38_9_38_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_16&#39;)"><span class="hl_tyconref"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> where
    </span><a href="Control.Applicative.html#loc_140_5_140_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_140_5_140_10&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre">                         = </span><a href="#loc_38_21_38_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_28&#39;)"><span class="hl_conref"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_140_5_140_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_140_5_140_10&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">
    (</span><a href="#loc_38_21_38_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_28&#39;)"><span class="hl_conref"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> </span><a name="loc_51_14_51_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_14_51_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> (</span><a href="#loc_38_21_38_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_28&#39;)"><span class="hl_conref"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> </span><a name="loc_51_31_51_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_31_51_33&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><a href="#loc_38_21_38_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_28&#39;)"><span class="hl_conref"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_51_14_51_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_14_51_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="#loc_51_31_51_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_31_51_33&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">)

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 1, srcSpanEndLine = 53, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 1, srcSpanEndLine = 53, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpa"><span class="mpre">type UrlMap = UrlMap&#39; Application</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Mount an application under a given path. The ToApplication typeclass gives</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- you the option to pass either an &#39;Network.Wai.Application&#39; or an &#39;UrlMap&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as the second argument.</span></span><span class="mpre">
</span><a href="#loc_59_1_59_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_7&#39;)"><span class="mpre">mount&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 58, srcSpanStartColumn = 11, srcSpanEndLine = 58, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 58, srcSpanStartColumn = 27, srcSpanEndLine = 58, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-ex"><span class="mpre">ToApplication a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Path</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UrlMap</span></span><span class="mpre">
</span><a name="loc_59_1_59_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_7&#39;)"><span class="hl_fundecl"><span class="mpre">mount&#39;</span></span></a><span class="mpre"> </span><a name="loc_59_8_59_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_8_59_14&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><a name="loc_59_15_59_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_15_59_20&#39;)"><span class="hl_vardecl"><span class="mpre">thing</span></span></a><span class="mpre"> = </span><a href="#loc_38_21_38_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_21_38_28&#39;)"><span class="hl_conref"><span class="mpre">UrlMap&#39;</span></span></a><span class="mpre"> [(</span><a href="#loc_59_8_59_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_8_59_14&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre">, </span><a href="#loc_81_5_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_5_81_18&#39;)"><span class="hl_varref"><span class="mpre">toApplication</span></span></a><span class="mpre"> </span><a href="#loc_59_15_59_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_15_59_20&#39;)"><span class="hl_varref"><span class="mpre">thing</span></span></a><span class="mpre">)]

</span><span class="hl_comment"><span class="mpre">-- | A convenience function like mount&#39;, but for mounting things under a single</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- path segment.</span></span><span class="mpre">
</span><a href="#loc_64_1_64_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_6&#39;)"><span class="mpre">mount</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 10, srcSpanEndLine = 63, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 26, srcSpanEndLine = 63, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-ex"><span class="mpre">ToApplication a =&gt;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UrlMap</span></span><span class="mpre">
</span><a name="loc_64_1_64_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_6&#39;)"><span class="hl_fundecl"><span class="mpre">mount</span></span></a><span class="mpre"> </span><a name="loc_64_7_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_7_64_13&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><a name="loc_64_14_64_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_14_64_19&#39;)"><span class="hl_vardecl"><span class="mpre">thing</span></span></a><span class="mpre"> = </span><a href="#loc_59_1_59_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_7&#39;)"><span class="hl_varref"><span class="mpre">mount&#39;</span></span></a><span class="mpre"> [</span><a href="#loc_64_7_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_7_64_13&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre">] </span><a href="#loc_64_14_64_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_14_64_19&#39;)"><span class="hl_varref"><span class="mpre">thing</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Mount something at the root. Use this for the last application in the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- block, to avoid 500 errors from none of the applications matching.</span></span><span class="mpre">
</span><a href="#loc_69_1_69_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_10&#39;)"><span class="mpre">mountRoot</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 14, srcSpanEndLine = 68, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 30, srcSpanEndLine = 68, srcSpanEndColumn = 32}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-ex"><span class="mpre">ToApplication a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">UrlMap</span></span><span class="mpre">
</span><a name="loc_69_1_69_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_10&#39;)"><span class="hl_vardecl"><span class="mpre">mountRoot</span></span></a><span class="mpre"> = </span><a href="#loc_59_1_59_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_7&#39;)"><span class="hl_varref"><span class="mpre">mount&#39;</span></span></a><span class="mpre"> []

</span><a href="#loc_75_1_75_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_4&#39;)"><span class="mpre">try</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 8, srcSpanEndLine = 72, srcSpanEndColumn = 7}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 5, srcSpanEndLine = 72, srcSpanEndColumn = 7}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-"><span class="mpre">Eq a
    =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ Path info of request</span></span><span class="mpre">
    -&gt; [([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">], </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)] </span><span class="hl_comment"><span class="mpre">-- ^ List of applications to match</span></span><span class="mpre">
    -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> ([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">], </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_75_1_75_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_4&#39;)"><span class="hl_fundecl"><span class="mpre">try</span></span></a><span class="mpre"> </span><a name="loc_75_5_75_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_7&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_75_8_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_8_75_14&#39;)"><span class="hl_vardecl"><span class="mpre">tuples</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> </span><a href="#loc_77_9_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><a href="#loc_75_8_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_8_75_14&#39;)"><span class="hl_varref"><span class="mpre">tuples</span></span></a><span class="mpre">
    where
        </span><a name="loc_77_9_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_77_18_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) _ = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_77_18_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a href="#loc_77_9_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> _ (</span><a name="loc_78_15_78_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_15_78_21&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre">, </span><a name="loc_78_23_78_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_23_78_24&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><a href="Data.List.html#loc_241_1_241_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_241_1_241_12&#39;)"><span class="hl_varref"><span class="mpre">stripPrefix</span></span></a><span class="mpre"> </span><a href="#loc_78_15_78_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_15_78_21&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><a href="#loc_75_5_75_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_7&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_78_55_78_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_55_78_58&#39;)"><span class="hl_vardecl"><span class="mpre">xs&#39;</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_78_55_78_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_55_78_58&#39;)"><span class="hl_varref"><span class="mpre">xs&#39;</span></span></a><span class="mpre">, </span><a href="#loc_78_23_78_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_23_78_24&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)

class </span><a name="loc_80_7_80_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_7_80_20&#39;)"><span class="hl_classdecl"><span class="mpre">ToApplication</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> where
    </span><a name="loc_81_5_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_5_81_18&#39;)"><span class="mpre">toApplication</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">

instance </span><a href="#loc_80_7_80_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_7_80_20&#39;)"><span class="hl_classref"><span class="mpre">ToApplication</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre"> where
    </span><a href="#loc_81_5_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_5_81_18&#39;)"><span class="hl_vardecl"><span class="mpre">toApplication</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">

instance </span><a href="#loc_80_7_80_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_7_80_20&#39;)"><span class="hl_classref"><span class="mpre">ToApplication</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">UrlMap</span></span><span class="mpre"> where
    </span><a href="#loc_81_5_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_5_81_18&#39;)"><span class="hl_fundecl"><span class="mpre">toApplication</span></span></a><span class="mpre"> </span><a name="loc_87_19_87_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_19_87_25&#39;)"><span class="hl_vardecl"><span class="mpre">urlMap</span></span></a><span class="mpre"> </span><a name="loc_87_26_87_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_26_87_29&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> </span><a name="loc_87_30_87_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_30_87_42&#39;)"><span class="hl_vardecl"><span class="mpre">sendResponse</span></span></a><span class="mpre"> =
        case </span><a href="#loc_75_1_75_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_50_6_50_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_50_6_50_14&#39;)"><span class="hl_varref"><span class="mpre">pathInfo</span></span></a><span class="mpre"> </span><a href="#loc_87_26_87_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_26_87_29&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">) (</span><a href="#loc_38_31_38_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_31_38_39&#39;)"><span class="hl_varref"><span class="mpre">unUrlMap</span></span></a><span class="mpre"> </span><a href="#loc_87_19_87_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_19_87_25&#39;)"><span class="hl_varref"><span class="mpre">urlMap</span></span></a><span class="mpre">) of
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_vardecl"><span class="mpre">newPath</span></span><span class="mpre">, </span><a name="loc_89_28_89_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_28_89_31&#39;)"><span class="hl_vardecl"><span class="mpre">app</span></span></a><span class="mpre">) -&gt;
                </span><a href="#loc_89_28_89_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_28_89_31&#39;)"><span class="hl_varref"><span class="mpre">app</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 22, srcSpanEndLine = 92, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 26, srcSpanEndLine = 90, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/UrlMap.hs&quot;, sr"><span class="mpre">req { pathInfo = newPath
                         , rawPathInfo = makeRaw newPath
                         }</span></span><span class="mpre">) </span><a href="#loc_87_30_87_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_30_87_42&#39;)"><span class="hl_varref"><span class="mpre">sendResponse</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt;
                </span><a href="#loc_87_30_87_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_30_87_42&#39;)"><span class="hl_varref"><span class="mpre">sendResponse</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre">
                    </span><a href="Network.HTTP.Types.Status.html#loc_337_1_337_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_337_1_337_10&#39;)"><span class="hl_varref"><span class="mpre">status404</span></span></a><span class="mpre">
                    [(</span><span class="hl_string"><span class="mpre">&quot;content-type&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;text/plain&quot;</span></span><span class="mpre">)]
                    </span><span class="hl_string"><span class="mpre">&quot;Not found\n&quot;</span></span><span class="mpre">

        where
        </span><a href="#loc_101_9_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_16&#39;)"><span class="mpre">makeRaw</span></a><span class="mpre"> :: [</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
        </span><a name="loc_101_9_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_16&#39;)"><span class="hl_vardecl"><span class="mpre">makeRaw</span></span></a><span class="mpre"> = (</span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.append`</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">T.encodeUtf8</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_615_1_615_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_615_1_615_12&#39;)"><span class="hl_varref"><span class="mpre">T.intercalate</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">

</span><a href="#loc_104_1_104_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_8&#39;)"><span class="mpre">mapUrls</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">UrlMap</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">
</span><a name="loc_104_1_104_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_8&#39;)"><span class="hl_vardecl"><span class="mpre">mapUrls</span></span></a><span class="mpre"> = </span><a href="#loc_81_5_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_5_81_18&#39;)"><span class="hl_varref"><span class="mpre">toApplication</span></span></a><span class="mpre">
</span></div></body></html>