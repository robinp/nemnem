<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE RecordWildCards #-}

module Grep(runGrep) where

import Language.Haskell.HLint2
import HSE.All
import Control.Monad
import Data.List
import Util
import Idea


</span><a href="#loc_14_1_14_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_1_14_8&#39;)"><span class="mpre">runGrep</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="HSE.All.html#loc_27_6_27_16" onmouseover="nemnem.highlightLocalToRemote(&#39;HSE.All.html#loc_27_6_27_16&#39;)"><span class="hl_tyconref"><span class="mpre">ParseFlags</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_14_1_14_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_1_14_8&#39;)"><span class="hl_fundecl"><span class="mpre">runGrep</span></span></a><span class="mpre"> </span><a name="loc_14_9_14_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_9_14_16&#39;)"><span class="hl_vardecl"><span class="mpre">pattern</span></span></a><span class="mpre"> </span><a name="loc_14_17_14_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_17_14_22&#39;)"><span class="hl_vardecl"><span class="mpre">flags</span></span></a><span class="mpre"> </span><a name="loc_14_23_14_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_23_14_28&#39;)"><span class="hl_vardecl"><span class="mpre">files</span></span></a><span class="mpre"> = do
    </span><a name="loc_15_5_15_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_5_15_8&#39;)"><span class="hl_vardecl"><span class="mpre">exp</span></span></a><span class="mpre"> &lt;- case </span><span class="hl_varref"><span class="mpre">parseExp</span></span><span class="mpre"> </span><a href="#loc_14_9_14_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_9_14_16&#39;)"><span class="hl_varref"><span class="mpre">pattern</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">ParseOk</span></span><span class="mpre"> </span><a name="loc_16_17_16_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_17_16_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_16_17_16_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_17_16_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">ParseFailed</span></span><span class="mpre"> </span><a name="loc_17_21_17_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_21_17_23&#39;)"><span class="hl_vardecl"><span class="mpre">sl</span></span></a><span class="mpre"> </span><a name="loc_17_24_17_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_24_17_27&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> -&gt;
            </span><a href="Util.html#loc_220_1_220_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Util.html#loc_220_1_220_12&#39;)"><span class="hl_varref"><span class="mpre">exitMessage</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (if </span><span class="hl_string"><span class="mpre">&quot;Parse error&quot;</span></span><span class="mpre"> </span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="hl_infix"><span class="mpre">`isPrefixOf`</span></span></a><span class="mpre"> </span><a href="#loc_17_24_17_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_24_17_27&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> then </span><a href="#loc_17_24_17_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_24_17_27&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> else </span><span class="hl_string"><span class="mpre">&quot;Parse error in pattern: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_17_24_17_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_24_17_27&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
                          </span><a href="#loc_14_9_14_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_9_14_16&#39;)"><span class="hl_varref"><span class="mpre">pattern</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
                          </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">srcColumn</span></span><span class="mpre"> </span><a href="#loc_17_21_17_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_21_17_23&#39;)"><span class="hl_varref"><span class="mpre">sl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;^&quot;</span></span><span class="mpre">
    let </span><a name="loc_21_9_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_9_21_14&#39;)"><span class="hl_vardecl"><span class="mpre">scope</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">scopeCreate</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Module</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">an</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> [] [] []
    let </span><a name="loc_22_9_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_9_22_13&#39;)"><span class="hl_vardecl"><span class="mpre">rule</span></span></a><span class="mpre"> = </span><a href="Hint.All.html#loc_50_1_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Hint.All.html#loc_50_1_50_10&#39;)"><span class="hl_varref"><span class="mpre">hintRules</span></span></a><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">HintRule</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Warning</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;grep&quot;</span></span><span class="mpre"> </span><a href="#loc_21_9_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_9_21_14&#39;)"><span class="hl_varref"><span class="mpre">scope</span></span></a><span class="mpre"> </span><a href="#loc_15_5_15_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_5_15_8&#39;)"><span class="hl_varref"><span class="mpre">exp</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Tuple</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">an</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Boxed</span></span><span class="mpre"> []) </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> []]
    </span><a href="Control.Monad.html#loc_168_1_168_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_168_1_168_6&#39;)"><span class="hl_varref"><span class="mpre">forM_</span></span></a><span class="mpre"> </span><a href="#loc_14_23_14_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_23_14_28&#39;)"><span class="hl_varref"><span class="mpre">files</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_23_20_23_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_20_23_24&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_24_9_24_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_9_24_12&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="HSE.All.html#loc_68_1_68_14" onmouseover="nemnem.highlightLocalToRemote(&#39;HSE.All.html#loc_68_1_68_14&#39;)"><span class="hl_varref"><span class="mpre">parseModuleEx</span></span></a><span class="mpre"> </span><a href="#loc_14_17_14_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_17_14_22&#39;)"><span class="hl_varref"><span class="mpre">flags</span></span></a><span class="mpre"> </span><a href="#loc_23_20_23_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_20_23_24&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        case </span><a href="#loc_24_9_24_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_9_24_12&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ParseError</span></span><span class="mpre"> </span><a name="loc_26_30_26_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_30_26_32&#39;)"><span class="hl_vardecl"><span class="mpre">sl</span></span></a><span class="mpre"> </span><a name="loc_26_33_26_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_33_26_36&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> </span><a name="loc_26_37_26_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_37_26_41&#39;)"><span class="hl_vardecl"><span class="mpre">ctxt</span></span></a><span class="mpre">) -&gt; do
                </span><span class="hl_varref"><span class="mpre">print</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">rawIdea</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Warning</span></span><span class="mpre"> (if </span><span class="hl_string"><span class="mpre">&quot;Parse error&quot;</span></span><span class="mpre"> </span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="hl_infix"><span class="mpre">`isPrefixOf`</span></span></a><span class="mpre"> </span><a href="#loc_26_33_26_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_33_26_36&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> then </span><a href="#loc_26_33_26_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_33_26_36&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> else </span><span class="hl_string"><span class="mpre">&quot;Parse error: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_26_33_26_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_33_26_36&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">mkSrcSpan</span></span><span class="mpre"> </span><a href="#loc_26_30_26_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_30_26_32&#39;)"><span class="hl_varref"><span class="mpre">sl</span></span></a><span class="mpre"> </span><a href="#loc_26_30_26_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_30_26_32&#39;)"><span class="hl_varref"><span class="mpre">sl</span></span></a><span class="mpre">) </span><a href="#loc_26_37_26_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_37_26_41&#39;)"><span class="hl_varref"><span class="mpre">ctxt</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> []
            </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_28_19_28_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_19_28_20&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt;
                </span><a href="Control.Monad.html#loc_168_1_168_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_168_1_168_6&#39;)"><span class="hl_varref"><span class="mpre">forM_</span></span></a><span class="mpre"> (</span><a href="Apply.html#loc_36_1_36_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Apply.html#loc_36_1_36_11&#39;)"><span class="hl_varref"><span class="mpre">applyHints</span></span></a><span class="mpre"> [] </span><a href="#loc_22_9_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_9_22_13&#39;)"><span class="hl_varref"><span class="mpre">rule</span></span></a><span class="mpre"> [</span><a href="#loc_28_19_28_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_19_28_20&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">]) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><span class="hl_vardecl"><span class="mpre">i</span></span><span class="mpre"> -&gt;
                    </span><span class="hl_varref"><span class="mpre">print</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Grep.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 27, srcSpanEndLine = 30, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Grep.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 28, srcSpanEndLine = 30, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/Grep.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 40, srcSpanE"><span class="mpre">i{ideaHint=&quot;&quot;, ideaTo=Nothing}</span></span><span class="mpre">
</span></div></body></html>