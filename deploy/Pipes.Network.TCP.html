<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE RankNTypes #-}

</span><span class="hl_comment"><span class="mpre">-- | This minimal module exports facilities that ease the usage of TCP</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Socket&#39;s in the /Pipes ecosystem/. It is meant to be used together with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the &quot;Network.Simple.TCP&quot; module from the @network-simple@ package, which is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- completely re-exported from this module.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module /does not/ export facilities that would allow you to acquire new</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Socket&#39;s within a pipeline. If you need to do so, then you should use</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;Pipes.Network.TCP.Safe&quot; instead, which exports a similar API to the one</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- exported by this module. However, don&#39;t be confused by the word “safe” in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that module; this module is equally safe to use as long as you don&#39;t try to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- acquire resources within the pipeline.</span></span><span class="mpre">

module Pipes.Network.TCP (
  </span><span class="hl_comment"><span class="mpre">-- * Receiving</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- $receiving</span></span><span class="mpre">
    fromSocket
  , fromSocketTimeout
  </span><span class="hl_comment"><span class="mpre">-- ** Bidirectional pipes</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- $bidirectional</span></span><span class="mpre">
  , fromSocketN
  , fromSocketTimeoutN
  </span><span class="hl_comment"><span class="mpre">-- * Sending</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- $sending</span></span><span class="mpre">
  , toSocket
  , toSocketTimeout
  </span><span class="hl_comment"><span class="mpre">-- * Exports</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- $exports</span></span><span class="mpre">
  , module Network.Simple.TCP
  ) where

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-network-0.6.3/src/Pipes/Network/TCP.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 18, srcSpanEndLine = 33, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">                as B
import           Foreign.C.Error                (</span><a href="Foreign.C.Error.html#loc_467_1_467_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.Error.html#loc_467_1_467_15&#39;)"><span class="mpre">errnoToIOError</span></a><span class="mpre">, </span><a href="Foreign.C.Error.html#loc_234_1_234_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.Error.html#loc_234_1_234_10&#39;)"><span class="mpre">eTIMEDOUT</span></a><span class="mpre">)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-network-0.6.3/src/Pipes/Network/TCP.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 18, srcSpanEndLine = 35, srcSpanEndColumn = 43}, srcInfoPoints = []}) &quot;Network.Socket.ByteString&quot;"><span class="mpre">Network.Socket.ByteString</span></span><span class="mpre">      as NSB
import           Network.Simple.TCP
                  (</span><a href="Network.Simple.TCP.html#loc_126_1_126_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Simple.TCP.html#loc_126_1_126_8&#39;)"><span class="mpre">connect</span></a><span class="mpre">, </span><a href="Network.Simple.TCP.html#loc_165_1_165_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Simple.TCP.html#loc_165_1_165_6&#39;)"><span class="mpre">serve</span></a><span class="mpre">, </span><a href="Network.Simple.TCP.html#loc_190_1_190_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Simple.TCP.html#loc_190_1_190_7&#39;)"><span class="mpre">listen</span></a><span class="mpre">, </span><a href="Network.Simple.TCP.html#loc_209_1_209_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Simple.TCP.html#loc_209_1_209_7&#39;)"><span class="mpre">accept</span></a><span class="mpre">, </span><a href="Network.Simple.TCP.html#loc_225_1_225_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Simple.TCP.html#loc_225_1_225_11&#39;)"><span class="mpre">acceptFork</span></a><span class="mpre">,
                   </span><a href="Network.Simple.TCP.html#loc_265_1_265_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Simple.TCP.html#loc_265_1_265_9&#39;)"><span class="mpre">bindSock</span></a><span class="mpre">, </span><a href="Network.Simple.TCP.html#loc_245_1_245_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Simple.TCP.html#loc_245_1_245_12&#39;)"><span class="mpre">connectSock</span></a><span class="mpre">, </span><a href="Network.Simple.TCP.html#loc_307_1_307_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Simple.TCP.html#loc_307_1_307_5&#39;)"><span class="mpre">recv</span></a><span class="mpre">, </span><a href="Network.Simple.TCP.html#loc_316_1_316_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Simple.TCP.html#loc_316_1_316_5&#39;)"><span class="mpre">send</span></a><span class="mpre">, withSocketsDo,
                   HostName, </span><a href="Network.Simple.Internal.html#loc_17_6_17_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Simple.Internal.html#loc_17_6_17_20&#39;)"><span class="mpre">HostPreference</span></a><span class="mpre">(HostAny, HostIPv4, HostIPv6, Host),
                   ServiceName, SockAddr, Socket)
import           Pipes
import           Pipes.Core
import           System.Timeout                 (</span><a href="System.Timeout.html#loc_79_1_79_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Timeout.html#loc_79_1_79_8&#39;)"><span class="mpre">timeout</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- $receiving</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The following pipes allow you to receive bytes from the remote end.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Besides the pipes below, you might want to use &quot;Network.Simple.TCP&quot;&#39;s</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Network.Simple.TCP.recv&#39;, which happens to be an &#39;Effect&#39;&#39;:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Network.Simple.TCP.recv&#39; :: &#39;MonadIO&#39; m =&gt; &#39;Socket&#39; -&gt; &#39;Int&#39; -&gt; &#39;Effect&#39;&#39; m (&#39;Maybe&#39; &#39;B.ByteString&#39;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Receives bytes from the remote end and sends them downstream.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The number of bytes received at once is always in the interval</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /[1 .. specified maximum]/.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This &#39;Producer&#39;&#39; returns if the remote peer closes its side of the connection</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- or EOF is received.</span></span><span class="mpre">
</span><a href="#loc_75_1_75_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_11&#39;)"><span class="mpre">fromSocket</span></a><span class="mpre">
  :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-network-0.6.3/src/Pipes/Network/TCP.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 6, srcSpanEndLine = 69, srcSpanEndColumn = 5}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-network-0.6.3/src/Pipes/Network/TCP.hs&quot;, srcSpanStartLine = 69, srcSpanStartColumn = 3, srcSpanEndLine = 69, srcSpanEndColumn = 5}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/"><span class="mpre">MonadIO m
  =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Socket</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^Connected socket.</span></span><span class="mpre">
  -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- ^Maximum number of bytes to receive and send</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- dowstream at once. Any positive value is fine, the</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- optimal value depends on how you deal with the</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- received data. Try using @4096@ if you don&#39;t care.</span></span><span class="mpre">
  -&gt; </span><span class="hl_tyconref"><span class="mpre">Producer&#39;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_75_1_75_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_11&#39;)"><span class="hl_fundecl"><span class="mpre">fromSocket</span></span></a><span class="mpre"> </span><a name="loc_75_12_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_12_75_16&#39;)"><span class="hl_vardecl"><span class="mpre">sock</span></span></a><span class="mpre"> </span><a name="loc_75_17_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_17_75_23&#39;)"><span class="hl_vardecl"><span class="mpre">nbytes</span></span></a><span class="mpre"> = </span><a href="#loc_76_5_76_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_5_76_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> where
    </span><a name="loc_76_5_76_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_5_76_9&#39;)"><span class="hl_vardecl"><span class="mpre">loop</span></span></a><span class="mpre"> = do
        </span><a name="loc_77_9_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">NSB.recv</span></span><span class="mpre"> </span><a href="#loc_75_12_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_12_75_16&#39;)"><span class="hl_varref"><span class="mpre">sock</span></span></a><span class="mpre"> </span><a href="#loc_75_17_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_17_75_23&#39;)"><span class="hl_varref"><span class="mpre">nbytes</span></span></a><span class="mpre">)
        if </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_77_9_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
           then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
           else </span><a href="Pipes.html#loc_132_1_132_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_132_1_132_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> </span><a href="#loc_77_9_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_76_5_76_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_5_76_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE fromSocket #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like &#39;fromSocket&#39;, except with the first &#39;Int&#39; argument you can specify</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the maximum time that each interaction with the remote end can take. If such</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- time elapses before the interaction finishes, then an &#39;IOError&#39; exception is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- thrown. The time is specified in microseconds (1 second = 1e6 microseconds).</span></span><span class="mpre">
</span><a href="#loc_90_1_90_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_18&#39;)"><span class="mpre">fromSocketTimeout</span></a><span class="mpre">
  :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-network-0.6.3/src/Pipes/Network/TCP.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 6, srcSpanEndLine = 89, srcSpanEndColumn = 5}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-network-0.6.3/src/Pipes/Network/TCP.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 3, srcSpanEndLine = 89, srcSpanEndColumn = 5}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/"><span class="mpre">MonadIO m
  =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Socket</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Producer&#39;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_90_1_90_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_18&#39;)"><span class="hl_fundecl"><span class="mpre">fromSocketTimeout</span></span></a><span class="mpre"> </span><a name="loc_90_19_90_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_19_90_23&#39;)"><span class="hl_vardecl"><span class="mpre">wait</span></span></a><span class="mpre"> </span><a name="loc_90_24_90_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_24_90_28&#39;)"><span class="hl_vardecl"><span class="mpre">sock</span></span></a><span class="mpre"> </span><a name="loc_90_29_90_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_29_90_35&#39;)"><span class="hl_vardecl"><span class="mpre">nbytes</span></span></a><span class="mpre"> = </span><a href="#loc_91_5_91_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_5_91_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> where
    </span><a name="loc_91_5_91_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_5_91_9&#39;)"><span class="hl_vardecl"><span class="mpre">loop</span></span></a><span class="mpre"> = do
       </span><a name="loc_92_8_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_8_92_11&#39;)"><span class="hl_vardecl"><span class="mpre">mbs</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> (</span><a href="System.Timeout.html#loc_79_1_79_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Timeout.html#loc_79_1_79_8&#39;)"><span class="hl_varref"><span class="mpre">timeout</span></span></a><span class="mpre"> </span><a href="#loc_90_19_90_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_19_90_23&#39;)"><span class="hl_varref"><span class="mpre">wait</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">NSB.recv</span></span><span class="mpre"> </span><a href="#loc_90_24_90_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_24_90_28&#39;)"><span class="hl_varref"><span class="mpre">sock</span></span></a><span class="mpre"> </span><a href="#loc_90_29_90_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_29_90_35&#39;)"><span class="hl_varref"><span class="mpre">nbytes</span></span></a><span class="mpre">))
       case </span><a href="#loc_92_8_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_8_92_11&#39;)"><span class="hl_varref"><span class="mpre">mbs</span></span></a><span class="mpre"> of
          </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_94_16_94_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_16_94_18&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> -&gt; </span><a href="Pipes.html#loc_132_1_132_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_132_1_132_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> </span><a href="#loc_94_16_94_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_16_94_18&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_91_5_91_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_5_91_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
          </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ioError</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Foreign.C.Error.html#loc_467_1_467_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.Error.html#loc_467_1_467_15&#39;)"><span class="hl_varref"><span class="mpre">errnoToIOError</span></span></a><span class="mpre">
             </span><span class="hl_string"><span class="mpre">&quot;Pipes.Network.TCP.fromSocketTimeout&quot;</span></span><span class="mpre"> </span><a href="Foreign.C.Error.html#loc_234_1_234_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.Error.html#loc_234_1_234_10&#39;)"><span class="hl_varref"><span class="mpre">eTIMEDOUT</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE fromSocketTimeout #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- $bidirectional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The following pipes are bidirectional, which means useful data can flow</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- through them upstream and downstream. If you don&#39;t care about bidirectional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- pipes, just skip this section.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like &#39;fromSocket&#39;, except the downstream pipe can specify the maximum</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- number of bytes to receive at once using &#39;request&#39;.</span></span><span class="mpre">
</span><a href="#loc_112_1_112_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_12&#39;)"><span class="mpre">fromSocketN</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-network-0.6.3/src/Pipes/Network/TCP.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 16, srcSpanEndLine = 111, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-network-0.6.3/src/Pipes/Network/TCP.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 26, srcSpanEndLine = 111, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemn"><span class="mpre">MonadIO m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Socket</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Server&#39;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_112_1_112_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_12&#39;)"><span class="hl_fundecl"><span class="mpre">fromSocketN</span></span></a><span class="mpre"> </span><a name="loc_112_13_112_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_13_112_17&#39;)"><span class="hl_vardecl"><span class="mpre">sock</span></span></a><span class="mpre"> = </span><a href="#loc_113_5_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> where
    </span><a name="loc_113_5_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_9&#39;)"><span class="hl_vardecl"><span class="mpre">loop</span></span></a><span class="mpre"> = \</span><a name="loc_113_13_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_13_113_19&#39;)"><span class="hl_vardecl"><span class="mpre">nbytes</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_114_9_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">NSB.recv</span></span><span class="mpre"> </span><a href="#loc_112_13_112_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_13_112_17&#39;)"><span class="hl_varref"><span class="mpre">sock</span></span></a><span class="mpre"> </span><a href="#loc_113_13_113_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_13_113_19&#39;)"><span class="hl_varref"><span class="mpre">nbytes</span></span></a><span class="mpre">)
        if </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_114_9_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
           then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
           else </span><a href="Pipes.Core.html#loc_263_1_263_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Core.html#loc_263_1_263_8&#39;)"><span class="hl_varref"><span class="mpre">respond</span></span></a><span class="mpre"> </span><a href="#loc_114_9_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_113_5_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE fromSocketN #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Like &#39;fromSocketN&#39;, except with the first &#39;Int&#39; argument you can specify</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the maximum time that each interaction with the remote end can take. If such</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- time elapses before the interaction finishes, then an &#39;IOError&#39; exception is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- thrown. The time is specified in microseconds (1 second = 1e6 microseconds).</span></span><span class="mpre">
</span><a href="#loc_128_1_128_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_19&#39;)"><span class="mpre">fromSocketTimeoutN</span></a><span class="mpre">
  :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-network-0.6.3/src/Pipes/Network/TCP.hs&quot;, srcSpanStartLine = 126, srcSpanStartColumn = 6, srcSpanEndLine = 127, srcSpanEndColumn = 5}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-network-0.6.3/src/Pipes/Network/TCP.hs&quot;, srcSpanStartLine = 127, srcSpanStartColumn = 3, srcSpanEndLine = 127, srcSpanEndColumn = 5}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">MonadIO m
  =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Socket</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Server&#39;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_128_1_128_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_19&#39;)"><span class="hl_fundecl"><span class="mpre">fromSocketTimeoutN</span></span></a><span class="mpre"> </span><a name="loc_128_20_128_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_20_128_24&#39;)"><span class="hl_vardecl"><span class="mpre">wait</span></span></a><span class="mpre"> </span><a name="loc_128_25_128_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_25_128_29&#39;)"><span class="hl_vardecl"><span class="mpre">sock</span></span></a><span class="mpre"> = </span><a href="#loc_129_5_129_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_5_129_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> where
    </span><a name="loc_129_5_129_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_5_129_9&#39;)"><span class="hl_vardecl"><span class="mpre">loop</span></span></a><span class="mpre"> = \</span><a name="loc_129_13_129_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_13_129_19&#39;)"><span class="hl_vardecl"><span class="mpre">nbytes</span></span></a><span class="mpre"> -&gt; do
       </span><a name="loc_130_8_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_8_130_11&#39;)"><span class="hl_vardecl"><span class="mpre">mbs</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> (</span><a href="System.Timeout.html#loc_79_1_79_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Timeout.html#loc_79_1_79_8&#39;)"><span class="hl_varref"><span class="mpre">timeout</span></span></a><span class="mpre"> </span><a href="#loc_128_20_128_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_20_128_24&#39;)"><span class="hl_varref"><span class="mpre">wait</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">NSB.recv</span></span><span class="mpre"> </span><a href="#loc_128_25_128_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_25_128_29&#39;)"><span class="hl_varref"><span class="mpre">sock</span></span></a><span class="mpre"> </span><a href="#loc_129_13_129_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_13_129_19&#39;)"><span class="hl_varref"><span class="mpre">nbytes</span></span></a><span class="mpre">))
       case </span><a href="#loc_130_8_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_8_130_11&#39;)"><span class="hl_varref"><span class="mpre">mbs</span></span></a><span class="mpre"> of
          </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_132_16_132_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_16_132_18&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> -&gt; </span><a href="Pipes.Core.html#loc_263_1_263_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.Core.html#loc_263_1_263_8&#39;)"><span class="hl_varref"><span class="mpre">respond</span></span></a><span class="mpre"> </span><a href="#loc_132_16_132_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_16_132_18&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_129_5_129_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_5_129_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
          </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ioError</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Foreign.C.Error.html#loc_467_1_467_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.Error.html#loc_467_1_467_15&#39;)"><span class="hl_varref"><span class="mpre">errnoToIOError</span></span></a><span class="mpre">
             </span><span class="hl_string"><span class="mpre">&quot;Pipes.Network.TCP.fromSocketTimeoutN&quot;</span></span><span class="mpre"> </span><a href="Foreign.C.Error.html#loc_234_1_234_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.Error.html#loc_234_1_234_10&#39;)"><span class="hl_varref"><span class="mpre">eTIMEDOUT</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE fromSocketTimeoutN #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- $sending</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The following pipes allow you to send bytes to the remote end.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Besides the pipes below, you might want to use &quot;Network.Simple.TCP&quot;&#39;s</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Network.Simple.TCP.send&#39;, which happens to be an &#39;Effect&#39;&#39;:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Network.Simple.TCP.send&#39; :: &#39;MonadIO&#39; m =&gt; &#39;Socket&#39; -&gt; &#39;B.ByteString&#39; -&gt; &#39;Effect&#39;&#39; m ()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Sends to the remote end each &#39;B.ByteString&#39; received from upstream.</span></span><span class="mpre">
</span><a href="#loc_155_1_155_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_9&#39;)"><span class="mpre">toSocket</span></a><span class="mpre">
  :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-network-0.6.3/src/Pipes/Network/TCP.hs&quot;, srcSpanStartLine = 152, srcSpanStartColumn = 6, srcSpanEndLine = 153, srcSpanEndColumn = 5}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-network-0.6.3/src/Pipes/Network/TCP.hs&quot;, srcSpanStartLine = 153, srcSpanStartColumn = 3, srcSpanEndLine = 153, srcSpanEndColumn = 5}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">MonadIO m
  =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Socket</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^Connected socket.</span></span><span class="mpre">
  -&gt; </span><span class="hl_tyconref"><span class="mpre">Consumer&#39;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_155_1_155_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_9&#39;)"><span class="hl_fundecl"><span class="mpre">toSocket</span></span></a><span class="mpre"> </span><a name="loc_155_10_155_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_10_155_14&#39;)"><span class="hl_vardecl"><span class="mpre">sock</span></span></a><span class="mpre"> = </span><a href="Pipes.html#loc_150_1_150_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_150_1_150_4&#39;)"><span class="hl_varref"><span class="mpre">for</span></span></a><span class="mpre"> </span><a href="Pipes.html#loc_299_1_299_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_299_1_299_4&#39;)"><span class="hl_varref"><span class="mpre">cat</span></span></a><span class="mpre"> (\</span><a name="loc_155_27_155_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_27_155_28&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><a href="Network.Simple.TCP.html#loc_316_1_316_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Simple.TCP.html#loc_316_1_316_5&#39;)"><span class="hl_varref"><span class="mpre">send</span></span></a><span class="mpre"> </span><a href="#loc_155_10_155_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_10_155_14&#39;)"><span class="hl_varref"><span class="mpre">sock</span></span></a><span class="mpre"> </span><a href="#loc_155_27_155_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_27_155_28&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE toSocket #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like &#39;toSocket&#39;, except with the first &#39;Int&#39; argument you can specify</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the maximum time that each interaction with the remote end can take. If such</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- time elapses before the interaction finishes, then an &#39;IOError&#39; exception is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- thrown. The time is specified in microseconds (1 second = 1e6 microseconds).</span></span><span class="mpre">
</span><a href="#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_16&#39;)"><span class="mpre">toSocketTimeout</span></a><span class="mpre">
  :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-network-0.6.3/src/Pipes/Network/TCP.hs&quot;, srcSpanStartLine = 163, srcSpanStartColumn = 6, srcSpanEndLine = 164, srcSpanEndColumn = 5}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/pipes-network-0.6.3/src/Pipes/Network/TCP.hs&quot;, srcSpanStartLine = 164, srcSpanStartColumn = 3, srcSpanEndLine = 164, srcSpanEndColumn = 5}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">MonadIO m
  =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Socket</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Consumer&#39;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_165_1_165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_16&#39;)"><span class="hl_fundecl"><span class="mpre">toSocketTimeout</span></span></a><span class="mpre"> </span><a name="loc_165_17_165_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_17_165_21&#39;)"><span class="hl_vardecl"><span class="mpre">wait</span></span></a><span class="mpre"> </span><a name="loc_165_22_165_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_22_165_26&#39;)"><span class="hl_vardecl"><span class="mpre">sock</span></span></a><span class="mpre"> = </span><a href="Pipes.html#loc_150_1_150_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_150_1_150_4&#39;)"><span class="hl_varref"><span class="mpre">for</span></span></a><span class="mpre"> </span><a href="Pipes.html#loc_299_1_299_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Pipes.html#loc_299_1_299_4&#39;)"><span class="hl_varref"><span class="mpre">cat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_165_40_165_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_40_165_41&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; do
    </span><a name="loc_166_5_166_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_5_166_7&#39;)"><span class="hl_vardecl"><span class="mpre">mu</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> (</span><a href="System.Timeout.html#loc_79_1_79_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Timeout.html#loc_79_1_79_8&#39;)"><span class="hl_varref"><span class="mpre">timeout</span></span></a><span class="mpre"> </span><a href="#loc_165_17_165_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_17_165_21&#39;)"><span class="hl_varref"><span class="mpre">wait</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">NSB.sendAll</span></span><span class="mpre"> </span><a href="#loc_165_22_165_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_22_165_26&#39;)"><span class="hl_varref"><span class="mpre">sock</span></span></a><span class="mpre"> </span><a href="#loc_165_40_165_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_40_165_41&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">))
    case </span><a href="#loc_166_5_166_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_5_166_7&#39;)"><span class="hl_varref"><span class="mpre">mu</span></span></a><span class="mpre"> of
       </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
       </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ioError</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Foreign.C.Error.html#loc_467_1_467_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.Error.html#loc_467_1_467_15&#39;)"><span class="hl_varref"><span class="mpre">errnoToIOError</span></span></a><span class="mpre">
          </span><span class="hl_string"><span class="mpre">&quot;Pipes.Network.TCP.toSocketTimeout&quot;</span></span><span class="mpre"> </span><a href="Foreign.C.Error.html#loc_234_1_234_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.Error.html#loc_234_1_234_10&#39;)"><span class="hl_varref"><span class="mpre">eTIMEDOUT</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINABLE toSocketTimeout #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- $exports</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [From &quot;Network.Simple.TCP&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     &#39;accept&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     &#39;acceptFork&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     &#39;bindSock&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     &#39;connect&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     &#39;connectSock&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     &#39;HostPreference&#39;(&#39;HostAny&#39;,&#39;HostIPv4&#39;,&#39;HostIPv6&#39;,&#39;Host&#39;),</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     &#39;listen&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     &#39;recv&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     &#39;send&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     &#39;serve&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [From &quot;Network.Socket&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    &#39;HostName&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    &#39;ServiceName&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    &#39;SockAddr&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    &#39;Socket&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    &#39;withSocketsDo&#39;.</span></span><span class="mpre">
</span></div></body></html>