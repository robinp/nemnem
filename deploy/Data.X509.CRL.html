<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.X509.CRL</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Read and Write X509 Certificate Revocation List (CRL).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- follows RFC5280 / RFC6818.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.X509.CRL
    ( CRL(..)
    , RevokedCertificate(..)
    ) where

import Control.Applicative
import Control.Monad.Error

import Data.Time.Clock (</span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="mpre">UTCTime</span></a><span class="mpre">)
import Data.ASN1.Types

import Data.X509.DistinguishedName
import Data.X509.AlgorithmIdentifier
import Data.X509.ExtensionRaw
import Data.X509.Internal

</span><span class="hl_comment"><span class="mpre">-- | Describe a Certificate revocation list</span></span><span class="mpre">
data </span><a name="loc_29_6_29_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_9&#39;)"><span class="hl_tycondecl"><span class="mpre">CRL</span></span></a><span class="mpre"> = </span><a name="loc_29_12_29_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_12_29_15&#39;)"><span class="hl_condecl"><span class="mpre">CRL</span></span></a><span class="mpre">
    { </span><a name="loc_30_7_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_7_30_17&#39;)"><span class="hl_fielddecl"><span class="mpre">crlVersion</span></span></a><span class="mpre">             :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
    , </span><a name="loc_31_7_31_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_7_31_22&#39;)"><span class="hl_fielddecl"><span class="mpre">crlSignatureAlg</span></span></a><span class="mpre">        :: </span><a href="Data.X509.AlgorithmIdentifier.html#loc_39_6_39_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_39_6_39_18&#39;)"><span class="hl_tyconref"><span class="mpre">SignatureALG</span></span></a><span class="mpre">
    , </span><a name="loc_32_7_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_16&#39;)"><span class="hl_fielddecl"><span class="mpre">crlIssuer</span></span></a><span class="mpre">              :: </span><a href="Data.X509.DistinguishedName.html#loc_25_9_25_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.DistinguishedName.html#loc_25_9_25_26&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre">
    , </span><a name="loc_33_7_33_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_20&#39;)"><span class="hl_fielddecl"><span class="mpre">crlThisUpdate</span></span></a><span class="mpre">          :: </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">
    , </span><a name="loc_34_7_34_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_20&#39;)"><span class="hl_fielddecl"><span class="mpre">crlNextUpdate</span></span></a><span class="mpre">          :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">
    , </span><a name="loc_35_7_35_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_7_35_29&#39;)"><span class="hl_fielddecl"><span class="mpre">crlRevokedCertificates</span></span></a><span class="mpre"> :: [</span><a href="#loc_40_6_40_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_24&#39;)"><span class="hl_tyconref"><span class="mpre">RevokedCertificate</span></span></a><span class="mpre">]
    , </span><a name="loc_36_7_36_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_20&#39;)"><span class="hl_fielddecl"><span class="mpre">crlExtensions</span></span></a><span class="mpre">          :: </span><a href="Data.X509.ExtensionRaw.html#loc_29_9_29_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.ExtensionRaw.html#loc_29_9_29_19&#39;)"><span class="hl_tyconref"><span class="mpre">Extensions</span></span></a><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/CRL.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 7, srcSpanEndLine = 37, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/CRL.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 7, srcSpanEndLine = 37, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/CRL.hs&quot;, srcSpanStartLine = 37, srcSpanStartCol"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Describe a revoked certificate identifiable by serial number.</span></span><span class="mpre">
data </span><a name="loc_40_6_40_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_24&#39;)"><span class="hl_tycondecl"><span class="mpre">RevokedCertificate</span></span></a><span class="mpre"> = </span><a name="loc_40_27_40_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_27_40_45&#39;)"><span class="hl_condecl"><span class="mpre">RevokedCertificate</span></span></a><span class="mpre">
    { </span><a name="loc_41_7_41_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_26&#39;)"><span class="hl_fielddecl"><span class="mpre">revokedSerialNumber</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
    , </span><a name="loc_42_7_42_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_18&#39;)"><span class="hl_fielddecl"><span class="mpre">revokedDate</span></span></a><span class="mpre">         :: </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">
    , </span><a name="loc_43_7_43_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_24&#39;)"><span class="hl_fielddecl"><span class="mpre">revokedExtensions</span></span></a><span class="mpre">   :: </span><a href="Data.X509.ExtensionRaw.html#loc_29_9_29_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.ExtensionRaw.html#loc_29_9_29_19&#39;)"><span class="hl_tyconref"><span class="mpre">Extensions</span></span></a><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/CRL.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 7, srcSpanEndLine = 44, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/CRL.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 7, srcSpanEndLine = 44, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/CRL.hs&quot;, srcSpanStartLine = 44, srcSpanStartCol"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

instance </span><a href="Data.ASN1.Types.html#loc_64_7_64_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_64_7_64_17&#39;)"><span class="hl_classref"><span class="mpre">ASN1Object</span></span></a><span class="mpre"> </span><a href="#loc_29_6_29_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_9&#39;)"><span class="hl_tyconref"><span class="mpre">CRL</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">toASN1</span></span></a><span class="mpre"> </span><a name="loc_47_12_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_12_47_15&#39;)"><span class="hl_vardecl"><span class="mpre">crl</span></span></a><span class="mpre"> = </span><a href="#loc_81_1_81_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_10&#39;)"><span class="hl_varref"><span class="mpre">encodeCRL</span></span></a><span class="mpre"> </span><a href="#loc_47_12_47_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_12_47_15&#39;)"><span class="hl_varref"><span class="mpre">crl</span></span></a><span class="mpre">
    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_vardecl"><span class="mpre">fromASN1</span></span></a><span class="mpre"> = </span><a href="Data.ASN1.Parse.html#loc_39_1_39_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_39_1_39_18&#39;)"><span class="hl_varref"><span class="mpre">runParseASN1State</span></span></a><span class="mpre"> </span><a href="#loc_59_1_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_9&#39;)"><span class="hl_varref"><span class="mpre">parseCRL</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- TODO support extension</span></span><span class="mpre">
instance </span><a href="Data.ASN1.Types.html#loc_64_7_64_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_64_7_64_17&#39;)"><span class="hl_classref"><span class="mpre">ASN1Object</span></span></a><span class="mpre"> </span><a href="#loc_40_6_40_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_24&#39;)"><span class="hl_tyconref"><span class="mpre">RevokedCertificate</span></span></a><span class="mpre"> where
    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_fundecl"><span class="mpre">fromASN1</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><a name="loc_52_39_52_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_39_52_45&#39;)"><span class="hl_vardecl"><span class="mpre">serial</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_53_7_53_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_53_7_53_15&#39;)"><span class="hl_conref"><span class="mpre">ASN1Time</span></span></a><span class="mpre"> _ </span><a name="loc_52_59_52_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_59_52_60&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> _ </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_52_80_52_82" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_80_52_82&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) =
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_40_27_40_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_27_40_45&#39;)"><span class="hl_conref"><span class="mpre">RevokedCertificate</span></span></a><span class="mpre"> </span><a href="#loc_52_39_52_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_39_52_45&#39;)"><span class="hl_varref"><span class="mpre">serial</span></span></a><span class="mpre"> </span><a href="#loc_52_59_52_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_59_52_60&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> (</span><a href="Data.X509.ExtensionRaw.html#loc_29_22_29_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.ExtensionRaw.html#loc_29_22_29_32&#39;)"><span class="hl_conref"><span class="mpre">Extensions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">), </span><a href="#loc_52_80_52_82" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_80_52_82&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
    </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_fundecl"><span class="mpre">fromASN1</span></span></a><span class="mpre"> </span><a name="loc_54_14_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_14_54_15&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;fromASN1: X509.RevokedCertificate: unknown format:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_54_14_54_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_14_54_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
    </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">toASN1</span></span></a><span class="mpre"> (</span><a href="#loc_40_27_40_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_27_40_45&#39;)"><span class="hl_conref"><span class="mpre">RevokedCertificate</span></span></a><span class="mpre"> </span><a name="loc_55_32_55_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_32_55_38&#39;)"><span class="hl_vardecl"><span class="mpre">serial</span></span></a><span class="mpre"> </span><a name="loc_55_39_55_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_39_55_43&#39;)"><span class="hl_vardecl"><span class="mpre">time</span></span></a><span class="mpre"> _) = \</span><a name="loc_55_50_55_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_50_55_52&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> -&gt;
        </span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><a href="#loc_55_32_55_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_32_55_38&#39;)"><span class="hl_varref"><span class="mpre">serial</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_53_7_53_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_53_7_53_15&#39;)"><span class="hl_conref"><span class="mpre">ASN1Time</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_39_21_39_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_39_21_39_36&#39;)"><span class="hl_conref"><span class="mpre">TimeGeneralized</span></span></a><span class="mpre"> </span><a href="#loc_55_39_55_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_39_55_43&#39;)"><span class="hl_varref"><span class="mpre">time</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_55_50_55_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_50_55_52&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><a href="#loc_59_1_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_9&#39;)"><span class="mpre">parseCRL</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Parse.html#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><a href="#loc_29_6_29_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_9&#39;)"><span class="hl_tyconref"><span class="mpre">CRL</span></span></a><span class="mpre">
</span><a name="loc_59_1_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_9&#39;)"><span class="hl_vardecl"><span class="mpre">parseCRL</span></span></a><span class="mpre"> = do
    </span><a href="#loc_29_12_29_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_12_29_15&#39;)"><span class="hl_conref"><span class="mpre">CRL</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Parse.html#loc_65_1_65_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_65_1_65_8&#39;)"><span class="hl_varref"><span class="mpre">getNext</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_67_9_67_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_19&#39;)"><span class="hl_varref"><span class="mpre">getVersion</span></span></a><span class="mpre">)
        </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Parse.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">getObject</span></span></a><span class="mpre">
        </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Parse.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">getObject</span></span></a><span class="mpre">
        </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Parse.html#loc_65_1_65_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_65_1_65_8&#39;)"><span class="hl_varref"><span class="mpre">getNext</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_70_9_70_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_22&#39;)"><span class="hl_varref"><span class="mpre">getThisUpdate</span></span></a><span class="mpre">)
        </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_73_9_73_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_22&#39;)"><span class="hl_varref"><span class="mpre">getNextUpdate</span></span></a><span class="mpre">
        </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_78_9_78_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_9_78_31&#39;)"><span class="hl_varref"><span class="mpre">getRevokedCertificates</span></span></a><span class="mpre">
        </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Parse.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">getObject</span></span></a><span class="mpre">
  where </span><a name="loc_67_9_67_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_19&#39;)"><span class="hl_fundecl"><span class="mpre">getVersion</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><a name="loc_67_28_67_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_28_67_29&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_67_28_67_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_28_67_29&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
        </span><a href="#loc_67_9_67_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_19&#39;)"><span class="hl_fundecl"><span class="mpre">getVersion</span></span></a><span class="mpre"> _          = </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unexpected type for version&quot;</span></span><span class="mpre">

        </span><a name="loc_70_9_70_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_22&#39;)"><span class="hl_fundecl"><span class="mpre">getThisUpdate</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.html#loc_53_7_53_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_53_7_53_15&#39;)"><span class="hl_conref"><span class="mpre">ASN1Time</span></span></a><span class="mpre"> _ </span><a name="loc_70_35_70_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_35_70_37&#39;)"><span class="hl_vardecl"><span class="mpre">t1</span></span></a><span class="mpre"> _) = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_70_35_70_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_35_70_37&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre">
        </span><a href="#loc_70_9_70_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_9_70_22&#39;)"><span class="hl_fundecl"><span class="mpre">getThisUpdate</span></span></a><span class="mpre"> _                 = </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bad this update format, expecting time&quot;</span></span><span class="mpre">

        </span><a name="loc_73_9_73_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_22&#39;)"><span class="hl_vardecl"><span class="mpre">getNextUpdate</span></span></a><span class="mpre"> = </span><a href="Data.ASN1.Parse.html#loc_81_1_81_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_81_1_81_13&#39;)"><span class="hl_varref"><span class="mpre">getNextMaybe</span></span></a><span class="mpre"> </span><a href="#loc_75_9_75_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_22&#39;)"><span class="hl_varref"><span class="mpre">timeOrNothing</span></span></a><span class="mpre">

        </span><a name="loc_75_9_75_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_22&#39;)"><span class="hl_fundecl"><span class="mpre">timeOrNothing</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.html#loc_53_7_53_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_53_7_53_15&#39;)"><span class="hl_conref"><span class="mpre">ASN1Time</span></span></a><span class="mpre"> _ </span><a name="loc_75_35_75_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_35_75_40&#39;)"><span class="hl_vardecl"><span class="mpre">tnext</span></span></a><span class="mpre"> _) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_75_35_75_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_35_75_40&#39;)"><span class="hl_varref"><span class="mpre">tnext</span></span></a><span class="mpre">
        </span><a href="#loc_75_9_75_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_22&#39;)"><span class="hl_fundecl"><span class="mpre">timeOrNothing</span></span></a><span class="mpre"> _                    = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

        </span><a name="loc_78_9_78_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_9_78_31&#39;)"><span class="hl_vardecl"><span class="mpre">getRevokedCertificates</span></span></a><span class="mpre"> = </span><a href="Data.ASN1.Parse.html#loc_104_1_104_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_104_1_104_16&#39;)"><span class="hl_varref"><span class="mpre">onNextContainer</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.Parse.html#loc_73_1_73_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_73_1_73_8&#39;)"><span class="hl_varref"><span class="mpre">getMany</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Parse.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Parse.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">getObject</span></span></a><span class="mpre">

</span><a href="#loc_81_1_81_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_10&#39;)"><span class="mpre">encodeCRL</span></a><span class="mpre"> :: </span><a href="#loc_29_6_29_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_9&#39;)"><span class="hl_tyconref"><span class="mpre">CRL</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ASN1S</span></span><span class="mpre">
</span><a name="loc_81_1_81_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_10&#39;)"><span class="hl_fundecl"><span class="mpre">encodeCRL</span></span></a><span class="mpre"> </span><a name="loc_81_11_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_11_81_14&#39;)"><span class="hl_vardecl"><span class="mpre">crl</span></span></a><span class="mpre"> </span><a name="loc_81_15_81_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_15_81_17&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> =
    [</span><a href="Data.ASN1.Types.html#loc_45_7_45_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_45_7_45_13&#39;)"><span class="hl_conref"><span class="mpre">IntVal</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_30_7_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_7_30_17&#39;)"><span class="hl_varref"><span class="mpre">crlVersion</span></span></a><span class="mpre"> </span><a href="#loc_81_11_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_11_81_14&#39;)"><span class="hl_varref"><span class="mpre">crl</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
    </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> (</span><a href="#loc_31_7_31_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_7_31_22&#39;)"><span class="hl_varref"><span class="mpre">crlSignatureAlg</span></span></a><span class="mpre"> </span><a href="#loc_81_11_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_11_81_14&#39;)"><span class="hl_varref"><span class="mpre">crl</span></span></a><span class="mpre">) [] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
    </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> (</span><a href="#loc_32_7_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_7_32_16&#39;)"><span class="hl_varref"><span class="mpre">crlIssuer</span></span></a><span class="mpre"> </span><a href="#loc_81_11_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_11_81_14&#39;)"><span class="hl_varref"><span class="mpre">crl</span></span></a><span class="mpre">) [] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
    [</span><a href="Data.ASN1.Types.html#loc_53_7_53_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_53_7_53_15&#39;)"><span class="hl_conref"><span class="mpre">ASN1Time</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_39_21_39_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_39_21_39_36&#39;)"><span class="hl_conref"><span class="mpre">TimeGeneralized</span></span></a><span class="mpre"> (</span><a href="#loc_33_7_33_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_7_33_20&#39;)"><span class="hl_varref"><span class="mpre">crlThisUpdate</span></span></a><span class="mpre"> </span><a href="#loc_81_11_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_11_81_14&#39;)"><span class="hl_varref"><span class="mpre">crl</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
    (</span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> [] (\</span><a name="loc_86_17_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_18&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> -&gt; [</span><a href="Data.ASN1.Types.html#loc_53_7_53_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_53_7_53_15&#39;)"><span class="hl_conref"><span class="mpre">ASN1Time</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_39_21_39_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_39_21_39_36&#39;)"><span class="hl_conref"><span class="mpre">TimeGeneralized</span></span></a><span class="mpre"> </span><a href="#loc_86_17_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_18&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">]) (</span><a href="#loc_34_7_34_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_20&#39;)"><span class="hl_varref"><span class="mpre">crlNextUpdate</span></span></a><span class="mpre"> </span><a href="#loc_81_11_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_11_81_14&#39;)"><span class="hl_varref"><span class="mpre">crl</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
    [</span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
    </span><a href="#loc_93_5_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_5_93_12&#39;)"><span class="hl_varref"><span class="mpre">revoked</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
    [</span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
    </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> (</span><a href="#loc_36_7_36_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_7_36_20&#39;)"><span class="hl_varref"><span class="mpre">crlExtensions</span></span></a><span class="mpre"> </span><a href="#loc_81_11_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_11_81_14&#39;)"><span class="hl_varref"><span class="mpre">crl</span></span></a><span class="mpre">) [] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
    </span><a href="#loc_81_15_81_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_15_81_17&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
  where
    </span><a name="loc_93_5_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_5_93_12&#39;)"><span class="hl_vardecl"><span class="mpre">revoked</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (\</span><a name="loc_93_27_93_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_27_93_28&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> </span><a href="#loc_93_27_93_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_27_93_28&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> []) (</span><a href="#loc_35_7_35_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_7_35_29&#39;)"><span class="hl_varref"><span class="mpre">crlRevokedCertificates</span></span></a><span class="mpre"> </span><a href="#loc_81_11_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_11_81_14&#39;)"><span class="hl_varref"><span class="mpre">crl</span></span></a><span class="mpre">)
</span></div></body></html>