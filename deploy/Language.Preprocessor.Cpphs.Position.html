<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Position</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  2000-2004 Malcolm Wallace</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Licence     :  LGPL</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Malcolm Wallace &lt;Malcolm.Wallace@cs.york.ac.uk&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  All</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Simple file position information, with recursive inclusion points.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Language.Preprocessor.Cpphs.Position
  ( Posn(..)
  , newfile
  , addcol, newline, tab, newlines, newpos
  , cppline, haskline, cpp2hask
  , filename, lineno, directory
  , cleanPath
  ) where

import Data.List (isPrefixOf)

</span><span class="hl_comment"><span class="mpre">-- | Source positions contain a filename, line, column, and an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   inclusion point, which is itself another source position,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   recursively.</span></span><span class="mpre">
data </span><a name="loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tycondecl"><span class="mpre">Posn</span></span></a><span class="mpre"> = </span><a name="loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_condecl"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre">)
        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/Position.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 9, srcSpanEndLine = 29, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/Position.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 9, srcSpanEndLine = 29, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language"><span class="mpre">deriving (Eq)</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre"> where
      </span><span class="hl_fundecl"><span class="mpre">showsPrec</span></span><span class="mpre"> _ (</span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a name="loc_32_23_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_23_32_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_32_25_32_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_25_32_26&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_32_27_32_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_27_32_28&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_32_29_32_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_29_32_30&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">showString</span></span><span class="mpre"> </span><a href="#loc_32_23_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_23_32_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">
                                 </span><span class="hl_varref"><span class="mpre">showString</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;  at line &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">shows</span></span><span class="mpre"> </span><a href="#loc_32_25_32_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_25_32_26&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">
                                 </span><span class="hl_varref"><span class="mpre">showString</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; col &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">shows</span></span><span class="mpre"> </span><a href="#loc_32_27_32_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_27_32_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">
                                 ( case </span><a href="#loc_32_29_32_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_29_32_30&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> of
                                    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
                                    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_37_42_37_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_42_37_43&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">  -&gt; </span><span class="hl_varref"><span class="mpre">showString</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n    used by  &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">
                                               </span><span class="hl_varref"><span class="mpre">shows</span></span><span class="mpre"> </span><a href="#loc_37_42_37_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_42_37_43&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> )

</span><span class="hl_comment"><span class="mpre">-- | Constructor.  Argument is filename.</span></span><span class="mpre">
</span><a href="#loc_42_1_42_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_8&#39;)"><span class="mpre">newfile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre">
</span><a name="loc_42_1_42_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_8&#39;)"><span class="hl_fundecl"><span class="mpre">newfile</span></span></a><span class="mpre"> </span><a name="loc_42_9_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_13&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> = </span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> (</span><a href="#loc_104_1_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_10&#39;)"><span class="hl_varref"><span class="mpre">cleanPath</span></span></a><span class="mpre"> </span><a href="#loc_42_9_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_13&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Increment column number by given quantity.</span></span><span class="mpre">
</span><a href="#loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="mpre">addcol</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre">
</span><a name="loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="hl_fundecl"><span class="mpre">addcol</span></span></a><span class="mpre"> </span><a name="loc_46_8_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_8_46_9&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a name="loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_46_16_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_16_46_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_46_18_46_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_18_46_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_46_20_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_20_46_21&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_46_16_46_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_16_46_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> (</span><a href="#loc_46_18_46_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_18_46_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_46_8_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_8_46_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><a href="#loc_46_20_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_20_46_21&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Increment row number, reset column to 1.</span></span><span class="mpre">
</span><a href="#loc_51_1_51_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_8&#39;)"><span class="mpre">newline</span></a><span class="mpre"> :: </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--newline (Pn f r _ i) = Pn f (r+1) 1 i</span></span><span class="mpre">
</span><a name="loc_51_1_51_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_8&#39;)"><span class="hl_fundecl"><span class="mpre">newline</span></span></a><span class="mpre"> (</span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a name="loc_51_13_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_51_15_51_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_15_51_16&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> _ </span><a name="loc_51_19_51_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = let </span><a name="loc_51_28_51_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_28_51_30&#39;)"><span class="hl_vardecl"><span class="mpre">r&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_51_15_51_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_15_51_16&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> in </span><a href="#loc_51_28_51_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_28_51_30&#39;)"><span class="hl_varref"><span class="mpre">r&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a href="#loc_51_13_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_51_28_51_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_28_51_30&#39;)"><span class="hl_varref"><span class="mpre">r&#39;</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_51_19_51_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Increment column number, tab stops are every 8 chars.</span></span><span class="mpre">
</span><a href="#loc_55_1_55_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_4&#39;)"><span class="mpre">tab</span></a><span class="mpre">     :: </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre">
</span><a name="loc_55_1_55_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_4&#39;)"><span class="hl_fundecl"><span class="mpre">tab</span></span></a><span class="mpre">     (</span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a name="loc_55_13_55_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_13_55_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_55_15_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_15_55_16&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_55_17_55_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_17_55_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_55_19_55_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_19_55_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a href="#loc_55_13_55_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_13_55_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_55_15_55_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_15_55_16&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> (((</span><a href="#loc_55_17_55_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_17_55_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">`div`</span></span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">*</span></span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><a href="#loc_55_19_55_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_19_55_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Increment row number by given quantity.</span></span><span class="mpre">
</span><a href="#loc_59_1_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_9&#39;)"><span class="mpre">newlines</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre">
</span><a name="loc_59_1_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_9&#39;)"><span class="hl_fundecl"><span class="mpre">newlines</span></span></a><span class="mpre"> </span><a name="loc_59_10_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_10_59_11&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a name="loc_59_16_59_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_16_59_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_59_18_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_18_59_19&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> _ </span><a name="loc_59_22_59_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_22_59_23&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a href="#loc_59_16_59_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_16_59_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_59_18_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_18_59_19&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_59_10_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_10_59_11&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_59_22_59_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_22_59_23&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Update position with a new row, and possible filename.</span></span><span class="mpre">
</span><a href="#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_7&#39;)"><span class="mpre">newpos</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre">
</span><a name="loc_63_1_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_7&#39;)"><span class="hl_fundecl"><span class="mpre">newpos</span></span></a><span class="mpre"> </span><a name="loc_63_8_63_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_8_63_9&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  (</span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a name="loc_63_23_63_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_23_63_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _ </span><a name="loc_63_27_63_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_27_63_28&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_63_29_63_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_29_63_30&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a href="#loc_63_23_63_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_23_63_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_63_8_63_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_8_63_9&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_63_27_63_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_27_63_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_63_29_63_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_29_63_30&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
</span><a href="#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_7&#39;)"><span class="hl_fundecl"><span class="mpre">newpos</span></span></a><span class="mpre"> </span><a name="loc_64_8_64_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_8_64_9&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;&quot;&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_64_21_64_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_21_64_22&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)) (</span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> _ _ </span><a name="loc_64_33_64_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_33_64_34&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_64_35_64_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_35_64_36&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">init</span></span><span class="mpre"> </span><a href="#loc_64_21_64_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_21_64_22&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_64_8_64_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_8_64_9&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_64_33_64_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_33_64_34&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_64_35_64_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_35_64_36&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
</span><a href="#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_7&#39;)"><span class="hl_fundecl"><span class="mpre">newpos</span></span></a><span class="mpre"> </span><a name="loc_65_8_65_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_8_65_9&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_65_16_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_16_65_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)       (</span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> _ _ </span><a name="loc_65_33_65_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_33_65_34&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_65_35_65_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_35_65_36&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a href="#loc_65_16_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_16_65_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_65_8_65_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_8_65_9&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_65_33_65_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_33_65_34&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_65_35_65_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_35_65_36&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Project the line number.</span></span><span class="mpre">
</span><a href="#loc_74_1_74_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_7&#39;)"><span class="mpre">lineno</span></a><span class="mpre">    :: </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Project the filename.</span></span><span class="mpre">
</span><a href="#loc_75_1_75_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_9&#39;)"><span class="mpre">filename</span></a><span class="mpre">  :: </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Project the directory of the filename.</span></span><span class="mpre">
</span><a href="#loc_76_1_76_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_10&#39;)"><span class="mpre">directory</span></a><span class="mpre"> :: </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">

</span><a name="loc_74_1_74_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_7&#39;)"><span class="hl_fundecl"><span class="mpre">lineno</span></span></a><span class="mpre">    (</span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> _ </span><a name="loc_74_17_74_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_18&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> _ _) = </span><a href="#loc_74_17_74_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_18&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><a name="loc_75_1_75_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_9&#39;)"><span class="hl_fundecl"><span class="mpre">filename</span></span></a><span class="mpre">  (</span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a name="loc_75_15_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _ _ _) = </span><a href="#loc_75_15_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
</span><a name="loc_76_1_76_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_10&#39;)"><span class="hl_fundecl"><span class="mpre">directory</span></span></a><span class="mpre"> (</span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a name="loc_76_15_76_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_15_76_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _ _ _) = </span><a href="#loc_97_1_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_8&#39;)"><span class="hl_varref"><span class="mpre">dirname</span></span></a><span class="mpre"> </span><a href="#loc_76_15_76_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_15_76_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | cpp-style printing of file position</span></span><span class="mpre">
</span><a href="#loc_81_1_81_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_8&#39;)"><span class="mpre">cppline</span></a><span class="mpre"> :: </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_81_1_81_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_8&#39;)"><span class="hl_fundecl"><span class="mpre">cppline</span></span></a><span class="mpre"> (</span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a name="loc_81_13_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_13_81_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_81_15_81_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_15_81_16&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> _ _) = </span><span class="hl_string"><span class="mpre">&quot;#line &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_81_15_81_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_15_81_16&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_81_13_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_13_81_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | haskell-style printing of file position</span></span><span class="mpre">
</span><a href="#loc_85_1_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_9&#39;)"><span class="mpre">haskline</span></a><span class="mpre"> :: </span><a href="#loc_28_6_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_10&#39;)"><span class="hl_tyconref"><span class="mpre">Posn</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_85_1_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_9&#39;)"><span class="hl_fundecl"><span class="mpre">haskline</span></span></a><span class="mpre"> (</span><a href="#loc_28_13_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_15&#39;)"><span class="hl_conref"><span class="mpre">Pn</span></span></a><span class="mpre"> </span><a name="loc_85_14_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_85_16_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_16_85_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> _ _) = </span><span class="hl_string"><span class="mpre">&quot;{-# LINE &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_85_16_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_16_85_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_85_14_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot; #-}&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Conversion from a cpp-style &quot;#line&quot; to haskell-style pragma.</span></span><span class="mpre">
</span><a href="#loc_89_1_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_9&#39;)"><span class="mpre">cpp2hask</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_89_1_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_9&#39;)"><span class="hl_fundecl"><span class="mpre">cpp2hask</span></span></a><span class="mpre"> </span><a name="loc_89_10_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_10_89_14&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> | </span><span class="hl_string"><span class="mpre">&quot;#line&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`isPrefixOf`</span></span><span class="mpre"> </span><a href="#loc_89_10_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_10_89_14&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;{-# LINE &quot;</span></span><span class="mpre">
                                            </span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">unwords</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">words</span></span><span class="mpre"> </span><a href="#loc_89_10_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_10_89_14&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">))
                                            </span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot; #-}&quot;</span></span><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_89_10_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_10_89_14&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Strip non-directory suffix from file name (analogous to the shell</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   command of the same name).</span></span><span class="mpre">
</span><a href="#loc_97_1_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_8&#39;)"><span class="mpre">dirname</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_97_1_97_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_8&#39;)"><span class="hl_vardecl"><span class="mpre">dirname</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_98_9_98_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_17&#39;)"><span class="hl_varref"><span class="mpre">safetail</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">(</span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="hl_string"><span class="mpre">&quot;\\/&quot;</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre">
  where </span><a name="loc_98_9_98_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_17&#39;)"><span class="hl_fundecl"><span class="mpre">safetail</span></span></a><span class="mpre"> [] = []
        </span><a href="#loc_98_9_98_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_17&#39;)"><span class="hl_fundecl"><span class="mpre">safetail</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_99_21_99_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_21_99_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_99_21_99_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_21_99_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Sigh.  Mixing Windows filepaths with unix is bad.  Make sure there is a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   canonical path separator.</span></span><span class="mpre">
</span><a href="#loc_104_1_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_10&#39;)"><span class="mpre">cleanPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_104_1_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_10&#39;)"><span class="hl_fundecl"><span class="mpre">cleanPath</span></span></a><span class="mpre"> [] = []
</span><a href="#loc_104_1_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_10&#39;)"><span class="hl_fundecl"><span class="mpre">cleanPath</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\\&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_105_17_105_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_19&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) = </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_104_1_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_10&#39;)"><span class="hl_varref"><span class="mpre">cleanPath</span></span></a><span class="mpre"> </span><a href="#loc_105_17_105_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_19&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
</span><a href="#loc_104_1_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_10&#39;)"><span class="hl_fundecl"><span class="mpre">cleanPath</span></span></a><span class="mpre"> (</span><a name="loc_106_12_106_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_12_106_13&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_106_14_106_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_14_106_16&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)    = </span><a href="#loc_106_12_106_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_12_106_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">   </span><a href="#loc_104_1_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_10&#39;)"><span class="hl_varref"><span class="mpre">cleanPath</span></span></a><span class="mpre"> </span><a href="#loc_106_14_106_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_14_106_16&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

</span></div></body></html>