<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE ExistentialQuantification #-}
{-# LANGUAGE PatternGuards #-}
{-# LANGUAGE TypeFamilies #-}
{-# LANGUAGE RankNTypes #-}
</span><span class="hl_comment"><span class="mpre">-- | Some helpers for parsing data out of a raw WAI &#39;Request&#39;.</span></span><span class="mpre">

module Network.Wai.Parse
    ( parseHttpAccept
    , parseRequestBody
    , RequestBodyType (..)
    , getRequestBodyType
    , sinkRequestBody
    , BackEnd
    , lbsBackEnd
    , tempFileBackEnd
    , tempFileBackEndOpts
    , Param
    , File
    , FileInfo (..)
    , parseContentType
#if TEST
    , Bound (..)
    , findBound
    , sinkTillBound
    , killCR
    , killCRLF
    , takeLine
#endif
    ) where

import qualified Data.ByteString.Search as Search
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 18, srcSpanEndLine = 34, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 18, srcSpanEndLine = 35, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 18, srcSpanEndLine = 36, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as S8
import Data.Word (Word8)
import Data.Maybe (</span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="mpre">fromMaybe</span></a><span class="mpre">)
import Data.List (</span><a href="Data.List.html#loc_810_1_810_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_810_1_810_7&#39;)"><span class="mpre">sortBy</span></a><span class="mpre">)
import Data.Function (</span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="mpre">on</span></a><span class="mpre">, </span><a href="Data.Function.html#loc_32_1_32_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_32_1_32_4&#39;)"><span class="mpre">fix</span></a><span class="mpre">)
import System.Directory (</span><a href="System.Directory.html#loc_400_1_400_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_400_1_400_11&#39;)"><span class="mpre">removeFile</span></a><span class="mpre">, </span><a href="System.Directory.html#loc_906_1_906_22" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_906_1_906_22&#39;)"><span class="mpre">getTemporaryDirectory</span></a><span class="mpre">)
import System.IO (</span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="mpre">hClose</span></a><span class="mpre">, </span><a href="System.IO.html#loc_450_1_450_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_450_1_450_19&#39;)"><span class="mpre">openBinaryTempFile</span></a><span class="mpre">)
import Network.Wai
import qualified Network.HTTP.Types as H
import Control.Monad (</span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="mpre">unless</span></a><span class="mpre">)
import Control.Monad.Trans.Resource (</span><a href="Control.Monad.Trans.Resource.html#loc_138_1_138_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Resource.html#loc_138_1_138_9&#39;)"><span class="mpre">allocate</span></a><span class="mpre">, </span><a href="Control.Monad.Trans.Resource.html#loc_115_1_115_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Resource.html#loc_115_1_115_8&#39;)"><span class="mpre">release</span></a><span class="mpre">, </span><a href="Control.Monad.Trans.Resource.html#loc_108_1_108_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Resource.html#loc_108_1_108_9&#39;)"><span class="mpre">register</span></a><span class="mpre">, InternalState, </span><a href="Control.Monad.Trans.Resource.html#loc_356_1_356_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Resource.html#loc_356_1_356_17&#39;)"><span class="mpre">runInternalState</span></a><span class="mpre">)
import Data.IORef

</span><a href="#loc_50_1_50_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_13&#39;)"><span class="mpre">breakDiscard</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)
</span><a name="loc_50_1_50_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_13&#39;)"><span class="hl_fundecl"><span class="mpre">breakDiscard</span></span></a><span class="mpre"> </span><a name="loc_50_14_50_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_14_50_15&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_50_16_50_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_16_50_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
    let (</span><a name="loc_51_10_51_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_10_51_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_51_13_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_14&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_50_14_50_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_14_50_15&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) </span><a href="#loc_50_16_50_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_16_50_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
     in (</span><a href="#loc_51_10_51_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_10_51_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_51_13_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_14&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Parse the HTTP accept string to determine supported content types.</span></span><span class="mpre">
</span><a href="#loc_56_1_56_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_16&#39;)"><span class="mpre">parseHttpAccept</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]
</span><a name="loc_56_1_56_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_16&#39;)"><span class="hl_vardecl"><span class="mpre">parseHttpAccept</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.List.html#loc_810_1_810_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_810_1_810_7&#39;)"><span class="hl_varref"><span class="mpre">sortBy</span></span></a><span class="mpre"> (</span><a href="#loc_62_5_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_13&#39;)"><span class="hl_varref"><span class="mpre">rcompare</span></span></a><span class="mpre"> </span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="hl_infix"><span class="mpre">`on`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">)
                </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_63_5_63_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_19&#39;)"><span class="hl_varref"><span class="mpre">addSpecificity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_68_5_68_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_5_68_10&#39;)"><span class="hl_varref"><span class="mpre">grabQ</span></span></a><span class="mpre">)
                </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.split</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">44</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- comma</span></span><span class="mpre">
  where
    </span><a href="#loc_62_5_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_13&#39;)"><span class="mpre">rcompare</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Ordering</span></span><span class="mpre">
    </span><a name="loc_62_5_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_13&#39;)"><span class="hl_vardecl"><span class="mpre">rcompare</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre">
    </span><a name="loc_63_5_63_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_19&#39;)"><span class="hl_fundecl"><span class="mpre">addSpecificity</span></span></a><span class="mpre"> (</span><a name="loc_63_21_63_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_21_63_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_63_24_63_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_24_63_25&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">) =
        </span><span class="hl_comment"><span class="mpre">-- Prefer higher-specificity types</span></span><span class="mpre">
        let </span><a name="loc_65_13_65_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_13_65_23&#39;)"><span class="hl_vardecl"><span class="mpre">semicolons</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.count</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3B</span></span><span class="mpre"> </span><a href="#loc_63_21_63_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_21_63_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
            </span><a name="loc_66_13_66_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_18&#39;)"><span class="hl_vardecl"><span class="mpre">stars</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.count</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x2A</span></span><span class="mpre"> </span><a href="#loc_63_21_63_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_21_63_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
        in (</span><a href="#loc_63_21_63_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_21_63_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, (</span><a href="#loc_63_24_63_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_24_63_25&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">, </span><a href="#loc_65_13_65_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_13_65_23&#39;)"><span class="hl_varref"><span class="mpre">semicolons</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_66_13_66_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_18&#39;)"><span class="hl_varref"><span class="mpre">stars</span></span></a><span class="mpre">))
    </span><a name="loc_68_5_68_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_5_68_10&#39;)"><span class="hl_fundecl"><span class="mpre">grabQ</span></span></a><span class="mpre"> </span><a name="loc_68_11_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
        </span><span class="hl_comment"><span class="mpre">-- Stripping all spaces may be too harsh.</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- Maybe just strip either side of semicolon?</span></span><span class="mpre">
        let (</span><a name="loc_71_14_71_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_14_71_16&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a name="loc_71_18_71_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_18_71_19&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.breakSubstring</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;;q=&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.filter</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="hl_num"><span class="mpre">0x20</span></span><span class="mpre">) </span><a href="#loc_68_11_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_11_68_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- 0x20 is space</span></span><span class="mpre">
            </span><a name="loc_72_13_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_13_72_15&#39;)"><span class="hl_vardecl"><span class="mpre">q&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.takeWhile</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="hl_num"><span class="mpre">0x3B</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><a href="#loc_71_18_71_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_18_71_19&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- 0x3B is semicolon</span></span><span class="mpre">
         in (</span><a href="#loc_71_14_71_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_14_71_16&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a href="#loc_74_5_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_10&#39;)"><span class="hl_varref"><span class="mpre">readQ</span></span></a><span class="mpre"> </span><a href="#loc_72_13_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_13_72_15&#39;)"><span class="hl_varref"><span class="mpre">q&#39;</span></span></a><span class="mpre">)
    </span><a name="loc_74_5_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_10&#39;)"><span class="hl_fundecl"><span class="mpre">readQ</span></span></a><span class="mpre"> </span><a name="loc_74_11_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_11_74_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">reads</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S8.unpack</span></span><span class="mpre"> </span><a href="#loc_74_11_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_11_74_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
                (</span><a name="loc_75_18_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_18_75_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, _)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_ -&gt; </span><a href="#loc_75_18_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_18_75_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                _ -&gt; </span><span class="hl_num"><span class="mpre">1.0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Store uploaded files in memory</span></span><span class="mpre">
</span><a href="#loc_80_1_80_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_11&#39;)"><span class="mpre">lbsBackEnd</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 15, srcSpanEndLine = 79, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 23, srcSpanEndLine = 79, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extr"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">ignored1</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">ignored2</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_80_1_80_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_11&#39;)"><span class="hl_fundecl"><span class="mpre">lbsBackEnd</span></span></a><span class="mpre"> _ _ </span><a name="loc_80_16_80_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_16_80_22&#39;)"><span class="hl_vardecl"><span class="mpre">popper</span></span></a><span class="mpre"> =
    </span><a href="#loc_83_5_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
  where
    </span><a name="loc_83_5_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_9&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_83_10_83_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_15&#39;)"><span class="hl_vardecl"><span class="mpre">front</span></span></a><span class="mpre"> = do
        </span><a name="loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_80_16_80_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_16_80_22&#39;)"><span class="hl_varref"><span class="mpre">popper</span></span></a><span class="mpre">
        if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
            then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_83_10_83_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_15&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> []
            else </span><a href="#loc_83_5_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_83_10_83_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_15&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_84_9_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Save uploaded files on disk as temporary files</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note: starting with version 2.0, removal of temp files is registered with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the provided @InternalState@. It is the responsibility of the caller to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ensure that this @InternalState@ gets cleaned up.</span></span><span class="mpre">
</span><a href="#loc_95_1_95_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_16&#39;)"><span class="mpre">tempFileBackEnd</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">InternalState</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">ignored1</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">ignored2</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_95_1_95_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_16&#39;)"><span class="hl_vardecl"><span class="mpre">tempFileBackEnd</span></span></a><span class="mpre"> = </span><a href="#loc_105_1_105_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_20&#39;)"><span class="hl_varref"><span class="mpre">tempFileBackEndOpts</span></span></a><span class="mpre"> </span><a href="System.Directory.html#loc_906_1_906_22" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_906_1_906_22&#39;)"><span class="hl_varref"><span class="mpre">getTemporaryDirectory</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;webenc.buf&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Same as &#39;tempFileSink&#39;, but use configurable temp folders and patterns.</span></span><span class="mpre">
</span><a href="#loc_105_1_105_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_20&#39;)"><span class="mpre">tempFileBackEndOpts</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ get temporary directory</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ filename pattern</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">InternalState</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyvar"><span class="mpre">ignored1</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyvar"><span class="mpre">ignored2</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_105_1_105_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_20&#39;)"><span class="hl_fundecl"><span class="mpre">tempFileBackEndOpts</span></span></a><span class="mpre"> </span><a name="loc_105_21_105_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_21_105_30&#39;)"><span class="hl_vardecl"><span class="mpre">getTmpDir</span></span></a><span class="mpre"> </span><a name="loc_105_31_105_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_31_105_38&#39;)"><span class="hl_vardecl"><span class="mpre">pattern</span></span></a><span class="mpre"> </span><a name="loc_105_39_105_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_39_105_52&#39;)"><span class="hl_vardecl"><span class="mpre">internalState</span></span></a><span class="mpre"> _ _ </span><a name="loc_105_57_105_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_57_105_63&#39;)"><span class="hl_vardecl"><span class="mpre">popper</span></span></a><span class="mpre"> = do
    (</span><a name="loc_106_6_106_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_6_106_9&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre">, (</span><a name="loc_106_12_106_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_12_106_14&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre">, </span><a name="loc_106_16_106_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_16_106_17&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">)) &lt;- </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Control.Monad.Trans.Resource.html#loc_356_1_356_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Resource.html#loc_356_1_356_17&#39;)"><span class="hl_varref"><span class="mpre">runInternalState</span></span></a><span class="mpre"> </span><a href="#loc_105_39_105_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_39_105_52&#39;)"><span class="hl_varref"><span class="mpre">internalState</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.Trans.Resource.html#loc_138_1_138_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Resource.html#loc_138_1_138_9&#39;)"><span class="hl_varref"><span class="mpre">allocate</span></span></a><span class="mpre"> (do
        </span><a name="loc_107_9_107_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_9_107_16&#39;)"><span class="hl_vardecl"><span class="mpre">tempDir</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_105_21_105_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_21_105_30&#39;)"><span class="hl_varref"><span class="mpre">getTmpDir</span></span></a><span class="mpre">
        </span><a href="System.IO.html#loc_450_1_450_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_450_1_450_19&#39;)"><span class="hl_varref"><span class="mpre">openBinaryTempFile</span></span></a><span class="mpre"> </span><a href="#loc_107_9_107_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_9_107_16&#39;)"><span class="hl_varref"><span class="mpre">tempDir</span></span></a><span class="mpre"> </span><a href="#loc_105_31_105_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_31_105_38&#39;)"><span class="hl_varref"><span class="mpre">pattern</span></span></a><span class="mpre">) (\(_, </span><a name="loc_108_51_108_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_51_108_52&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">) -&gt; </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre"> </span><a href="#loc_108_51_108_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_51_108_52&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">)
    _ &lt;- </span><a href="Control.Monad.Trans.Resource.html#loc_356_1_356_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Resource.html#loc_356_1_356_17&#39;)"><span class="hl_varref"><span class="mpre">runInternalState</span></span></a><span class="mpre"> (</span><a href="Control.Monad.Trans.Resource.html#loc_108_1_108_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Resource.html#loc_108_1_108_9&#39;)"><span class="hl_varref"><span class="mpre">register</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.Directory.html#loc_400_1_400_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_400_1_400_11&#39;)"><span class="hl_varref"><span class="mpre">removeFile</span></span></a><span class="mpre"> </span><a href="#loc_106_12_106_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_12_106_14&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">) </span><a href="#loc_105_39_105_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_39_105_52&#39;)"><span class="hl_varref"><span class="mpre">internalState</span></span></a><span class="mpre">
    </span><a href="Data.Function.html#loc_32_1_32_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_32_1_32_4&#39;)"><span class="hl_varref"><span class="mpre">fix</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_110_12_110_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_12_110_16&#39;)"><span class="hl_vardecl"><span class="mpre">loop</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_111_9_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_105_57_105_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_57_105_63&#39;)"><span class="hl_varref"><span class="mpre">popper</span></span></a><span class="mpre">
        </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_111_9_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><span class="hl_varref"><span class="mpre">S.hPut</span></span><span class="mpre"> </span><a href="#loc_106_16_106_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_16_106_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_111_9_111_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
            </span><a href="#loc_110_12_110_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_12_110_16&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
    </span><a href="Control.Monad.Trans.Resource.html#loc_115_1_115_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Resource.html#loc_115_1_115_8&#39;)"><span class="hl_varref"><span class="mpre">release</span></span></a><span class="mpre"> </span><a href="#loc_106_6_106_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_6_106_9&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_106_12_106_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_12_106_14&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Information on an uploaded file.</span></span><span class="mpre">
data </span><a name="loc_119_6_119_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_6_119_14&#39;)"><span class="hl_tycondecl"><span class="mpre">FileInfo</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> = </span><a name="loc_119_19_119_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_19_119_27&#39;)"><span class="hl_condecl"><span class="mpre">FileInfo</span></span></a><span class="mpre">
    { </span><a name="loc_120_7_120_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_7_120_15&#39;)"><span class="hl_fielddecl"><span class="mpre">fileName</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
    , </span><a name="loc_121_7_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_7_121_22&#39;)"><span class="hl_fielddecl"><span class="mpre">fileContentType</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
    , </span><a name="loc_122_7_122_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_7_122_18&#39;)"><span class="hl_fielddecl"><span class="mpre">fileContent</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">
    }
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 124, srcSpanStartColumn = 5, srcSpanEndLine = 124, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 124, srcSpanStartColumn = 5, srcSpanEndLine = 124, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcS"><span class="mpre">deriving (Eq, Show)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Post parameter name and value.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 127, srcSpanStartColumn = 1, srcSpanEndLine = 127, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 127, srcSpanStartColumn = 1, srcSpanEndLine = 127, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSp"><span class="mpre">type Param = (S.ByteString, S.ByteString)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Post parameter name and associated file information.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 130, srcSpanStartColumn = 1, srcSpanEndLine = 130, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 130, srcSpanStartColumn = 1, srcSpanEndLine = 130, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSp"><span class="mpre">type File y = (S.ByteString, FileInfo y)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A file uploading backend. Takes the parameter name, file name, and a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- stream of data.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 134, srcSpanStartColumn = 1, srcSpanEndLine = 137, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 134, srcSpanStartColumn = 1, srcSpanEndLine = 134, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSp"><span class="mpre">type BackEnd a = S.ByteString </span><span class="hl_comment"><span class="mpre">-- ^ parameter name</span></span><span class="mpre">
              -&gt; FileInfo ()
              -&gt; IO S.ByteString
              -&gt; IO a</span></span><span class="mpre">

data </span><a name="loc_139_6_139_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_6_139_21&#39;)"><span class="hl_tycondecl"><span class="mpre">RequestBodyType</span></span></a><span class="mpre"> = </span><a name="loc_139_24_139_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_34&#39;)"><span class="hl_condecl"><span class="mpre">UrlEncoded</span></span></a><span class="mpre"> | </span><a name="loc_139_37_139_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_37_139_46&#39;)"><span class="hl_condecl"><span class="mpre">Multipart</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">

</span><a href="#loc_142_1_142_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_19&#39;)"><span class="mpre">getRequestBodyType</span></a><span class="mpre"> :: </span><a href="Network.Wai.Internal.html#loc_20_6_20_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_20_6_20_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_139_6_139_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_6_139_21&#39;)"><span class="hl_tyconref"><span class="mpre">RequestBodyType</span></span></a><span class="mpre">
</span><a name="loc_142_1_142_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_19&#39;)"><span class="hl_fundecl"><span class="mpre">getRequestBodyType</span></span></a><span class="mpre"> </span><a name="loc_142_20_142_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_20_142_23&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> = do
    </span><a name="loc_143_5_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_11&#39;)"><span class="hl_vardecl"><span class="mpre">ctype&#39;</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Type&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Internal.html#loc_36_6_36_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_36_6_36_20&#39;)"><span class="hl_varref"><span class="mpre">requestHeaders</span></span></a><span class="mpre"> </span><a href="#loc_142_20_142_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_20_142_23&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
    let (</span><a name="loc_144_10_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_10_144_15&#39;)"><span class="hl_vardecl"><span class="mpre">ctype</span></span></a><span class="mpre">, </span><a name="loc_144_17_144_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_17_144_22&#39;)"><span class="hl_vardecl"><span class="mpre">attrs</span></span></a><span class="mpre">) = </span><a href="#loc_155_1_155_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_17&#39;)"><span class="hl_varref"><span class="mpre">parseContentType</span></span></a><span class="mpre"> </span><a href="#loc_143_5_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_11&#39;)"><span class="hl_varref"><span class="mpre">ctype&#39;</span></span></a><span class="mpre">
    case </span><a href="#loc_144_10_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_10_144_15&#39;)"><span class="hl_varref"><span class="mpre">ctype</span></span></a><span class="mpre"> of
        </span><span class="hl_string"><span class="mpre">&quot;application/x-www-form-urlencoded&quot;</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_139_24_139_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_34&#39;)"><span class="hl_conref"><span class="mpre">UrlEncoded</span></span></a><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;multipart/form-data&quot;</span></span><span class="mpre"> | </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_147_38_147_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_38_147_43&#39;)"><span class="hl_vardecl"><span class="mpre">bound</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;boundary&quot;</span></span><span class="mpre"> </span><a href="#loc_144_17_144_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_17_144_22&#39;)"><span class="hl_varref"><span class="mpre">attrs</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_139_37_139_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_37_139_46&#39;)"><span class="hl_conref"><span class="mpre">Multipart</span></span></a><span class="mpre"> </span><a href="#loc_147_38_147_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_38_147_43&#39;)"><span class="hl_varref"><span class="mpre">bound</span></span></a><span class="mpre">
        _ -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Parse a content type value, turning a single @ByteString@ into the actual</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- content type and a list of pairs of attributes.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 1.3.2</span></span><span class="mpre">
</span><a href="#loc_155_1_155_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_17&#39;)"><span class="mpre">parseContentType</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">, [(</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)])
</span><a name="loc_155_1_155_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseContentType</span></span></a><span class="mpre"> </span><a name="loc_155_18_155_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_18_155_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = do
    let (</span><a name="loc_156_10_156_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_10_156_15&#39;)"><span class="hl_vardecl"><span class="mpre">ctype</span></span></a><span class="mpre">, </span><a name="loc_156_17_156_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_17_156_18&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_160_5_160_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_5_160_14&#39;)"><span class="hl_varref"><span class="mpre">semicolon</span></span></a><span class="mpre">) </span><a href="#loc_155_18_155_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_18_155_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
        </span><a name="loc_157_9_157_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_14&#39;)"><span class="hl_vardecl"><span class="mpre">attrs</span></span></a><span class="mpre"> = </span><a href="#loc_163_5_163_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_5_163_12&#39;)"><span class="hl_varref"><span class="mpre">goAttrs</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_156_17_156_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_17_156_18&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
     in (</span><a href="#loc_156_10_156_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_10_156_15&#39;)"><span class="hl_varref"><span class="mpre">ctype</span></span></a><span class="mpre">, </span><a href="#loc_157_9_157_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_14&#39;)"><span class="hl_varref"><span class="mpre">attrs</span></span></a><span class="mpre">)
  where
    </span><a name="loc_160_5_160_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_5_160_14&#39;)"><span class="hl_vardecl"><span class="mpre">semicolon</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre">
    </span><a name="loc_161_5_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_5_161_11&#39;)"><span class="hl_vardecl"><span class="mpre">equals</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">61</span></span><span class="mpre">
    </span><a name="loc_162_5_162_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_5_162_10&#39;)"><span class="hl_vardecl"><span class="mpre">space</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">
    </span><a name="loc_163_5_163_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_5_163_12&#39;)"><span class="hl_fundecl"><span class="mpre">goAttrs</span></span></a><span class="mpre"> </span><a name="loc_163_13_163_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_13_163_18&#39;)"><span class="hl_vardecl"><span class="mpre">front</span></span></a><span class="mpre"> </span><a name="loc_163_19_163_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_19_163_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_163_19_163_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_19_163_21&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_163_13_163_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_13_163_18&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> []
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
            let (</span><a name="loc_166_18_166_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_18_166_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_166_21_166_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_21_166_25&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_160_5_160_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_5_160_14&#39;)"><span class="hl_varref"><span class="mpre">semicolon</span></span></a><span class="mpre">) </span><a href="#loc_163_19_163_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_19_163_21&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
             in </span><a href="#loc_163_5_163_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_5_163_12&#39;)"><span class="hl_varref"><span class="mpre">goAttrs</span></span></a><span class="mpre"> (</span><a href="#loc_163_13_163_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_13_163_18&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_168_5_168_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_11&#39;)"><span class="hl_varref"><span class="mpre">goAttr</span></span></a><span class="mpre"> </span><a href="#loc_166_18_166_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_18_166_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_166_21_166_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_21_166_25&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
    </span><a name="loc_168_5_168_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_11&#39;)"><span class="hl_fundecl"><span class="mpre">goAttr</span></span></a><span class="mpre"> </span><a name="loc_168_12_168_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_12_168_14&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
        let (</span><a name="loc_169_14_169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_14_169_15&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">, </span><a name="loc_169_17_169_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_17_169_19&#39;)"><span class="hl_vardecl"><span class="mpre">v&#39;</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_161_5_161_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_5_161_11&#39;)"><span class="hl_varref"><span class="mpre">equals</span></span></a><span class="mpre">) </span><a href="#loc_168_12_168_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_12_168_14&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
            </span><a name="loc_170_13_170_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_13_170_14&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_169_17_169_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_17_169_19&#39;)"><span class="hl_varref"><span class="mpre">v&#39;</span></span></a><span class="mpre">
         in (</span><a href="#loc_172_5_172_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_10&#39;)"><span class="hl_varref"><span class="mpre">strip</span></span></a><span class="mpre"> </span><a href="#loc_169_14_169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_14_169_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">, </span><a href="#loc_172_5_172_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_10&#39;)"><span class="hl_varref"><span class="mpre">strip</span></span></a><span class="mpre"> </span><a href="#loc_170_13_170_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_13_170_14&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)
    </span><a name="loc_172_5_172_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_10&#39;)"><span class="hl_vardecl"><span class="mpre">strip</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.dropWhile</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_162_5_162_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_5_162_10&#39;)"><span class="hl_varref"><span class="mpre">space</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.breakEnd</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_162_5_162_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_5_162_10&#39;)"><span class="hl_varref"><span class="mpre">space</span></span></a><span class="mpre">)

</span><a href="#loc_177_1_177_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_17&#39;)"><span class="mpre">parseRequestBody</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BackEnd</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre">
                 -&gt; </span><a href="Network.Wai.Internal.html#loc_20_6_20_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_20_6_20_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> ([</span><span class="hl_tyconref"><span class="mpre">Param</span></span><span class="mpre">], [</span><span class="hl_tyconref"><span class="mpre">File</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre">])
</span><a name="loc_177_1_177_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseRequestBody</span></span></a><span class="mpre"> </span><a name="loc_177_18_177_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_18_177_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_177_20_177_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_20_177_21&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> =
    case </span><a href="#loc_142_1_142_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_19&#39;)"><span class="hl_varref"><span class="mpre">getRequestBodyType</span></span></a><span class="mpre"> </span><a href="#loc_177_20_177_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_20_177_21&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> ([], [])
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_180_14_180_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_14_180_17&#39;)"><span class="hl_vardecl"><span class="mpre">rbt</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_186_1_186_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_16&#39;)"><span class="hl_varref"><span class="mpre">sinkRequestBody</span></span></a><span class="mpre"> </span><a href="#loc_177_18_177_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_18_177_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_180_14_180_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_14_180_17&#39;)"><span class="hl_varref"><span class="mpre">rbt</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Internal.html#loc_55_6_55_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_55_6_55_17&#39;)"><span class="hl_varref"><span class="mpre">requestBody</span></span></a><span class="mpre"> </span><a href="#loc_177_20_177_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_20_177_21&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)

</span><a href="#loc_186_1_186_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_16&#39;)"><span class="mpre">sinkRequestBody</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BackEnd</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre">
                -&gt; </span><a href="#loc_139_6_139_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_6_139_21&#39;)"><span class="hl_tyconref"><span class="mpre">RequestBodyType</span></span></a><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> ([</span><span class="hl_tyconref"><span class="mpre">Param</span></span><span class="mpre">], [</span><span class="hl_tyconref"><span class="mpre">File</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre">])
</span><a name="loc_186_1_186_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_16&#39;)"><span class="hl_fundecl"><span class="mpre">sinkRequestBody</span></span></a><span class="mpre"> </span><a name="loc_186_17_186_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_17_186_18&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_186_19_186_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_19_186_20&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_186_21_186_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_21_186_25&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> = do
    </span><a name="loc_187_5_187_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_8&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">)
    let </span><a name="loc_188_9_188_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_12&#39;)"><span class="hl_fundecl"><span class="mpre">add</span></span></a><span class="mpre"> </span><a name="loc_188_13_188_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_13_188_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Data.IORef.html#loc_101_1_101_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_101_1_101_18&#39;)"><span class="hl_varref"><span class="mpre">atomicModifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_187_5_187_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \(</span><a name="loc_188_43_188_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_43_188_44&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">, </span><a name="loc_188_46_188_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_46_188_47&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">) -&gt;
            case </span><a href="#loc_188_13_188_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_13_188_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_190_22_190_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_22_190_24&#39;)"><span class="hl_vardecl"><span class="mpre">y&#39;</span></span></a><span class="mpre"> -&gt; ((</span><a href="#loc_188_43_188_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_43_188_44&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_190_22_190_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_22_190_24&#39;)"><span class="hl_varref"><span class="mpre">y&#39;</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">), </span><a href="#loc_188_46_188_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_46_188_47&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">), </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)
                </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_191_23_191_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_23_191_25&#39;)"><span class="hl_vardecl"><span class="mpre">z&#39;</span></span></a><span class="mpre"> -&gt; ((</span><a href="#loc_188_43_188_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_43_188_44&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">, </span><a href="#loc_188_46_188_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_46_188_47&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_191_23_191_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_23_191_25&#39;)"><span class="hl_varref"><span class="mpre">z&#39;</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)), </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)
    </span><a href="#loc_201_1_201_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_19&#39;)"><span class="hl_varref"><span class="mpre">conduitRequestBody</span></span></a><span class="mpre"> </span><a href="#loc_186_17_186_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_17_186_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_186_19_186_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_19_186_20&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_186_21_186_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_21_186_25&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre"> </span><a href="#loc_188_9_188_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_12&#39;)"><span class="hl_varref"><span class="mpre">add</span></span></a><span class="mpre">
    (</span><a name="loc_193_6_193_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_7&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_193_9_193_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_9_193_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_187_5_187_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_193_6_193_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_7&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> [], </span><a href="#loc_193_9_193_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_9_193_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> [])

</span><a href="#loc_201_1_201_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_19&#39;)"><span class="mpre">conduitRequestBody</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BackEnd</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre">
                   -&gt; </span><a href="#loc_139_6_139_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_6_139_21&#39;)"><span class="hl_tyconref"><span class="mpre">RequestBodyType</span></span></a><span class="mpre">
                   -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
                   -&gt; (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Param</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">File</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)
                   -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_201_1_201_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_19&#39;)"><span class="hl_fundecl"><span class="mpre">conduitRequestBody</span></span></a><span class="mpre"> _ </span><a href="#loc_139_24_139_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_24_139_34&#39;)"><span class="hl_conref"><span class="mpre">UrlEncoded</span></span></a><span class="mpre"> </span><a name="loc_201_33_201_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_33_201_38&#39;)"><span class="hl_vardecl"><span class="mpre">rbody</span></span></a><span class="mpre"> </span><a name="loc_201_39_201_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_39_201_42&#39;)"><span class="hl_vardecl"><span class="mpre">add</span></span></a><span class="mpre"> = do
    </span><span class="hl_comment"><span class="mpre">-- NOTE: in general, url-encoded data will be in a single chunk.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Therefore, I&#39;m optimizing for the usual case by sticking with</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- strict byte strings here.</span></span><span class="mpre">
    let </span><a name="loc_205_9_205_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_205_14_205_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_14_205_19&#39;)"><span class="hl_vardecl"><span class="mpre">front</span></span></a><span class="mpre"> = do
            </span><a name="loc_206_13_206_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_13_206_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_201_33_201_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_33_201_38&#39;)"><span class="hl_varref"><span class="mpre">rbody</span></span></a><span class="mpre">
            if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_206_13_206_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_13_206_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_205_14_205_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_14_205_19&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> []
                else </span><a href="#loc_205_9_205_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_205_14_205_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_14_205_19&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_206_13_206_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_13_206_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)
    </span><a name="loc_210_5_210_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_5_210_7&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_205_9_205_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> (</span><a href="#loc_201_39_201_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_39_201_42&#39;)"><span class="hl_varref"><span class="mpre">add</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Types.URI.html#loc_165_1_165_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.URI.html#loc_165_1_165_17&#39;)"><span class="hl_varref"><span class="mpre">H.parseSimpleQuery</span></span></a><span class="mpre"> </span><a href="#loc_210_5_210_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_5_210_7&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
</span><a href="#loc_201_1_201_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_19&#39;)"><span class="hl_fundecl"><span class="mpre">conduitRequestBody</span></span></a><span class="mpre"> </span><a name="loc_212_20_212_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_20_212_27&#39;)"><span class="hl_vardecl"><span class="mpre">backend</span></span></a><span class="mpre"> (</span><a href="#loc_139_37_139_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_37_139_46&#39;)"><span class="hl_conref"><span class="mpre">Multipart</span></span></a><span class="mpre"> </span><a name="loc_212_39_212_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_39_212_44&#39;)"><span class="hl_vardecl"><span class="mpre">bound</span></span></a><span class="mpre">) </span><a name="loc_212_46_212_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_46_212_51&#39;)"><span class="hl_vardecl"><span class="mpre">rbody</span></span></a><span class="mpre"> </span><a name="loc_212_52_212_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_52_212_55&#39;)"><span class="hl_vardecl"><span class="mpre">add</span></span></a><span class="mpre"> =
    </span><a href="#loc_267_1_267_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_12&#39;)"><span class="hl_varref"><span class="mpre">parsePieces</span></span></a><span class="mpre"> </span><a href="#loc_212_20_212_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_20_212_27&#39;)"><span class="hl_varref"><span class="mpre">backend</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`S.append`</span></span><span class="mpre"> </span><a href="#loc_212_39_212_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_39_212_44&#39;)"><span class="hl_varref"><span class="mpre">bound</span></span></a><span class="mpre">) </span><a href="#loc_212_46_212_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_46_212_51&#39;)"><span class="hl_varref"><span class="mpre">rbody</span></span></a><span class="mpre"> </span><a href="#loc_212_52_212_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_52_212_55&#39;)"><span class="hl_varref"><span class="mpre">add</span></span></a><span class="mpre">

</span><a href="#loc_216_1_216_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_9&#39;)"><span class="mpre">takeLine</span></a><span class="mpre"> :: </span><a href="#loc_245_6_245_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_6_245_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)
</span><a name="loc_216_1_216_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_9&#39;)"><span class="hl_fundecl"><span class="mpre">takeLine</span></span></a><span class="mpre"> </span><a name="loc_216_10_216_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_13&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> =
    </span><a href="#loc_219_5_219_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_5_219_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
  where
    </span><a name="loc_219_5_219_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_5_219_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_219_8_219_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_8_219_13&#39;)"><span class="hl_vardecl"><span class="mpre">front</span></span></a><span class="mpre"> = do
        </span><a name="loc_220_9_220_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_9_220_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_253_1_253_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_1_253_11&#39;)"><span class="hl_varref"><span class="mpre">readSource</span></span></a><span class="mpre"> </span><a href="#loc_216_10_216_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_13&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
        if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_220_9_220_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_9_220_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
            then </span><a href="#loc_225_5_225_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_5_225_10&#39;)"><span class="hl_varref"><span class="mpre">close</span></span></a><span class="mpre"> </span><a href="#loc_219_8_219_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_8_219_13&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre">
            else </span><a href="#loc_226_5_226_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_5_226_9&#39;)"><span class="hl_varref"><span class="mpre">push</span></span></a><span class="mpre"> </span><a href="#loc_219_8_219_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_8_219_13&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><a href="#loc_220_9_220_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_9_220_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

    </span><a name="loc_225_5_225_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_5_225_10&#39;)"><span class="hl_fundecl"><span class="mpre">close</span></span></a><span class="mpre"> </span><a name="loc_225_11_225_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_11_225_16&#39;)"><span class="hl_vardecl"><span class="mpre">front</span></span></a><span class="mpre"> = </span><a href="#loc_260_1_260_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_1_260_9&#39;)"><span class="hl_varref"><span class="mpre">leftover</span></span></a><span class="mpre"> </span><a href="#loc_216_10_216_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_13&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> (</span><a href="#loc_225_11_225_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_11_225_16&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    </span><a name="loc_226_5_226_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_5_226_9&#39;)"><span class="hl_fundecl"><span class="mpre">push</span></span></a><span class="mpre"> </span><a name="loc_226_10_226_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_10_226_15&#39;)"><span class="hl_vardecl"><span class="mpre">front</span></span></a><span class="mpre"> </span><a name="loc_226_16_226_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_16_226_18&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = do
        let (</span><a name="loc_227_14_227_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_14_227_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_227_17_227_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_17_227_18&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_226_10_226_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_10_226_15&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><a href="#loc_226_16_226_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_16_226_18&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- LF</span></span><span class="mpre">
         in if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_227_17_227_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_17_227_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                then </span><a href="#loc_219_5_219_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_5_219_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.append</span></span><span class="mpre"> </span><a href="#loc_227_14_227_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_14_227_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                else do
                    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_227_17_227_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_17_227_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_260_1_260_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_1_260_9&#39;)"><span class="hl_varref"><span class="mpre">leftover</span></span></a><span class="mpre"> </span><a href="#loc_216_10_216_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_13&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_227_17_227_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_17_227_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_431_1_431_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_1_431_7&#39;)"><span class="hl_varref"><span class="mpre">killCR</span></span></a><span class="mpre"> </span><a href="#loc_227_14_227_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_14_227_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_235_1_235_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_1_235_10&#39;)"><span class="mpre">takeLines</span></a><span class="mpre"> :: </span><a href="#loc_245_6_245_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_6_245_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]
</span><a name="loc_235_1_235_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_1_235_10&#39;)"><span class="hl_fundecl"><span class="mpre">takeLines</span></span></a><span class="mpre"> </span><a name="loc_235_11_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_11_235_14&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = do
    </span><a name="loc_236_5_236_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_5_236_8&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_216_1_216_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_9&#39;)"><span class="hl_varref"><span class="mpre">takeLine</span></span></a><span class="mpre"> </span><a href="#loc_235_11_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_11_235_14&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
    case </span><a href="#loc_236_5_236_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_5_236_8&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_239_14_239_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_14_239_15&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_239_14_239_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_14_239_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; do
                </span><a name="loc_242_17_242_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_17_242_19&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_235_1_235_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_1_235_10&#39;)"><span class="hl_varref"><span class="mpre">takeLines</span></span></a><span class="mpre"> </span><a href="#loc_235_11_235_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_11_235_14&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_239_14_239_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_14_239_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_242_17_242_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_17_242_19&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">

data </span><a name="loc_245_6_245_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_6_245_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Source</span></span></a><span class="mpre"> = </span><a name="loc_245_15_245_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_15_245_21&#39;)"><span class="hl_condecl"><span class="mpre">Source</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">) (</span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)

</span><a href="#loc_248_1_248_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_9&#39;)"><span class="mpre">mkSource</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_245_6_245_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_6_245_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre">
</span><a name="loc_248_1_248_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_9&#39;)"><span class="hl_fundecl"><span class="mpre">mkSource</span></span></a><span class="mpre"> </span><a name="loc_248_10_248_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_10_248_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
    </span><a name="loc_249_5_249_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_5_249_8&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_245_15_245_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_15_245_21&#39;)"><span class="hl_conref"><span class="mpre">Source</span></span></a><span class="mpre"> </span><a href="#loc_248_10_248_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_10_248_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_249_5_249_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_5_249_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">

</span><a href="#loc_253_1_253_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_1_253_11&#39;)"><span class="mpre">readSource</span></a><span class="mpre"> :: </span><a href="#loc_245_6_245_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_6_245_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
</span><a name="loc_253_1_253_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_1_253_11&#39;)"><span class="hl_fundecl"><span class="mpre">readSource</span></span></a><span class="mpre"> (</span><a href="#loc_245_15_245_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_15_245_21&#39;)"><span class="hl_conref"><span class="mpre">Source</span></span></a><span class="mpre"> </span><a name="loc_253_20_253_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_20_253_21&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_253_22_253_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_22_253_25&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre">) = do
    </span><a name="loc_254_5_254_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_5_254_7&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Data.IORef.html#loc_101_1_101_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_101_1_101_18&#39;)"><span class="hl_varref"><span class="mpre">atomicModifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_253_22_253_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_22_253_25&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_254_36_254_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_36_254_38&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">, </span><a href="#loc_254_36_254_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_36_254_38&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
    if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_254_5_254_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_5_254_7&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        then </span><a href="#loc_253_20_253_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_20_253_21&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
        else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_254_5_254_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_5_254_7&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><a href="#loc_260_1_260_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_1_260_9&#39;)"><span class="mpre">leftover</span></a><span class="mpre"> :: </span><a href="#loc_245_6_245_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_6_245_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_260_1_260_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_1_260_9&#39;)"><span class="hl_fundecl"><span class="mpre">leftover</span></span></a><span class="mpre"> (</span><a href="#loc_245_15_245_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_15_245_21&#39;)"><span class="hl_conref"><span class="mpre">Source</span></span></a><span class="mpre"> _ </span><a name="loc_260_20_260_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_20_260_23&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre">) </span><a name="loc_260_25_260_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_25_260_27&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_260_20_260_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_20_260_23&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_260_25_260_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_25_260_27&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><a href="#loc_267_1_267_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_12&#39;)"><span class="mpre">parsePieces</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BackEnd</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
            -&gt; (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Param</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">File</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)
            -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_267_1_267_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_12&#39;)"><span class="hl_fundecl"><span class="mpre">parsePieces</span></span></a><span class="mpre"> </span><a name="loc_267_13_267_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_13_267_17&#39;)"><span class="hl_vardecl"><span class="mpre">sink</span></span></a><span class="mpre"> </span><a name="loc_267_18_267_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_18_267_23&#39;)"><span class="hl_vardecl"><span class="mpre">bound</span></span></a><span class="mpre"> </span><a name="loc_267_24_267_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_24_267_29&#39;)"><span class="hl_vardecl"><span class="mpre">rbody</span></span></a><span class="mpre"> </span><a name="loc_267_30_267_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_30_267_33&#39;)"><span class="hl_vardecl"><span class="mpre">add</span></span></a><span class="mpre"> =
    </span><a href="#loc_248_1_248_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_9&#39;)"><span class="hl_varref"><span class="mpre">mkSource</span></span></a><span class="mpre"> </span><a href="#loc_267_24_267_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_24_267_29&#39;)"><span class="hl_varref"><span class="mpre">rbody</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_270_5_270_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_5_270_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
  where
    </span><a name="loc_270_5_270_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_5_270_9&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_270_10_270_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_10_270_13&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = do
        </span><span class="hl_vardecl"><span class="mpre">_boundLine</span></span><span class="mpre"> &lt;- </span><a href="#loc_216_1_216_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_9&#39;)"><span class="hl_varref"><span class="mpre">takeLine</span></span></a><span class="mpre"> </span><a href="#loc_270_10_270_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_10_270_13&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
        </span><a name="loc_272_9_272_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_9_272_13&#39;)"><span class="hl_vardecl"><span class="mpre">res&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_235_1_235_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_1_235_10&#39;)"><span class="hl_varref"><span class="mpre">takeLines</span></span></a><span class="mpre"> </span><a href="#loc_270_10_270_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_10_270_13&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
        </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_272_9_272_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_9_272_13&#39;)"><span class="hl_varref"><span class="mpre">res&#39;</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            let </span><a name="loc_274_17_274_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_17_274_20&#39;)"><span class="hl_vardecl"><span class="mpre">ls&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_305_9_305_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_9_305_18&#39;)"><span class="hl_varref"><span class="mpre">parsePair</span></span></a><span class="mpre"> </span><a href="#loc_272_9_272_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_9_272_13&#39;)"><span class="hl_varref"><span class="mpre">res&#39;</span></span></a><span class="mpre">
            let </span><a name="loc_275_17_275_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_17_275_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do
                    </span><a name="loc_276_21_276_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_21_276_23&#39;)"><span class="hl_vardecl"><span class="mpre">cd</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><a href="#loc_303_9_303_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_9_303_17&#39;)"><span class="hl_varref"><span class="mpre">contDisp</span></span></a><span class="mpre"> </span><a href="#loc_274_17_274_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_17_274_20&#39;)"><span class="hl_varref"><span class="mpre">ls&#39;</span></span></a><span class="mpre">
                    let </span><a name="loc_277_25_277_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_25_277_27&#39;)"><span class="hl_vardecl"><span class="mpre">ct</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><a href="#loc_304_9_304_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_9_304_17&#39;)"><span class="hl_varref"><span class="mpre">contType</span></span></a><span class="mpre"> </span><a href="#loc_274_17_274_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_17_274_20&#39;)"><span class="hl_varref"><span class="mpre">ls&#39;</span></span></a><span class="mpre">
                    let </span><a name="loc_278_25_278_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_25_278_30&#39;)"><span class="hl_vardecl"><span class="mpre">attrs</span></span></a><span class="mpre"> = </span><a href="#loc_415_1_415_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_1_415_11&#39;)"><span class="hl_varref"><span class="mpre">parseAttrs</span></span></a><span class="mpre"> </span><a href="#loc_276_21_276_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_21_276_23&#39;)"><span class="hl_varref"><span class="mpre">cd</span></span></a><span class="mpre">
                    </span><a name="loc_279_21_279_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_21_279_25&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;name&quot;</span></span><span class="mpre"> </span><a href="#loc_278_25_278_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_25_278_30&#39;)"><span class="hl_varref"><span class="mpre">attrs</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_277_25_277_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_25_277_27&#39;)"><span class="hl_varref"><span class="mpre">ct</span></span></a><span class="mpre">, </span><a href="#loc_279_21_279_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_21_279_25&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;filename&quot;</span></span><span class="mpre"> </span><a href="#loc_278_25_278_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_25_278_30&#39;)"><span class="hl_varref"><span class="mpre">attrs</span></span></a><span class="mpre">)
            case </span><a href="#loc_275_17_275_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_17_275_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_282_23_282_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_23_282_26&#39;)"><span class="hl_vardecl"><span class="mpre">mct</span></span></a><span class="mpre">, </span><a name="loc_282_28_282_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_28_282_32&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_282_39_282_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_39_282_47&#39;)"><span class="hl_vardecl"><span class="mpre">filename</span></span></a><span class="mpre">) -&gt; do
                    let </span><a name="loc_283_25_283_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_25_283_27&#39;)"><span class="hl_vardecl"><span class="mpre">ct</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;application/octet-stream&quot;</span></span><span class="mpre"> </span><a href="#loc_282_23_282_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_23_282_26&#39;)"><span class="hl_varref"><span class="mpre">mct</span></span></a><span class="mpre">
                        </span><a name="loc_284_25_284_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_25_284_28&#39;)"><span class="hl_vardecl"><span class="mpre">fi0</span></span></a><span class="mpre"> = </span><a href="#loc_119_19_119_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_19_119_27&#39;)"><span class="hl_conref"><span class="mpre">FileInfo</span></span></a><span class="mpre"> </span><a href="#loc_282_39_282_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_39_282_47&#39;)"><span class="hl_varref"><span class="mpre">filename</span></span></a><span class="mpre"> </span><a href="#loc_283_25_283_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_25_283_27&#39;)"><span class="hl_varref"><span class="mpre">ct</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
                    (</span><a name="loc_285_22_285_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_22_285_30&#39;)"><span class="hl_vardecl"><span class="mpre">wasFound</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">y</span></span><span class="mpre">) &lt;- </span><a href="#loc_343_1_343_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_1_343_15&#39;)"><span class="hl_varref"><span class="mpre">sinkTillBound&#39;</span></span></a><span class="mpre"> </span><a href="#loc_267_18_267_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_18_267_23&#39;)"><span class="hl_varref"><span class="mpre">bound</span></span></a><span class="mpre"> </span><a href="#loc_282_28_282_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_28_282_32&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_284_25_284_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_25_284_28&#39;)"><span class="hl_varref"><span class="mpre">fi0</span></span></a><span class="mpre"> </span><a href="#loc_267_13_267_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_13_267_17&#39;)"><span class="hl_varref"><span class="mpre">sink</span></span></a><span class="mpre"> </span><a href="#loc_270_10_270_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_10_270_13&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
                    </span><a href="#loc_267_30_267_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_30_267_33&#39;)"><span class="hl_varref"><span class="mpre">add</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_282_28_282_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_28_282_32&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">, </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 286, srcSpanStartColumn = 40, srcSpanEndLine = 286, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 286, srcSpanStartColumn = 44, srcSpanEndLine = 286, srcSpanEndColumn = 45},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, s"><span class="mpre">fi0 { fileContent = y }</span></span><span class="mpre">)
                    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> </span><a href="#loc_285_22_285_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_22_285_30&#39;)"><span class="hl_varref"><span class="mpre">wasFound</span></span></a><span class="mpre"> (</span><a href="#loc_270_5_270_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_5_270_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_270_10_270_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_10_270_13&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">)
                </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_vardecl"><span class="mpre">_ct</span></span><span class="mpre">, </span><a name="loc_288_28_288_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_28_288_32&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) -&gt; do
                    let </span><a name="loc_289_25_289_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_25_289_29&#39;)"><span class="hl_vardecl"><span class="mpre">seed</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
                    let </span><a name="loc_290_25_290_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_25_290_29&#39;)"><span class="hl_fundecl"><span class="mpre">iter</span></span></a><span class="mpre"> </span><a name="loc_290_30_290_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_30_290_35&#39;)"><span class="hl_vardecl"><span class="mpre">front</span></span></a><span class="mpre"> </span><a name="loc_290_36_290_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_36_290_38&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_290_30_290_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_30_290_35&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> </span><a href="#loc_290_36_290_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_36_290_38&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                    (</span><a name="loc_291_22_291_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_22_291_30&#39;)"><span class="hl_vardecl"><span class="mpre">wasFound</span></span></a><span class="mpre">, </span><a name="loc_291_32_291_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_32_291_37&#39;)"><span class="hl_vardecl"><span class="mpre">front</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_403_1_403_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_1_403_14&#39;)"><span class="hl_varref"><span class="mpre">sinkTillBound</span></span></a><span class="mpre"> </span><a href="#loc_267_18_267_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_18_267_23&#39;)"><span class="hl_varref"><span class="mpre">bound</span></span></a><span class="mpre"> </span><a href="#loc_290_25_290_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_25_290_29&#39;)"><span class="hl_varref"><span class="mpre">iter</span></span></a><span class="mpre"> </span><a href="#loc_289_25_289_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_25_289_29&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre"> </span><a href="#loc_270_10_270_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_10_270_13&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
                    let </span><a name="loc_292_25_292_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_25_292_27&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_291_32_291_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_32_291_37&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> []
                    let </span><a name="loc_293_25_293_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_25_293_27&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre"> = (</span><a href="#loc_288_28_288_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_28_288_32&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">, </span><a href="#loc_292_25_292_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_25_292_27&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
                    </span><a href="#loc_267_30_267_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_30_267_33&#39;)"><span class="hl_varref"><span class="mpre">add</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_293_25_293_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_25_293_27&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre">
                    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> </span><a href="#loc_291_22_291_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_22_291_30&#39;)"><span class="hl_varref"><span class="mpre">wasFound</span></span></a><span class="mpre"> (</span><a href="#loc_270_5_270_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_5_270_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_270_10_270_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_10_270_13&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">)
                _ -&gt; do
                    </span><span class="hl_comment"><span class="mpre">-- ignore this part</span></span><span class="mpre">
                    let </span><a name="loc_298_25_298_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_25_298_29&#39;)"><span class="hl_vardecl"><span class="mpre">seed</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
                        </span><a name="loc_299_25_299_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_25_299_29&#39;)"><span class="hl_fundecl"><span class="mpre">iter</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
                    (</span><a name="loc_300_22_300_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_22_300_30&#39;)"><span class="hl_vardecl"><span class="mpre">wasFound</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) &lt;- </span><a href="#loc_403_1_403_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_1_403_14&#39;)"><span class="hl_varref"><span class="mpre">sinkTillBound</span></span></a><span class="mpre"> </span><a href="#loc_267_18_267_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_18_267_23&#39;)"><span class="hl_varref"><span class="mpre">bound</span></span></a><span class="mpre"> </span><a href="#loc_299_25_299_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_25_299_29&#39;)"><span class="hl_varref"><span class="mpre">iter</span></span></a><span class="mpre"> </span><a href="#loc_298_25_298_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_25_298_29&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre"> </span><a href="#loc_270_10_270_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_10_270_13&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
                    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> </span><a href="#loc_300_22_300_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_22_300_30&#39;)"><span class="hl_varref"><span class="mpre">wasFound</span></span></a><span class="mpre"> (</span><a href="#loc_270_5_270_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_5_270_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_270_10_270_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_10_270_13&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">)
      where
        </span><a name="loc_303_9_303_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_9_303_17&#39;)"><span class="hl_vardecl"><span class="mpre">contDisp</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Disposition&quot;</span></span><span class="mpre">
        </span><a name="loc_304_9_304_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_9_304_17&#39;)"><span class="hl_vardecl"><span class="mpre">contType</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Type&quot;</span></span><span class="mpre">
        </span><a name="loc_305_9_305_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_9_305_18&#39;)"><span class="hl_fundecl"><span class="mpre">parsePair</span></span></a><span class="mpre"> </span><a name="loc_305_19_305_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_19_305_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
            let (</span><a name="loc_306_18_306_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_18_306_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_306_21_306_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_21_306_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><a href="#loc_50_1_50_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_13&#39;)"><span class="hl_varref"><span class="mpre">breakDiscard</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">58</span></span><span class="mpre"> </span><a href="#loc_305_19_305_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_19_305_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- colon</span></span><span class="mpre">
             in (</span><a href="#loc_306_18_306_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_18_306_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">S.dropWhile</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">) </span><a href="#loc_306_21_306_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_21_306_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- space</span></span><span class="mpre">

data </span><a name="loc_309_6_309_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_6_309_11&#39;)"><span class="hl_tycondecl"><span class="mpre">Bound</span></span></a><span class="mpre"> = </span><a name="loc_309_14_309_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_14_309_24&#39;)"><span class="hl_condecl"><span class="mpre">FoundBound</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
           | </span><a name="loc_310_14_310_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_14_310_21&#39;)"><span class="hl_condecl"><span class="mpre">NoBound</span></span></a><span class="mpre">
           | </span><a name="loc_311_14_311_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_14_311_26&#39;)"><span class="hl_condecl"><span class="mpre">PartialBound</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 312, srcSpanStartColumn = 5, srcSpanEndLine = 312, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 312, srcSpanStartColumn = 5, srcSpanEndLine = 312, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcS"><span class="mpre">deriving (Eq, Show)</span></span><span class="mpre">

</span><a href="#loc_315_1_315_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_1_315_10&#39;)"><span class="mpre">findBound</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_309_6_309_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_6_309_11&#39;)"><span class="hl_tyconref"><span class="mpre">Bound</span></span></a><span class="mpre">
</span><a name="loc_315_1_315_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_1_315_10&#39;)"><span class="hl_fundecl"><span class="mpre">findBound</span></span></a><span class="mpre"> </span><a name="loc_315_11_315_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_11_315_12&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_317_5_317_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_5_317_16&#39;)"><span class="hl_varref"><span class="mpre">handleBreak</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.Search.html#loc_153_1_153_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.html#loc_153_1_153_8&#39;)"><span class="hl_varref"><span class="mpre">Search.breakOn</span></span></a><span class="mpre"> </span><a href="#loc_315_11_315_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_11_315_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
  where
    </span><a name="loc_317_5_317_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_5_317_16&#39;)"><span class="hl_fundecl"><span class="mpre">handleBreak</span></span></a><span class="mpre"> (</span><a name="loc_317_18_317_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_18_317_19&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">, </span><a name="loc_317_21_317_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_21_317_22&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">)
        | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_317_21_317_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_21_317_22&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_323_5_323_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_5_323_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 318, srcSpanStartColumn = 25, srcSpanEndLine = 318, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 318, srcSpanStartColumn = 25, srcSpanEndLine = 318, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, "><span class="mpre">[lowBound..S.length bs - 1]</span></span><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_309_14_309_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_14_309_24&#39;)"><span class="hl_conref"><span class="mpre">FoundBound</span></span></a><span class="mpre"> </span><a href="#loc_317_18_317_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_18_317_19&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_315_11_315_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_11_315_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><a href="#loc_317_21_317_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_21_317_22&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

    </span><span class="hl_vardecl"><span class="mpre">lowBound</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_315_11_315_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_11_315_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

    </span><a name="loc_323_5_323_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_5_323_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] = </span><a href="#loc_310_14_310_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_14_310_21&#39;)"><span class="hl_conref"><span class="mpre">NoBound</span></span></a><span class="mpre">
    </span><a href="#loc_323_5_323_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_5_323_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_324_9_324_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_9_324_10&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_324_11_324_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_11_324_13&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">)
        | </span><a href="#loc_331_5_331_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_13&#39;)"><span class="hl_varref"><span class="mpre">mismatch</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 325, srcSpanStartColumn = 20, srcSpanEndLine = 325, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 325, srcSpanStartColumn = 20, srcSpanEndLine = 325, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, "><span class="mpre">[0..S.length b - 1]</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 325, srcSpanStartColumn = 40, srcSpanEndLine = 325, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, srcSpanStartLine = 325, srcSpanStartColumn = 40, srcSpanEndLine = 325, srcSpanEndColumn = 41},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Parse.hs&quot;, "><span class="mpre">[i..S.length bs - 1]</span></span><span class="mpre"> = </span><a href="#loc_323_5_323_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_5_323_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_324_11_324_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_11_324_13&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
            let </span><a name="loc_327_17_327_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_17_327_21&#39;)"><span class="hl_vardecl"><span class="mpre">endI</span></span></a><span class="mpre"> = </span><a href="#loc_324_9_324_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_9_324_10&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_315_11_315_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_11_315_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
             in if </span><a href="#loc_327_17_327_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_17_327_21&#39;)"><span class="hl_varref"><span class="mpre">endI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                    then </span><a href="#loc_311_14_311_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_14_311_26&#39;)"><span class="hl_conref"><span class="mpre">PartialBound</span></span></a><span class="mpre">
                    else </span><a href="#loc_309_14_309_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_14_309_24&#39;)"><span class="hl_conref"><span class="mpre">FoundBound</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_324_9_324_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_9_324_10&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_327_17_327_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_17_327_21&#39;)"><span class="hl_varref"><span class="mpre">endI</span></span></a><span class="mpre"> </span><a href="#loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
    </span><a name="loc_331_5_331_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_13&#39;)"><span class="hl_fundecl"><span class="mpre">mismatch</span></span></a><span class="mpre"> [] _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    </span><a href="#loc_331_5_331_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_13&#39;)"><span class="hl_fundecl"><span class="mpre">mismatch</span></span></a><span class="mpre"> _ [] = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    </span><a href="#loc_331_5_331_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_13&#39;)"><span class="hl_fundecl"><span class="mpre">mismatch</span></span></a><span class="mpre"> (</span><a name="loc_333_15_333_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_15_333_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_333_17_333_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_17_333_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) (</span><a name="loc_333_22_333_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_22_333_23&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_333_24_333_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_24_333_26&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">)
        | </span><span class="hl_varref"><span class="mpre">S.index</span></span><span class="mpre"> </span><a href="#loc_315_11_315_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_11_315_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_333_15_333_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_15_333_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.index</span></span><span class="mpre"> </span><a href="#loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_333_22_333_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_22_333_23&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_331_5_331_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_13&#39;)"><span class="hl_varref"><span class="mpre">mismatch</span></span></a><span class="mpre"> </span><a href="#loc_333_17_333_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_17_333_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_333_24_333_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_24_333_26&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

</span><a href="#loc_343_1_343_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_1_343_15&#39;)"><span class="mpre">sinkTillBound&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
               -&gt; </span><a href="#loc_119_6_119_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_6_119_14&#39;)"><span class="hl_tyconref"><span class="mpre">FileInfo</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">BackEnd</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre">
               -&gt; </span><a href="#loc_245_6_245_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_6_245_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre">)
</span><a name="loc_343_1_343_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_1_343_15&#39;)"><span class="hl_fundecl"><span class="mpre">sinkTillBound&#39;</span></span></a><span class="mpre"> </span><a name="loc_343_16_343_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_16_343_21&#39;)"><span class="hl_vardecl"><span class="mpre">bound</span></span></a><span class="mpre"> </span><a name="loc_343_22_343_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_22_343_26&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_343_27_343_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_27_343_29&#39;)"><span class="hl_vardecl"><span class="mpre">fi</span></span></a><span class="mpre"> </span><a name="loc_343_30_343_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_30_343_34&#39;)"><span class="hl_vardecl"><span class="mpre">sink</span></span></a><span class="mpre"> </span><a name="loc_343_35_343_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_35_343_38&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = do
    (</span><a name="loc_344_6_344_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_6_344_10&#39;)"><span class="hl_vardecl"><span class="mpre">next</span></span></a><span class="mpre">, </span><a name="loc_344_12_344_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_12_344_17&#39;)"><span class="hl_vardecl"><span class="mpre">final</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_354_1_354_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_14&#39;)"><span class="hl_varref"><span class="mpre">wrapTillBound</span></span></a><span class="mpre"> </span><a href="#loc_343_16_343_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_16_343_21&#39;)"><span class="hl_varref"><span class="mpre">bound</span></span></a><span class="mpre"> </span><a href="#loc_343_35_343_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_35_343_38&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
    </span><a name="loc_345_5_345_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_5_345_6&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_343_30_343_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_30_343_34&#39;)"><span class="hl_varref"><span class="mpre">sink</span></span></a><span class="mpre"> </span><a href="#loc_343_22_343_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_22_343_26&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_343_27_343_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_27_343_29&#39;)"><span class="hl_varref"><span class="mpre">fi</span></span></a><span class="mpre"> </span><a href="#loc_344_6_344_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_6_344_10&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre">
    </span><a name="loc_346_5_346_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_5_346_6&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_344_12_344_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_12_344_17&#39;)"><span class="hl_varref"><span class="mpre">final</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_346_5_346_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_5_346_6&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">, </span><a href="#loc_345_5_345_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_5_345_6&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)

data </span><span class="hl_tycondecl"><span class="mpre">WTB</span></span><span class="mpre"> = </span><a name="loc_349_12_349_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_12_349_22&#39;)"><span class="hl_condecl"><span class="mpre">WTBWorking</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)
         | </span><a name="loc_350_12_350_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_12_350_19&#39;)"><span class="hl_condecl"><span class="mpre">WTBDone</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a href="#loc_354_1_354_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_14&#39;)"><span class="mpre">wrapTillBound</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ bound</span></span><span class="mpre">
              -&gt; </span><a href="#loc_245_6_245_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_6_245_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre">
              -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ Bool indicates if the bound was found</span></span><span class="mpre">
</span><a name="loc_354_1_354_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_14&#39;)"><span class="hl_fundecl"><span class="mpre">wrapTillBound</span></span></a><span class="mpre"> </span><a name="loc_354_15_354_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_15_354_20&#39;)"><span class="hl_vardecl"><span class="mpre">bound</span></span></a><span class="mpre"> </span><a name="loc_354_21_354_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_21_354_24&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = do
    </span><a name="loc_355_5_355_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_5_355_8&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_349_12_349_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_12_349_22&#39;)"><span class="hl_conref"><span class="mpre">WTBWorking</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_364_5_364_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_5_364_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_355_5_355_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_5_355_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">, </span><a href="#loc_358_5_358_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_5_358_10&#39;)"><span class="hl_varref"><span class="mpre">final</span></span></a><span class="mpre"> </span><a href="#loc_355_5_355_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_5_355_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">)
  where
    </span><a name="loc_358_5_358_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_5_358_10&#39;)"><span class="hl_fundecl"><span class="mpre">final</span></span></a><span class="mpre"> </span><a name="loc_358_11_358_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_11_358_14&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> = do
        </span><a name="loc_359_9_359_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_9_359_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_358_11_358_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_11_358_14&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
        case </span><a href="#loc_359_9_359_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_9_359_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
            </span><a href="#loc_349_12_349_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_12_349_22&#39;)"><span class="hl_conref"><span class="mpre">WTBWorking</span></span></a><span class="mpre"> _ -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;wrapTillBound did not finish&quot;</span></span><span class="mpre">
            </span><a href="#loc_350_12_350_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_12_350_19&#39;)"><span class="hl_conref"><span class="mpre">WTBDone</span></span></a><span class="mpre"> </span><a name="loc_362_21_362_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_21_362_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_362_21_362_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_21_362_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

    </span><a name="loc_364_5_364_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_5_364_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_364_8_364_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_8_364_11&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> = do
        </span><a name="loc_365_9_365_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_9_365_14&#39;)"><span class="hl_vardecl"><span class="mpre">state</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_364_8_364_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_8_364_11&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
        case </span><a href="#loc_365_9_365_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_9_365_14&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> of
            </span><a href="#loc_350_12_350_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_12_350_19&#39;)"><span class="hl_conref"><span class="mpre">WTBDone</span></span></a><span class="mpre"> _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
            </span><a href="#loc_349_12_349_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_12_349_22&#39;)"><span class="hl_conref"><span class="mpre">WTBWorking</span></span></a><span class="mpre"> </span><a name="loc_368_24_368_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_24_368_29&#39;)"><span class="hl_vardecl"><span class="mpre">front</span></span></a><span class="mpre"> -&gt; do
                </span><a name="loc_369_17_369_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_17_369_19&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_253_1_253_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_1_253_11&#39;)"><span class="hl_varref"><span class="mpre">readSource</span></span></a><span class="mpre"> </span><a href="#loc_354_21_354_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_21_354_24&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
                if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_369_17_369_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_17_369_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                    then do
                        </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_364_8_364_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_8_364_11&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_350_12_350_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_12_350_19&#39;)"><span class="hl_conref"><span class="mpre">WTBDone</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
                        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_368_24_368_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_24_368_29&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><a href="#loc_369_17_369_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_17_369_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                    else </span><a href="#loc_376_9_376_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_9_376_13&#39;)"><span class="hl_varref"><span class="mpre">push</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_368_24_368_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_24_368_29&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><a href="#loc_369_17_369_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_17_369_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
      where
        </span><a name="loc_376_9_376_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_9_376_13&#39;)"><span class="hl_fundecl"><span class="mpre">push</span></span></a><span class="mpre"> </span><a name="loc_376_14_376_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_14_376_16&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
            case </span><a href="#loc_315_1_315_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_1_315_10&#39;)"><span class="hl_varref"><span class="mpre">findBound</span></span></a><span class="mpre"> </span><a href="#loc_354_15_354_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_15_354_20&#39;)"><span class="hl_varref"><span class="mpre">bound</span></span></a><span class="mpre"> </span><a href="#loc_376_14_376_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_14_376_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
                </span><a href="#loc_309_14_309_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_14_309_24&#39;)"><span class="hl_conref"><span class="mpre">FoundBound</span></span></a><span class="mpre"> </span><a name="loc_378_28_378_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_28_378_34&#39;)"><span class="hl_vardecl"><span class="mpre">before</span></span></a><span class="mpre"> </span><a name="loc_378_35_378_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_35_378_40&#39;)"><span class="hl_vardecl"><span class="mpre">after</span></span></a><span class="mpre"> -&gt; do
                    let </span><a name="loc_379_25_379_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_25_379_32&#39;)"><span class="hl_vardecl"><span class="mpre">before&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_426_1_426_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_426_1_426_9&#39;)"><span class="hl_varref"><span class="mpre">killCRLF</span></span></a><span class="mpre"> </span><a href="#loc_378_28_378_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_28_378_34&#39;)"><span class="hl_varref"><span class="mpre">before</span></span></a><span class="mpre">
                    </span><a href="#loc_260_1_260_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_1_260_9&#39;)"><span class="hl_varref"><span class="mpre">leftover</span></span></a><span class="mpre"> </span><a href="#loc_354_21_354_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_21_354_24&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_378_35_378_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_35_378_40&#39;)"><span class="hl_varref"><span class="mpre">after</span></span></a><span class="mpre">
                    </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_364_8_364_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_8_364_11&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_350_12_350_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_12_350_19&#39;)"><span class="hl_conref"><span class="mpre">WTBDone</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_379_25_379_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_25_379_32&#39;)"><span class="hl_varref"><span class="mpre">before&#39;</span></span></a><span class="mpre">
                </span><a href="#loc_310_14_310_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_14_310_21&#39;)"><span class="hl_conref"><span class="mpre">NoBound</span></span></a><span class="mpre"> -&gt; do
                    </span><span class="hl_comment"><span class="mpre">-- don&#39;t emit newlines, in case it&#39;s part of a bound</span></span><span class="mpre">
                    let (</span><a name="loc_385_26_385_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_26_385_32&#39;)"><span class="hl_vardecl"><span class="mpre">toEmit</span></span></a><span class="mpre">, </span><a name="loc_385_34_385_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_34_385_40&#39;)"><span class="hl_vardecl"><span class="mpre">front&#39;</span></span></a><span class="mpre">) =
                            if </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S8.null</span></span><span class="mpre"> </span><a href="#loc_376_14_376_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_14_376_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S8.last</span></span><span class="mpre"> </span><a href="#loc_376_14_376_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_14_376_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\r\n&quot;</span></span><span class="mpre">
                                then let (</span><a name="loc_387_43_387_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_43_387_44&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_387_46_387_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_46_387_47&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.splitAt</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_376_14_376_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_14_376_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_376_14_376_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_14_376_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                                      in (</span><a href="#loc_387_43_387_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_43_387_44&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">S.append</span></span><span class="mpre"> </span><a href="#loc_387_46_387_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_46_387_47&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
                                else (</span><a href="#loc_376_14_376_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_14_376_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">)
                    </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_364_8_364_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_8_364_11&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_349_12_349_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_12_349_22&#39;)"><span class="hl_conref"><span class="mpre">WTBWorking</span></span></a><span class="mpre"> </span><a href="#loc_385_34_385_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_34_385_40&#39;)"><span class="hl_varref"><span class="mpre">front&#39;</span></span></a><span class="mpre">
                    if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_385_26_385_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_26_385_32&#39;)"><span class="hl_varref"><span class="mpre">toEmit</span></span></a><span class="mpre">
                        then </span><a href="#loc_364_5_364_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_5_364_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_364_8_364_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_8_364_11&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
                        else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_385_26_385_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_26_385_32&#39;)"><span class="hl_varref"><span class="mpre">toEmit</span></span></a><span class="mpre">
                </span><a href="#loc_311_14_311_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_14_311_26&#39;)"><span class="hl_conref"><span class="mpre">PartialBound</span></span></a><span class="mpre"> -&gt; do
                    </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_364_8_364_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_8_364_11&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_349_12_349_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_12_349_22&#39;)"><span class="hl_conref"><span class="mpre">WTBWorking</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.append</span></span><span class="mpre"> </span><a href="#loc_376_14_376_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_14_376_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                    </span><a href="#loc_364_5_364_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_5_364_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_364_8_364_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_8_364_11&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">

</span><a href="#loc_403_1_403_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_1_403_14&#39;)"><span class="mpre">sinkTillBound</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
              -&gt; (</span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">)
              -&gt; </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">
              -&gt; </span><a href="#loc_245_6_245_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_6_245_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre">
              -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">)
</span><a name="loc_403_1_403_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_1_403_14&#39;)"><span class="hl_fundecl"><span class="mpre">sinkTillBound</span></span></a><span class="mpre"> </span><a name="loc_403_15_403_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_15_403_20&#39;)"><span class="hl_vardecl"><span class="mpre">bound</span></span></a><span class="mpre"> </span><a name="loc_403_21_403_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_21_403_25&#39;)"><span class="hl_vardecl"><span class="mpre">iter</span></span></a><span class="mpre"> </span><a name="loc_403_26_403_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_26_403_31&#39;)"><span class="hl_vardecl"><span class="mpre">seed0</span></span></a><span class="mpre"> </span><a name="loc_403_32_403_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_32_403_35&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = do
    (</span><a name="loc_404_6_404_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_6_404_10&#39;)"><span class="hl_vardecl"><span class="mpre">next</span></span></a><span class="mpre">, </span><a name="loc_404_12_404_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_12_404_17&#39;)"><span class="hl_vardecl"><span class="mpre">final</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_354_1_354_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_14&#39;)"><span class="hl_varref"><span class="mpre">wrapTillBound</span></span></a><span class="mpre"> </span><a href="#loc_403_15_403_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_15_403_20&#39;)"><span class="hl_varref"><span class="mpre">bound</span></span></a><span class="mpre"> </span><a href="#loc_403_32_403_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_32_403_35&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
    let </span><a name="loc_405_9_405_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_9_405_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_405_14_405_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_14_405_18&#39;)"><span class="hl_vardecl"><span class="mpre">seed</span></span></a><span class="mpre"> = do
            </span><a name="loc_406_13_406_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_13_406_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_404_6_404_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_6_404_10&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre">
            if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_406_13_406_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_13_406_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_405_14_405_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_14_405_18&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre">
                else </span><a href="#loc_403_21_403_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_21_403_25&#39;)"><span class="hl_varref"><span class="mpre">iter</span></span></a><span class="mpre"> </span><a href="#loc_405_14_405_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_14_405_18&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre"> </span><a href="#loc_406_13_406_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_13_406_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_405_9_405_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_9_405_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
    </span><a name="loc_410_5_410_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_5_410_9&#39;)"><span class="hl_vardecl"><span class="mpre">seed</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_405_9_405_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_9_405_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_403_26_403_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_26_403_31&#39;)"><span class="hl_varref"><span class="mpre">seed0</span></span></a><span class="mpre">
    </span><a name="loc_411_5_411_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_5_411_6&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_404_12_404_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_12_404_17&#39;)"><span class="hl_varref"><span class="mpre">final</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_411_5_411_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_5_411_6&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">, </span><a href="#loc_410_5_410_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_5_410_9&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre">)

</span><a href="#loc_415_1_415_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_1_415_11&#39;)"><span class="mpre">parseAttrs</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)]
</span><a name="loc_415_1_415_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_1_415_11&#39;)"><span class="hl_vardecl"><span class="mpre">parseAttrs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_421_5_421_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_5_421_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.split</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- semicolon</span></span><span class="mpre">
  where
    </span><a name="loc_417_5_417_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_5_417_7&#39;)"><span class="hl_vardecl"><span class="mpre">tw</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.dropWhile</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- space</span></span><span class="mpre">
    </span><a name="loc_418_5_418_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_5_418_7&#39;)"><span class="hl_fundecl"><span class="mpre">dq</span></span></a><span class="mpre"> </span><a name="loc_418_8_418_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_8_418_9&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_418_8_418_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_8_418_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.head</span></span><span class="mpre"> </span><a href="#loc_418_8_418_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_8_418_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">34</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.last</span></span><span class="mpre"> </span><a href="#loc_418_8_418_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_8_418_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">34</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- quote</span></span><span class="mpre">
                then </span><span class="hl_varref"><span class="mpre">S.tail</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.init</span></span><span class="mpre"> </span><a href="#loc_418_8_418_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_8_418_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
                else </span><a href="#loc_418_8_418_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_8_418_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><a name="loc_421_5_421_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_5_421_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_421_8_421_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_8_421_9&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
        let (</span><a name="loc_422_14_422_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_14_422_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_422_17_422_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_17_422_18&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><a href="#loc_50_1_50_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_13&#39;)"><span class="hl_varref"><span class="mpre">breakDiscard</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">61</span></span><span class="mpre"> </span><a href="#loc_421_8_421_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_8_421_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- equals sign</span></span><span class="mpre">
         in (</span><a href="#loc_417_5_417_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_5_417_7&#39;)"><span class="hl_varref"><span class="mpre">tw</span></span></a><span class="mpre"> </span><a href="#loc_422_14_422_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_14_422_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_418_5_418_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_5_418_7&#39;)"><span class="hl_varref"><span class="mpre">dq</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_417_5_417_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_5_417_7&#39;)"><span class="hl_varref"><span class="mpre">tw</span></span></a><span class="mpre"> </span><a href="#loc_422_17_422_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_17_422_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)

</span><a href="#loc_426_1_426_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_426_1_426_9&#39;)"><span class="mpre">killCRLF</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
</span><a name="loc_426_1_426_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_426_1_426_9&#39;)"><span class="hl_fundecl"><span class="mpre">killCRLF</span></span></a><span class="mpre"> </span><a name="loc_426_10_426_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_426_10_426_12&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_426_10_426_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_426_10_426_12&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.last</span></span><span class="mpre"> </span><a href="#loc_426_10_426_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_426_10_426_12&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> = </span><a href="#loc_426_10_426_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_426_10_426_12&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- line feed</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_431_1_431_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_1_431_7&#39;)"><span class="hl_varref"><span class="mpre">killCR</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.init</span></span><span class="mpre"> </span><a href="#loc_426_10_426_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_426_10_426_12&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><a href="#loc_431_1_431_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_1_431_7&#39;)"><span class="mpre">killCR</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
</span><a name="loc_431_1_431_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_1_431_7&#39;)"><span class="hl_fundecl"><span class="mpre">killCR</span></span></a><span class="mpre"> </span><a name="loc_431_8_431_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_8_431_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_431_8_431_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_8_431_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.last</span></span><span class="mpre"> </span><a href="#loc_431_8_431_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_8_431_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre"> = </span><a href="#loc_431_8_431_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_8_431_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- carriage return</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.init</span></span><span class="mpre"> </span><a href="#loc_431_8_431_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_8_431_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
</span></div></body></html>