<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}
{-# OPTIONS_HADDOCK hide, prune #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module         : Data.ByteString.Search.Internal.KnuthMorrisPratt</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright      : Justin Bailey</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                  Chris Kuklewicz</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                  Daniel Fischer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Licence        : BSD3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer     : Daniel Fischer &lt;daniel.is.fischer@googlemail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability      : Provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability    : non-portable (BangPatterns)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Fast Knuth-Morris-Pratt search of both strict and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- lazy &#39;S.ByteString&#39; values.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A description of the algorithm can be found at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://en.wikipedia.org/wiki/Knuth-Morris-Pratt_algorithm&gt;.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Original authors: Justin Bailey (jgbailey at gmail.com) and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Chris Kuklewicz (haskell at list.mightyreason.com).</span></span><span class="mpre">

module Data.ByteString.Search.Internal.KnuthMorrisPratt ( </span><span class="hl_comment"><span class="mpre">-- * Overview</span></span><span class="mpre">
                                                          </span><span class="hl_comment"><span class="mpre">-- $overview</span></span><span class="mpre">

                                                          </span><span class="hl_comment"><span class="mpre">-- * Partial application</span></span><span class="mpre">
                                                          </span><span class="hl_comment"><span class="mpre">-- $partial</span></span><span class="mpre">

                                                          </span><span class="hl_comment"><span class="mpre">-- * Complexity and Performance</span></span><span class="mpre">
                                                          </span><span class="hl_comment"><span class="mpre">-- $complexity</span></span><span class="mpre">

                                                          </span><span class="hl_comment"><span class="mpre">-- * Finding substrings</span></span><span class="mpre">
                                                          </span><span class="hl_comment"><span class="mpre">-- ** Overlapping</span></span><span class="mpre">
                                                            indicesL
                                                          , indicesS
                                                          </span><span class="hl_comment"><span class="mpre">-- ** Non-overlapping</span></span><span class="mpre">
                                                          , matchLL
                                                          , matchLS
                                                          , matchSL
                                                          , matchSS
                                                          ) where

import Data.ByteString.Search.Internal.Utils (</span><a href="Data.ByteString.Search.Internal.Utils.html#loc_73_1_73_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_73_1_73_11&#39;)"><span class="mpre">kmpBorders</span></a><span class="mpre">, </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_285_1_285_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_285_1_285_10&#39;)"><span class="mpre">strictify</span></a><span class="mpre">)

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/KnuthMorrisPratt.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 18, srcSpanEndLine = 44, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/KnuthMorrisPratt.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 18, srcSpanEndLine = 45, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import Data.ByteString.Unsafe (</span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="mpre">unsafeIndex</span></a><span class="mpre">)

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/KnuthMorrisPratt.hs&quot;, srcSpanStartLine = 48, srcSpanStartColumn = 8, srcSpanEndLine = 48, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.Array.Base&quot;"><span class="mpre">Data.Array.Base</span></span><span class="mpre"> (unsafeAt)
</span><span class="hl_comment"><span class="mpre">--import Data.Array.Unboxed</span></span><span class="mpre">

import Data.Int (</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="mpre">Int64</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- $overview</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module exports 6 search functions: &#39;matchLL&#39;, &#39;matchLS&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;matchSL&#39;, and &#39;matchSS&#39;, which find the indices of all non-overlapping</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- occurrences of a pattern in a target string, and the newly added</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;indicesL&#39; and &#39;indicesS&#39; which find the indices of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- all (possibly overlapping) occurrences of the pattern in the target</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- string. The performance should be the same when the pattern can&#39;t</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- overlap, but when the pattern occurs often and can have significant</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- overlap, the search excluding the overlap is faster.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In all cases, the list of indices is produced lazily.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The behaviour of the old @matchXY@ functions for an empty pattern has</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- changed, formerly they returned an empty list, now all functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- return @[0 .. &#39;length&#39; target]@ for an empty pattern.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The return type of the @matchXS@ functions changed to @[&#39;Int&#39;]@, since</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- strict ByteStrings are @&#39;Int&#39;@-indexed.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The trailing @L\/S@ in the function names indicate whether they work</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- on lazy or strict ByteStrings. Since all patterns are converted to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- strict ByteStrings for performance reasons, the @matchLX@ add just</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- an additional bit of wrapping around the worker in comparison to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @matchSX@. For the new functions, no such wrapping is provided, you</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- have to &#39;strictify&#39; lazy patterns before feeding them to the searcher.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The limit on the pattern lengths that the conversion to a strict</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ByteString imposes should be irrelevant in practice.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The functions searching in lazy ByteStrings don&#39;t keep any references</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to chunks already traversed. This means the garbage collector can free</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- those chunks early and only a small part of the target string needs to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- be in memory.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- $partial</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- These functions can all be usefully partially applied. Given only a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- pattern, the auxiliary data will be computed only once, allowing for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- efficient re-use.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- $complexity</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The preprocessing of the pattern is /O/(@patternLength@) in time and space.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The time complexity of the searching phase is /O/(@targetLength@) for all</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- functions.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In most cases, these functions are considerably slower than the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Boyer-Moore variants, performance is close to that of those from</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;Data.ByteString.Search.DFA&quot; resp. &quot;Data.ByteString.Lazy.Search.DFA&quot;.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                 Wrappers                                 --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;indicesL&#39;@ finds all indices of (possibly overlapping)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   occurrences of the pattern in the target string.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_113_1_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_9&#39;)"><span class="mpre">indicesL</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_113_1_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_9&#39;)"><span class="mpre">indicesL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Lazy target string</span></span><span class="mpre">
         -&gt; [</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">]          </span><span class="hl_comment"><span class="mpre">-- ^ Offsets of matches</span></span><span class="mpre">
</span><a name="loc_113_1_113_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_9&#39;)"><span class="hl_fundecl"><span class="mpre">indicesL</span></span></a><span class="mpre"> </span><a name="loc_113_10_113_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_10_113_13&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_115_5_115_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_5_115_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    </span><a name="loc_115_5_115_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_5_115_11&#39;)"><span class="hl_vardecl"><span class="mpre">search</span></span></a><span class="mpre"> = </span><a href="#loc_183_1_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_8&#39;)"><span class="hl_varref"><span class="mpre">matcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_113_10_113_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_10_113_13&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;indicesS&#39;@ finds all indices of (possibly overlapping)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   occurrences of the pattern in the target string.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_123_1_123_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_9&#39;)"><span class="mpre">indicesS</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_123_1_123_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_9&#39;)"><span class="mpre">indicesS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Strict target string</span></span><span class="mpre">
         -&gt; [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">]            </span><span class="hl_comment"><span class="mpre">-- ^ Offsets of matches</span></span><span class="mpre">
</span><a name="loc_123_1_123_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_9&#39;)"><span class="hl_fundecl"><span class="mpre">indicesS</span></span></a><span class="mpre"> </span><a name="loc_123_10_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_10_123_13&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_125_5_125_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_5_125_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[])
  where
    </span><a name="loc_125_5_125_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_5_125_11&#39;)"><span class="hl_vardecl"><span class="mpre">search</span></span></a><span class="mpre"> = </span><a href="#loc_183_1_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_8&#39;)"><span class="hl_varref"><span class="mpre">matcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_123_10_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_10_123_13&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;matchLL&#39;@ finds the starting indices of all /non-overlapping/ occurrences</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   of the pattern in the target string. It is a simple wrapper around</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;Data.ByteString.Lazy.Search.KMP.nonOverlappingIndices&#39; strictifying</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   the pattern.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_135_1_135_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_8&#39;)"><span class="mpre">matchLL</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_135_1_135_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_8&#39;)"><span class="mpre">matchLL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ Lazy pattern</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ Lazy target string</span></span><span class="mpre">
        -&gt; [</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">]                </span><span class="hl_comment"><span class="mpre">-- ^ Offsets of matches</span></span><span class="mpre">
</span><a name="loc_135_1_135_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_8&#39;)"><span class="hl_fundecl"><span class="mpre">matchLL</span></span></a><span class="mpre"> </span><a name="loc_135_9_135_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_12&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_138_5_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    !</span><a name="loc_137_6_137_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_6_137_10&#39;)"><span class="hl_vardecl"><span class="mpre">spat</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_285_1_285_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_285_1_285_10&#39;)"><span class="hl_varref"><span class="mpre">strictify</span></span></a><span class="mpre"> </span><a href="#loc_135_9_135_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_138_5_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_11&#39;)"><span class="hl_vardecl"><span class="mpre">search</span></span></a><span class="mpre"> = </span><a href="#loc_183_1_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_8&#39;)"><span class="hl_varref"><span class="mpre">matcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_137_6_137_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_6_137_10&#39;)"><span class="hl_varref"><span class="mpre">spat</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;matchLS&#39;@ finds the starting indices of all /non-overlapping/ occurrences</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   of the pattern in the target string. It is a simple wrapper around</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;Data.ByteString.Search.KMP.nonOverlappingIndices&#39; strictifying</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   the pattern.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_148_1_148_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_8&#39;)"><span class="mpre">matchLS</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_148_1_148_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_8&#39;)"><span class="mpre">matchLS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ Lazy pattern</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ Strict target string</span></span><span class="mpre">
        -&gt; [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">]                </span><span class="hl_comment"><span class="mpre">-- ^ Offsets of matches</span></span><span class="mpre">
</span><a name="loc_148_1_148_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_8&#39;)"><span class="hl_fundecl"><span class="mpre">matchLS</span></span></a><span class="mpre"> </span><a name="loc_148_9_148_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_12&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_151_5_151_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_5_151_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[])
  where
    !</span><a name="loc_150_6_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_6_150_10&#39;)"><span class="hl_vardecl"><span class="mpre">spat</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_285_1_285_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_285_1_285_10&#39;)"><span class="hl_varref"><span class="mpre">strictify</span></span></a><span class="mpre"> </span><a href="#loc_148_9_148_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_151_5_151_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_5_151_11&#39;)"><span class="hl_vardecl"><span class="mpre">search</span></span></a><span class="mpre"> = </span><a href="#loc_183_1_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_8&#39;)"><span class="hl_varref"><span class="mpre">matcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_150_6_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_6_150_10&#39;)"><span class="hl_varref"><span class="mpre">spat</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;matchSS&#39;@ finds the starting indices of all /non-overlapping/ occurrences</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   of the pattern in the target string. It is an alias for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;Data.ByteString.Search.KMP.nonOverlappingIndices&#39;.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_160_1_160_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_8&#39;)"><span class="mpre">matchSS</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_160_1_160_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_8&#39;)"><span class="mpre">matchSS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ Strict target string</span></span><span class="mpre">
        -&gt; [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">]                </span><span class="hl_comment"><span class="mpre">-- ^ Offsets of matches</span></span><span class="mpre">
</span><a name="loc_160_1_160_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_8&#39;)"><span class="hl_fundecl"><span class="mpre">matchSS</span></span></a><span class="mpre"> </span><a name="loc_160_9_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_12&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_162_5_162_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_5_162_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[])
  where
    </span><a name="loc_162_5_162_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_5_162_11&#39;)"><span class="hl_vardecl"><span class="mpre">search</span></span></a><span class="mpre"> = </span><a href="#loc_183_1_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_8&#39;)"><span class="hl_varref"><span class="mpre">matcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_160_9_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;matchSL&#39;@ finds the starting indices of all /non-overlapping/ occurrences</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   of the pattern in the target string. It is an alias for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;Data.ByteString.Lazy.Search.KMP.nonOverlappingIndices&#39;.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_171_1_171_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_8&#39;)"><span class="mpre">matchSL</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_171_1_171_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_8&#39;)"><span class="mpre">matchSL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ Lazy target string</span></span><span class="mpre">
        -&gt; [</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">]              </span><span class="hl_comment"><span class="mpre">-- ^ Offsets of matches</span></span><span class="mpre">
</span><a name="loc_171_1_171_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_8&#39;)"><span class="hl_fundecl"><span class="mpre">matchSL</span></span></a><span class="mpre"> </span><a name="loc_171_9_171_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_9_171_12&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_173_5_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_5_173_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    </span><a name="loc_173_5_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_5_173_11&#39;)"><span class="hl_vardecl"><span class="mpre">search</span></span></a><span class="mpre"> = </span><a href="#loc_183_1_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_8&#39;)"><span class="hl_varref"><span class="mpre">matcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_171_9_171_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_9_171_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                  Worker                                  --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclSpecSig (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/KnuthMorrisPratt.hs&quot;, srcSpanStartLine = 180, srcSpanStartColumn = 1, srcSpanEndLine = 181, srcSpanEndColumn = 80}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/KnuthMorrisPratt.hs&quot;, srcSpanStartLine = 180, srcSpanStartColumn = 1, srcSpanEndLine = 180, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/hom"><span class="mpre">{-# SPECIALISE matcher :: Bool -&gt; S.ByteString -&gt; [S.ByteString] -&gt; [Int],
                          Bool -&gt; S.ByteString -&gt; [S.ByteString] -&gt; [Int64] #-}</span></span><span class="mpre">
</span><a href="#loc_183_1_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_8&#39;)"><span class="mpre">matcher</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/KnuthMorrisPratt.hs&quot;, srcSpanStartLine = 182, srcSpanStartColumn = 12, srcSpanEndLine = 182, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/KnuthMorrisPratt.hs&quot;, srcSpanStartLine = 182, srcSpanStartColumn = 23, srcSpanEndLine = 182, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcI"><span class="mpre">Integral a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_183_1_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_8&#39;)"><span class="hl_fundecl"><span class="mpre">matcher</span></span></a><span class="mpre"> _ !</span><a name="loc_183_12_183_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_12_183_15&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_183_12_183_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_12_183_15&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> =  (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_186_7_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_7_186_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    where
      </span><a name="loc_186_7_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_7_186_9&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> _ [] = []
      </span><a href="#loc_186_7_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_7_186_9&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_187_11_187_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_11_187_16&#39;)"><span class="hl_vardecl"><span class="mpre">prior</span></span></a><span class="mpre"> (!</span><a name="loc_187_19_187_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_19_187_22&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_187_25_187_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_25_187_29&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = [</span><a href="#loc_187_11_187_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_11_187_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_187_59_187_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_59_187_60&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> | </span><a name="loc_187_59_187_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_59_187_60&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> &lt;- </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/KnuthMorrisPratt.hs&quot;, srcSpanStartLine = 187, srcSpanStartColumn = 64, srcSpanEndLine = 187, srcSpanEndColumn = 72}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/KnuthMorrisPratt.hs&quot;, srcSpanStartLine = 187, srcSpanStartColumn = 64, srcSpanEndLine = 187, srcSpanEndColumn = 65},SrcSpan {srcSpanFilename = "><span class="mpre">[1 .. l]</span></span><span class="mpre">]
                                  </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_186_7_186_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_7_186_9&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_191_12_191_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_12_191_18&#39;)"><span class="hl_varref"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> </span><a href="#loc_187_25_187_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_25_187_29&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
        where
          !</span><a name="loc_190_12_190_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_12_190_13&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_187_19_187_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_19_187_22&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
          !</span><a name="loc_191_12_191_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_12_191_18&#39;)"><span class="hl_vardecl"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_187_11_187_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_11_187_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_190_12_190_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_12_190_13&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
</span><a href="#loc_183_1_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_8&#39;)"><span class="hl_fundecl"><span class="mpre">matcher</span></span></a><span class="mpre"> !</span><a name="loc_192_10_192_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_10_192_17&#39;)"><span class="hl_vardecl"><span class="mpre">overlap</span></span></a><span class="mpre"> </span><a name="loc_192_18_192_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_18_192_21&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_202_5_202_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_13&#39;)"><span class="hl_varref"><span class="mpre">searcher</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  where
    !</span><a name="loc_194_6_194_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_6_194_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_192_18_192_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_18_192_21&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    !</span><a name="loc_195_6_195_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_6_195_11&#39;)"><span class="hl_vardecl"><span class="mpre">bords</span></span></a><span class="mpre">  = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_73_1_73_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_73_1_73_11&#39;)"><span class="hl_varref"><span class="mpre">kmpBorders</span></span></a><span class="mpre"> </span><a href="#loc_192_18_192_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_18_192_21&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    !</span><a name="loc_196_6_196_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_6_196_10&#39;)"><span class="hl_vardecl"><span class="mpre">patH</span></span></a><span class="mpre">   = </span><a href="#loc_200_5_200_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_5_200_10&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_198_5_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_5_198_9&#39;)"><span class="mpre">misi</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a name="loc_198_5_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_5_198_9&#39;)"><span class="hl_fundecl"><span class="mpre">misi</span></span></a><span class="mpre"> !</span><a name="loc_198_11_198_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_11_198_12&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_195_6_195_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_6_195_11&#39;)"><span class="hl_varref"><span class="mpre">bords</span></span></a><span class="mpre"> </span><a href="#loc_198_11_198_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_11_198_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_200_5_200_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_5_200_10&#39;)"><span class="mpre">patAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a name="loc_200_5_200_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_5_200_10&#39;)"><span class="hl_fundecl"><span class="mpre">patAt</span></span></a><span class="mpre"> !</span><a name="loc_200_12_200_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_12_200_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_192_18_192_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_18_192_21&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><a href="#loc_200_12_200_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_12_200_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
    !</span><a name="loc_201_6_201_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_6_201_9&#39;)"><span class="hl_vardecl"><span class="mpre">ami</span></span></a><span class="mpre">    = if </span><a href="#loc_192_10_192_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_10_192_17&#39;)"><span class="hl_varref"><span class="mpre">overlap</span></span></a><span class="mpre"> then </span><a href="#loc_198_5_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_5_198_9&#39;)"><span class="hl_varref"><span class="mpre">misi</span></span></a><span class="mpre"> </span><a href="#loc_194_6_194_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_6_194_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> else </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><a name="loc_202_5_202_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_13&#39;)"><span class="hl_fundecl"><span class="mpre">searcher</span></span></a><span class="mpre"> _ _ [] = []
    </span><a href="#loc_202_5_202_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_13&#39;)"><span class="hl_fundecl"><span class="mpre">searcher</span></span></a><span class="mpre"> !</span><a name="loc_203_15_203_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_15_203_20&#39;)"><span class="hl_vardecl"><span class="mpre">prior</span></span></a><span class="mpre"> !</span><a name="loc_203_22_203_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_22_203_28&#39;)"><span class="hl_vardecl"><span class="mpre">patPos</span></span></a><span class="mpre"> (!</span><a name="loc_203_31_203_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_31_203_34&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_203_37_203_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_37_203_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">)
      | </span><a href="#loc_203_22_203_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_22_203_28&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><a href="#loc_210_9_210_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_9_210_18&#39;)"><span class="hl_varref"><span class="mpre">checkHead</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_215_9_215_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_9_215_18&#39;)"><span class="hl_varref"><span class="mpre">findMatch</span></span></a><span class="mpre"> </span><a href="#loc_203_22_203_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_22_203_28&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
      where
        !</span><a name="loc_207_10_207_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_10_207_16&#39;)"><span class="hl_vardecl"><span class="mpre">strLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_203_31_203_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_31_203_34&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
        </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_209_9_209_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_9_209_14&#39;)"><span class="mpre">strAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
        </span><a name="loc_209_9_209_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_9_209_14&#39;)"><span class="hl_fundecl"><span class="mpre">strAt</span></span></a><span class="mpre"> !</span><a name="loc_209_16_209_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_16_209_17&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_203_31_203_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_31_203_34&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_209_16_209_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_16_209_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
        </span><a name="loc_210_9_210_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_9_210_18&#39;)"><span class="hl_fundecl"><span class="mpre">checkHead</span></span></a><span class="mpre"> !</span><a name="loc_210_20_210_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_20_210_24&#39;)"><span class="hl_vardecl"><span class="mpre">strI</span></span></a><span class="mpre">
            | </span><a href="#loc_210_20_210_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_20_210_24&#39;)"><span class="hl_varref"><span class="mpre">strI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_207_10_207_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_10_207_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> =
              </span><a href="#loc_202_5_202_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_13&#39;)"><span class="hl_varref"><span class="mpre">searcher</span></span></a><span class="mpre"> (</span><a href="#loc_203_15_203_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_15_203_20&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_207_10_207_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_10_207_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_203_37_203_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_37_203_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
            | </span><a href="#loc_209_9_209_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_9_209_14&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_210_20_210_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_20_210_24&#39;)"><span class="hl_varref"><span class="mpre">strI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_196_6_196_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_6_196_10&#39;)"><span class="hl_varref"><span class="mpre">patH</span></span></a><span class="mpre"> = </span><a href="#loc_215_9_215_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_9_215_18&#39;)"><span class="hl_varref"><span class="mpre">findMatch</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (</span><a href="#loc_210_20_210_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_20_210_24&#39;)"><span class="hl_varref"><span class="mpre">strI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_210_9_210_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_9_210_18&#39;)"><span class="hl_varref"><span class="mpre">checkHead</span></span></a><span class="mpre"> (</span><a href="#loc_210_20_210_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_20_210_24&#39;)"><span class="hl_varref"><span class="mpre">strI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><a name="loc_215_9_215_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_9_215_18&#39;)"><span class="hl_fundecl"><span class="mpre">findMatch</span></span></a><span class="mpre"> !</span><a name="loc_215_20_215_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_20_215_24&#39;)"><span class="hl_vardecl"><span class="mpre">patI</span></span></a><span class="mpre"> !</span><a name="loc_215_26_215_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_26_215_30&#39;)"><span class="hl_vardecl"><span class="mpre">strI</span></span></a><span class="mpre">
            | </span><a href="#loc_215_20_215_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_20_215_24&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_194_6_194_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_6_194_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> =
                (</span><a href="#loc_203_15_203_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_15_203_20&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_215_26_215_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_26_215_30&#39;)"><span class="hl_varref"><span class="mpre">strI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_194_6_194_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_6_194_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">)
                    </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> if </span><a href="#loc_201_6_201_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_6_201_9&#39;)"><span class="hl_varref"><span class="mpre">ami</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><a href="#loc_210_9_210_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_9_210_18&#39;)"><span class="hl_varref"><span class="mpre">checkHead</span></span></a><span class="mpre"> </span><a href="#loc_215_26_215_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_26_215_30&#39;)"><span class="hl_varref"><span class="mpre">strI</span></span></a><span class="mpre"> else </span><a href="#loc_215_9_215_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_9_215_18&#39;)"><span class="hl_varref"><span class="mpre">findMatch</span></span></a><span class="mpre"> </span><a href="#loc_201_6_201_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_6_201_9&#39;)"><span class="hl_varref"><span class="mpre">ami</span></span></a><span class="mpre"> </span><a href="#loc_215_26_215_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_26_215_30&#39;)"><span class="hl_varref"><span class="mpre">strI</span></span></a><span class="mpre">
            | </span><a href="#loc_215_26_215_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_26_215_30&#39;)"><span class="hl_varref"><span class="mpre">strI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_207_10_207_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_10_207_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> =
                </span><a href="#loc_202_5_202_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_13&#39;)"><span class="hl_varref"><span class="mpre">searcher</span></span></a><span class="mpre"> (</span><a href="#loc_203_15_203_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_15_203_20&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_207_10_207_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_10_207_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">) </span><a href="#loc_215_20_215_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_20_215_24&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><a href="#loc_203_37_203_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_37_203_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">      =
                if </span><a href="#loc_209_9_209_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_9_209_14&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_215_26_215_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_26_215_30&#39;)"><span class="hl_varref"><span class="mpre">strI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_200_5_200_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_5_200_10&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><a href="#loc_215_20_215_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_20_215_24&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">
                    then </span><a href="#loc_215_9_215_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_9_215_18&#39;)"><span class="hl_varref"><span class="mpre">findMatch</span></span></a><span class="mpre"> (</span><a href="#loc_215_20_215_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_20_215_24&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_215_26_215_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_26_215_30&#39;)"><span class="hl_varref"><span class="mpre">strI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                    else case </span><a href="#loc_198_5_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_5_198_9&#39;)"><span class="hl_varref"><span class="mpre">misi</span></span></a><span class="mpre"> </span><a href="#loc_215_20_215_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_20_215_24&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> of
                            </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">    -&gt; </span><a href="#loc_210_9_210_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_9_210_18&#39;)"><span class="hl_varref"><span class="mpre">checkHead</span></span></a><span class="mpre"> </span><a href="#loc_215_26_215_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_26_215_30&#39;)"><span class="hl_varref"><span class="mpre">strI</span></span></a><span class="mpre">
                            (</span><span class="warning" data-warning="PatPNeg (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/KnuthMorrisPratt.hs&quot;, srcSpanStartLine = 226, srcSpanStartColumn = 30, srcSpanEndLine = 226, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/KnuthMorrisPratt.hs&quot;, srcSpanStartLine = 226, srcSpanStartColumn = 30, srcSpanEndLine = 226, srcSpanEndColumn = 31}]}) (PLit (SrcSpanInfo {srcInfoSpa"><span class="mpre">-1</span></span><span class="mpre">) -&gt; </span><a href="#loc_210_9_210_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_9_210_18&#39;)"><span class="hl_varref"><span class="mpre">checkHead</span></span></a><span class="mpre"> (</span><a href="#loc_215_26_215_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_26_215_30&#39;)"><span class="hl_varref"><span class="mpre">strI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                            </span><a name="loc_227_29_227_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_29_227_31&#39;)"><span class="hl_vardecl"><span class="mpre">pI</span></span></a><span class="mpre">   -&gt; </span><a href="#loc_215_9_215_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_9_215_18&#39;)"><span class="hl_varref"><span class="mpre">findMatch</span></span></a><span class="mpre"> </span><a href="#loc_227_29_227_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_29_227_31&#39;)"><span class="hl_varref"><span class="mpre">pI</span></span></a><span class="mpre"> </span><a href="#loc_215_26_215_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_26_215_30&#39;)"><span class="hl_varref"><span class="mpre">strI</span></span></a><span class="mpre">
</span></div></body></html>