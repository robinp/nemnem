<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
</span><span class="hl_comment"><span class="mpre">-- | This module implements the algorithms described in RFC 6265 for the Network.HTTP.Conduit library.</span></span><span class="mpre">
module Network.HTTP.Client.Cookies
    ( updateCookieJar
    , receiveSetCookie
    , generateCookie
    , insertCheckedCookie
    , insertCookiesIntoRequest
    , computeCookieString
    , evictExpiredCookies
    , createCookieJar
    , destroyCookieJar
    , pathMatches
    , removeExistingCookieFromCookieJar
    , domainMatches
    , isIpAddress
    , defaultPath
    ) where

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 18, srcSpanEndLine = 20, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as BS
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 18, srcSpanEndLine = 21, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as S8
import Data.Maybe
import qualified Data.List as L
import Data.Time.Clock
import Data.Time.Calendar
import Web.Cookie
import qualified Data.CaseInsensitive as CI
import Blaze.ByteString.Builder
import qualified Network.PublicSuffixList.Lookup as PSL
import Data.Text.Encoding (</span><a href="Data.Text.Encoding.html#loc_142_1_142_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_142_1_142_15&#39;)"><span class="mpre">decodeUtf8With</span></a><span class="mpre">)
import Data.Text.Encoding.Error (</span><a href="Data.Text.Encoding.Error.html#loc_107_1_107_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.Error.html#loc_107_1_107_14&#39;)"><span class="mpre">lenientDecode</span></a><span class="mpre">)

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 18, srcSpanEndLine = 33, srcSpanEndColumn = 45}, srcInfoPoints = []}) &quot;Network.HTTP.Client.Request&quot;"><span class="mpre">Network.HTTP.Client.Request</span></span><span class="mpre"> as Req
import qualified Network.HTTP.Client.Response as Res
import Network.HTTP.Client.Types as Req

</span><a href="#loc_38_1_38_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_6&#39;)"><span class="mpre">slash</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 10, srcSpanEndLine = 37, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 21, srcSpanEndLine = 37, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/"><span class="mpre">Integral a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_38_1_38_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_6&#39;)"><span class="hl_vardecl"><span class="mpre">slash</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">47</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- &#39;/&#39;</span></span><span class="mpre">

</span><a href="#loc_41_1_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_12&#39;)"><span class="mpre">isIpAddress</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_41_1_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_12&#39;)"><span class="hl_vardecl"><span class="mpre">isIpAddress</span></span></a><span class="mpre"> =
    </span><a href="#loc_44_5_44_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_5_44_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">
  where
    </span><a name="loc_44_5_44_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_5_44_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_44_10_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_10_44_12&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">BS.null</span></span><span class="mpre"> </span><a href="#loc_44_10_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_10_44_12&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
    </span><a href="#loc_44_5_44_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_5_44_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_45_8_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_8_45_12&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a name="loc_45_13_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
        case </span><span class="hl_varref"><span class="mpre">S8.readInt</span></span><span class="mpre"> </span><a href="#loc_50_10_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_10_50_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_47_19_47_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">, </span><a name="loc_47_22_47_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_24&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">BS.null</span></span><span class="mpre"> </span><a href="#loc_47_22_47_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_22_47_24&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_47_19_47_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_47_19_47_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">256</span></span><span class="mpre"> -&gt; </span><a href="#loc_44_5_44_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_5_44_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_45_8_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_8_45_12&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_51_9_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
            _ -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
      where
        (</span><a name="loc_50_10_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_10_50_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_50_13_50_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_13_50_15&#39;)"><span class="hl_vardecl"><span class="mpre">y&#39;</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">BS.breakByte</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">46</span></span><span class="mpre"> </span><a href="#loc_45_13_45_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- period</span></span><span class="mpre">
        </span><a name="loc_51_9_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">BS.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_50_13_50_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_13_50_15&#39;)"><span class="hl_varref"><span class="mpre">y&#39;</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This corresponds to the subcomponent algorithm entitled \&quot;Domain Matching\&quot; detailed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in section 5.1.3</span></span><span class="mpre">
</span><a href="#loc_56_1_56_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_14&#39;)"><span class="mpre">domainMatches</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_56_1_56_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_14&#39;)"><span class="hl_fundecl"><span class="mpre">domainMatches</span></span></a><span class="mpre"> </span><a name="loc_56_15_56_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_15_56_21&#39;)"><span class="hl_vardecl"><span class="mpre">string</span></span></a><span class="mpre"> </span><a name="loc_56_22_56_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_22_56_34&#39;)"><span class="hl_vardecl"><span class="mpre">domainString</span></span></a><span class="mpre">
  | </span><a href="#loc_56_15_56_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_15_56_21&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_56_22_56_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_22_56_34&#39;)"><span class="hl_varref"><span class="mpre">domainString</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">BS.length</span></span><span class="mpre"> </span><a href="#loc_56_15_56_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_15_56_21&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.length</span></span><span class="mpre"> </span><a href="#loc_56_22_56_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_22_56_34&#39;)"><span class="hl_varref"><span class="mpre">domainString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
  | </span><a href="#loc_56_22_56_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_22_56_34&#39;)"><span class="hl_varref"><span class="mpre">domainString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`BS.isSuffixOf`</span></span><span class="mpre"> </span><a href="#loc_56_15_56_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_15_56_21&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.singleton</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BS.last</span></span><span class="mpre"> </span><a href="#loc_61_9_61_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_9_61_19&#39;)"><span class="hl_varref"><span class="mpre">difference</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_41_1_41_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_12&#39;)"><span class="hl_varref"><span class="mpre">isIpAddress</span></span></a><span class="mpre"> </span><a href="#loc_56_15_56_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_15_56_21&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
  where </span><a name="loc_61_9_61_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_9_61_19&#39;)"><span class="hl_vardecl"><span class="mpre">difference</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">BS.take</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BS.length</span></span><span class="mpre"> </span><a href="#loc_56_15_56_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_15_56_21&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.length</span></span><span class="mpre"> </span><a href="#loc_56_22_56_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_22_56_34&#39;)"><span class="hl_varref"><span class="mpre">domainString</span></span></a><span class="mpre">) </span><a href="#loc_56_15_56_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_15_56_21&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This corresponds to the subcomponent algorithm entitled \&quot;Paths\&quot; detailed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in section 5.1.4</span></span><span class="mpre">
</span><a href="#loc_66_1_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_12&#39;)"><span class="mpre">defaultPath</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">Req.Request</span></span></a><span class="mpre">   -&gt; </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre">
</span><a name="loc_66_1_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_12&#39;)"><span class="hl_fundecl"><span class="mpre">defaultPath</span></span></a><span class="mpre"> </span><a name="loc_66_13_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_16&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">BS.null</span></span><span class="mpre"> </span><a href="#loc_71_9_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_17&#39;)"><span class="hl_varref"><span class="mpre">uri_path</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">BS.singleton</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BS.head</span></span><span class="mpre"> </span><a href="#loc_71_9_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_17&#39;)"><span class="hl_varref"><span class="mpre">uri_path</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">BS.count</span></span><span class="mpre"> </span><a href="#loc_38_1_38_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_6&#39;)"><span class="hl_varref"><span class="mpre">slash</span></span></a><span class="mpre"> </span><a href="#loc_71_9_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_17&#39;)"><span class="hl_varref"><span class="mpre">uri_path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">BS.reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.tail</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.dropWhile</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_38_1_38_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_6&#39;)"><span class="hl_varref"><span class="mpre">slash</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.reverse</span></span><span class="mpre"> </span><a href="#loc_71_9_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_17&#39;)"><span class="hl_varref"><span class="mpre">uri_path</span></span></a><span class="mpre">
  where </span><a name="loc_71_9_71_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_17&#39;)"><span class="hl_vardecl"><span class="mpre">uri_path</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Types.html#loc_298_7_298_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_298_7_298_11&#39;)"><span class="hl_varref"><span class="mpre">Req.path</span></span></a><span class="mpre"> </span><a href="#loc_66_13_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_16&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This corresponds to the subcomponent algorithm entitled \&quot;Path-Match\&quot; detailed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in section 5.1.4</span></span><span class="mpre">
</span><a href="#loc_76_1_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_12&#39;)"><span class="mpre">pathMatches</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_76_1_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_12&#39;)"><span class="hl_fundecl"><span class="mpre">pathMatches</span></span></a><span class="mpre"> </span><a name="loc_76_13_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_13_76_24&#39;)"><span class="hl_vardecl"><span class="mpre">requestPath</span></span></a><span class="mpre"> </span><a name="loc_76_25_76_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_25_76_35&#39;)"><span class="hl_vardecl"><span class="mpre">cookiePath</span></span></a><span class="mpre">
  | </span><a href="#loc_76_25_76_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_25_76_35&#39;)"><span class="hl_varref"><span class="mpre">cookiePath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_82_9_82_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_9_82_14&#39;)"><span class="hl_varref"><span class="mpre">path&#39;</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
  | </span><a href="#loc_76_25_76_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_25_76_35&#39;)"><span class="hl_varref"><span class="mpre">cookiePath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`BS.isPrefixOf`</span></span><span class="mpre"> </span><a href="#loc_82_9_82_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_9_82_14&#39;)"><span class="hl_varref"><span class="mpre">path&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.singleton</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BS.last</span></span><span class="mpre"> </span><a href="#loc_76_25_76_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_25_76_35&#39;)"><span class="hl_varref"><span class="mpre">cookiePath</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
  | </span><a href="#loc_76_25_76_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_25_76_35&#39;)"><span class="hl_varref"><span class="mpre">cookiePath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`BS.isPrefixOf`</span></span><span class="mpre"> </span><a href="#loc_82_9_82_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_9_82_14&#39;)"><span class="hl_varref"><span class="mpre">path&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.singleton</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BS.head</span></span><span class="mpre"> </span><a href="#loc_81_9_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_18&#39;)"><span class="hl_varref"><span class="mpre">remainder</span></span></a><span class="mpre">)  </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
  where </span><a name="loc_81_9_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_18&#39;)"><span class="hl_vardecl"><span class="mpre">remainder</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">BS.drop</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BS.length</span></span><span class="mpre"> </span><a href="#loc_76_25_76_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_25_76_35&#39;)"><span class="hl_varref"><span class="mpre">cookiePath</span></span></a><span class="mpre">) </span><a href="#loc_76_13_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_13_76_24&#39;)"><span class="hl_varref"><span class="mpre">requestPath</span></span></a><span class="mpre">
        </span><a name="loc_82_9_82_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_9_82_14&#39;)"><span class="hl_vardecl"><span class="mpre">path&#39;</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">S8.uncons</span></span><span class="mpre"> </span><a href="#loc_76_13_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_13_76_24&#39;)"><span class="hl_varref"><span class="mpre">requestPath</span></span></a><span class="mpre"> of
                 </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="mpre">, _) -&gt; </span><a href="#loc_76_13_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_13_76_24&#39;)"><span class="hl_varref"><span class="mpre">requestPath</span></span></a><span class="mpre">
                 _             -&gt; </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`S8.cons`</span></span><span class="mpre"> </span><a href="#loc_76_13_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_13_76_24&#39;)"><span class="hl_varref"><span class="mpre">requestPath</span></span></a><span class="mpre">

</span><a href="#loc_87_1_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_16&#39;)"><span class="mpre">createCookieJar</span></a><span class="mpre"> :: [</span><a href="Network.HTTP.Client.Types.html#loc_115_6_115_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_115_6_115_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre">] -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre">
</span><a name="loc_87_1_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_16&#39;)"><span class="hl_vardecl"><span class="mpre">createCookieJar</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">CJ</span></span><span class="mpre">

</span><a href="#loc_90_1_90_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_17&#39;)"><span class="mpre">destroyCookieJar</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre"> -&gt; [</span><a href="Network.HTTP.Client.Types.html#loc_115_6_115_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_115_6_115_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre">]
</span><a name="loc_90_1_90_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_17&#39;)"><span class="hl_vardecl"><span class="mpre">destroyCookieJar</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Types.html#loc_130_26_130_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_26_130_32&#39;)"><span class="hl_varref"><span class="mpre">expose</span></span></a><span class="mpre">

</span><a href="#loc_93_1_93_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_20&#39;)"><span class="mpre">insertIntoCookieJar</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_115_6_115_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_115_6_115_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre"> -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre"> -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre">
</span><a name="loc_93_1_93_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_20&#39;)"><span class="hl_fundecl"><span class="mpre">insertIntoCookieJar</span></span></a><span class="mpre"> </span><a name="loc_93_21_93_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_21_93_27&#39;)"><span class="hl_vardecl"><span class="mpre">cookie</span></span></a><span class="mpre"> </span><a name="loc_93_28_93_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_28_93_39&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">CJ</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_93_21_93_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_21_93_27&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_94_9_94_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_19&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre">
  where </span><a name="loc_94_9_94_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_19&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Types.html#loc_130_26_130_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_26_130_32&#39;)"><span class="hl_varref"><span class="mpre">expose</span></span></a><span class="mpre"> </span><a href="#loc_93_28_93_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_28_93_39&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">

</span><a href="#loc_97_1_97_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_34&#39;)"><span class="mpre">removeExistingCookieFromCookieJar</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_115_6_115_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_115_6_115_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre"> -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre"> -&gt; (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_115_6_115_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_115_6_115_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre">)
</span><a name="loc_97_1_97_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_34&#39;)"><span class="hl_fundecl"><span class="mpre">removeExistingCookieFromCookieJar</span></span></a><span class="mpre"> </span><a name="loc_97_35_97_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_35_97_41&#39;)"><span class="hl_vardecl"><span class="mpre">cookie</span></span></a><span class="mpre"> </span><a name="loc_97_42_97_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_42_97_53&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre"> = (</span><a href="#loc_98_10_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_10_98_12&#39;)"><span class="hl_varref"><span class="mpre">mc</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">CJ</span></span><span class="mpre"> </span><a href="#loc_98_14_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_16&#39;)"><span class="hl_varref"><span class="mpre">lc</span></span></a><span class="mpre">)
  where (</span><a name="loc_98_10_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_10_98_12&#39;)"><span class="hl_vardecl"><span class="mpre">mc</span></span></a><span class="mpre">, </span><a name="loc_98_14_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_14_98_16&#39;)"><span class="hl_vardecl"><span class="mpre">lc</span></span></a><span class="mpre">) = </span><a href="#loc_99_9_99_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_48&#39;)"><span class="hl_varref"><span class="mpre">removeExistingCookieFromCookieJarHelper</span></span></a><span class="mpre"> </span><a href="#loc_97_35_97_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_35_97_41&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_130_26_130_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_26_130_32&#39;)"><span class="hl_varref"><span class="mpre">expose</span></span></a><span class="mpre"> </span><a href="#loc_97_42_97_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_42_97_53&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">)
        </span><a name="loc_99_9_99_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_48&#39;)"><span class="hl_fundecl"><span class="mpre">removeExistingCookieFromCookieJarHelper</span></span></a><span class="mpre"> _ [] = (</span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">, [])
        </span><a href="#loc_99_9_99_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_48&#39;)"><span class="hl_fundecl"><span class="mpre">removeExistingCookieFromCookieJarHelper</span></span></a><span class="mpre"> </span><a name="loc_100_49_100_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_49_100_50&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a name="loc_100_52_100_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_52_100_54&#39;)"><span class="hl_vardecl"><span class="mpre">c&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_100_57_100_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_57_100_59&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)
          | </span><a href="#loc_100_49_100_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_49_100_50&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_100_52_100_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_52_100_54&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre"> = (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_100_52_100_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_52_100_54&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre">, </span><a href="#loc_100_57_100_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_57_100_59&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = (</span><a href="#loc_103_18_103_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_18_103_25&#39;)"><span class="hl_varref"><span class="mpre">cookie&#39;</span></span></a><span class="mpre">, </span><a href="#loc_100_52_100_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_52_100_54&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_103_27_103_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_27_103_39&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;&#39;</span></span></a><span class="mpre">)
          where (</span><a name="loc_103_18_103_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_18_103_25&#39;)"><span class="hl_vardecl"><span class="mpre">cookie&#39;</span></span></a><span class="mpre">, </span><a name="loc_103_27_103_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_27_103_39&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar&#39;&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_99_9_99_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_9_99_48&#39;)"><span class="hl_varref"><span class="mpre">removeExistingCookieFromCookieJarHelper</span></span></a><span class="mpre"> </span><a href="#loc_100_49_100_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_49_100_50&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_100_57_100_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_57_100_59&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Are we configured to reject cookies for domains such as \&quot;com\&quot;?</span></span><span class="mpre">
</span><a href="#loc_107_1_107_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_21&#39;)"><span class="mpre">rejectPublicSuffixes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_107_1_107_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_21&#39;)"><span class="hl_vardecl"><span class="mpre">rejectPublicSuffixes</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

</span><a href="#loc_110_1_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_15&#39;)"><span class="mpre">isPublicSuffix</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_110_1_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_15&#39;)"><span class="hl_vardecl"><span class="mpre">isPublicSuffix</span></span></a><span class="mpre"> = </span><a href="Network.PublicSuffixList.Lookup.html#loc_86_1_86_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.PublicSuffixList.Lookup.html#loc_86_1_86_9&#39;)"><span class="hl_varref"><span class="mpre">PSL.isSuffix</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.Encoding.html#loc_142_1_142_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_142_1_142_15&#39;)"><span class="hl_varref"><span class="mpre">decodeUtf8With</span></span></a><span class="mpre"> </span><a href="Data.Text.Encoding.Error.html#loc_107_1_107_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.Error.html#loc_107_1_107_14&#39;)"><span class="hl_varref"><span class="mpre">lenientDecode</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This corresponds to the eviction algorithm described in Section 5.3 \&quot;Storage Model\&quot;</span></span><span class="mpre">
</span><a href="#loc_116_1_116_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_20&#39;)"><span class="mpre">evictExpiredCookies</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Input cookie jar</span></span><span class="mpre">
                    -&gt; </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Value that should be used as \&quot;now\&quot;</span></span><span class="mpre">
                    -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Filtered cookie jar</span></span><span class="mpre">
</span><a name="loc_116_1_116_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_20&#39;)"><span class="hl_fundecl"><span class="mpre">evictExpiredCookies</span></span></a><span class="mpre"> </span><a name="loc_116_21_116_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_21_116_32&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre"> </span><a name="loc_116_33_116_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_33_116_36&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">CJ</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (\ </span><a name="loc_116_54_116_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_54_116_60&#39;)"><span class="hl_vardecl"><span class="mpre">cookie</span></span></a><span class="mpre"> -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_118_5_118_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_118_5_118_23&#39;)"><span class="hl_varref"><span class="mpre">cookie_expiry_time</span></span></a><span class="mpre"> </span><a href="#loc_116_54_116_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_54_116_60&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_116_33_116_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_33_116_36&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_130_26_130_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_26_130_32&#39;)"><span class="hl_varref"><span class="mpre">expose</span></span></a><span class="mpre"> </span><a href="#loc_116_21_116_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_21_116_32&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This applies the &#39;computeCookieString&#39; to a given Request</span></span><span class="mpre">
</span><a href="#loc_123_1_123_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_25&#39;)"><span class="mpre">insertCookiesIntoRequest</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">Req.Request</span></span></a><span class="mpre">                 </span><span class="hl_comment"><span class="mpre">-- ^ The request to insert into</span></span><span class="mpre">
                         -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre">                   </span><span class="hl_comment"><span class="mpre">-- ^ Current cookie jar</span></span><span class="mpre">
                         -&gt; </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">                     </span><span class="hl_comment"><span class="mpre">-- ^ Value that should be used as \&quot;now\&quot;</span></span><span class="mpre">
                         -&gt; (</span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">Req.Request</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre">)    </span><span class="hl_comment"><span class="mpre">-- ^ (Ouptut request, Updated cookie jar (last-access-time is updated))</span></span><span class="mpre">
</span><a name="loc_123_1_123_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_25&#39;)"><span class="hl_fundecl"><span class="mpre">insertCookiesIntoRequest</span></span></a><span class="mpre"> </span><a name="loc_123_26_123_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_26_123_33&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> </span><a name="loc_123_34_123_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_34_123_44&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a name="loc_123_45_123_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_45_123_48&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">BS.null</span></span><span class="mpre"> </span><a href="#loc_127_10_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_10_127_23&#39;)"><span class="hl_varref"><span class="mpre">cookie_string</span></span></a><span class="mpre"> = (</span><a href="#loc_123_26_123_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_26_123_33&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre">, </span><a href="#loc_127_25_127_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_25_127_36&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">)
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = (</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 125, srcSpanStartColumn = 18, srcSpanEndLine = 125, srcSpanEndColumn = 78}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 125, srcSpanStartColumn = 26, srcSpanEndLine = 125, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Netw"><span class="mpre">request {Req.requestHeaders = cookie_header : purgedHeaders}</span></span><span class="mpre">, </span><a href="#loc_127_25_127_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_25_127_36&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">)
  where </span><span class="hl_vardecl"><span class="mpre">purgedHeaders</span></span><span class="mpre"> = </span><a href="Data.List.html#loc_365_1_365_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_365_1_365_9&#39;)"><span class="hl_varref"><span class="mpre">L.deleteBy</span></span></a><span class="mpre"> (\ (</span><a name="loc_126_40_126_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_40_126_41&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, _) (</span><a name="loc_126_47_126_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_47_126_48&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">, _) -&gt; </span><a href="#loc_126_40_126_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_40_126_41&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_126_47_126_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_47_126_48&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) (</span><a href="Data.CaseInsensitive.Internal.html#loc_94_1_94_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_94_1_94_3&#39;)"><span class="hl_varref"><span class="mpre">CI.mk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Cookie&quot;</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">BS.empty</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_306_7_306_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_306_7_306_21&#39;)"><span class="hl_varref"><span class="mpre">Req.requestHeaders</span></span></a><span class="mpre"> </span><a href="#loc_123_26_123_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_26_123_33&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre">
        (</span><a name="loc_127_10_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_10_127_23&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_string</span></span></a><span class="mpre">, </span><a name="loc_127_25_127_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_25_127_36&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_136_1_136_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_20&#39;)"><span class="hl_varref"><span class="mpre">computeCookieString</span></span></a><span class="mpre"> </span><a href="#loc_123_26_123_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_26_123_33&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><a href="#loc_123_34_123_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_34_123_44&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_123_45_123_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_45_123_48&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        </span><span class="hl_vardecl"><span class="mpre">cookie_header</span></span><span class="mpre"> = (</span><a href="Data.CaseInsensitive.Internal.html#loc_94_1_94_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_94_1_94_3&#39;)"><span class="hl_varref"><span class="mpre">CI.mk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Cookie&quot;</span></span><span class="mpre">, </span><a href="#loc_127_10_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_10_127_23&#39;)"><span class="hl_varref"><span class="mpre">cookie_string</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | This corresponds to the algorithm described in Section 5.4 \&quot;The Cookie Header\&quot;</span></span><span class="mpre">
</span><a href="#loc_136_1_136_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_20&#39;)"><span class="mpre">computeCookieString</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">Req.Request</span></span></a><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ Input request</span></span><span class="mpre">
                    -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre">             </span><span class="hl_comment"><span class="mpre">-- ^ Current cookie jar</span></span><span class="mpre">
                    -&gt; </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">               </span><span class="hl_comment"><span class="mpre">-- ^ Value that should be used as \&quot;now\&quot;</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">                  </span><span class="hl_comment"><span class="mpre">-- ^ Whether or not this request is coming from an \&quot;http\&quot; source (not javascript or anything like that)</span></span><span class="mpre">
                    -&gt; (</span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre">)  </span><span class="hl_comment"><span class="mpre">-- ^ (Contents of a \&quot;Cookie\&quot; header, Updated cookie jar (last-access-time is updated))</span></span><span class="mpre">
</span><a name="loc_136_1_136_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_20&#39;)"><span class="hl_fundecl"><span class="mpre">computeCookieString</span></span></a><span class="mpre"> </span><a name="loc_136_21_136_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_21_136_28&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> </span><a name="loc_136_29_136_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_29_136_39&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">now</span></span><span class="mpre"> </span><a name="loc_136_44_136_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_44_136_55&#39;)"><span class="hl_vardecl"><span class="mpre">is_http_api</span></span></a><span class="mpre"> = (</span><a href="#loc_150_9_150_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_20&#39;)"><span class="hl_varref"><span class="mpre">output_line</span></span></a><span class="mpre">, </span><a href="#loc_154_9_154_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_20&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">)
  where </span><a name="loc_137_9_137_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_24&#39;)"><span class="hl_fundecl"><span class="mpre">matching_cookie</span></span></a><span class="mpre"> </span><a name="loc_137_25_137_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_25_137_31&#39;)"><span class="hl_vardecl"><span class="mpre">cookie</span></span></a><span class="mpre"> = </span><a href="#loc_138_17_138_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_17_138_27&#39;)"><span class="hl_varref"><span class="mpre">condition1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_141_17_141_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_17_141_27&#39;)"><span class="hl_varref"><span class="mpre">condition2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_142_17_142_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_17_142_27&#39;)"><span class="hl_varref"><span class="mpre">condition3</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_145_17_145_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_17_145_27&#39;)"><span class="hl_varref"><span class="mpre">condition4</span></span></a><span class="mpre">
          where </span><a name="loc_138_17_138_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_17_138_27&#39;)"><span class="hl_vardecl"><span class="mpre">condition1</span></span></a><span class="mpre">
                  | </span><a href="Network.HTTP.Client.Types.html#loc_124_5_124_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_124_5_124_21&#39;)"><span class="hl_varref"><span class="mpre">cookie_host_only</span></span></a><span class="mpre"> </span><a href="#loc_137_25_137_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_25_137_31&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Types.html#loc_289_7_289_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_289_7_289_11&#39;)"><span class="hl_varref"><span class="mpre">Req.host</span></span></a><span class="mpre"> </span><a href="#loc_136_21_136_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_21_136_28&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_119_5_119_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_119_5_119_18&#39;)"><span class="hl_varref"><span class="mpre">cookie_domain</span></span></a><span class="mpre"> </span><a href="#loc_137_25_137_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_25_137_31&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_56_1_56_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_14&#39;)"><span class="hl_varref"><span class="mpre">domainMatches</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_289_7_289_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_289_7_289_11&#39;)"><span class="hl_varref"><span class="mpre">Req.host</span></span></a><span class="mpre"> </span><a href="#loc_136_21_136_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_21_136_28&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre">) (</span><a href="Network.HTTP.Client.Types.html#loc_119_5_119_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_119_5_119_18&#39;)"><span class="hl_varref"><span class="mpre">cookie_domain</span></span></a><span class="mpre"> </span><a href="#loc_137_25_137_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_25_137_31&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre">)
                </span><a name="loc_141_17_141_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_17_141_27&#39;)"><span class="hl_vardecl"><span class="mpre">condition2</span></span></a><span class="mpre"> = </span><a href="#loc_76_1_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_12&#39;)"><span class="hl_varref"><span class="mpre">pathMatches</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_298_7_298_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_298_7_298_11&#39;)"><span class="hl_varref"><span class="mpre">Req.path</span></span></a><span class="mpre"> </span><a href="#loc_136_21_136_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_21_136_28&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre">) (</span><a href="Network.HTTP.Client.Types.html#loc_120_5_120_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_120_5_120_16&#39;)"><span class="hl_varref"><span class="mpre">cookie_path</span></span></a><span class="mpre"> </span><a href="#loc_137_25_137_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_25_137_31&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre">)
                </span><a name="loc_142_17_142_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_17_142_27&#39;)"><span class="hl_vardecl"><span class="mpre">condition3</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_125_5_125_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_125_5_125_23&#39;)"><span class="hl_varref"><span class="mpre">cookie_secure_only</span></span></a><span class="mpre"> </span><a href="#loc_137_25_137_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_25_137_31&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="Network.HTTP.Client.Types.html#loc_285_7_285_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_285_7_285_13&#39;)"><span class="hl_varref"><span class="mpre">Req.secure</span></span></a><span class="mpre"> </span><a href="#loc_136_21_136_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_21_136_28&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre">
                </span><a name="loc_145_17_145_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_17_145_27&#39;)"><span class="hl_vardecl"><span class="mpre">condition4</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_126_5_126_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_126_5_126_21&#39;)"><span class="hl_varref"><span class="mpre">cookie_http_only</span></span></a><span class="mpre"> </span><a href="#loc_137_25_137_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_25_137_31&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_136_44_136_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_44_136_55&#39;)"><span class="hl_varref"><span class="mpre">is_http_api</span></span></a><span class="mpre">
        </span><a name="loc_148_9_148_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_25&#39;)"><span class="hl_vardecl"><span class="mpre">matching_cookies</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> </span><a href="#loc_137_9_137_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_24&#39;)"><span class="hl_varref"><span class="mpre">matching_cookie</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_130_26_130_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_26_130_32&#39;)"><span class="hl_varref"><span class="mpre">expose</span></span></a><span class="mpre"> </span><a href="#loc_136_29_136_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_29_136_39&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre">
        </span><a name="loc_149_9_149_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_9_149_23&#39;)"><span class="hl_vardecl"><span class="mpre">output_cookies</span></span></a><span class="mpre"> =  </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\ </span><a name="loc_149_34_149_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_34_149_35&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; (</span><a href="Network.HTTP.Client.Types.html#loc_116_5_116_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_116_5_116_16&#39;)"><span class="hl_varref"><span class="mpre">cookie_name</span></span></a><span class="mpre"> </span><a href="#loc_149_34_149_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_34_149_35&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_117_5_117_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_117_5_117_17&#39;)"><span class="hl_varref"><span class="mpre">cookie_value</span></span></a><span class="mpre"> </span><a href="#loc_149_34_149_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_34_149_35&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.List.html#loc_809_1_809_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_809_1_809_5&#39;)"><span class="hl_varref"><span class="mpre">L.sort</span></span></a><span class="mpre"> </span><a href="#loc_148_9_148_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_25&#39;)"><span class="hl_varref"><span class="mpre">matching_cookies</span></span></a><span class="mpre">
        </span><a name="loc_150_9_150_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_20&#39;)"><span class="hl_vardecl"><span class="mpre">output_line</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.html#loc_299_1_299_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_299_1_299_13&#39;)"><span class="hl_varref"><span class="mpre">toByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Web.Cookie.html#loc_87_1_87_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Web.Cookie.html#loc_87_1_87_14&#39;)"><span class="hl_varref"><span class="mpre">renderCookies</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_149_9_149_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_9_149_23&#39;)"><span class="hl_varref"><span class="mpre">output_cookies</span></span></a><span class="mpre">
        </span><a name="loc_151_9_151_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_9_151_25&#39;)"><span class="hl_fundecl"><span class="mpre">folding_function</span></span></a><span class="mpre"> </span><a name="loc_151_26_151_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_26_151_38&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar&#39;&#39;</span></span></a><span class="mpre"> </span><a name="loc_151_39_151_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_39_151_45&#39;)"><span class="hl_vardecl"><span class="mpre">cookie</span></span></a><span class="mpre"> = case </span><a href="#loc_97_1_97_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_34&#39;)"><span class="hl_varref"><span class="mpre">removeExistingCookieFromCookieJar</span></span></a><span class="mpre"> </span><a href="#loc_151_39_151_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_39_151_45&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre"> </span><a href="#loc_151_26_151_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_26_151_38&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;&#39;</span></span></a><span class="mpre"> of
          (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">c</span></span><span class="mpre">, </span><a name="loc_152_20_152_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_20_152_33&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar&#39;&#39;&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_93_1_93_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_20&#39;)"><span class="hl_varref"><span class="mpre">insertIntoCookieJar</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 152, srcSpanStartColumn = 59, srcSpanEndLine = 152, srcSpanEndColumn = 92}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 152, srcSpanStartColumn = 61, srcSpanEndLine = 152, srcSpanEndColumn = 62},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Netw"><span class="mpre">c {cookie_last_access_time = now}</span></span><span class="mpre">) </span><a href="#loc_152_20_152_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_20_152_33&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;&#39;&#39;</span></span></a><span class="mpre">
          (</span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">, </span><a name="loc_153_21_153_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_21_153_34&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar&#39;&#39;&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_153_21_153_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_21_153_34&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;&#39;&#39;</span></span></a><span class="mpre">
        </span><a name="loc_154_9_154_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_20&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> </span><a href="#loc_151_9_151_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_9_151_25&#39;)"><span class="hl_varref"><span class="mpre">folding_function</span></span></a><span class="mpre"> </span><a href="#loc_136_29_136_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_29_136_39&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_148_9_148_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_9_148_25&#39;)"><span class="hl_varref"><span class="mpre">matching_cookies</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This applies &#39;receiveSetCookie&#39; to a given Response</span></span><span class="mpre">
</span><a href="#loc_162_1_162_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_16&#39;)"><span class="mpre">updateCookieJar</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_404_6_404_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_404_6_404_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">                   </span><span class="hl_comment"><span class="mpre">-- ^ Response received from server</span></span><span class="mpre">
                -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre">                      </span><span class="hl_comment"><span class="mpre">-- ^ Request which generated the response</span></span><span class="mpre">
                -&gt; </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">                      </span><span class="hl_comment"><span class="mpre">-- ^ Value that should be used as \&quot;now\&quot;</span></span><span class="mpre">
                -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre">                    </span><span class="hl_comment"><span class="mpre">-- ^ Current cookie jar</span></span><span class="mpre">
                -&gt; (</span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_404_6_404_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_404_6_404_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)      </span><span class="hl_comment"><span class="mpre">-- ^ (Updated cookie jar with cookies from the Response, The response stripped of any \&quot;Set-Cookie\&quot; header)</span></span><span class="mpre">
</span><a name="loc_162_1_162_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_16&#39;)"><span class="hl_fundecl"><span class="mpre">updateCookieJar</span></span></a><span class="mpre"> </span><a name="loc_162_17_162_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_17_162_25&#39;)"><span class="hl_vardecl"><span class="mpre">response</span></span></a><span class="mpre"> </span><a name="loc_162_26_162_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_26_162_33&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> </span><a name="loc_162_34_162_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_34_162_37&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> </span><a name="loc_162_38_162_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_38_162_48&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> = (</span><a href="#loc_166_9_166_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_20&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">, </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 65, srcSpanEndLine = 162, srcSpanEndColumn = 109}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 74, srcSpanEndLine = 162, srcSpanEndColumn = 75},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Net"><span class="mpre">response { responseHeaders = other_headers }</span></span><span class="mpre">)
  where (</span><a name="loc_163_10_163_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_10_163_28&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie_headers</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">other_headers</span></span><span class="mpre">) = </span><a href="Data.List.html#loc_464_1_464_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_464_1_464_10&#39;)"><span class="hl_varref"><span class="mpre">L.partition</span></span></a><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> (</span><a href="Data.CaseInsensitive.Internal.html#loc_94_1_94_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_94_1_94_3&#39;)"><span class="hl_varref"><span class="mpre">CI.mk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Set-Cookie&quot;</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_413_7_413_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_413_7_413_22&#39;)"><span class="hl_varref"><span class="mpre">responseHeaders</span></span></a><span class="mpre"> </span><a href="#loc_162_17_162_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_17_162_25&#39;)"><span class="hl_varref"><span class="mpre">response</span></span></a><span class="mpre">
        </span><a name="loc_164_9_164_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_9_164_24&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie_data</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_163_10_163_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_10_163_28&#39;)"><span class="hl_varref"><span class="mpre">set_cookie_headers</span></span></a><span class="mpre">
        </span><a name="loc_165_9_165_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_9_165_20&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookies</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Web.Cookie.html#loc_166_1_166_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Web.Cookie.html#loc_166_1_166_15&#39;)"><span class="hl_varref"><span class="mpre">parseSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_164_9_164_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_9_164_24&#39;)"><span class="hl_varref"><span class="mpre">set_cookie_data</span></span></a><span class="mpre">
        </span><a name="loc_166_9_166_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_20&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> (\ </span><a name="loc_166_32_166_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_32_166_34&#39;)"><span class="hl_vardecl"><span class="mpre">cj</span></span></a><span class="mpre"> </span><a name="loc_166_35_166_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_35_166_37&#39;)"><span class="hl_vardecl"><span class="mpre">sc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_17&#39;)"><span class="hl_varref"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a href="#loc_166_35_166_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_35_166_37&#39;)"><span class="hl_varref"><span class="mpre">sc</span></span></a><span class="mpre"> </span><a href="#loc_162_26_162_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_26_162_33&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><a href="#loc_162_34_162_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_34_162_37&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_166_32_166_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_32_166_34&#39;)"><span class="hl_varref"><span class="mpre">cj</span></span></a><span class="mpre">) </span><a href="#loc_162_38_162_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_38_162_48&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_165_9_165_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_9_165_20&#39;)"><span class="hl_varref"><span class="mpre">set_cookies</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This corresponds to the algorithm described in Section 5.3 \&quot;Storage Model\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function consists of calling &#39;generateCookie&#39; followed by &#39;insertCheckedCookie&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Use this function if you plan to do both in a row.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;generateCookie&#39; and &#39;insertCheckedCookie&#39; are only provided for more fine-grained control.</span></span><span class="mpre">
</span><a href="#loc_178_1_178_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_17&#39;)"><span class="mpre">receiveSetCookie</span></a><span class="mpre"> :: </span><a href="Web.Cookie.html#loc_97_6_97_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Web.Cookie.html#loc_97_6_97_15&#39;)"><span class="hl_tyconref"><span class="mpre">SetCookie</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ The &#39;SetCookie&#39; the cookie jar is receiving</span></span><span class="mpre">
                 -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">Req.Request</span></span></a><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ The request that originated the response that yielded the &#39;SetCookie&#39;</span></span><span class="mpre">
                 -&gt; </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- ^ Value that should be used as \&quot;now\&quot;</span></span><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ Whether or not this request is coming from an \&quot;http\&quot; source (not javascript or anything like that)</span></span><span class="mpre">
                 -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ Input cookie jar to modify</span></span><span class="mpre">
                 -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ Updated cookie jar</span></span><span class="mpre">
</span><a name="loc_178_1_178_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_17&#39;)"><span class="hl_fundecl"><span class="mpre">receiveSetCookie</span></span></a><span class="mpre"> </span><a name="loc_178_18_178_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_18_178_28&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a name="loc_178_29_178_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_29_178_36&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> </span><a name="loc_178_37_178_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_37_178_40&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> </span><a name="loc_178_41_178_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_41_178_52&#39;)"><span class="hl_vardecl"><span class="mpre">is_http_api</span></span></a><span class="mpre"> </span><a name="loc_178_53_178_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_53_178_63&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> = case (do
  </span><a name="loc_179_3_179_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_9&#39;)"><span class="hl_vardecl"><span class="mpre">cookie</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_206_1_206_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_15&#39;)"><span class="hl_varref"><span class="mpre">generateCookie</span></span></a><span class="mpre"> </span><a href="#loc_178_18_178_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_18_178_28&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a href="#loc_178_29_178_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_29_178_36&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><a href="#loc_178_37_178_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_37_178_40&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><a href="#loc_178_41_178_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_41_178_52&#39;)"><span class="hl_varref"><span class="mpre">is_http_api</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_189_1_189_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_20&#39;)"><span class="hl_varref"><span class="mpre">insertCheckedCookie</span></span></a><span class="mpre"> </span><a href="#loc_179_3_179_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_9&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre"> </span><a href="#loc_178_53_178_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_53_178_63&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a href="#loc_178_41_178_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_41_178_52&#39;)"><span class="hl_varref"><span class="mpre">is_http_api</span></span></a><span class="mpre">) of
  </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_181_8_181_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_8_181_10&#39;)"><span class="hl_vardecl"><span class="mpre">cj</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_181_8_181_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_8_181_10&#39;)"><span class="hl_varref"><span class="mpre">cj</span></span></a><span class="mpre">
  </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_178_53_178_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_53_178_63&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Insert a cookie created by generateCookie into the cookie jar (or not if it shouldn&#39;t be allowed in)</span></span><span class="mpre">
</span><a href="#loc_189_1_189_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_20&#39;)"><span class="mpre">insertCheckedCookie</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_115_6_115_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_115_6_115_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ The &#39;SetCookie&#39; the cookie jar is receiving</span></span><span class="mpre">
                    -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Input cookie jar to modify</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ Whether or not this request is coming from an \&quot;http\&quot; source (not javascript or anything like that)</span></span><span class="mpre">
                    -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_130_9_130_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_130_9_130_18&#39;)"><span class="hl_tyconref"><span class="mpre">CookieJar</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Updated (or not) cookie jar</span></span><span class="mpre">
</span><a name="loc_189_1_189_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_20&#39;)"><span class="hl_fundecl"><span class="mpre">insertCheckedCookie</span></span></a><span class="mpre"> </span><a name="loc_189_21_189_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_21_189_22&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_189_23_189_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_23_189_33&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar</span></span></a><span class="mpre"> </span><a name="loc_189_34_189_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_34_189_45&#39;)"><span class="hl_vardecl"><span class="mpre">is_http_api</span></span></a><span class="mpre"> = case (do
  (</span><a name="loc_190_4_190_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_4_190_15&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">, </span><a name="loc_190_17_190_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_17_190_24&#39;)"><span class="hl_vardecl"><span class="mpre">cookie&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_194_9_194_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_22&#39;)"><span class="hl_varref"><span class="mpre">existanceTest</span></span></a><span class="mpre"> </span><a href="#loc_189_21_189_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_21_189_22&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_189_23_189_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_23_189_33&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_93_1_93_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_20&#39;)"><span class="hl_varref"><span class="mpre">insertIntoCookieJar</span></span></a><span class="mpre"> </span><a href="#loc_190_17_190_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_17_190_24&#39;)"><span class="hl_varref"><span class="mpre">cookie&#39;</span></span></a><span class="mpre"> </span><a href="#loc_190_4_190_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_4_190_15&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">) of
  </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_192_8_192_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_8_192_10&#39;)"><span class="hl_vardecl"><span class="mpre">cj</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_192_8_192_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_8_192_10&#39;)"><span class="hl_varref"><span class="mpre">cj</span></span></a><span class="mpre">
  </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_189_23_189_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_23_189_33&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar</span></span></a><span class="mpre">
  where </span><a name="loc_194_9_194_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_22&#39;)"><span class="hl_fundecl"><span class="mpre">existanceTest</span></span></a><span class="mpre"> </span><a name="loc_194_23_194_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_23_194_29&#39;)"><span class="hl_vardecl"><span class="mpre">cookie</span></span></a><span class="mpre"> </span><a name="loc_194_30_194_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_30_194_41&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_195_9_195_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_28&#39;)"><span class="hl_varref"><span class="mpre">existanceTestHelper</span></span></a><span class="mpre"> </span><a href="#loc_194_23_194_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_23_194_29&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_97_1_97_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_34&#39;)"><span class="hl_varref"><span class="mpre">removeExistingCookieFromCookieJar</span></span></a><span class="mpre"> </span><a href="#loc_194_23_194_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_23_194_29&#39;)"><span class="hl_varref"><span class="mpre">cookie</span></span></a><span class="mpre"> </span><a href="#loc_194_30_194_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_30_194_41&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">
        </span><a name="loc_195_9_195_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_28&#39;)"><span class="hl_fundecl"><span class="mpre">existanceTestHelper</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">new_cookie</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_195_46_195_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_46_195_56&#39;)"><span class="hl_vardecl"><span class="mpre">old_cookie</span></span></a><span class="mpre">, </span><a name="loc_195_58_195_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_58_195_69&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><a href="#loc_189_34_189_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_34_189_45&#39;)"><span class="hl_varref"><span class="mpre">is_http_api</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_126_5_126_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_126_5_126_21&#39;)"><span class="hl_varref"><span class="mpre">cookie_http_only</span></span></a><span class="mpre"> </span><a href="#loc_195_46_195_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_46_195_56&#39;)"><span class="hl_varref"><span class="mpre">old_cookie</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_195_58_195_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_58_195_69&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">, </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 197, srcSpanStartColumn = 46, srcSpanEndLine = 197, srcSpanEndColumn = 113}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 197, srcSpanStartColumn = 57, srcSpanEndLine = 197, srcSpanEndColumn = 58},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Net"><span class="mpre">new_cookie {cookie_creation_time = cookie_creation_time old_cookie}</span></span><span class="mpre">)
        </span><a href="#loc_195_9_195_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_28&#39;)"><span class="hl_fundecl"><span class="mpre">existanceTestHelper</span></span></a><span class="mpre"> </span><a name="loc_198_29_198_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_29_198_39&#39;)"><span class="hl_vardecl"><span class="mpre">new_cookie</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">, </span><a name="loc_198_50_198_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_50_198_61&#39;)"><span class="hl_vardecl"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_198_50_198_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_50_198_61&#39;)"><span class="hl_varref"><span class="mpre">cookie_jar&#39;</span></span></a><span class="mpre">, </span><a href="#loc_198_29_198_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_29_198_39&#39;)"><span class="hl_varref"><span class="mpre">new_cookie</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Turn a SetCookie into a Cookie, if it is valid</span></span><span class="mpre">
</span><a href="#loc_206_1_206_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_15&#39;)"><span class="mpre">generateCookie</span></a><span class="mpre"> :: </span><a href="Web.Cookie.html#loc_97_6_97_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Web.Cookie.html#loc_97_6_97_15&#39;)"><span class="hl_tyconref"><span class="mpre">SetCookie</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ The &#39;SetCookie&#39; we are encountering</span></span><span class="mpre">
               -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">Req.Request</span></span></a><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ The request that originated the response that yielded the &#39;SetCookie&#39;</span></span><span class="mpre">
               -&gt; </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- ^ Value that should be used as \&quot;now\&quot;</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ Whether or not this request is coming from an \&quot;http\&quot; source (not javascript or anything like that)</span></span><span class="mpre">
               -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_115_6_115_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_115_6_115_12&#39;)"><span class="hl_tyconref"><span class="mpre">Cookie</span></span></a><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ The optional output cookie</span></span><span class="mpre">
</span><a name="loc_206_1_206_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_15&#39;)"><span class="hl_fundecl"><span class="mpre">generateCookie</span></span></a><span class="mpre"> </span><a name="loc_206_16_206_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_16_206_26&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie</span></span></a><span class="mpre"> </span><a name="loc_206_27_206_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_27_206_34&#39;)"><span class="hl_vardecl"><span class="mpre">request</span></span></a><span class="mpre"> </span><a name="loc_206_35_206_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_35_206_38&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> </span><a name="loc_206_39_206_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_39_206_50&#39;)"><span class="hl_vardecl"><span class="mpre">is_http_api</span></span></a><span class="mpre"> = do
          </span><a name="loc_207_11_207_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_11_207_27&#39;)"><span class="hl_vardecl"><span class="mpre">domain_sanitized</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_223_9_223_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_9_223_23&#39;)"><span class="hl_varref"><span class="mpre">sanitizeDomain</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_228_9_228_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_9_228_14&#39;)"><span class="hl_varref"><span class="mpre">step4</span></span></a><span class="mpre"> (</span><a href="Web.Cookie.html#loc_103_7_103_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Web.Cookie.html#loc_103_7_103_22&#39;)"><span class="hl_varref"><span class="mpre">setCookieDomain</span></span></a><span class="mpre"> </span><a href="#loc_206_16_206_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_16_206_26&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre">)
          </span><a name="loc_208_11_208_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_11_208_30&#39;)"><span class="hl_vardecl"><span class="mpre">domain_intermediate</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_230_9_230_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_9_230_14&#39;)"><span class="hl_varref"><span class="mpre">step5</span></span></a><span class="mpre"> </span><a href="#loc_207_11_207_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_11_207_27&#39;)"><span class="hl_varref"><span class="mpre">domain_sanitized</span></span></a><span class="mpre">
          (</span><span class="hl_vardecl"><span class="mpre">domain_final</span></span><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">host_only&#39;</span></span><span class="mpre">) &lt;- </span><a href="#loc_236_9_236_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_9_236_14&#39;)"><span class="hl_varref"><span class="mpre">step6</span></span></a><span class="mpre"> </span><a href="#loc_208_11_208_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_11_208_30&#39;)"><span class="hl_varref"><span class="mpre">domain_intermediate</span></span></a><span class="mpre">
          </span><span class="hl_vardecl"><span class="mpre">http_only&#39;</span></span><span class="mpre"> &lt;- </span><a href="#loc_241_9_241_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_9_241_15&#39;)"><span class="hl_varref"><span class="mpre">step10</span></span></a><span class="mpre">
          </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 211, srcSpanStartColumn = 20, srcSpanEndLine = 222, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Cookies.hs&quot;, srcSpanStartLine = 211, srcSpanStartColumn = 27, srcSpanEndLine = 211, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Netw"><span class="mpre">Cookie { cookie_name = setCookieName set_cookie
                          , cookie_value = setCookieValue set_cookie
                          , cookie_expiry_time = getExpiryTime (setCookieExpires set_cookie) (setCookieMaxAge set_cookie)
                          , cookie_domain = domain_final
                          , cookie_path = getPath $ setCookiePath set_cookie
                          , cookie_creation_time = now
                          , cookie_last_access_time = now
                          , cookie_persistent = getPersistent
                          , cookie_host_only = host_only&#39;
                          , cookie_secure_only = setCookieSecure set_cookie
                          , cookie_http_only = http_only&#39;
                          }</span></span><span class="mpre">
  where </span><a name="loc_223_9_223_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_9_223_23&#39;)"><span class="hl_fundecl"><span class="mpre">sanitizeDomain</span></span></a><span class="mpre"> </span><a name="loc_223_24_223_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_24_223_31&#39;)"><span class="hl_vardecl"><span class="mpre">domain&#39;</span></span></a><span class="mpre">
          | </span><a href="#loc_227_17_227_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_17_227_32&#39;)"><span class="hl_varref"><span class="mpre">has_a_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.singleton</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BS.last</span></span><span class="mpre"> </span><a href="#loc_223_24_223_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_24_223_31&#39;)"><span class="hl_varref"><span class="mpre">domain&#39;</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
          | </span><a href="#loc_227_17_227_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_17_227_32&#39;)"><span class="hl_varref"><span class="mpre">has_a_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.singleton</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BS.head</span></span><span class="mpre"> </span><a href="#loc_223_24_223_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_24_223_31&#39;)"><span class="hl_varref"><span class="mpre">domain&#39;</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.tail</span></span><span class="mpre"> </span><a href="#loc_223_24_223_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_24_223_31&#39;)"><span class="hl_varref"><span class="mpre">domain&#39;</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_223_24_223_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_24_223_31&#39;)"><span class="hl_varref"><span class="mpre">domain&#39;</span></span></a><span class="mpre">
          where </span><a name="loc_227_17_227_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_17_227_32&#39;)"><span class="hl_vardecl"><span class="mpre">has_a_character</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BS.null</span></span><span class="mpre"> </span><a href="#loc_223_24_223_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_24_223_31&#39;)"><span class="hl_varref"><span class="mpre">domain&#39;</span></span></a><span class="mpre">)
        </span><a name="loc_228_9_228_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_9_228_14&#39;)"><span class="hl_fundecl"><span class="mpre">step4</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_228_21_228_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_21_228_38&#39;)"><span class="hl_vardecl"><span class="mpre">set_cookie_domain</span></span></a><span class="mpre">) = </span><a href="#loc_228_21_228_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_21_228_38&#39;)"><span class="hl_varref"><span class="mpre">set_cookie_domain</span></span></a><span class="mpre">
        </span><a href="#loc_228_9_228_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_9_228_14&#39;)"><span class="hl_fundecl"><span class="mpre">step4</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">BS.empty</span></span><span class="mpre">
        </span><a name="loc_230_9_230_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_9_230_14&#39;)"><span class="hl_fundecl"><span class="mpre">step5</span></span></a><span class="mpre"> </span><a name="loc_230_15_230_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_15_230_22&#39;)"><span class="hl_vardecl"><span class="mpre">domain&#39;</span></span></a><span class="mpre">
          | </span><a href="#loc_234_17_234_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_17_234_31&#39;)"><span class="hl_varref"><span class="mpre">firstCondition</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_230_15_230_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_15_230_22&#39;)"><span class="hl_varref"><span class="mpre">domain&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_289_7_289_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_289_7_289_11&#39;)"><span class="hl_varref"><span class="mpre">Req.host</span></span></a><span class="mpre"> </span><a href="#loc_206_27_206_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_27_206_34&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.empty</span></span><span class="mpre">
          | </span><a href="#loc_234_17_234_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_17_234_31&#39;)"><span class="hl_varref"><span class="mpre">firstCondition</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_230_15_230_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_15_230_22&#39;)"><span class="hl_varref"><span class="mpre">domain&#39;</span></span></a><span class="mpre">
          where </span><a name="loc_234_17_234_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_17_234_31&#39;)"><span class="hl_vardecl"><span class="mpre">firstCondition</span></span></a><span class="mpre"> = </span><a href="#loc_107_1_107_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_21&#39;)"><span class="hl_varref"><span class="mpre">rejectPublicSuffixes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_235_17_235_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_17_235_32&#39;)"><span class="hl_varref"><span class="mpre">has_a_character</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_110_1_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_15&#39;)"><span class="hl_varref"><span class="mpre">isPublicSuffix</span></span></a><span class="mpre"> </span><a href="#loc_230_15_230_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_15_230_22&#39;)"><span class="hl_varref"><span class="mpre">domain&#39;</span></span></a><span class="mpre">
                </span><a name="loc_235_17_235_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_17_235_32&#39;)"><span class="hl_vardecl"><span class="mpre">has_a_character</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BS.null</span></span><span class="mpre"> </span><a href="#loc_230_15_230_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_15_230_22&#39;)"><span class="hl_varref"><span class="mpre">domain&#39;</span></span></a><span class="mpre">)
        </span><a name="loc_236_9_236_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_9_236_14&#39;)"><span class="hl_fundecl"><span class="mpre">step6</span></span></a><span class="mpre"> </span><a name="loc_236_15_236_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_15_236_22&#39;)"><span class="hl_vardecl"><span class="mpre">domain&#39;</span></span></a><span class="mpre">
          | </span><a href="#loc_240_17_240_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_17_240_31&#39;)"><span class="hl_varref"><span class="mpre">firstCondition</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_56_1_56_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_14&#39;)"><span class="hl_varref"><span class="mpre">domainMatches</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_289_7_289_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_289_7_289_11&#39;)"><span class="hl_varref"><span class="mpre">Req.host</span></span></a><span class="mpre"> </span><a href="#loc_206_27_206_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_27_206_34&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre">) </span><a href="#loc_236_15_236_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_15_236_22&#39;)"><span class="hl_varref"><span class="mpre">domain&#39;</span></span></a><span class="mpre">) = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
          | </span><a href="#loc_240_17_240_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_17_240_31&#39;)"><span class="hl_varref"><span class="mpre">firstCondition</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_236_15_236_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_15_236_22&#39;)"><span class="hl_varref"><span class="mpre">domain&#39;</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_289_7_289_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_289_7_289_11&#39;)"><span class="hl_varref"><span class="mpre">Req.host</span></span></a><span class="mpre"> </span><a href="#loc_206_27_206_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_27_206_34&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)
          where </span><a name="loc_240_17_240_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_17_240_31&#39;)"><span class="hl_vardecl"><span class="mpre">firstCondition</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.null</span></span><span class="mpre"> </span><a href="#loc_236_15_236_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_15_236_22&#39;)"><span class="hl_varref"><span class="mpre">domain&#39;</span></span></a><span class="mpre">
        </span><a name="loc_241_9_241_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_9_241_15&#39;)"><span class="hl_vardecl"><span class="mpre">step10</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><a href="#loc_206_39_206_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_39_206_50&#39;)"><span class="hl_varref"><span class="mpre">is_http_api</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Web.Cookie.html#loc_104_7_104_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Web.Cookie.html#loc_104_7_104_24&#39;)"><span class="hl_varref"><span class="mpre">setCookieHttpOnly</span></span></a><span class="mpre"> </span><a href="#loc_206_16_206_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_16_206_26&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Web.Cookie.html#loc_104_7_104_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Web.Cookie.html#loc_104_7_104_24&#39;)"><span class="hl_varref"><span class="mpre">setCookieHttpOnly</span></span></a><span class="mpre"> </span><a href="#loc_206_16_206_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_16_206_26&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre">
        </span><a href="#loc_245_9_245_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_9_245_22&#39;)"><span class="mpre">getExpiryTime</span></a><span class="mpre"> :: </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="Data.Time.Clock.Scale.html#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">
        </span><a name="loc_245_9_245_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_9_245_22&#39;)"><span class="hl_fundecl"><span class="mpre">getExpiryTime</span></span></a><span class="mpre"> _ (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_245_31_245_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_31_245_32&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) = (</span><span class="hl_varref"><span class="mpre">fromRational</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre"> </span><a href="#loc_245_31_245_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_31_245_32&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><a href="Data.Time.Clock.UTCDiff.html#loc_9_1_9_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTCDiff.html#loc_9_1_9_11&#39;)"><span class="hl_infix"><span class="mpre">`addUTCTime`</span></span></a><span class="mpre"> </span><a href="#loc_206_35_206_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_35_206_38&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre">
        </span><a href="#loc_245_9_245_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_9_245_22&#39;)"><span class="hl_fundecl"><span class="mpre">getExpiryTime</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_246_29_246_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_29_246_30&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> = </span><a href="#loc_246_29_246_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_29_246_30&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
        </span><a href="#loc_245_9_245_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_9_245_22&#39;)"><span class="hl_fundecl"><span class="mpre">getExpiryTime</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">365000</span></span><span class="mpre"> </span><a href="Data.Time.Calendar.Days.html#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_48_1_48_8&#39;)"><span class="hl_infix"><span class="mpre">`addDays`</span></span></a><span class="mpre"> </span><a href="Data.Time.Clock.UTC.html#loc_33_9_33_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_33_9_33_16&#39;)"><span class="hl_varref"><span class="mpre">utctDay</span></span></a><span class="mpre"> </span><a href="#loc_206_35_206_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_35_206_38&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre">) (</span><a href="Data.Time.Clock.Scale.html#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_99_1_99_18&#39;)"><span class="hl_varref"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
        </span><a name="loc_248_9_248_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_9_248_16&#39;)"><span class="hl_fundecl"><span class="mpre">getPath</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_248_23_248_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_23_248_24&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) = </span><a href="#loc_248_23_248_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_23_248_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
        </span><a href="#loc_248_9_248_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_9_248_16&#39;)"><span class="hl_fundecl"><span class="mpre">getPath</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> = </span><a href="#loc_66_1_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_12&#39;)"><span class="hl_varref"><span class="mpre">defaultPath</span></span></a><span class="mpre"> </span><a href="#loc_206_27_206_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_27_206_34&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre">
        </span><span class="hl_vardecl"><span class="mpre">getPersistent</span></span><span class="mpre"> = </span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> (</span><a href="Web.Cookie.html#loc_101_7_101_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Web.Cookie.html#loc_101_7_101_23&#39;)"><span class="hl_varref"><span class="mpre">setCookieExpires</span></span></a><span class="mpre"> </span><a href="#loc_206_16_206_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_16_206_26&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> (</span><a href="Web.Cookie.html#loc_102_7_102_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Web.Cookie.html#loc_102_7_102_22&#39;)"><span class="hl_varref"><span class="mpre">setCookieMaxAge</span></span></a><span class="mpre"> </span><a href="#loc_206_16_206_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_16_206_26&#39;)"><span class="hl_varref"><span class="mpre">set_cookie</span></span></a><span class="mpre">)
</span></div></body></html>