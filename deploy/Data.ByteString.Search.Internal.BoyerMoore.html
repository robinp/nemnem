<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}
{-# OPTIONS_HADDOCK hide, prune #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module         : Data.ByteString.Search.Internal.BoyerMoore</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright      : Daniel Fischer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                  Chris Kuklewicz</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Licence        : BSD3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer     : Daniel Fischer &lt;daniel.is.fischer@googlemail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability      : Provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability    : non-portable (BangPatterns)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Fast overlapping Boyer-Moore search of both strict and lazy</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;S.ByteString&#39; values. Breaking, splitting and replacing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- using the Boyer-Moore algorithm.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Descriptions of the algorithm can be found at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://www-igm.univ-mlv.fr/~lecroq/string/node14.html#SECTION00140&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://en.wikipedia.org/wiki/Boyer-Moore_string_search_algorithm&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Original authors: Daniel Fischer (daniel.is.fischer at googlemail.com) and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Chris Kuklewicz (haskell at list.mightyreason.com).</span></span><span class="mpre">

module Data.ByteString.Search.Internal.BoyerMoore (
                                           matchLS
                                         , matchSS

                                           </span><span class="hl_comment"><span class="mpre">--  Non-overlapping</span></span><span class="mpre">
                                         , matchNOS

                                            </span><span class="hl_comment"><span class="mpre">--  Replacing substrings</span></span><span class="mpre">
                                            </span><span class="hl_comment"><span class="mpre">-- replacing</span></span><span class="mpre">
                                         , replaceAllS
                                            </span><span class="hl_comment"><span class="mpre">--  Breaking on substrings</span></span><span class="mpre">
                                            </span><span class="hl_comment"><span class="mpre">-- breaking</span></span><span class="mpre">
                                         , breakSubstringS
                                         , breakAfterS
                                            </span><span class="hl_comment"><span class="mpre">--  Splitting on substrings</span></span><span class="mpre">
                                            </span><span class="hl_comment"><span class="mpre">-- splitting</span></span><span class="mpre">
                                         , splitKeepEndS
                                         , splitKeepFrontS
                                         , splitDropS
                                         ) where


import Data.ByteString.Search.Internal.Utils
                (</span><a href="Data.ByteString.Search.Internal.Utils.html#loc_127_1_127_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_127_1_127_7&#39;)"><span class="mpre">occurs</span></a><span class="mpre">, </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_180_1_180_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_180_1_180_11&#39;)"><span class="mpre">suffShifts</span></a><span class="mpre">, </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_285_1_285_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_285_1_285_10&#39;)"><span class="mpre">strictify</span></a><span class="mpre">)
import Data.ByteString.Search.Substitution

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/BoyerMoore.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 18, srcSpanEndLine = 50, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/BoyerMoore.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 18, srcSpanEndLine = 51, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import qualified Data.ByteString.Lazy.Internal as LI
import Data.ByteString.Unsafe (</span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="mpre">unsafeIndex</span></a><span class="mpre">)

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/BoyerMoore.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 8, srcSpanEndLine = 55, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.Array.Base&quot;"><span class="mpre">Data.Array.Base</span></span><span class="mpre"> (unsafeAt)

import Data.Word (Word8)

</span><span class="hl_comment"><span class="mpre">-- overview</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module exports three search functions for searching in strict</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ByteStrings. One for searching non-overlapping occurrences of a strict</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- pattern and one each for possibly overlapping occurrences of a lazy</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- resp. strict pattern. The common base name is @match@, the suffix</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- indicates the type of search to perform. These functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- return (for a non-empty pattern) a list of all the indices of the target</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- string where an occurrence of the pattern begins, if some occurrences</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- overlap, all starting indices are reported. The list is produced lazily,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- so not necessarily the entire target string is searched.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The behaviour of these functions when given an empty pattern has changed.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Formerly, the @matchXY@ functions returned an empty list then, now it&#39;s</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @[0 .. &#39;length&#39; target]@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Newly added are functions to replace all (non-overlapping) occurrences</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of a pattern within a string, functions to break ByteStrings at the first</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- occurrence of a pattern and functions to split ByteStrings at each</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- occurrence of a pattern. None of these functions does copying, so they</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- don&#39;t introduce large memory overhead.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Internally, a lazy pattern is always converted to a strict ByteString,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which is necessary for an efficient implementation of the algorithm.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The limit this imposes on the length of the pattern is probably</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- irrelevant in practice, but perhaps it should be mentioned.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This also means that the @matchL*@ functions are mere convenience wrappers.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Except for the initial &#39;strictify&#39;ing, there&#39;s no difference between lazy</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and strict patterns, they call the same workers. There is, however, a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- difference between strict and lazy target strings.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For the new functions, no such wrappers are provided, you have to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;strictify&#39; lazy patterns yourself.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- caution</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- When working with a lazy target string, the relation between the pattern</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- length and the chunk size can play a big r&amp;#244;le.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Crossing chunk boundaries is relatively expensive, so when that becomes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a frequent occurrence, as may happen when the pattern length is close</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to or larger than the chunk size, performance is likely to degrade.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If it is needed, steps can be taken to ameliorate that effect, but unless</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- entirely separate functions are introduced, that would hurt the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- performance for the more common case of patterns much shorter than</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the default chunk size.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- performance</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In general, the Boyer-Moore algorithm is the most efficient method to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- search for a pattern inside a string, so most of the time, you&#39;ll want</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to use the functions of this module, hence this is where the most work</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- has gone. Very short patterns are an exception to this, for those you</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- should consider using a finite automaton</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (&quot;Data.ByteString.Search.DFA.Array&quot;). That is also often the better</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- choice for searching longer periodic patterns in a lazy ByteString</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with many matches.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Operating on a strict target string is mostly faster than on a lazy</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- target string, but the difference is usually small (according to my</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- tests).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The known exceptions to this rule of thumb are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [long targets] Then the smaller memory footprint of a lazy target often</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- gives (much) better performance.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [high number of matches] When there are very many matches, strict target</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- strings are much faster, especially if the pattern is periodic.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If both conditions hold, either may outweigh the other.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- complexity</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Preprocessing the pattern is /O/(@patternLength@ + &amp;#963;) in time and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- space (&amp;#963; is the alphabet size, 256 here) for all functions.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The time complexity of the searching phase for @matchXY@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is /O/(@targetLength@ \/ @patternLength@) in the best case.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For non-periodic patterns, the worst case complexity is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /O/(@targetLength@), but for periodic patterns, the worst case complexity</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is /O/(@targetLength@ * @patternLength@) for the original Boyer-Moore</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- algorithm.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The searching functions in this module now contain a modification which</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- drastically improves the performance for periodic patterns.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- I believe that for strict target strings, the worst case is now</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /O/(@targetLength@) also for periodic patterns and for lazy target strings,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- my semi-educated guess is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /O/(@targetLength@ * (1 + @patternLength@ \/ @chunkSize@)).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- I may be very wrong, though.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The other functions don&#39;t have to deal with possible overlapping</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- patterns, hence the worst case complexity for the processing phase</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is /O/(@targetLength@) (respectively /O/(@firstIndex + patternLength@)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for the breaking functions if the pattern occurs).</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- currying</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- These functions can all be usefully curried. Given only a pattern</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the curried version will compute the supporting lookup tables only</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- once, allowing for efficient re-use.  Similarly, the curried</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;matchLL&#39; and &#39;matchLS&#39; will compute the concatenated pattern only</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- once.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- overflow</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The current code uses @Int@ to keep track of the locations in the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- target string.  If the length of the pattern plus the length of any</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- strict chunk of the target string is greater than</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @&#39;maxBound&#39; :: &#39;Int&#39;@ then this will overflow causing an error.  We</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- try to detect this and call &#39;error&#39; before a segfault occurs.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                 Wrappers                                 --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- matching</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- These functions find the indices of all (possibly overlapping)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- occurrences of a pattern in a target string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If the pattern is empty, the result is @[0 .. length target]@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If the pattern is much shorter than the target string</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and the pattern does not occur very near the beginning of the target,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; not . null $ matchSS pattern target</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is a much more efficient version of &#39;S.isInfixOf&#39;.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;matchLS&#39;@ finds the starting indices of all possibly overlapping</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   occurrences of the pattern in the target string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   It is a simple wrapper for &#39;Data.ByteString.Search.indices&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   If the pattern is empty, the result is @[0 .. &#39;length&#39; target]@.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_193_1_193_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_8&#39;)"><span class="mpre">matchLS</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_193_1_193_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_8&#39;)"><span class="mpre">matchLS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Lazy pattern</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Strict target string</span></span><span class="mpre">
        -&gt; [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">]            </span><span class="hl_comment"><span class="mpre">-- ^ Offsets of matches</span></span><span class="mpre">
</span><a name="loc_193_1_193_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_8&#39;)"><span class="hl_fundecl"><span class="mpre">matchLS</span></span></a><span class="mpre"> </span><a name="loc_193_9_193_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_9_193_12&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_195_5_195_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_5_195_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre">
  where
    </span><a name="loc_195_5_195_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_5_195_11&#39;)"><span class="hl_vardecl"><span class="mpre">search</span></span></a><span class="mpre"> = </span><a href="#loc_341_1_341_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_15&#39;)"><span class="hl_varref"><span class="mpre">strictSearcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> (</span><a href="Data.ByteString.Search.Internal.Utils.html#loc_285_1_285_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_285_1_285_10&#39;)"><span class="hl_varref"><span class="mpre">strictify</span></span></a><span class="mpre"> </span><a href="#loc_193_9_193_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_9_193_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;matchSS&#39;@ finds the starting indices of all possibly overlapping</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   occurrences of the pattern in the target string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   It is an alias for &#39;Data.ByteString.Search.indices&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   If the pattern is empty, the result is @[0 .. &#39;length&#39; target]@.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_205_1_205_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_8&#39;)"><span class="mpre">matchSS</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_205_1_205_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_8&#39;)"><span class="mpre">matchSS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Strict target string</span></span><span class="mpre">
        -&gt; [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">]            </span><span class="hl_comment"><span class="mpre">-- ^ Offsets of matches</span></span><span class="mpre">
</span><a name="loc_205_1_205_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_8&#39;)"><span class="hl_fundecl"><span class="mpre">matchSS</span></span></a><span class="mpre"> </span><a name="loc_205_9_205_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_12&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_207_5_207_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_5_207_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre">
  where
    </span><a name="loc_207_5_207_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_5_207_11&#39;)"><span class="hl_vardecl"><span class="mpre">search</span></span></a><span class="mpre"> = </span><a href="#loc_341_1_341_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_15&#39;)"><span class="hl_varref"><span class="mpre">strictSearcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_205_9_205_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;matchNOS&#39;@ finds the indices of all non-overlapping occurrences</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   of the pattern in the Strict target string.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_215_1_215_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_9&#39;)"><span class="mpre">matchNOS</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_215_1_215_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_9&#39;)"><span class="mpre">matchNOS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Strict target string</span></span><span class="mpre">
         -&gt; [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">]           </span><span class="hl_comment"><span class="mpre">-- ^ Offsets of matches</span></span><span class="mpre">
</span><a name="loc_215_1_215_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_9&#39;)"><span class="hl_fundecl"><span class="mpre">matchNOS</span></span></a><span class="mpre"> </span><a name="loc_215_10_215_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_10_215_13&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_217_5_217_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_5_217_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre">
  where
    </span><a name="loc_217_5_217_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_5_217_11&#39;)"><span class="hl_vardecl"><span class="mpre">search</span></span></a><span class="mpre"> = </span><a href="#loc_341_1_341_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_15&#39;)"><span class="hl_varref"><span class="mpre">strictSearcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_215_10_215_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_10_215_13&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- replacing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   These functions replace all (non-overlapping) occurrences of a pattern</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   in the target string. If some occurrences overlap, the earliest is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   replaced and replacing continues at the index after the replaced</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   occurrence, for example</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; replaceAllL \&quot;ana\&quot; \&quot;olog\&quot; \&quot;banana\&quot; == \&quot;bologna\&quot;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; replaceAllS \&quot;abacab\&quot; \&quot;u\&quot; \&quot;abacabacabacab\&quot; == \&quot;uacu\&quot;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; replaceAllS \&quot;aa\&quot; \&quot;aaa\&quot; \&quot;aaaa\&quot; == \&quot;aaaaaa\&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Equality of pattern and substitution is not checked, but</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; pat == sub =&gt; &#39;strictify&#39; (replaceAllS pat sub str) == str,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; pat == sub =&gt; replaceAllL pat sub str == str.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   The result is a lazily generated lazy ByteString, the first chunks will</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   generally be available before the entire target has been scanned.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   If the pattern is empty, but not the substitution, the result is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   equivalent to @&#39;cycle&#39; sub@.</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_246_1_246_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_12&#39;)"><span class="mpre">replaceAllS</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_246_1_246_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_12&#39;)"><span class="mpre">replaceAllS</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/BoyerMoore.hs&quot;, srcSpanStartLine = 241, srcSpanStartColumn = 16, srcSpanEndLine = 242, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Search/Internal/BoyerMoore.hs&quot;, srcSpanStartLine = 242, srcSpanStartColumn = 13, srcSpanEndLine = 242, srcSpanEndColumn = 15}]}) (ClassA (SrcSpanInfo {srcInfoSpan = Sr"><span class="mpre">Substitution rep
            =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Pattern to replace</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyvar"><span class="mpre">rep</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ Substitution string</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Target string</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Lazy result</span></span><span class="mpre">
</span><a name="loc_246_1_246_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_1_246_12&#39;)"><span class="hl_fundecl"><span class="mpre">replaceAllS</span></span></a><span class="mpre"> </span><a name="loc_246_13_246_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_13_246_16&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_246_13_246_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_13_246_16&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> = \</span><a name="loc_247_21_247_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_21_247_24&#39;)"><span class="hl_vardecl"><span class="mpre">sub</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Search.Substitution.html#loc_34_5_34_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Substitution.html#loc_34_5_34_17&#39;)"><span class="hl_varref"><span class="mpre">prependCycle</span></span></a><span class="mpre"> </span><a href="#loc_247_21_247_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_21_247_24&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_173_1_173_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_173_1_173_6&#39;)"><span class="hl_varref"><span class="mpre">LI.chunk</span></span></a><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_19_82_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_19_82_24&#39;)"><span class="hl_conref"><span class="mpre">LI.Empty</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
      let </span><a name="loc_249_11_249_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_11_249_15&#39;)"><span class="hl_vardecl"><span class="mpre">repl</span></span></a><span class="mpre"> = </span><a href="#loc_518_1_518_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_1_518_11&#39;)"><span class="hl_varref"><span class="mpre">strictRepl</span></span></a><span class="mpre"> </span><a href="#loc_246_13_246_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_13_246_16&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
      in \</span><a name="loc_250_11_250_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_11_250_14&#39;)"><span class="hl_vardecl"><span class="mpre">sub</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_249_11_249_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_11_249_15&#39;)"><span class="hl_varref"><span class="mpre">repl</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Search.Substitution.html#loc_23_5_23_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Substitution.html#loc_23_5_23_17&#39;)"><span class="hl_varref"><span class="mpre">substitution</span></span></a><span class="mpre"> </span><a href="#loc_250_11_250_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_11_250_14&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- breaking</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Break a string on a pattern. The first component of the result</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- contains the prefix of the string before the first occurrence of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- pattern, the second component contains the remainder.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The following relations hold:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; breakSubstringX \&quot;\&quot; str = (\&quot;\&quot;, str)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; not (pat `isInfixOf` str) == null (snd $ breakSunbstringX pat str)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; True == case breakSubstringX pat str of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          (x, y) -&gt; not (pat `isInfixOf` x)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;                       &amp;&amp; (null y || pat `isPrefixOf` y)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This function has the same semantics as &#39;S.breakSubstring&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   but is generally much faster.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_272_1_272_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_1_272_16&#39;)"><span class="mpre">breakSubstringS</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_272_1_272_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_1_272_16&#39;)"><span class="mpre">breakSubstringS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Pattern to break on</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ String to break up</span></span><span class="mpre">
                -&gt; (</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)
                    </span><span class="hl_comment"><span class="mpre">-- ^ Prefix and remainder of broken string</span></span><span class="mpre">
</span><a name="loc_272_1_272_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_1_272_16&#39;)"><span class="hl_vardecl"><span class="mpre">breakSubstringS</span></span></a><span class="mpre"> = </span><a href="#loc_442_1_442_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_1_442_12&#39;)"><span class="hl_varref"><span class="mpre">strictBreak</span></span></a><span class="mpre">

</span><a href="#loc_277_1_277_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_1_277_12&#39;)"><span class="mpre">breakAfterS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
            -&gt; (</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)
</span><a name="loc_277_1_277_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_1_277_12&#39;)"><span class="hl_fundecl"><span class="mpre">breakAfterS</span></span></a><span class="mpre"> </span><a name="loc_277_13_277_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_13_277_16&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_277_13_277_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_13_277_16&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> = \</span><a name="loc_278_19_278_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_19_278_22&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">, </span><a href="#loc_278_19_278_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_19_278_22&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)
</span><a href="#loc_277_1_277_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_1_277_12&#39;)"><span class="hl_fundecl"><span class="mpre">breakAfterS</span></span></a><span class="mpre"> </span><a name="loc_279_13_279_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_13_279_16&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_283_5_283_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_5_283_12&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre">
  where
    !</span><a name="loc_281_6_281_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_6_281_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_279_13_279_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_13_279_16&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_282_5_282_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_5_282_13&#39;)"><span class="hl_vardecl"><span class="mpre">searcher</span></span></a><span class="mpre"> = </span><a href="#loc_341_1_341_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_15&#39;)"><span class="hl_varref"><span class="mpre">strictSearcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_279_13_279_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_13_279_16&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_283_5_283_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_5_283_12&#39;)"><span class="hl_fundecl"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a name="loc_283_13_283_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_13_283_16&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = case </span><a href="#loc_282_5_282_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_5_282_13&#39;)"><span class="hl_varref"><span class="mpre">searcher</span></span></a><span class="mpre"> </span><a href="#loc_283_13_283_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_13_283_16&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> of
                    []    -&gt; (</span><a href="#loc_283_13_283_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_13_283_16&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">)
                    (</span><a name="loc_285_22_285_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_22_285_23&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><span class="hl_varref"><span class="mpre">S.splitAt</span></span><span class="mpre"> (</span><a href="#loc_285_22_285_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_22_285_23&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_281_6_281_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_6_281_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">) </span><a href="#loc_283_13_283_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_13_283_16&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- splitting</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- These functions implement various splitting strategies.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If the pattern to split on is empty, all functions return an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- infinite list of empty ByteStrings.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Otherwise, the names are rather self-explanatory.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For nonempty patterns, the following relations hold:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; concat (splitKeepXY pat str) == str</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; concat (&#39;Data.List.intersperse&#39; pat (splitDropX pat str)) == str.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- All fragments except possibly the last in the result of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @splitKeepEndX pat@ end with @pat@, none of the fragments contains</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- more than one occurrence of @pat@ or is empty.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- All fragments except possibly the first in the result of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @splitKeepFrontX pat@ begin with @pat@, none of the fragments</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- contains more than one occurrence of @patq or is empty.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitDropX pat str == map dropPat (splitKeepFrontX pat str)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;     patLen = length pat</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;     dropPat frag</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;        | pat `isPrefixOf` frag = drop patLen frag</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;        | otherwise             = frag</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- but @splitDropX@ is a little more efficient than that.</span></span><span class="mpre">


</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_322_1_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_1_322_14&#39;)"><span class="mpre">splitKeepEndS</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_322_1_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_1_322_14&#39;)"><span class="mpre">splitKeepEndS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Pattern to split on</span></span><span class="mpre">
              -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ String to split</span></span><span class="mpre">
              -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]  </span><span class="hl_comment"><span class="mpre">-- ^ List of fragments</span></span><span class="mpre">
</span><a name="loc_322_1_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_1_322_14&#39;)"><span class="hl_vardecl"><span class="mpre">splitKeepEndS</span></span></a><span class="mpre"> = </span><a href="#loc_479_1_479_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_1_479_19&#39;)"><span class="hl_varref"><span class="mpre">strictSplitKeepEnd</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_328_1_328_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_16&#39;)"><span class="mpre">splitKeepFrontS</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_328_1_328_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_16&#39;)"><span class="mpre">splitKeepFrontS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Pattern to split on</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ String to split</span></span><span class="mpre">
                -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]  </span><span class="hl_comment"><span class="mpre">-- ^ List of fragments</span></span><span class="mpre">
</span><a name="loc_328_1_328_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_16&#39;)"><span class="hl_vardecl"><span class="mpre">splitKeepFrontS</span></span></a><span class="mpre"> = </span><a href="#loc_456_1_456_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_1_456_21&#39;)"><span class="hl_varref"><span class="mpre">strictSplitKeepFront</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_334_1_334_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_11&#39;)"><span class="mpre">splitDropS</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_334_1_334_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_11&#39;)"><span class="mpre">splitDropS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Pattern to split on</span></span><span class="mpre">
           -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ String to split</span></span><span class="mpre">
           -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]  </span><span class="hl_comment"><span class="mpre">-- ^ List of fragments</span></span><span class="mpre">
</span><a name="loc_334_1_334_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_11&#39;)"><span class="hl_vardecl"><span class="mpre">splitDropS</span></span></a><span class="mpre"> = </span><a href="#loc_494_1_494_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_1_494_16&#39;)"><span class="hl_varref"><span class="mpre">strictSplitDrop</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                             Search Functions                             --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_341_1_341_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_15&#39;)"><span class="mpre">strictSearcher</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">]
</span><a name="loc_341_1_341_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_15&#39;)"><span class="hl_fundecl"><span class="mpre">strictSearcher</span></span></a><span class="mpre"> _ !</span><a name="loc_341_19_341_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_19_341_22&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_341_19_341_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_19_341_22&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">enumFromTo</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_341_19_341_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_19_341_22&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = let !</span><a name="loc_343_32_343_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_32_343_33&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.head</span></span><span class="mpre"> </span><a href="#loc_341_19_341_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_19_341_22&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> in </span><span class="hl_varref"><span class="mpre">S.elemIndices</span></span><span class="mpre"> </span><a href="#loc_343_32_343_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_32_343_33&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">
</span><a href="#loc_341_1_341_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_15&#39;)"><span class="hl_fundecl"><span class="mpre">strictSearcher</span></span></a><span class="mpre"> !</span><a name="loc_344_17_344_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_17_344_24&#39;)"><span class="hl_vardecl"><span class="mpre">overlap</span></span></a><span class="mpre"> </span><a name="loc_344_25_344_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_25_344_28&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_366_5_366_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_5_366_13&#39;)"><span class="hl_varref"><span class="mpre">searcher</span></span></a><span class="mpre">
  where
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_348_5_348_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_5_348_10&#39;)"><span class="mpre">patAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a href="#loc_348_5_348_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_5_348_10&#39;)"><span class="mpre">patAt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
    </span><a name="loc_348_5_348_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_5_348_10&#39;)"><span class="hl_fundecl"><span class="mpre">patAt</span></span></a><span class="mpre"> !</span><a name="loc_348_12_348_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_12_348_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_344_25_344_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_25_344_28&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><a href="#loc_348_12_348_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_12_348_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

    !</span><a name="loc_350_6_350_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_6_350_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_344_25_344_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_25_344_28&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    !</span><a name="loc_351_6_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_6_351_12&#39;)"><span class="hl_vardecl"><span class="mpre">patEnd</span></span></a><span class="mpre"> = </span><a href="#loc_350_6_350_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_6_350_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    !</span><a name="loc_352_6_352_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_6_352_12&#39;)"><span class="hl_vardecl"><span class="mpre">maxLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maxBound</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_350_6_350_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_6_350_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">
    !</span><a name="loc_353_6_353_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_6_353_10&#39;)"><span class="hl_vardecl"><span class="mpre">occT</span></span></a><span class="mpre">   = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_127_1_127_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_127_1_127_7&#39;)"><span class="hl_varref"><span class="mpre">occurs</span></span></a><span class="mpre"> </span><a href="#loc_344_25_344_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_25_344_28&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- for bad-character-shift</span></span><span class="mpre">
    !</span><a name="loc_354_6_354_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_6_354_11&#39;)"><span class="hl_vardecl"><span class="mpre">suffT</span></span></a><span class="mpre">  = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_180_1_180_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_180_1_180_11&#39;)"><span class="hl_varref"><span class="mpre">suffShifts</span></span></a><span class="mpre"> </span><a href="#loc_344_25_344_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_25_344_28&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- for good-suffix-shift</span></span><span class="mpre">
    !</span><a name="loc_355_6_355_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_6_355_10&#39;)"><span class="hl_vardecl"><span class="mpre">skip</span></span></a><span class="mpre">   = if </span><a href="#loc_344_17_344_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_17_344_24&#39;)"><span class="hl_varref"><span class="mpre">overlap</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_354_6_354_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_6_354_11&#39;)"><span class="hl_varref"><span class="mpre">suffT</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> else </span><a href="#loc_350_6_350_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_6_350_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- shift after a complete match</span></span><span class="mpre">
    !</span><a name="loc_357_6_357_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_6_357_10&#39;)"><span class="hl_vardecl"><span class="mpre">kept</span></span></a><span class="mpre">   = </span><a href="#loc_350_6_350_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_6_350_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_355_6_355_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_6_355_10&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- length of known prefix after full match</span></span><span class="mpre">
    !</span><a name="loc_358_6_358_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_6_358_8&#39;)"><span class="hl_vardecl"><span class="mpre">pe</span></span></a><span class="mpre">     = </span><a href="#loc_348_5_348_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_5_348_10&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><a href="#loc_351_6_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_6_351_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- last pattern byte for fast comparison</span></span><span class="mpre">

    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_361_5_361_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_5_361_8&#39;)"><span class="mpre">occ</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a name="loc_361_5_361_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_5_361_8&#39;)"><span class="hl_fundecl"><span class="mpre">occ</span></span></a><span class="mpre"> !</span><a name="loc_361_10_361_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_10_361_11&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_353_6_353_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_6_353_10&#39;)"><span class="hl_varref"><span class="mpre">occT</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_361_10_361_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_10_361_11&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_364_5_364_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_5_364_9&#39;)"><span class="mpre">suff</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a name="loc_364_5_364_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_5_364_9&#39;)"><span class="hl_fundecl"><span class="mpre">suff</span></span></a><span class="mpre"> !</span><a name="loc_364_11_364_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_11_364_12&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_354_6_354_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_6_354_11&#39;)"><span class="hl_varref"><span class="mpre">suffT</span></span></a><span class="mpre"> </span><a href="#loc_364_11_364_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_11_364_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

    </span><a name="loc_366_5_366_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_5_366_13&#39;)"><span class="hl_fundecl"><span class="mpre">searcher</span></span></a><span class="mpre"> </span><a name="loc_366_14_366_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_14_366_17&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">
        | </span><a href="#loc_352_6_352_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_6_352_12&#39;)"><span class="hl_varref"><span class="mpre">maxLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_372_14_372_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_14_372_20&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">
            = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Overflow in BoyerMoore.strictSearcher&quot;</span></span><span class="mpre">
        | </span><a href="#loc_374_14_374_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_14_374_21&#39;)"><span class="hl_varref"><span class="mpre">maxDiff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">   = []
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><a href="#loc_407_13_407_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_13_407_21&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> </span><a href="#loc_351_6_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_6_351_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
          where
            !</span><a name="loc_372_14_372_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_14_372_20&#39;)"><span class="hl_vardecl"><span class="mpre">strLen</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_366_14_366_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_14_366_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
            !</span><a name="loc_373_14_373_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_14_373_20&#39;)"><span class="hl_vardecl"><span class="mpre">strEnd</span></span></a><span class="mpre">  = </span><a href="#loc_372_14_372_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_14_372_20&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
            !</span><a name="loc_374_14_374_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_14_374_21&#39;)"><span class="hl_vardecl"><span class="mpre">maxDiff</span></span></a><span class="mpre"> = </span><a href="#loc_372_14_372_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_14_372_20&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_350_6_350_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_6_350_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">

            </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_377_13_377_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_13_377_18&#39;)"><span class="mpre">strAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
            </span><a name="loc_377_13_377_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_13_377_18&#39;)"><span class="hl_fundecl"><span class="mpre">strAt</span></span></a><span class="mpre"> !</span><a name="loc_377_20_377_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_20_377_21&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_366_14_366_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_14_366_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_377_20_377_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_20_377_21&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

            </span><span class="hl_comment"><span class="mpre">-- After a full match, we know how long a prefix of the pattern</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- still matches. Do not re-compare the prefix to prevent O(m*n)</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- behaviour for periodic patterns.</span></span><span class="mpre">
            </span><a name="loc_382_13_382_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_13_382_23&#39;)"><span class="hl_fundecl"><span class="mpre">afterMatch</span></span></a><span class="mpre"> !</span><a name="loc_382_25_382_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_25_382_29&#39;)"><span class="hl_vardecl"><span class="mpre">diff</span></span></a><span class="mpre"> !</span><a name="loc_382_31_382_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_31_382_35&#39;)"><span class="hl_vardecl"><span class="mpre">patI</span></span></a><span class="mpre"> =
              case </span><a href="#loc_377_13_377_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_13_377_18&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> (</span><a href="#loc_382_25_382_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_25_382_29&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_382_31_382_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_31_382_35&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">) of
                !</span><a name="loc_384_18_384_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_18_384_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">  | </span><a href="#loc_384_18_384_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_18_384_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_348_5_348_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_5_348_10&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><a href="#loc_382_31_382_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_31_382_35&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> -&gt;
                      if </span><a href="#loc_382_31_382_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_31_382_35&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_357_6_357_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_6_357_10&#39;)"><span class="hl_varref"><span class="mpre">kept</span></span></a><span class="mpre">
                        then </span><a href="#loc_382_25_382_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_25_382_29&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> let !</span><a name="loc_386_42_386_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_42_386_47&#39;)"><span class="hl_vardecl"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_382_25_382_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_25_382_29&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_355_6_355_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_6_355_10&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre">
                                    in if </span><a href="#loc_374_14_374_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_14_374_21&#39;)"><span class="hl_varref"><span class="mpre">maxDiff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_386_42_386_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_42_386_47&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre">
                                        then []
                                        else </span><a href="#loc_382_13_382_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_13_382_23&#39;)"><span class="hl_varref"><span class="mpre">afterMatch</span></span></a><span class="mpre"> </span><a href="#loc_386_42_386_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_42_386_47&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><a href="#loc_351_6_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_6_351_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                        else </span><a href="#loc_382_13_382_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_13_382_23&#39;)"><span class="hl_varref"><span class="mpre">afterMatch</span></span></a><span class="mpre"> </span><a href="#loc_382_25_382_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_25_382_29&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> (</span><a href="#loc_382_31_382_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_31_382_35&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                    | </span><a href="#loc_382_31_382_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_31_382_35&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_351_6_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_6_351_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">  -&gt;
                            </span><a href="#loc_407_13_407_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_13_407_21&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_382_25_382_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_25_382_29&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_351_6_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_6_351_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_361_5_361_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_5_361_8&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_384_18_384_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_18_384_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)
                    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       -&gt;
                            let </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_395_33_395_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_33_395_41&#39;)"><span class="mpre">badShift</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                                </span><a name="loc_395_33_395_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_33_395_41&#39;)"><span class="hl_vardecl"><span class="mpre">badShift</span></span></a><span class="mpre"> = </span><a href="#loc_382_31_382_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_31_382_35&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_361_5_361_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_5_361_8&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_384_18_384_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_18_384_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                                </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_397_33_397_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_33_397_42&#39;)"><span class="mpre">goodShift</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                                </span><a name="loc_397_33_397_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_33_397_42&#39;)"><span class="hl_vardecl"><span class="mpre">goodShift</span></span></a><span class="mpre"> = </span><a href="#loc_364_5_364_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_5_364_9&#39;)"><span class="hl_varref"><span class="mpre">suff</span></span></a><span class="mpre"> </span><a href="#loc_382_31_382_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_31_382_35&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">
                                !</span><a name="loc_398_34_398_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_34_398_39&#39;)"><span class="hl_vardecl"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_382_25_382_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_25_382_29&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><a href="#loc_395_33_395_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_33_395_41&#39;)"><span class="hl_varref"><span class="mpre">badShift</span></span></a><span class="mpre"> </span><a href="#loc_397_33_397_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_33_397_42&#39;)"><span class="hl_varref"><span class="mpre">goodShift</span></span></a><span class="mpre">
                            in if </span><a href="#loc_374_14_374_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_14_374_21&#39;)"><span class="hl_varref"><span class="mpre">maxDiff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_398_34_398_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_34_398_39&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre">
                                then []
                                else </span><a href="#loc_407_13_407_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_13_407_21&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_382_25_382_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_25_382_29&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_351_6_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_6_351_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">)

            </span><span class="hl_comment"><span class="mpre">-- While comparing the last byte of the pattern, the bad-</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- character-shift is always at least as large as the good-</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- suffix-shift. Eliminating the unnecessary memory reads and</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- comparison speeds things up noticeably.</span></span><span class="mpre">
            </span><a name="loc_407_13_407_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_13_407_21&#39;)"><span class="hl_fundecl"><span class="mpre">checkEnd</span></span></a><span class="mpre"> !</span><a name="loc_407_23_407_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_23_407_25&#39;)"><span class="hl_vardecl"><span class="mpre">sI</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- index in string to compare to last of pattern</span></span><span class="mpre">
                | </span><a href="#loc_373_14_373_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_14_373_20&#39;)"><span class="hl_varref"><span class="mpre">strEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_407_23_407_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_23_407_25&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre">   = []
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     =
                  case </span><a href="#loc_377_13_377_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_13_377_18&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_407_23_407_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_23_407_25&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> of
                    !</span><a name="loc_411_22_411_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_22_411_23&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">  | </span><a href="#loc_411_22_411_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_22_411_23&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_358_6_358_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_6_358_8&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre">   -&gt; </span><a href="#loc_417_13_417_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_13_417_22&#39;)"><span class="hl_varref"><span class="mpre">findMatch</span></span></a><span class="mpre"> (</span><a href="#loc_407_23_407_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_23_407_25&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_351_6_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_6_351_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">) (</span><a href="#loc_351_6_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_6_351_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="#loc_407_13_407_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_13_407_21&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_407_23_407_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_23_407_25&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_351_6_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_6_351_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_361_5_361_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_5_361_8&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_411_22_411_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_22_411_23&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)

            </span><span class="hl_comment"><span class="mpre">-- Once the last byte has matched, we enter the full matcher</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- diff is the offset of the window, patI the index of the</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- pattern byte to compare next.</span></span><span class="mpre">
            </span><a name="loc_417_13_417_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_13_417_22&#39;)"><span class="hl_fundecl"><span class="mpre">findMatch</span></span></a><span class="mpre"> !</span><a name="loc_417_24_417_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_24_417_28&#39;)"><span class="hl_vardecl"><span class="mpre">diff</span></span></a><span class="mpre"> !</span><a name="loc_417_30_417_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_30_417_34&#39;)"><span class="hl_vardecl"><span class="mpre">patI</span></span></a><span class="mpre"> =
                case </span><a href="#loc_377_13_377_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_13_377_18&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> (</span><a href="#loc_417_24_417_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_24_417_28&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_417_30_417_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_30_417_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">) of
                    !</span><a name="loc_419_22_419_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_22_419_23&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">  | </span><a href="#loc_419_22_419_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_22_419_23&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_348_5_348_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_5_348_10&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><a href="#loc_417_30_417_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_30_417_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> -&gt;
                            if </span><a href="#loc_417_30_417_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_30_417_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- full match, report</span></span><span class="mpre">
                                then </span><a href="#loc_417_24_417_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_24_417_28&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> let !</span><a name="loc_421_50_421_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_50_421_55&#39;)"><span class="hl_vardecl"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_417_24_417_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_24_417_28&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_355_6_355_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_6_355_10&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre">
                                            in if </span><a href="#loc_374_14_374_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_14_374_21&#39;)"><span class="hl_varref"><span class="mpre">maxDiff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_421_50_421_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_50_421_55&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre">
                                                then []
                                                else
                                                  if </span><a href="#loc_355_6_355_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_6_355_10&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_350_6_350_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_6_350_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">
                                                    then
                                                      </span><a href="#loc_407_13_407_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_13_407_21&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_421_50_421_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_50_421_55&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_351_6_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_6_351_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">)
                                                    else
                                                      </span><a href="#loc_382_13_382_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_13_382_23&#39;)"><span class="hl_varref"><span class="mpre">afterMatch</span></span></a><span class="mpre"> </span><a href="#loc_421_50_421_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_50_421_55&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><a href="#loc_351_6_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_6_351_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                                else </span><a href="#loc_417_13_417_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_13_417_22&#39;)"><span class="hl_varref"><span class="mpre">findMatch</span></span></a><span class="mpre"> </span><a href="#loc_417_24_417_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_24_417_28&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> (</span><a href="#loc_417_30_417_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_30_417_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       -&gt;
                            let !</span><a name="loc_432_34_432_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_34_432_39&#39;)"><span class="hl_vardecl"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_417_24_417_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_24_417_28&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> (</span><a href="#loc_417_30_417_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_30_417_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_361_5_361_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_5_361_8&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_419_22_419_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_22_419_23&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) (</span><a href="#loc_364_5_364_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_5_364_9&#39;)"><span class="hl_varref"><span class="mpre">suff</span></span></a><span class="mpre"> </span><a href="#loc_417_30_417_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_30_417_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">)
                            in if </span><a href="#loc_374_14_374_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_14_374_21&#39;)"><span class="hl_varref"><span class="mpre">maxDiff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_432_34_432_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_34_432_39&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre">
                                then []
                                else </span><a href="#loc_407_13_407_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_13_407_21&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_432_34_432_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_34_432_39&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_351_6_351_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_6_351_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                            Breaking Functions                            --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_442_1_442_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_1_442_12&#39;)"><span class="mpre">strictBreak</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)
</span><a name="loc_442_1_442_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_1_442_12&#39;)"><span class="hl_fundecl"><span class="mpre">strictBreak</span></span></a><span class="mpre"> </span><a name="loc_442_13_442_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_13_442_16&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_442_13_442_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_13_442_16&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">    = \</span><a name="loc_443_24_443_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_24_443_27&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">, </span><a href="#loc_443_24_443_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_24_443_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><a href="#loc_447_9_447_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_9_447_16&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre">
      where
        </span><a name="loc_446_9_446_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_9_446_17&#39;)"><span class="hl_vardecl"><span class="mpre">searcher</span></span></a><span class="mpre"> = </span><a href="#loc_341_1_341_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_15&#39;)"><span class="hl_varref"><span class="mpre">strictSearcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_442_13_442_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_442_13_442_16&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
        </span><a name="loc_447_9_447_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_9_447_16&#39;)"><span class="hl_fundecl"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a name="loc_447_17_447_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_17_447_20&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = case </span><a href="#loc_446_9_446_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_9_446_17&#39;)"><span class="hl_varref"><span class="mpre">searcher</span></span></a><span class="mpre"> </span><a href="#loc_447_17_447_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_17_447_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> of
                        []      -&gt; (</span><a href="#loc_447_17_447_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_17_447_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">)
                        (</span><a name="loc_449_26_449_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_26_449_27&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)   -&gt; </span><span class="hl_varref"><span class="mpre">S.splitAt</span></span><span class="mpre"> </span><a href="#loc_449_26_449_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_26_449_27&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_447_17_447_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_17_447_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                            Splitting Functions                           --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_456_1_456_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_1_456_21&#39;)"><span class="mpre">strictSplitKeepFront</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]
</span><a name="loc_456_1_456_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_1_456_21&#39;)"><span class="hl_fundecl"><span class="mpre">strictSplitKeepFront</span></span></a><span class="mpre"> </span><a name="loc_456_22_456_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_22_456_25&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_456_22_456_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_22_456_25&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">)
</span><a href="#loc_456_1_456_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_1_456_21&#39;)"><span class="hl_fundecl"><span class="mpre">strictSplitKeepFront</span></span></a><span class="mpre"> </span><a name="loc_458_22_458_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_22_458_25&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_462_5_462_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_5_462_13&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre">
  where
    !</span><a name="loc_460_6_460_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_6_460_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_458_22_458_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_22_458_25&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_461_5_461_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_5_461_13&#39;)"><span class="hl_vardecl"><span class="mpre">searcher</span></span></a><span class="mpre"> = </span><a href="#loc_341_1_341_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_15&#39;)"><span class="hl_varref"><span class="mpre">strictSearcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_458_22_458_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_22_458_25&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_462_5_462_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_5_462_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a name="loc_462_14_462_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_14_462_17&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_462_14_462_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_14_462_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">    = []
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     =
          case </span><a href="#loc_461_5_461_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_5_461_13&#39;)"><span class="hl_varref"><span class="mpre">searcher</span></span></a><span class="mpre"> </span><a href="#loc_462_14_462_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_14_462_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> of
            []            -&gt; [</span><a href="#loc_462_14_462_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_14_462_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">]
            (</span><a name="loc_467_14_467_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_14_467_15&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)
              | </span><a href="#loc_467_14_467_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_14_467_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">    -&gt; </span><a href="#loc_470_5_470_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_5_470_14&#39;)"><span class="hl_varref"><span class="mpre">psplitter</span></span></a><span class="mpre"> </span><a href="#loc_462_14_462_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_14_462_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_467_14_467_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_14_467_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_462_14_462_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_14_462_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_470_5_470_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_5_470_14&#39;)"><span class="hl_varref"><span class="mpre">psplitter</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_467_14_467_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_14_467_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_462_14_462_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_14_462_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)
    </span><a name="loc_470_5_470_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_5_470_14&#39;)"><span class="hl_fundecl"><span class="mpre">psplitter</span></span></a><span class="mpre"> !</span><a name="loc_470_16_470_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_16_470_19&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_470_16_470_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_16_470_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">    = []
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     =
          case </span><a href="#loc_461_5_461_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_5_461_13&#39;)"><span class="hl_varref"><span class="mpre">searcher</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_460_6_460_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_6_460_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><a href="#loc_470_16_470_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_16_470_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">) of
            []      -&gt; [</span><a href="#loc_470_16_470_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_16_470_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">]
            (</span><a name="loc_475_14_475_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_14_475_15&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)   -&gt; </span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> (</span><a href="#loc_475_14_475_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_14_475_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_460_6_460_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_6_460_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">) </span><a href="#loc_470_16_470_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_16_470_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">
                        </span><a href="#loc_470_5_470_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_5_470_14&#39;)"><span class="hl_varref"><span class="mpre">psplitter</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> (</span><a href="#loc_475_14_475_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_14_475_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_460_6_460_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_6_460_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">) </span><a href="#loc_470_16_470_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_16_470_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)

</span><a href="#loc_479_1_479_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_1_479_19&#39;)"><span class="mpre">strictSplitKeepEnd</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]
</span><a name="loc_479_1_479_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_1_479_19&#39;)"><span class="hl_fundecl"><span class="mpre">strictSplitKeepEnd</span></span></a><span class="mpre"> </span><a name="loc_479_20_479_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_20_479_23&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_479_20_479_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_20_479_23&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">)
</span><a href="#loc_479_1_479_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_1_479_19&#39;)"><span class="hl_fundecl"><span class="mpre">strictSplitKeepEnd</span></span></a><span class="mpre"> </span><a name="loc_481_20_481_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_20_481_23&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_485_5_485_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_5_485_13&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre">
  where
    !</span><a name="loc_483_6_483_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_483_6_483_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_481_20_481_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_20_481_23&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_484_5_484_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_484_5_484_13&#39;)"><span class="hl_vardecl"><span class="mpre">searcher</span></span></a><span class="mpre"> = </span><a href="#loc_341_1_341_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_15&#39;)"><span class="hl_varref"><span class="mpre">strictSearcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_481_20_481_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_20_481_23&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_485_5_485_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_5_485_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a name="loc_485_14_485_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_14_485_17&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_485_14_485_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_14_485_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">    = []
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     =
          case </span><a href="#loc_484_5_484_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_484_5_484_13&#39;)"><span class="hl_varref"><span class="mpre">searcher</span></span></a><span class="mpre"> </span><a href="#loc_485_14_485_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_14_485_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> of
            [] -&gt; [</span><a href="#loc_485_14_485_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_14_485_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">]
            (</span><a name="loc_490_14_490_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_490_14_490_15&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> (</span><a href="#loc_490_14_490_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_490_14_490_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_483_6_483_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_483_6_483_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">) </span><a href="#loc_485_14_485_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_14_485_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">
                        </span><a href="#loc_485_5_485_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_5_485_13&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> (</span><a href="#loc_490_14_490_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_490_14_490_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_483_6_483_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_483_6_483_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">) </span><a href="#loc_485_14_485_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_14_485_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)

</span><a href="#loc_494_1_494_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_1_494_16&#39;)"><span class="mpre">strictSplitDrop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]
</span><a name="loc_494_1_494_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_1_494_16&#39;)"><span class="hl_fundecl"><span class="mpre">strictSplitDrop</span></span></a><span class="mpre"> </span><a name="loc_494_17_494_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_17_494_20&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_494_17_494_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_17_494_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">)
</span><a href="#loc_494_1_494_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_1_494_16&#39;)"><span class="hl_fundecl"><span class="mpre">strictSplitDrop</span></span></a><span class="mpre"> </span><a name="loc_496_17_496_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_17_496_20&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_500_5_500_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_5_500_14&#39;)"><span class="hl_varref"><span class="mpre">splitter&#39;</span></span></a><span class="mpre">
  where
    !</span><a name="loc_498_6_498_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_6_498_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_496_17_496_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_17_496_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_499_5_499_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_5_499_13&#39;)"><span class="hl_vardecl"><span class="mpre">searcher</span></span></a><span class="mpre"> = </span><a href="#loc_341_1_341_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_15&#39;)"><span class="hl_varref"><span class="mpre">strictSearcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_496_17_496_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_17_496_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_500_5_500_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_5_500_14&#39;)"><span class="hl_fundecl"><span class="mpre">splitter&#39;</span></span></a><span class="mpre"> </span><a name="loc_500_15_500_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_15_500_18&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_500_15_500_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_15_500_18&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">    = []
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><a href="#loc_503_5_503_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_5_503_13&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a href="#loc_500_15_500_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_15_500_18&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
    </span><a name="loc_503_5_503_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_5_503_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a name="loc_503_14_503_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_14_503_17&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_503_14_503_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_14_503_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">    = [</span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">]
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     =
          case </span><a href="#loc_499_5_499_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_5_499_13&#39;)"><span class="hl_varref"><span class="mpre">searcher</span></span></a><span class="mpre"> </span><a href="#loc_503_14_503_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_14_503_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> of
            []            -&gt; [</span><a href="#loc_503_14_503_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_14_503_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">]
            (</span><a name="loc_508_14_508_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_14_508_15&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_508_14_508_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_14_508_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_503_14_503_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_14_503_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_503_5_503_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_5_503_13&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> (</span><a href="#loc_508_14_508_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_14_508_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_498_6_498_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_6_498_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">) </span><a href="#loc_503_14_503_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_14_503_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                            Replacing Functions                           --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- replacing loop for strict ByteStrings, called only for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- non-empty patterns and substitutions</span></span><span class="mpre">
</span><a href="#loc_518_1_518_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_1_518_11&#39;)"><span class="mpre">strictRepl</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; ([</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">])
            -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]
</span><a name="loc_518_1_518_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_1_518_11&#39;)"><span class="hl_fundecl"><span class="mpre">strictRepl</span></span></a><span class="mpre"> </span><a name="loc_518_12_518_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_12_518_15&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">  = </span><a href="#loc_522_5_522_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_5_522_9&#39;)"><span class="hl_varref"><span class="mpre">repl</span></span></a><span class="mpre">
  where
    !</span><a name="loc_520_6_520_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_6_520_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_518_12_518_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_12_518_15&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_521_5_521_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_5_521_13&#39;)"><span class="hl_vardecl"><span class="mpre">searcher</span></span></a><span class="mpre"> = </span><a href="#loc_341_1_341_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_15&#39;)"><span class="hl_varref"><span class="mpre">strictSearcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_518_12_518_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_12_518_15&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_522_5_522_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_5_522_9&#39;)"><span class="hl_fundecl"><span class="mpre">repl</span></span></a><span class="mpre"> </span><a name="loc_522_10_522_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_10_522_13&#39;)"><span class="hl_vardecl"><span class="mpre">sub</span></span></a><span class="mpre"> = </span><a href="#loc_524_9_524_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_9_524_17&#39;)"><span class="hl_varref"><span class="mpre">replacer</span></span></a><span class="mpre">
      where
        </span><a name="loc_524_9_524_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_9_524_17&#39;)"><span class="hl_fundecl"><span class="mpre">replacer</span></span></a><span class="mpre"> </span><a name="loc_524_18_524_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_18_524_21&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_524_18_524_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_18_524_21&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">    = []
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     =
            case </span><a href="#loc_521_5_521_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_5_521_13&#39;)"><span class="hl_varref"><span class="mpre">searcher</span></span></a><span class="mpre"> </span><a href="#loc_524_18_524_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_18_524_21&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> of
              []            -&gt; [</span><a href="#loc_524_18_524_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_18_524_21&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">]
              (</span><a name="loc_529_16_529_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_16_529_17&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)
                | </span><a href="#loc_529_16_529_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_16_529_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">    -&gt; </span><a href="#loc_522_10_522_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_10_522_13&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_524_9_524_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_9_524_17&#39;)"><span class="hl_varref"><span class="mpre">replacer</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_520_6_520_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_6_520_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><a href="#loc_524_18_524_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_18_524_21&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt;
                  </span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_529_16_529_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_16_529_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_524_18_524_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_18_524_21&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_522_10_522_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_10_522_13&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="mpre"> (</span><a href="#loc_524_9_524_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_9_524_17&#39;)"><span class="hl_varref"><span class="mpre">replacer</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> (</span><a href="#loc_529_16_529_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_16_529_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_520_6_520_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_6_520_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">) </span><a href="#loc_524_18_524_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_18_524_21&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">))
</span></div></body></html>