<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.PubKey.RSA.PKCS15</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Good</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
{-# LANGUAGE OverloadedStrings #-}
module Crypto.PubKey.RSA.PKCS15
    (
    </span><span class="hl_comment"><span class="mpre">-- * padding and unpadding</span></span><span class="mpre">
      pad
    , padSignature
    , unpad
    </span><span class="hl_comment"><span class="mpre">-- * private key operations</span></span><span class="mpre">
    , decrypt
    , decryptSafer
    , sign
    , signSafer
    </span><span class="hl_comment"><span class="mpre">-- * public key operations</span></span><span class="mpre">
    , encrypt
    , verify
    ) where

import Crypto.Random
import Crypto.PubKey.Internal (</span><a href="Crypto.PubKey.Internal.html#loc_17_1_17_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.Internal.html#loc_17_1_17_5&#39;)"><span class="mpre">and&#39;</span></a><span class="mpre">)
import Crypto.Types.PubKey.RSA
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/PKCS15.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 8, srcSpanEndLine = 28, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/PKCS15.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 18, srcSpanEndLine = 29, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Crypto.PubKey.RSA.Prim
import Crypto.PubKey.RSA.Types
import Crypto.PubKey.RSA (</span><a href="Crypto.PubKey.RSA.html#loc_91_1_91_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.html#loc_91_1_91_16&#39;)"><span class="mpre">generateBlinder</span></a><span class="mpre">)
import Crypto.PubKey.HashDescr

</span><span class="hl_comment"><span class="mpre">-- | This produce a standard PKCS1.5 padding for encryption</span></span><span class="mpre">
</span><a href="#loc_37_1_37_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_4&#39;)"><span class="mpre">pad</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/PKCS15.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 8, srcSpanEndLine = 36, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/PKCS15.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 15, srcSpanEndLine = 36, srcSpanEndColumn = 17}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nem"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_19_6_19_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_19_6_19_11&#39;)"><span class="hl_tyconref"><span class="mpre">Error</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_37_1_37_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_4&#39;)"><span class="hl_fundecl"><span class="mpre">pad</span></span></a><span class="mpre"> </span><a name="loc_37_5_37_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_8&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_37_9_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_9_37_12&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> </span><a name="loc_37_13_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_13_37_14&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_37_13_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_13_37_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_37_9_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_9_37_12&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_21_7_21_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_21_7_21_21&#39;)"><span class="hl_conref"><span class="mpre">MessageTooLong</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">             =
        let (</span><a name="loc_40_14_40_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_14_40_21&#39;)"><span class="hl_vardecl"><span class="mpre">padding</span></span></a><span class="mpre">, </span><a name="loc_40_23_40_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_23_40_27&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_45_15_45_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_15_45_31&#39;)"><span class="hl_varref"><span class="mpre">getNonNullRandom</span></span></a><span class="mpre"> </span><a href="#loc_37_5_37_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_8&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> (</span><a href="#loc_37_9_37_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_9_37_12&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_37_13_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_13_37_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)
         in </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [ </span><span class="hl_varref"><span class="mpre">B.singleton</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">B.singleton</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><a href="#loc_40_14_40_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_14_40_21&#39;)"><span class="hl_varref"><span class="mpre">padding</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">B.singleton</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><a href="#loc_37_13_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_13_37_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> ], </span><a href="#loc_40_23_40_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_23_40_27&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre">)

        where </span><span class="hl_comment"><span class="mpre">{- get random non-null bytes -}</span></span><span class="mpre">
              </span><a href="#loc_45_15_45_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_15_45_31&#39;)"><span class="mpre">getNonNullRandom</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/PKCS15.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 35, srcSpanEndLine = 44, srcSpanEndColumn = 44}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/PKCS15.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 42, srcSpanEndLine = 44, srcSpanEndColumn = 44}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
              </span><a name="loc_45_15_45_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_15_45_31&#39;)"><span class="hl_fundecl"><span class="mpre">getNonNullRandom</span></span></a><span class="mpre"> </span><a name="loc_45_32_45_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_32_45_33&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_45_34_45_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_34_45_35&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
                    let (</span><a name="loc_46_26_46_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_26_46_29&#39;)"><span class="hl_vardecl"><span class="mpre">bs0</span></span></a><span class="mpre">,</span><a name="loc_46_30_46_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_30_46_32&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">cprgGenerate</span></span><span class="mpre"> </span><a href="#loc_45_34_45_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_34_45_35&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_45_32_45_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_32_45_33&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                        </span><a name="loc_47_25_47_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_25_47_30&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.unpack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_46_26_46_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_26_46_29&#39;)"><span class="hl_varref"><span class="mpre">bs0</span></span></a><span class="mpre">
                        </span><a name="loc_48_25_48_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_25_48_29&#39;)"><span class="hl_vardecl"><span class="mpre">left</span></span></a><span class="mpre">     = (</span><a href="#loc_45_34_45_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_34_45_35&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_47_25_47_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_25_47_30&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">)
                     in if </span><a href="#loc_48_25_48_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_25_48_29&#39;)"><span class="hl_varref"><span class="mpre">left</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                        then (</span><a href="#loc_47_25_47_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_25_47_30&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">, </span><a href="#loc_46_30_46_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_30_46_32&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">)
                        else let (</span><a name="loc_51_35_51_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_35_51_39&#39;)"><span class="hl_vardecl"><span class="mpre">bend</span></span></a><span class="mpre">, </span><a name="loc_51_41_51_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_41_51_44&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_45_15_45_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_15_45_31&#39;)"><span class="hl_varref"><span class="mpre">getNonNullRandom</span></span></a><span class="mpre"> </span><a href="#loc_46_30_46_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_30_46_32&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre"> </span><a href="#loc_48_25_48_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_25_48_29&#39;)"><span class="hl_varref"><span class="mpre">left</span></span></a><span class="mpre">
                              in (</span><a href="#loc_47_25_47_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_25_47_30&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.append`</span></span><span class="mpre"> </span><a href="#loc_51_35_51_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_35_51_39&#39;)"><span class="hl_varref"><span class="mpre">bend</span></span></a><span class="mpre">, </span><a href="#loc_51_41_51_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_41_51_44&#39;)"><span class="hl_varref"><span class="mpre">g&#39;&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Produce a standard PKCS1.5 padding for signature</span></span><span class="mpre">
</span><a href="#loc_56_1_56_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_13&#39;)"><span class="mpre">padSignature</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_19_6_19_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_19_6_19_11&#39;)"><span class="hl_tyconref"><span class="mpre">Error</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_56_1_56_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_13&#39;)"><span class="hl_fundecl"><span class="mpre">padSignature</span></span></a><span class="mpre"> </span><a name="loc_56_14_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_14_56_18&#39;)"><span class="hl_vardecl"><span class="mpre">klen</span></span></a><span class="mpre"> </span><a name="loc_56_19_56_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_19_56_28&#39;)"><span class="hl_vardecl"><span class="mpre">signature</span></span></a><span class="mpre">
    | </span><a href="#loc_56_14_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_14_56_18&#39;)"><span class="hl_varref"><span class="mpre">klen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_60_9_60_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_9_60_15&#39;)"><span class="hl_varref"><span class="mpre">siglen</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_23_7_23_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_23_7_23_23&#39;)"><span class="hl_conref"><span class="mpre">SignatureTooLong</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [</span><span class="hl_varref"><span class="mpre">B.singleton</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><span class="hl_varref"><span class="mpre">B.singleton</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><a href="#loc_61_9_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_9_61_16&#39;)"><span class="hl_varref"><span class="mpre">padding</span></span></a><span class="mpre">,</span><span class="hl_varref"><span class="mpre">B.singleton</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><a href="#loc_56_19_56_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_19_56_28&#39;)"><span class="hl_varref"><span class="mpre">signature</span></span></a><span class="mpre">]
    where
        </span><a name="loc_60_9_60_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_9_60_15&#39;)"><span class="hl_vardecl"><span class="mpre">siglen</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_56_19_56_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_19_56_28&#39;)"><span class="hl_varref"><span class="mpre">signature</span></span></a><span class="mpre">
        </span><a name="loc_61_9_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_9_61_16&#39;)"><span class="hl_vardecl"><span class="mpre">padding</span></span></a><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> (</span><a href="#loc_56_14_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_14_56_18&#39;)"><span class="hl_varref"><span class="mpre">klen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_60_9_60_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_9_60_15&#39;)"><span class="hl_varref"><span class="mpre">siglen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Try to remove a standard PKCS1.5 encryption padding.</span></span><span class="mpre">
</span><a href="#loc_65_1_65_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_6&#39;)"><span class="mpre">unpad</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_19_6_19_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_19_6_19_11&#39;)"><span class="hl_tyconref"><span class="mpre">Error</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_65_1_65_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_6&#39;)"><span class="hl_fundecl"><span class="mpre">unpad</span></span></a><span class="mpre"> </span><a name="loc_65_7_65_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_7_65_13&#39;)"><span class="hl_vardecl"><span class="mpre">packed</span></span></a><span class="mpre">
    | </span><a href="#loc_72_9_72_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_23&#39;)"><span class="hl_varref"><span class="mpre">paddingSuccess</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_71_13_71_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">      = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_22_7_22_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_22_7_22_27&#39;)"><span class="hl_conref"><span class="mpre">MessageNotRecognized</span></span></a><span class="mpre">
    where
        (</span><a name="loc_69_10_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_10_69_12&#39;)"><span class="hl_vardecl"><span class="mpre">zt</span></span></a><span class="mpre">, </span><a name="loc_69_14_69_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_14_69_18&#39;)"><span class="hl_vardecl"><span class="mpre">ps0m</span></span></a><span class="mpre">)   = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><a href="#loc_65_7_65_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_7_65_13&#39;)"><span class="hl_varref"><span class="mpre">packed</span></span></a><span class="mpre">
        (</span><a name="loc_70_10_70_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_10_70_12&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a name="loc_70_14_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_14_70_16&#39;)"><span class="hl_vardecl"><span class="mpre">zm</span></span></a><span class="mpre">)     = </span><span class="hl_varref"><span class="mpre">B.span</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><a href="#loc_69_14_69_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_14_69_18&#39;)"><span class="hl_varref"><span class="mpre">ps0m</span></span></a><span class="mpre">
        (</span><a name="loc_71_10_71_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_10_71_11&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">, </span><a name="loc_71_13_71_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_13_71_14&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">)       = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_70_14_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_14_70_16&#39;)"><span class="hl_varref"><span class="mpre">zm</span></span></a><span class="mpre">
        </span><a name="loc_72_9_72_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_23&#39;)"><span class="hl_vardecl"><span class="mpre">paddingSuccess</span></span></a><span class="mpre"> = </span><a href="Crypto.PubKey.Internal.html#loc_17_1_17_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.Internal.html#loc_17_1_17_5&#39;)"><span class="hl_varref"><span class="mpre">and&#39;</span></span></a><span class="mpre"> [ </span><a href="#loc_69_10_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_10_69_12&#39;)"><span class="hl_varref"><span class="mpre">zt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\x00\x02&quot;</span></span><span class="mpre">
                              , </span><a href="#loc_71_10_71_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_10_71_11&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\x00&quot;</span></span><span class="mpre">
                              , </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_70_10_70_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_10_70_12&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">
                              ]

</span><span class="hl_comment"><span class="mpre">-- | decrypt message using the private key.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- When the decryption is not in a context where an attacker could gain</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- information from the timing of the operation, the blinder can be set to None.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If unsure always set a blinder or use decryptSafer</span></span><span class="mpre">
</span><a href="#loc_87_1_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_8&#39;)"><span class="mpre">decrypt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_15_6_15_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_15_6_15_13&#39;)"><span class="hl_tyconref"><span class="mpre">Blinder</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ optional blinder</span></span><span class="mpre">
        -&gt; </span><a href="Crypto.Types.PubKey.RSA.html#loc_60_6_60_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_60_6_60_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ RSA private key</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ cipher text</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_19_6_19_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_19_6_19_11&#39;)"><span class="hl_tyconref"><span class="mpre">Error</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_87_1_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_8&#39;)"><span class="hl_fundecl"><span class="mpre">decrypt</span></span></a><span class="mpre"> </span><a name="loc_87_9_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_9_87_16&#39;)"><span class="hl_vardecl"><span class="mpre">blinder</span></span></a><span class="mpre"> </span><a name="loc_87_17_87_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_19&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_87_20_87_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_20_87_21&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_87_20_87_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_20_87_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_71_1_71_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_71_1_71_13&#39;)"><span class="hl_varref"><span class="mpre">private_size</span></span></a><span class="mpre"> </span><a href="#loc_87_17_87_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_19&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_20_7_20_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_20_7_20_27&#39;)"><span class="hl_conref"><span class="mpre">MessageSizeIncorrect</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                       = </span><a href="#loc_65_1_65_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_6&#39;)"><span class="hl_varref"><span class="mpre">unpad</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Prim.html#loc_51_1_51_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Prim.html#loc_51_1_51_3&#39;)"><span class="hl_varref"><span class="mpre">dp</span></span></a><span class="mpre"> </span><a href="#loc_87_9_87_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_9_87_16&#39;)"><span class="hl_varref"><span class="mpre">blinder</span></span></a><span class="mpre"> </span><a href="#loc_87_17_87_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_17_87_19&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a href="#loc_87_20_87_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_20_87_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | decrypt message using the private key and by automatically generating a blinder.</span></span><span class="mpre">
</span><a href="#loc_97_1_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_13&#39;)"><span class="mpre">decryptSafer</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/PKCS15.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 17, srcSpanEndLine = 93, srcSpanEndColumn = 16}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/PKCS15.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 14, srcSpanEndLine = 93, srcSpanEndColumn = 16}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">CPRG g
             =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- ^ random generator</span></span><span class="mpre">
             -&gt; </span><a href="Crypto.Types.PubKey.RSA.html#loc_60_6_60_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_60_6_60_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ RSA private key</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ cipher text</span></span><span class="mpre">
             -&gt; (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_19_6_19_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_19_6_19_11&#39;)"><span class="hl_tyconref"><span class="mpre">Error</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_97_1_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_13&#39;)"><span class="hl_fundecl"><span class="mpre">decryptSafer</span></span></a><span class="mpre"> </span><a name="loc_97_14_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_14_97_17&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_97_18_97_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_18_97_20&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_97_21_97_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_21_97_22&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> =
    let (</span><a name="loc_98_10_98_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_10_98_17&#39;)"><span class="hl_vardecl"><span class="mpre">blinder</span></span></a><span class="mpre">, </span><a name="loc_98_19_98_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_19_98_23&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span></a><span class="mpre">) = </span><a href="Crypto.PubKey.RSA.html#loc_91_1_91_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.html#loc_91_1_91_16&#39;)"><span class="hl_varref"><span class="mpre">generateBlinder</span></span></a><span class="mpre"> </span><a href="#loc_97_14_97_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_14_97_17&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_74_1_74_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_74_1_74_10&#39;)"><span class="hl_varref"><span class="mpre">private_n</span></span></a><span class="mpre"> </span><a href="#loc_97_18_97_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_18_97_20&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">)
     in (</span><a href="#loc_87_1_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_8&#39;)"><span class="hl_varref"><span class="mpre">decrypt</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_98_10_98_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_10_98_17&#39;)"><span class="hl_varref"><span class="mpre">blinder</span></span></a><span class="mpre">) </span><a href="#loc_97_18_97_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_18_97_20&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a href="#loc_97_21_97_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_21_97_22&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">, </span><a href="#loc_98_19_98_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_19_98_23&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | encrypt a bytestring using the public key and a CPRG random generator.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the message need to be smaller than the key size - 11</span></span><span class="mpre">
</span><a href="#loc_105_1_105_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_8&#39;)"><span class="mpre">encrypt</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/PKCS15.hs&quot;, srcSpanStartLine = 104, srcSpanStartColumn = 12, srcSpanEndLine = 104, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/PKCS15.hs&quot;, srcSpanStartLine = 104, srcSpanStartColumn = 19, srcSpanEndLine = 104, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.RSA.html#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">PublicKey</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_19_6_19_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_19_6_19_11&#39;)"><span class="hl_tyconref"><span class="mpre">Error</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_105_1_105_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_8&#39;)"><span class="hl_fundecl"><span class="mpre">encrypt</span></span></a><span class="mpre"> </span><a name="loc_105_9_105_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_12&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_105_13_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_13_105_15&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_105_16_105_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_16_105_17&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = do
    case </span><a href="#loc_37_1_37_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_4&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre"> </span><a href="#loc_105_9_105_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_12&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_26_7_26_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_26_7_26_18&#39;)"><span class="hl_varref"><span class="mpre">public_size</span></span></a><span class="mpre"> </span><a href="#loc_105_13_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_13_105_15&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) </span><a href="#loc_105_16_105_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_16_105_17&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_107_14_107_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_14_107_17&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">         -&gt; (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_107_14_107_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_14_107_17&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">, </span><a href="#loc_105_9_105_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_12&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_108_16_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_16_108_18&#39;)"><span class="hl_vardecl"><span class="mpre">em</span></span></a><span class="mpre">, </span><a name="loc_108_20_108_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_20_108_24&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="Crypto.PubKey.RSA.Prim.html#loc_57_1_57_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Prim.html#loc_57_1_57_3&#39;)"><span class="hl_varref"><span class="mpre">ep</span></span></a><span class="mpre"> </span><a href="#loc_105_13_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_13_105_15&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a href="#loc_108_16_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_16_108_18&#39;)"><span class="hl_varref"><span class="mpre">em</span></span></a><span class="mpre">), </span><a href="#loc_108_20_108_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_20_108_24&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | sign message using private key, a hash and its ASN1 description</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- When the signature is not in a context where an attacker could gain</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- information from the timing of the operation, the blinder can be set to None.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If unsure always set a blinder or use signSafer</span></span><span class="mpre">
</span><a href="#loc_121_1_121_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_5&#39;)"><span class="mpre">sign</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_15_6_15_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_15_6_15_13&#39;)"><span class="hl_tyconref"><span class="mpre">Blinder</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ optional blinder</span></span><span class="mpre">
     -&gt; </span><a href="Crypto.PubKey.HashDescr.html#loc_37_6_37_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_37_6_37_15&#39;)"><span class="hl_tyconref"><span class="mpre">HashDescr</span></span></a><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ hash descriptor</span></span><span class="mpre">
     -&gt; </span><a href="Crypto.Types.PubKey.RSA.html#loc_60_6_60_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_60_6_60_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ private key</span></span><span class="mpre">
     -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ message to sign</span></span><span class="mpre">
     -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_19_6_19_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_19_6_19_11&#39;)"><span class="hl_tyconref"><span class="mpre">Error</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_121_1_121_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_5&#39;)"><span class="hl_fundecl"><span class="mpre">sign</span></span></a><span class="mpre"> </span><a name="loc_121_6_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_13&#39;)"><span class="hl_vardecl"><span class="mpre">blinder</span></span></a><span class="mpre"> </span><a name="loc_121_14_121_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_14_121_23&#39;)"><span class="hl_vardecl"><span class="mpre">hashDescr</span></span></a><span class="mpre"> </span><a name="loc_121_24_121_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_24_121_26&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_121_27_121_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_27_121_28&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="Crypto.PubKey.RSA.Prim.html#loc_51_1_51_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Prim.html#loc_51_1_51_3&#39;)"><span class="hl_varref"><span class="mpre">dp</span></span></a><span class="mpre"> </span><a href="#loc_121_6_121_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_13&#39;)"><span class="hl_varref"><span class="mpre">blinder</span></span></a><span class="mpre"> </span><a href="#loc_121_24_121_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_24_121_26&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="#loc_143_1_143_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_14&#39;)"><span class="hl_varref"><span class="mpre">makeSignature</span></span></a><span class="mpre"> </span><a href="#loc_121_14_121_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_14_121_23&#39;)"><span class="hl_varref"><span class="mpre">hashDescr</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_71_1_71_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_71_1_71_13&#39;)"><span class="hl_varref"><span class="mpre">private_size</span></span></a><span class="mpre"> </span><a href="#loc_121_24_121_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_24_121_26&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) </span><a href="#loc_121_27_121_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_27_121_28&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | sign message using the private key and by automatically generating a blinder.</span></span><span class="mpre">
</span><a href="#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_10&#39;)"><span class="mpre">signSafer</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/PKCS15.hs&quot;, srcSpanStartLine = 124, srcSpanStartColumn = 14, srcSpanEndLine = 125, srcSpanEndColumn = 13}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/PKCS15.hs&quot;, srcSpanStartLine = 125, srcSpanStartColumn = 11, srcSpanEndLine = 125, srcSpanEndColumn = 13}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">CPRG g
          =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- ^ random generator</span></span><span class="mpre">
          -&gt; </span><a href="Crypto.PubKey.HashDescr.html#loc_37_6_37_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_37_6_37_15&#39;)"><span class="hl_tyconref"><span class="mpre">HashDescr</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Hash descriptor</span></span><span class="mpre">
          -&gt; </span><a href="Crypto.Types.PubKey.RSA.html#loc_60_6_60_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_60_6_60_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ private key</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ message to sign</span></span><span class="mpre">
          -&gt; (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_19_6_19_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_19_6_19_11&#39;)"><span class="hl_tyconref"><span class="mpre">Error</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_130_1_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_10&#39;)"><span class="hl_fundecl"><span class="mpre">signSafer</span></span></a><span class="mpre"> </span><a name="loc_130_11_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_11_130_14&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_130_15_130_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_15_130_24&#39;)"><span class="hl_vardecl"><span class="mpre">hashDescr</span></span></a><span class="mpre"> </span><a name="loc_130_25_130_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_25_130_27&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_130_28_130_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_28_130_29&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> =
    let (</span><a name="loc_131_10_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_10_131_17&#39;)"><span class="hl_vardecl"><span class="mpre">blinder</span></span></a><span class="mpre">, </span><a name="loc_131_19_131_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_19_131_23&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span></a><span class="mpre">) = </span><a href="Crypto.PubKey.RSA.html#loc_91_1_91_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.html#loc_91_1_91_16&#39;)"><span class="hl_varref"><span class="mpre">generateBlinder</span></span></a><span class="mpre"> </span><a href="#loc_130_11_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_11_130_14&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_74_1_74_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_74_1_74_10&#39;)"><span class="hl_varref"><span class="mpre">private_n</span></span></a><span class="mpre"> </span><a href="#loc_130_25_130_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_25_130_27&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">)
     in (</span><a href="#loc_121_1_121_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_5&#39;)"><span class="hl_varref"><span class="mpre">sign</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_131_10_131_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_10_131_17&#39;)"><span class="hl_varref"><span class="mpre">blinder</span></span></a><span class="mpre">) </span><a href="#loc_130_15_130_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_15_130_24&#39;)"><span class="hl_varref"><span class="mpre">hashDescr</span></span></a><span class="mpre"> </span><a href="#loc_130_25_130_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_25_130_27&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a href="#loc_130_28_130_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_28_130_29&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">, </span><a href="#loc_131_19_131_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_19_131_23&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | verify message with the signed message</span></span><span class="mpre">
</span><a href="#loc_136_1_136_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_7&#39;)"><span class="mpre">verify</span></a><span class="mpre"> :: </span><a href="Crypto.PubKey.HashDescr.html#loc_37_6_37_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_37_6_37_15&#39;)"><span class="hl_tyconref"><span class="mpre">HashDescr</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.RSA.html#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">PublicKey</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_136_1_136_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_7&#39;)"><span class="hl_fundecl"><span class="mpre">verify</span></span></a><span class="mpre"> </span><a name="loc_136_8_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_8_136_17&#39;)"><span class="hl_vardecl"><span class="mpre">hashDescr</span></span></a><span class="mpre"> </span><a name="loc_136_18_136_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_18_136_20&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_136_21_136_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_21_136_22&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_136_23_136_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_23_136_25&#39;)"><span class="hl_vardecl"><span class="mpre">sm</span></span></a><span class="mpre"> =
    case </span><a href="#loc_143_1_143_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_14&#39;)"><span class="hl_varref"><span class="mpre">makeSignature</span></span></a><span class="mpre"> </span><a href="#loc_136_8_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_8_136_17&#39;)"><span class="hl_varref"><span class="mpre">hashDescr</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_26_7_26_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_26_7_26_18&#39;)"><span class="hl_varref"><span class="mpre">public_size</span></span></a><span class="mpre"> </span><a href="#loc_136_18_136_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_18_136_20&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) </span><a href="#loc_136_21_136_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_21_136_22&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> _  -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_139_15_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_139_15_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> (</span><a href="Crypto.PubKey.RSA.Prim.html#loc_57_1_57_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Prim.html#loc_57_1_57_3&#39;)"><span class="hl_varref"><span class="mpre">ep</span></span></a><span class="mpre"> </span><a href="#loc_136_18_136_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_18_136_20&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a href="#loc_136_23_136_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_23_136_25&#39;)"><span class="hl_varref"><span class="mpre">sm</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">{- makeSignature for sign and verify -}</span></span><span class="mpre">
</span><a href="#loc_143_1_143_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_14&#39;)"><span class="mpre">makeSignature</span></a><span class="mpre"> :: </span><a href="Crypto.PubKey.HashDescr.html#loc_37_6_37_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_37_6_37_15&#39;)"><span class="hl_tyconref"><span class="mpre">HashDescr</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_19_6_19_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_19_6_19_11&#39;)"><span class="hl_tyconref"><span class="mpre">Error</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_143_1_143_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_14&#39;)"><span class="hl_fundecl"><span class="mpre">makeSignature</span></span></a><span class="mpre"> </span><a name="loc_143_15_143_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_15_143_24&#39;)"><span class="hl_vardecl"><span class="mpre">hashDescr</span></span></a><span class="mpre"> </span><a name="loc_143_25_143_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_25_143_29&#39;)"><span class="hl_vardecl"><span class="mpre">klen</span></span></a><span class="mpre"> </span><a name="loc_143_30_143_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_30_143_31&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_56_1_56_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_13&#39;)"><span class="hl_varref"><span class="mpre">padSignature</span></span></a><span class="mpre"> </span><a href="#loc_143_25_143_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_25_143_29&#39;)"><span class="hl_varref"><span class="mpre">klen</span></span></a><span class="mpre"> </span><a href="#loc_144_11_144_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_11_144_20&#39;)"><span class="hl_varref"><span class="mpre">signature</span></span></a><span class="mpre">
    where </span><a name="loc_144_11_144_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_11_144_20&#39;)"><span class="hl_vardecl"><span class="mpre">signature</span></span></a><span class="mpre"> = (</span><a href="Crypto.PubKey.HashDescr.html#loc_38_30_38_42" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_38_30_38_42&#39;)"><span class="hl_varref"><span class="mpre">digestToASN1</span></span></a><span class="mpre"> </span><a href="#loc_143_15_143_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_15_143_24&#39;)"><span class="hl_varref"><span class="mpre">hashDescr</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="Crypto.PubKey.HashDescr.html#loc_37_30_37_42" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.HashDescr.html#loc_37_30_37_42&#39;)"><span class="hl_varref"><span class="mpre">hashFunction</span></span></a><span class="mpre"> </span><a href="#loc_143_15_143_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_15_143_24&#39;)"><span class="hl_varref"><span class="mpre">hashDescr</span></span></a><span class="mpre">) </span><a href="#loc_143_30_143_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_30_143_31&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
</span></div></body></html>