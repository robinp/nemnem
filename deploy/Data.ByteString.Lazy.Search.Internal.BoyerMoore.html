<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}
{-# OPTIONS_HADDOCK hide, prune #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module         : Data.ByteString.Lazy.Search.Internal.BoyerMoore</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright      : Daniel Fischer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                  Chris Kuklewicz</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Licence        : BSD3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer     : Daniel Fischer &lt;daniel.is.fischer@googlemail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability      : Provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability    : non-portable (BangPatterns)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Fast overlapping Boyer-Moore search of both strict and lazy</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;S.ByteString&#39; values. Breaking, splitting and replacing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- using the Boyer-Moore algorithm.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Descriptions of the algorithm can be found at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://www-igm.univ-mlv.fr/~lecroq/string/node14.html#SECTION00140&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://en.wikipedia.org/wiki/Boyer-Moore_string_search_algorithm&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Original authors: Daniel Fischer (daniel.is.fischer at googlemail.com) and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Chris Kuklewicz (haskell at list.mightyreason.com).</span></span><span class="mpre">

module Data.ByteString.Lazy.Search.Internal.BoyerMoore (
                                           matchLL
                                         , matchSL

                                           </span><span class="hl_comment"><span class="mpre">--  Non-overlapping</span></span><span class="mpre">
                                         , matchNOL

                                            </span><span class="hl_comment"><span class="mpre">--  Replacing substrings</span></span><span class="mpre">
                                            </span><span class="hl_comment"><span class="mpre">-- replacing</span></span><span class="mpre">
                                         , replaceAllL
                                            </span><span class="hl_comment"><span class="mpre">--  Breaking on substrings</span></span><span class="mpre">
                                            </span><span class="hl_comment"><span class="mpre">-- breaking</span></span><span class="mpre">
                                         , breakSubstringL
                                         , breakAfterL
                                         , breakFindAfterL
                                            </span><span class="hl_comment"><span class="mpre">--  Splitting on substrings</span></span><span class="mpre">
                                            </span><span class="hl_comment"><span class="mpre">-- splitting</span></span><span class="mpre">
                                         , splitKeepEndL
                                         , splitKeepFrontL
                                         , splitDropL
                                         ) where


import Data.ByteString.Search.Internal.Utils
                (</span><a href="Data.ByteString.Search.Internal.Utils.html#loc_127_1_127_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_127_1_127_7&#39;)"><span class="mpre">occurs</span></a><span class="mpre">, </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_180_1_180_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_180_1_180_11&#39;)"><span class="mpre">suffShifts</span></a><span class="mpre">, </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_290_1_290_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_290_1_290_6&#39;)"><span class="mpre">ldrop</span></a><span class="mpre">, </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7&#39;)"><span class="mpre">lsplit</span></a><span class="mpre">, </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_338_1_338_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_338_1_338_5&#39;)"><span class="mpre">keep</span></a><span class="mpre">, </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_326_1_326_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_326_1_326_8&#39;)"><span class="mpre">release</span></a><span class="mpre">, </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_285_1_285_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_285_1_285_10&#39;)"><span class="mpre">strictify</span></a><span class="mpre">)
import Data.ByteString.Search.Substitution

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/Internal/BoyerMoore.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 18, srcSpanEndLine = 51, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/Internal/BoyerMoore.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 18, srcSpanEndLine = 52, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import Data.ByteString.Unsafe (</span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="mpre">unsafeIndex</span></a><span class="mpre">)

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/Internal/BoyerMoore.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 8, srcSpanEndLine = 55, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.Array.Base&quot;"><span class="mpre">Data.Array.Base</span></span><span class="mpre"> (unsafeAt)

import Data.Word (Word8)
import Data.Int (</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="mpre">Int64</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- overview</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module exports three search functions for searching in lazy</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ByteSrings, one for searching non-overlapping occurrences of a strict</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- pattern, and one each for searchin overlapping occurrences of a strict</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- resp. lazy pattern. The common base name is @match@, the suffix</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- indicates the type of search. These functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- return (for a non-empty pattern) a list of all the indices of the target</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- string where an occurrence of the pattern begins, if some occurrences</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- overlap, all starting indices are reported. The list is produced lazily,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- so not necessarily the entire target string is searched.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The behaviour of these functions when given an empty pattern has changed.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Formerly, the @matchXY@ functions returned an empty list then, now it&#39;s</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @[0 .. &#39;length&#39; target]@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Newly added are functions to replace all (non-overlapping) occurrences</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of a pattern within a string, functions to break ByteStrings at the first</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- occurrence of a pattern and functions to split ByteStrings at each</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- occurrence of a pattern. None of these functions does copying, so they</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- don&#39;t introduce large memory overhead.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Internally, a lazy pattern is always converted to a strict ByteString,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which is necessary for an efficient implementation of the algorithm.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The limit this imposes on the length of the pattern is probably</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- irrelevant in practice, but perhaps it should be mentioned.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This also means that the @matchL*@ functions are mere convenience wrappers.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Except for the initial &#39;strictify&#39;ing, there&#39;s no difference between lazy</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and strict patterns, they call the same workers. There is, however, a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- difference between strict and lazy target strings.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For the new functions, no such wrappers are provided, you have to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;strictify&#39; lazy patterns yourself.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- caution</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- When working with a lazy target string, the relation between the pattern</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- length and the chunk size can play a big r&amp;#244;le.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Crossing chunk boundaries is relatively expensive, so when that becomes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a frequent occurrence, as may happen when the pattern length is close</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to or larger than the chunk size, performance is likely to degrade.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If it is needed, steps can be taken to ameliorate that effect, but unless</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- entirely separate functions are introduced, that would hurt the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- performance for the more common case of patterns much shorter than</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the default chunk size.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- performance</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In general, the Boyer-Moore algorithm is the most efficient method to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- search for a pattern inside a string, so most of the time, you&#39;ll want</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to use the functions of this module, hence this is where the most work</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- has gone. Very short patterns are an exception to this, for those you</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- should consider using a finite automaton</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (&quot;Data.ByteString.Search.DFA.Array&quot;). That is also often the better</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- choice for searching longer periodic patterns in a lazy ByteString</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with many matches.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Operating on a strict target string is mostly faster than on a lazy</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- target string, but the difference is usually small (according to my</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- tests).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The known exceptions to this rule of thumb are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [long targets] Then the smaller memory footprint of a lazy target often</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- gives (much) better performance.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [high number of matches] When there are very many matches, strict target</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- strings are much faster, especially if the pattern is periodic.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If both conditions hold, either may outweigh the other.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- complexity</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Preprocessing the pattern is /O/(@patternLength@ + &amp;#963;) in time and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- space (&amp;#963; is the alphabet size, 256 here) for all functions.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The time complexity of the searching phase for @matchXY@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is /O/(@targetLength@ \/ @patternLength@) in the best case.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For non-periodic patterns, the worst case complexity is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /O/(@targetLength@), but for periodic patterns, the worst case complexity</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is /O/(@targetLength@ * @patternLength@) for the original Boyer-Moore</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- algorithm.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The searching functions in this module now contain a modification which</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- drastically improves the performance for periodic patterns.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- I believe that for strict target strings, the worst case is now</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /O/(@targetLength@) also for periodic patterns and for lazy target strings,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- my semi-educated guess is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /O/(@targetLength@ * (1 + @patternLength@ \/ @chunkSize@)).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- I may be very wrong, though.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The other functions don&#39;t have to deal with possible overlapping</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- patterns, hence the worst case complexity for the processing phase</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is /O/(@targetLength@) (respectively /O/(@firstIndex + patternLength@)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for the breaking functions if the pattern occurs).</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- currying</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- These functions can all be usefully curried. Given only a pattern</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the curried version will compute the supporting lookup tables only</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- once, allowing for efficient re-use.  Similarly, the curried</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;matchLL&#39; and &#39;matchLS&#39; will compute the concatenated pattern only</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- once.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- overflow</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The current code uses @Int@ to keep track of the locations in the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- target string.  If the length of the pattern plus the length of any</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- strict chunk of the target string is greater than</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @&#39;maxBound&#39; :: &#39;Int&#39;@ then this will overflow causing an error.  We</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- try to detect this and call &#39;error&#39; before a segfault occurs.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                 Wrappers                                 --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- matching</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- These functions find the indices of all (possibly overlapping)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- occurrences of a pattern in a target string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If the pattern is empty, the result is @[0 .. length target]@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If the pattern is much shorter than the target string</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and the pattern does not occur very near the beginning of the target,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; not . null $ matchSS pattern target</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is a much more efficient version of &#39;S.isInfixOf&#39;.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;matchLL&#39;@ finds the starting indices of all possibly overlapping</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   occurrences of the pattern in the target string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   It is a simple wrapper for &#39;Data.ByteString.Lazy.Search.indices&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   If the pattern is empty, the result is @[0 .. &#39;length&#39; target]@.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="mpre">matchLL</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="mpre">matchLL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Lazy pattern</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Lazy target string</span></span><span class="mpre">
        -&gt; [</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">]          </span><span class="hl_comment"><span class="mpre">-- ^ Offsets of matches</span></span><span class="mpre">
</span><a name="loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="hl_fundecl"><span class="mpre">matchLL</span></span></a><span class="mpre"> </span><a name="loc_194_9_194_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_12&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_196_5_196_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_5_196_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    </span><a name="loc_196_5_196_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_5_196_11&#39;)"><span class="hl_vardecl"><span class="mpre">search</span></span></a><span class="mpre">  = </span><a href="#loc_387_1_387_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_13&#39;)"><span class="hl_varref"><span class="mpre">lazySearcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> (</span><a href="Data.ByteString.Search.Internal.Utils.html#loc_285_1_285_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_285_1_285_10&#39;)"><span class="hl_varref"><span class="mpre">strictify</span></span></a><span class="mpre"> </span><a href="#loc_194_9_194_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;matchSL&#39;@ finds the starting indices of all possibly overlapping</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   occurrences of the pattern in the target string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   It is an alias for &#39;Data.ByteString.Lazy.Search.indices&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   If the pattern is empty, the result is @[0 .. &#39;length&#39; target]@.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_206_1_206_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_8&#39;)"><span class="mpre">matchSL</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_206_1_206_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_8&#39;)"><span class="mpre">matchSL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Lazy target string</span></span><span class="mpre">
        -&gt; [</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">]          </span><span class="hl_comment"><span class="mpre">-- ^ Offsets of matches</span></span><span class="mpre">
</span><a name="loc_206_1_206_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_8&#39;)"><span class="hl_fundecl"><span class="mpre">matchSL</span></span></a><span class="mpre"> </span><a name="loc_206_9_206_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_12&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_208_5_208_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_5_208_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    </span><a name="loc_208_5_208_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_5_208_11&#39;)"><span class="hl_vardecl"><span class="mpre">search</span></span></a><span class="mpre"> = </span><a href="#loc_387_1_387_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_13&#39;)"><span class="hl_varref"><span class="mpre">lazySearcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_206_9_206_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;matchNOL&#39;@ finds the indices of all non-overlapping occurrences</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   of the pattern in the lazy target string.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_216_1_216_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_9&#39;)"><span class="mpre">matchNOL</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_216_1_216_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_9&#39;)"><span class="mpre">matchNOL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Lazy target string</span></span><span class="mpre">
         -&gt; [</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">]         </span><span class="hl_comment"><span class="mpre">-- ^ Offsets of matches</span></span><span class="mpre">
</span><a name="loc_216_1_216_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_1_216_9&#39;)"><span class="hl_fundecl"><span class="mpre">matchNOL</span></span></a><span class="mpre"> </span><a name="loc_216_10_216_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_13&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_218_5_218_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_5_218_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    </span><a name="loc_218_5_218_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_5_218_11&#39;)"><span class="hl_vardecl"><span class="mpre">search</span></span></a><span class="mpre"> = </span><a href="#loc_387_1_387_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_13&#39;)"><span class="hl_varref"><span class="mpre">lazySearcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_216_10_216_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_10_216_13&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- replacing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   These functions replace all (non-overlapping) occurrences of a pattern</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   in the target string. If some occurrences overlap, the earliest is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   replaced and replacing continues at the index after the replaced</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   occurrence, for example</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; replaceAllL \&quot;ana\&quot; \&quot;olog\&quot; \&quot;banana\&quot; == \&quot;bologna\&quot;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; replaceAllS \&quot;abacab\&quot; \&quot;u\&quot; \&quot;abacabacabacab\&quot; == \&quot;uacu\&quot;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; replaceAllS \&quot;aa\&quot; \&quot;aaa\&quot; \&quot;aaaa\&quot; == \&quot;aaaaaa\&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Equality of pattern and substitution is not checked, but</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; pat == sub =&gt; &#39;strictify&#39; (replaceAllS pat sub str) == str,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; pat == sub =&gt; replaceAllL pat sub str == str.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   The result is a lazily generated lazy ByteString, the first chunks will</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   generally be available before the entire target has been scanned.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   If the pattern is empty, but not the substitution, the result is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   equivalent to @&#39;cycle&#39; sub@.</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_247_1_247_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_12&#39;)"><span class="mpre">replaceAllL</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_247_1_247_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_12&#39;)"><span class="mpre">replaceAllL</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/Internal/BoyerMoore.hs&quot;, srcSpanStartLine = 242, srcSpanStartColumn = 16, srcSpanEndLine = 243, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/Internal/BoyerMoore.hs&quot;, srcSpanStartLine = 243, srcSpanStartColumn = 13, srcSpanEndLine = 243, srcSpanEndColumn = 15}]}) (ClassA (SrcSpanInfo {srcInf"><span class="mpre">Substitution rep
            =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Pattern to replace</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyvar"><span class="mpre">rep</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ Substitution string</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Target string</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Lazy result</span></span><span class="mpre">
</span><a name="loc_247_1_247_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_12&#39;)"><span class="hl_fundecl"><span class="mpre">replaceAllL</span></span></a><span class="mpre"> </span><a name="loc_247_13_247_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_13_247_16&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_247_13_247_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_13_247_16&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> = \</span><a name="loc_248_21_248_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_21_248_24&#39;)"><span class="hl_vardecl"><span class="mpre">sub</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Search.Substitution.html#loc_34_5_34_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Substitution.html#loc_34_5_34_17&#39;)"><span class="hl_varref"><span class="mpre">prependCycle</span></span></a><span class="mpre"> </span><a href="#loc_248_21_248_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_21_248_24&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_247_13_247_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_13_247_16&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> =
      let </span><a name="loc_250_11_250_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_11_250_18&#39;)"><span class="hl_vardecl"><span class="mpre">breaker</span></span></a><span class="mpre"> = </span><a href="#loc_585_1_585_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_1_585_10&#39;)"><span class="hl_varref"><span class="mpre">lazyBreak</span></span></a><span class="mpre"> </span><a href="#loc_247_13_247_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_13_247_16&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
          </span><a name="loc_251_11_251_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_11_251_15&#39;)"><span class="hl_fundecl"><span class="mpre">repl</span></span></a><span class="mpre"> </span><a name="loc_251_16_251_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_16_251_21&#39;)"><span class="hl_vardecl"><span class="mpre">subst</span></span></a><span class="mpre"> </span><a name="loc_251_22_251_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_22_251_26&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_251_22_251_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_22_251_26&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre"> = []
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
                case </span><a href="#loc_250_11_250_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_11_250_18&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a href="#loc_251_22_251_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_22_251_26&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre"> of
                  (</span><a name="loc_255_20_255_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_20_255_23&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a name="loc_255_25_255_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_25_255_29&#39;)"><span class="hl_vardecl"><span class="mpre">mtch</span></span></a><span class="mpre">) -&gt;
                        </span><a href="#loc_255_20_255_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_20_255_23&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> case </span><a href="#loc_255_25_255_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_25_255_29&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre"> of
                                [] -&gt; []
                                _  -&gt; </span><a href="#loc_251_16_251_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_16_251_21&#39;)"><span class="hl_varref"><span class="mpre">subst</span></span></a><span class="mpre"> (</span><a href="#loc_251_11_251_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_11_251_15&#39;)"><span class="hl_varref"><span class="mpre">repl</span></span></a><span class="mpre"> </span><a href="#loc_251_16_251_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_16_251_21&#39;)"><span class="hl_varref"><span class="mpre">subst</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Search.Internal.Utils.html#loc_290_1_290_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_290_1_290_6&#39;)"><span class="hl_varref"><span class="mpre">ldrop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_255_25_255_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_25_255_29&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre">))
      in \</span><a name="loc_259_11_259_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_11_259_14&#39;)"><span class="hl_vardecl"><span class="mpre">sub</span></span></a><span class="mpre"> -&gt; let </span><a name="loc_259_22_259_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_22_259_27&#39;)"><span class="hl_vardecl"><span class="mpre">repl1</span></span></a><span class="mpre"> = </span><a href="#loc_251_11_251_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_11_251_15&#39;)"><span class="hl_varref"><span class="mpre">repl</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Search.Substitution.html#loc_23_5_23_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Substitution.html#loc_23_5_23_17&#39;)"><span class="hl_varref"><span class="mpre">substitution</span></span></a><span class="mpre"> </span><a href="#loc_259_11_259_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_11_259_14&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="mpre">)
                 in </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_259_22_259_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_22_259_27&#39;)"><span class="hl_varref"><span class="mpre">repl1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
      let </span><a name="loc_262_11_262_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_11_262_15&#39;)"><span class="hl_vardecl"><span class="mpre">repl</span></span></a><span class="mpre"> = </span><a href="#loc_803_1_803_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_803_1_803_9&#39;)"><span class="hl_varref"><span class="mpre">lazyRepl</span></span></a><span class="mpre"> </span><a href="#loc_247_13_247_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_13_247_16&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
      in \</span><a name="loc_263_11_263_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_11_263_14&#39;)"><span class="hl_vardecl"><span class="mpre">sub</span></span></a><span class="mpre"> -&gt; let </span><a name="loc_263_22_263_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_22_263_27&#39;)"><span class="hl_vardecl"><span class="mpre">repl1</span></span></a><span class="mpre"> = </span><a href="#loc_262_11_262_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_11_262_15&#39;)"><span class="hl_varref"><span class="mpre">repl</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Search.Substitution.html#loc_23_5_23_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Substitution.html#loc_23_5_23_17&#39;)"><span class="hl_varref"><span class="mpre">substitution</span></span></a><span class="mpre"> </span><a href="#loc_263_11_263_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_11_263_14&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="mpre">)
                 in </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_263_22_263_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_22_263_27&#39;)"><span class="hl_varref"><span class="mpre">repl1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- breaking</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Break a string on a pattern. The first component of the result</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- contains the prefix of the string before the first occurrence of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- pattern, the second component contains the remainder.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The following relations hold:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; breakSubstringX \&quot;\&quot; str = (\&quot;\&quot;, str)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; not (pat `isInfixOf` str) == null (snd $ breakSunbstringX pat str)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; True == case breakSubstringX pat str of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          (x, y) -&gt; not (pat `isInfixOf` x)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;                       &amp;&amp; (null y || pat `isPrefixOf` y)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The analogous function for a lazy target string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   The first component is generated lazily, so parts of it can be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   available before the pattern is detected (or found to be absent).</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_287_1_287_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_1_287_16&#39;)"><span class="mpre">breakSubstringL</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_287_1_287_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_1_287_16&#39;)"><span class="mpre">breakSubstringL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Pattern to break on</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ String to break up</span></span><span class="mpre">
                -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">)
                    </span><span class="hl_comment"><span class="mpre">-- ^ Prefix and remainder of broken string</span></span><span class="mpre">
</span><a name="loc_287_1_287_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_1_287_16&#39;)"><span class="hl_fundecl"><span class="mpre">breakSubstringL</span></span></a><span class="mpre"> </span><a name="loc_287_17_287_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_17_287_20&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_290_5_290_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_5_290_12&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    </span><a name="loc_289_5_289_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_5_289_9&#39;)"><span class="hl_vardecl"><span class="mpre">lbrk</span></span></a><span class="mpre"> = </span><a href="#loc_585_1_585_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_1_585_10&#39;)"><span class="hl_varref"><span class="mpre">lazyBreak</span></span></a><span class="mpre"> </span><a href="#loc_287_17_287_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_17_287_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_290_5_290_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_5_290_12&#39;)"><span class="hl_fundecl"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a name="loc_290_13_290_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_13_290_17&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> = let (</span><a name="loc_290_25_290_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_25_290_26&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">, </span><a name="loc_290_28_290_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_28_290_29&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_289_5_289_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_5_289_9&#39;)"><span class="hl_varref"><span class="mpre">lbrk</span></span></a><span class="mpre"> </span><a href="#loc_290_13_290_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_13_290_17&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">
                   in (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_290_25_290_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_25_290_26&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_290_28_290_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_28_290_29&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)

</span><a href="#loc_296_1_296_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_1_296_12&#39;)"><span class="mpre">breakAfterL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
            -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">)
</span><a name="loc_296_1_296_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_1_296_12&#39;)"><span class="hl_fundecl"><span class="mpre">breakAfterL</span></span></a><span class="mpre"> </span><a name="loc_296_13_296_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_13_296_16&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_296_13_296_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_13_296_16&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">      = \</span><a name="loc_297_24_297_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_24_297_27&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">, </span><a href="#loc_297_24_297_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_24_297_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)
</span><a href="#loc_296_1_296_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_1_296_12&#39;)"><span class="hl_fundecl"><span class="mpre">breakAfterL</span></span></a><span class="mpre"> </span><a name="loc_298_13_298_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_13_298_16&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">     = </span><a href="#loc_302_5_302_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_5_302_13&#39;)"><span class="hl_varref"><span class="mpre">breaker&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    !</span><a name="loc_300_6_300_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_6_300_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_298_13_298_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_13_298_16&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_301_5_301_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_5_301_12&#39;)"><span class="hl_vardecl"><span class="mpre">breaker</span></span></a><span class="mpre"> = </span><a href="#loc_585_1_585_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_1_585_10&#39;)"><span class="hl_varref"><span class="mpre">lazyBreak</span></span></a><span class="mpre"> </span><a href="#loc_298_13_298_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_13_298_16&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_302_5_302_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_5_302_13&#39;)"><span class="hl_fundecl"><span class="mpre">breaker&#39;</span></span></a><span class="mpre"> </span><a name="loc_302_14_302_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_14_302_18&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> =
      let (</span><a name="loc_303_12_303_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_12_303_15&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a name="loc_303_17_303_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_17_303_21&#39;)"><span class="hl_vardecl"><span class="mpre">mtch</span></span></a><span class="mpre">) = </span><a href="#loc_301_5_301_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_5_301_12&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a href="#loc_302_14_302_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_14_302_18&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">
          (</span><a name="loc_304_12_304_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_12_304_14&#39;)"><span class="hl_vardecl"><span class="mpre">pl</span></span></a><span class="mpre">, </span><a name="loc_304_16_304_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_16_304_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_303_17_303_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_17_303_21&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre"> then ([],[]) else </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7&#39;)"><span class="hl_varref"><span class="mpre">lsplit</span></span></a><span class="mpre"> </span><a href="#loc_300_6_300_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_6_300_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><a href="#loc_303_17_303_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_17_303_21&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre">
      in (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> (</span><a href="#loc_303_12_303_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_12_303_15&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_304_12_304_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_12_304_14&#39;)"><span class="hl_varref"><span class="mpre">pl</span></span></a><span class="mpre">), </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_304_16_304_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_16_304_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)

</span><a href="#loc_310_1_310_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_1_310_16&#39;)"><span class="mpre">breakFindAfterL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
                -&gt; ((</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">), </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)
</span><a name="loc_310_1_310_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_1_310_16&#39;)"><span class="hl_fundecl"><span class="mpre">breakFindAfterL</span></span></a><span class="mpre"> </span><a name="loc_310_17_310_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_17_310_20&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_310_17_310_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_17_310_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">  = \</span><a name="loc_311_20_311_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_20_311_23&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> -&gt; ((</span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">, </span><a href="#loc_311_20_311_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_20_311_23&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">), </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)
</span><a href="#loc_310_1_310_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_1_310_16&#39;)"><span class="hl_fundecl"><span class="mpre">breakFindAfterL</span></span></a><span class="mpre"> </span><a name="loc_312_17_312_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_17_312_20&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_316_5_316_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_5_316_13&#39;)"><span class="hl_varref"><span class="mpre">breaker&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    !</span><a name="loc_314_6_314_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_6_314_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_312_17_312_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_17_312_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_315_5_315_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_5_315_12&#39;)"><span class="hl_vardecl"><span class="mpre">breaker</span></span></a><span class="mpre"> = </span><a href="#loc_585_1_585_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_1_585_10&#39;)"><span class="hl_varref"><span class="mpre">lazyBreak</span></span></a><span class="mpre"> </span><a href="#loc_312_17_312_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_17_312_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_316_5_316_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_5_316_13&#39;)"><span class="hl_fundecl"><span class="mpre">breaker&#39;</span></span></a><span class="mpre"> </span><a name="loc_316_14_316_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_14_316_18&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> =
      let (</span><a name="loc_317_12_317_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_12_317_15&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a name="loc_317_17_317_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_17_317_21&#39;)"><span class="hl_vardecl"><span class="mpre">mtch</span></span></a><span class="mpre">) = </span><a href="#loc_315_5_315_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_5_315_12&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a href="#loc_316_14_316_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_14_316_18&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">
          (</span><a name="loc_318_12_318_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_12_318_14&#39;)"><span class="hl_vardecl"><span class="mpre">pl</span></span></a><span class="mpre">, </span><a name="loc_318_16_318_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_16_318_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_317_17_317_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_17_317_21&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre"> then ([],[]) else </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7&#39;)"><span class="hl_varref"><span class="mpre">lsplit</span></span></a><span class="mpre"> </span><a href="#loc_314_6_314_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_6_314_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><a href="#loc_317_17_317_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_17_317_21&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre">
      in ((</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> (</span><a href="#loc_317_12_317_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_12_317_15&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_318_12_318_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_12_318_14&#39;)"><span class="hl_varref"><span class="mpre">pl</span></span></a><span class="mpre">), </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_318_16_318_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_16_318_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">), </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_317_17_317_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_17_317_21&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- splitting</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- These functions implement various splitting strategies.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If the pattern to split on is empty, all functions return an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- infinite list of empty ByteStrings.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Otherwise, the names are rather self-explanatory.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For nonempty patterns, the following relations hold:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; concat (splitKeepXY pat str) == str</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; concat (&#39;Data.List.intersperse&#39; pat (splitDropX pat str)) == str.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- All fragments except possibly the last in the result of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @splitKeepEndX pat@ end with @pat@, none of the fragments contains</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- more than one occurrence of @pat@ or is empty.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- All fragments except possibly the first in the result of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @splitKeepFrontX pat@ begin with @pat@, none of the fragments</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- contains more than one occurrence of @patq or is empty.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; splitDropX pat str == map dropPat (splitKeepFrontX pat str)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;   where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;     patLen = length pat</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;     dropPat frag</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;        | pat `isPrefixOf` frag = drop patLen frag</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;        | otherwise             = frag</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- but @splitDropX@ is a little more efficient than that.</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_355_1_355_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_1_355_14&#39;)"><span class="mpre">splitKeepEndL</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_355_1_355_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_1_355_14&#39;)"><span class="mpre">splitKeepEndL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Pattern to split on</span></span><span class="mpre">
              -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ String to split</span></span><span class="mpre">
              -&gt; [</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">]  </span><span class="hl_comment"><span class="mpre">-- ^ List of fragments</span></span><span class="mpre">
</span><a name="loc_355_1_355_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_1_355_14&#39;)"><span class="hl_fundecl"><span class="mpre">splitKeepEndL</span></span></a><span class="mpre"> </span><a name="loc_355_15_355_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_15_355_18&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_355_15_355_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_15_355_18&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     =
      let </span><a name="loc_358_11_358_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_11_358_19&#39;)"><span class="hl_vardecl"><span class="mpre">splitter</span></span></a><span class="mpre"> = </span><a href="#loc_719_1_719_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_719_1_719_17&#39;)"><span class="hl_varref"><span class="mpre">lazySplitKeepEnd</span></span></a><span class="mpre"> </span><a href="#loc_355_15_355_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_15_355_18&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
      in  </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_358_11_358_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_11_358_19&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_365_1_365_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_16&#39;)"><span class="mpre">splitKeepFrontL</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_365_1_365_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_16&#39;)"><span class="mpre">splitKeepFrontL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Pattern to split on</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ String to split</span></span><span class="mpre">
                -&gt; [</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">]  </span><span class="hl_comment"><span class="mpre">-- ^ List of fragments</span></span><span class="mpre">
</span><a name="loc_365_1_365_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_16&#39;)"><span class="hl_fundecl"><span class="mpre">splitKeepFrontL</span></span></a><span class="mpre"> </span><a name="loc_365_17_365_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_17_365_20&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_365_17_365_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_17_365_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     =
      let </span><a name="loc_368_11_368_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_11_368_19&#39;)"><span class="hl_vardecl"><span class="mpre">splitter</span></span></a><span class="mpre"> = </span><a href="#loc_697_1_697_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_697_1_697_19&#39;)"><span class="hl_varref"><span class="mpre">lazySplitKeepFront</span></span></a><span class="mpre"> </span><a href="#loc_365_17_365_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_17_365_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
      in  </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_368_11_368_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_11_368_19&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">


</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_376_1_376_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_11&#39;)"><span class="mpre">splitDropL</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_376_1_376_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_11&#39;)"><span class="mpre">splitDropL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Pattern to split on</span></span><span class="mpre">
           -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ String to split</span></span><span class="mpre">
           -&gt; [</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">]  </span><span class="hl_comment"><span class="mpre">-- ^ List of fragments</span></span><span class="mpre">
</span><a name="loc_376_1_376_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_11&#39;)"><span class="hl_fundecl"><span class="mpre">splitDropL</span></span></a><span class="mpre"> </span><a name="loc_376_12_376_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_12_376_15&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_376_12_376_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_12_376_15&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     =
      let </span><a name="loc_379_11_379_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_11_379_19&#39;)"><span class="hl_vardecl"><span class="mpre">splitter</span></span></a><span class="mpre"> = </span><a href="#loc_734_1_734_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_1_734_14&#39;)"><span class="hl_varref"><span class="mpre">lazySplitDrop</span></span></a><span class="mpre"> </span><a href="#loc_376_12_376_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_12_376_15&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
      in </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_379_11_379_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_11_379_19&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                             Search Functions                             --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_387_1_387_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_13&#39;)"><span class="mpre">lazySearcher</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; [</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">]
</span><a name="loc_387_1_387_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_13&#39;)"><span class="hl_fundecl"><span class="mpre">lazySearcher</span></span></a><span class="mpre"> _ !</span><a name="loc_387_17_387_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_17_387_20&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_387_17_387_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_17_387_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">        =
      let </span><a name="loc_389_11_389_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_11_389_14&#39;)"><span class="hl_fundecl"><span class="mpre">zgo</span></span></a><span class="mpre"> !</span><a name="loc_389_16_389_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_16_389_21&#39;)"><span class="hl_vardecl"><span class="mpre">prior</span></span></a><span class="mpre"> [] = [</span><a href="#loc_389_16_389_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_16_389_21&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre">]
          </span><a href="#loc_389_11_389_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_11_389_14&#39;)"><span class="hl_fundecl"><span class="mpre">zgo</span></span></a><span class="mpre"> </span><a name="loc_390_15_390_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_15_390_20&#39;)"><span class="hl_vardecl"><span class="mpre">prior</span></span></a><span class="mpre"> (!</span><a name="loc_390_23_390_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_23_390_26&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_390_29_390_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_29_390_33&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) =
              let !</span><a name="loc_391_20_391_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_20_391_21&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_390_23_390_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_23_390_26&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
                  !</span><a name="loc_392_20_392_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_20_392_26&#39;)"><span class="hl_vardecl"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_390_15_390_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_15_390_20&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_391_20_391_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_20_391_21&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
              in [</span><a href="#loc_390_15_390_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_15_390_20&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_393_44_393_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_44_393_45&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> | </span><a name="loc_393_44_393_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_44_393_45&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> &lt;- </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/Internal/BoyerMoore.hs&quot;, srcSpanStartLine = 393, srcSpanStartColumn = 49, srcSpanEndLine = 393, srcSpanEndColumn = 59}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/Internal/BoyerMoore.hs&quot;, srcSpanStartLine = 393, srcSpanStartColumn = 49, srcSpanEndLine = 393, srcSpanEndColumn = 50},SrcSpan {srcSpanFilename = &quot;/"><span class="mpre">[0 .. l-1]</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_389_11_389_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_11_389_14&#39;)"><span class="hl_varref"><span class="mpre">zgo</span></span></a><span class="mpre"> </span><a href="#loc_392_20_392_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_20_392_26&#39;)"><span class="hl_varref"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> </span><a href="#loc_390_29_390_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_29_390_33&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
      in </span><a href="#loc_389_11_389_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_11_389_14&#39;)"><span class="hl_varref"><span class="mpre">zgo</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_387_17_387_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_17_387_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> =
      let !</span><a name="loc_396_12_396_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_12_396_13&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.head</span></span><span class="mpre"> </span><a href="#loc_387_17_387_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_17_387_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
          </span><a name="loc_397_11_397_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_11_397_15&#39;)"><span class="hl_vardecl"><span class="mpre">ixes</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.elemIndices</span></span><span class="mpre"> </span><a href="#loc_396_12_396_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_12_396_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">
          </span><a name="loc_398_11_398_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_11_398_13&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> _ [] = []
          </span><a href="#loc_398_11_398_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_11_398_13&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_399_15_399_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_15_399_20&#39;)"><span class="hl_vardecl"><span class="mpre">prior</span></span></a><span class="mpre"> (!</span><a name="loc_399_23_399_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_23_399_26&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_399_29_399_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_29_399_33&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">)
            = let !</span><a name="loc_400_20_400_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_20_400_26&#39;)"><span class="hl_vardecl"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_399_15_399_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_15_399_20&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_399_23_399_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_23_399_26&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)
              in </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_399_15_399_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_15_399_20&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">) (</span><a href="#loc_397_11_397_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_11_397_15&#39;)"><span class="hl_varref"><span class="mpre">ixes</span></span></a><span class="mpre"> </span><a href="#loc_399_23_399_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_23_399_26&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_398_11_398_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_11_398_13&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_400_20_400_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_20_400_26&#39;)"><span class="hl_varref"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> </span><a href="#loc_399_29_399_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_29_399_33&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
      in </span><a href="#loc_398_11_398_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_11_398_13&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
</span><a href="#loc_387_1_387_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_13&#39;)"><span class="hl_fundecl"><span class="mpre">lazySearcher</span></span></a><span class="mpre"> !</span><a name="loc_403_15_403_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_15_403_22&#39;)"><span class="hl_vardecl"><span class="mpre">overlap</span></span></a><span class="mpre"> </span><a name="loc_403_23_403_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_23_403_26&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_427_5_427_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_5_427_13&#39;)"><span class="hl_varref"><span class="mpre">searcher</span></span></a><span class="mpre">
  where
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_407_5_407_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_5_407_10&#39;)"><span class="mpre">patAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a href="#loc_407_5_407_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_5_407_10&#39;)"><span class="mpre">patAt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
    </span><a name="loc_407_5_407_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_5_407_10&#39;)"><span class="hl_fundecl"><span class="mpre">patAt</span></span></a><span class="mpre"> !</span><a name="loc_407_12_407_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_12_407_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_403_23_403_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_23_403_26&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><a href="#loc_407_12_407_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_12_407_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

    !</span><a name="loc_409_6_409_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_6_409_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_403_23_403_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_23_403_26&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    !</span><a name="loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_vardecl"><span class="mpre">patEnd</span></span></a><span class="mpre"> = </span><a href="#loc_409_6_409_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_6_409_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_412_5_412_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_5_412_11&#39;)"><span class="mpre">preEnd</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a name="loc_412_5_412_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_5_412_11&#39;)"><span class="hl_vardecl"><span class="mpre">preEnd</span></span></a><span class="mpre">  = </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    !</span><a name="loc_413_6_413_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_6_413_12&#39;)"><span class="hl_vardecl"><span class="mpre">maxLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maxBound</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_409_6_409_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_6_409_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">
    !</span><a name="loc_414_6_414_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_6_414_10&#39;)"><span class="hl_vardecl"><span class="mpre">occT</span></span></a><span class="mpre">   = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_127_1_127_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_127_1_127_7&#39;)"><span class="hl_varref"><span class="mpre">occurs</span></span></a><span class="mpre"> </span><a href="#loc_403_23_403_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_23_403_26&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- for bad-character-shift</span></span><span class="mpre">
    !</span><a name="loc_415_6_415_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_6_415_11&#39;)"><span class="hl_vardecl"><span class="mpre">suffT</span></span></a><span class="mpre">  = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_180_1_180_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_180_1_180_11&#39;)"><span class="hl_varref"><span class="mpre">suffShifts</span></span></a><span class="mpre"> </span><a href="#loc_403_23_403_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_23_403_26&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- for good-suffix-shift</span></span><span class="mpre">
    !</span><a name="loc_416_6_416_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_6_416_10&#39;)"><span class="hl_vardecl"><span class="mpre">skip</span></span></a><span class="mpre">   = if </span><a href="#loc_403_15_403_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_15_403_22&#39;)"><span class="hl_varref"><span class="mpre">overlap</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_415_6_415_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_6_415_11&#39;)"><span class="hl_varref"><span class="mpre">suffT</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> else </span><a href="#loc_409_6_409_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_6_409_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- shift after a complete match</span></span><span class="mpre">
    !</span><a name="loc_418_6_418_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_6_418_10&#39;)"><span class="hl_vardecl"><span class="mpre">kept</span></span></a><span class="mpre">   = </span><a href="#loc_409_6_409_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_6_409_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_416_6_416_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_6_416_10&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- length of known prefix after full match</span></span><span class="mpre">
    !</span><a name="loc_419_6_419_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_6_419_8&#39;)"><span class="hl_vardecl"><span class="mpre">pe</span></span></a><span class="mpre">     = </span><a href="#loc_407_5_407_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_5_407_10&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- last pattern byte for fast comparison</span></span><span class="mpre">

    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_422_5_422_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_5_422_8&#39;)"><span class="mpre">occ</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a name="loc_422_5_422_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_5_422_8&#39;)"><span class="hl_fundecl"><span class="mpre">occ</span></span></a><span class="mpre"> !</span><a name="loc_422_10_422_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_10_422_11&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_414_6_414_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_6_414_10&#39;)"><span class="hl_varref"><span class="mpre">occT</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_422_10_422_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_10_422_11&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_425_5_425_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_5_425_9&#39;)"><span class="mpre">suff</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a name="loc_425_5_425_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_5_425_9&#39;)"><span class="hl_fundecl"><span class="mpre">suff</span></span></a><span class="mpre"> !</span><a name="loc_425_11_425_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_11_425_12&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_415_6_415_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_415_6_415_11&#39;)"><span class="hl_varref"><span class="mpre">suffT</span></span></a><span class="mpre"> </span><a href="#loc_425_11_425_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_11_425_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

    </span><a name="loc_427_5_427_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_5_427_13&#39;)"><span class="hl_fundecl"><span class="mpre">searcher</span></span></a><span class="mpre"> </span><a name="loc_427_14_427_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_14_427_17&#39;)"><span class="hl_vardecl"><span class="mpre">lst</span></span></a><span class="mpre"> = case </span><a href="#loc_427_14_427_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_14_427_17&#39;)"><span class="hl_varref"><span class="mpre">lst</span></span></a><span class="mpre"> of
                    []      -&gt; []
                    (</span><a name="loc_429_22_429_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_22_429_23&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_429_26_429_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_26_429_27&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) -&gt;
                      if </span><a href="#loc_413_6_413_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_6_413_12&#39;)"><span class="hl_varref"><span class="mpre">maxLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_429_22_429_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_22_429_23&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
                        then </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Overflow in BoyerMoore.lazySearcher&quot;</span></span><span class="mpre">
                        else </span><a href="#loc_446_5_446_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_5_446_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> [] </span><a href="#loc_429_22_429_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_22_429_23&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_429_26_429_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_26_429_27&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- seek is used to position the &quot;zipper&quot; of (past, str, future) to the</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- correct S.ByteString to search. This is done by ensuring that</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- 0 &lt;= strPos &lt; strLen, where strPos = diffPos + patPos.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Note that future is not a strict parameter. The bytes being compared</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- will then be (strAt strPos) and (patAt patPos).</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Splitting this into specialised versions is possible, but it would</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- only be useful if the pattern length is close to (or larger than)</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- the chunk size. For ordinary patterns of at most a few hundred bytes,</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- the overhead of yet more code-paths and larger code size will probably</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- outweigh the small gains in the relatively rare calls to seek.</span></span><span class="mpre">
    </span><a href="#loc_446_5_446_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_5_446_9&#39;)"><span class="mpre">seek</span></a><span class="mpre"> :: </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
            -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">]
    </span><a name="loc_446_5_446_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_5_446_9&#39;)"><span class="hl_fundecl"><span class="mpre">seek</span></span></a><span class="mpre"> !</span><a name="loc_446_11_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_16&#39;)"><span class="hl_vardecl"><span class="mpre">prior</span></span></a><span class="mpre"> !</span><a name="loc_446_18_446_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_18_446_22&#39;)"><span class="hl_vardecl"><span class="mpre">past</span></span></a><span class="mpre"> !</span><a name="loc_446_24_446_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_24_446_27&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><a name="loc_446_28_446_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_28_446_34&#39;)"><span class="hl_vardecl"><span class="mpre">future</span></span></a><span class="mpre"> !</span><a name="loc_446_36_446_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_36_446_43&#39;)"><span class="hl_vardecl"><span class="mpre">diffPos</span></span></a><span class="mpre"> !</span><a name="loc_446_45_446_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_45_446_51&#39;)"><span class="hl_vardecl"><span class="mpre">patPos</span></span></a><span class="mpre">
        | </span><a href="#loc_470_14_470_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_14_470_20&#39;)"><span class="hl_varref"><span class="mpre">strPos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> =  </span><span class="hl_comment"><span class="mpre">-- need to look at previous chunk</span></span><span class="mpre">
            case </span><a href="#loc_446_18_446_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_18_446_22&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> of
                (</span><a name="loc_449_18_449_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_18_449_19&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_449_22_449_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_22_449_23&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) -&gt;
                    let !</span><a name="loc_450_26_450_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_26_450_30&#39;)"><span class="hl_vardecl"><span class="mpre">hLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_449_18_449_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_18_449_19&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
                    in </span><a href="#loc_446_5_446_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_5_446_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> (</span><a href="#loc_446_11_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_450_26_450_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_26_450_30&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">) </span><a href="#loc_449_22_449_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_22_449_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_449_18_449_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_18_449_19&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> (</span><a href="#loc_446_24_446_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_24_446_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_446_28_446_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_28_446_34&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre">)
                                (</span><a href="#loc_446_36_446_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_36_446_43&#39;)"><span class="hl_varref"><span class="mpre">diffPos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_450_26_450_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_26_450_30&#39;)"><span class="hl_varref"><span class="mpre">hLen</span></span></a><span class="mpre">) </span><a href="#loc_446_45_446_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_45_446_51&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">
                []      -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;seek back too far!&quot;</span></span><span class="mpre">
        | </span><a href="#loc_472_14_472_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_472_14_472_20&#39;)"><span class="hl_varref"><span class="mpre">strEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_470_14_470_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_14_470_20&#39;)"><span class="hl_varref"><span class="mpre">strPos</span></span></a><span class="mpre"> =  </span><span class="hl_comment"><span class="mpre">-- need to look at next chunk if there is</span></span><span class="mpre">
            case </span><a href="#loc_446_28_446_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_28_446_34&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> of
                (</span><a name="loc_456_18_456_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_18_456_19&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_456_22_456_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_22_456_23&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) -&gt;
                    let </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_458_25_458_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_25_458_31&#39;)"><span class="mpre">prior&#39;</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                        </span><a name="loc_458_25_458_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_25_458_31&#39;)"><span class="hl_vardecl"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_446_11_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_471_14_471_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_14_471_20&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">
                        !</span><a name="loc_459_26_459_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_26_459_34&#39;)"><span class="hl_vardecl"><span class="mpre">diffPos&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_446_36_446_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_36_446_43&#39;)"><span class="hl_varref"><span class="mpre">diffPos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_471_14_471_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_14_471_20&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">
                        </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_461_25_461_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_25_461_30&#39;)"><span class="mpre">past&#39;</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                        </span><a name="loc_461_25_461_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_25_461_30&#39;)"><span class="hl_vardecl"><span class="mpre">past&#39;</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_326_1_326_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_326_1_326_8&#39;)"><span class="hl_varref"><span class="mpre">release</span></span></a><span class="mpre"> (-</span><a href="#loc_459_26_459_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_26_459_34&#39;)"><span class="hl_varref"><span class="mpre">diffPos&#39;</span></span></a><span class="mpre">) (</span><a href="#loc_446_24_446_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_24_446_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_446_18_446_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_18_446_22&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre">)
                    in if </span><a href="#loc_413_6_413_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_6_413_12&#39;)"><span class="hl_varref"><span class="mpre">maxLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_456_18_456_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_18_456_19&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
                        then </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Overflow in BoyerMoore.lazySearcher&quot;</span></span><span class="mpre">
                        else </span><a href="#loc_446_5_446_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_5_446_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_458_25_458_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_25_458_31&#39;)"><span class="hl_varref"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> </span><a href="#loc_461_25_461_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_25_461_30&#39;)"><span class="hl_varref"><span class="mpre">past&#39;</span></span></a><span class="mpre"> </span><a href="#loc_456_18_456_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_18_456_19&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_456_22_456_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_22_456_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_459_26_459_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_26_459_34&#39;)"><span class="hl_varref"><span class="mpre">diffPos&#39;</span></span></a><span class="mpre"> </span><a href="#loc_446_45_446_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_45_446_51&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">
                []      -&gt; []
        | </span><a href="#loc_446_45_446_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_45_446_51&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">  = </span><a href="#loc_482_13_482_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_13_482_21&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> </span><a href="#loc_470_14_470_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_14_470_20&#39;)"><span class="hl_varref"><span class="mpre">strPos</span></span></a><span class="mpre">
        | </span><a href="#loc_446_36_446_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_36_446_43&#39;)"><span class="hl_varref"><span class="mpre">diffPos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">       = </span><a href="#loc_503_13_503_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_13_503_21&#39;)"><span class="hl_varref"><span class="mpre">matcherN</span></span></a><span class="mpre"> </span><a href="#loc_446_36_446_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_36_446_43&#39;)"><span class="hl_varref"><span class="mpre">diffPos</span></span></a><span class="mpre"> </span><a href="#loc_446_45_446_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_45_446_51&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         = </span><a href="#loc_523_13_523_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_13_523_21&#39;)"><span class="hl_varref"><span class="mpre">matcherP</span></span></a><span class="mpre"> </span><a href="#loc_446_36_446_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_36_446_43&#39;)"><span class="hl_varref"><span class="mpre">diffPos</span></span></a><span class="mpre"> </span><a href="#loc_446_45_446_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_45_446_51&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">
          where
            !</span><a name="loc_470_14_470_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_14_470_20&#39;)"><span class="hl_vardecl"><span class="mpre">strPos</span></span></a><span class="mpre">  = </span><a href="#loc_446_36_446_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_36_446_43&#39;)"><span class="hl_varref"><span class="mpre">diffPos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_446_45_446_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_45_446_51&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">
            !</span><a name="loc_471_14_471_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_14_471_20&#39;)"><span class="hl_vardecl"><span class="mpre">strLen</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_446_24_446_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_24_446_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
            !</span><a name="loc_472_14_472_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_472_14_472_20&#39;)"><span class="hl_vardecl"><span class="mpre">strEnd</span></span></a><span class="mpre">  = </span><a href="#loc_471_14_471_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_14_471_20&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
            !</span><a name="loc_473_14_473_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_14_473_21&#39;)"><span class="hl_vardecl"><span class="mpre">maxDiff</span></span></a><span class="mpre"> = </span><a href="#loc_471_14_471_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_14_471_20&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_409_6_409_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_6_409_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">

            </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_476_13_476_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_13_476_18&#39;)"><span class="mpre">strAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
            </span><a name="loc_476_13_476_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_13_476_18&#39;)"><span class="hl_fundecl"><span class="mpre">strAt</span></span></a><span class="mpre"> !</span><a name="loc_476_20_476_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_20_476_21&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_446_24_446_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_24_446_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_476_20_476_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_20_476_21&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

            </span><span class="hl_comment"><span class="mpre">-- While comparing the last byte of the pattern, the bad-</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- character-shift is always at least as large as the good-</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- suffix-shift. Eliminating the unnecessary memory reads and</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- comparison speeds things up noticeably.</span></span><span class="mpre">
            </span><a name="loc_482_13_482_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_13_482_21&#39;)"><span class="hl_fundecl"><span class="mpre">checkEnd</span></span></a><span class="mpre"> !</span><a name="loc_482_23_482_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_23_482_25&#39;)"><span class="hl_vardecl"><span class="mpre">sI</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- index in string to compare to last of pattern</span></span><span class="mpre">
              | </span><a href="#loc_472_14_472_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_472_14_472_20&#39;)"><span class="hl_varref"><span class="mpre">strEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_482_23_482_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_23_482_25&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> = </span><a href="#loc_446_5_446_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_5_446_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_446_11_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><a href="#loc_446_18_446_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_18_446_22&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_446_24_446_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_24_446_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_446_28_446_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_28_446_34&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> (</span><a href="#loc_482_23_482_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_23_482_25&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">) </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">   =
                case </span><a href="#loc_476_13_476_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_13_476_18&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_482_23_482_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_23_482_25&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> of
                  !</span><a name="loc_486_20_486_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_486_20_486_21&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> | </span><a href="#loc_486_20_486_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_486_20_486_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_419_6_419_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_6_419_8&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre">   -&gt;
                       if </span><a href="#loc_482_23_482_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_23_482_25&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                        then case </span><a href="#loc_482_23_482_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_23_482_25&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> of
                              </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> -&gt; </span><a href="#loc_446_5_446_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_5_446_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_446_11_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><a href="#loc_446_18_446_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_18_446_22&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_446_24_446_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_24_446_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_446_28_446_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_28_446_34&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> (-</span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">) </span><a href="#loc_412_5_412_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_5_412_11&#39;)"><span class="hl_varref"><span class="mpre">preEnd</span></span></a><span class="mpre">
                              _ -&gt; </span><a href="#loc_503_13_503_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_13_503_21&#39;)"><span class="hl_varref"><span class="mpre">matcherN</span></span></a><span class="mpre"> (</span><a href="#loc_482_23_482_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_23_482_25&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">) </span><a href="#loc_412_5_412_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_5_412_11&#39;)"><span class="hl_varref"><span class="mpre">preEnd</span></span></a><span class="mpre">
                        else </span><a href="#loc_523_13_523_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_13_523_21&#39;)"><span class="hl_varref"><span class="mpre">matcherP</span></span></a><span class="mpre"> (</span><a href="#loc_482_23_482_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_23_482_25&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">) </span><a href="#loc_412_5_412_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_5_412_11&#39;)"><span class="hl_varref"><span class="mpre">preEnd</span></span></a><span class="mpre">
                     | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="#loc_482_13_482_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_13_482_21&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_482_23_482_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_23_482_25&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_422_5_422_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_5_422_8&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_486_20_486_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_486_20_486_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)

            </span><span class="hl_comment"><span class="mpre">-- Once the last byte has matched, we enter the full matcher</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- diff is the offset of the window, patI the index of the</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- pattern byte to compare next.</span></span><span class="mpre">

            </span><span class="hl_comment"><span class="mpre">-- matcherN is the tight loop that walks backwards from the end</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- of the pattern checking for matching bytes. The offset is</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- always negative, so no complete match can occur here.</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- When a byte matches, we need to check whether we&#39;ve reached</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- the front of this chunk, otherwise whether we need the next.</span></span><span class="mpre">
            </span><a name="loc_503_13_503_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_13_503_21&#39;)"><span class="hl_fundecl"><span class="mpre">matcherN</span></span></a><span class="mpre"> !</span><a name="loc_503_23_503_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_23_503_27&#39;)"><span class="hl_vardecl"><span class="mpre">diff</span></span></a><span class="mpre"> !</span><a name="loc_503_29_503_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_29_503_33&#39;)"><span class="hl_vardecl"><span class="mpre">patI</span></span></a><span class="mpre"> =
              case </span><a href="#loc_476_13_476_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_13_476_18&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> (</span><a href="#loc_503_23_503_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_23_503_27&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_503_29_503_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_29_503_33&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">) of
                !</span><a name="loc_505_18_505_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_18_505_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">  | </span><a href="#loc_505_18_505_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_18_505_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_407_5_407_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_5_407_10&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><a href="#loc_503_29_503_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_29_503_33&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">   -&gt;
                        if </span><a href="#loc_503_23_503_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_23_503_27&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_503_29_503_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_29_503_33&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                            then </span><a href="#loc_446_5_446_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_5_446_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_446_11_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><a href="#loc_446_18_446_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_18_446_22&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_446_24_446_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_24_446_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_446_28_446_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_28_446_34&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> </span><a href="#loc_503_23_503_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_23_503_27&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> (</span><a href="#loc_503_29_503_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_29_503_33&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                            else </span><a href="#loc_503_13_503_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_13_503_21&#39;)"><span class="hl_varref"><span class="mpre">matcherN</span></span></a><span class="mpre"> </span><a href="#loc_503_23_503_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_23_503_27&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> (</span><a href="#loc_503_29_503_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_29_503_33&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         -&gt;
                        let </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_511_29_511_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_29_511_37&#39;)"><span class="mpre">badShift</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                            </span><a name="loc_511_29_511_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_29_511_37&#39;)"><span class="hl_vardecl"><span class="mpre">badShift</span></span></a><span class="mpre"> = </span><a href="#loc_503_29_503_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_29_503_33&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_422_5_422_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_5_422_8&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_505_18_505_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_18_505_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                            </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_513_29_513_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_29_513_38&#39;)"><span class="mpre">goodShift</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                            </span><a name="loc_513_29_513_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_29_513_38&#39;)"><span class="hl_vardecl"><span class="mpre">goodShift</span></span></a><span class="mpre"> = </span><a href="#loc_425_5_425_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_5_425_9&#39;)"><span class="hl_varref"><span class="mpre">suff</span></span></a><span class="mpre"> </span><a href="#loc_503_29_503_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_29_503_33&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">
                            !</span><a name="loc_514_30_514_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_30_514_35&#39;)"><span class="hl_vardecl"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_503_23_503_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_23_503_27&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><a href="#loc_511_29_511_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_29_511_37&#39;)"><span class="hl_varref"><span class="mpre">badShift</span></span></a><span class="mpre"> </span><a href="#loc_513_29_513_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_29_513_38&#39;)"><span class="hl_varref"><span class="mpre">goodShift</span></span></a><span class="mpre">
                        in if </span><a href="#loc_473_14_473_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_14_473_21&#39;)"><span class="hl_varref"><span class="mpre">maxDiff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_514_30_514_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_30_514_35&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre">
                            then </span><a href="#loc_446_5_446_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_5_446_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_446_11_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><a href="#loc_446_18_446_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_18_446_22&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_446_24_446_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_24_446_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_446_28_446_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_28_446_34&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> </span><a href="#loc_514_30_514_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_30_514_35&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                            else </span><a href="#loc_482_13_482_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_13_482_21&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_514_30_514_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_30_514_35&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">)

            </span><span class="hl_comment"><span class="mpre">-- matcherP is the tight loop for non-negative offsets.</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- When the pattern is shifted, we must check whether we leave</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- the current chunk, otherwise we only need to check for a</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- complete match.</span></span><span class="mpre">
            </span><a name="loc_523_13_523_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_13_523_21&#39;)"><span class="hl_fundecl"><span class="mpre">matcherP</span></span></a><span class="mpre"> !</span><a name="loc_523_23_523_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_23_523_27&#39;)"><span class="hl_vardecl"><span class="mpre">diff</span></span></a><span class="mpre"> !</span><a name="loc_523_29_523_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_29_523_33&#39;)"><span class="hl_vardecl"><span class="mpre">patI</span></span></a><span class="mpre"> =
              case </span><a href="#loc_476_13_476_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_13_476_18&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> (</span><a href="#loc_523_23_523_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_23_523_27&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_523_29_523_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_29_523_33&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">) of
                !</span><a name="loc_525_18_525_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_18_525_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">  | </span><a href="#loc_525_18_525_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_18_525_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_407_5_407_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_5_407_10&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><a href="#loc_523_29_523_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_29_523_33&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">   -&gt;
                      if </span><a href="#loc_523_29_523_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_29_523_33&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                        then </span><a href="#loc_446_11_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_523_23_523_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_23_523_27&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">
                              let !</span><a name="loc_528_36_528_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_36_528_41&#39;)"><span class="hl_vardecl"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_523_23_523_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_23_523_27&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_416_6_416_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_6_416_10&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre">
                              in if </span><a href="#loc_473_14_473_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_14_473_21&#39;)"><span class="hl_varref"><span class="mpre">maxDiff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_528_36_528_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_36_528_41&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre">
                                then </span><a href="#loc_446_5_446_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_5_446_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_446_11_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><a href="#loc_446_18_446_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_18_446_22&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_446_24_446_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_24_446_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_446_28_446_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_28_446_34&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> </span><a href="#loc_528_36_528_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_36_528_41&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                                else
                                  if </span><a href="#loc_416_6_416_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_6_416_10&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_409_6_409_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_6_409_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">
                                    then
                                      </span><a href="#loc_482_13_482_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_13_482_21&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_528_36_528_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_36_528_41&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">)
                                    else
                                      </span><a href="#loc_553_13_553_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_13_553_23&#39;)"><span class="hl_varref"><span class="mpre">afterMatch</span></span></a><span class="mpre"> </span><a href="#loc_528_36_528_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_36_528_41&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                        else </span><a href="#loc_523_13_523_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_13_523_21&#39;)"><span class="hl_varref"><span class="mpre">matcherP</span></span></a><span class="mpre"> </span><a href="#loc_523_23_523_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_23_523_27&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> (</span><a href="#loc_523_29_523_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_29_523_33&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         -&gt;
                        let </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_540_29_540_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_29_540_37&#39;)"><span class="mpre">badShift</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                            </span><a name="loc_540_29_540_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_29_540_37&#39;)"><span class="hl_vardecl"><span class="mpre">badShift</span></span></a><span class="mpre"> = </span><a href="#loc_523_29_523_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_29_523_33&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_422_5_422_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_5_422_8&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_525_18_525_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_18_525_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                            </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_542_29_542_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_29_542_38&#39;)"><span class="mpre">goodShift</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                            </span><a name="loc_542_29_542_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_29_542_38&#39;)"><span class="hl_vardecl"><span class="mpre">goodShift</span></span></a><span class="mpre"> = </span><a href="#loc_425_5_425_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_5_425_9&#39;)"><span class="hl_varref"><span class="mpre">suff</span></span></a><span class="mpre"> </span><a href="#loc_523_29_523_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_29_523_33&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">
                            !</span><a name="loc_543_30_543_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_30_543_35&#39;)"><span class="hl_vardecl"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_523_23_523_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_23_523_27&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><a href="#loc_540_29_540_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_29_540_37&#39;)"><span class="hl_varref"><span class="mpre">badShift</span></span></a><span class="mpre"> </span><a href="#loc_542_29_542_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_29_542_38&#39;)"><span class="hl_varref"><span class="mpre">goodShift</span></span></a><span class="mpre">
                        in if </span><a href="#loc_473_14_473_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_14_473_21&#39;)"><span class="hl_varref"><span class="mpre">maxDiff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_543_30_543_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_30_543_35&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre">
                            then </span><a href="#loc_446_5_446_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_5_446_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_446_11_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><a href="#loc_446_18_446_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_18_446_22&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_446_24_446_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_24_446_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_446_28_446_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_28_446_34&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> </span><a href="#loc_543_30_543_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_30_543_35&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                            else </span><a href="#loc_482_13_482_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_13_482_21&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_543_30_543_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_30_543_35&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">)

            </span><span class="hl_comment"><span class="mpre">-- After a full match, we know how long a prefix of the pattern</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- still matches. Do not re-compare the prefix to prevent O(m*n)</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- behaviour for periodic patterns.</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- This breaks down at chunk boundaries, but except for long</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- patterns with a short period, that shouldn&#39;t matter much.</span></span><span class="mpre">
            </span><a name="loc_553_13_553_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_13_553_23&#39;)"><span class="hl_fundecl"><span class="mpre">afterMatch</span></span></a><span class="mpre"> !</span><a name="loc_553_25_553_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_25_553_29&#39;)"><span class="hl_vardecl"><span class="mpre">diff</span></span></a><span class="mpre"> !</span><a name="loc_553_31_553_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_31_553_35&#39;)"><span class="hl_vardecl"><span class="mpre">patI</span></span></a><span class="mpre"> =
              case </span><a href="#loc_476_13_476_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_13_476_18&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> (</span><a href="#loc_553_25_553_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_25_553_29&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_553_31_553_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_31_553_35&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">) of
                !</span><a name="loc_555_18_555_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_18_555_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">  | </span><a href="#loc_555_18_555_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_18_555_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_407_5_407_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_5_407_10&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><a href="#loc_553_31_553_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_31_553_35&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> -&gt;
                      if </span><a href="#loc_553_31_553_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_31_553_35&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_418_6_418_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_6_418_10&#39;)"><span class="hl_varref"><span class="mpre">kept</span></span></a><span class="mpre">
                        then </span><a href="#loc_446_11_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_553_25_553_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_25_553_29&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">
                            let !</span><a name="loc_558_34_558_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_34_558_39&#39;)"><span class="hl_vardecl"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_553_25_553_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_25_553_29&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_416_6_416_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_6_416_10&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre">
                            in if </span><a href="#loc_473_14_473_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_14_473_21&#39;)"><span class="hl_varref"><span class="mpre">maxDiff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_558_34_558_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_34_558_39&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre">
                                then </span><a href="#loc_446_5_446_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_5_446_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_446_11_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><a href="#loc_446_18_446_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_18_446_22&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_446_24_446_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_24_446_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_446_28_446_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_28_446_34&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> </span><a href="#loc_558_34_558_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_34_558_39&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                                else </span><a href="#loc_553_13_553_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_13_553_23&#39;)"><span class="hl_varref"><span class="mpre">afterMatch</span></span></a><span class="mpre"> </span><a href="#loc_558_34_558_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_34_558_39&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                        else </span><a href="#loc_553_13_553_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_13_553_23&#39;)"><span class="hl_varref"><span class="mpre">afterMatch</span></span></a><span class="mpre"> </span><a href="#loc_553_25_553_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_25_553_29&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> (</span><a href="#loc_553_31_553_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_31_553_35&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                    | </span><a href="#loc_553_31_553_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_31_553_35&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">  -&gt;
                        </span><a href="#loc_482_13_482_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_13_482_21&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_553_25_553_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_25_553_29&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_422_5_422_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_5_422_8&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_555_18_555_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_18_555_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)
                    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       -&gt;
                        let </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_567_29_567_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_29_567_37&#39;)"><span class="mpre">badShift</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                            </span><a name="loc_567_29_567_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_29_567_37&#39;)"><span class="hl_vardecl"><span class="mpre">badShift</span></span></a><span class="mpre"> = </span><a href="#loc_553_31_553_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_31_553_35&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_422_5_422_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_422_5_422_8&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_555_18_555_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_18_555_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                            </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_569_29_569_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_29_569_38&#39;)"><span class="mpre">goodShift</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                            </span><a name="loc_569_29_569_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_29_569_38&#39;)"><span class="hl_vardecl"><span class="mpre">goodShift</span></span></a><span class="mpre"> = </span><a href="#loc_425_5_425_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_5_425_9&#39;)"><span class="hl_varref"><span class="mpre">suff</span></span></a><span class="mpre"> </span><a href="#loc_553_31_553_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_31_553_35&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">
                            !</span><a name="loc_570_30_570_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_30_570_35&#39;)"><span class="hl_vardecl"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_553_25_553_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_25_553_29&#39;)"><span class="hl_varref"><span class="mpre">diff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><a href="#loc_567_29_567_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_29_567_37&#39;)"><span class="hl_varref"><span class="mpre">badShift</span></span></a><span class="mpre"> </span><a href="#loc_569_29_569_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_29_569_38&#39;)"><span class="hl_varref"><span class="mpre">goodShift</span></span></a><span class="mpre">
                        in if </span><a href="#loc_473_14_473_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_473_14_473_21&#39;)"><span class="hl_varref"><span class="mpre">maxDiff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_570_30_570_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_30_570_35&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre">
                            then </span><a href="#loc_446_5_446_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_5_446_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_446_11_446_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_11_446_16&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><a href="#loc_446_18_446_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_18_446_22&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_446_24_446_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_24_446_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_446_28_446_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_28_446_34&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> </span><a href="#loc_570_30_570_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_30_570_35&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                            else </span><a href="#loc_482_13_482_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_13_482_21&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_570_30_570_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_30_570_35&#39;)"><span class="hl_varref"><span class="mpre">diff&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_410_6_410_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_6_410_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                            Breaking Functions                            --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Ugh! Code duplication ahead!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- But we want to get the first component lazily, so it&#39;s no good to find</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the first index (if any) and then split.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Therefore bite the bullet and copy most of the code of lazySearcher.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- No need for afterMatch here, fortunately.</span></span><span class="mpre">
</span><a href="#loc_585_1_585_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_1_585_10&#39;)"><span class="mpre">lazyBreak</span></a><span class="mpre"> ::</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; ([</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">], [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">])
</span><a name="loc_585_1_585_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_1_585_10&#39;)"><span class="hl_fundecl"><span class="mpre">lazyBreak</span></span></a><span class="mpre"> !</span><a name="loc_585_12_585_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_12_585_15&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_585_12_585_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_12_585_15&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">  = \</span><a name="loc_586_20_586_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_20_586_23&#39;)"><span class="hl_vardecl"><span class="mpre">lst</span></span></a><span class="mpre"> -&gt; ([],</span><a href="#loc_586_20_586_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_586_20_586_23&#39;)"><span class="hl_varref"><span class="mpre">lst</span></span></a><span class="mpre">)
  | </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_585_12_585_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_12_585_15&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> =
    let !</span><a name="loc_588_10_588_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_10_588_11&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.head</span></span><span class="mpre"> </span><a href="#loc_585_12_585_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_12_585_15&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
        </span><a name="loc_589_9_589_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_589_9_589_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] = ([], [])
        </span><a href="#loc_589_9_589_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_589_9_589_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (!</span><a name="loc_590_14_590_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_14_590_17&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_590_20_590_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_20_590_24&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) =
            case </span><span class="hl_varref"><span class="mpre">S.elemIndices</span></span><span class="mpre"> </span><a href="#loc_588_10_588_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_10_588_11&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="#loc_590_14_590_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_14_590_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> of
                []    -&gt; let (</span><a name="loc_592_31_592_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_31_592_34&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a name="loc_592_36_592_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_36_592_40&#39;)"><span class="hl_vardecl"><span class="mpre">post</span></span></a><span class="mpre">) = </span><a href="#loc_589_9_589_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_589_9_589_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_590_20_590_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_20_590_24&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> in (</span><a href="#loc_590_14_590_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_14_590_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_592_31_592_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_31_592_34&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a href="#loc_592_36_592_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_36_592_40&#39;)"><span class="hl_varref"><span class="mpre">post</span></span></a><span class="mpre">)
                (</span><a name="loc_593_18_593_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_18_593_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; if </span><a href="#loc_593_18_593_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_18_593_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                            then ([], </span><a href="#loc_590_14_590_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_14_590_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_590_20_590_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_20_590_24&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
                            else ([</span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_593_18_593_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_18_593_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_590_14_590_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_14_590_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">], </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_593_18_593_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_18_593_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_590_14_590_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_14_590_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_590_20_590_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_20_590_24&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
    in </span><a href="#loc_589_9_589_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_589_9_589_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
</span><a href="#loc_585_1_585_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_1_585_10&#39;)"><span class="hl_fundecl"><span class="mpre">lazyBreak</span></span></a><span class="mpre"> </span><a name="loc_597_11_597_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_11_597_14&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_615_5_615_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_615_5_615_12&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre">
  where
    !</span><a name="loc_599_6_599_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_6_599_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_597_11_597_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_11_597_14&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    !</span><a name="loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_vardecl"><span class="mpre">patEnd</span></span></a><span class="mpre"> = </span><a href="#loc_599_6_599_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_6_599_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    !</span><a name="loc_601_6_601_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_601_6_601_10&#39;)"><span class="hl_vardecl"><span class="mpre">occT</span></span></a><span class="mpre">   = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_127_1_127_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_127_1_127_7&#39;)"><span class="hl_varref"><span class="mpre">occurs</span></span></a><span class="mpre"> </span><a href="#loc_597_11_597_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_11_597_14&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    !</span><a name="loc_602_6_602_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_602_6_602_11&#39;)"><span class="hl_vardecl"><span class="mpre">suffT</span></span></a><span class="mpre">  = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_180_1_180_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_180_1_180_11&#39;)"><span class="hl_varref"><span class="mpre">suffShifts</span></span></a><span class="mpre"> </span><a href="#loc_597_11_597_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_11_597_14&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    !</span><a name="loc_603_6_603_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_603_6_603_12&#39;)"><span class="hl_vardecl"><span class="mpre">maxLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maxBound</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_599_6_599_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_6_599_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">
    !</span><a name="loc_604_6_604_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_604_6_604_8&#39;)"><span class="hl_vardecl"><span class="mpre">pe</span></span></a><span class="mpre">     = </span><a href="#loc_607_5_607_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_5_607_10&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">

    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_607_5_607_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_5_607_10&#39;)"><span class="mpre">patAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a name="loc_607_5_607_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_5_607_10&#39;)"><span class="hl_fundecl"><span class="mpre">patAt</span></span></a><span class="mpre"> !</span><a name="loc_607_12_607_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_12_607_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_597_11_597_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_11_597_14&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><a href="#loc_607_12_607_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_12_607_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_610_5_610_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_5_610_8&#39;)"><span class="mpre">occ</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a name="loc_610_5_610_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_5_610_8&#39;)"><span class="hl_fundecl"><span class="mpre">occ</span></span></a><span class="mpre"> !</span><a name="loc_610_10_610_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_10_610_11&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_601_6_601_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_601_6_601_10&#39;)"><span class="hl_varref"><span class="mpre">occT</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_610_10_610_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_10_610_11&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_613_5_613_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_5_613_9&#39;)"><span class="mpre">suff</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a name="loc_613_5_613_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_5_613_9&#39;)"><span class="hl_fundecl"><span class="mpre">suff</span></span></a><span class="mpre"> !</span><a name="loc_613_11_613_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_11_613_12&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_602_6_602_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_602_6_602_11&#39;)"><span class="hl_varref"><span class="mpre">suffT</span></span></a><span class="mpre"> </span><a href="#loc_613_11_613_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_11_613_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

    </span><a name="loc_615_5_615_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_615_5_615_12&#39;)"><span class="hl_fundecl"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a name="loc_615_13_615_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_615_13_615_16&#39;)"><span class="hl_vardecl"><span class="mpre">lst</span></span></a><span class="mpre"> =
      case </span><a href="#loc_615_13_615_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_615_13_615_16&#39;)"><span class="hl_varref"><span class="mpre">lst</span></span></a><span class="mpre"> of
        []    -&gt; ([],[])
        (</span><a name="loc_618_10_618_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_10_618_11&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_618_12_618_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_12_618_13&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) -&gt;
          if </span><a href="#loc_603_6_603_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_603_6_603_12&#39;)"><span class="hl_varref"><span class="mpre">maxLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_618_10_618_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_10_618_11&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
            then </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Overflow in BoyerMoore.lazyBreak&quot;</span></span><span class="mpre">
            else </span><a href="#loc_625_5_625_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_5_625_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> [] </span><a href="#loc_618_10_618_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_10_618_11&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_618_12_618_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_12_618_13&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">

    </span><a href="#loc_625_5_625_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_5_625_9&#39;)"><span class="mpre">seek</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]
                -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; ([</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">], [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">])
    </span><a name="loc_625_5_625_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_5_625_9&#39;)"><span class="hl_fundecl"><span class="mpre">seek</span></span></a><span class="mpre"> !</span><a name="loc_625_11_625_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_11_625_15&#39;)"><span class="hl_vardecl"><span class="mpre">past</span></span></a><span class="mpre"> !</span><a name="loc_625_17_625_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_17_625_20&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><a name="loc_625_21_625_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_21_625_27&#39;)"><span class="hl_vardecl"><span class="mpre">future</span></span></a><span class="mpre"> !</span><a name="loc_625_29_625_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_29_625_35&#39;)"><span class="hl_vardecl"><span class="mpre">offset</span></span></a><span class="mpre"> !</span><a name="loc_625_37_625_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_37_625_43&#39;)"><span class="hl_vardecl"><span class="mpre">patPos</span></span></a><span class="mpre">
      | </span><a href="#loc_650_10_650_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_10_650_16&#39;)"><span class="hl_varref"><span class="mpre">strPos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> =
        case </span><a href="#loc_625_11_625_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_11_625_15&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> of
          [] -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;not enough past!&quot;</span></span><span class="mpre">
          (</span><a name="loc_629_12_629_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_12_629_13&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_629_16_629_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_16_629_17&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_625_5_625_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_5_625_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_629_16_629_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_16_629_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_629_12_629_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_12_629_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> (</span><a href="#loc_625_17_625_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_17_625_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_625_21_625_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_21_625_27&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre">) (</span><a href="#loc_625_29_625_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_29_625_35&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_629_12_629_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_12_629_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) </span><a href="#loc_625_37_625_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_37_625_43&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">
      | </span><a href="#loc_648_10_648_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_648_10_648_16&#39;)"><span class="hl_varref"><span class="mpre">strEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_650_10_650_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_10_650_16&#39;)"><span class="hl_varref"><span class="mpre">strPos</span></span></a><span class="mpre"> =
        case </span><a href="#loc_625_21_625_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_21_625_27&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> of
          []      -&gt; (</span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_625_11_625_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_11_625_15&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> [</span><a href="#loc_625_17_625_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_17_625_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">], [])
          (</span><a name="loc_633_12_633_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_633_12_633_13&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_633_16_633_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_633_16_633_17&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) -&gt;
            let !</span><a name="loc_634_18_634_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_18_634_22&#39;)"><span class="hl_vardecl"><span class="mpre">off&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_625_29_625_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_29_625_35&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_647_10_647_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_10_647_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">
                (</span><a name="loc_635_18_635_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_18_635_23&#39;)"><span class="hl_vardecl"><span class="mpre">past&#39;</span></span></a><span class="mpre">, !</span><a name="loc_635_26_635_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_26_635_35&#39;)"><span class="hl_vardecl"><span class="mpre">discharge</span></span></a><span class="mpre">) = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_338_1_338_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_338_1_338_5&#39;)"><span class="hl_varref"><span class="mpre">keep</span></span></a><span class="mpre"> (-</span><a href="#loc_634_18_634_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_18_634_22&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre">) (</span><a href="#loc_625_17_625_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_17_625_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_625_11_625_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_11_625_15&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre">)
            in if </span><a href="#loc_603_6_603_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_603_6_603_12&#39;)"><span class="hl_varref"><span class="mpre">maxLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_633_12_633_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_633_12_633_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
                then </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Overflow in BoyerMoore.lazyBreak (future)&quot;</span></span><span class="mpre">
                else let (</span><a name="loc_638_27_638_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_638_27_638_30&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">,</span><a name="loc_638_31_638_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_638_31_638_35&#39;)"><span class="hl_vardecl"><span class="mpre">post</span></span></a><span class="mpre">) = </span><a href="#loc_625_5_625_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_5_625_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_635_18_635_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_18_635_23&#39;)"><span class="hl_varref"><span class="mpre">past&#39;</span></span></a><span class="mpre"> </span><a href="#loc_633_12_633_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_633_12_633_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_633_16_633_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_633_16_633_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_634_18_634_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_634_18_634_22&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre"> </span><a href="#loc_625_37_625_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_37_625_43&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">
                     in (</span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_635_26_635_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_635_26_635_35&#39;)"><span class="hl_varref"><span class="mpre">discharge</span></span></a><span class="mpre"> </span><a href="#loc_638_27_638_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_638_27_638_30&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a href="#loc_638_31_638_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_638_31_638_35&#39;)"><span class="hl_varref"><span class="mpre">post</span></span></a><span class="mpre">)
      | </span><a href="#loc_625_37_625_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_37_625_43&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> = </span><a href="#loc_652_9_652_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_9_652_17&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> </span><a href="#loc_650_10_650_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_10_650_16&#39;)"><span class="hl_varref"><span class="mpre">strPos</span></span></a><span class="mpre">
      | </span><a href="#loc_625_29_625_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_29_625_35&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><a href="#loc_664_9_664_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_9_664_17&#39;)"><span class="hl_varref"><span class="mpre">matcherN</span></span></a><span class="mpre"> </span><a href="#loc_625_29_625_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_29_625_35&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre"> </span><a href="#loc_625_37_625_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_37_625_43&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><a href="#loc_676_9_676_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_9_676_17&#39;)"><span class="hl_varref"><span class="mpre">matcherP</span></span></a><span class="mpre"> </span><a href="#loc_625_29_625_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_29_625_35&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre"> </span><a href="#loc_625_37_625_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_37_625_43&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">
      where
        </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_645_9_645_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_9_645_14&#39;)"><span class="mpre">strAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
        </span><a name="loc_645_9_645_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_9_645_14&#39;)"><span class="hl_fundecl"><span class="mpre">strAt</span></span></a><span class="mpre"> !</span><a name="loc_645_16_645_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_16_645_17&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_625_17_625_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_17_625_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_645_16_645_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_16_645_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

        !</span><a name="loc_647_10_647_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_10_647_16&#39;)"><span class="hl_vardecl"><span class="mpre">strLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_625_17_625_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_17_625_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
        !</span><a name="loc_648_10_648_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_648_10_648_16&#39;)"><span class="hl_vardecl"><span class="mpre">strEnd</span></span></a><span class="mpre"> = </span><a href="#loc_647_10_647_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_10_647_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        !</span><a name="loc_649_10_649_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_10_649_16&#39;)"><span class="hl_vardecl"><span class="mpre">maxOff</span></span></a><span class="mpre"> = </span><a href="#loc_647_10_647_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_10_647_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_599_6_599_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_6_599_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">
        !</span><a name="loc_650_10_650_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_10_650_16&#39;)"><span class="hl_vardecl"><span class="mpre">strPos</span></span></a><span class="mpre"> = </span><a href="#loc_625_29_625_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_29_625_35&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_625_37_625_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_37_625_43&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">

        </span><a name="loc_652_9_652_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_9_652_17&#39;)"><span class="hl_fundecl"><span class="mpre">checkEnd</span></span></a><span class="mpre"> !</span><a name="loc_652_19_652_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_19_652_21&#39;)"><span class="hl_vardecl"><span class="mpre">sI</span></span></a><span class="mpre">
          | </span><a href="#loc_648_10_648_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_648_10_648_16&#39;)"><span class="hl_varref"><span class="mpre">strEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_652_19_652_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_19_652_21&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> = </span><a href="#loc_625_5_625_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_5_625_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_625_11_625_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_11_625_15&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_625_17_625_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_17_625_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_625_21_625_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_21_625_27&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> (</span><a href="#loc_652_19_652_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_19_652_21&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">) </span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">   =
            case </span><a href="#loc_645_9_645_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_9_645_14&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_652_19_652_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_19_652_21&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> of
              !</span><a name="loc_656_16_656_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_656_16_656_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">  | </span><a href="#loc_656_16_656_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_656_16_656_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_604_6_604_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_604_6_604_8&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre">   -&gt;
                    if </span><a href="#loc_652_19_652_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_19_652_21&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                      then (if </span><a href="#loc_652_19_652_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_19_652_21&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                              then </span><a href="#loc_625_5_625_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_5_625_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_625_11_625_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_11_625_15&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_625_17_625_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_17_625_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_625_21_625_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_21_625_27&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> (-</span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">) (</span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                              else </span><a href="#loc_664_9_664_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_9_664_17&#39;)"><span class="hl_varref"><span class="mpre">matcherN</span></span></a><span class="mpre"> (</span><a href="#loc_652_19_652_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_19_652_21&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">) (</span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">))
                      else </span><a href="#loc_676_9_676_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_9_676_17&#39;)"><span class="hl_varref"><span class="mpre">matcherP</span></span></a><span class="mpre"> (</span><a href="#loc_652_19_652_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_19_652_21&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">) (</span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="#loc_652_9_652_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_9_652_17&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_652_19_652_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_19_652_21&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_610_5_610_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_5_610_8&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_656_16_656_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_656_16_656_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)

        </span><a name="loc_664_9_664_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_9_664_17&#39;)"><span class="hl_fundecl"><span class="mpre">matcherN</span></span></a><span class="mpre"> !</span><a name="loc_664_19_664_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_19_664_22&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> !</span><a name="loc_664_24_664_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_24_664_28&#39;)"><span class="hl_vardecl"><span class="mpre">patI</span></span></a><span class="mpre"> =
          case </span><a href="#loc_645_9_645_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_9_645_14&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> (</span><a href="#loc_664_19_664_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_19_664_22&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_664_24_664_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_24_664_28&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">) of
            !</span><a name="loc_666_14_666_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_666_14_666_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">  | </span><a href="#loc_666_14_666_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_666_14_666_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_607_5_607_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_5_607_10&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><a href="#loc_664_24_664_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_24_664_28&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> -&gt;
                  if </span><a href="#loc_664_19_664_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_19_664_22&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_664_24_664_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_24_664_28&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                    then </span><a href="#loc_625_5_625_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_5_625_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_625_11_625_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_11_625_15&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_625_17_625_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_17_625_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_625_21_625_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_21_625_27&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> </span><a href="#loc_664_19_664_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_19_664_22&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> (</span><a href="#loc_664_24_664_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_24_664_28&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                    else </span><a href="#loc_664_9_664_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_9_664_17&#39;)"><span class="hl_varref"><span class="mpre">matcherN</span></span></a><span class="mpre"> </span><a href="#loc_664_19_664_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_19_664_22&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> (</span><a href="#loc_664_24_664_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_24_664_28&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt;
                    let !</span><a name="loc_671_26_671_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_26_671_30&#39;)"><span class="hl_vardecl"><span class="mpre">off&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_664_19_664_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_19_664_22&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> (</span><a href="#loc_613_5_613_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_5_613_9&#39;)"><span class="hl_varref"><span class="mpre">suff</span></span></a><span class="mpre"> </span><a href="#loc_664_24_664_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_24_664_28&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">) (</span><a href="#loc_664_24_664_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_24_664_28&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_610_5_610_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_5_610_8&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_666_14_666_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_666_14_666_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)
                    in if </span><a href="#loc_649_10_649_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_10_649_16&#39;)"><span class="hl_varref"><span class="mpre">maxOff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_671_26_671_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_26_671_30&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre">
                        then </span><a href="#loc_625_5_625_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_5_625_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_625_11_625_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_11_625_15&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_625_17_625_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_17_625_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_625_21_625_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_21_625_27&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> </span><a href="#loc_671_26_671_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_26_671_30&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre"> </span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                        else </span><a href="#loc_652_9_652_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_9_652_17&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_671_26_671_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_26_671_30&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">)

        </span><a name="loc_676_9_676_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_9_676_17&#39;)"><span class="hl_fundecl"><span class="mpre">matcherP</span></span></a><span class="mpre"> !</span><a name="loc_676_19_676_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_19_676_22&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> !</span><a name="loc_676_24_676_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_24_676_28&#39;)"><span class="hl_vardecl"><span class="mpre">patI</span></span></a><span class="mpre"> =
          case </span><a href="#loc_645_9_645_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_9_645_14&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> (</span><a href="#loc_676_19_676_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_19_676_22&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_676_24_676_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_24_676_28&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">) of
            !</span><a name="loc_678_14_678_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_14_678_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">  | </span><a href="#loc_678_14_678_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_14_678_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_607_5_607_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_5_607_10&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><a href="#loc_676_24_676_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_24_676_28&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> -&gt;
                  if </span><a href="#loc_676_24_676_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_24_676_28&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                    then let !</span><a name="loc_680_31_680_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_31_680_34&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre"> = if </span><a href="#loc_676_19_676_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_19_676_22&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then [] else [</span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_676_19_676_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_19_676_22&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_625_17_625_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_17_625_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">]
                             !</span><a name="loc_681_31_681_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_31_681_35&#39;)"><span class="hl_vardecl"><span class="mpre">post</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_676_19_676_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_19_676_22&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_625_17_625_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_17_625_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
                         in (</span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_625_11_625_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_11_625_15&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_680_31_680_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_31_680_34&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a href="#loc_681_31_681_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_31_681_35&#39;)"><span class="hl_varref"><span class="mpre">post</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_625_21_625_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_21_625_27&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre">)
                    else </span><a href="#loc_676_9_676_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_9_676_17&#39;)"><span class="hl_varref"><span class="mpre">matcherP</span></span></a><span class="mpre"> </span><a href="#loc_676_19_676_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_19_676_22&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> (</span><a href="#loc_676_24_676_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_24_676_28&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt;
                    let !</span><a name="loc_685_26_685_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_685_26_685_30&#39;)"><span class="hl_vardecl"><span class="mpre">off&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_676_19_676_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_19_676_22&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> (</span><a href="#loc_613_5_613_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_5_613_9&#39;)"><span class="hl_varref"><span class="mpre">suff</span></span></a><span class="mpre"> </span><a href="#loc_676_24_676_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_24_676_28&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">) (</span><a href="#loc_676_24_676_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_24_676_28&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_610_5_610_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_5_610_8&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_678_14_678_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_678_14_678_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)
                    in if </span><a href="#loc_649_10_649_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_10_649_16&#39;)"><span class="hl_varref"><span class="mpre">maxOff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_685_26_685_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_685_26_685_30&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre">
                        then </span><a href="#loc_625_5_625_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_5_625_9&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_625_11_625_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_11_625_15&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_625_17_625_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_17_625_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_625_21_625_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_625_21_625_27&#39;)"><span class="hl_varref"><span class="mpre">future</span></span></a><span class="mpre"> </span><a href="#loc_685_26_685_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_685_26_685_30&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre"> </span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                        else </span><a href="#loc_652_9_652_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_9_652_17&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_685_26_685_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_685_26_685_30&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_600_6_600_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_6_600_12&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                            Splitting Functions                           --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- non-empty pattern</span></span><span class="mpre">
</span><a href="#loc_697_1_697_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_697_1_697_19&#39;)"><span class="mpre">lazySplitKeepFront</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; [[</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]]
</span><a name="loc_697_1_697_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_697_1_697_19&#39;)"><span class="hl_fundecl"><span class="mpre">lazySplitKeepFront</span></span></a><span class="mpre"> </span><a name="loc_697_20_697_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_697_20_697_23&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_701_5_701_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_5_701_14&#39;)"><span class="hl_varref"><span class="mpre">splitter&#39;</span></span></a><span class="mpre">
  where
    !</span><a name="loc_699_6_699_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_699_6_699_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_697_20_697_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_697_20_697_23&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_700_5_700_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_700_5_700_12&#39;)"><span class="hl_vardecl"><span class="mpre">breaker</span></span></a><span class="mpre"> = </span><a href="#loc_585_1_585_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_1_585_10&#39;)"><span class="hl_varref"><span class="mpre">lazyBreak</span></span></a><span class="mpre"> </span><a href="#loc_697_20_697_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_697_20_697_23&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_701_5_701_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_5_701_14&#39;)"><span class="hl_fundecl"><span class="mpre">splitter&#39;</span></span></a><span class="mpre"> </span><a name="loc_701_15_701_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_15_701_19&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> = case </span><a href="#loc_704_5_704_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_704_5_704_13&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a href="#loc_701_15_701_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_15_701_19&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre"> of
                        ([]</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_702_29_702_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_702_29_702_33&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_702_29_702_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_702_29_702_33&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
                        </span><a name="loc_703_25_703_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_703_25_703_30&#39;)"><span class="hl_vardecl"><span class="mpre">other</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_703_25_703_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_703_25_703_30&#39;)"><span class="hl_varref"><span class="mpre">other</span></span></a><span class="mpre">
    </span><a name="loc_704_5_704_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_704_5_704_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitter</span></span></a><span class="mpre"> [] = []
    </span><a href="#loc_704_5_704_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_704_5_704_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a name="loc_705_14_705_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_14_705_18&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> =
      case </span><a href="#loc_700_5_700_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_700_5_700_12&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a href="#loc_705_14_705_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_14_705_18&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre"> of
        (</span><a name="loc_707_10_707_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_10_707_13&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a name="loc_707_15_707_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_15_707_19&#39;)"><span class="hl_vardecl"><span class="mpre">mtch</span></span></a><span class="mpre">) -&gt;
           </span><a href="#loc_707_10_707_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_10_707_13&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> case </span><a href="#loc_707_15_707_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_15_707_19&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre"> of
                    [] -&gt; []
                    _  -&gt; case </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7&#39;)"><span class="hl_varref"><span class="mpre">lsplit</span></span></a><span class="mpre"> </span><a href="#loc_699_6_699_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_699_6_699_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><a href="#loc_707_15_707_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_15_707_19&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre"> of
                            (</span><a name="loc_711_30_711_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_711_30_711_32&#39;)"><span class="hl_vardecl"><span class="mpre">pt</span></span></a><span class="mpre">, </span><a name="loc_711_34_711_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_711_34_711_37&#39;)"><span class="hl_vardecl"><span class="mpre">rst</span></span></a><span class="mpre">) -&gt;
                              if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_711_34_711_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_711_34_711_37&#39;)"><span class="hl_varref"><span class="mpre">rst</span></span></a><span class="mpre">
                                then [</span><a href="#loc_711_30_711_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_711_30_711_32&#39;)"><span class="hl_varref"><span class="mpre">pt</span></span></a><span class="mpre">]
                                else let (</span><a name="loc_714_43_714_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_43_714_44&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_714_47_714_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_47_714_48&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) = </span><a href="#loc_704_5_704_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_704_5_704_13&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a href="#loc_711_34_711_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_711_34_711_37&#39;)"><span class="hl_varref"><span class="mpre">rst</span></span></a><span class="mpre">
                                     in (</span><a href="#loc_711_30_711_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_711_30_711_32&#39;)"><span class="hl_varref"><span class="mpre">pt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_714_43_714_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_43_714_44&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_714_47_714_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_47_714_48&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- non-empty pattern</span></span><span class="mpre">
</span><a href="#loc_719_1_719_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_719_1_719_17&#39;)"><span class="mpre">lazySplitKeepEnd</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; [[</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]]
</span><a name="loc_719_1_719_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_719_1_719_17&#39;)"><span class="hl_fundecl"><span class="mpre">lazySplitKeepEnd</span></span></a><span class="mpre"> </span><a name="loc_719_18_719_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_719_18_719_21&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_723_5_723_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_5_723_13&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre">
  where
    !</span><a name="loc_721_6_721_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_721_6_721_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_719_18_719_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_719_18_719_21&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_722_5_722_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_722_5_722_12&#39;)"><span class="hl_vardecl"><span class="mpre">breaker</span></span></a><span class="mpre"> = </span><a href="#loc_585_1_585_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_1_585_10&#39;)"><span class="hl_varref"><span class="mpre">lazyBreak</span></span></a><span class="mpre"> </span><a href="#loc_719_18_719_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_719_18_719_21&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_723_5_723_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_5_723_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitter</span></span></a><span class="mpre"> [] = []
    </span><a href="#loc_723_5_723_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_5_723_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a name="loc_724_14_724_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_14_724_18&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> =
      case </span><a href="#loc_722_5_722_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_722_5_722_12&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a href="#loc_724_14_724_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_724_14_724_18&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre"> of
        (</span><a name="loc_726_10_726_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_10_726_13&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a name="loc_726_15_726_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_15_726_19&#39;)"><span class="hl_vardecl"><span class="mpre">mtch</span></span></a><span class="mpre">) -&gt;
            let (</span><a name="loc_727_18_727_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_18_727_19&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_727_22_727_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_22_727_23&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) = if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_726_15_726_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_15_726_19&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre">
                            then [[]]
                            else case </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7&#39;)"><span class="hl_varref"><span class="mpre">lsplit</span></span></a><span class="mpre"> </span><a href="#loc_721_6_721_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_721_6_721_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><a href="#loc_726_15_726_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_15_726_19&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre"> of
                                    (</span><a name="loc_730_38_730_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_38_730_40&#39;)"><span class="hl_vardecl"><span class="mpre">pt</span></span></a><span class="mpre">, </span><a name="loc_730_42_730_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_42_730_45&#39;)"><span class="hl_vardecl"><span class="mpre">rst</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_730_38_730_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_38_730_40&#39;)"><span class="hl_varref"><span class="mpre">pt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_723_5_723_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_5_723_13&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a href="#loc_730_42_730_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_42_730_45&#39;)"><span class="hl_varref"><span class="mpre">rst</span></span></a><span class="mpre">
            in (</span><a href="#loc_726_10_726_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_10_726_13&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_727_18_727_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_18_727_19&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_727_22_727_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_22_727_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><a href="#loc_734_1_734_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_1_734_14&#39;)"><span class="mpre">lazySplitDrop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; [[</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]]
</span><a name="loc_734_1_734_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_1_734_14&#39;)"><span class="hl_fundecl"><span class="mpre">lazySplitDrop</span></span></a><span class="mpre"> </span><a name="loc_734_15_734_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_15_734_18&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_738_5_738_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_738_5_738_13&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre">
  where
    !</span><a name="loc_736_6_736_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_6_736_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_734_15_734_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_15_734_18&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_737_5_737_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_5_737_12&#39;)"><span class="hl_vardecl"><span class="mpre">breaker</span></span></a><span class="mpre"> = </span><a href="#loc_585_1_585_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_1_585_10&#39;)"><span class="hl_varref"><span class="mpre">lazyBreak</span></span></a><span class="mpre"> </span><a href="#loc_734_15_734_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_15_734_18&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_738_5_738_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_738_5_738_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitter</span></span></a><span class="mpre"> [] = []
    </span><a href="#loc_738_5_738_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_738_5_738_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a name="loc_739_14_739_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_14_739_18&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> = </span><a href="#loc_740_5_740_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_5_740_14&#39;)"><span class="hl_varref"><span class="mpre">splitter&#39;</span></span></a><span class="mpre"> </span><a href="#loc_739_14_739_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_14_739_18&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">
    </span><a name="loc_740_5_740_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_5_740_14&#39;)"><span class="hl_fundecl"><span class="mpre">splitter&#39;</span></span></a><span class="mpre"> [] = [[]]
    </span><a href="#loc_740_5_740_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_5_740_14&#39;)"><span class="hl_fundecl"><span class="mpre">splitter&#39;</span></span></a><span class="mpre"> </span><a name="loc_741_15_741_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_15_741_19&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> = case </span><a href="#loc_737_5_737_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_5_737_12&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a href="#loc_741_15_741_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_15_741_19&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre"> of
                        (</span><a name="loc_742_26_742_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_26_742_29&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">,</span><a name="loc_742_30_742_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_30_742_34&#39;)"><span class="hl_vardecl"><span class="mpre">mtch</span></span></a><span class="mpre">) -&gt;
                            </span><a href="#loc_742_26_742_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_26_742_29&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> case </span><a href="#loc_742_30_742_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_30_742_34&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre"> of
                                    [] -&gt; []
                                    _  -&gt; </span><a href="#loc_740_5_740_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_5_740_14&#39;)"><span class="hl_varref"><span class="mpre">splitter&#39;</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Search.Internal.Utils.html#loc_290_1_290_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_290_1_290_6&#39;)"><span class="hl_varref"><span class="mpre">ldrop</span></span></a><span class="mpre"> </span><a href="#loc_736_6_736_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_6_736_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><a href="#loc_742_30_742_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_30_742_34&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                            Replacing Functions                           --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-

These would be really nice.
Unfortunately they&#39;re too slow, so instead, there&#39;s another instance of
almost the same code as in lazySearcher below.

-- variant of below
lazyFRepl :: S.ByteString -&gt; ([S.ByteString] -&gt; [S.ByteString])
                -&gt; [S.ByteString] -&gt; [S.ByteString]
lazyFRepl pat = repl
  where
    !patLen = S.length pat
    breaker = lazyBreak pat
    repl sub = replacer
      where
        replacer [] = []
        replacer strs =
          let (pre, mtch) = breaker strs
          in pre ++ case mtch of
                      [] -&gt; []
                      _  -&gt; sub (replacer (ldrop patLen mtch))

-- This is nice and short. I really hope it&#39;s performing well!
lazyBRepl :: S.ByteString -&gt; S.ByteString -&gt; [S.ByteString] -&gt; [S.ByteString]
lazyBRepl pat !sub = replacer
  where
    !patLen = S.length pat
    breaker = lazyBreak pat
    replacer [] = []
    replacer strs = let (pre, mtch) = breaker strs
                    in pre ++ case mtch of
                                [] -&gt; []
                                _  -&gt; sub : replacer (ldrop patLen mtch)
-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Yet more code duplication.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Benchmark it against an implementation using lazyBreak and,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- unless it&#39;s significantly faster, NUKE IT!!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Sigh, it is significantly faster. 10 - 25 %.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- I could live with the 10, but 25 is too much.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Hmm, maybe an implementation via</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- replace pat sub = L.intercalate sub . split pat</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- would be competitive now.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- TODO: test speed and space usage.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- replacing loop for lazy ByteStrings as list of chunks,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- called only for non-empty patterns</span></span><span class="mpre">
</span><a href="#loc_803_1_803_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_803_1_803_9&#39;)"><span class="mpre">lazyRepl</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; ([</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">])
            -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]
</span><a name="loc_803_1_803_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_803_1_803_9&#39;)"><span class="hl_fundecl"><span class="mpre">lazyRepl</span></span></a><span class="mpre"> </span><a name="loc_803_10_803_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_803_10_803_13&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_821_3_821_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_821_3_821_11&#39;)"><span class="hl_varref"><span class="mpre">replacer</span></span></a><span class="mpre">
 where
  !</span><a name="loc_805_4_805_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_4_805_10&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_803_10_803_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_803_10_803_13&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
  !</span><a name="loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_vardecl"><span class="mpre">patEnd</span></span></a><span class="mpre"> = </span><a href="#loc_805_4_805_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_4_805_10&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
  !</span><a name="loc_807_4_807_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_807_4_807_8&#39;)"><span class="hl_vardecl"><span class="mpre">occT</span></span></a><span class="mpre">   = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_127_1_127_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_127_1_127_7&#39;)"><span class="hl_varref"><span class="mpre">occurs</span></span></a><span class="mpre"> </span><a href="#loc_803_10_803_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_803_10_803_13&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
  !</span><a name="loc_808_4_808_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_4_808_9&#39;)"><span class="hl_vardecl"><span class="mpre">suffT</span></span></a><span class="mpre">  = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_180_1_180_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_180_1_180_11&#39;)"><span class="hl_varref"><span class="mpre">suffShifts</span></span></a><span class="mpre"> </span><a href="#loc_803_10_803_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_803_10_803_13&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
  !</span><a name="loc_809_4_809_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_809_4_809_10&#39;)"><span class="hl_vardecl"><span class="mpre">maxLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maxBound</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_805_4_805_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_4_805_10&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">
  !</span><a name="loc_810_4_810_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_810_4_810_6&#39;)"><span class="hl_vardecl"><span class="mpre">pe</span></span></a><span class="mpre">     = </span><a href="#loc_813_3_813_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_813_3_813_8&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">

  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_813_3_813_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_813_3_813_8&#39;)"><span class="mpre">patAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a name="loc_813_3_813_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_813_3_813_8&#39;)"><span class="hl_fundecl"><span class="mpre">patAt</span></span></a><span class="mpre"> !</span><a name="loc_813_10_813_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_813_10_813_11&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_803_10_803_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_803_10_803_13&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><a href="#loc_813_10_813_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_813_10_813_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_816_3_816_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_816_3_816_6&#39;)"><span class="mpre">occ</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a name="loc_816_3_816_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_816_3_816_6&#39;)"><span class="hl_fundecl"><span class="mpre">occ</span></span></a><span class="mpre"> !</span><a name="loc_816_8_816_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_816_8_816_9&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_807_4_807_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_807_4_807_8&#39;)"><span class="hl_varref"><span class="mpre">occT</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_816_8_816_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_816_8_816_9&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_819_3_819_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_819_3_819_7&#39;)"><span class="mpre">suff</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a name="loc_819_3_819_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_819_3_819_7&#39;)"><span class="hl_fundecl"><span class="mpre">suff</span></span></a><span class="mpre"> !</span><a name="loc_819_9_819_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_819_9_819_10&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_808_4_808_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_4_808_9&#39;)"><span class="hl_varref"><span class="mpre">suffT</span></span></a><span class="mpre"> </span><a href="#loc_819_9_819_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_819_9_819_10&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

  </span><a name="loc_821_3_821_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_821_3_821_11&#39;)"><span class="hl_fundecl"><span class="mpre">replacer</span></span></a><span class="mpre"> </span><a name="loc_821_12_821_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_821_12_821_15&#39;)"><span class="hl_vardecl"><span class="mpre">sub</span></span></a><span class="mpre"> </span><a name="loc_821_16_821_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_821_16_821_19&#39;)"><span class="hl_vardecl"><span class="mpre">lst</span></span></a><span class="mpre"> =
      case </span><a href="#loc_821_16_821_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_821_16_821_19&#39;)"><span class="hl_varref"><span class="mpre">lst</span></span></a><span class="mpre"> of
        []    -&gt; []
        (</span><a name="loc_824_10_824_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_824_10_824_11&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_824_12_824_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_824_12_824_13&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) -&gt;
          if </span><a href="#loc_809_4_809_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_809_4_809_10&#39;)"><span class="hl_varref"><span class="mpre">maxLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_824_10_824_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_824_10_824_11&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
            then </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Overflow in BoyerMoore.lazyRepl&quot;</span></span><span class="mpre">
            else </span><a href="#loc_841_9_841_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_9_841_13&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> [] </span><a href="#loc_824_10_824_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_824_10_824_11&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_824_12_824_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_824_12_824_13&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
   where
        </span><a name="loc_829_9_829_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_829_9_829_13&#39;)"><span class="hl_fundecl"><span class="mpre">chop</span></span></a><span class="mpre"> _ [] = []
        </span><a href="#loc_829_9_829_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_829_9_829_13&#39;)"><span class="hl_fundecl"><span class="mpre">chop</span></span></a><span class="mpre"> !</span><a name="loc_830_15_830_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_15_830_16&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (!</span><a name="loc_830_19_830_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_19_830_22&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_830_25_830_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_25_830_29&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">)
          | </span><a href="#loc_830_15_830_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_15_830_16&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_837_16_837_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_837_16_837_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">     =
            if </span><a href="#loc_809_4_809_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_809_4_809_10&#39;)"><span class="hl_varref"><span class="mpre">maxLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> (</span><a href="#loc_837_16_837_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_837_16_837_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_830_15_830_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_15_830_16&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
                then </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Overflow in BoyerMoore.lazyRepl (chop)&quot;</span></span><span class="mpre">
                else </span><a href="#loc_841_9_841_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_9_841_13&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> [] (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_830_15_830_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_15_830_16&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_830_19_830_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_19_830_22&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">) </span><a href="#loc_830_25_830_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_25_830_29&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_829_9_829_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_829_9_829_13&#39;)"><span class="hl_varref"><span class="mpre">chop</span></span></a><span class="mpre"> (</span><a href="#loc_830_15_830_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_15_830_16&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_837_16_837_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_837_16_837_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_830_25_830_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_25_830_29&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
            where
              !</span><a name="loc_837_16_837_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_837_16_837_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_830_19_830_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_19_830_22&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">

        </span><a href="#loc_841_9_841_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_9_841_13&#39;)"><span class="mpre">seek</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]
                                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]
        </span><a name="loc_841_9_841_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_9_841_13&#39;)"><span class="hl_fundecl"><span class="mpre">seek</span></span></a><span class="mpre"> !</span><a name="loc_841_15_841_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_15_841_19&#39;)"><span class="hl_vardecl"><span class="mpre">past</span></span></a><span class="mpre"> !</span><a name="loc_841_21_841_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_21_841_24&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><a name="loc_841_25_841_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_25_841_28&#39;)"><span class="hl_vardecl"><span class="mpre">fut</span></span></a><span class="mpre"> !</span><a name="loc_841_30_841_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_30_841_36&#39;)"><span class="hl_vardecl"><span class="mpre">offset</span></span></a><span class="mpre"> !</span><a name="loc_841_38_841_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_38_841_44&#39;)"><span class="hl_vardecl"><span class="mpre">patPos</span></span></a><span class="mpre">
          | </span><a href="#loc_866_16_866_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_866_16_866_22&#39;)"><span class="hl_varref"><span class="mpre">strPos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> =
            case </span><a href="#loc_841_15_841_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_15_841_19&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> of
              [] -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;not enough past!&quot;</span></span><span class="mpre">
              (</span><a name="loc_845_16_845_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_845_16_845_17&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_845_20_845_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_845_20_845_21&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_841_9_841_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_9_841_13&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_845_20_845_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_845_20_845_21&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_845_16_845_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_845_16_845_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> (</span><a href="#loc_841_21_841_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_21_841_24&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_841_25_841_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_25_841_28&#39;)"><span class="hl_varref"><span class="mpre">fut</span></span></a><span class="mpre">) (</span><a href="#loc_841_30_841_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_30_841_36&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_845_16_845_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_845_16_845_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) </span><a href="#loc_841_38_841_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_38_841_44&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">
          | </span><a href="#loc_864_16_864_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_864_16_864_22&#39;)"><span class="hl_varref"><span class="mpre">strEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_866_16_866_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_866_16_866_22&#39;)"><span class="hl_varref"><span class="mpre">strPos</span></span></a><span class="mpre"> =
            case </span><a href="#loc_841_25_841_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_25_841_28&#39;)"><span class="hl_varref"><span class="mpre">fut</span></span></a><span class="mpre"> of
              []      -&gt; </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_841_15_841_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_15_841_19&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> [</span><a href="#loc_841_21_841_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_21_841_24&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">]
              (</span><a name="loc_849_16_849_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_849_16_849_17&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_849_20_849_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_849_20_849_21&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) -&gt;
                let !</span><a name="loc_850_22_850_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_850_22_850_26&#39;)"><span class="hl_vardecl"><span class="mpre">off&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_841_30_841_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_30_841_36&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_863_16_863_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_863_16_863_22&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">
                    (</span><a name="loc_851_22_851_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_851_22_851_27&#39;)"><span class="hl_vardecl"><span class="mpre">past&#39;</span></span></a><span class="mpre">, !</span><a name="loc_851_30_851_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_851_30_851_39&#39;)"><span class="hl_vardecl"><span class="mpre">discharge</span></span></a><span class="mpre">) = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_338_1_338_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_338_1_338_5&#39;)"><span class="hl_varref"><span class="mpre">keep</span></span></a><span class="mpre"> (-</span><a href="#loc_850_22_850_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_850_22_850_26&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre">) (</span><a href="#loc_841_21_841_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_21_841_24&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_841_15_841_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_15_841_19&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre">)
                in if </span><a href="#loc_809_4_809_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_809_4_809_10&#39;)"><span class="hl_varref"><span class="mpre">maxLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_849_16_849_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_849_16_849_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
                    then </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Overflow in BoyerMoore.lazyRepl (future)&quot;</span></span><span class="mpre">
                    else </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_851_30_851_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_851_30_851_39&#39;)"><span class="hl_varref"><span class="mpre">discharge</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                            </span><a href="#loc_841_9_841_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_9_841_13&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_851_22_851_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_851_22_851_27&#39;)"><span class="hl_varref"><span class="mpre">past&#39;</span></span></a><span class="mpre"> </span><a href="#loc_849_16_849_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_849_16_849_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_849_20_849_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_849_20_849_21&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_850_22_850_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_850_22_850_26&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre"> </span><a href="#loc_841_38_841_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_38_841_44&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">
          | </span><a href="#loc_841_38_841_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_38_841_44&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> = </span><a href="#loc_868_15_868_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_15_868_23&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> </span><a href="#loc_866_16_866_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_866_16_866_22&#39;)"><span class="hl_varref"><span class="mpre">strPos</span></span></a><span class="mpre">
          | </span><a href="#loc_841_30_841_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_30_841_36&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><a href="#loc_880_15_880_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_15_880_23&#39;)"><span class="hl_varref"><span class="mpre">matcherN</span></span></a><span class="mpre"> </span><a href="#loc_841_30_841_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_30_841_36&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre"> </span><a href="#loc_841_38_841_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_38_841_44&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><a href="#loc_892_15_892_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_15_892_23&#39;)"><span class="hl_varref"><span class="mpre">matcherP</span></span></a><span class="mpre"> </span><a href="#loc_841_30_841_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_30_841_36&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre"> </span><a href="#loc_841_38_841_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_38_841_44&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">
            where
              </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_861_15_861_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_15_861_20&#39;)"><span class="mpre">strAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
              </span><a name="loc_861_15_861_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_15_861_20&#39;)"><span class="hl_fundecl"><span class="mpre">strAt</span></span></a><span class="mpre"> !</span><a name="loc_861_22_861_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_22_861_23&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_841_21_841_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_21_841_24&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_861_22_861_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_22_861_23&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

              !</span><a name="loc_863_16_863_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_863_16_863_22&#39;)"><span class="hl_vardecl"><span class="mpre">strLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_841_21_841_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_21_841_24&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
              !</span><a name="loc_864_16_864_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_864_16_864_22&#39;)"><span class="hl_vardecl"><span class="mpre">strEnd</span></span></a><span class="mpre"> = </span><a href="#loc_863_16_863_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_863_16_863_22&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
              !</span><a name="loc_865_16_865_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_865_16_865_22&#39;)"><span class="hl_vardecl"><span class="mpre">maxOff</span></span></a><span class="mpre"> = </span><a href="#loc_863_16_863_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_863_16_863_22&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_805_4_805_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_4_805_10&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">
              !</span><a name="loc_866_16_866_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_866_16_866_22&#39;)"><span class="hl_vardecl"><span class="mpre">strPos</span></span></a><span class="mpre"> = </span><a href="#loc_841_30_841_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_30_841_36&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_841_38_841_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_38_841_44&#39;)"><span class="hl_varref"><span class="mpre">patPos</span></span></a><span class="mpre">

              </span><a name="loc_868_15_868_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_15_868_23&#39;)"><span class="hl_fundecl"><span class="mpre">checkEnd</span></span></a><span class="mpre"> !</span><a name="loc_868_25_868_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_25_868_27&#39;)"><span class="hl_vardecl"><span class="mpre">sI</span></span></a><span class="mpre">
                | </span><a href="#loc_864_16_864_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_864_16_864_22&#39;)"><span class="hl_varref"><span class="mpre">strEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_868_25_868_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_25_868_27&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> = </span><a href="#loc_841_9_841_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_9_841_13&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_841_15_841_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_15_841_19&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_841_21_841_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_21_841_24&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_841_25_841_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_25_841_28&#39;)"><span class="hl_varref"><span class="mpre">fut</span></span></a><span class="mpre"> (</span><a href="#loc_868_25_868_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_25_868_27&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">) </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">   =
                  case </span><a href="#loc_861_15_861_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_15_861_20&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_868_25_868_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_25_868_27&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> of
                    !</span><a name="loc_872_22_872_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_22_872_23&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">  | </span><a href="#loc_872_22_872_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_22_872_23&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_810_4_810_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_810_4_810_6&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre">   -&gt;
                          if </span><a href="#loc_868_25_868_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_25_868_27&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                            then (if </span><a href="#loc_868_25_868_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_25_868_27&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                              then </span><a href="#loc_841_9_841_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_9_841_13&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_841_15_841_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_15_841_19&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_841_21_841_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_21_841_24&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_841_25_841_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_25_841_28&#39;)"><span class="hl_varref"><span class="mpre">fut</span></span></a><span class="mpre"> (-</span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">) (</span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                              else </span><a href="#loc_880_15_880_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_15_880_23&#39;)"><span class="hl_varref"><span class="mpre">matcherN</span></span></a><span class="mpre"> (</span><a href="#loc_868_25_868_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_25_868_27&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">) (</span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">))
                          else </span><a href="#loc_892_15_892_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_15_892_23&#39;)"><span class="hl_varref"><span class="mpre">matcherP</span></span></a><span class="mpre"> (</span><a href="#loc_868_25_868_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_25_868_27&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">) (</span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="#loc_868_15_868_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_15_868_23&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_868_25_868_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_25_868_27&#39;)"><span class="hl_varref"><span class="mpre">sI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_816_3_816_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_816_3_816_6&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_872_22_872_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_22_872_23&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)

              </span><a name="loc_880_15_880_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_15_880_23&#39;)"><span class="hl_fundecl"><span class="mpre">matcherN</span></span></a><span class="mpre"> !</span><a name="loc_880_25_880_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_25_880_28&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> !</span><a name="loc_880_30_880_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_30_880_34&#39;)"><span class="hl_vardecl"><span class="mpre">patI</span></span></a><span class="mpre"> =
                case </span><a href="#loc_861_15_861_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_15_861_20&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> (</span><a href="#loc_880_25_880_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_25_880_28&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_880_30_880_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_30_880_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">) of
                  !</span><a name="loc_882_20_882_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_882_20_882_21&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">  | </span><a href="#loc_882_20_882_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_882_20_882_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_813_3_813_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_813_3_813_8&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><a href="#loc_880_30_880_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_30_880_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> -&gt;
                        if </span><a href="#loc_880_25_880_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_25_880_28&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_880_30_880_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_30_880_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                          then </span><a href="#loc_841_9_841_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_9_841_13&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_841_15_841_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_15_841_19&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_841_21_841_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_21_841_24&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_841_25_841_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_25_841_28&#39;)"><span class="hl_varref"><span class="mpre">fut</span></span></a><span class="mpre"> </span><a href="#loc_880_25_880_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_25_880_28&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> (</span><a href="#loc_880_30_880_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_30_880_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                          else </span><a href="#loc_880_15_880_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_15_880_23&#39;)"><span class="hl_varref"><span class="mpre">matcherN</span></span></a><span class="mpre"> </span><a href="#loc_880_25_880_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_25_880_28&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> (</span><a href="#loc_880_30_880_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_30_880_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt;
                        let !</span><a name="loc_887_30_887_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_887_30_887_34&#39;)"><span class="hl_vardecl"><span class="mpre">off&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_880_25_880_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_25_880_28&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> (</span><a href="#loc_819_3_819_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_819_3_819_7&#39;)"><span class="hl_varref"><span class="mpre">suff</span></span></a><span class="mpre"> </span><a href="#loc_880_30_880_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_30_880_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">) (</span><a href="#loc_880_30_880_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_880_30_880_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_816_3_816_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_816_3_816_6&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_882_20_882_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_882_20_882_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)
                        in if </span><a href="#loc_865_16_865_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_865_16_865_22&#39;)"><span class="hl_varref"><span class="mpre">maxOff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_887_30_887_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_887_30_887_34&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre">
                            then </span><a href="#loc_841_9_841_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_9_841_13&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_841_15_841_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_15_841_19&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_841_21_841_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_21_841_24&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_841_25_841_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_25_841_28&#39;)"><span class="hl_varref"><span class="mpre">fut</span></span></a><span class="mpre"> </span><a href="#loc_887_30_887_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_887_30_887_34&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre"> </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                            else </span><a href="#loc_868_15_868_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_15_868_23&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_887_30_887_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_887_30_887_34&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">)

              </span><a name="loc_892_15_892_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_15_892_23&#39;)"><span class="hl_fundecl"><span class="mpre">matcherP</span></span></a><span class="mpre"> !</span><a name="loc_892_25_892_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_25_892_28&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> !</span><a name="loc_892_30_892_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_30_892_34&#39;)"><span class="hl_vardecl"><span class="mpre">patI</span></span></a><span class="mpre"> =
                case </span><a href="#loc_861_15_861_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_15_861_20&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> (</span><a href="#loc_892_25_892_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_25_892_28&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_892_30_892_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_30_892_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">) of
                  !</span><a name="loc_894_20_894_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_20_894_21&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">  | </span><a href="#loc_894_20_894_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_20_894_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_813_3_813_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_813_3_813_8&#39;)"><span class="hl_varref"><span class="mpre">patAt</span></span></a><span class="mpre"> </span><a href="#loc_892_30_892_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_30_892_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> -&gt;
                        if </span><a href="#loc_892_30_892_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_30_892_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                          then </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_841_15_841_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_15_841_19&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                            let </span><a name="loc_897_33_897_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_897_33_897_36&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre"> = if </span><a href="#loc_892_25_892_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_25_892_28&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                                        then </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
                                        else (</span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_892_25_892_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_25_892_28&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_841_21_841_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_21_841_24&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)
                            in </span><a href="#loc_897_33_897_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_897_33_897_36&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_821_12_821_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_821_12_821_15&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                let !</span><a name="loc_901_38_901_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_901_38_901_39&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_892_25_892_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_25_892_28&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_805_4_805_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_4_805_10&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">
                                in if </span><a href="#loc_901_38_901_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_901_38_901_39&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_863_16_863_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_863_16_863_22&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">
                                    then </span><a href="#loc_841_9_841_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_9_841_13&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> [] (</span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_901_38_901_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_901_38_901_39&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_841_21_841_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_21_841_24&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">) </span><a href="#loc_841_25_841_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_25_841_28&#39;)"><span class="hl_varref"><span class="mpre">fut</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                                    else </span><a href="#loc_829_9_829_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_829_9_829_13&#39;)"><span class="hl_varref"><span class="mpre">chop</span></span></a><span class="mpre"> (</span><a href="#loc_901_38_901_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_901_38_901_39&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_863_16_863_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_863_16_863_22&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">) </span><a href="#loc_841_25_841_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_25_841_28&#39;)"><span class="hl_varref"><span class="mpre">fut</span></span></a><span class="mpre">
                        else </span><a href="#loc_892_15_892_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_15_892_23&#39;)"><span class="hl_varref"><span class="mpre">matcherP</span></span></a><span class="mpre"> </span><a href="#loc_892_25_892_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_25_892_28&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> (</span><a href="#loc_892_30_892_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_30_892_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt;
                        let !</span><a name="loc_907_30_907_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_907_30_907_34&#39;)"><span class="hl_vardecl"><span class="mpre">off&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_892_25_892_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_25_892_28&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> (</span><a href="#loc_819_3_819_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_819_3_819_7&#39;)"><span class="hl_varref"><span class="mpre">suff</span></span></a><span class="mpre"> </span><a href="#loc_892_30_892_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_30_892_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre">) (</span><a href="#loc_892_30_892_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_30_892_34&#39;)"><span class="hl_varref"><span class="mpre">patI</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_816_3_816_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_816_3_816_6&#39;)"><span class="hl_varref"><span class="mpre">occ</span></span></a><span class="mpre"> </span><a href="#loc_894_20_894_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_20_894_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)
                        in if </span><a href="#loc_865_16_865_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_865_16_865_22&#39;)"><span class="hl_varref"><span class="mpre">maxOff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_907_30_907_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_907_30_907_34&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre">
                            then </span><a href="#loc_841_9_841_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_9_841_13&#39;)"><span class="hl_varref"><span class="mpre">seek</span></span></a><span class="mpre"> </span><a href="#loc_841_15_841_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_15_841_19&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> </span><a href="#loc_841_21_841_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_21_841_24&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_841_25_841_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_25_841_28&#39;)"><span class="hl_varref"><span class="mpre">fut</span></span></a><span class="mpre"> </span><a href="#loc_907_30_907_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_907_30_907_34&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre"> </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">
                            else </span><a href="#loc_868_15_868_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_15_868_23&#39;)"><span class="hl_varref"><span class="mpre">checkEnd</span></span></a><span class="mpre"> (</span><a href="#loc_907_30_907_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_907_30_907_34&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_806_4_806_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_4_806_10&#39;)"><span class="hl_varref"><span class="mpre">patEnd</span></span></a><span class="mpre">)
</span></div></body></html>