<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}

</span><span class="hl_comment"><span class="mpre">-- | Stream primitives for decoding and encoding &#39;Text&#39; values in UTF-8 format.</span></span><span class="mpre">
module System.IO.Streams.Text
  ( </span><span class="hl_comment"><span class="mpre">-- * Decoders and Encoders</span></span><span class="mpre">
    decodeUtf8
  , decodeUtf8With
  , encodeUtf8
  ) where

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           Control.Monad                 (</span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">)
import           Control.Monad.IO.Class        (</span><a href="Control.Monad.IO.Class.html#loc_30_20_30_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_30_20_30_27&#39;)"><span class="mpre">MonadIO</span></a><span class="mpre"> (..))
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Text.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 18, srcSpanEndLine = 14, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">               (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Text.hs&quot;, srcSpanStartLine = 15, srcSpanStartColumn = 18, srcSpanEndLine = 15, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">               as S
import qualified Data.ByteString.Unsafe        as S
import           Data.Monoid                   (</span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="mpre">mappend</span></a><span class="mpre">)
import           Data.Text                     (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="mpre">Text</span></a><span class="mpre">)
import qualified Data.Text.Encoding            as T
import           Data.Text.Encoding.Error      (OnDecodeError)
import           Data.Word                     (Word8)
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import qualified System.IO.Streams.Combinators as Streams
import           System.IO.Streams.Internal    (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="mpre">InputStream</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="mpre">OutputStream</span></a><span class="mpre">)
import qualified System.IO.Streams.Internal    as Streams


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Convert an &#39;OutputStream&#39; taking &#39;ByteString&#39;s to an &#39;OutputStream&#39; that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- takes &#39;Text&#39;, encoding the data as UTF-8. See</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @Data.Text.Encoding.&#39;T.encodeUtf8&#39;@.</span></span><span class="mpre">
</span><a href="#loc_33_1_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_11&#39;)"><span class="mpre">encodeUtf8</span></a><span class="mpre"> :: </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">)
</span><a name="loc_33_1_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_11&#39;)"><span class="hl_vardecl"><span class="mpre">encodeUtf8</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Combinators.html#loc_383_1_383_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Combinators.html#loc_383_1_383_10&#39;)"><span class="hl_varref"><span class="mpre">Streams.contramap</span></span></a><span class="mpre"> </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">T.encodeUtf8</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Decode an &#39;InputStream&#39; of &#39;ByteString&#39;s in UTF-8 format into an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;InputStream&#39; of &#39;Text&#39; values. If decoding fails, will throw an exception.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- See @Data.Text.Encoding.&#39;T.decodeUtf8&#39;@.</span></span><span class="mpre">
</span><a href="#loc_41_1_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_11&#39;)"><span class="mpre">decodeUtf8</span></a><span class="mpre"> :: </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">)
</span><a name="loc_41_1_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_11&#39;)"><span class="hl_vardecl"><span class="mpre">decodeUtf8</span></span></a><span class="mpre"> = </span><a href="#loc_61_1_61_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="Data.Text.Encoding.html#loc_307_1_307_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_307_1_307_11&#39;)"><span class="hl_varref"><span class="mpre">T.decodeUtf8</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_41_1_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_11&#39;)"><span class="mpre">decodeUtf8</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Decode an &#39;InputStream&#39; of &#39;ByteString&#39;s in UTF-8 format into an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;InputStream&#39; of &#39;Text&#39; values. If decoding fails, invokes the given</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;OnDecodeError&#39; function to decide what to do. See</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @Data.Text.Encoding.&#39;T.decodeUtf8With&#39;@.</span></span><span class="mpre">
</span><a href="#loc_53_1_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_15&#39;)"><span class="mpre">decodeUtf8With</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">OnDecodeError</span></span><span class="mpre">
               -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">)
</span><a name="loc_53_1_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_15&#39;)"><span class="hl_fundecl"><span class="mpre">decodeUtf8With</span></span></a><span class="mpre"> </span><a name="loc_53_16_53_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_16_53_17&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = </span><a href="#loc_61_1_61_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> (</span><a href="Data.Text.Encoding.html#loc_142_1_142_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_142_1_142_15&#39;)"><span class="hl_varref"><span class="mpre">T.decodeUtf8With</span></span></a><span class="mpre"> </span><a href="#loc_53_16_53_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_16_53_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_53_1_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_15&#39;)"><span class="mpre">decodeUtf8With</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_61_1_61_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_7&#39;)"><span class="mpre">decode</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">)
       -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
       -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">)
</span><a name="loc_61_1_61_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_7&#39;)"><span class="hl_fundecl"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a name="loc_61_8_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_8_61_18&#39;)"><span class="hl_vardecl"><span class="mpre">decodeFunc</span></span></a><span class="mpre"> </span><a name="loc_61_19_61_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_19_61_24&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_599_1_599_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_599_1_599_14&#39;)"><span class="hl_varref"><span class="mpre">Streams.fromGenerator</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_63_5_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
  where
    </span><a name="loc_63_5_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_63_9_63_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_14&#39;)"><span class="hl_vardecl"><span class="mpre">soFar</span></span></a><span class="mpre"> = </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">Streams.read</span></span></a><span class="mpre"> </span><a href="#loc_61_19_61_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_19_61_24&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><a href="#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">finish</span></span></a><span class="mpre"> </span><a href="#loc_63_9_63_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_14&#39;)"><span class="hl_varref"><span class="mpre">soFar</span></span></a><span class="mpre">) (</span><a href="#loc_69_5_69_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_10&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a href="#loc_63_9_63_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_14&#39;)"><span class="hl_varref"><span class="mpre">soFar</span></span></a><span class="mpre">)

    </span><a name="loc_66_5_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">finish</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
    </span><a href="#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_11&#39;)"><span class="hl_fundecl"><span class="mpre">finish</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_67_18_67_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_18_67_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="System.IO.Streams.Internal.html#loc_593_1_593_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_593_1_593_6&#39;)"><span class="hl_varref"><span class="mpre">Streams.yield</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_61_8_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_8_61_18&#39;)"><span class="hl_varref"><span class="mpre">decodeFunc</span></span></a><span class="mpre"> </span><a href="#loc_67_18_67_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_18_67_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

    </span><a name="loc_69_5_69_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  </span><a name="loc_69_20_69_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_20_69_21&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_72_5_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_12&#39;)"><span class="hl_varref"><span class="mpre">process</span></span></a><span class="mpre"> </span><a href="#loc_69_20_69_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_20_69_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><a href="#loc_69_5_69_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_70_17_70_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_17_70_18&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) </span><a name="loc_70_20_70_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_20_70_21&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_72_5_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_12&#39;)"><span class="hl_varref"><span class="mpre">process</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_70_17_70_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_17_70_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_70_20_70_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_20_70_21&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

    </span><a name="loc_72_5_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_12&#39;)"><span class="hl_fundecl"><span class="mpre">process</span></span></a><span class="mpre"> !</span><a name="loc_72_14_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_14_72_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
      case </span><a href="#loc_114_1_114_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_17&#39;)"><span class="hl_varref"><span class="mpre">findLastFullCode</span></span></a><span class="mpre"> </span><a href="#loc_72_14_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_14_72_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
        </span><a href="#loc_106_19_106_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_19_106_37&#39;)"><span class="hl_conref"><span class="mpre">LastCodeIsComplete</span></span></a><span class="mpre"> </span><a name="loc_74_28_74_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_28_74_29&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; (</span><a href="System.IO.Streams.Internal.html#loc_593_1_593_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_593_1_593_6&#39;)"><span class="hl_varref"><span class="mpre">Streams.yield</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_61_8_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_8_61_18&#39;)"><span class="hl_varref"><span class="mpre">decodeFunc</span></span></a><span class="mpre"> </span><a href="#loc_74_28_74_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_28_74_29&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_63_5_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        </span><a href="#loc_107_19_107_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_19_107_24&#39;)"><span class="hl_conref"><span class="mpre">Split</span></span></a><span class="mpre"> </span><a name="loc_75_15_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_75_17_75_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_17_75_18&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">            -&gt; do
                                  </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_75_15_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                      </span><a href="System.IO.Streams.Internal.html#loc_593_1_593_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_593_1_593_6&#39;)"><span class="hl_varref"><span class="mpre">Streams.yield</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_61_8_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_8_61_18&#39;)"><span class="hl_varref"><span class="mpre">decodeFunc</span></span></a><span class="mpre"> </span><a href="#loc_75_15_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
                                  </span><a href="#loc_63_5_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_75_17_75_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_17_75_18&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
        </span><a href="#loc_108_19_108_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_19_108_37&#39;)"><span class="hl_conref"><span class="mpre">NoCodesAreComplete</span></span></a><span class="mpre"> </span><a name="loc_79_28_79_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_28_79_29&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_63_5_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_79_28_79_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_28_79_29&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
data </span><a name="loc_83_6_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_6_83_14&#39;)"><span class="hl_tycondecl"><span class="mpre">ByteType</span></span></a><span class="mpre"> = </span><a name="loc_83_17_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_17_83_24&#39;)"><span class="hl_condecl"><span class="mpre">Regular</span></span></a><span class="mpre">
              | </span><a name="loc_84_17_84_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_17_84_29&#39;)"><span class="hl_condecl"><span class="mpre">Continuation</span></span></a><span class="mpre">
              | </span><a name="loc_85_17_85_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_17_85_22&#39;)"><span class="hl_condecl"><span class="mpre">Start</span></span></a><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_90_1_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_8&#39;)"><span class="mpre">between</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_90_1_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_8&#39;)"><span class="hl_fundecl"><span class="mpre">between</span></span></a><span class="mpre"> </span><a name="loc_90_9_90_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_9_90_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_90_11_90_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_12&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_90_13_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_13_90_14&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = </span><a href="#loc_90_9_90_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_9_90_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_90_11_90_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_12&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_90_9_90_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_9_90_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_90_13_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_13_90_14&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_90_1_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_8&#39;)"><span class="mpre">between</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_96_1_96_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_17&#39;)"><span class="mpre">characterizeByte</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="#loc_83_6_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_6_83_14&#39;)"><span class="hl_tyconref"><span class="mpre">ByteType</span></span></a><span class="mpre">
</span><a name="loc_96_1_96_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_17&#39;)"><span class="hl_fundecl"><span class="mpre">characterizeByte</span></span></a><span class="mpre"> </span><a name="loc_96_18_96_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_18_96_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> | </span><a href="#loc_90_1_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_8&#39;)"><span class="hl_varref"><span class="mpre">between</span></span></a><span class="mpre"> </span><a href="#loc_96_18_96_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_18_96_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7F</span></span><span class="mpre">    = </span><a href="#loc_83_17_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_17_83_24&#39;)"><span class="hl_conref"><span class="mpre">Regular</span></span></a><span class="mpre">
                   | </span><a href="#loc_90_1_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_8&#39;)"><span class="hl_varref"><span class="mpre">between</span></span></a><span class="mpre"> </span><a href="#loc_96_18_96_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_18_96_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xBF</span></span><span class="mpre"> = </span><a href="#loc_84_17_84_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_17_84_29&#39;)"><span class="hl_conref"><span class="mpre">Continuation</span></span></a><span class="mpre">
                   | </span><a href="#loc_90_1_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_8&#39;)"><span class="hl_varref"><span class="mpre">between</span></span></a><span class="mpre"> </span><a href="#loc_96_18_96_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_18_96_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xC0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDF</span></span><span class="mpre"> = </span><a href="#loc_85_17_85_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_17_85_22&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                   | </span><a href="#loc_90_1_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_8&#39;)"><span class="hl_varref"><span class="mpre">between</span></span></a><span class="mpre"> </span><a href="#loc_96_18_96_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_18_96_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xE0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xEF</span></span><span class="mpre"> = </span><a href="#loc_85_17_85_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_17_85_22&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
                   </span><span class="hl_comment"><span class="mpre">-- Technically utf-8 ends after 0xf4, but those sequences</span></span><span class="mpre">
                   </span><span class="hl_comment"><span class="mpre">-- won&#39;t decode anyways.</span></span><span class="mpre">
                   | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">           = </span><a href="#loc_85_17_85_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_17_85_22&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
data </span><a name="loc_106_6_106_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_6_106_16&#39;)"><span class="hl_tycondecl"><span class="mpre">FindOutput</span></span></a><span class="mpre"> = </span><a name="loc_106_19_106_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_19_106_37&#39;)"><span class="hl_condecl"><span class="mpre">LastCodeIsComplete</span></span></a><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
                | </span><a name="loc_107_19_107_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_19_107_24&#39;)"><span class="hl_condecl"><span class="mpre">Split</span></span></a><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
                | </span><a name="loc_108_19_108_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_19_108_37&#39;)"><span class="hl_condecl"><span class="mpre">NoCodesAreComplete</span></span></a><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- should be impossibly rare</span></span><span class="mpre">
                                                   </span><span class="hl_comment"><span class="mpre">-- in real data</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_114_1_114_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_17&#39;)"><span class="mpre">findLastFullCode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_106_6_106_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_6_106_16&#39;)"><span class="hl_tyconref"><span class="mpre">FindOutput</span></span></a><span class="mpre">
</span><a name="loc_114_1_114_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_17&#39;)"><span class="hl_fundecl"><span class="mpre">findLastFullCode</span></span></a><span class="mpre"> </span><a name="loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> | </span><a href="#loc_117_5_117_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_8&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  = </span><a href="#loc_106_19_106_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_19_106_37&#39;)"><span class="hl_conref"><span class="mpre">LastCodeIsComplete</span></span></a><span class="mpre"> </span><a href="#loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                   | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_119_5_119_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
    </span><a name="loc_117_5_117_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_8&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

    </span><a name="loc_119_5_119_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_7&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre"> = let !</span><a name="loc_119_15_119_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_15_119_18&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre"> = </span><a href="#loc_117_5_117_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_8&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
             !</span><a name="loc_120_15_120_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_15_120_16&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">   = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">S.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_119_15_119_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_15_119_18&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre">
         in case </span><a href="#loc_96_1_96_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_17&#39;)"><span class="hl_varref"><span class="mpre">characterizeByte</span></span></a><span class="mpre"> </span><a href="#loc_120_15_120_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_15_120_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> of
              </span><a href="#loc_83_17_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_17_83_24&#39;)"><span class="hl_conref"><span class="mpre">Regular</span></span></a><span class="mpre">      -&gt; </span><a href="#loc_106_19_106_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_19_106_37&#39;)"><span class="hl_conref"><span class="mpre">LastCodeIsComplete</span></span></a><span class="mpre"> </span><a href="#loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
              </span><a href="#loc_84_17_84_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_17_84_29&#39;)"><span class="hl_conref"><span class="mpre">Continuation</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_126_5_126_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_5_126_9&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> (</span><a href="#loc_117_5_117_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_8&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
              _            -&gt; </span><a href="#loc_107_19_107_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_19_107_24&#39;)"><span class="hl_conref"><span class="mpre">Split</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Unsafe.html#loc_142_1_142_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_142_1_142_11&#39;)"><span class="hl_varref"><span class="mpre">S.unsafeTake</span></span></a><span class="mpre"> </span><a href="#loc_119_15_119_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_15_119_18&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="#loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) (</span><a href="Data.ByteString.Unsafe.html#loc_148_1_148_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_148_1_148_11&#39;)"><span class="hl_varref"><span class="mpre">S.unsafeDrop</span></span></a><span class="mpre"> </span><a href="#loc_119_15_119_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_15_119_18&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="#loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)

    </span><a name="loc_126_5_126_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_5_126_9&#39;)"><span class="hl_fundecl"><span class="mpre">cont</span></span></a><span class="mpre"> !</span><a name="loc_126_11_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_14&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre"> | </span><a href="#loc_126_11_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_14&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><a href="#loc_108_19_108_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_19_108_37&#39;)"><span class="hl_conref"><span class="mpre">NoCodesAreComplete</span></span></a><span class="mpre"> </span><a href="#loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
                  let !</span><a name="loc_128_24_128_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_24_128_25&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">S.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_126_11_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_14&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre">
                  in case </span><a href="#loc_96_1_96_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_17&#39;)"><span class="hl_varref"><span class="mpre">characterizeByte</span></span></a><span class="mpre"> </span><a href="#loc_128_24_128_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_24_128_25&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> of
                       </span><span class="hl_comment"><span class="mpre">-- what do we do with this? decoding will fail. give up</span></span><span class="mpre">
                       </span><span class="hl_comment"><span class="mpre">-- and lie, the text decoder will deal with it..</span></span><span class="mpre">
                       </span><a href="#loc_83_17_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_17_83_24&#39;)"><span class="hl_conref"><span class="mpre">Regular</span></span></a><span class="mpre">      -&gt; </span><a href="#loc_106_19_106_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_19_106_37&#39;)"><span class="hl_conref"><span class="mpre">LastCodeIsComplete</span></span></a><span class="mpre"> </span><a href="#loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                       </span><a href="#loc_84_17_84_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_17_84_29&#39;)"><span class="hl_conref"><span class="mpre">Continuation</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_126_5_126_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_5_126_9&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> (</span><a href="#loc_126_11_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_14&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                       </span><a href="#loc_85_17_85_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_17_85_22&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a name="loc_134_30_134_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_30_134_31&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">      -&gt; if </span><a href="#loc_134_30_134_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_30_134_31&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_126_11_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_14&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_117_5_117_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_8&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                                         then </span><a href="#loc_106_19_106_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_19_106_37&#39;)"><span class="hl_conref"><span class="mpre">LastCodeIsComplete</span></span></a><span class="mpre"> </span><a href="#loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                                         else </span><a href="#loc_107_19_107_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_19_107_24&#39;)"><span class="hl_conref"><span class="mpre">Split</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Unsafe.html#loc_142_1_142_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_142_1_142_11&#39;)"><span class="hl_varref"><span class="mpre">S.unsafeTake</span></span></a><span class="mpre"> </span><a href="#loc_126_11_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_14&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="#loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
                                                    (</span><a href="Data.ByteString.Unsafe.html#loc_148_1_148_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_148_1_148_11&#39;)"><span class="hl_varref"><span class="mpre">S.unsafeDrop</span></span></a><span class="mpre"> </span><a href="#loc_126_11_126_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_14&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="#loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_114_1_114_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_17&#39;)"><span class="mpre">findLastFullCode</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span></div></body></html>