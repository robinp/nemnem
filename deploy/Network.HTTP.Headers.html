<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Network.HTTP.Headers</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  See LICENSE file</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Ganesh Sittampalam &lt;ganesh@earth.li&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (not tested)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module provides the data types for representing HTTP headers, and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- operations for looking up header values and working with sequences of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- header values in &#39;Request&#39;s and &#39;Response&#39;s. To avoid having to provide</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- separate set of operations for doing so, we introduce a type class &#39;HasHeaders&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to facilitate writing such processing using overloading instead.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
module Network.HTTP.Headers
   ( HasHeaders(..)     </span><span class="hl_comment"><span class="mpre">-- type class</span></span><span class="mpre">

   , Header(..)
   , mkHeader           </span><span class="hl_comment"><span class="mpre">-- :: HeaderName -&gt; String -&gt; Header</span></span><span class="mpre">
   , hdrName            </span><span class="hl_comment"><span class="mpre">-- :: Header     -&gt; HeaderName</span></span><span class="mpre">
   , hdrValue           </span><span class="hl_comment"><span class="mpre">-- :: Header     -&gt; String</span></span><span class="mpre">

   , HeaderName(..)

   , insertHeader          </span><span class="hl_comment"><span class="mpre">-- :: HasHeaders a =&gt; HeaderName -&gt; String -&gt; a -&gt; a</span></span><span class="mpre">
   , insertHeaderIfMissing </span><span class="hl_comment"><span class="mpre">-- :: HasHeaders a =&gt; HeaderName -&gt; String -&gt; a -&gt; a</span></span><span class="mpre">
   , insertHeaders         </span><span class="hl_comment"><span class="mpre">-- :: HasHeaders a =&gt; [Header] -&gt; a -&gt; a</span></span><span class="mpre">
   , retrieveHeaders       </span><span class="hl_comment"><span class="mpre">-- :: HasHeaders a =&gt; HeaderName -&gt; a -&gt; [Header]</span></span><span class="mpre">
   , replaceHeader         </span><span class="hl_comment"><span class="mpre">-- :: HasHeaders a =&gt; HeaderName -&gt; String -&gt; a -&gt; a</span></span><span class="mpre">
   , findHeader            </span><span class="hl_comment"><span class="mpre">-- :: HasHeaders a =&gt; HeaderName -&gt; a -&gt; Maybe String</span></span><span class="mpre">
   , lookupHeader          </span><span class="hl_comment"><span class="mpre">-- :: HeaderName -&gt; [Header] -&gt; Maybe String</span></span><span class="mpre">

   , parseHeader           </span><span class="hl_comment"><span class="mpre">-- :: parseHeader :: String -&gt; Result Header</span></span><span class="mpre">
   , parseHeaders          </span><span class="hl_comment"><span class="mpre">-- :: [String] -&gt; Result [Header]</span></span><span class="mpre">
   
   , headerMap             </span><span class="hl_comment"><span class="mpre">-- :: [(String, HeaderName)]</span></span><span class="mpre">
   
   , HeaderSetter
   ) where

import Data.Char (</span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="mpre">toLower</span></a><span class="mpre">)
import Network.Stream (Result, </span><a href="Network.Stream.html#loc_55_1_55_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Stream.html#loc_55_1_55_10&#39;)"><span class="mpre">failParse</span></a><span class="mpre">)
import Network.HTTP.Utils ( </span><a href="Network.HTTP.Utils.html#loc_58_1_58_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_58_1_58_5&#39;)"><span class="mpre">trim</span></a><span class="mpre">, </span><a href="Network.HTTP.Utils.html#loc_52_1_52_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_52_1_52_6&#39;)"><span class="mpre">split</span></a><span class="mpre">, </span><a href="Network.HTTP.Utils.html#loc_38_1_38_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_38_1_38_5&#39;)"><span class="mpre">crlf</span></a><span class="mpre"> )

</span><span class="hl_comment"><span class="mpre">-- | The @Header@ data type pairs header names &amp; values.</span></span><span class="mpre">
data </span><a name="loc_49_6_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_6_49_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Header</span></span></a><span class="mpre"> = </span><a name="loc_49_15_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_21&#39;)"><span class="hl_condecl"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="#loc_74_6_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_6_74_16&#39;)"><span class="hl_tyconref"><span class="mpre">HeaderName</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">

</span><a href="#loc_52_1_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_8&#39;)"><span class="mpre">hdrName</span></a><span class="mpre"> :: </span><a href="#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_74_6_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_6_74_16&#39;)"><span class="hl_tyconref"><span class="mpre">HeaderName</span></span></a><span class="mpre">
</span><a name="loc_52_1_52_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_8&#39;)"><span class="hl_fundecl"><span class="mpre">hdrName</span></span></a><span class="mpre"> (</span><a href="#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a name="loc_52_17_52_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_18&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> _) = </span><a href="#loc_52_17_52_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_18&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">

</span><a href="#loc_55_1_55_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_9&#39;)"><span class="mpre">hdrValue</span></a><span class="mpre"> :: </span><a href="#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_55_1_55_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_9&#39;)"><span class="hl_fundecl"><span class="mpre">hdrValue</span></span></a><span class="mpre"> (</span><a href="#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> _ </span><a name="loc_55_20_55_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_20_55_21&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = </span><a href="#loc_55_20_55_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_20_55_21&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Header constructor as a function, hiding above rep.</span></span><span class="mpre">
</span><a href="#loc_59_1_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_9&#39;)"><span class="mpre">mkHeader</span></a><span class="mpre"> :: </span><a href="#loc_74_6_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_6_74_16&#39;)"><span class="hl_tyconref"><span class="mpre">HeaderName</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">
</span><a name="loc_59_1_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_9&#39;)"><span class="hl_vardecl"><span class="mpre">mkHeader</span></span></a><span class="mpre"> = </span><a href="#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a name="loc_62_18_62_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_18_62_21&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre"> </span><a name="loc_62_22_62_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_22_62_27&#39;)"><span class="hl_vardecl"><span class="mpre">value</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">shows</span></span><span class="mpre"> </span><a href="#loc_62_18_62_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_18_62_21&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_62_22_62_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_22_62_27&#39;)"><span class="hl_varref"><span class="mpre">value</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Network.HTTP.Utils.html#loc_38_1_38_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_38_1_38_5&#39;)"><span class="hl_varref"><span class="mpre">crlf</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | HTTP @HeaderName@ type, a Haskell data constructor for each</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- specification-defined header, prefixed with @Hdr@ and CamelCased,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (i.e., eliding the @-@ in the process.) Should you require using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a custom header, there&#39;s the @HdrCustom@ constructor which takes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a @String@ argument.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Encoding HTTP header names differently, as Strings perhaps, is an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- equally fine choice..no decidedly clear winner, but let&#39;s stick</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with data constructors here.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
data </span><a name="loc_74_6_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_6_74_16&#39;)"><span class="hl_tycondecl"><span class="mpre">HeaderName</span></span></a><span class="mpre"> 
    </span><span class="hl_comment"><span class="mpre">-- Generic Headers --</span></span><span class="mpre">
 = </span><a name="loc_76_4_76_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_4_76_19&#39;)"><span class="hl_condecl"><span class="mpre">HdrCacheControl</span></span></a><span class="mpre">
 | </span><a name="loc_77_4_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_4_77_17&#39;)"><span class="hl_condecl"><span class="mpre">HdrConnection</span></span></a><span class="mpre">
 | </span><a name="loc_78_4_78_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_4_78_11&#39;)"><span class="hl_condecl"><span class="mpre">HdrDate</span></span></a><span class="mpre">
 | </span><a name="loc_79_4_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_4_79_13&#39;)"><span class="hl_condecl"><span class="mpre">HdrPragma</span></span></a><span class="mpre">
 | </span><a name="loc_80_4_80_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_4_80_23&#39;)"><span class="hl_condecl"><span class="mpre">HdrTransferEncoding</span></span></a><span class="mpre">        
 | </span><a name="loc_81_4_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_4_81_14&#39;)"><span class="hl_condecl"><span class="mpre">HdrUpgrade</span></span></a><span class="mpre">                
 | </span><a name="loc_82_4_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_4_82_10&#39;)"><span class="hl_condecl"><span class="mpre">HdrVia</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Request Headers --</span></span><span class="mpre">
 | </span><a name="loc_84_4_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_4_84_13&#39;)"><span class="hl_condecl"><span class="mpre">HdrAccept</span></span></a><span class="mpre">
 | </span><a name="loc_85_4_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_4_85_20&#39;)"><span class="hl_condecl"><span class="mpre">HdrAcceptCharset</span></span></a><span class="mpre">
 | </span><a name="loc_86_4_86_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_4_86_21&#39;)"><span class="hl_condecl"><span class="mpre">HdrAcceptEncoding</span></span></a><span class="mpre">
 | </span><a name="loc_87_4_87_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_4_87_21&#39;)"><span class="hl_condecl"><span class="mpre">HdrAcceptLanguage</span></span></a><span class="mpre">
 | </span><a name="loc_88_4_88_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_4_88_20&#39;)"><span class="hl_condecl"><span class="mpre">HdrAuthorization</span></span></a><span class="mpre">
 | </span><a name="loc_89_4_89_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_4_89_13&#39;)"><span class="hl_condecl"><span class="mpre">HdrCookie</span></span></a><span class="mpre">
 | </span><a name="loc_90_4_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_4_90_13&#39;)"><span class="hl_condecl"><span class="mpre">HdrExpect</span></span></a><span class="mpre">
 | </span><a name="loc_91_4_91_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_4_91_11&#39;)"><span class="hl_condecl"><span class="mpre">HdrFrom</span></span></a><span class="mpre">
 | </span><a name="loc_92_4_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_4_92_11&#39;)"><span class="hl_condecl"><span class="mpre">HdrHost</span></span></a><span class="mpre">
 | </span><a name="loc_93_4_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_4_93_22&#39;)"><span class="hl_condecl"><span class="mpre">HdrIfModifiedSince</span></span></a><span class="mpre">
 | </span><a name="loc_94_4_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_4_94_14&#39;)"><span class="hl_condecl"><span class="mpre">HdrIfMatch</span></span></a><span class="mpre">
 | </span><a name="loc_95_4_95_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_4_95_18&#39;)"><span class="hl_condecl"><span class="mpre">HdrIfNoneMatch</span></span></a><span class="mpre">
 | </span><a name="loc_96_4_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_4_96_14&#39;)"><span class="hl_condecl"><span class="mpre">HdrIfRange</span></span></a><span class="mpre">
 | </span><a name="loc_97_4_97_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_4_97_24&#39;)"><span class="hl_condecl"><span class="mpre">HdrIfUnmodifiedSince</span></span></a><span class="mpre">
 | </span><a name="loc_98_4_98_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_4_98_18&#39;)"><span class="hl_condecl"><span class="mpre">HdrMaxForwards</span></span></a><span class="mpre">
 | </span><a name="loc_99_4_99_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_4_99_25&#39;)"><span class="hl_condecl"><span class="mpre">HdrProxyAuthorization</span></span></a><span class="mpre">
 | </span><a name="loc_100_4_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_4_100_12&#39;)"><span class="hl_condecl"><span class="mpre">HdrRange</span></span></a><span class="mpre">
 | </span><a name="loc_101_4_101_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_4_101_14&#39;)"><span class="hl_condecl"><span class="mpre">HdrReferer</span></span></a><span class="mpre">
 | </span><a name="loc_102_4_102_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_4_102_16&#39;)"><span class="hl_condecl"><span class="mpre">HdrUserAgent</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Response Headers</span></span><span class="mpre">
 | </span><a name="loc_104_4_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_4_104_10&#39;)"><span class="hl_condecl"><span class="mpre">HdrAge</span></span></a><span class="mpre">
 | </span><a name="loc_105_4_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_4_105_15&#39;)"><span class="hl_condecl"><span class="mpre">HdrLocation</span></span></a><span class="mpre">
 | </span><a name="loc_106_4_106_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_4_106_24&#39;)"><span class="hl_condecl"><span class="mpre">HdrProxyAuthenticate</span></span></a><span class="mpre">
 | </span><a name="loc_107_4_107_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_4_107_13&#39;)"><span class="hl_condecl"><span class="mpre">HdrPublic</span></span></a><span class="mpre">
 | </span><a name="loc_108_4_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_4_108_17&#39;)"><span class="hl_condecl"><span class="mpre">HdrRetryAfter</span></span></a><span class="mpre">
 | </span><a name="loc_109_4_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_4_109_13&#39;)"><span class="hl_condecl"><span class="mpre">HdrServer</span></span></a><span class="mpre">
 | </span><a name="loc_110_4_110_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_4_110_16&#39;)"><span class="hl_condecl"><span class="mpre">HdrSetCookie</span></span></a><span class="mpre">
 | </span><a name="loc_111_4_111_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_4_111_9&#39;)"><span class="hl_condecl"><span class="mpre">HdrTE</span></span></a><span class="mpre">
 | </span><a name="loc_112_4_112_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_4_112_14&#39;)"><span class="hl_condecl"><span class="mpre">HdrTrailer</span></span></a><span class="mpre">
 | </span><a name="loc_113_4_113_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_4_113_11&#39;)"><span class="hl_condecl"><span class="mpre">HdrVary</span></span></a><span class="mpre">
 | </span><a name="loc_114_4_114_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_4_114_14&#39;)"><span class="hl_condecl"><span class="mpre">HdrWarning</span></span></a><span class="mpre">
 | </span><a name="loc_115_4_115_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_4_115_22&#39;)"><span class="hl_condecl"><span class="mpre">HdrWWWAuthenticate</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Entity Headers</span></span><span class="mpre">
 | </span><a name="loc_117_4_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_4_117_12&#39;)"><span class="hl_condecl"><span class="mpre">HdrAllow</span></span></a><span class="mpre">
 | </span><a name="loc_118_4_118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_4_118_18&#39;)"><span class="hl_condecl"><span class="mpre">HdrContentBase</span></span></a><span class="mpre">
 | </span><a name="loc_119_4_119_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_4_119_22&#39;)"><span class="hl_condecl"><span class="mpre">HdrContentEncoding</span></span></a><span class="mpre">
 | </span><a name="loc_120_4_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_4_120_22&#39;)"><span class="hl_condecl"><span class="mpre">HdrContentLanguage</span></span></a><span class="mpre">
 | </span><a name="loc_121_4_121_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_4_121_20&#39;)"><span class="hl_condecl"><span class="mpre">HdrContentLength</span></span></a><span class="mpre">
 | </span><a name="loc_122_4_122_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_4_122_22&#39;)"><span class="hl_condecl"><span class="mpre">HdrContentLocation</span></span></a><span class="mpre">
 | </span><a name="loc_123_4_123_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_4_123_17&#39;)"><span class="hl_condecl"><span class="mpre">HdrContentMD5</span></span></a><span class="mpre">
 | </span><a name="loc_124_4_124_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_4_124_19&#39;)"><span class="hl_condecl"><span class="mpre">HdrContentRange</span></span></a><span class="mpre">
 | </span><a name="loc_125_4_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_4_125_18&#39;)"><span class="hl_condecl"><span class="mpre">HdrContentType</span></span></a><span class="mpre">
 | </span><a name="loc_126_4_126_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_4_126_11&#39;)"><span class="hl_condecl"><span class="mpre">HdrETag</span></span></a><span class="mpre">
 | </span><a name="loc_127_4_127_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_4_127_14&#39;)"><span class="hl_condecl"><span class="mpre">HdrExpires</span></span></a><span class="mpre">
 | </span><a name="loc_128_4_128_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_4_128_19&#39;)"><span class="hl_condecl"><span class="mpre">HdrLastModified</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | MIME entity headers (for sub-parts)</span></span><span class="mpre">
 | </span><a name="loc_130_4_130_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_4_130_30&#39;)"><span class="hl_condecl"><span class="mpre">HdrContentTransferEncoding</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | Allows for unrecognised or experimental headers.</span></span><span class="mpre">
 | </span><a name="loc_132_4_132_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_4_132_13&#39;)"><span class="hl_condecl"><span class="mpre">HdrCustom</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- not in header map below.</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 133, srcSpanStartColumn = 5, srcSpanEndLine = 133, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 133, srcSpanStartColumn = 5, srcSpanEndLine = 133, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcS"><span class="mpre">deriving(Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @headerMap@ is a straight assoc list for translating between header names </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and values.</span></span><span class="mpre">
</span><a href="#loc_138_1_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_10&#39;)"><span class="mpre">headerMap</span></a><span class="mpre"> :: [ (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><a href="#loc_74_6_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_6_74_16&#39;)"><span class="hl_tyconref"><span class="mpre">HeaderName</span></span></a><span class="mpre">) ]
</span><a name="loc_138_1_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_10&#39;)"><span class="hl_vardecl"><span class="mpre">headerMap</span></span></a><span class="mpre"> =
   [ </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Cache-Control&quot;</span></span><span class="mpre">        </span><a href="#loc_76_4_76_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_4_76_19&#39;)"><span class="hl_conref"><span class="mpre">HdrCacheControl</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Connection&quot;</span></span><span class="mpre">           </span><a href="#loc_77_4_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_4_77_17&#39;)"><span class="hl_conref"><span class="mpre">HdrConnection</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Date&quot;</span></span><span class="mpre">                 </span><a href="#loc_78_4_78_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_4_78_11&#39;)"><span class="hl_conref"><span class="mpre">HdrDate</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Pragma&quot;</span></span><span class="mpre">               </span><a href="#loc_79_4_79_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_4_79_13&#39;)"><span class="hl_conref"><span class="mpre">HdrPragma</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Transfer-Encoding&quot;</span></span><span class="mpre">    </span><a href="#loc_80_4_80_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_4_80_23&#39;)"><span class="hl_conref"><span class="mpre">HdrTransferEncoding</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Upgrade&quot;</span></span><span class="mpre">              </span><a href="#loc_81_4_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_4_81_14&#39;)"><span class="hl_conref"><span class="mpre">HdrUpgrade</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Via&quot;</span></span><span class="mpre">                  </span><a href="#loc_82_4_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_4_82_10&#39;)"><span class="hl_conref"><span class="mpre">HdrVia</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Accept&quot;</span></span><span class="mpre">               </span><a href="#loc_84_4_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_4_84_13&#39;)"><span class="hl_conref"><span class="mpre">HdrAccept</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Accept-Charset&quot;</span></span><span class="mpre">       </span><a href="#loc_85_4_85_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_4_85_20&#39;)"><span class="hl_conref"><span class="mpre">HdrAcceptCharset</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Accept-Encoding&quot;</span></span><span class="mpre">      </span><a href="#loc_86_4_86_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_4_86_21&#39;)"><span class="hl_conref"><span class="mpre">HdrAcceptEncoding</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Accept-Language&quot;</span></span><span class="mpre">      </span><a href="#loc_87_4_87_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_4_87_21&#39;)"><span class="hl_conref"><span class="mpre">HdrAcceptLanguage</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Authorization&quot;</span></span><span class="mpre">        </span><a href="#loc_88_4_88_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_4_88_20&#39;)"><span class="hl_conref"><span class="mpre">HdrAuthorization</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Cookie&quot;</span></span><span class="mpre">               </span><a href="#loc_89_4_89_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_4_89_13&#39;)"><span class="hl_conref"><span class="mpre">HdrCookie</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Expect&quot;</span></span><span class="mpre">               </span><a href="#loc_90_4_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_4_90_13&#39;)"><span class="hl_conref"><span class="mpre">HdrExpect</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;From&quot;</span></span><span class="mpre">                 </span><a href="#loc_91_4_91_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_4_91_11&#39;)"><span class="hl_conref"><span class="mpre">HdrFrom</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Host&quot;</span></span><span class="mpre">                 </span><a href="#loc_92_4_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_4_92_11&#39;)"><span class="hl_conref"><span class="mpre">HdrHost</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;If-Modified-Since&quot;</span></span><span class="mpre">    </span><a href="#loc_93_4_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_4_93_22&#39;)"><span class="hl_conref"><span class="mpre">HdrIfModifiedSince</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;If-Match&quot;</span></span><span class="mpre">             </span><a href="#loc_94_4_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_4_94_14&#39;)"><span class="hl_conref"><span class="mpre">HdrIfMatch</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;If-None-Match&quot;</span></span><span class="mpre">        </span><a href="#loc_95_4_95_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_4_95_18&#39;)"><span class="hl_conref"><span class="mpre">HdrIfNoneMatch</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;If-Range&quot;</span></span><span class="mpre">             </span><a href="#loc_96_4_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_4_96_14&#39;)"><span class="hl_conref"><span class="mpre">HdrIfRange</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;If-Unmodified-Since&quot;</span></span><span class="mpre">  </span><a href="#loc_97_4_97_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_4_97_24&#39;)"><span class="hl_conref"><span class="mpre">HdrIfUnmodifiedSince</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Max-Forwards&quot;</span></span><span class="mpre">         </span><a href="#loc_98_4_98_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_4_98_18&#39;)"><span class="hl_conref"><span class="mpre">HdrMaxForwards</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Proxy-Authorization&quot;</span></span><span class="mpre">  </span><a href="#loc_99_4_99_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_4_99_25&#39;)"><span class="hl_conref"><span class="mpre">HdrProxyAuthorization</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Range&quot;</span></span><span class="mpre">                </span><a href="#loc_100_4_100_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_4_100_12&#39;)"><span class="hl_conref"><span class="mpre">HdrRange</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Referer&quot;</span></span><span class="mpre">              </span><a href="#loc_101_4_101_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_4_101_14&#39;)"><span class="hl_conref"><span class="mpre">HdrReferer</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;User-Agent&quot;</span></span><span class="mpre">           </span><a href="#loc_102_4_102_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_4_102_16&#39;)"><span class="hl_conref"><span class="mpre">HdrUserAgent</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Age&quot;</span></span><span class="mpre">                  </span><a href="#loc_104_4_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_4_104_10&#39;)"><span class="hl_conref"><span class="mpre">HdrAge</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Location&quot;</span></span><span class="mpre">             </span><a href="#loc_105_4_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_4_105_15&#39;)"><span class="hl_conref"><span class="mpre">HdrLocation</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Proxy-Authenticate&quot;</span></span><span class="mpre">   </span><a href="#loc_106_4_106_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_4_106_24&#39;)"><span class="hl_conref"><span class="mpre">HdrProxyAuthenticate</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Public&quot;</span></span><span class="mpre">               </span><a href="#loc_107_4_107_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_4_107_13&#39;)"><span class="hl_conref"><span class="mpre">HdrPublic</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Retry-After&quot;</span></span><span class="mpre">          </span><a href="#loc_108_4_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_4_108_17&#39;)"><span class="hl_conref"><span class="mpre">HdrRetryAfter</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Server&quot;</span></span><span class="mpre">               </span><a href="#loc_109_4_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_4_109_13&#39;)"><span class="hl_conref"><span class="mpre">HdrServer</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Set-Cookie&quot;</span></span><span class="mpre">           </span><a href="#loc_110_4_110_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_4_110_16&#39;)"><span class="hl_conref"><span class="mpre">HdrSetCookie</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;TE&quot;</span></span><span class="mpre">                   </span><a href="#loc_111_4_111_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_4_111_9&#39;)"><span class="hl_conref"><span class="mpre">HdrTE</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Trailer&quot;</span></span><span class="mpre">              </span><a href="#loc_112_4_112_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_4_112_14&#39;)"><span class="hl_conref"><span class="mpre">HdrTrailer</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Vary&quot;</span></span><span class="mpre">                 </span><a href="#loc_113_4_113_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_4_113_11&#39;)"><span class="hl_conref"><span class="mpre">HdrVary</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Warning&quot;</span></span><span class="mpre">              </span><a href="#loc_114_4_114_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_4_114_14&#39;)"><span class="hl_conref"><span class="mpre">HdrWarning</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;WWW-Authenticate&quot;</span></span><span class="mpre">     </span><a href="#loc_115_4_115_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_4_115_22&#39;)"><span class="hl_conref"><span class="mpre">HdrWWWAuthenticate</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Allow&quot;</span></span><span class="mpre">                </span><a href="#loc_117_4_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_4_117_12&#39;)"><span class="hl_conref"><span class="mpre">HdrAllow</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Base&quot;</span></span><span class="mpre">         </span><a href="#loc_118_4_118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_4_118_18&#39;)"><span class="hl_conref"><span class="mpre">HdrContentBase</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Encoding&quot;</span></span><span class="mpre">     </span><a href="#loc_119_4_119_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_4_119_22&#39;)"><span class="hl_conref"><span class="mpre">HdrContentEncoding</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Language&quot;</span></span><span class="mpre">     </span><a href="#loc_120_4_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_4_120_22&#39;)"><span class="hl_conref"><span class="mpre">HdrContentLanguage</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Length&quot;</span></span><span class="mpre">       </span><a href="#loc_121_4_121_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_4_121_20&#39;)"><span class="hl_conref"><span class="mpre">HdrContentLength</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Location&quot;</span></span><span class="mpre">     </span><a href="#loc_122_4_122_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_4_122_22&#39;)"><span class="hl_conref"><span class="mpre">HdrContentLocation</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-MD5&quot;</span></span><span class="mpre">          </span><a href="#loc_123_4_123_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_4_123_17&#39;)"><span class="hl_conref"><span class="mpre">HdrContentMD5</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Range&quot;</span></span><span class="mpre">        </span><a href="#loc_124_4_124_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_4_124_19&#39;)"><span class="hl_conref"><span class="mpre">HdrContentRange</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Type&quot;</span></span><span class="mpre">         </span><a href="#loc_125_4_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_4_125_18&#39;)"><span class="hl_conref"><span class="mpre">HdrContentType</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ETag&quot;</span></span><span class="mpre">                 </span><a href="#loc_126_4_126_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_4_126_11&#39;)"><span class="hl_conref"><span class="mpre">HdrETag</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Expires&quot;</span></span><span class="mpre">              </span><a href="#loc_127_4_127_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_4_127_14&#39;)"><span class="hl_conref"><span class="mpre">HdrExpires</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Last-Modified&quot;</span></span><span class="mpre">        </span><a href="#loc_128_4_128_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_4_128_19&#39;)"><span class="hl_conref"><span class="mpre">HdrLastModified</span></span></a><span class="mpre">
   , </span><a href="#loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Transfer-Encoding&quot;</span></span><span class="mpre"> </span><a href="#loc_130_4_130_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_4_130_30&#39;)"><span class="hl_conref"><span class="mpre">HdrContentTransferEncoding</span></span></a><span class="mpre">
   ]
 where
  </span><a name="loc_192_3_192_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_4&#39;)"><span class="hl_fundecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_192_5_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_5_192_6&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_192_7_192_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_7_192_8&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = (</span><a href="#loc_192_5_192_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_5_192_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_192_7_192_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_7_192_8&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_74_6_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_6_74_16&#39;)"><span class="hl_tyconref"><span class="mpre">HeaderName</span></span></a><span class="mpre"> where
    </span><a name="loc_195_5_195_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_5_195_9&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> (</span><a href="#loc_132_4_132_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_4_132_13&#39;)"><span class="hl_conref"><span class="mpre">HdrCustom</span></span></a><span class="mpre"> </span><a name="loc_195_21_195_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_21_195_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><a href="#loc_195_21_195_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_21_195_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><a href="#loc_195_5_195_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_5_195_9&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> </span><a name="loc_196_10_196_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_10_196_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">==</span></span><a href="#loc_196_10_196_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_10_196_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">) </span><a href="#loc_138_1_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_10&#39;)"><span class="hl_varref"><span class="mpre">headerMap</span></span></a><span class="mpre"> of
                [] -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;headerMap incomplete&quot;</span></span><span class="mpre">
                (</span><a name="loc_198_18_198_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_18_198_19&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="#loc_198_18_198_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_18_198_19&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @HasHeaders@ is a type class for types containing HTTP headers, allowing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- you to write overloaded header manipulation functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for both &#39;Request&#39; and &#39;Response&#39; data types, for instance.</span></span><span class="mpre">
class </span><a name="loc_203_7_203_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_7_203_17&#39;)"><span class="hl_classdecl"><span class="mpre">HasHeaders</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> where
    </span><a name="loc_204_5_204_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_5_204_15&#39;)"><span class="mpre">getHeaders</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> -&gt; [</span><a href="#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">]
    </span><a name="loc_205_5_205_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_5_205_15&#39;)"><span class="mpre">setHeaders</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> -&gt; [</span><a href="#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Header manipulation functions</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 209, srcSpanStartColumn = 1, srcSpanEndLine = 209, srcSpanEndColumn = 53}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 209, srcSpanStartColumn = 1, srcSpanEndLine = 209, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSp"><span class="mpre">type HeaderSetter a = HeaderName -&gt; String -&gt; a -&gt; a</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @insertHeader hdr val x@ inserts a header with the given header name</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and value. Does not check for existing headers with same name, allowing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- duplicates to be introduce (use &#39;replaceHeader&#39; if you want to avoid this.)</span></span><span class="mpre">
</span><a href="#loc_215_1_215_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_13&#39;)"><span class="mpre">insertHeader</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 214, srcSpanStartColumn = 17, srcSpanEndLine = 214, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 214, srcSpanStartColumn = 30, srcSpanEndLine = 214, srcSpanEndColumn = 32}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP"><span class="mpre">HasHeaders a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HeaderSetter</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_215_1_215_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_13&#39;)"><span class="hl_fundecl"><span class="mpre">insertHeader</span></span></a><span class="mpre"> </span><a name="loc_215_14_215_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_14_215_18&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_215_19_215_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_19_215_24&#39;)"><span class="hl_vardecl"><span class="mpre">value</span></span></a><span class="mpre"> </span><a name="loc_215_25_215_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_25_215_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_205_5_205_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_5_205_15&#39;)"><span class="hl_varref"><span class="mpre">setHeaders</span></span></a><span class="mpre"> </span><a href="#loc_215_25_215_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_25_215_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_217_9_217_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_9_217_19&#39;)"><span class="hl_varref"><span class="mpre">newHeaders</span></span></a><span class="mpre">
    where
        </span><a name="loc_217_9_217_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_9_217_19&#39;)"><span class="hl_vardecl"><span class="mpre">newHeaders</span></span></a><span class="mpre"> = (</span><a href="#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="#loc_215_14_215_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_14_215_18&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_215_19_215_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_19_215_24&#39;)"><span class="hl_varref"><span class="mpre">value</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_204_5_204_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_5_204_15&#39;)"><span class="hl_varref"><span class="mpre">getHeaders</span></span></a><span class="mpre"> </span><a href="#loc_215_25_215_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_25_215_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @insertHeaderIfMissing hdr val x@ adds the new header only if no previous</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- header with name @hdr@ exists in @x@.</span></span><span class="mpre">
</span><a href="#loc_222_1_222_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_22&#39;)"><span class="mpre">insertHeaderIfMissing</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 221, srcSpanStartColumn = 26, srcSpanEndLine = 221, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 221, srcSpanStartColumn = 39, srcSpanEndLine = 221, srcSpanEndColumn = 41}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP"><span class="mpre">HasHeaders a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HeaderSetter</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_222_1_222_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_22&#39;)"><span class="hl_fundecl"><span class="mpre">insertHeaderIfMissing</span></span></a><span class="mpre"> </span><a name="loc_222_23_222_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_23_222_27&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_222_28_222_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_28_222_33&#39;)"><span class="hl_vardecl"><span class="mpre">value</span></span></a><span class="mpre"> </span><a name="loc_222_34_222_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_34_222_35&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_205_5_205_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_5_205_15&#39;)"><span class="hl_varref"><span class="mpre">setHeaders</span></span></a><span class="mpre"> </span><a href="#loc_222_34_222_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_34_222_35&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><a href="#loc_224_9_224_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_9_224_19&#39;)"><span class="hl_varref"><span class="mpre">newHeaders</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_204_5_204_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_5_204_15&#39;)"><span class="hl_varref"><span class="mpre">getHeaders</span></span></a><span class="mpre"> </span><a href="#loc_222_34_222_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_34_222_35&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
    where
        </span><a name="loc_224_9_224_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_9_224_19&#39;)"><span class="hl_fundecl"><span class="mpre">newHeaders</span></span></a><span class="mpre"> </span><a name="loc_224_20_224_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_20_224_24&#39;)"><span class="hl_specname"><span class="mpre">list</span></span></a><span class="mpre">@(</span><a name="loc_224_26_224_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_26_224_27&#39;)"><span class="hl_specname"><span class="mpre">h</span></span></a><span class="mpre">@(</span><a href="#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a name="loc_224_36_224_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_36_224_37&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_224_42_224_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_42_224_46&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">)
            | </span><a href="#loc_224_36_224_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_36_224_37&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_222_23_222_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_23_222_27&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">  = </span><a href="#loc_224_20_224_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_20_224_24&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><a href="#loc_224_26_224_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_26_224_27&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_224_9_224_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_9_224_19&#39;)"><span class="hl_varref"><span class="mpre">newHeaders</span></span></a><span class="mpre"> </span><a href="#loc_224_42_224_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_42_224_46&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
        </span><a href="#loc_224_9_224_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_9_224_19&#39;)"><span class="hl_fundecl"><span class="mpre">newHeaders</span></span></a><span class="mpre"> [] = [</span><a href="#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="#loc_222_23_222_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_23_222_27&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_222_28_222_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_28_222_33&#39;)"><span class="hl_varref"><span class="mpre">value</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | @replaceHeader hdr val o@ replaces the header @hdr@ with the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- value @val@, dropping any existing </span></span><span class="mpre">
</span><a href="#loc_232_1_232_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_1_232_14&#39;)"><span class="mpre">replaceHeader</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 231, srcSpanStartColumn = 18, srcSpanEndLine = 231, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 231, srcSpanStartColumn = 31, srcSpanEndLine = 231, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP"><span class="mpre">HasHeaders a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HeaderSetter</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_232_1_232_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_1_232_14&#39;)"><span class="hl_fundecl"><span class="mpre">replaceHeader</span></span></a><span class="mpre"> </span><a name="loc_232_15_232_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_15_232_19&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_232_20_232_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_20_232_25&#39;)"><span class="hl_vardecl"><span class="mpre">value</span></span></a><span class="mpre"> </span><a name="loc_232_26_232_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_26_232_27&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = </span><a href="#loc_205_5_205_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_5_205_15&#39;)"><span class="hl_varref"><span class="mpre">setHeaders</span></span></a><span class="mpre"> </span><a href="#loc_232_26_232_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_26_232_27&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_234_9_234_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_9_234_19&#39;)"><span class="hl_varref"><span class="mpre">newHeaders</span></span></a><span class="mpre">
    where
        </span><a name="loc_234_9_234_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_9_234_19&#39;)"><span class="hl_vardecl"><span class="mpre">newHeaders</span></span></a><span class="mpre"> = </span><a href="#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="#loc_232_15_232_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_15_232_19&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_232_20_232_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_20_232_25&#39;)"><span class="hl_varref"><span class="mpre">value</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> [ </span><a href="#loc_234_48_234_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_48_234_49&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a name="loc_234_48_234_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_48_234_49&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@(</span><a href="#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a name="loc_234_58_234_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_58_234_59&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _) &lt;- </span><a href="#loc_204_5_204_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_5_204_15&#39;)"><span class="hl_varref"><span class="mpre">getHeaders</span></span></a><span class="mpre"> </span><a href="#loc_232_26_232_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_26_232_27&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">, </span><a href="#loc_232_15_232_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_15_232_19&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_234_58_234_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_58_234_59&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> ]
          
</span><span class="hl_comment"><span class="mpre">-- | @insertHeaders hdrs x@ appends multiple headers to @x@&#39;s existing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- set.</span></span><span class="mpre">
</span><a href="#loc_239_1_239_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_14&#39;)"><span class="mpre">insertHeaders</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 238, srcSpanStartColumn = 18, srcSpanEndLine = 238, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 238, srcSpanStartColumn = 31, srcSpanEndLine = 238, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP"><span class="mpre">HasHeaders a =&gt;</span></span><span class="mpre"> [</span><a href="#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_239_1_239_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_14&#39;)"><span class="hl_fundecl"><span class="mpre">insertHeaders</span></span></a><span class="mpre"> </span><a name="loc_239_15_239_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_15_239_19&#39;)"><span class="hl_vardecl"><span class="mpre">hdrs</span></span></a><span class="mpre"> </span><a name="loc_239_20_239_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_20_239_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_205_5_205_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_5_205_15&#39;)"><span class="hl_varref"><span class="mpre">setHeaders</span></span></a><span class="mpre"> </span><a href="#loc_239_20_239_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_20_239_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><a href="#loc_204_5_204_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_5_204_15&#39;)"><span class="hl_varref"><span class="mpre">getHeaders</span></span></a><span class="mpre"> </span><a href="#loc_239_20_239_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_20_239_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_239_15_239_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_15_239_19&#39;)"><span class="hl_varref"><span class="mpre">hdrs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @retrieveHeaders hdrNm x@ gets a list of headers with &#39;HeaderName&#39; @hdrNm@.</span></span><span class="mpre">
</span><a href="#loc_243_1_243_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_16&#39;)"><span class="mpre">retrieveHeaders</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 242, srcSpanStartColumn = 20, srcSpanEndLine = 242, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 242, srcSpanStartColumn = 33, srcSpanEndLine = 242, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP"><span class="mpre">HasHeaders a =&gt;</span></span><span class="mpre"> </span><a href="#loc_74_6_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_6_74_16&#39;)"><span class="hl_tyconref"><span class="mpre">HeaderName</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><a href="#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">]
</span><a name="loc_243_1_243_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_16&#39;)"><span class="hl_fundecl"><span class="mpre">retrieveHeaders</span></span></a><span class="mpre"> </span><a name="loc_243_17_243_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_17_243_21&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_243_22_243_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_22_243_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> </span><a href="#loc_245_9_245_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_9_245_18&#39;)"><span class="hl_varref"><span class="mpre">matchname</span></span></a><span class="mpre"> (</span><a href="#loc_204_5_204_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_5_204_15&#39;)"><span class="hl_varref"><span class="mpre">getHeaders</span></span></a><span class="mpre"> </span><a href="#loc_243_22_243_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_22_243_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
    where
        </span><a name="loc_245_9_245_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_9_245_18&#39;)"><span class="hl_fundecl"><span class="mpre">matchname</span></span></a><span class="mpre"> (</span><a href="#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a name="loc_245_27_245_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_27_245_28&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _) = </span><a href="#loc_245_27_245_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_27_245_28&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_243_17_243_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_17_243_21&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> 

</span><span class="hl_comment"><span class="mpre">-- | @findHeader hdrNm x@ looks up @hdrNm@ in @x@, returning the first</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- header that matches, if any.</span></span><span class="mpre">
</span><a href="#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_1_250_11&#39;)"><span class="mpre">findHeader</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 249, srcSpanStartColumn = 15, srcSpanEndLine = 249, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP-4000.2.17/Network/HTTP/Headers.hs&quot;, srcSpanStartLine = 249, srcSpanStartColumn = 28, srcSpanEndLine = 249, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/HTTP"><span class="mpre">HasHeaders a =&gt;</span></span><span class="mpre"> </span><a href="#loc_74_6_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_6_74_16&#39;)"><span class="hl_tyconref"><span class="mpre">HeaderName</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_250_1_250_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_1_250_11&#39;)"><span class="hl_fundecl"><span class="mpre">findHeader</span></span></a><span class="mpre"> </span><a name="loc_250_12_250_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_12_250_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_250_14_250_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_14_250_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_255_1_255_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_13&#39;)"><span class="hl_varref"><span class="mpre">lookupHeader</span></span></a><span class="mpre"> </span><a href="#loc_250_12_250_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_12_250_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a href="#loc_204_5_204_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_5_204_15&#39;)"><span class="hl_varref"><span class="mpre">getHeaders</span></span></a><span class="mpre"> </span><a href="#loc_250_14_250_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_14_250_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @lookupHeader hdr hdrs@ locates the first header matching @hdr@ in the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- list @hdrs@.</span></span><span class="mpre">
</span><a href="#loc_255_1_255_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_13&#39;)"><span class="mpre">lookupHeader</span></a><span class="mpre"> :: </span><a href="#loc_74_6_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_6_74_16&#39;)"><span class="hl_tyconref"><span class="mpre">HeaderName</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_255_1_255_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_13&#39;)"><span class="hl_fundecl"><span class="mpre">lookupHeader</span></span></a><span class="mpre"> _ [] = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><a href="#loc_255_1_255_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_13&#39;)"><span class="hl_fundecl"><span class="mpre">lookupHeader</span></span></a><span class="mpre"> </span><a name="loc_256_14_256_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_14_256_15&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> (</span><a href="#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a name="loc_256_24_256_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_24_256_25&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_256_26_256_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_26_256_27&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_256_28_256_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_28_256_29&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">)  
  |  </span><a href="#loc_256_14_256_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_14_256_15&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_256_24_256_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_24_256_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">   =  </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_256_26_256_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_26_256_27&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =  </span><a href="#loc_255_1_255_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_13&#39;)"><span class="hl_varref"><span class="mpre">lookupHeader</span></span></a><span class="mpre"> </span><a href="#loc_256_14_256_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_14_256_15&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_256_28_256_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_28_256_29&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @parseHeader headerNameAndValueString@ tries to unscramble a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @header: value@ pairing and returning it as a &#39;Header&#39;.</span></span><span class="mpre">
</span><a href="#loc_263_1_263_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_12&#39;)"><span class="mpre">parseHeader</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> </span><a href="#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">
</span><a name="loc_263_1_263_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_12&#39;)"><span class="hl_fundecl"><span class="mpre">parseHeader</span></span></a><span class="mpre"> </span><a name="loc_263_13_263_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_13_263_16&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> =
    case </span><a href="Network.HTTP.Utils.html#loc_52_1_52_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_52_1_52_6&#39;)"><span class="hl_varref"><span class="mpre">split</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre"> </span><a href="#loc_263_13_263_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_13_263_16&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="Network.Stream.html#loc_55_1_55_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Stream.html#loc_55_1_55_10&#39;)"><span class="hl_varref"><span class="mpre">failParse</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Unable to parse header: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_263_13_263_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_13_263_16&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_266_15_266_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_15_266_16&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">,</span><a name="loc_266_17_266_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_17_266_18&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_49_15_49_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> (</span><a href="#loc_268_9_268_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_9_268_11&#39;)"><span class="hl_varref"><span class="mpre">fn</span></span></a><span class="mpre"> </span><a href="#loc_266_15_266_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_15_266_16&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) (</span><a href="Network.HTTP.Utils.html#loc_58_1_58_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Utils.html#loc_58_1_58_5&#39;)"><span class="hl_varref"><span class="mpre">trim</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_266_17_266_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_17_266_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)
    where
        </span><a name="loc_268_9_268_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_9_268_11&#39;)"><span class="hl_fundecl"><span class="mpre">fn</span></span></a><span class="mpre"> </span><a name="loc_268_12_268_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_12_268_13&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><a href="#loc_273_9_273_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_9_273_14&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_268_12_268_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_12_268_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">) </span><a href="#loc_138_1_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_1_138_10&#39;)"><span class="hl_varref"><span class="mpre">headerMap</span></span></a><span class="mpre"> of
                 [] -&gt; (</span><a href="#loc_132_4_132_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_4_132_13&#39;)"><span class="hl_conref"><span class="mpre">HdrCustom</span></span></a><span class="mpre"> </span><a href="#loc_268_12_268_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_12_268_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
                 (</span><a name="loc_270_19_270_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_19_270_20&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><a href="#loc_270_19_270_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_19_270_20&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">

        </span><a href="#loc_273_9_273_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_9_273_14&#39;)"><span class="mpre">match</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
        </span><a name="loc_273_9_273_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_9_273_14&#39;)"><span class="hl_fundecl"><span class="mpre">match</span></span></a><span class="mpre"> </span><a name="loc_273_15_273_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_15_273_17&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre"> </span><a name="loc_273_18_273_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_18_273_20&#39;)"><span class="hl_vardecl"><span class="mpre">s2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><a href="#loc_273_15_273_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_15_273_17&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><a href="#loc_273_18_273_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_18_273_20&#39;)"><span class="hl_varref"><span class="mpre">s2</span></span></a><span class="mpre">
    
</span><span class="hl_comment"><span class="mpre">-- | @parseHeaders hdrs@ takes a sequence of strings holding header</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- information and parses them into a set of headers (preserving their</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- order in the input argument.) Handles header values split up over</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- multiple lines.</span></span><span class="mpre">
</span><a href="#loc_280_1_280_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_1_280_13&#39;)"><span class="mpre">parseHeaders</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> [</span><a href="#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">]
</span><a name="loc_280_1_280_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_1_280_13&#39;)"><span class="hl_vardecl"><span class="mpre">parseHeaders</span></span></a><span class="mpre"> = </span><a href="#loc_302_9_302_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_9_302_17&#39;)"><span class="hl_varref"><span class="mpre">catRslts</span></span></a><span class="mpre"> [] </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> 
                 </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_263_1_263_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_12&#39;)"><span class="hl_varref"><span class="mpre">parseHeader</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_294_9_294_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_9_294_14&#39;)"><span class="hl_varref"><span class="mpre">clean</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> 
                     </span><a href="#loc_286_9_286_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_21&#39;)"><span class="hl_varref"><span class="mpre">joinExtended</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
   where
        </span><span class="hl_comment"><span class="mpre">-- Joins consecutive lines where the second line</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- begins with &#39; &#39; or &#39;\t&#39;.</span></span><span class="mpre">
        </span><a name="loc_286_9_286_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_21&#39;)"><span class="hl_fundecl"><span class="mpre">joinExtended</span></span></a><span class="mpre"> </span><a name="loc_286_22_286_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_22_286_25&#39;)"><span class="hl_vardecl"><span class="mpre">old</span></span></a><span class="mpre">      [] = [</span><a href="#loc_286_22_286_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_22_286_25&#39;)"><span class="hl_varref"><span class="mpre">old</span></span></a><span class="mpre">]
        </span><a href="#loc_286_9_286_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_21&#39;)"><span class="hl_fundecl"><span class="mpre">joinExtended</span></span></a><span class="mpre"> </span><a name="loc_287_22_287_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_22_287_25&#39;)"><span class="hl_vardecl"><span class="mpre">old</span></span></a><span class="mpre"> (</span><a name="loc_287_27_287_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_27_287_28&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_287_31_287_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_31_287_32&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">)
          | </span><a href="#loc_291_9_291_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_24&#39;)"><span class="hl_varref"><span class="mpre">isLineExtension</span></span></a><span class="mpre"> </span><a href="#loc_287_27_287_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_27_287_28&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">    = </span><a href="#loc_286_9_286_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_21&#39;)"><span class="hl_varref"><span class="mpre">joinExtended</span></span></a><span class="mpre"> (</span><a href="#loc_287_22_287_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_22_287_25&#39;)"><span class="hl_varref"><span class="mpre">old</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><a href="#loc_287_27_287_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_27_287_28&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) </span><a href="#loc_287_31_287_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_31_287_32&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">            = </span><a href="#loc_287_22_287_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_22_287_25&#39;)"><span class="hl_varref"><span class="mpre">old</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_286_9_286_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_21&#39;)"><span class="hl_varref"><span class="mpre">joinExtended</span></span></a><span class="mpre"> </span><a href="#loc_287_27_287_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_27_287_28&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_287_31_287_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_31_287_32&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
        
        </span><a name="loc_291_9_291_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_24&#39;)"><span class="hl_fundecl"><span class="mpre">isLineExtension</span></span></a><span class="mpre"> (</span><a name="loc_291_26_291_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_26_291_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><a href="#loc_291_26_291_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_26_291_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_291_26_291_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_26_291_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\t&#39;</span></span><span class="mpre">
        </span><a href="#loc_291_9_291_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_24&#39;)"><span class="hl_fundecl"><span class="mpre">isLineExtension</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

        </span><a name="loc_294_9_294_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_9_294_14&#39;)"><span class="hl_fundecl"><span class="mpre">clean</span></span></a><span class="mpre"> [] = []
        </span><a href="#loc_294_9_294_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_9_294_14&#39;)"><span class="hl_fundecl"><span class="mpre">clean</span></span></a><span class="mpre"> (</span><a name="loc_295_16_295_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_16_295_17&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_295_18_295_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_18_295_19&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) | </span><a href="#loc_295_16_295_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_16_295_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\t\r\n&quot;</span></span><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_294_9_294_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_9_294_14&#39;)"><span class="hl_varref"><span class="mpre">clean</span></span></a><span class="mpre"> </span><a href="#loc_295_18_295_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_18_295_19&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
                    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_295_16_295_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_16_295_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_294_9_294_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_9_294_14&#39;)"><span class="hl_varref"><span class="mpre">clean</span></span></a><span class="mpre"> </span><a href="#loc_295_18_295_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_18_295_19&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- tolerant of errors?  should parse</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- errors here be reported or ignored?</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- currently ignored.</span></span><span class="mpre">
        </span><a href="#loc_302_9_302_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_9_302_17&#39;)"><span class="mpre">catRslts</span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
        </span><a name="loc_302_9_302_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_9_302_17&#39;)"><span class="hl_fundecl"><span class="mpre">catRslts</span></span></a><span class="mpre"> </span><a name="loc_302_18_302_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_18_302_22&#39;)"><span class="hl_vardecl"><span class="mpre">list</span></span></a><span class="mpre"> (</span><a name="loc_302_24_302_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_24_302_25&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_302_26_302_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_26_302_27&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) = 
            case </span><a href="#loc_302_24_302_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_24_302_25&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> _ -&gt; </span><a href="#loc_302_9_302_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_9_302_17&#39;)"><span class="hl_varref"><span class="mpre">catRslts</span></span></a><span class="mpre"> </span><a href="#loc_302_18_302_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_18_302_22&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre"> </span><a href="#loc_302_26_302_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_26_302_27&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
                </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_305_23_305_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_23_305_24&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_302_9_302_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_9_302_17&#39;)"><span class="hl_varref"><span class="mpre">catRslts</span></span></a><span class="mpre"> (</span><a href="#loc_305_23_305_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_23_305_24&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_302_18_302_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_18_302_22&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre">) </span><a href="#loc_302_26_302_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_26_302_27&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
        </span><a href="#loc_302_9_302_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_9_302_17&#39;)"><span class="hl_fundecl"><span class="mpre">catRslts</span></span></a><span class="mpre"> </span><a name="loc_306_18_306_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_18_306_22&#39;)"><span class="hl_vardecl"><span class="mpre">list</span></span></a><span class="mpre"> [] = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_306_18_306_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_18_306_22&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre">            
</span></div></body></html>