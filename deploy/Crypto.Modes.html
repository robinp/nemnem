<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
</span><span class="hl_comment"><span class="mpre">{-|
 Maintainer: Thomas.DuBuisson@gmail.com
 Stability: beta
 Portability: portable 
 Authors: Thomas DuBuisson


 Generic mode implementations useable by any correct BlockCipher
 instance Be aware there are no tests for CFB mode yet.  See
 &#39;Test.Crypto&#39;.
-}</span></span><span class="mpre">
module Crypto.Modes (
        </span><span class="hl_comment"><span class="mpre">-- * Initialization Vector Type, Modifiers (for all ciphers, all modes that use IVs)</span></span><span class="mpre">
          dblIV
        </span><span class="hl_comment"><span class="mpre">-- * Authentication modes</span></span><span class="mpre">
        , cbcMac&#39;, cbcMac, cMac, cMac&#39;
        , cMacStar, cMacStar&#39;
        </span><span class="hl_comment"><span class="mpre">-- Combined modes (nothing here yet)</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- , gmc</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- , xts</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- , ccm</span></span><span class="mpre">
        ) where

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 18, srcSpanEndLine = 25, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 18, srcSpanEndLine = 26, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 8, srcSpanEndLine = 27, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Data.Serialize&quot;"><span class="mpre">Data.Serialize</span></span><span class="mpre">
import qualified Data.Serialize.Put as SP
import qualified Data.Serialize.Get as SG
import Data.Bits (</span><a href="Data.Bits.html#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_87_5_87_8&#39;)"><span class="mpre">xor</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="mpre">shift</span></a><span class="mpre">, (.&amp;.), (.|.), </span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="mpre">testBit</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_158_5_158_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_158_5_158_11&#39;)"><span class="mpre">setBit</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_161_5_161_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_161_5_161_13&#39;)"><span class="mpre">clearBit</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_79_15_79_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_79_15_79_19&#39;)"><span class="mpre">Bits</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_164_5_164_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_164_5_164_18&#39;)"><span class="mpre">complementBit</span></a><span class="mpre">)
import Data.Tagged
import Crypto.Classes (</span><a href="Crypto.Classes.html#loc_151_25_151_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_151_25_151_36&#39;)"><span class="mpre">BlockCipher</span></a><span class="mpre">(..), </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="mpre">for</span></a><span class="mpre">, </span><a href="Crypto.Classes.html#loc_455_1_455_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_455_1_455_15&#39;)"><span class="mpre">blockSizeBytes</span></a><span class="mpre">, </span><a href="Crypto.Classes.html#loc_668_1_668_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_668_1_668_6&#39;)"><span class="mpre">incIV</span></a><span class="mpre">, </span><a href="Crypto.Classes.html#loc_675_1_675_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_675_1_675_7&#39;)"><span class="mpre">zeroIV</span></a><span class="mpre">, </span><a href="Crypto.Classes.html#loc_686_1_686_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_686_1_686_9&#39;)"><span class="mpre">chunkFor</span></a><span class="mpre">, </span><a href="Crypto.Classes.html#loc_696_1_696_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_696_1_696_10&#39;)"><span class="mpre">chunkFor&#39;</span></a><span class="mpre">)
import Crypto.Random
import Crypto.Util
import Crypto.CPoly
import Crypto.Types
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 8, srcSpanEndLine = 37, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;System.Entropy&quot;"><span class="mpre">System.Entropy</span></span><span class="mpre"> (getEntropy)
import Control.Monad (</span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="mpre">liftM</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_168_1_168_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_168_1_168_6&#39;)"><span class="mpre">forM_</span></a><span class="mpre">)
import Data.List (</span><a href="Data.List.html#loc_607_1_607_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_607_1_607_12&#39;)"><span class="mpre">genericDrop</span></a><span class="mpre">)
import Data.Word (Word8)
import Data.List (</span><a href="Data.List.html#loc_607_1_607_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_607_1_607_12&#39;)"><span class="mpre">genericDrop</span></a><span class="mpre">,</span><a href="Data.List.html#loc_632_1_632_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_632_1_632_17&#39;)"><span class="mpre">genericReplicate</span></a><span class="mpre">,</span><a href="Data.List.html#loc_583_1_583_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_583_1_583_14&#39;)"><span class="mpre">genericLength</span></a><span class="mpre">)

#if MIN_VERSION_tagged(0,2,0)
import Data.Proxy
#endif

</span><span class="hl_comment"><span class="mpre">-- |Cipher block chaining message authentication</span></span><span class="mpre">
</span><a href="#loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="mpre">cbcMac&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 48, srcSpanStartColumn = 12, srcSpanEndLine = 48, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 48, srcSpanStartColumn = 26, srcSpanEndLine = 48, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="hl_fundecl"><span class="mpre">cbcMac&#39;</span></span></a><span class="mpre"> </span><a name="loc_49_9_49_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_49_11_49_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_11_49_13&#39;)"><span class="hl_vardecl"><span class="mpre">pt</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">encode</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_166_3_166_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_166_3_166_6&#39;)"><span class="hl_varref"><span class="mpre">cbc</span></span></a><span class="mpre"> </span><a href="#loc_49_9_49_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="Crypto.Classes.html#loc_675_1_675_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_675_1_675_7&#39;)"><span class="hl_varref"><span class="mpre">zeroIV</span></span></a><span class="mpre"> </span><a href="#loc_49_11_49_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_11_49_13&#39;)"><span class="hl_varref"><span class="mpre">pt</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE cbcMac&#39; #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Cipher block chaining message authentication</span></span><span class="mpre">
</span><a href="#loc_54_1_54_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_7&#39;)"><span class="mpre">cbcMac</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 11, srcSpanEndLine = 53, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 25, srcSpanEndLine = 53, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_54_1_54_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_7&#39;)"><span class="hl_fundecl"><span class="mpre">cbcMac</span></span></a><span class="mpre"> </span><a name="loc_54_8_54_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_8_54_9&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_54_10_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_10_54_12&#39;)"><span class="hl_vardecl"><span class="mpre">pt</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> [</span><span class="hl_varref"><span class="mpre">encode</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_203_3_203_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_203_3_203_10&#39;)"><span class="hl_varref"><span class="mpre">cbcLazy</span></span></a><span class="mpre"> </span><a href="#loc_54_8_54_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_8_54_9&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="Crypto.Classes.html#loc_675_1_675_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_675_1_675_7&#39;)"><span class="hl_varref"><span class="mpre">zeroIV</span></span></a><span class="mpre"> </span><a href="#loc_54_10_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_10_54_12&#39;)"><span class="hl_varref"><span class="mpre">pt</span></span></a><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">{-# INLINEABLE cbcMac #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Generate cmac subkeys.</span></span><span class="mpre">
</span><a href="#loc_59_1_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_9&#39;)"><span class="mpre">cMacSubk</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 58, srcSpanStartColumn = 13, srcSpanEndLine = 58, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 58, srcSpanStartColumn = 27, srcSpanEndLine = 58, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">)
</span><a name="loc_59_1_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_9&#39;)"><span class="hl_fundecl"><span class="mpre">cMacSubk</span></span></a><span class="mpre"> </span><a name="loc_59_10_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_10_59_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = (</span><a href="#loc_62_8_62_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_8_62_10&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre">, </span><a href="#loc_63_8_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_8_63_10&#39;)"><span class="hl_varref"><span class="mpre">k2</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> (</span><a href="#loc_62_8_62_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_8_62_10&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre">, </span><a href="#loc_63_8_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_8_63_10&#39;)"><span class="hl_varref"><span class="mpre">k2</span></span></a><span class="mpre">)
  where
       </span><a name="loc_61_8_61_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_8_61_13&#39;)"><span class="hl_vardecl"><span class="mpre">bSize</span></span></a><span class="mpre"> = </span><a href="Crypto.Classes.html#loc_455_1_455_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_455_1_455_15&#39;)"><span class="hl_varref"><span class="mpre">blockSizeBytes</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_59_10_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_10_59_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
       </span><a name="loc_62_8_62_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_8_62_10&#39;)"><span class="hl_vardecl"><span class="mpre">k1</span></span></a><span class="mpre"> = </span><a href="#loc_155_1_155_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_6&#39;)"><span class="hl_varref"><span class="mpre">dblIV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_59_10_59_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_10_59_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> </span><a href="#loc_61_8_61_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_8_61_13&#39;)"><span class="hl_varref"><span class="mpre">bSize</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
       </span><a name="loc_63_8_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_8_63_10&#39;)"><span class="hl_vardecl"><span class="mpre">k2</span></span></a><span class="mpre"> = </span><a href="#loc_155_1_155_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_6&#39;)"><span class="hl_varref"><span class="mpre">dblIV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_62_8_62_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_8_62_10&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Pad the string as required by the cmac algorithm. In theory this</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  should work at bit level but since the API works at byte level we</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  do the same</span></span><span class="mpre">
</span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="mpre">cMacPad</span></a><span class="mpre"> :: ([</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">], </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">,([</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">], </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">))
</span><a name="loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_fundecl"><span class="mpre">cMacPad</span></span></a><span class="mpre"> (_, _, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_fundecl"><span class="mpre">cMacPad</span></span></a><span class="mpre"> ([], </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><a name="loc_70_21_70_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_21_70_22&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,([], </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><a href="#loc_70_21_70_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_21_70_22&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">))
</span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_fundecl"><span class="mpre">cMacPad</span></span></a><span class="mpre"> ([], </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a name="loc_71_20_71_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_20_71_21&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">128</span></span><span class="mpre">,([], </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><a href="#loc_71_20_71_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_20_71_21&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">))
</span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_fundecl"><span class="mpre">cMacPad</span></span></a><span class="mpre"> (</span><a name="loc_72_10_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_72_12_72_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_12_72_14&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">, </span><a name="loc_72_16_72_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_16_72_17&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">, </span><a name="loc_72_19_72_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_19_72_20&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) =  </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_72_10_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,(</span><a href="#loc_72_12_72_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_12_72_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">, </span><a href="#loc_72_16_72_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_16_72_17&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">, </span><a href="#loc_72_19_72_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_19_72_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- |Obtain the cmac with the specified subkey for lazy bytestrings</span></span><span class="mpre">
</span><a href="#loc_76_1_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_13&#39;)"><span class="mpre">cMacWithSubK</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 17, srcSpanEndLine = 75, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 31, srcSpanEndLine = 75, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_76_1_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_13&#39;)"><span class="hl_fundecl"><span class="mpre">cMacWithSubK</span></span></a><span class="mpre"> </span><a name="loc_76_14_76_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_14_76_15&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_76_20_76_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_20_76_22&#39;)"><span class="hl_vardecl"><span class="mpre">k1</span></span></a><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_76_27_76_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_27_76_29&#39;)"><span class="hl_vardecl"><span class="mpre">k2</span></span></a><span class="mpre">) </span><a name="loc_76_31_76_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_31_76_32&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> [</span><a href="#loc_84_8_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_8_84_10&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="Crypto.Classes.html#loc_686_1_686_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_686_1_686_9&#39;)"><span class="hl_varref"><span class="mpre">chunkFor</span></span></a><span class="mpre"> </span><a href="#loc_76_14_76_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_14_76_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_80_9_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_10&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> </span><a href="#loc_78_8_78_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_8_78_14&#39;)"><span class="hl_varref"><span class="mpre">bSize1</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">]
  where
       </span><a name="loc_78_8_78_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_8_78_14&#39;)"><span class="hl_vardecl"><span class="mpre">bSize1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_455_1_455_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_455_1_455_15&#39;)"><span class="hl_varref"><span class="mpre">blockSizeBytes</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_76_14_76_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_14_76_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
       </span><a name="loc_79_8_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_8_79_14&#39;)"><span class="hl_vardecl"><span class="mpre">bSize2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_455_1_455_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_455_1_455_15&#39;)"><span class="hl_varref"><span class="mpre">blockSizeBytes</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_76_14_76_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_14_76_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
       (</span><a name="loc_80_9_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_9_80_10&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">,</span><a name="loc_80_11_80_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_11_80_12&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">L.splitAt</span></span><span class="mpre"> (((</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_76_31_76_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_31_76_32&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><a href="#loc_79_8_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_8_79_14&#39;)"><span class="hl_varref"><span class="mpre">bSize2</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_79_8_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_8_79_14&#39;)"><span class="hl_varref"><span class="mpre">bSize2</span></span></a><span class="mpre">) </span><a href="#loc_76_31_76_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_31_76_32&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
       </span><a name="loc_81_8_81_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_8_81_10&#39;)"><span class="hl_vardecl"><span class="mpre">pe</span></span></a><span class="mpre"> =  </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.unfoldrN</span></span><span class="mpre"> (</span><a href="#loc_78_8_78_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_8_78_14&#39;)"><span class="hl_varref"><span class="mpre">bSize1</span></span></a><span class="mpre">) </span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_varref"><span class="mpre">cMacPad</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.unpack</span></span><span class="mpre"> </span><a href="#loc_80_11_80_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_11_80_12&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><a href="#loc_78_8_78_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_8_78_14&#39;)"><span class="hl_varref"><span class="mpre">bSize1</span></span></a><span class="mpre">)
       </span><a name="loc_82_8_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_8_82_10&#39;)"><span class="hl_vardecl"><span class="mpre">fe</span></span></a><span class="mpre"> | </span><a href="#loc_79_8_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_8_79_14&#39;)"><span class="hl_varref"><span class="mpre">bSize2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_80_11_80_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_11_80_12&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> = </span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> </span><a href="#loc_76_20_76_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_20_76_22&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre"> </span><a href="#loc_81_8_81_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_8_81_10&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =  </span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> </span><a href="#loc_76_27_76_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_27_76_29&#39;)"><span class="hl_varref"><span class="mpre">k2</span></span></a><span class="mpre"> </span><a href="#loc_81_8_81_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_8_81_10&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre">
       </span><a name="loc_84_8_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_8_84_10&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] </span><a name="loc_84_14_84_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_14_84_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="Crypto.Classes.html#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_76_14_76_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_14_76_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> </span><a href="#loc_84_14_84_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_14_84_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_82_8_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_8_82_10&#39;)"><span class="hl_varref"><span class="mpre">fe</span></span></a><span class="mpre">)
       </span><a href="#loc_84_8_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_8_84_10&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_85_12_85_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_12_85_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_85_14_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_85_18_85_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_18_85_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_84_8_84_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_8_84_10&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_85_14_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_76_14_76_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_14_76_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> </span><a href="#loc_85_18_85_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_18_85_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_85_12_85_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_12_85_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Obtain the cmac for lazy bytestrings</span></span><span class="mpre">
</span><a href="#loc_89_1_89_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_5&#39;)"><span class="mpre">cMac</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 9, srcSpanEndLine = 88, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 23, srcSpanEndLine = 88, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_89_1_89_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_5&#39;)"><span class="hl_fundecl"><span class="mpre">cMac</span></span></a><span class="mpre"> </span><a name="loc_89_6_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_7&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_76_1_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_13&#39;)"><span class="hl_varref"><span class="mpre">cMacWithSubK</span></span></a><span class="mpre"> </span><a href="#loc_89_6_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_7&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_59_1_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_9&#39;)"><span class="hl_varref"><span class="mpre">cMacSubk</span></span></a><span class="mpre"> </span><a href="#loc_89_6_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_7&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |Obtain the cmac with the specified subkey for strict bytestrings</span></span><span class="mpre">
</span><a href="#loc_93_1_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_14&#39;)"><span class="mpre">cMacWithSubK&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 18, srcSpanEndLine = 92, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 32, srcSpanEndLine = 92, srcSpanEndColumn = 34}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; (</span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_93_1_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_14&#39;)"><span class="hl_fundecl"><span class="mpre">cMacWithSubK&#39;</span></span></a><span class="mpre"> </span><a name="loc_93_15_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_16&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_93_21_93_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_21_93_23&#39;)"><span class="hl_vardecl"><span class="mpre">k1</span></span></a><span class="mpre">, </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_93_28_93_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_28_93_30&#39;)"><span class="hl_vardecl"><span class="mpre">k2</span></span></a><span class="mpre">) </span><a name="loc_93_32_93_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_32_93_33&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_101_8_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_8_101_10&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="Crypto.Classes.html#loc_696_1_696_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_696_1_696_10&#39;)"><span class="hl_varref"><span class="mpre">chunkFor&#39;</span></span></a><span class="mpre"> </span><a href="#loc_93_15_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_16&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_97_9_97_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_10&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> </span><a href="#loc_95_8_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_8_95_14&#39;)"><span class="hl_varref"><span class="mpre">bSize1</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  where
       </span><a name="loc_95_8_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_8_95_14&#39;)"><span class="hl_vardecl"><span class="mpre">bSize1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_455_1_455_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_455_1_455_15&#39;)"><span class="hl_varref"><span class="mpre">blockSizeBytes</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_93_15_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_16&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
       </span><a name="loc_96_8_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_8_96_14&#39;)"><span class="hl_vardecl"><span class="mpre">bSize2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_455_1_455_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_455_1_455_15&#39;)"><span class="hl_varref"><span class="mpre">blockSizeBytes</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_93_15_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_16&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
       (</span><a name="loc_97_9_97_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_10&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">,</span><a name="loc_97_11_97_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_11_97_12&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> (((</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_93_32_93_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_32_93_33&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><a href="#loc_96_8_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_8_96_14&#39;)"><span class="hl_varref"><span class="mpre">bSize2</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_96_8_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_8_96_14&#39;)"><span class="hl_varref"><span class="mpre">bSize2</span></span></a><span class="mpre">) </span><a href="#loc_93_32_93_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_32_93_33&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
       </span><a name="loc_98_8_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_8_98_10&#39;)"><span class="hl_vardecl"><span class="mpre">pe</span></span></a><span class="mpre"> =  </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.unfoldrN</span></span><span class="mpre"> (</span><a href="#loc_95_8_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_8_95_14&#39;)"><span class="hl_varref"><span class="mpre">bSize1</span></span></a><span class="mpre">) </span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_varref"><span class="mpre">cMacPad</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.unpack</span></span><span class="mpre"> </span><a href="#loc_97_11_97_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_11_97_12&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><a href="#loc_95_8_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_8_95_14&#39;)"><span class="hl_varref"><span class="mpre">bSize1</span></span></a><span class="mpre">)
       </span><a name="loc_99_8_99_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_8_99_10&#39;)"><span class="hl_vardecl"><span class="mpre">fe</span></span></a><span class="mpre"> | </span><a href="#loc_96_8_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_8_96_14&#39;)"><span class="hl_varref"><span class="mpre">bSize2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_97_11_97_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_11_97_12&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> = </span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> </span><a href="#loc_93_21_93_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_21_93_23&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre"> </span><a href="#loc_98_8_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_8_98_10&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =  </span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> </span><a href="#loc_93_28_93_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_28_93_30&#39;)"><span class="hl_varref"><span class="mpre">k2</span></span></a><span class="mpre"> </span><a href="#loc_98_8_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_8_98_10&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre">
       </span><a name="loc_101_8_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_8_101_10&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] </span><a name="loc_101_14_101_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="Crypto.Classes.html#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_93_15_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_16&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> </span><a href="#loc_101_14_101_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_99_8_99_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_8_99_10&#39;)"><span class="hl_varref"><span class="mpre">fe</span></span></a><span class="mpre">)
       </span><a href="#loc_101_8_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_8_101_10&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_102_12_102_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_12_102_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_102_14_102_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_14_102_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_102_18_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_101_8_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_8_101_10&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_102_14_102_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_14_102_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_153_3_153_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_153_3_153_15&#39;)"><span class="hl_varref"><span class="mpre">encryptBlock</span></span></a><span class="mpre"> </span><a href="#loc_93_15_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_16&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> </span><a href="#loc_102_18_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_102_12_102_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_12_102_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Obtain the cmac for strict bytestrings</span></span><span class="mpre">
</span><a href="#loc_106_1_106_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_6&#39;)"><span class="mpre">cMac&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 10, srcSpanEndLine = 105, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 24, srcSpanEndLine = 105, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Cr"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_106_1_106_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_6&#39;)"><span class="hl_fundecl"><span class="mpre">cMac&#39;</span></span></a><span class="mpre"> </span><a name="loc_106_7_106_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_7_106_8&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_93_1_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_14&#39;)"><span class="hl_varref"><span class="mpre">cMacWithSubK&#39;</span></span></a><span class="mpre"> </span><a href="#loc_106_7_106_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_7_106_8&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_59_1_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_9&#39;)"><span class="hl_varref"><span class="mpre">cMacSubk</span></span></a><span class="mpre"> </span><a href="#loc_106_7_106_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_7_106_8&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)

</span><a href="#loc_109_1_109_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_9&#39;)"><span class="mpre">cMacStar</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 108, srcSpanStartColumn = 13, srcSpanEndLine = 108, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 108, srcSpanStartColumn = 27, srcSpanEndLine = 108, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Cr"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_109_1_109_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_9&#39;)"><span class="hl_fundecl"><span class="mpre">cMacStar</span></span></a><span class="mpre"> </span><a name="loc_109_10_109_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_10_109_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_109_12_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_12_109_13&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_114_9_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_113_9_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_14&#39;)"><span class="hl_varref"><span class="mpre">lcmac</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.replicate</span></span><span class="mpre"> </span><a href="#loc_111_9_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_14&#39;)"><span class="hl_varref"><span class="mpre">bSize</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)) </span><a href="#loc_109_12_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_12_109_13&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
  where
        </span><a name="loc_111_9_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_14&#39;)"><span class="hl_vardecl"><span class="mpre">bSize</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_455_1_455_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_455_1_455_15&#39;)"><span class="hl_varref"><span class="mpre">blockSizeBytes</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_109_10_109_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_10_109_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
        </span><span class="hl_vardecl"><span class="mpre">bSizeb</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_152_3_152_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_152_3_152_12&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_109_10_109_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_10_109_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
        </span><a name="loc_113_9_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_14&#39;)"><span class="hl_vardecl"><span class="mpre">lcmac</span></span></a><span class="mpre"> = </span><a href="#loc_76_1_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_13&#39;)"><span class="hl_varref"><span class="mpre">cMacWithSubK</span></span></a><span class="mpre"> </span><a href="#loc_109_10_109_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_10_109_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_59_1_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_9&#39;)"><span class="hl_varref"><span class="mpre">cMacSubk</span></span></a><span class="mpre"> </span><a href="#loc_109_10_109_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_10_109_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
        </span><a name="loc_114_9_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_114_12_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_12_114_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> [] = </span><a href="#loc_114_12_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_12_114_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
        </span><a href="#loc_114_9_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_115_12_115_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_12_115_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> [</span><a name="loc_115_15_115_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_15_115_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">] | (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_115_15_115_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_15_115_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_111_9_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_14&#39;)"><span class="hl_varref"><span class="mpre">bSize</span></span></a><span class="mpre"> = </span><a href="#loc_113_9_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_14&#39;)"><span class="hl_varref"><span class="mpre">lcmac</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Util.html#loc_97_1_97_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_97_1_97_4&#39;)"><span class="hl_varref"><span class="mpre">zwp</span></span></a><span class="mpre"> </span><a href="#loc_115_15_115_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_15_115_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.unfoldr</span></span><span class="mpre"> (</span><a href="#loc_133_1_133_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_7&#39;)"><span class="hl_varref"><span class="mpre">xorend</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_111_9_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_14&#39;)"><span class="hl_varref"><span class="mpre">bSize</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_115_15_115_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_15_115_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><span class="hl_varref"><span class="mpre">L.unpack</span></span><span class="mpre"> </span><a href="#loc_115_12_115_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_12_115_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
                 | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_113_9_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_14&#39;)"><span class="hl_varref"><span class="mpre">lcmac</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Util.html#loc_97_1_97_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_97_1_97_4&#39;)"><span class="hl_varref"><span class="mpre">zwp</span></span></a><span class="mpre"> (</span><a href="#loc_164_1_164_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_5&#39;)"><span class="hl_varref"><span class="mpre">dblL</span></span></a><span class="mpre"> </span><a href="#loc_115_12_115_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_12_115_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">L.unfoldr</span></span><span class="mpre"> </span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_varref"><span class="mpre">cMacPad</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.unpack</span></span><span class="mpre"> </span><a href="#loc_115_15_115_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_15_115_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_111_9_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_9_111_14&#39;)"><span class="hl_varref"><span class="mpre">bSize</span></span></a><span class="mpre">))
        </span><a href="#loc_114_9_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_117_12_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_12_117_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a name="loc_117_15_117_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_15_117_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_117_17_117_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_17_117_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_114_9_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="Crypto.Util.html#loc_97_1_97_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_97_1_97_4&#39;)"><span class="hl_varref"><span class="mpre">zwp</span></span></a><span class="mpre"> (</span><a href="#loc_164_1_164_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_5&#39;)"><span class="hl_varref"><span class="mpre">dblL</span></span></a><span class="mpre"> </span><a href="#loc_117_12_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_12_117_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) (</span><a href="#loc_113_9_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_14&#39;)"><span class="hl_varref"><span class="mpre">lcmac</span></span></a><span class="mpre"> </span><a href="#loc_117_15_117_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_15_117_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)) </span><a href="#loc_117_17_117_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_17_117_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Obtain the CMAC* on strict bytestrings</span></span><span class="mpre">
</span><a href="#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="mpre">cMacStar&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 14, srcSpanEndLine = 120, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 28, srcSpanEndLine = 120, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Cr"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_121_1_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_10&#39;)"><span class="hl_fundecl"><span class="mpre">cMacStar&#39;</span></span></a><span class="mpre"> </span><a name="loc_121_11_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_121_13_121_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_13_121_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_126_8_126_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_8_126_10&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_125_8_125_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_8_125_13&#39;)"><span class="hl_varref"><span class="mpre">lcmac</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> </span><a href="#loc_123_8_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_8_123_13&#39;)"><span class="hl_varref"><span class="mpre">bSize</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)) </span><a href="#loc_121_13_121_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_13_121_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
  where
       </span><a name="loc_123_8_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_8_123_13&#39;)"><span class="hl_vardecl"><span class="mpre">bSize</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_455_1_455_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_455_1_455_15&#39;)"><span class="hl_varref"><span class="mpre">blockSizeBytes</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_121_11_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
       </span><span class="hl_vardecl"><span class="mpre">bSizeb</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Classes.html#loc_152_3_152_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Classes.html#loc_152_3_152_12&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="Crypto.Util.html#loc_46_1_46_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_46_1_46_4&#39;)"><span class="hl_infix"><span class="mpre">`for`</span></span></a><span class="mpre"> </span><a href="#loc_121_11_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
       </span><a name="loc_125_8_125_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_8_125_13&#39;)"><span class="hl_vardecl"><span class="mpre">lcmac</span></span></a><span class="mpre"> = </span><a href="#loc_93_1_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_14&#39;)"><span class="hl_varref"><span class="mpre">cMacWithSubK&#39;</span></span></a><span class="mpre"> </span><a href="#loc_121_11_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_59_1_59_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_9&#39;)"><span class="hl_varref"><span class="mpre">cMacSubk</span></span></a><span class="mpre"> </span><a href="#loc_121_11_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
       </span><a name="loc_126_8_126_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_8_126_10&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_126_11_126_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> [] = </span><a href="#loc_126_11_126_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
       </span><a href="#loc_126_8_126_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_8_126_10&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_127_11_127_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_11_127_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> [</span><a name="loc_127_14_127_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_14_127_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">] | (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_127_14_127_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_14_127_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_123_8_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_8_123_13&#39;)"><span class="hl_varref"><span class="mpre">bSize</span></span></a><span class="mpre"> = </span><a href="#loc_125_8_125_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_8_125_13&#39;)"><span class="hl_varref"><span class="mpre">lcmac</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> </span><a href="#loc_127_14_127_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_14_127_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.unfoldrN</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_127_14_127_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_14_127_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><a href="#loc_133_1_133_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_7&#39;)"><span class="hl_varref"><span class="mpre">xorend</span></span></a><span class="mpre"> </span><a href="#loc_123_8_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_8_123_13&#39;)"><span class="hl_varref"><span class="mpre">bSize</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_127_14_127_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_14_127_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><span class="hl_varref"><span class="mpre">B.unpack</span></span><span class="mpre"> </span><a href="#loc_127_11_127_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_11_127_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_125_8_125_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_8_125_13&#39;)"><span class="hl_varref"><span class="mpre">lcmac</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_159_1_159_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_5&#39;)"><span class="hl_varref"><span class="mpre">dblB</span></span></a><span class="mpre"> </span><a href="#loc_127_11_127_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_11_127_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.unfoldrN</span></span><span class="mpre"> </span><a href="#loc_123_8_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_8_123_13&#39;)"><span class="hl_varref"><span class="mpre">bSize</span></span></a><span class="mpre"> </span><a href="#loc_69_1_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_8&#39;)"><span class="hl_varref"><span class="mpre">cMacPad</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.unpack</span></span><span class="mpre"> </span><a href="#loc_127_14_127_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_14_127_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,</span><a href="#loc_123_8_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_8_123_13&#39;)"><span class="hl_varref"><span class="mpre">bSize</span></span></a><span class="mpre">))
       </span><a href="#loc_126_8_126_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_8_126_10&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_129_11_129_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_11_129_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a name="loc_129_14_129_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_14_129_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_129_16_129_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_16_129_18&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_126_8_126_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_8_126_10&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="Crypto.Util.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Util.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">zwp&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_159_1_159_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_5&#39;)"><span class="hl_varref"><span class="mpre">dblB</span></span></a><span class="mpre"> </span><a href="#loc_129_11_129_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_11_129_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) (</span><a href="#loc_125_8_125_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_8_125_13&#39;)"><span class="hl_varref"><span class="mpre">lcmac</span></span></a><span class="mpre"> </span><a href="#loc_129_14_129_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_14_129_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)) </span><a href="#loc_129_16_129_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_16_129_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> 

</span><span class="hl_comment"><span class="mpre">-- |Generate the xor stream for the last step of the CMAC* algorithm</span></span><span class="mpre">
</span><a href="#loc_133_1_133_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_7&#39;)"><span class="mpre">xorend</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]) -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">,(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]))
</span><a name="loc_133_1_133_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_7&#39;)"><span class="hl_fundecl"><span class="mpre">xorend</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">bsize</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, []) = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><a href="#loc_133_1_133_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_7&#39;)"><span class="hl_fundecl"><span class="mpre">xorend</span></span></a><span class="mpre"> </span><a name="loc_134_8_134_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_8_134_13&#39;)"><span class="hl_vardecl"><span class="mpre">bsize</span></span></a><span class="mpre"> (</span><a name="loc_134_15_134_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_15_134_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">, </span><a name="loc_134_18_134_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_18_134_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_134_20_134_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_20_134_22&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) | </span><a href="#loc_134_15_134_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_15_134_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_134_8_134_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_8_134_13&#39;)"><span class="hl_varref"><span class="mpre">bsize</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_134_18_134_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_18_134_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,((</span><a href="#loc_134_15_134_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_15_134_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">),</span><a href="#loc_134_20_134_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_20_134_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">))
                       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,((</span><a href="#loc_134_15_134_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_15_134_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">),(</span><a href="#loc_134_18_134_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_18_134_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_134_20_134_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_20_134_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)))

</span><span class="hl_comment"><span class="mpre">-- |Accumulator based double operation</span></span><span class="mpre">
</span><a href="#loc_139_1_139_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_5&#39;)"><span class="mpre">dblw</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">],</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; ((</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">],</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">), </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
</span><a name="loc_139_1_139_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_5&#39;)"><span class="hl_fundecl"><span class="mpre">dblw</span></span></a><span class="mpre"> </span><a name="loc_139_6_139_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_6_139_8&#39;)"><span class="hl_vardecl"><span class="mpre">hb</span></span></a><span class="mpre"> (</span><a name="loc_139_10_139_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_10_139_11&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">,</span><a name="loc_139_12_139_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_12_139_14&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a name="loc_139_15_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_16&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) </span><a name="loc_139_18_139_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_18_139_19&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_150_8_150_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_8_150_13&#39;)"><span class="hl_varref"><span class="mpre">dblw&#39;</span></span></a><span class="mpre"> </span><a href="#loc_139_6_139_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_6_139_8&#39;)"><span class="hl_varref"><span class="mpre">hb</span></span></a><span class="mpre">
  where
       </span><a name="loc_141_8_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_8_141_11&#39;)"><span class="hl_fundecl"><span class="mpre">slw</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a name="loc_141_17_141_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_17_141_18&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = (</span><a href="Data.Bits.html#loc_158_5_158_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_158_5_158_11&#39;)"><span class="hl_varref"><span class="mpre">setBit</span></span></a><span class="mpre"> (</span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre"> </span><a href="#loc_141_17_141_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_17_141_18&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
       </span><a href="#loc_141_8_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_8_141_11&#39;)"><span class="hl_fundecl"><span class="mpre">slw</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a name="loc_142_18_142_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_18_142_19&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = (</span><a href="Data.Bits.html#loc_161_5_161_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_161_5_161_13&#39;)"><span class="hl_varref"><span class="mpre">clearBit</span></span></a><span class="mpre"> (</span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre"> </span><a href="#loc_142_18_142_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_18_142_19&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
       </span><a name="loc_143_8_143_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_8_143_14&#39;)"><span class="hl_fundecl"><span class="mpre">cpolyw</span></span></a><span class="mpre"> </span><a name="loc_143_15_143_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_15_143_16&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> [] </span><a name="loc_143_20_143_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_20_143_21&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = ((</span><a href="#loc_143_15_143_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_15_143_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,[]),</span><a href="#loc_143_20_143_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_20_143_21&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)
       </span><a href="#loc_143_8_143_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_8_143_14&#39;)"><span class="hl_fundecl"><span class="mpre">cpolyw</span></span></a><span class="mpre"> </span><a name="loc_144_15_144_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_15_144_16&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a name="loc_144_18_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_18_144_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_144_20_144_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_20_144_22&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_144_24_144_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_24_144_25&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">
         | </span><a href="#loc_144_18_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_18_144_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_144_15_144_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_15_144_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> = (\(</span><a name="loc_145_26_145_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_26_145_27&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_145_28_145_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_28_145_29&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_145_26_145_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_26_145_27&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="Data.Bits.html#loc_164_5_164_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_164_5_164_18&#39;)"><span class="hl_varref"><span class="mpre">complementBit</span></span></a><span class="mpre"> </span><a href="#loc_145_28_145_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_28_145_29&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (</span><a href="#loc_144_18_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_18_144_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_144_15_144_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_15_144_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">))) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_143_8_143_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_8_143_14&#39;)"><span class="hl_varref"><span class="mpre">cpolyw</span></span></a><span class="mpre"> </span><a href="#loc_144_15_144_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_15_144_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_144_20_144_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_20_144_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_144_24_144_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_24_144_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">
         |</span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = ((</span><a href="#loc_144_15_144_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_15_144_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,(</span><a href="#loc_144_18_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_18_144_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_144_20_144_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_20_144_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)),</span><a href="#loc_144_24_144_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_24_144_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)
       </span><a name="loc_147_8_147_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_8_147_10&#39;)"><span class="hl_vardecl"><span class="mpre">b&#39;</span></span></a><span class="mpre"> = </span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="hl_varref"><span class="mpre">testBit</span></span></a><span class="mpre"> </span><a href="#loc_139_18_139_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_18_139_19&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">
       </span><a name="loc_148_8_148_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_8_148_10&#39;)"><span class="hl_vardecl"><span class="mpre">w&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_141_8_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_8_141_11&#39;)"><span class="hl_varref"><span class="mpre">slw</span></span></a><span class="mpre"> </span><a href="#loc_139_15_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_16&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_139_18_139_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_18_139_19&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">
       ((</span><a name="loc_149_10_149_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_10_149_12&#39;)"><span class="hl_vardecl"><span class="mpre">i&#39;</span></span></a><span class="mpre">,</span><a name="loc_149_13_149_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_13_149_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs&#39;</span></span></a><span class="mpre">),</span><a name="loc_149_18_149_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_18_149_21&#39;)"><span class="hl_vardecl"><span class="mpre">w&#39;&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_143_8_143_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_8_143_14&#39;)"><span class="hl_varref"><span class="mpre">cpolyw</span></span></a><span class="mpre"> </span><a href="#loc_139_10_139_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_10_139_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_139_12_139_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_12_139_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_148_8_148_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_8_148_10&#39;)"><span class="hl_varref"><span class="mpre">w&#39;</span></span></a><span class="mpre">
       </span><a name="loc_150_8_150_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_8_150_13&#39;)"><span class="hl_fundecl"><span class="mpre">dblw&#39;</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> = </span><a href="#loc_149_10_149_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_10_149_12&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="hl_infix"><span class="mpre">`seq`</span></span><a href="#loc_149_13_149_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_13_149_16&#39;)"><span class="hl_varref"><span class="mpre">xs&#39;</span></span></a><span class="hl_infix"><span class="mpre">`seq`</span></span><a href="#loc_149_18_149_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_18_149_21&#39;)"><span class="hl_varref"><span class="mpre">w&#39;&#39;</span></span></a><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre">((</span><a href="#loc_139_10_139_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_10_139_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">,</span><a href="#loc_139_12_139_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_12_139_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a href="#loc_147_8_147_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_8_147_10&#39;)"><span class="hl_varref"><span class="mpre">b&#39;</span></span></a><span class="mpre">),</span><a href="#loc_148_8_148_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_8_148_10&#39;)"><span class="hl_varref"><span class="mpre">w&#39;</span></span></a><span class="mpre">)
       </span><a href="#loc_150_8_150_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_8_150_13&#39;)"><span class="hl_fundecl"><span class="mpre">dblw&#39;</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">  = ((</span><a href="#loc_149_10_149_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_10_149_12&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="mpre">,</span><a href="#loc_149_13_149_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_13_149_16&#39;)"><span class="hl_varref"><span class="mpre">xs&#39;</span></span></a><span class="mpre">,</span><a href="#loc_147_8_147_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_8_147_10&#39;)"><span class="hl_varref"><span class="mpre">b&#39;</span></span></a><span class="mpre">),</span><a href="#loc_149_18_149_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_18_149_21&#39;)"><span class="hl_varref"><span class="mpre">w&#39;&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |Perform doubling as defined by the CMAC and SIV papers</span></span><span class="mpre">
</span><a href="#loc_155_1_155_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_6&#39;)"><span class="mpre">dblIV</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 154, srcSpanStartColumn = 10, srcSpanEndLine = 154, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 154, srcSpanStartColumn = 24, srcSpanEndLine = 154, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Cr"><span class="mpre">BlockCipher k =&gt;</span></span><span class="mpre"> </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.html#loc_19_6_19_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_6_19_8&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">
</span><a name="loc_155_1_155_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_1_155_6&#39;)"><span class="hl_fundecl"><span class="mpre">dblIV</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_155_11_155_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_12&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="Crypto.Types.html#loc_19_13_19_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.html#loc_19_13_19_15&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_159_1_159_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_5&#39;)"><span class="hl_varref"><span class="mpre">dblB</span></span></a><span class="mpre"> </span><a href="#loc_155_11_155_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Perform doubling as defined by the CMAC and SIV papers</span></span><span class="mpre">
</span><a href="#loc_159_1_159_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_5&#39;)"><span class="mpre">dblB</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_159_1_159_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_5&#39;)"><span class="hl_fundecl"><span class="mpre">dblB</span></span></a><span class="mpre"> </span><a name="loc_159_6_159_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_6_159_7&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_159_6_159_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_6_159_7&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_159_6_159_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_6_159_7&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.mapAccumR</span></span><span class="mpre"> (</span><a href="#loc_139_1_139_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_5&#39;)"><span class="hl_varref"><span class="mpre">dblw</span></span></a><span class="mpre"> (</span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="hl_varref"><span class="mpre">testBit</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.head</span></span><span class="mpre"> </span><a href="#loc_159_6_159_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_6_159_7&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">)) (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><a href="Crypto.CPoly.html#loc_37_1_37_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.CPoly.html#loc_37_1_37_14&#39;)"><span class="hl_varref"><span class="mpre">cpoly2revlist</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_159_6_159_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_6_159_7&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">),</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">) </span><a href="#loc_159_6_159_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_6_159_7&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Perform doubling as defined by the CMAC and SIV papers</span></span><span class="mpre">
</span><a href="#loc_164_1_164_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_5&#39;)"><span class="mpre">dblL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_164_1_164_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_5&#39;)"><span class="hl_fundecl"><span class="mpre">dblL</span></span></a><span class="mpre"> </span><a name="loc_164_6_164_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_6_164_7&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">L.null</span></span><span class="mpre"> </span><a href="#loc_164_6_164_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_6_164_7&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_164_6_164_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_6_164_7&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.mapAccumR</span></span><span class="mpre"> (</span><a href="#loc_139_1_139_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_5&#39;)"><span class="hl_varref"><span class="mpre">dblw</span></span></a><span class="mpre"> (</span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="hl_varref"><span class="mpre">testBit</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.head</span></span><span class="mpre"> </span><a href="#loc_164_6_164_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_6_164_7&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">)) (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><a href="Crypto.CPoly.html#loc_37_1_37_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.CPoly.html#loc_37_1_37_14&#39;)"><span class="hl_varref"><span class="mpre">cpoly2revlist</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_164_6_164_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_6_164_7&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">),</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">) </span><a href="#loc_164_6_164_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_6_164_7&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
 
</span><span class="hl_comment"><span class="mpre">-- |Cast a bigEndian ByteString into an Integer</span></span><span class="mpre">
</span><a href="#loc_169_1_169_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_8&#39;)"><span class="mpre">decodeB</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_169_1_169_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_8&#39;)"><span class="hl_vardecl"><span class="mpre">decodeB</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.foldl&#39;</span></span><span class="mpre"> (\</span><a name="loc_169_22_169_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_22_169_25&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_169_26_169_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_26_169_27&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> -&gt; (</span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre"> </span><a href="#loc_169_22_169_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_22_169_25&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre">(</span><a href="#loc_169_26_169_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_26_169_27&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Cast an Integer into a bigEndian ByteString of size k.  It will</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- drop the MSBs in case the number is bigger than k and add 00s if it</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is smaller.</span></span><span class="mpre">
</span><a href="#loc_175_1_175_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_8&#39;)"><span class="mpre">encodeB</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 12, srcSpanEndLine = 174, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 12, srcSpanEndLine = 174, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 174, "><span class="mpre">(Ord a,Num a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_175_1_175_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_8&#39;)"><span class="hl_fundecl"><span class="mpre">encodeB</span></span></a><span class="mpre"> </span><a name="loc_175_9_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_9_175_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_175_11_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_11_175_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> if </span><a href="#loc_184_8_184_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_8_184_10&#39;)"><span class="hl_varref"><span class="mpre">lr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_175_9_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_9_175_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> then </span><a href="#loc_181_8_181_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_8_181_13&#39;)"><span class="hl_varref"><span class="mpre">takel</span></span></a><span class="mpre"> (</span><a href="#loc_184_8_184_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_8_184_10&#39;)"><span class="hl_varref"><span class="mpre">lr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_175_9_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_9_175_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_183_8_183_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_8_183_9&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> else </span><a href="#loc_179_8_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_8_179_11&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre"> (</span><a href="#loc_175_9_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_9_175_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_184_8_184_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_8_184_10&#39;)"><span class="hl_varref"><span class="mpre">lr</span></span></a><span class="mpre">) </span><a href="#loc_183_8_183_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_8_183_9&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
  where
       </span><a name="loc_177_8_177_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_8_177_10&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_177_13_177_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_13_177_15&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_177_13_177_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_13_177_15&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> 
       </span><a href="#loc_177_8_177_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_8_177_10&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_178_11_178_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_11_178_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_178_13_178_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_13_178_15&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_177_8_177_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_8_177_10&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre"> </span><a href="#loc_178_11_178_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_11_178_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (-</span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)) (</span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> (</span><a href="#loc_178_11_178_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_11_178_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">255</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_178_13_178_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_13_178_15&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
       </span><a name="loc_179_8_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_8_179_11&#39;)"><span class="hl_fundecl"><span class="mpre">pad</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_179_14_179_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_14_179_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_179_14_179_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_14_179_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
       </span><a href="#loc_179_8_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_8_179_11&#39;)"><span class="hl_fundecl"><span class="mpre">pad</span></span></a><span class="mpre"> </span><a name="loc_180_12_180_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_12_180_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_180_14_180_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_14_180_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_179_8_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_8_179_11&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre"> (</span><a href="#loc_180_12_180_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_12_180_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_180_14_180_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_14_180_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
       </span><a name="loc_181_8_181_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_8_181_13&#39;)"><span class="hl_fundecl"><span class="mpre">takel</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_181_16_181_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_16_181_18&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_181_16_181_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_16_181_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
       </span><a href="#loc_181_8_181_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_8_181_13&#39;)"><span class="hl_fundecl"><span class="mpre">takel</span></span></a><span class="mpre"> </span><a name="loc_182_14_182_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_14_182_15&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_182_19_182_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_19_182_21&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_181_8_181_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_8_181_13&#39;)"><span class="hl_varref"><span class="mpre">takel</span></span></a><span class="mpre"> (</span><a href="#loc_182_14_182_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_14_182_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_182_19_182_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_19_182_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
       </span><a name="loc_183_8_183_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_8_183_9&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_177_8_177_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_8_177_10&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_175_11_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_11_175_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> []
       </span><a name="loc_184_8_184_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_8_184_10&#39;)"><span class="hl_vardecl"><span class="mpre">lr</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_583_1_583_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_583_1_583_14&#39;)"><span class="hl_varref"><span class="mpre">genericLength</span></span></a><span class="mpre"> </span><a href="#loc_183_8_183_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_8_183_9&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Cast a bigEndian ByteString into an Integer</span></span><span class="mpre">
</span><a href="#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_8&#39;)"><span class="mpre">decodeL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_188_1_188_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_8&#39;)"><span class="hl_vardecl"><span class="mpre">decodeL</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.foldl&#39;</span></span><span class="mpre"> (\</span><a name="loc_188_22_188_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_22_188_25&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_188_26_188_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_26_188_27&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> -&gt; (</span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre"> </span><a href="#loc_188_22_188_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_22_188_25&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toInteger</span></span><span class="mpre">(</span><a href="#loc_188_26_188_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_26_188_27&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Cast an Integer into a bigEndian ByteString of size k.  It will</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- drop the MSBs in case the number is bigger than k and add 00s if it</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is smaller.</span></span><span class="mpre">
</span><a href="#loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="mpre">encodeL</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 193, srcSpanStartColumn = 12, srcSpanEndLine = 193, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 193, srcSpanStartColumn = 12, srcSpanEndLine = 193, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-api-0.13/Crypto/Modes.hs&quot;, srcSpanStartLine = 193, "><span class="mpre">(Ord a,Num a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="hl_fundecl"><span class="mpre">encodeL</span></span></a><span class="mpre"> </span><a name="loc_194_9_194_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_194_11_194_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_11_194_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> if </span><a href="#loc_202_9_202_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_9_202_11&#39;)"><span class="hl_varref"><span class="mpre">lr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_194_9_194_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> then </span><a href="#loc_199_9_199_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_9_199_14&#39;)"><span class="hl_varref"><span class="mpre">takel</span></span></a><span class="mpre"> (</span><a href="#loc_202_9_202_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_9_202_11&#39;)"><span class="hl_varref"><span class="mpre">lr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_194_9_194_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_201_9_201_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> else </span><a href="#loc_197_9_197_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_12&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre"> (</span><a href="#loc_194_9_194_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_9_194_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_202_9_202_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_9_202_11&#39;)"><span class="hl_varref"><span class="mpre">lr</span></span></a><span class="mpre">) </span><a href="#loc_201_9_201_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
  where </span><a name="loc_195_9_195_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_195_14_195_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_14_195_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_195_14_195_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_14_195_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> 
        </span><a href="#loc_195_9_195_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_196_12_196_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_12_196_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_196_14_196_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_14_196_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_195_9_195_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="Data.Bits.html#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">shift</span></span></a><span class="mpre"> </span><a href="#loc_196_12_196_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_12_196_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (-</span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)) (</span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> (</span><a href="#loc_196_12_196_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_12_196_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">255</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_196_14_196_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_14_196_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
        </span><a name="loc_197_9_197_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_12&#39;)"><span class="hl_fundecl"><span class="mpre">pad</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_197_15_197_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_15_197_17&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_197_15_197_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_15_197_17&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_197_9_197_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_12&#39;)"><span class="hl_fundecl"><span class="mpre">pad</span></span></a><span class="mpre"> </span><a name="loc_198_13_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_13_198_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_198_15_198_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_15_198_17&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_197_9_197_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_12&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre"> (</span><a href="#loc_198_13_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_13_198_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_198_15_198_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_15_198_17&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a name="loc_199_9_199_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_9_199_14&#39;)"><span class="hl_fundecl"><span class="mpre">takel</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_199_17_199_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_17_199_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_199_17_199_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_17_199_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a href="#loc_199_9_199_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_9_199_14&#39;)"><span class="hl_fundecl"><span class="mpre">takel</span></span></a><span class="mpre"> </span><a name="loc_200_15_200_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_15_200_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_200_20_200_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_20_200_22&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_199_9_199_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_9_199_14&#39;)"><span class="hl_varref"><span class="mpre">takel</span></span></a><span class="mpre"> (</span><a href="#loc_200_15_200_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_15_200_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_200_20_200_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_20_200_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><a name="loc_201_9_201_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_10&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_195_9_195_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_194_11_194_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_11_194_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> []
        </span><a name="loc_202_9_202_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_9_202_11&#39;)"><span class="hl_vardecl"><span class="mpre">lr</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_583_1_583_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_583_1_583_14&#39;)"><span class="hl_varref"><span class="mpre">genericLength</span></span></a><span class="mpre"> </span><a href="#loc_201_9_201_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- TODO: GCM, GMAC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Consider the AES-only modes of XTS, CCM</span></span><span class="mpre">
</span></div></body></html>