<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}

module Timer (timer) where

import Control.Exception (</span><a href="GHC.IO.html#loc_480_1_480_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_480_1_480_9&#39;)"><span class="mpre">evaluate</span></a><span class="mpre">)
import Data.Time.Clock.POSIX (</span><a href="Data.Time.Clock.POSIX.html#loc_51_1_51_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.POSIX.html#loc_51_1_51_13&#39;)"><span class="mpre">getPOSIXTime</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/benchmarks/haskell/Timer.hs&quot;, srcSpanStartLine = 7, srcSpanStartColumn = 8, srcSpanEndLine = 7, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;GHC.Float&quot;"><span class="mpre">GHC.Float</span></span><span class="mpre"> (FFFormat(..), formatRealFloat)

</span><a href="#loc_10_1_10_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_10&#39;)"><span class="mpre">ickyRound</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_10_1_10_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_10&#39;)"><span class="hl_fundecl"><span class="mpre">ickyRound</span></span></a><span class="mpre"> </span><a name="loc_10_11_10_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_11_10_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">formatRealFloat</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">FFFixed</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_10_11_10_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_11_10_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)

</span><a href="#loc_13_1_13_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_1_13_6&#39;)"><span class="mpre">timer</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_13_1_13_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_1_13_6&#39;)"><span class="hl_fundecl"><span class="mpre">timer</span></span></a><span class="mpre"> </span><a name="loc_13_7_13_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_7_13_12&#39;)"><span class="hl_vardecl"><span class="mpre">count</span></span></a><span class="mpre"> </span><a name="loc_13_13_13_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_13_13_15&#39;)"><span class="hl_vardecl"><span class="mpre">a0</span></span></a><span class="mpre"> </span><a name="loc_13_16_13_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_16_13_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
  let </span><a name="loc_14_7_14_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_7_14_11&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_14_13_14_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_13_14_14&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> !</span><a name="loc_14_16_14_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_16_14_23&#39;)"><span class="hl_vardecl"><span class="mpre">fastest</span></span></a><span class="mpre">
        | </span><a href="#loc_14_13_14_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_13_14_14&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_14_16_14_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_16_14_23&#39;)"><span class="hl_varref"><span class="mpre">fastest</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
        </span><a name="loc_17_9_17_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_14&#39;)"><span class="hl_vardecl"><span class="mpre">start</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Time.Clock.POSIX.html#loc_51_1_51_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.POSIX.html#loc_51_1_51_13&#39;)"><span class="hl_varref"><span class="mpre">getPOSIXTime</span></span></a><span class="mpre">
        let </span><a name="loc_18_13_18_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_13_18_18&#39;)"><span class="hl_fundecl"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a name="loc_18_19_18_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_19_18_20&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_18_21_18_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_21_18_22&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
              | </span><a href="#loc_18_21_18_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_21_18_22&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="GHC.IO.html#loc_480_1_480_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_480_1_480_9&#39;)"><span class="hl_varref"><span class="mpre">evaluate</span></span></a><span class="mpre"> (</span><a href="#loc_13_16_13_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_16_13_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_18_19_18_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_19_18_20&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_18_13_18_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_13_18_18&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_18_19_18_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_19_18_20&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_18_21_18_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_21_18_22&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><a href="#loc_18_13_18_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_13_18_18&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_13_13_13_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_13_13_15&#39;)"><span class="hl_varref"><span class="mpre">a0</span></span></a><span class="mpre"> </span><a href="#loc_13_7_13_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_7_13_12&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre">
        </span><a name="loc_22_9_22_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_9_22_12&#39;)"><span class="hl_vardecl"><span class="mpre">end</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Time.Clock.POSIX.html#loc_51_1_51_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.POSIX.html#loc_51_1_51_13&#39;)"><span class="hl_varref"><span class="mpre">getPOSIXTime</span></span></a><span class="mpre">
        let </span><a name="loc_23_13_23_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_13_23_20&#39;)"><span class="hl_vardecl"><span class="mpre">elapsed</span></span></a><span class="mpre"> = </span><a href="#loc_22_9_22_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_9_22_12&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_17_9_17_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_9_17_14&#39;)"><span class="hl_varref"><span class="mpre">start</span></span></a><span class="mpre">
        </span><a href="#loc_14_7_14_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_7_14_11&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_14_13_14_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_13_14_14&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> </span><a href="#loc_14_16_14_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_16_14_23&#39;)"><span class="hl_varref"><span class="mpre">fastest</span></span></a><span class="mpre"> (</span><a href="#loc_23_13_23_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_13_23_20&#39;)"><span class="hl_varref"><span class="mpre">elapsed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_13_7_13_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_7_13_12&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre">))
  </span><a name="loc_25_3_25_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_3_25_4&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_14_7_14_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_7_14_11&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">1e300</span></span><span class="mpre">
  let </span><a name="loc_26_7_26_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_7_26_12&#39;)"><span class="hl_fundecl"><span class="mpre">log10</span></span></a><span class="mpre"> </span><a name="loc_26_13_26_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_13_26_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">log</span></span><span class="mpre"> </span><a href="#loc_26_13_26_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_13_26_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">log</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">
      </span><a name="loc_27_7_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_7_27_9&#39;)"><span class="hl_vardecl"><span class="mpre">ft</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">realToFrac</span></span><span class="mpre"> </span><a href="#loc_25_3_25_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_3_25_4&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
      </span><a name="loc_28_7_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_7_28_11&#39;)"><span class="hl_vardecl"><span class="mpre">prec</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">round</span></span><span class="mpre"> (</span><a href="#loc_26_7_26_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_7_26_12&#39;)"><span class="hl_varref"><span class="mpre">log10</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_13_7_13_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_7_13_12&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_26_7_26_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_7_26_12&#39;)"><span class="hl_varref"><span class="mpre">log10</span></span></a><span class="mpre"> </span><a href="#loc_27_7_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_7_27_9&#39;)"><span class="hl_varref"><span class="mpre">ft</span></span></a><span class="mpre">)
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_10_1_10_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_10&#39;)"><span class="hl_varref"><span class="mpre">ickyRound</span></span></a><span class="mpre"> </span><a href="#loc_28_7_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_7_28_11&#39;)"><span class="hl_varref"><span class="mpre">prec</span></span></a><span class="mpre"> </span><a href="#loc_27_7_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_7_27_9&#39;)"><span class="hl_varref"><span class="mpre">ft</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_13_1_13_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_1_13_6&#39;)"><span class="mpre">timer</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span></div></body></html>