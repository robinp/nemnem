<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns, DeriveDataTypeable #-}
{-# OPTIONS_HADDOCK not-home #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.Text.Internal.Lazy</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) 2009, 2010 Bryan O&#39;Sullivan</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : bos@serpentine.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : GHC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Warning/: this is an internal module, and does not have a stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- API or name. Functions in this module may not check or enforce</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- preconditions expected by public modules. Use at your own risk!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A module containing private &#39;Text&#39; internals. This exposes the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Text&#39; representation and low level construction functions.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Modules which extend the &#39;Text&#39; system may need to use this module.</span></span><span class="mpre">

module Data.Text.Internal.Lazy
    (
      Text(..)
    , chunk
    , empty
    , foldrChunks
    , foldlChunks
    </span><span class="hl_comment"><span class="mpre">-- * Data type invariant and abstraction functions</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- $invariant</span></span><span class="mpre">
    , strictInvariant
    , lazyInvariant
    , showStructure

    </span><span class="hl_comment"><span class="mpre">-- * Chunk allocation sizes</span></span><span class="mpre">
    , defaultChunkSize
    , smallChunkSize
    , chunkOverhead
    ) where

import Data.Text ()
import Data.Text.Internal.Unsafe.Shift (</span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="mpre">shiftL</span></a><span class="mpre">)
import Data.Typeable (</span><a href="Data.Typeable.Internal.html#loc_196_7_196_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Typeable.Internal.html#loc_196_7_196_15&#39;)"><span class="mpre">Typeable</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Lazy.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 8, srcSpanEndLine = 44, srcSpanEndColumn = 24}, srcInfoPoints = []}) &quot;Foreign.Storable&quot;"><span class="mpre">Foreign.Storable</span></span><span class="mpre"> (sizeOf)
import qualified Data.Text.Internal as T

data </span><a name="loc_47_6_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_10&#39;)"><span class="hl_tycondecl"><span class="mpre">Text</span></span></a><span class="mpre"> = </span><a name="loc_47_13_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_18&#39;)"><span class="hl_condecl"><span class="mpre">Empty</span></span></a><span class="mpre">
          | </span><a name="loc_48_13_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_18&#39;)"><span class="hl_condecl"><span class="mpre">Chunk</span></span></a><span class="mpre"> {-# UNPACK #-} !</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> </span><a href="#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
            </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Lazy.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 13, srcSpanEndLine = 49, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Lazy.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 13, srcSpanEndLine = 49, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Lazy.hs&quot;, src"><span class="mpre">deriving (Typeable)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- $invariant</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The data type invariant for lazy &#39;Text&#39;: Every &#39;Text&#39; is either &#39;Empty&#39; or</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- consists of non-null &#39;T.Text&#39;s.  All functions must preserve this,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and the QC properties must check this.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Check the invariant strictly.</span></span><span class="mpre">
</span><a href="#loc_59_1_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_16&#39;)"><span class="mpre">strictInvariant</span></a><span class="mpre"> :: </span><a href="#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_59_1_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_16&#39;)"><span class="hl_fundecl"><span class="mpre">strictInvariant</span></span></a><span class="mpre"> </span><a href="#loc_47_13_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_18&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_59_1_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_16&#39;)"><span class="hl_fundecl"><span class="mpre">strictInvariant</span></span></a><span class="mpre"> </span><a name="loc_60_17_60_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_17_60_18&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@(</span><a href="#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">T.Text</span></span></a><span class="mpre"> _ _ </span><a name="loc_60_38_60_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_38_60_41&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) </span><a name="loc_60_43_60_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_43_60_45&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)
    | </span><a href="#loc_60_38_60_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_38_60_41&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">   = </span><a href="#loc_59_1_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_16&#39;)"><span class="hl_varref"><span class="mpre">strictInvariant</span></span></a><span class="mpre"> </span><a href="#loc_60_43_60_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_43_60_45&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Data.Text.Lazy: invariant violation: &quot;</span></span><span class="mpre">
                  </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_75_1_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_14&#39;)"><span class="hl_varref"><span class="mpre">showStructure</span></span></a><span class="mpre"> </span><a href="#loc_60_17_60_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_17_60_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Check the invariant lazily.</span></span><span class="mpre">
</span><a href="#loc_67_1_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_14&#39;)"><span class="mpre">lazyInvariant</span></a><span class="mpre"> :: </span><a href="#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_67_1_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_14&#39;)"><span class="hl_fundecl"><span class="mpre">lazyInvariant</span></span></a><span class="mpre"> </span><a href="#loc_47_13_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_18&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre"> = </span><a href="#loc_47_13_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_18&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">
</span><a href="#loc_67_1_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_14&#39;)"><span class="hl_fundecl"><span class="mpre">lazyInvariant</span></span></a><span class="mpre"> </span><a name="loc_68_15_68_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_15_68_16&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@(</span><a href="#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a name="loc_68_24_68_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_24_68_25&#39;)"><span class="hl_specname"><span class="mpre">c</span></span></a><span class="mpre">@(</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">T.Text</span></span></a><span class="mpre"> _ _ </span><a name="loc_68_38_68_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_38_68_41&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) </span><a name="loc_68_43_68_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_43_68_45&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)
    | </span><a href="#loc_68_38_68_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_38_68_41&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">   = </span><a href="#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a href="#loc_68_24_68_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_24_68_25&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_67_1_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_14&#39;)"><span class="hl_varref"><span class="mpre">lazyInvariant</span></span></a><span class="mpre"> </span><a href="#loc_68_43_68_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_43_68_45&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Data.Text.Lazy: invariant violation: &quot;</span></span><span class="mpre">
                  </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_75_1_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_14&#39;)"><span class="hl_varref"><span class="mpre">showStructure</span></span></a><span class="mpre"> </span><a href="#loc_68_15_68_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_15_68_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Display the internal structure of a lazy &#39;Text&#39;.</span></span><span class="mpre">
</span><a href="#loc_75_1_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_14&#39;)"><span class="mpre">showStructure</span></a><span class="mpre"> :: </span><a href="#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_75_1_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_14&#39;)"><span class="hl_fundecl"><span class="mpre">showStructure</span></span></a><span class="mpre"> </span><a href="#loc_47_13_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_18&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">           = </span><span class="hl_string"><span class="mpre">&quot;Empty&quot;</span></span><span class="mpre">
</span><a href="#loc_75_1_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_14&#39;)"><span class="hl_fundecl"><span class="mpre">showStructure</span></span></a><span class="mpre"> (</span><a href="#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a name="loc_76_22_76_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_22_76_23&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_47_13_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_18&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">) = </span><span class="hl_string"><span class="mpre">&quot;Chunk &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_76_22_76_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_22_76_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; Empty&quot;</span></span><span class="mpre">
</span><a href="#loc_75_1_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_14&#39;)"><span class="hl_fundecl"><span class="mpre">showStructure</span></span></a><span class="mpre"> (</span><a href="#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a name="loc_77_22_77_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_22_77_23&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_77_24_77_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_24_77_26&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">)    =
    </span><span class="hl_string"><span class="mpre">&quot;Chunk &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_77_22_77_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_22_77_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; (&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_75_1_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_14&#39;)"><span class="hl_varref"><span class="mpre">showStructure</span></span></a><span class="mpre"> </span><a href="#loc_77_24_77_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_24_77_26&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Smart constructor for &#39;Chunk&#39;. Guarantees the data type invariant.</span></span><span class="mpre">
</span><a href="#loc_83_1_83_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_6&#39;)"><span class="mpre">chunk</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_83_1_83_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_6&#39;)"><span class="mpre">chunk</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_83_1_83_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_6&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_83_7_83_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_7_83_8&#39;)"><span class="hl_specname"><span class="mpre">t</span></span></a><span class="mpre">@(</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">T.Text</span></span></a><span class="mpre"> _ _ </span><a name="loc_83_21_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_21_83_24&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) </span><a name="loc_83_26_83_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_26_83_28&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre"> | </span><a href="#loc_83_21_83_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_21_83_24&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><a href="#loc_83_26_83_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_26_83_28&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
                            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a href="#loc_83_7_83_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_7_83_8&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_83_26_83_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_26_83_28&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Smart constructor for &#39;Empty&#39;.</span></span><span class="mpre">
</span><a href="#loc_89_1_89_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_6&#39;)"><span class="mpre">empty</span></a><span class="mpre"> :: </span><a href="#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_89_1_89_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_6&#39;)"><span class="mpre">empty</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a name="loc_89_1_89_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_6&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre"> = </span><a href="#loc_47_13_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_18&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Consume the chunks of a lazy &#39;Text&#39; with a natural right fold.</span></span><span class="mpre">
</span><a href="#loc_93_1_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_12&#39;)"><span class="mpre">foldrChunks</span></a><span class="mpre"> :: (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_93_1_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_12&#39;)"><span class="hl_fundecl"><span class="mpre">foldrChunks</span></span></a><span class="mpre"> </span><a name="loc_93_13_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_13_93_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_93_15_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_16&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = </span><a href="#loc_94_9_94_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where </span><a name="loc_94_9_94_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_47_13_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_18&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">        = </span><a href="#loc_93_15_93_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_16&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
        </span><a href="#loc_94_9_94_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a name="loc_95_19_95_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_19_95_20&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_95_21_95_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_21_95_23&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) = </span><a href="#loc_93_13_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_13_93_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_95_19_95_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_19_95_20&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_94_9_94_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_95_21_95_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_21_95_23&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_93_1_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_12&#39;)"><span class="mpre">foldrChunks</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Consume the chunks of a lazy &#39;Text&#39; with a strict, tail-recursive,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- accumulating left fold.</span></span><span class="mpre">
</span><a href="#loc_101_1_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_12&#39;)"><span class="mpre">foldlChunks</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_6_47_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_101_1_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_12&#39;)"><span class="hl_fundecl"><span class="mpre">foldlChunks</span></span></a><span class="mpre"> </span><a name="loc_101_13_101_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_13_101_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_101_15_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_15_101_16&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = </span><a href="#loc_102_9_102_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_101_15_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_15_101_16&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
  where </span><a name="loc_102_9_102_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_102_13_102_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_13_102_14&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_47_13_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_13_47_18&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">        = </span><a href="#loc_102_13_102_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_13_102_14&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
        </span><a href="#loc_102_9_102_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_103_13_103_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_13_103_14&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_48_13_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_18&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a name="loc_103_22_103_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_22_103_23&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_103_24_103_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_24_103_26&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) = </span><a href="#loc_102_9_102_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_101_13_101_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_13_101_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_103_13_103_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_13_103_14&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_103_22_103_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_22_103_23&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_103_24_103_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_24_103_26&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_101_1_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_12&#39;)"><span class="mpre">foldlChunks</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Currently set to 16 KiB, less the memory management overhead.</span></span><span class="mpre">
</span><a href="#loc_108_1_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_17&#39;)"><span class="mpre">defaultChunkSize</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_108_1_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_17&#39;)"><span class="hl_vardecl"><span class="mpre">defaultChunkSize</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">16384</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_118_1_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_14&#39;)"><span class="hl_varref"><span class="mpre">chunkOverhead</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_108_1_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_17&#39;)"><span class="mpre">defaultChunkSize</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Currently set to 128 bytes, less the memory management overhead.</span></span><span class="mpre">
</span><a href="#loc_113_1_113_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_15&#39;)"><span class="mpre">smallChunkSize</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_113_1_113_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_15&#39;)"><span class="hl_vardecl"><span class="mpre">smallChunkSize</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">128</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_118_1_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_14&#39;)"><span class="hl_varref"><span class="mpre">chunkOverhead</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_113_1_113_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_15&#39;)"><span class="mpre">smallChunkSize</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The memory management overhead. Currently this is tuned for GHC only.</span></span><span class="mpre">
</span><a href="#loc_118_1_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_14&#39;)"><span class="mpre">chunkOverhead</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_118_1_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_14&#39;)"><span class="hl_vardecl"><span class="mpre">chunkOverhead</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_118_1_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_14&#39;)"><span class="mpre">chunkOverhead</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span></div></body></html>