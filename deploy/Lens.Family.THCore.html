<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE TemplateHaskell #-}

</span><span class="hl_comment"><span class="mpre">-- | The shared functionality behind Lens.Family.TH and Lens.Family2.TH.</span></span><span class="mpre">
module Lens.Family.THCore (
   defaultNameTransform
  , LensTypeInfo
  , ConstructorFieldInfo
  , deriveLenses
  , makeTraversals
  ) where

import Language.Haskell.TH
import Control.Applicative (</span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="mpre">pure</span></a><span class="mpre">)
import Data.Char (</span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="mpre">toLower</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | By default, if the field name begins with an underscore,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- then the underscore will simply be removed (and the new first character</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- lowercased if necessary).</span></span><span class="mpre">
</span><a href="#loc_20_1_20_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_21&#39;)"><span class="mpre">defaultNameTransform</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_20_1_20_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_21&#39;)"><span class="hl_fundecl"><span class="mpre">defaultNameTransform</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_20_27_20_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_27_20_28&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_20_29_20_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_29_20_33&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><a href="#loc_20_27_20_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_27_20_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_20_29_20_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_29_20_33&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
</span><a href="#loc_20_1_20_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_21&#39;)"><span class="hl_fundecl"><span class="mpre">defaultNameTransform</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Information about the larger type the lens will operate on.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 1, srcSpanEndLine = 25, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 1, srcSpanEndLine = 25, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THC"><span class="mpre">type LensTypeInfo = (Name, [TyVarBndr])</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Information about the smaller type the lens will operate on.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 1, srcSpanEndLine = 28, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 1, srcSpanEndLine = 28, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THC"><span class="mpre">type ConstructorFieldInfo = (Name, Strict, Type)</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The true workhorse of lens derivation. This macro is parameterized</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- by a macro that derives signatures, as well as a function that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- filters and transforms names. Producing Nothing means that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a lens should not be generated for the provided name.</span></span><span class="mpre">
</span><a href="#loc_41_1_41_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_13&#39;)"><span class="mpre">deriveLenses</span></a><span class="mpre"> ::
     (</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">LensTypeInfo</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ConstructorFieldInfo</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">])
     </span><span class="hl_comment"><span class="mpre">-- ^ the signature deriver</span></span><span class="mpre">
  -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
     </span><span class="hl_comment"><span class="mpre">-- ^ the name transformer</span></span><span class="mpre">
  -&gt; </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_41_1_41_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_13&#39;)"><span class="hl_fundecl"><span class="mpre">deriveLenses</span></span></a><span class="mpre"> </span><a name="loc_41_14_41_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_14_41_24&#39;)"><span class="hl_vardecl"><span class="mpre">sigDeriver</span></span></a><span class="mpre"> </span><a name="loc_41_25_41_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_25_41_38&#39;)"><span class="hl_vardecl"><span class="mpre">nameTransform</span></span></a><span class="mpre"> </span><a name="loc_41_39_41_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_39_41_47&#39;)"><span class="hl_vardecl"><span class="mpre">datatype</span></span></a><span class="mpre"> = do
  </span><a name="loc_42_3_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_3_42_11&#39;)"><span class="hl_vardecl"><span class="mpre">typeInfo</span></span></a><span class="mpre">          &lt;- </span><a href="#loc_49_1_49_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_20&#39;)"><span class="hl_varref"><span class="mpre">extractLensTypeInfo</span></span></a><span class="mpre"> </span><a href="#loc_41_39_41_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_39_41_47&#39;)"><span class="hl_varref"><span class="mpre">datatype</span></span></a><span class="mpre">
  let </span><a name="loc_43_7_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_14&#39;)"><span class="hl_vardecl"><span class="mpre">derive1</span></span></a><span class="mpre"> = </span><a href="#loc_84_1_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_11&#39;)"><span class="hl_varref"><span class="mpre">deriveLens</span></span></a><span class="mpre"> </span><a href="#loc_41_14_41_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_14_41_24&#39;)"><span class="hl_varref"><span class="mpre">sigDeriver</span></span></a><span class="mpre"> </span><a href="#loc_41_25_41_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_25_41_38&#39;)"><span class="hl_varref"><span class="mpre">nameTransform</span></span></a><span class="mpre"> </span><a href="#loc_42_3_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_3_42_11&#39;)"><span class="hl_varref"><span class="mpre">typeInfo</span></span></a><span class="mpre">
  </span><a name="loc_44_3_44_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_3_44_20&#39;)"><span class="hl_vardecl"><span class="mpre">constructorFields</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_60_1_60_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_25&#39;)"><span class="hl_varref"><span class="mpre">extractConstructorFields</span></span></a><span class="mpre"> </span><a href="#loc_41_39_41_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_39_41_47&#39;)"><span class="hl_varref"><span class="mpre">datatype</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> </span><a href="#loc_43_7_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_14&#39;)"><span class="hl_varref"><span class="mpre">derive1</span></span></a><span class="mpre"> </span><a href="#loc_44_3_44_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_3_44_20&#39;)"><span class="hl_varref"><span class="mpre">constructorFields</span></span></a><span class="mpre">


</span><a href="#loc_49_1_49_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_20&#39;)"><span class="mpre">extractLensTypeInfo</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LensTypeInfo</span></span><span class="mpre">
</span><a name="loc_49_1_49_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_20&#39;)"><span class="hl_fundecl"><span class="mpre">extractLensTypeInfo</span></span></a><span class="mpre"> </span><a name="loc_49_21_49_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_21_49_29&#39;)"><span class="hl_vardecl"><span class="mpre">datatype</span></span></a><span class="mpre"> = do
  let </span><a name="loc_50_7_50_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_18&#39;)"><span class="hl_vardecl"><span class="mpre">datatypeStr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_49_21_49_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_21_49_29&#39;)"><span class="hl_varref"><span class="mpre">datatype</span></span></a><span class="mpre">
  </span><a name="loc_51_3_51_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_3_51_4&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">reify</span></span><span class="mpre"> </span><a href="#loc_49_21_49_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_21_49_29&#39;)"><span class="hl_varref"><span class="mpre">datatype</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> case </span><a href="#loc_51_3_51_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_3_51_4&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">DataD</span></span><span class="mpre">    _ </span><a name="loc_53_24_53_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_24_53_25&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_53_26_53_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_26_53_28&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre"> _ _) -&gt; (</span><a href="#loc_53_24_53_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_24_53_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><a href="#loc_53_26_53_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_26_53_28&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">)
    </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">NewtypeD</span></span><span class="mpre"> _ </span><a name="loc_54_24_54_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_24_54_25&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_54_26_54_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_26_54_28&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre"> _ _) -&gt; (</span><a href="#loc_54_24_54_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_24_54_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><a href="#loc_54_26_54_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_26_54_28&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">)
    _ -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Can&#39;t derive Lens for: &quot;</span></span><span class="mpre">  </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_50_7_50_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_18&#39;)"><span class="hl_varref"><span class="mpre">datatypeStr</span></span></a><span class="mpre">
              </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;, type name required.&quot;</span></span><span class="mpre">


</span><a href="#loc_60_1_60_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_25&#39;)"><span class="mpre">extractConstructorFields</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">ConstructorFieldInfo</span></span><span class="mpre">]
</span><a name="loc_60_1_60_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_25&#39;)"><span class="hl_fundecl"><span class="mpre">extractConstructorFields</span></span></a><span class="mpre"> </span><a name="loc_60_26_60_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_26_60_34&#39;)"><span class="hl_vardecl"><span class="mpre">datatype</span></span></a><span class="mpre"> = do
  let </span><a name="loc_61_7_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_18&#39;)"><span class="hl_vardecl"><span class="mpre">datatypeStr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_60_26_60_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_26_60_34&#39;)"><span class="hl_varref"><span class="mpre">datatype</span></span></a><span class="mpre">
  </span><a name="loc_62_3_62_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_3_62_4&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">reify</span></span><span class="mpre"> </span><a href="#loc_60_26_60_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_26_60_34&#39;)"><span class="hl_varref"><span class="mpre">datatype</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> case </span><a href="#loc_62_3_62_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_3_62_4&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">DataD</span></span><span class="mpre">    _ _ _ [</span><span class="hl_conref"><span class="mpre">RecC</span></span><span class="mpre"> _ </span><a name="loc_64_36_64_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_36_64_38&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre">] _) -&gt; </span><a href="#loc_64_36_64_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_36_64_38&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">NewtypeD</span></span><span class="mpre"> _ _ _ (</span><span class="hl_conref"><span class="mpre">RecC</span></span><span class="mpre"> _ </span><a name="loc_65_36_65_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_36_65_38&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre">) _) -&gt; </span><a href="#loc_65_36_65_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_36_65_38&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">DataD</span></span><span class="mpre">    _ _ _ [_]         _) -&gt;
      </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Can&#39;t derive Lens without record selectors: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_61_7_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_18&#39;)"><span class="hl_varref"><span class="mpre">datatypeStr</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 12, srcSpanEndLine = 68, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 20, srcSpanEndLine = 68, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCo"><span class="mpre">NewtypeD{}</span></span><span class="mpre"> -&gt;
      </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Can&#39;t derive Lens without record selectors: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_61_7_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_18&#39;)"><span class="hl_varref"><span class="mpre">datatypeStr</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 12, srcSpanEndLine = 70, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 18, srcSpanEndLine = 70, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCo"><span class="mpre">TySynD{}</span></span><span class="mpre"> -&gt;
      </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Can&#39;t derive Lens for type synonym: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_61_7_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_18&#39;)"><span class="hl_varref"><span class="mpre">datatypeStr</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 12, srcSpanEndLine = 72, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 17, srcSpanEndLine = 72, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCo"><span class="mpre">DataD{}</span></span><span class="mpre"> -&gt;
      </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Can&#39;t derive Lens for tagged union: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_61_7_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_18&#39;)"><span class="hl_varref"><span class="mpre">datatypeStr</span></span></a><span class="mpre">
    _ -&gt;
      </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Can&#39;t derive Lens for: &quot;</span></span><span class="mpre">  </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_61_7_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_7_61_18&#39;)"><span class="hl_varref"><span class="mpre">datatypeStr</span></span></a><span class="mpre">
           </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;, type name required.&quot;</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Derive a lens for the given record selector</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- using the given name transformation function.</span></span><span class="mpre">
</span><a href="#loc_84_1_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_11&#39;)"><span class="mpre">deriveLens</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">LensTypeInfo</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ConstructorFieldInfo</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">])
           -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
           -&gt; </span><span class="hl_tyconref"><span class="mpre">LensTypeInfo</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ConstructorFieldInfo</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_84_1_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_11&#39;)"><span class="hl_fundecl"><span class="mpre">deriveLens</span></span></a><span class="mpre"> </span><a name="loc_84_12_84_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_12_84_22&#39;)"><span class="hl_vardecl"><span class="mpre">sigDeriver</span></span></a><span class="mpre"> </span><a name="loc_84_23_84_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_23_84_36&#39;)"><span class="hl_vardecl"><span class="mpre">nameTransform</span></span></a><span class="mpre"> </span><a name="loc_84_37_84_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_37_84_39&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre"> </span><a name="loc_84_40_84_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_40_84_45&#39;)"><span class="hl_vardecl"><span class="mpre">field</span></span></a><span class="mpre"> = do
  let (</span><a name="loc_85_8_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_8_85_17&#39;)"><span class="hl_vardecl"><span class="mpre">fieldName</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">_fieldStrict</span></span><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">_fieldType</span></span><span class="mpre">) = </span><a href="#loc_84_40_84_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_40_84_45&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre">
      (</span><span class="hl_vardecl"><span class="mpre">_tyName</span></span><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">_tyVars</span></span><span class="mpre">) = </span><a href="#loc_84_37_84_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_37_84_39&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- just to clarify what&#39;s here</span></span><span class="mpre">
  case </span><a href="#loc_84_23_84_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_23_84_36&#39;)"><span class="hl_varref"><span class="mpre">nameTransform</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_85_8_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_8_85_17&#39;)"><span class="hl_varref"><span class="mpre">fieldName</span></span></a><span class="mpre">) of
    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">       -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_89_10_89_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_10_89_21&#39;)"><span class="hl_vardecl"><span class="mpre">lensNameStr</span></span></a><span class="mpre"> -&gt; do
      let </span><a name="loc_90_11_90_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_19&#39;)"><span class="hl_vardecl"><span class="mpre">lensName</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><a href="#loc_89_10_89_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_10_89_21&#39;)"><span class="hl_varref"><span class="mpre">lensNameStr</span></span></a><span class="mpre">
      </span><a name="loc_91_7_91_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_10&#39;)"><span class="hl_vardecl"><span class="mpre">sig</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_84_12_84_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_12_84_22&#39;)"><span class="hl_varref"><span class="mpre">sigDeriver</span></span></a><span class="mpre"> </span><a href="#loc_90_11_90_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_19&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><a href="#loc_84_37_84_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_37_84_39&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> </span><a href="#loc_84_40_84_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_40_84_45&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre">
      </span><a name="loc_92_7_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_7_92_11&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_100_1_100_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_15&#39;)"><span class="hl_varref"><span class="mpre">deriveLensBody</span></span></a><span class="mpre"> </span><a href="#loc_90_11_90_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_19&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><a href="#loc_85_8_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_8_85_17&#39;)"><span class="hl_varref"><span class="mpre">fieldName</span></span></a><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_91_7_91_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_10&#39;)"><span class="hl_varref"><span class="mpre">sig</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_92_7_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_7_92_11&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">]


</span><span class="hl_comment"><span class="mpre">-- Given a record field name,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- produces a single function declaration:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- lensName f a = (\x -&gt; a { field = x }) `fmap` f (field a)</span></span><span class="mpre">
</span><a href="#loc_100_1_100_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_15&#39;)"><span class="mpre">deriveLensBody</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">
</span><a name="loc_100_1_100_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_15&#39;)"><span class="hl_fundecl"><span class="mpre">deriveLensBody</span></span></a><span class="mpre"> </span><a name="loc_100_16_100_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_16_100_24&#39;)"><span class="hl_vardecl"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">fieldName</span></span><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_100_16_100_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_16_100_24&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> [</span><a href="#loc_104_5_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_12&#39;)"><span class="hl_varref"><span class="mpre">defLine</span></span></a><span class="mpre">]
  where
    </span><a name="loc_102_5_102_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_5_102_6&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;a&quot;</span></span><span class="mpre">
    </span><a name="loc_103_5_103_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_6&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;f&quot;</span></span><span class="mpre">
    </span><a name="loc_104_5_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_12&#39;)"><span class="hl_vardecl"><span class="mpre">defLine</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> </span><a href="#loc_105_5_105_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_9&#39;)"><span class="hl_varref"><span class="mpre">pats</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> </span><a href="#loc_106_5_106_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_5_106_9&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">) []
    </span><a name="loc_105_5_105_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_9&#39;)"><span class="hl_vardecl"><span class="mpre">pats</span></span></a><span class="mpre"> = [</span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_103_5_103_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">, </span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_102_5_102_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_5_102_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">]
    </span><a name="loc_106_5_106_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_5_106_9&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpBracketExp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 12, srcSpanEndLine = 108, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 12, srcSpanEndLine = 106, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/F"><span class="mpre">[| (\x -&gt; $(record a fieldName [|x|]))
              `fmap` $(appE (varE f) (appE (varE fieldName) (varE a)))
            |]</span></span><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">record</span></span><span class="mpre"> </span><a name="loc_109_12_109_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_12_109_15&#39;)"><span class="hl_vardecl"><span class="mpre">rec</span></span></a><span class="mpre"> </span><a name="loc_109_16_109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_16_109_19&#39;)"><span class="hl_vardecl"><span class="mpre">fld</span></span></a><span class="mpre"> </span><a name="loc_109_20_109_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_20_109_23&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre"> = </span><a href="#loc_109_20_109_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_20_109_23&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_109_35_109_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_35_109_36&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; </span><a href="Language.Haskell.TH.Lib.html#loc_291_1_291_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_291_1_291_8&#39;)"><span class="hl_varref"><span class="mpre">recUpdE</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_109_12_109_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_12_109_15&#39;)"><span class="hl_varref"><span class="mpre">rec</span></span></a><span class="mpre">) [</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_109_16_109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_16_109_19&#39;)"><span class="hl_varref"><span class="mpre">fld</span></span></a><span class="mpre">, </span><a href="#loc_109_35_109_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_35_109_36&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)]

</span><a href="#loc_112_1_112_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_15&#39;)"><span class="mpre">makeTraversals</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_112_1_112_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_15&#39;)"><span class="hl_vardecl"><span class="mpre">makeTraversals</span></span></a><span class="mpre"> = </span><a href="#loc_115_1_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_17&#39;)"><span class="hl_varref"><span class="mpre">deriveTraversals</span></span></a><span class="mpre"> (\</span><a name="loc_112_37_112_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_37_112_38&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_112_37_112_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_37_112_38&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))

</span><a href="#loc_115_1_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_17&#39;)"><span class="mpre">deriveTraversals</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_115_1_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_17&#39;)"><span class="hl_fundecl"><span class="mpre">deriveTraversals</span></span></a><span class="mpre"> </span><a name="loc_115_18_115_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_18_115_31&#39;)"><span class="hl_vardecl"><span class="mpre">nameTransform</span></span></a><span class="mpre"> </span><a name="loc_115_32_115_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_32_115_36&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> = do
  </span><a name="loc_116_3_116_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_3_116_11&#39;)"><span class="hl_vardecl"><span class="mpre">typeInfo</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_49_1_49_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_20&#39;)"><span class="hl_varref"><span class="mpre">extractLensTypeInfo</span></span></a><span class="mpre"> </span><a href="#loc_115_32_115_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_32_115_36&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">
  let </span><a name="loc_117_7_117_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_7_117_14&#39;)"><span class="hl_vardecl"><span class="mpre">derive1</span></span></a><span class="mpre"> = </span><a href="#loc_136_1_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_16&#39;)"><span class="hl_varref"><span class="mpre">deriveTraversal</span></span></a><span class="mpre"> </span><a href="#loc_115_18_115_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_18_115_31&#39;)"><span class="hl_varref"><span class="mpre">nameTransform</span></span></a><span class="mpre"> </span><a href="#loc_116_3_116_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_3_116_11&#39;)"><span class="hl_varref"><span class="mpre">typeInfo</span></span></a><span class="mpre">
  </span><a name="loc_118_3_118_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_3_118_15&#39;)"><span class="hl_vardecl"><span class="mpre">constructors</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_123_1_123_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_23&#39;)"><span class="hl_varref"><span class="mpre">extractConstructorInfo</span></span></a><span class="mpre"> </span><a href="#loc_115_32_115_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_32_115_36&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> </span><a href="#loc_117_7_117_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_7_117_14&#39;)"><span class="hl_varref"><span class="mpre">derive1</span></span></a><span class="mpre"> </span><a href="#loc_118_3_118_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_3_118_15&#39;)"><span class="hl_varref"><span class="mpre">constructors</span></span></a><span class="mpre">


</span><a href="#loc_123_1_123_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_23&#39;)"><span class="mpre">extractConstructorInfo</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre">]
</span><a name="loc_123_1_123_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_23&#39;)"><span class="hl_fundecl"><span class="mpre">extractConstructorInfo</span></span></a><span class="mpre"> </span><a name="loc_123_24_123_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_24_123_32&#39;)"><span class="hl_vardecl"><span class="mpre">datatype</span></span></a><span class="mpre"> = do
  let </span><a name="loc_124_7_124_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_18&#39;)"><span class="hl_vardecl"><span class="mpre">datatypeStr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_123_24_123_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_24_123_32&#39;)"><span class="hl_varref"><span class="mpre">datatype</span></span></a><span class="mpre">
  </span><a name="loc_125_3_125_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_3_125_4&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">reify</span></span><span class="mpre"> </span><a href="#loc_123_24_123_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_24_123_32&#39;)"><span class="hl_varref"><span class="mpre">datatype</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> case </span><a href="#loc_125_3_125_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_3_125_4&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">DataD</span></span><span class="mpre">    _ _ _ [] _)
      -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Traversal derivation not yet supported: &quot;</span></span><span class="mpre">
         </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;empty constructor in: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_124_7_124_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_18&#39;)"><span class="hl_varref"><span class="mpre">datatypeStr</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">DataD</span></span><span class="mpre">    _ _ _ </span><a name="loc_130_28_130_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_28_130_30&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre"> _) -&gt; </span><a href="#loc_130_28_130_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_28_130_30&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">NewtypeD</span></span><span class="mpre"> _ _ _ </span><a name="loc_131_28_131_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_28_131_29&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">  _) -&gt; [</span><a href="#loc_131_28_131_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_28_131_29&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">]
    _ -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Can&#39;t derive traversal for: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_124_7_124_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_18&#39;)"><span class="hl_varref"><span class="mpre">datatypeStr</span></span></a><span class="mpre">


</span><a href="#loc_136_1_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_16&#39;)"><span class="mpre">deriveTraversal</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">LensTypeInfo</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_136_1_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_16&#39;)"><span class="hl_fundecl"><span class="mpre">deriveTraversal</span></span></a><span class="mpre"> </span><a name="loc_136_17_136_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_17_136_30&#39;)"><span class="hl_vardecl"><span class="mpre">nameTransform</span></span></a><span class="mpre"> </span><a name="loc_136_31_136_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_31_136_33&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre"> </span><a name="loc_136_34_136_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_34_136_37&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre"> = do
  let (</span><a name="loc_137_8_137_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_8_137_14&#39;)"><span class="hl_vardecl"><span class="mpre">tyName</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">_tyVars</span></span><span class="mpre">) = </span><a href="#loc_136_31_136_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_31_136_33&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- just to clarify what&#39;s here</span></span><span class="mpre">
      (</span><a name="loc_138_8_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_13&#39;)"><span class="hl_vardecl"><span class="mpre">cName</span></span></a><span class="mpre">, </span><a name="loc_138_15_138_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_15_138_19&#39;)"><span class="hl_vardecl"><span class="mpre">cTys</span></span></a><span class="mpre">) = case </span><a href="#loc_136_34_136_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_34_136_37&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">NormalC</span></span><span class="mpre"> </span><a name="loc_139_17_139_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_17_139_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_139_19_139_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_19_139_22&#39;)"><span class="hl_vardecl"><span class="mpre">tys</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_139_17_139_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_17_139_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><a href="#loc_139_19_139_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_19_139_22&#39;)"><span class="hl_varref"><span class="mpre">tys</span></span></a><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">RecC</span></span><span class="mpre"> </span><a name="loc_140_14_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_14_140_15&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_140_16_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_16_140_19&#39;)"><span class="hl_vardecl"><span class="mpre">tys</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_140_14_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_14_140_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(</span><span class="hl_vardecl"><span class="mpre">_n</span></span><span class="mpre">, </span><a name="loc_140_38_140_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_38_140_39&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_140_41_140_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_41_140_42&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_140_38_140_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_38_140_39&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_140_41_140_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_41_140_42&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)) </span><a href="#loc_140_16_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_16_140_19&#39;)"><span class="hl_varref"><span class="mpre">tys</span></span></a><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">InfixC</span></span><span class="mpre"> _ </span><a name="loc_141_18_141_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_18_141_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _
          -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Traversal derivation not yet supported: &quot;</span></span><span class="mpre">
             </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;infix constructor: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_141_18_141_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_18_141_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">ForallC</span></span><span class="mpre"> _ _ _
          -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Traversal derivation not supported: &quot;</span></span><span class="mpre">
             </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;forall&#39;d constructor in: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_137_8_137_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_8_137_14&#39;)"><span class="hl_varref"><span class="mpre">tyName</span></span></a><span class="mpre">
  </span><span class="hl_vardecl"><span class="mpre">cTy</span></span><span class="mpre"> &lt;- case </span><a href="#loc_138_15_138_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_15_138_19&#39;)"><span class="hl_varref"><span class="mpre">cTys</span></span></a><span class="mpre"> of
    [</span><a name="loc_148_6_148_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_6_148_7&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">] -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_148_6_148_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_6_148_7&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- TODO: this should be pretty easy to implement</span></span><span class="mpre">
    _ -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Traversal derivation not yet supported: &quot;</span></span><span class="mpre">
         </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;product constructor: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_138_8_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_13&#39;)"><span class="hl_varref"><span class="mpre">cName</span></span></a><span class="mpre">
  case </span><a href="#loc_136_17_136_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_17_136_30&#39;)"><span class="hl_varref"><span class="mpre">nameTransform</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_138_8_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_13&#39;)"><span class="hl_varref"><span class="mpre">cName</span></span></a><span class="mpre">) of
    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">       -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_154_10_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_10_154_21&#39;)"><span class="hl_vardecl"><span class="mpre">lensNameStr</span></span></a><span class="mpre"> -&gt; do
      let </span><a name="loc_155_11_155_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_19&#39;)"><span class="hl_vardecl"><span class="mpre">lensName</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><a href="#loc_154_10_154_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_10_154_21&#39;)"><span class="hl_varref"><span class="mpre">lensNameStr</span></span></a><span class="mpre">
      </span><a name="loc_156_7_156_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_7_156_10&#39;)"><span class="hl_vardecl"><span class="mpre">sig</span></span></a><span class="mpre">  &lt;- </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [] </span><span class="hl_comment"><span class="mpre">-- TODO</span></span><span class="mpre">
      </span><a name="loc_157_7_157_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_7_157_11&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_162_1_162_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_20&#39;)"><span class="hl_varref"><span class="mpre">deriveTraversalBody</span></span></a><span class="mpre"> </span><a href="#loc_155_11_155_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_11_155_19&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><a href="#loc_138_8_138_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_13&#39;)"><span class="hl_varref"><span class="mpre">cName</span></span></a><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_156_7_156_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_7_156_10&#39;)"><span class="hl_varref"><span class="mpre">sig</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_157_7_157_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_7_157_11&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">]


</span><a href="#loc_162_1_162_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_20&#39;)"><span class="mpre">deriveTraversalBody</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">
</span><a name="loc_162_1_162_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_20&#39;)"><span class="hl_fundecl"><span class="mpre">deriveTraversalBody</span></span></a><span class="mpre"> </span><a name="loc_162_21_162_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_21_162_29&#39;)"><span class="hl_vardecl"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><a name="loc_162_30_162_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_30_162_45&#39;)"><span class="hl_vardecl"><span class="mpre">constructorName</span></span></a><span class="mpre"> =
  </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_162_21_162_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_21_162_29&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> [</span><a href="#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_5_167_12&#39;)"><span class="hl_varref"><span class="mpre">defLine</span></span></a><span class="mpre">, </span><a href="#loc_172_5_172_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_13&#39;)"><span class="hl_varref"><span class="mpre">fallback</span></span></a><span class="mpre">] where
    </span><a name="loc_164_5_164_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_5_164_6&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;x&quot;</span></span><span class="mpre">
    </span><a name="loc_165_5_165_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_6&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;t&quot;</span></span><span class="mpre">
    </span><a name="loc_166_5_166_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_5_166_6&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;k&quot;</span></span><span class="mpre">
    </span><a name="loc_167_5_167_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_5_167_12&#39;)"><span class="hl_vardecl"><span class="mpre">defLine</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> </span><a href="#loc_168_5_168_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_12&#39;)"><span class="hl_varref"><span class="mpre">defPats</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> </span><a href="#loc_169_5_169_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_5_169_12&#39;)"><span class="hl_varref"><span class="mpre">defBody</span></span></a><span class="mpre">) []
    </span><a name="loc_168_5_168_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_12&#39;)"><span class="hl_vardecl"><span class="mpre">defPats</span></span></a><span class="mpre"> = [</span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_166_5_166_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_5_166_6&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">, </span><a href="Language.Haskell.TH.Lib.html#loc_76_1_76_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_76_1_76_5&#39;)"><span class="hl_varref"><span class="mpre">conP</span></span></a><span class="mpre"> </span><a href="#loc_162_30_162_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_30_162_45&#39;)"><span class="hl_varref"><span class="mpre">constructorName</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_164_5_164_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_5_164_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]]
    </span><a name="loc_169_5_169_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_5_169_12&#39;)"><span class="hl_vardecl"><span class="mpre">defBody</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpBracketExp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 169, srcSpanStartColumn = 15, srcSpanEndLine = 171, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 169, srcSpanStartColumn = 15, srcSpanEndLine = 169, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/F"><span class="mpre">[| $(conE constructorName)
                 `fmap` $(appE (varE k) (varE x))
               |]</span></span><span class="mpre">
    </span><a name="loc_172_5_172_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_13&#39;)"><span class="hl_vardecl"><span class="mpre">fallback</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> </span><a href="#loc_173_5_173_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_5_173_17&#39;)"><span class="hl_varref"><span class="mpre">fallbackPats</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> </span><a href="#loc_174_5_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_5_174_17&#39;)"><span class="hl_varref"><span class="mpre">fallbackBody</span></span></a><span class="mpre">) []
    </span><a name="loc_173_5_173_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_5_173_17&#39;)"><span class="hl_vardecl"><span class="mpre">fallbackPats</span></span></a><span class="mpre"> = [</span><a href="Language.Haskell.TH.Lib.html#loc_100_1_100_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_100_1_100_6&#39;)"><span class="hl_varref"><span class="mpre">wildP</span></span></a><span class="mpre">, </span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_165_5_165_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_6&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">]
    </span><a name="loc_174_5_174_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_5_174_17&#39;)"><span class="hl_vardecl"><span class="mpre">fallbackBody</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpBracketExp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 20, srcSpanEndLine = 174, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/Family/THCore.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 20, srcSpanEndLine = 174, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-family-th-0.3.0.0/Lens/F"><span class="mpre">[| pure $(varE t) |]</span></span><span class="mpre">

</span></div></body></html>