<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE Trustworthy #-}
{-# OPTIONS -fno-warn-unused-imports #-}
#include &quot;HsConfigure.h&quot;
</span><span class="hl_comment"><span class="mpre">-- #hide</span></span><span class="mpre">
module Data.Time.Clock.Scale
(
        </span><span class="hl_comment"><span class="mpre">-- * Universal Time</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- | Time as measured by the earth.</span></span><span class="mpre">
        UniversalTime(..),

        </span><span class="hl_comment"><span class="mpre">-- * Absolute intervals</span></span><span class="mpre">
        DiffTime,
        secondsToDiffTime, picosecondsToDiffTime
) where

import Control.DeepSeq
import Data.Ratio ((%))
import Data.Fixed
import Data.Typeable
#if LANGUAGE_Rank2Types
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/Clock/Scale.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 8, srcSpanEndLine = 21, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- | The Modified Julian Date is the day with the fraction of the day, measured from UT midnight.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It&#39;s used to represent UT1, which is time as measured by the earth&#39;s rotation, adjusted for various wobbles.</span></span><span class="mpre">
newtype </span><a name="loc_26_9_26_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_22&#39;)"><span class="hl_tycondecl"><span class="mpre">UniversalTime</span></span></a><span class="mpre"> = </span><a name="loc_26_25_26_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_25_26_38&#39;)"><span class="hl_condecl"><span class="mpre">ModJulianDate</span></span></a><span class="mpre"> {</span><a name="loc_26_40_26_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_40_26_56&#39;)"><span class="hl_fielddecl"><span class="mpre">getModJulianDate</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Rational</span></span><span class="mpre">} </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/Clock/Scale.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 70, srcSpanEndLine = 32, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/Clock/Scale.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 70, srcSpanEndLine = 26, srcSpanEndColumn = 78},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/Clock/Scale.hs&quot;, srcSpanStartLine"><span class="mpre">deriving (Eq,Ord
#if LANGUAGE_DeriveDataTypeable
#if LANGUAGE_Rank2Types
    ,Data, Typeable
#endif
#endif
    )</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- necessary because H98 doesn&#39;t have &quot;cunning newtype&quot; derivation</span></span><span class="mpre">
instance </span><a href="Control.DeepSeq.html#loc_110_7_110_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_110_7_110_13&#39;)"><span class="hl_classref"><span class="mpre">NFData</span></span></a><span class="mpre"> </span><a href="#loc_26_9_26_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_22&#39;)"><span class="hl_tyconref"><span class="mpre">UniversalTime</span></span></a><span class="mpre"> where
        </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">rnf</span></span></a><span class="mpre"> (</span><a href="#loc_26_25_26_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_25_26_38&#39;)"><span class="hl_conref"><span class="mpre">ModJulianDate</span></span></a><span class="mpre"> </span><a name="loc_36_28_36_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_28_36_29&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a href="#loc_36_28_36_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_28_36_29&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This is a length of time, as measured by a clock.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Conversion functions will treat it as seconds.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It has a precision of 10^-12 s.</span></span><span class="mpre">
newtype </span><a name="loc_41_9_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_17&#39;)"><span class="hl_tycondecl"><span class="mpre">DiffTime</span></span></a><span class="mpre"> = </span><a name="loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_condecl"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Pico</span></span><span class="mpre"> </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/Clock/Scale.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 36, srcSpanEndLine = 50, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/Clock/Scale.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 36, srcSpanEndLine = 41, srcSpanEndColumn = 44},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/Clock/Scale.hs&quot;, srcSpanStartLine"><span class="mpre">deriving (Eq,Ord
#if LANGUAGE_DeriveDataTypeable
#if LANGUAGE_Rank2Types
#if HAS_DataPico
    ,Data, Typeable
#else
#endif
#endif
#endif
    )</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- necessary because H98 doesn&#39;t have &quot;cunning newtype&quot; derivation</span></span><span class="mpre">
instance </span><a href="Control.DeepSeq.html#loc_110_7_110_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_110_7_110_13&#39;)"><span class="hl_classref"><span class="mpre">NFData</span></span></a><span class="mpre"> </span><a href="#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- FIXME: Data.Fixed had no NFData instances yet at time of writing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- necessary because H98 doesn&#39;t have &quot;cunning newtype&quot; derivation</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Enum</span></span><span class="mpre"> </span><a href="#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre"> where
        </span><span class="hl_fundecl"><span class="mpre">succ</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_57_26_57_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_26_57_27&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">succ</span></span><span class="mpre"> </span><a href="#loc_57_26_57_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_26_57_27&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
        </span><span class="hl_fundecl"><span class="mpre">pred</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_58_26_58_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_26_58_27&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">pred</span></span><span class="mpre"> </span><a href="#loc_58_26_58_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_26_58_27&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
        </span><span class="hl_vardecl"><span class="mpre">toEnum</span></span><span class="mpre"> = </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre">
        </span><span class="hl_fundecl"><span class="mpre">fromEnum</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_60_30_60_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_30_60_31&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_60_30_60_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_30_60_31&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
        </span><span class="hl_fundecl"><span class="mpre">enumFrom</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_61_30_61_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_30_61_31&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">enumFrom</span></span><span class="mpre"> </span><a href="#loc_61_30_61_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_30_61_31&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
        </span><span class="hl_fundecl"><span class="mpre">enumFromThen</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_62_34_62_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_34_62_35&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_62_49_62_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_49_62_50&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">enumFromThen</span></span><span class="mpre"> </span><a href="#loc_62_34_62_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_34_62_35&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_62_49_62_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_49_62_50&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
        </span><span class="hl_fundecl"><span class="mpre">enumFromTo</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_63_32_63_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_32_63_33&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_63_47_63_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_47_63_48&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">enumFromTo</span></span><span class="mpre"> </span><a href="#loc_63_32_63_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_32_63_33&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_63_47_63_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_47_63_48&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
        </span><span class="hl_fundecl"><span class="mpre">enumFromThenTo</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_64_36_64_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_36_64_37&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_64_51_64_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_51_64_52&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_64_66_64_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_66_64_67&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">enumFromThenTo</span></span><span class="mpre"> </span><a href="#loc_64_36_64_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_36_64_37&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_64_51_64_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_51_64_52&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_64_66_64_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_66_64_67&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre"> where
        </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_67_26_67_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_26_67_27&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) = (</span><a href="Data.Fixed.html#loc_142_1_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Fixed.html#loc_142_1_142_10&#39;)"><span class="hl_varref"><span class="mpre">showFixed</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_67_26_67_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_26_67_27&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;s&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- necessary because H98 doesn&#39;t have &quot;cunning newtype&quot; derivation</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Num</span></span><span class="mpre"> </span><a href="#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre"> where
        (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_71_21_71_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_21_71_22&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) </span><span class="hl_fundecl"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_71_38_71_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_38_71_39&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><a href="#loc_71_21_71_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_21_71_22&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_71_38_71_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_38_71_39&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
        (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_72_21_72_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_21_72_22&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) </span><span class="hl_fundecl"><span class="mpre">-</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_72_38_72_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_38_72_39&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><a href="#loc_72_21_72_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_21_72_22&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_72_38_72_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_38_72_39&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
        (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_73_21_73_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_21_73_22&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) </span><span class="hl_fundecl"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_73_38_73_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_38_73_39&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><a href="#loc_73_21_73_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_21_73_22&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_73_38_73_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_38_73_39&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
        </span><span class="hl_fundecl"><span class="mpre">negate</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_74_28_74_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_28_74_29&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">negate</span></span><span class="mpre"> </span><a href="#loc_74_28_74_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_28_74_29&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
        </span><span class="hl_fundecl"><span class="mpre">abs</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_75_25_75_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_25_75_26&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">abs</span></span><span class="mpre"> </span><a href="#loc_75_25_75_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_25_75_26&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
        </span><span class="hl_fundecl"><span class="mpre">signum</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_76_28_76_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_28_76_29&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">signum</span></span><span class="mpre"> </span><a href="#loc_76_28_76_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_28_76_29&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
        </span><span class="hl_fundecl"><span class="mpre">fromInteger</span></span><span class="mpre"> </span><a name="loc_77_21_77_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_22&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> </span><a href="#loc_77_21_77_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_22&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- necessary because H98 doesn&#39;t have &quot;cunning newtype&quot; derivation</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Real</span></span><span class="mpre"> </span><a href="#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre"> where
        </span><span class="hl_fundecl"><span class="mpre">toRational</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_81_32_81_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_32_81_33&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">toRational</span></span><span class="mpre"> </span><a href="#loc_81_32_81_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_32_81_33&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- necessary because H98 doesn&#39;t have &quot;cunning newtype&quot; derivation</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Fractional</span></span><span class="mpre"> </span><a href="#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre"> where
        (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_85_21_85_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_21_85_22&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) </span><span class="hl_fundecl"><span class="mpre">/</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_85_38_85_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_38_85_39&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><a href="#loc_85_21_85_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_21_85_22&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><a href="#loc_85_38_85_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_38_85_39&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
        </span><span class="hl_fundecl"><span class="mpre">recip</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_86_27_86_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_27_86_28&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">recip</span></span><span class="mpre"> </span><a href="#loc_86_27_86_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_27_86_28&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
        </span><span class="hl_fundecl"><span class="mpre">fromRational</span></span><span class="mpre"> </span><a name="loc_87_22_87_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_22_87_23&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromRational</span></span><span class="mpre"> </span><a href="#loc_87_22_87_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_22_87_23&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- necessary because H98 doesn&#39;t have &quot;cunning newtype&quot; derivation</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">RealFrac</span></span><span class="mpre"> </span><a href="#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">properFraction</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_91_32_91_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_32_91_33&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = let (</span><a name="loc_91_42_91_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_42_91_44&#39;)"><span class="hl_vardecl"><span class="mpre">b&#39;</span></span></a><span class="mpre">,</span><a name="loc_91_45_91_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_45_91_47&#39;)"><span class="hl_vardecl"><span class="mpre">a&#39;</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">properFraction</span></span><span class="mpre"> </span><a href="#loc_91_32_91_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_32_91_33&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> in (</span><a href="#loc_91_42_91_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_42_91_44&#39;)"><span class="hl_varref"><span class="mpre">b&#39;</span></span></a><span class="mpre">,</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a href="#loc_91_45_91_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_45_91_47&#39;)"><span class="hl_varref"><span class="mpre">a&#39;</span></span></a><span class="mpre">)
    </span><span class="hl_fundecl"><span class="mpre">truncate</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_92_26_92_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_26_92_27&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">truncate</span></span><span class="mpre"> </span><a href="#loc_92_26_92_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_26_92_27&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">round</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_93_23_93_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_23_93_24&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">round</span></span><span class="mpre"> </span><a href="#loc_93_23_93_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_23_93_24&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">ceiling</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_94_25_94_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_25_94_26&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">ceiling</span></span><span class="mpre"> </span><a href="#loc_94_25_94_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_25_94_26&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">floor</span></span><span class="mpre"> (</span><a href="#loc_41_20_41_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_30&#39;)"><span class="hl_conref"><span class="mpre">MkDiffTime</span></span></a><span class="mpre"> </span><a name="loc_95_23_95_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_23_95_24&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">floor</span></span><span class="mpre"> </span><a href="#loc_95_23_95_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_23_95_24&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create a &#39;DiffTime&#39; which represents an integral number of seconds.</span></span><span class="mpre">
</span><a href="#loc_99_1_99_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_18&#39;)"><span class="mpre">secondsToDiffTime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre">
</span><a name="loc_99_1_99_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_18&#39;)"><span class="hl_vardecl"><span class="mpre">secondsToDiffTime</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create a &#39;DiffTime&#39; from a number of picoseconds.</span></span><span class="mpre">
</span><a href="#loc_103_1_103_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_22&#39;)"><span class="mpre">picosecondsToDiffTime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><a href="#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre">
</span><a name="loc_103_1_103_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_22&#39;)"><span class="hl_fundecl"><span class="mpre">picosecondsToDiffTime</span></span></a><span class="mpre"> </span><a name="loc_103_23_103_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_23_103_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromRational</span></span><span class="mpre"> (</span><a href="#loc_103_23_103_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_23_103_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">%</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1000000000000</span></span><span class="mpre">)

</span><span class="hl_pragma"><span class="mpre">{-# RULES
&quot;realToFrac/DiffTime-&gt;Pico&quot;              realToFrac = \ (MkDiffTime ps) -&gt; ps
&quot;realToFrac/Pico-&gt;DiffTime&quot;              realToFrac = MkDiffTime
  #-}</span></span><span class="mpre">

</span></div></body></html>