<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module Data.Time.Calendar.Easter
        (
        sundayAfter,
        orthodoxPaschalMoon,orthodoxEaster,
        gregorianPaschalMoon,gregorianEaster
        ) where

</span><span class="hl_comment"><span class="mpre">-- formulae from Reingold &amp; Dershowitz, _Calendrical Calculations_, ch. 8.</span></span><span class="mpre">
        
import Data.Time.Calendar
import Data.Time.Calendar.Julian

</span><span class="hl_comment"><span class="mpre">-- | The next Sunday strictly after a given day.</span></span><span class="mpre">
</span><a href="#loc_15_1_15_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_12&#39;)"><span class="mpre">sundayAfter</span></a><span class="mpre"> :: </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_15_1_15_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_12&#39;)"><span class="hl_fundecl"><span class="mpre">sundayAfter</span></span></a><span class="mpre"> </span><a name="loc_15_13_15_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_13_15_16&#39;)"><span class="hl_vardecl"><span class="mpre">day</span></span></a><span class="mpre"> = </span><a href="Data.Time.Calendar.Days.html#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">addDays</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> (</span><a href="Data.Time.Calendar.Days.html#loc_18_34_18_53" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_34_18_53&#39;)"><span class="hl_varref"><span class="mpre">toModifiedJulianDay</span></span></a><span class="mpre"> </span><a href="#loc_15_13_15_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_13_15_16&#39;)"><span class="hl_varref"><span class="mpre">day</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">)) </span><a href="#loc_15_13_15_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_13_15_16&#39;)"><span class="hl_varref"><span class="mpre">day</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Given a year, find the Paschal full moon according to Orthodox Christian tradition</span></span><span class="mpre">
</span><a href="#loc_19_1_19_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_20&#39;)"><span class="mpre">orthodoxPaschalMoon</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_19_1_19_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_20&#39;)"><span class="hl_fundecl"><span class="mpre">orthodoxPaschalMoon</span></span></a><span class="mpre"> </span><a name="loc_19_21_19_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_21_19_25&#39;)"><span class="hl_vardecl"><span class="mpre">year</span></span></a><span class="mpre">  = </span><a href="Data.Time.Calendar.Days.html#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">addDays</span></span></a><span class="mpre"> (- </span><a href="#loc_20_9_20_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_9_20_21&#39;)"><span class="hl_varref"><span class="mpre">shiftedEpact</span></span></a><span class="mpre">) (</span><a href="Data.Time.Calendar.Julian.html#loc_27_1_27_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Julian.html#loc_27_1_27_11&#39;)"><span class="hl_varref"><span class="mpre">fromJulian</span></span></a><span class="mpre"> </span><a href="#loc_21_9_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_9_21_14&#39;)"><span class="hl_varref"><span class="mpre">jyear</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre">) where
        </span><a name="loc_20_9_20_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_9_20_21&#39;)"><span class="hl_vardecl"><span class="mpre">shiftedEpact</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_19_21_19_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_21_19_25&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre">)) </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">
        </span><a name="loc_21_9_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_9_21_14&#39;)"><span class="hl_vardecl"><span class="mpre">jyear</span></span></a><span class="mpre"> = if </span><a href="#loc_19_21_19_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_21_19_25&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><a href="#loc_19_21_19_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_21_19_25&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> else </span><a href="#loc_19_21_19_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_21_19_25&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Given a year, find Easter according to Orthodox Christian tradition</span></span><span class="mpre">
</span><a href="#loc_25_1_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_15&#39;)"><span class="mpre">orthodoxEaster</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_25_1_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_15&#39;)"><span class="hl_vardecl"><span class="mpre">orthodoxEaster</span></span></a><span class="mpre"> = </span><a href="#loc_15_1_15_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_12&#39;)"><span class="hl_varref"><span class="mpre">sundayAfter</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_19_1_19_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_1_19_20&#39;)"><span class="hl_varref"><span class="mpre">orthodoxPaschalMoon</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Given a year, find the Paschal full moon according to the Gregorian method</span></span><span class="mpre">
</span><a href="#loc_29_1_29_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_21&#39;)"><span class="mpre">gregorianPaschalMoon</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_29_1_29_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_21&#39;)"><span class="hl_fundecl"><span class="mpre">gregorianPaschalMoon</span></span></a><span class="mpre"> </span><a name="loc_29_22_29_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_22_29_26&#39;)"><span class="hl_vardecl"><span class="mpre">year</span></span></a><span class="mpre">  = </span><a href="Data.Time.Calendar.Days.html#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">addDays</span></span></a><span class="mpre"> (- </span><a href="#loc_32_9_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_9_32_22&#39;)"><span class="hl_varref"><span class="mpre">adjustedEpact</span></span></a><span class="mpre">) (</span><a href="Data.Time.Calendar.Gregorian.html#loc_32_1_32_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Gregorian.html#loc_32_1_32_14&#39;)"><span class="hl_varref"><span class="mpre">fromGregorian</span></span></a><span class="mpre"> </span><a href="#loc_29_22_29_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_22_29_26&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre">) where
        </span><a name="loc_30_9_30_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_16&#39;)"><span class="hl_vardecl"><span class="mpre">century</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> </span><a href="#loc_29_22_29_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_22_29_26&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a name="loc_31_9_31_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_21&#39;)"><span class="hl_vardecl"><span class="mpre">shiftedEpact</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_29_22_29_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_22_29_26&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_30_9_30_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_16&#39;)"><span class="hl_varref"><span class="mpre">century</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">div</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_30_9_30_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_16&#39;)"><span class="hl_varref"><span class="mpre">century</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">25</span></span><span class="mpre">)) </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre">
        </span><a name="loc_32_9_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_9_32_22&#39;)"><span class="hl_vardecl"><span class="mpre">adjustedEpact</span></span></a><span class="mpre"> = if </span><a href="#loc_31_9_31_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_21&#39;)"><span class="hl_varref"><span class="mpre">shiftedEpact</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> ((</span><a href="#loc_31_9_31_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_21&#39;)"><span class="hl_varref"><span class="mpre">shiftedEpact</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mod</span></span><span class="mpre"> </span><a href="#loc_29_22_29_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_22_29_26&#39;)"><span class="hl_varref"><span class="mpre">year</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">)) then </span><a href="#loc_31_9_31_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_21&#39;)"><span class="hl_varref"><span class="mpre">shiftedEpact</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> else </span><a href="#loc_31_9_31_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_21&#39;)"><span class="hl_varref"><span class="mpre">shiftedEpact</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Given a year, find Easter according to the Gregorian method</span></span><span class="mpre">
</span><a href="#loc_36_1_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_16&#39;)"><span class="mpre">gregorianEaster</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre">
</span><a name="loc_36_1_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_16&#39;)"><span class="hl_vardecl"><span class="mpre">gregorianEaster</span></span></a><span class="mpre"> = </span><a href="#loc_15_1_15_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_12&#39;)"><span class="hl_varref"><span class="mpre">sundayAfter</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_29_1_29_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_21&#39;)"><span class="hl_varref"><span class="mpre">gregorianPaschalMoon</span></span></a><span class="mpre">
</span></div></body></html>