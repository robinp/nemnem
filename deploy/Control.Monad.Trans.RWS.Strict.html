<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Control.Monad.Trans.RWS.Strict</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) Andy Gill 2001,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                (c) Oregon Graduate Institute of Science and Technology, 2001</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  ross@soi.city.ac.uk</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A monad transformer that combines &#39;ReaderT&#39;, &#39;WriterT&#39; and &#39;StateT&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This version is strict; for a lazy version, see</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;Control.Monad.Trans.RWS.Lazy&quot;, which has the same interface.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Control.Monad.Trans.RWS.Strict (
    </span><span class="hl_comment"><span class="mpre">-- * The RWS monad</span></span><span class="mpre">
    RWS,
    rws,
    runRWS,
    evalRWS,
    execRWS,
    mapRWS,
    withRWS,
    </span><span class="hl_comment"><span class="mpre">-- * The RWST monad transformer</span></span><span class="mpre">
    RWST(..),
    evalRWST,
    execRWST,
    mapRWST,
    withRWST,
    </span><span class="hl_comment"><span class="mpre">-- * Reader operations</span></span><span class="mpre">
    reader,
    ask,
    local,
    asks,
    </span><span class="hl_comment"><span class="mpre">-- * Writer operations</span></span><span class="mpre">
    writer,
    tell,
    listen,
    listens,
    pass,
    censor,
    </span><span class="hl_comment"><span class="mpre">-- * State operations</span></span><span class="mpre">
    state,
    get,
    put,
    modify,
    gets,
    </span><span class="hl_comment"><span class="mpre">-- * Lifting other operations</span></span><span class="mpre">
    liftCallCC,
    liftCallCC&#39;,
    liftCatch,
  ) where

import Control.Monad.IO.Class
import Control.Monad.Trans.Class
import Data.Functor.Identity

import Control.Applicative
import Control.Monad
import Control.Monad.Fix
import Data.Monoid

</span><span class="hl_comment"><span class="mpre">-- | A monad containing an environment of type @r@, output of type @w@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and an updatable state of type @s@.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 67, srcSpanStartColumn = 1, srcSpanEndLine = 67, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 67, srcSpanStartColumn = 1, srcSpanEndLine = 67, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0"><span class="mpre">type RWS r w s = RWST r w s Identity</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Construct an RWS computation from a function.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (The inverse of &#39;runRWS&#39;.)</span></span><span class="mpre">
</span><a href="#loc_72_1_72_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_4&#39;)"><span class="mpre">rws</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyconref"><span class="mpre">RWS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_72_1_72_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_4&#39;)"><span class="hl_fundecl"><span class="mpre">rws</span></span></a><span class="mpre"> </span><a name="loc_72_5_72_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_6&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> (\ </span><a name="loc_72_17_72_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_17_72_18&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_72_19_72_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_19_72_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Identity</span></span><span class="mpre"> (</span><a href="#loc_72_5_72_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_72_17_72_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_17_72_18&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_72_19_72_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_19_72_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | Unwrap an RWS computation as a function.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (The inverse of &#39;rws&#39;.)</span></span><span class="mpre">
</span><a href="#loc_77_1_77_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_7&#39;)"><span class="mpre">runRWS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">RWS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)
</span><a name="loc_77_1_77_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_7&#39;)"><span class="hl_fundecl"><span class="mpre">runRWS</span></span></a><span class="mpre"> </span><a name="loc_77_8_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_8_77_9&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_77_10_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_10_77_11&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_77_12_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_12_77_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="Data.Functor.Identity.html#loc_34_33_34_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.Identity.html#loc_34_33_34_44&#39;)"><span class="hl_varref"><span class="mpre">runIdentity</span></span></a><span class="mpre"> (</span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_77_8_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_8_77_9&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_77_10_77_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_10_77_11&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_77_12_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_12_77_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Evaluate a computation with the given initial state and environment,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- returning the final value and output, discarding the final state.</span></span><span class="mpre">
</span><a href="#loc_85_1_85_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_8&#39;)"><span class="mpre">evalRWS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">RWS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^RWS computation to execute</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">            </span><span class="hl_comment"><span class="mpre">-- ^initial environment</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">            </span><span class="hl_comment"><span class="mpre">-- ^initial value</span></span><span class="mpre">
        -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)       </span><span class="hl_comment"><span class="mpre">-- ^final value and output</span></span><span class="mpre">
</span><a name="loc_85_1_85_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_8&#39;)"><span class="hl_fundecl"><span class="mpre">evalRWS</span></span></a><span class="mpre"> </span><a name="loc_85_9_85_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_10&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_85_11_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_11_85_12&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_85_13_85_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = let
    (</span><a name="loc_86_6_86_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_7&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, _, </span><a name="loc_86_12_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_13&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) = </span><a href="#loc_77_1_77_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_7&#39;)"><span class="hl_varref"><span class="mpre">runRWS</span></span></a><span class="mpre"> </span><a href="#loc_85_9_85_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_85_11_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_11_85_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_85_13_85_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    in (</span><a href="#loc_86_6_86_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_7&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_86_12_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Evaluate a computation with the given initial state and environment,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- returning the final state and output, discarding the final value.</span></span><span class="mpre">
</span><a href="#loc_95_1_95_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_8&#39;)"><span class="mpre">execRWS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">RWS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^RWS computation to execute</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">            </span><span class="hl_comment"><span class="mpre">-- ^initial environment</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">            </span><span class="hl_comment"><span class="mpre">-- ^initial value</span></span><span class="mpre">
        -&gt; (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)       </span><span class="hl_comment"><span class="mpre">-- ^final state and output</span></span><span class="mpre">
</span><a name="loc_95_1_95_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_8&#39;)"><span class="hl_fundecl"><span class="mpre">execRWS</span></span></a><span class="mpre"> </span><a name="loc_95_9_95_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_10&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_95_11_95_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_11_95_12&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_95_13_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_13_95_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = let
    (_, </span><a name="loc_96_9_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_9_96_11&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a name="loc_96_13_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) = </span><a href="#loc_77_1_77_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_7&#39;)"><span class="hl_varref"><span class="mpre">runRWS</span></span></a><span class="mpre"> </span><a href="#loc_95_9_95_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_95_11_95_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_11_95_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_95_13_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_13_95_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    in (</span><a href="#loc_96_9_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_9_96_11&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a href="#loc_96_13_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Map the return value, final state and output of a computation using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the given function.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;runRWS&#39; (&#39;mapRWS&#39; f m) r s = f (&#39;runRWS&#39; m r s)@</span></span><span class="mpre">
</span><a href="#loc_104_1_104_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_7&#39;)"><span class="mpre">mapRWS</span></a><span class="mpre"> :: ((</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">w&#39;</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyconref"><span class="mpre">RWS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">RWS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w&#39;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_104_1_104_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_7&#39;)"><span class="hl_fundecl"><span class="mpre">mapRWS</span></span></a><span class="mpre"> </span><a name="loc_104_8_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_8_104_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_145_1_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_8&#39;)"><span class="hl_varref"><span class="mpre">mapRWST</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Identity</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_104_8_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_8_104_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Functor.Identity.html#loc_34_33_34_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.Identity.html#loc_34_33_34_44&#39;)"><span class="hl_varref"><span class="mpre">runIdentity</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;withRWS&#39; f m@ executes action @m@ with an initial environment</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and state modified by applying @f@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;runRWS&#39; (&#39;withRWS&#39; f m) r s = &#39;uncurry&#39; (&#39;runRWS&#39; m) (f r s)@</span></span><span class="mpre">
</span><a href="#loc_111_1_111_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_8&#39;)"><span class="mpre">withRWS</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyconref"><span class="mpre">RWS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">RWS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_111_1_111_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_8&#39;)"><span class="hl_vardecl"><span class="mpre">withRWS</span></span></a><span class="mpre"> = </span><a href="#loc_152_1_152_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_9&#39;)"><span class="hl_varref"><span class="mpre">withRWST</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | A monad transformer adding reading an environment of type @r@,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- collecting an output of type @w@ and updating a state of type @s@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to an inner monad @m@.</span></span><span class="mpre">
newtype </span><a name="loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tycondecl"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_condecl"><span class="mpre">RWST</span></span></a><span class="mpre"> { </span><a name="loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_fielddecl"><span class="mpre">runRWST</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">) }

</span><span class="hl_comment"><span class="mpre">-- | Evaluate a computation with the given initial state and environment,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- returning the final value and output, discarding the final state.</span></span><span class="mpre">
</span><a href="#loc_126_1_126_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_9&#39;)"><span class="mpre">evalRWST</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 121, srcSpanStartColumn = 13, srcSpanEndLine = 122, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 121, srcSpanStartColumn = 13, srcSpanEndLine = 121, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monad m)
         =&gt;</span></span><span class="mpre"> </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^computation to execute</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">                   </span><span class="hl_comment"><span class="mpre">-- ^initial environment</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">                   </span><span class="hl_comment"><span class="mpre">-- ^initial value</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)            </span><span class="hl_comment"><span class="mpre">-- ^computation yielding final value and output</span></span><span class="mpre">
</span><a name="loc_126_1_126_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_9&#39;)"><span class="hl_fundecl"><span class="mpre">evalRWST</span></span></a><span class="mpre"> </span><a name="loc_126_10_126_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_10_126_11&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_126_12_126_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_12_126_13&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_126_14_126_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_14_126_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = do
    (</span><a name="loc_127_6_127_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_6_127_7&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, _, </span><a name="loc_127_12_127_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_12_127_13&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_126_10_126_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_10_126_11&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_126_12_126_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_12_126_13&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_126_14_126_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_14_126_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_127_6_127_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_6_127_7&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_127_12_127_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_12_127_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Evaluate a computation with the given initial state and environment,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- returning the final state and output, discarding the final value.</span></span><span class="mpre">
</span><a href="#loc_137_1_137_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_9&#39;)"><span class="mpre">execRWST</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 132, srcSpanStartColumn = 13, srcSpanEndLine = 133, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 132, srcSpanStartColumn = 13, srcSpanEndLine = 132, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monad m)
         =&gt;</span></span><span class="mpre"> </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^computation to execute</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">                   </span><span class="hl_comment"><span class="mpre">-- ^initial environment</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">                   </span><span class="hl_comment"><span class="mpre">-- ^initial value</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)            </span><span class="hl_comment"><span class="mpre">-- ^computation yielding final state and output</span></span><span class="mpre">
</span><a name="loc_137_1_137_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_9&#39;)"><span class="hl_fundecl"><span class="mpre">execRWST</span></span></a><span class="mpre"> </span><a name="loc_137_10_137_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_10_137_11&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_137_12_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_12_137_13&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_137_14_137_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_14_137_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = do
    (_, </span><a name="loc_138_9_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_11&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a name="loc_138_13_138_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_13_138_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_137_10_137_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_10_137_11&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_137_12_137_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_12_137_13&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_137_14_137_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_14_137_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_138_9_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_11&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a href="#loc_138_13_138_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_13_138_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Map the inner computation using the given function.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;runRWST&#39; (&#39;mapRWST&#39; f m) r s = f (&#39;runRWST&#39; m r s)@</span></span><span class="mpre">
</span><a href="#loc_145_1_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_8&#39;)"><span class="mpre">mapRWST</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">n</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">w&#39;</span></span><span class="mpre">)) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w&#39;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">n</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_145_1_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_1_145_8&#39;)"><span class="hl_fundecl"><span class="mpre">mapRWST</span></span></a><span class="mpre"> </span><a name="loc_145_9_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_145_11_145_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_12&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_145_23_145_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_23_145_24&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_145_25_145_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_25_145_26&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_145_9_145_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_9_145_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_145_11_145_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_11_145_12&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_145_23_145_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_23_145_24&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_145_25_145_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_25_145_26&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;withRWST&#39; f m@ executes action @m@ with an initial environment</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and state modified by applying @f@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;runRWST&#39; (&#39;withRWST&#39; f m) r s = &#39;uncurry&#39; (&#39;runRWST&#39; m) (f r s)@</span></span><span class="mpre">
</span><a href="#loc_152_1_152_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_9&#39;)"><span class="mpre">withRWST</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_152_1_152_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_9&#39;)"><span class="hl_fundecl"><span class="mpre">withRWST</span></span></a><span class="mpre"> </span><a name="loc_152_10_152_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_10_152_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_152_12_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_12_152_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_152_24_152_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_24_152_25&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_152_26_152_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_26_152_27&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">uncurry</span></span><span class="mpre"> (</span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_152_12_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_12_152_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) (</span><a href="#loc_152_10_152_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_10_152_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_152_24_152_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_24_152_25&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_152_26_152_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_26_152_27&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

instance </span><span class="warning" data-warning="InstDecl ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 154, srcSpanStartColumn = 10, srcSpanEndLine = 154, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 154, srcSpanStartColumn = 10, srcSpanEndLine = 154, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Functor m) =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> (</span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
    </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_155_10_155_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_10_155_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_155_12_155_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_12_155_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_155_24_155_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_24_155_25&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_155_26_155_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_26_155_27&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt;
        </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (\ (</span><a name="loc_156_18_156_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_18_156_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_156_21_156_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_21_156_23&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a name="loc_156_25_156_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_25_156_26&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_155_10_155_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_10_155_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_156_18_156_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_18_156_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_156_21_156_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_21_156_23&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a href="#loc_156_25_156_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_25_156_26&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_155_12_155_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_12_155_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_155_24_155_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_24_155_25&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_155_26_155_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_26_155_27&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 158, srcSpanStartColumn = 10, srcSpanEndLine = 158, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 158, srcSpanStartColumn = 10, srcSpanEndLine = 158, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w, Functor m, Monad m) =&gt;</span></span><span class="mpre"> </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> (</span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
    </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_vardecl"><span class="mpre">pure</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">
    </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;*&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="hl_varref"><span class="mpre">ap</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 10, srcSpanEndLine = 162, srcSpanEndColumn = 47}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 10, srcSpanEndLine = 162, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w, Functor m, MonadPlus m) =&gt;</span></span><span class="mpre"> </span><a href="Control.Applicative.html#loc_138_24_138_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_138_24_138_35&#39;)"><span class="hl_classref"><span class="mpre">Alternative</span></span></a><span class="mpre"> (</span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
    </span><a href="Control.Applicative.html#loc_140_5_140_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_140_5_140_10&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_varref"><span class="mpre">mzero</span></span></a><span class="mpre">
    </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;|&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_varref"><span class="mpre">mplus</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 166, srcSpanStartColumn = 10, srcSpanEndLine = 166, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 166, srcSpanStartColumn = 10, srcSpanEndLine = 166, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> (</span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
    </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_167_12_167_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_12_167_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ </span><a name="loc_167_26_167_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_26_167_27&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_167_12_167_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_12_167_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_167_26_167_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_26_167_27&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">)
    </span><a name="loc_168_5_168_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_6&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_168_11_168_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_11_168_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">  = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_168_24_168_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_24_168_25&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_168_26_168_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_26_168_27&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; do
        (</span><a name="loc_169_10_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_10_169_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_169_13_169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_13_169_15&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a name="loc_169_17_169_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_17_169_18&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">)  &lt;- </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_168_5_168_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_168_24_168_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_24_168_25&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_168_26_168_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_26_168_27&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
        (</span><a name="loc_170_10_170_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_10_170_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">, </span><a name="loc_170_13_170_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_13_170_16&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;&#39;</span></span></a><span class="mpre">,</span><a name="loc_170_17_170_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_17_170_19&#39;)"><span class="hl_vardecl"><span class="mpre">w&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> (</span><a href="#loc_168_11_168_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_11_168_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_169_10_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_10_169_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_168_24_168_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_24_168_25&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_169_13_169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_13_169_15&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_170_10_170_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_10_170_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">, </span><a href="#loc_170_13_170_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_13_170_16&#39;)"><span class="hl_varref"><span class="mpre">s&#39;&#39;</span></span></a><span class="mpre">, </span><a href="#loc_169_17_169_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_17_169_18&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_170_17_170_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_17_170_19&#39;)"><span class="hl_varref"><span class="mpre">w&#39;</span></span></a><span class="mpre">)
    </span><span class="hl_fundecl"><span class="mpre">fail</span></span><span class="mpre"> </span><a name="loc_172_10_172_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_10_172_13&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ _ -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><a href="#loc_172_10_172_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_10_172_13&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 10, srcSpanEndLine = 174, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 10, srcSpanEndLine = 174, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w, MonadPlus m) =&gt;</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_122_18_122_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_122_18_122_27&#39;)"><span class="hl_classref"><span class="mpre">MonadPlus</span></span></a><span class="mpre"> (</span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
    </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_vardecl"><span class="mpre">mzero</span></span></a><span class="mpre">       = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ _ -&gt; </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_varref"><span class="mpre">mzero</span></span></a><span class="mpre">
    </span><a name="loc_176_5_176_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_5_176_6&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a name="loc_176_15_176_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_15_176_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_176_27_176_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_27_176_28&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_176_29_176_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_29_176_30&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_176_5_176_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_5_176_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_176_27_176_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_27_176_28&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_176_29_176_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_29_176_30&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_176_15_176_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_15_176_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_176_27_176_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_27_176_28&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_176_29_176_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_29_176_30&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 178, srcSpanStartColumn = 10, srcSpanEndLine = 178, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 178, srcSpanStartColumn = 10, srcSpanEndLine = 178, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w, MonadFix m) =&gt;</span></span><span class="mpre"> </span><a href="Control.Monad.Fix.html#loc_48_20_48_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Fix.html#loc_48_20_48_28&#39;)"><span class="hl_classref"><span class="mpre">MonadFix</span></span></a><span class="mpre"> (</span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
    </span><a href="Control.Monad.Fix.html#loc_53_9_53_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Fix.html#loc_53_9_53_13&#39;)"><span class="hl_fundecl"><span class="mpre">mfix</span></span></a><span class="mpre"> </span><a name="loc_179_10_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_179_22_179_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_22_179_23&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_179_24_179_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_24_179_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="Control.Monad.Fix.html#loc_53_9_53_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Fix.html#loc_53_9_53_13&#39;)"><span class="hl_varref"><span class="mpre">mfix</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><span class="warning" data-warning="PatPIrrPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 179, srcSpanStartColumn = 38, srcSpanEndLine = 179, srcSpanEndColumn = 48}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 179, srcSpanStartColumn = 38, srcSpanEndLine = 179, srcSpanEndColumn = 39}]}) (PTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = "><span class="mpre">~(a, _, _)</span></span><span class="mpre"> -&gt; </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> (</span><a href="#loc_179_10_179_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">a</span></span><span class="mpre">) </span><a href="#loc_179_22_179_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_22_179_23&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_179_24_179_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_24_179_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 181, srcSpanStartColumn = 10, srcSpanEndLine = 181, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 181, srcSpanStartColumn = 10, srcSpanEndLine = 181, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w) =&gt;</span></span><span class="mpre"> </span><a href="Control.Monad.Trans.Class.html#loc_47_7_47_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_47_7_47_17&#39;)"><span class="hl_classref"><span class="mpre">MonadTrans</span></span></a><span class="mpre"> (</span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
    </span><a href="Control.Monad.Trans.Class.html#loc_49_5_49_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_49_5_49_9&#39;)"><span class="hl_fundecl"><span class="mpre">lift</span></span></a><span class="mpre"> </span><a name="loc_182_10_182_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_10_182_11&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ </span><a name="loc_182_24_182_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_24_182_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_183_9_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_9_183_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_182_10_182_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_10_182_11&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_183_9_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_9_183_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_182_24_182_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_24_182_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">)

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 186, srcSpanStartColumn = 10, srcSpanEndLine = 186, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 186, srcSpanStartColumn = 10, srcSpanEndLine = 186, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w, MonadIO m) =&gt;</span></span><span class="mpre"> </span><a href="Control.Monad.IO.Class.html#loc_30_20_30_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_30_20_30_27&#39;)"><span class="hl_classref"><span class="mpre">MonadIO</span></span></a><span class="mpre"> (</span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) where
    </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_vardecl"><span class="mpre">liftIO</span></span></a><span class="mpre"> = </span><a href="Control.Monad.Trans.Class.html#loc_49_5_49_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_49_5_49_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Reader operations</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Constructor for computations in the reader monad (equivalent to &#39;asks&#39;).</span></span><span class="mpre">
</span><a href="#loc_194_1_194_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_7&#39;)"><span class="mpre">reader</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 193, srcSpanStartColumn = 11, srcSpanEndLine = 193, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 193, srcSpanStartColumn = 11, srcSpanEndLine = 193, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_194_1_194_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_7&#39;)"><span class="hl_vardecl"><span class="mpre">reader</span></span></a><span class="mpre"> = </span><a href="#loc_210_1_210_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_5&#39;)"><span class="hl_varref"><span class="mpre">asks</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Fetch the value of the environment.</span></span><span class="mpre">
</span><a href="#loc_198_1_198_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_4&#39;)"><span class="mpre">ask</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 197, srcSpanStartColumn = 8, srcSpanEndLine = 197, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 197, srcSpanStartColumn = 8, srcSpanEndLine = 197, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0."><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_198_1_198_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_4&#39;)"><span class="hl_vardecl"><span class="mpre">ask</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_198_15_198_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_15_198_16&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_198_17_198_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_17_198_18&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_198_15_198_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_15_198_16&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">, </span><a href="#loc_198_17_198_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_17_198_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Execute a computation in a modified environment</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;runRWST&#39; (&#39;local&#39; f m) r s = &#39;runRWST&#39; m (f r) s@</span></span><span class="mpre">
</span><a href="#loc_204_1_204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_6&#39;)"><span class="mpre">local</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 203, srcSpanStartColumn = 10, srcSpanEndLine = 203, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 203, srcSpanStartColumn = 10, srcSpanEndLine = 203, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_204_1_204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_6&#39;)"><span class="hl_fundecl"><span class="mpre">local</span></span></a><span class="mpre"> </span><a name="loc_204_7_204_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_7_204_8&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_204_9_204_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_9_204_10&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_204_21_204_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_21_204_22&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_204_23_204_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_23_204_24&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_204_9_204_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_9_204_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><a href="#loc_204_7_204_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_7_204_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_204_21_204_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_21_204_22&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">) </span><a href="#loc_204_23_204_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_23_204_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Retrieve a function of the current environment.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;asks&#39; f = &#39;liftM&#39; f &#39;ask&#39;@</span></span><span class="mpre">
</span><a href="#loc_210_1_210_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_5&#39;)"><span class="mpre">asks</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 209, srcSpanStartColumn = 9, srcSpanEndLine = 209, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 209, srcSpanStartColumn = 9, srcSpanEndLine = 209, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0"><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_210_1_210_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_5&#39;)"><span class="hl_fundecl"><span class="mpre">asks</span></span></a><span class="mpre"> </span><a name="loc_210_6_210_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_6_210_7&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_210_18_210_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_18_210_19&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_210_20_210_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_20_210_21&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_210_6_210_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_6_210_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_210_18_210_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_18_210_19&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">, </span><a href="#loc_210_20_210_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_20_210_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Writer operations</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Construct a writer computation from a (result, output) pair.</span></span><span class="mpre">
</span><a href="#loc_217_1_217_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_7&#39;)"><span class="mpre">writer</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 216, srcSpanStartColumn = 11, srcSpanEndLine = 216, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 216, srcSpanStartColumn = 19, srcSpanEndLine = 216, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_217_1_217_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_7&#39;)"><span class="hl_fundecl"><span class="mpre">writer</span></span></a><span class="mpre"> (</span><a name="loc_217_9_217_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_9_217_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_217_12_217_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_12_217_13&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ </span><a name="loc_217_27_217_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_27_217_28&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_217_9_217_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_9_217_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_217_27_217_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_27_217_28&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_217_12_217_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_12_217_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;tell&#39; w@ is an action that produces the output @w@.</span></span><span class="mpre">
</span><a href="#loc_221_1_221_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_5&#39;)"><span class="mpre">tell</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 220, srcSpanStartColumn = 9, srcSpanEndLine = 220, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 220, srcSpanStartColumn = 9, srcSpanEndLine = 220, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0"><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_221_1_221_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_5&#39;)"><span class="hl_fundecl"><span class="mpre">tell</span></span></a><span class="mpre"> </span><a name="loc_221_6_221_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_6_221_7&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ </span><a name="loc_221_20_221_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_20_221_21&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">,</span><a href="#loc_221_20_221_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_20_221_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">,</span><a href="#loc_221_6_221_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_6_221_7&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;listen&#39; m@ is an action that executes the action @m@ and adds its</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- output to the value of the computation.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;runRWST&#39; (&#39;listen&#39; m) r s = &#39;liftM&#39; (\\(a, w) -&gt; ((a, w), w)) (&#39;runRWST&#39; m r s)@</span></span><span class="mpre">
</span><a href="#loc_228_1_228_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_1_228_7&#39;)"><span class="mpre">listen</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 227, srcSpanStartColumn = 11, srcSpanEndLine = 227, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 227, srcSpanStartColumn = 11, srcSpanEndLine = 227, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)
</span><a name="loc_228_1_228_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_1_228_7&#39;)"><span class="hl_fundecl"><span class="mpre">listen</span></span></a><span class="mpre"> </span><a name="loc_228_8_228_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_8_228_9&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_228_20_228_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_20_228_21&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_228_22_228_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_22_228_23&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; do
    (</span><a name="loc_229_6_229_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_6_229_7&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_229_9_229_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_9_229_11&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a name="loc_229_13_229_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_13_229_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_228_8_228_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_8_228_9&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_228_20_228_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_20_228_21&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_228_22_228_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_22_228_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> ((</span><a href="#loc_229_6_229_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_6_229_7&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_229_13_229_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_13_229_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">), </span><a href="#loc_229_9_229_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_9_229_11&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a href="#loc_229_13_229_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_13_229_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;listens&#39; f m@ is an action that executes the action @m@ and adds</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the result of applying @f@ to the output to the value of the computation.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;listens&#39; f m = &#39;liftM&#39; (id *** f) (&#39;listen&#39; m)@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;runRWST&#39; (&#39;listens&#39; f m) r s = &#39;liftM&#39; (\\(a, w) -&gt; ((a, f w), w)) (&#39;runRWST&#39; m r s)@</span></span><span class="mpre">
</span><a href="#loc_239_1_239_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_8&#39;)"><span class="mpre">listens</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 238, srcSpanStartColumn = 12, srcSpanEndLine = 238, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 238, srcSpanStartColumn = 12, srcSpanEndLine = 238, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_239_1_239_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_8&#39;)"><span class="hl_fundecl"><span class="mpre">listens</span></span></a><span class="mpre"> </span><a name="loc_239_9_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_9_239_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_239_11_239_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_11_239_12&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_239_23_239_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_23_239_24&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_239_25_239_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_25_239_26&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; do
    (</span><a name="loc_240_6_240_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_6_240_7&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_240_9_240_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_9_240_11&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a name="loc_240_13_240_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_13_240_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_239_11_239_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_11_239_12&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_239_23_239_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_23_239_24&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_239_25_239_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_25_239_26&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> ((</span><a href="#loc_240_6_240_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_6_240_7&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_239_9_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_9_239_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_240_13_240_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_13_240_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">), </span><a href="#loc_240_9_240_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_9_240_11&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a href="#loc_240_13_240_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_13_240_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;pass&#39; m@ is an action that executes the action @m@, which returns</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a value and a function, and returns the value, applying the function</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to the output.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;runRWST&#39; (&#39;pass&#39; m) r s = &#39;liftM&#39; (\\((a, f), w) -&gt; (a, f w)) (&#39;runRWST&#39; m r s)@</span></span><span class="mpre">
</span><a href="#loc_249_1_249_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_5&#39;)"><span class="mpre">pass</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 248, srcSpanStartColumn = 9, srcSpanEndLine = 248, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 248, srcSpanStartColumn = 9, srcSpanEndLine = 248, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0"><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_249_1_249_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_5&#39;)"><span class="hl_fundecl"><span class="mpre">pass</span></span></a><span class="mpre"> </span><a name="loc_249_6_249_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_6_249_7&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_249_18_249_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_18_249_19&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_249_20_249_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_20_249_21&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; do
    ((</span><a name="loc_250_7_250_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_7_250_8&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_250_10_250_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_10_250_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">), </span><a name="loc_250_14_250_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_14_250_16&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a name="loc_250_18_250_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_18_250_19&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_249_6_249_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_6_249_7&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_249_18_249_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_18_249_19&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_249_20_249_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_20_249_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_250_7_250_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_7_250_8&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_250_14_250_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_14_250_16&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a href="#loc_250_10_250_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_10_250_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_250_18_250_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_18_250_19&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;censor&#39; f m@ is an action that executes the action @m@ and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- applies the function @f@ to its output, leaving the return value</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- unchanged.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;censor&#39; f m = &#39;pass&#39; (&#39;liftM&#39; (\\x -&gt; (x,f)) m)@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;runRWST&#39; (&#39;censor&#39; f m) r s = &#39;liftM&#39; (\\(a, w) -&gt; (a, f w)) (&#39;runRWST&#39; m r s)@</span></span><span class="mpre">
</span><a href="#loc_261_1_261_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_7&#39;)"><span class="mpre">censor</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 260, srcSpanStartColumn = 11, srcSpanEndLine = 260, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 260, srcSpanStartColumn = 11, srcSpanEndLine = 260, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_261_1_261_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_7&#39;)"><span class="hl_fundecl"><span class="mpre">censor</span></span></a><span class="mpre"> </span><a name="loc_261_8_261_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_8_261_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_261_10_261_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_10_261_11&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_261_22_261_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_22_261_23&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_261_24_261_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_24_261_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; do
    (</span><a name="loc_262_6_262_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_6_262_7&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_262_9_262_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_9_262_11&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a name="loc_262_13_262_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_13_262_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_261_10_261_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_10_261_11&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_261_22_261_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_22_261_23&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_261_24_261_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_24_261_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_262_6_262_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_6_262_7&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_262_9_262_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_9_262_11&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a href="#loc_261_8_261_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_8_261_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_262_13_262_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_13_262_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- State operations</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Construct a state monad computation from a state transformer function.</span></span><span class="mpre">
</span><a href="#loc_270_1_270_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_1_270_6&#39;)"><span class="mpre">state</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 269, srcSpanStartColumn = 10, srcSpanEndLine = 269, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 269, srcSpanStartColumn = 10, srcSpanEndLine = 269, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_270_1_270_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_1_270_6&#39;)"><span class="hl_fundecl"><span class="mpre">state</span></span></a><span class="mpre"> </span><a name="loc_270_7_270_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_7_270_8&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ </span><a name="loc_270_21_270_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_21_270_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_270_7_270_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_7_270_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_270_21_270_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_21_270_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of (</span><a name="loc_270_39_270_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_39_270_40&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_270_41_270_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_41_270_43&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_270_39_270_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_39_270_40&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_270_41_270_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_41_270_43&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Fetch the current value of the state within the monad.</span></span><span class="mpre">
</span><a href="#loc_274_1_274_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_1_274_4&#39;)"><span class="mpre">get</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 273, srcSpanStartColumn = 8, srcSpanEndLine = 273, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 273, srcSpanStartColumn = 8, srcSpanEndLine = 273, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0."><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_274_1_274_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_1_274_4&#39;)"><span class="hl_vardecl"><span class="mpre">get</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ </span><a name="loc_274_17_274_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_17_274_18&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_274_17_274_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_17_274_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_274_17_274_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_17_274_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;put&#39; s@ sets the state within the monad to @s@.</span></span><span class="mpre">
</span><a href="#loc_278_1_278_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_4&#39;)"><span class="mpre">put</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 277, srcSpanStartColumn = 8, srcSpanEndLine = 277, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 277, srcSpanStartColumn = 8, srcSpanEndLine = 277, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0."><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_278_1_278_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_4&#39;)"><span class="hl_fundecl"><span class="mpre">put</span></span></a><span class="mpre"> </span><a name="loc_278_5_278_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_5_278_6&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">, </span><a href="#loc_278_5_278_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_5_278_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;modify&#39; f@ is an action that updates the state to the result of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- applying @f@ to the current state.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;modify&#39; f = &#39;get&#39; &gt;&gt;= (&#39;put&#39; . f)@</span></span><span class="mpre">
</span><a href="#loc_285_1_285_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_1_285_7&#39;)"><span class="mpre">modify</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 284, srcSpanStartColumn = 11, srcSpanEndLine = 284, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 284, srcSpanStartColumn = 11, srcSpanEndLine = 284, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_285_1_285_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_1_285_7&#39;)"><span class="hl_fundecl"><span class="mpre">modify</span></span></a><span class="mpre"> </span><a name="loc_285_8_285_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_8_285_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ </span><a name="loc_285_22_285_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_22_285_23&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">, </span><a href="#loc_285_8_285_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_8_285_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_285_22_285_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_22_285_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">)
 
</span><span class="hl_comment"><span class="mpre">-- | Get a specific component of the state, using a projection function</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- supplied.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * @&#39;gets&#39; f = &#39;liftM&#39; f &#39;get&#39;@</span></span><span class="mpre">
</span><a href="#loc_292_1_292_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_1_292_5&#39;)"><span class="mpre">gets</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 291, srcSpanStartColumn = 9, srcSpanEndLine = 291, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 291, srcSpanStartColumn = 9, srcSpanEndLine = 291, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0"><span class="mpre">(Monoid w, Monad m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_292_1_292_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_1_292_5&#39;)"><span class="hl_fundecl"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a name="loc_292_6_292_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_7&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ </span><a name="loc_292_20_292_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_20_292_21&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_292_6_292_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_6_292_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_292_20_292_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_20_292_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_292_20_292_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_20_292_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Uniform lifting of a @callCC@ operation to the new monad.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This version rolls back to the original state on entering the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- continuation.</span></span><span class="mpre">
</span><a href="#loc_300_1_300_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_1_300_11&#39;)"><span class="mpre">liftCallCC</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 297, srcSpanStartColumn = 15, srcSpanEndLine = 297, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 297, srcSpanStartColumn = 15, srcSpanEndLine = 297, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w) =&gt;</span></span><span class="mpre">
    ((((</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)) -&gt;
    ((</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_300_1_300_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_1_300_11&#39;)"><span class="hl_fundecl"><span class="mpre">liftCallCC</span></span></a><span class="mpre"> </span><a name="loc_300_12_300_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_12_300_18&#39;)"><span class="hl_vardecl"><span class="mpre">callCC</span></span></a><span class="mpre"> </span><a name="loc_300_19_300_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_19_300_20&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_300_31_300_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_31_300_32&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_300_33_300_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_33_300_34&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt;
    </span><a href="#loc_300_12_300_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_12_300_18&#39;)"><span class="hl_varref"><span class="mpre">callCC</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_301_15_301_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_15_301_16&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt;
    </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> (</span><a href="#loc_300_19_300_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_19_300_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (\</span><a name="loc_302_18_302_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_18_302_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ _ -&gt; </span><a href="#loc_301_15_301_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_15_301_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_302_18_302_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_18_302_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_300_33_300_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_33_300_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">))) </span><a href="#loc_300_31_300_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_31_300_32&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_300_33_300_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_33_300_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | In-situ lifting of a @callCC@ operation to the new monad.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This version uses the current state on entering the continuation.</span></span><span class="mpre">
</span><a href="#loc_309_1_309_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_12&#39;)"><span class="mpre">liftCallCC&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 306, srcSpanStartColumn = 16, srcSpanEndLine = 306, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers-0.3.0.0/Control/Monad/Trans/RWS/Strict.hs&quot;, srcSpanStartLine = 306, srcSpanStartColumn = 16, srcSpanEndLine = 306, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/transformers"><span class="mpre">(Monoid w) =&gt;</span></span><span class="mpre">
    ((((</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)) -&gt;
    ((</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_309_1_309_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_12&#39;)"><span class="hl_fundecl"><span class="mpre">liftCallCC&#39;</span></span></a><span class="mpre"> </span><a name="loc_309_13_309_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_13_309_19&#39;)"><span class="hl_vardecl"><span class="mpre">callCC</span></span></a><span class="mpre"> </span><a name="loc_309_20_309_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_20_309_21&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_309_32_309_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_32_309_33&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_309_34_309_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_34_309_35&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt;
    </span><a href="#loc_309_13_309_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_13_309_19&#39;)"><span class="hl_varref"><span class="mpre">callCC</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_310_15_310_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_15_310_16&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt;
    </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> (</span><a href="#loc_309_20_309_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_20_309_21&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (\</span><a name="loc_311_18_311_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_18_311_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ </span><a name="loc_311_33_311_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_33_311_35&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_310_15_310_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_15_310_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_311_18_311_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_18_311_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_311_33_311_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_33_311_35&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">))) </span><a href="#loc_309_32_309_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_32_309_33&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_309_34_309_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_34_309_35&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Lift a @catchError@ operation to the new monad.</span></span><span class="mpre">
</span><a href="#loc_316_1_316_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_10&#39;)"><span class="mpre">liftCatch</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre">)) -&gt;
    </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">l</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">l</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_117_9_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_13&#39;)"><span class="hl_tyconref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">l</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">w</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_316_1_316_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_10&#39;)"><span class="hl_fundecl"><span class="mpre">liftCatch</span></span></a><span class="mpre"> </span><a name="loc_316_11_316_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_11_316_21&#39;)"><span class="hl_vardecl"><span class="mpre">catchError</span></span></a><span class="mpre"> </span><a name="loc_316_22_316_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_22_316_23&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_316_24_316_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_24_316_25&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> =
    </span><a href="#loc_117_26_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_26_117_30&#39;)"><span class="hl_conref"><span class="mpre">RWST</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_317_13_317_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_13_317_14&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_317_15_317_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_15_317_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> </span><a href="#loc_316_22_316_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_22_316_23&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_317_13_317_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_13_317_14&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_317_15_317_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_15_317_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_316_11_316_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_11_316_21&#39;)"><span class="hl_infix"><span class="mpre">`catchError`</span></span></a><span class="mpre"> \</span><a name="loc_317_48_317_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_48_317_49&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_117_33_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_33_117_40&#39;)"><span class="hl_varref"><span class="mpre">runRWST</span></span></a><span class="mpre"> (</span><a href="#loc_316_24_316_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_24_316_25&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_317_48_317_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_48_317_49&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">) </span><a href="#loc_317_13_317_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_13_317_14&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_317_15_317_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_15_317_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span></div></body></html>