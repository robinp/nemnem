<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
{-# LANGUAGE BangPatterns #-}
#ifndef MIN_VERSION_integer_gmp
#define MIN_VERSION_integer_gmp(a,b,c) 0
#endif
#if MIN_VERSION_integer_gmp(0,5,1)
{-# LANGUAGE MagicHash #-}
#endif
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Number.Prime</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Good</span></span><span class="mpre">

module Crypto.Number.Prime
    ( generatePrime
    , generateSafePrime
    , isProbablyPrime
    , findPrimeFrom
    , findPrimeFromWith
    , primalityTestNaive
    , primalityTestMillerRabin
    , primalityTestFermat
    , isCoprime
    ) where

import Crypto.Random.API
import Crypto.Number.Generate
import Crypto.Number.Basic (</span><a href="Crypto.Number.Basic.html#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Basic.html#loc_33_1_33_6&#39;)"><span class="mpre">sqrti</span></a><span class="mpre">, </span><a href="Crypto.Number.Basic.html#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Basic.html#loc_83_1_83_12&#39;)"><span class="mpre">gcde_binary</span></a><span class="mpre">)
import Crypto.Number.ModArithmetic (</span><a href="Crypto.Number.ModArithmetic.html#loc_121_1_121_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_121_1_121_15&#39;)"><span class="mpre">exponantiation</span></a><span class="mpre">)

#if MIN_VERSION_integer_gmp(0,5,1)
import GHC.Integer.GMP.Internals
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 8, srcSpanEndLine = 35, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre">
#else
import Data.Bits
#endif

</span><span class="hl_comment"><span class="mpre">-- | returns if the number is probably prime.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- first a list of small primes are implicitely tested for divisibility,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- then a fermat primality test is used with arbitrary numbers and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- then the Miller Rabin algorithm is used with an accuracy of 30 recursions</span></span><span class="mpre">
</span><a href="#loc_45_1_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_16&#39;)"><span class="mpre">isProbablyPrime</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 20, srcSpanEndLine = 44, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 27, srcSpanEndLine = 44, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_45_1_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_16&#39;)"><span class="hl_fundecl"><span class="mpre">isProbablyPrime</span></span></a><span class="mpre"> </span><a name="loc_45_17_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_17_45_20&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> !</span><a name="loc_45_22_45_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_22_45_23&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">any</span></span><span class="mpre"> (\</span><a name="loc_46_13_46_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_13_46_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_46_13_46_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_13_46_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_222_1_222_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_8&#39;)"><span class="hl_infix"><span class="mpre">`divides`</span></span></a><span class="mpre"> </span><a href="#loc_45_22_45_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_22_45_23&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_45_22_45_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_22_45_23&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><a href="#loc_175_1_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_12&#39;)"><span class="hl_varref"><span class="mpre">firstPrimes</span></span></a><span class="mpre">) = (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><a href="#loc_45_17_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_17_45_20&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre">)
    | </span><a href="#loc_151_1_151_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_20&#39;)"><span class="hl_varref"><span class="mpre">primalityTestFermat</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">50</span></span><span class="mpre"> (</span><a href="#loc_45_22_45_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_22_45_23&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">`div`</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_45_22_45_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_22_45_23&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">                   = </span><a href="#loc_91_1_91_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_25&#39;)"><span class="hl_varref"><span class="mpre">primalityTestMillerRabin</span></span></a><span class="mpre"> </span><a href="#loc_45_17_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_17_45_20&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre"> </span><a href="#loc_45_22_45_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_22_45_23&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                                            = (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><a href="#loc_45_17_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_17_45_20&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | generate a prime number of the required bitsize</span></span><span class="mpre">
</span><a href="#loc_52_1_52_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_14&#39;)"><span class="mpre">generatePrime</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 18, srcSpanEndLine = 51, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 25, srcSpanEndLine = 51, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_52_1_52_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_14&#39;)"><span class="hl_fundecl"><span class="mpre">generatePrime</span></span></a><span class="mpre"> </span><a name="loc_52_15_52_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_15_52_18&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_52_19_52_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_19_52_23&#39;)"><span class="hl_vardecl"><span class="mpre">bits</span></span></a><span class="mpre"> =
    let (</span><a name="loc_53_10_53_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_10_53_12&#39;)"><span class="hl_vardecl"><span class="mpre">sp</span></span></a><span class="mpre">, </span><a name="loc_53_14_53_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_14_53_18&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span></a><span class="mpre">) = </span><a href="Crypto.Number.Generate.html#loc_36_1_36_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Generate.html#loc_36_1_36_15&#39;)"><span class="hl_varref"><span class="mpre">generateOfSize</span></span></a><span class="mpre"> </span><a href="#loc_52_15_52_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_15_52_18&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a href="#loc_52_19_52_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_19_52_23&#39;)"><span class="hl_varref"><span class="mpre">bits</span></span></a><span class="mpre">
     in </span><a href="#loc_80_1_80_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_14&#39;)"><span class="hl_varref"><span class="mpre">findPrimeFrom</span></span></a><span class="mpre"> </span><a href="#loc_53_14_53_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_14_53_18&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre"> </span><a href="#loc_53_10_53_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_10_53_12&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | generate a prime number of the form 2p+1 where p is also prime.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it is also knowed as a Sophie Germaine prime or safe prime.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The number of safe prime is significantly smaller to the number of prime,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as such it shouldn&#39;t be used if this number is supposed to be kept safe.</span></span><span class="mpre">
</span><a href="#loc_62_1_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_18&#39;)"><span class="mpre">generateSafePrime</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 22, srcSpanEndLine = 61, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 29, srcSpanEndLine = 61, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_62_1_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_18&#39;)"><span class="hl_fundecl"><span class="mpre">generateSafePrime</span></span></a><span class="mpre"> </span><a name="loc_62_19_62_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_19_62_22&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_62_23_62_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_23_62_27&#39;)"><span class="hl_vardecl"><span class="mpre">bits</span></span></a><span class="mpre"> =
    let (</span><a name="loc_63_10_63_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_10_63_12&#39;)"><span class="hl_vardecl"><span class="mpre">sp</span></span></a><span class="mpre">, </span><a name="loc_63_14_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_14_63_18&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span></a><span class="mpre">) = </span><a href="Crypto.Number.Generate.html#loc_36_1_36_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Generate.html#loc_36_1_36_15&#39;)"><span class="hl_varref"><span class="mpre">generateOfSize</span></span></a><span class="mpre"> </span><a href="#loc_62_19_62_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_19_62_22&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a href="#loc_62_23_62_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_23_62_27&#39;)"><span class="hl_varref"><span class="mpre">bits</span></span></a><span class="mpre">
        (</span><a name="loc_64_10_64_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_10_64_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">, </span><a name="loc_64_13_64_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_13_64_18&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_69_1_69_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_18&#39;)"><span class="hl_varref"><span class="mpre">findPrimeFromWith</span></span></a><span class="mpre"> </span><a href="#loc_63_14_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_14_63_18&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre"> (\</span><a name="loc_64_47_64_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_47_64_48&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_64_49_64_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_49_64_50&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_45_1_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_16&#39;)"><span class="hl_varref"><span class="mpre">isProbablyPrime</span></span></a><span class="mpre"> </span><a href="#loc_64_47_64_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_47_64_48&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_64_49_64_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_49_64_50&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)) (</span><a href="#loc_63_10_63_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_10_63_12&#39;)"><span class="hl_varref"><span class="mpre">sp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
     in (</span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_64_10_64_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_10_64_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><a href="#loc_64_13_64_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_13_64_18&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | find a prime from a starting point where the property hold.</span></span><span class="mpre">
</span><a href="#loc_69_1_69_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_18&#39;)"><span class="mpre">findPrimeFromWith</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 22, srcSpanEndLine = 68, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 29, srcSpanEndLine = 68, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_69_1_69_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_18&#39;)"><span class="hl_fundecl"><span class="mpre">findPrimeFromWith</span></span></a><span class="mpre"> </span><a name="loc_69_19_69_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_22&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_69_23_69_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_23_69_27&#39;)"><span class="hl_vardecl"><span class="mpre">prop</span></span></a><span class="mpre"> !</span><a name="loc_69_29_69_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_29_69_30&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">even</span></span><span class="mpre"> </span><a href="#loc_69_29_69_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_29_69_30&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">        = </span><a href="#loc_69_1_69_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_18&#39;)"><span class="hl_varref"><span class="mpre">findPrimeFromWith</span></span></a><span class="mpre"> </span><a href="#loc_69_19_69_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_22&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a href="#loc_69_23_69_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_23_69_27&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre"> (</span><a href="#loc_69_29_69_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_29_69_30&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = case </span><a href="#loc_45_1_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_16&#39;)"><span class="hl_varref"><span class="mpre">isProbablyPrime</span></span></a><span class="mpre"> </span><a href="#loc_69_19_69_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_22&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a href="#loc_69_29_69_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_29_69_30&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> of
        (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><a name="loc_72_17_72_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_17_72_21&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span></a><span class="mpre">)    -&gt; </span><a href="#loc_69_1_69_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_18&#39;)"><span class="hl_varref"><span class="mpre">findPrimeFromWith</span></span></a><span class="mpre"> </span><a href="#loc_72_17_72_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_17_72_21&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre"> </span><a href="#loc_69_23_69_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_23_69_27&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre"> (</span><a href="#loc_69_29_69_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_29_69_30&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
        (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a name="loc_73_16_73_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_16_73_20&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span></a><span class="mpre">)     -&gt;
            case </span><a href="#loc_69_23_69_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_23_69_27&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a href="#loc_73_16_73_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_16_73_20&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre"> </span><a href="#loc_69_29_69_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_29_69_30&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> of
                (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><a name="loc_75_25_75_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_25_75_30&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_69_1_69_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_18&#39;)"><span class="hl_varref"><span class="mpre">findPrimeFromWith</span></span></a><span class="mpre"> </span><a href="#loc_75_25_75_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_25_75_30&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;&#39;</span></span></a><span class="mpre"> </span><a href="#loc_69_23_69_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_23_69_27&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre"> (</span><a href="#loc_69_29_69_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_29_69_30&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
                (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a name="loc_76_24_76_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_24_76_29&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;&#39;</span></span></a><span class="mpre">)  -&gt; (</span><a href="#loc_69_29_69_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_29_69_30&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><a href="#loc_76_24_76_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_24_76_29&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | find a prime from a starting point with no specific property.</span></span><span class="mpre">
</span><a href="#loc_80_1_80_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_14&#39;)"><span class="mpre">findPrimeFrom</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 18, srcSpanEndLine = 79, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 25, srcSpanEndLine = 79, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_80_1_80_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_14&#39;)"><span class="hl_fundecl"><span class="mpre">findPrimeFrom</span></span></a><span class="mpre"> </span><a name="loc_80_15_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_15_80_18&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_80_19_80_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_19_80_20&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
#if MIN_VERSION_integer_gmp(0,5,1)
    (</span><span class="hl_varref"><span class="mpre">nextPrimeInteger</span></span><span class="mpre"> </span><a href="#loc_80_19_80_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_19_80_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><a href="#loc_80_15_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_15_80_18&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre">)
#else
    </span><a href="#loc_69_1_69_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_18&#39;)"><span class="hl_varref"><span class="mpre">findPrimeFromWith</span></span></a><span class="mpre"> </span><a href="#loc_80_15_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_15_80_18&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> (\</span><a name="loc_84_29_84_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_29_84_30&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> _ -&gt; (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a href="#loc_84_29_84_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_29_84_30&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)) </span><a href="#loc_80_19_80_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_19_80_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- | Miller Rabin algorithm return if the number is probably prime or composite.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the tries parameter is the number of recursion, that determines the accuracy of the test.</span></span><span class="mpre">
</span><a href="#loc_91_1_91_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_25&#39;)"><span class="mpre">primalityTestMillerRabin</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 29, srcSpanEndLine = 89, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 36, srcSpanEndLine = 89, srcSpanEndColumn = 38}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pul"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
#if MIN_VERSION_integer_gmp(0,5,1)
</span><a name="loc_91_1_91_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_25&#39;)"><span class="hl_fundecl"><span class="mpre">primalityTestMillerRabin</span></span></a><span class="mpre"> </span><a name="loc_91_26_91_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_26_91_29&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">I#</span></span><span class="mpre"> </span><a name="loc_91_34_91_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_34_91_39&#39;)"><span class="hl_vardecl"><span class="mpre">tries</span></span></a><span class="mpre">) !</span><a name="loc_91_42_91_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_42_91_43&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
    case </span><span class="hl_varref"><span class="mpre">testPrimeInteger</span></span><span class="mpre"> </span><a href="#loc_91_42_91_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_42_91_43&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_91_34_91_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_34_91_39&#39;)"><span class="hl_varref"><span class="mpre">tries</span></span></a><span class="mpre"> of
        0# -&gt; (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><a href="#loc_91_26_91_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_26_91_29&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre">)
        _  -&gt; (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a href="#loc_91_26_91_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_26_91_29&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre">)
#else
</span><a href="#loc_91_1_91_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_25&#39;)"><span class="hl_fundecl"><span class="mpre">primalityTestMillerRabin</span></span></a><span class="mpre"> </span><a name="loc_96_26_96_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_26_96_29&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_96_30_96_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_30_96_35&#39;)"><span class="hl_vardecl"><span class="mpre">tries</span></span></a><span class="mpre"> !</span><a name="loc_96_37_96_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_37_96_38&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">
    | </span><a href="#loc_96_37_96_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_37_96_38&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">     = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Miller-Rabin requires tested value to be &gt; 3&quot;</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">even</span></span><span class="mpre"> </span><a href="#loc_96_37_96_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_37_96_38&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">     = (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><a href="#loc_96_26_96_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_26_96_29&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre">)
    | </span><a href="#loc_96_30_96_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_30_96_35&#39;)"><span class="hl_varref"><span class="mpre">tries</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Miller-Rabin tries need to be &gt; 0&quot;</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = let (</span><a name="loc_100_25_100_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_25_100_34&#39;)"><span class="hl_vardecl"><span class="mpre">witnesses</span></span></a><span class="mpre">, </span><a name="loc_100_36_100_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_36_100_40&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_107_15_107_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_15_107_28&#39;)"><span class="hl_varref"><span class="mpre">generateTries</span></span></a><span class="mpre"> </span><a href="#loc_96_30_96_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_30_96_35&#39;)"><span class="hl_varref"><span class="mpre">tries</span></span></a><span class="mpre"> </span><a href="#loc_96_26_96_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_26_96_29&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre">
                    in (</span><a href="#loc_120_15_120_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_15_120_19&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_100_25_100_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_25_100_34&#39;)"><span class="hl_varref"><span class="mpre">witnesses</span></span></a><span class="mpre">, </span><a href="#loc_100_36_100_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_36_100_40&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre">)
        where !</span><a name="loc_102_16_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_16_102_19&#39;)"><span class="hl_vardecl"><span class="mpre">nm1</span></span></a><span class="mpre"> = </span><a href="#loc_96_37_96_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_37_96_38&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
              !</span><a name="loc_103_16_103_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_16_103_19&#39;)"><span class="hl_vardecl"><span class="mpre">nm2</span></span></a><span class="mpre"> = </span><a href="#loc_96_37_96_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_37_96_38&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">

              (!</span><a name="loc_105_17_105_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_18&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">,!</span><a name="loc_105_20_105_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_20_105_21&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = (</span><a href="#loc_114_15_114_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_15_114_24&#39;)"><span class="hl_varref"><span class="mpre">factorise</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_102_16_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_16_102_19&#39;)"><span class="hl_varref"><span class="mpre">nm1</span></span></a><span class="mpre">)

              </span><a name="loc_107_15_107_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_15_107_28&#39;)"><span class="hl_fundecl"><span class="mpre">generateTries</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_107_31_107_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_31_107_32&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = ([], </span><a href="#loc_107_31_107_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_31_107_32&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
              </span><a href="#loc_107_15_107_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_15_107_28&#39;)"><span class="hl_fundecl"><span class="mpre">generateTries</span></span></a><span class="mpre"> </span><a name="loc_108_29_108_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_29_108_30&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_108_31_108_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_31_108_32&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = let (</span><a name="loc_108_40_108_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_40_108_41&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_108_42_108_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_42_108_44&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">)   = </span><a href="Crypto.Number.Generate.html#loc_29_1_29_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Generate.html#loc_29_1_29_16&#39;)"><span class="hl_varref"><span class="mpre">generateBetween</span></span></a><span class="mpre"> </span><a href="#loc_108_31_108_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_31_108_32&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><a href="#loc_103_16_103_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_16_103_19&#39;)"><span class="hl_varref"><span class="mpre">nm2</span></span></a><span class="mpre">
                                      (</span><a name="loc_109_40_109_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_40_109_42&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre">,</span><a name="loc_109_43_109_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_43_109_46&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_107_15_107_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_15_107_28&#39;)"><span class="hl_varref"><span class="mpre">generateTries</span></span></a><span class="mpre"> (</span><a href="#loc_108_29_108_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_29_108_30&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_108_42_108_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_42_108_44&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
                                   in (</span><a href="#loc_108_40_108_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_40_108_41&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_109_40_109_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_40_109_42&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">, </span><a href="#loc_109_43_109_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_43_109_46&#39;)"><span class="hl_varref"><span class="mpre">g&#39;&#39;</span></span></a><span class="mpre">)

              </span><span class="hl_comment"><span class="mpre">-- factorise n-1 into the form 2^s*d</span></span><span class="mpre">
              </span><a href="#loc_114_15_114_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_15_114_24&#39;)"><span class="mpre">factorise</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">)
              </span><a name="loc_114_15_114_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_15_114_24&#39;)"><span class="hl_fundecl"><span class="mpre">factorise</span></span></a><span class="mpre"> !</span><a name="loc_114_26_114_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_26_114_28&#39;)"><span class="hl_vardecl"><span class="mpre">si</span></span></a><span class="mpre"> !</span><a name="loc_114_30_114_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_30_114_32&#39;)"><span class="hl_vardecl"><span class="mpre">vi</span></span></a><span class="mpre">
                  | </span><a href="#loc_114_30_114_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_30_114_32&#39;)"><span class="hl_varref"><span class="mpre">vi</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="hl_infix"><span class="mpre">`testBit`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = (</span><a href="#loc_114_26_114_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_26_114_28&#39;)"><span class="hl_varref"><span class="mpre">si</span></span></a><span class="mpre">, </span><a href="#loc_114_30_114_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_30_114_32&#39;)"><span class="hl_varref"><span class="mpre">vi</span></span></a><span class="mpre">)
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><a href="#loc_114_15_114_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_15_114_24&#39;)"><span class="hl_varref"><span class="mpre">factorise</span></span></a><span class="mpre"> (</span><a href="#loc_114_26_114_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_26_114_28&#39;)"><span class="hl_varref"><span class="mpre">si</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_114_30_114_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_30_114_32&#39;)"><span class="hl_varref"><span class="mpre">vi</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- probably faster to not shift v continously, but just once.</span></span><span class="mpre">
              </span><a name="loc_117_15_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_15_117_21&#39;)"><span class="hl_vardecl"><span class="mpre">expmod</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.ModArithmetic.html#loc_121_1_121_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_121_1_121_15&#39;)"><span class="hl_varref"><span class="mpre">exponantiation</span></span></a><span class="mpre">

              </span><span class="hl_comment"><span class="mpre">-- when iteration reach zero, we have a probable prime</span></span><span class="mpre">
              </span><a name="loc_120_15_120_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_15_120_19&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> []     = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
              </span><a href="#loc_120_15_120_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_15_120_19&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a name="loc_121_21_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_21_121_22&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_121_23_121_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_23_121_25&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">) = let </span><a name="loc_121_33_121_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_33_121_34&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_117_15_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_15_117_21&#39;)"><span class="hl_varref"><span class="mpre">expmod</span></span></a><span class="mpre"> </span><a href="#loc_121_21_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_21_121_22&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="#loc_105_20_105_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_20_105_21&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_96_37_96_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_37_96_38&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
                             in if </span><a href="#loc_121_33_121_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_33_121_34&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_121_33_121_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_33_121_34&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_102_16_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_16_102_19&#39;)"><span class="hl_varref"><span class="mpre">nm1</span></span></a><span class="mpre">
                                   then </span><a href="#loc_120_15_120_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_15_120_19&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_121_23_121_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_23_121_25&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
                                   else </span><a href="#loc_127_15_127_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_15_127_20&#39;)"><span class="hl_varref"><span class="mpre">loop&#39;</span></span></a><span class="mpre"> </span><a href="#loc_121_23_121_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_23_121_25&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre"> ((</span><a href="#loc_121_33_121_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_33_121_34&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_121_33_121_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_33_121_34&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_96_37_96_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_37_96_38&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">

              </span><span class="hl_comment"><span class="mpre">-- loop from 1 to s-1. if we reach the end then it&#39;s composite</span></span><span class="mpre">
              </span><a name="loc_127_15_127_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_15_127_20&#39;)"><span class="hl_fundecl"><span class="mpre">loop&#39;</span></span></a><span class="mpre"> </span><a name="loc_127_21_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_21_127_23&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre"> !</span><a name="loc_127_25_127_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_25_127_27&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> !</span><a name="loc_127_29_127_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_29_127_30&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">
                  | </span><a href="#loc_127_29_127_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_29_127_30&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_105_17_105_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">    = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
                  | </span><a href="#loc_127_25_127_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_25_127_27&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">   = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
                  | </span><a href="#loc_127_25_127_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_25_127_27&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_102_16_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_16_102_19&#39;)"><span class="hl_varref"><span class="mpre">nm1</span></span></a><span class="mpre"> = </span><a href="#loc_127_15_127_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_15_127_20&#39;)"><span class="hl_varref"><span class="mpre">loop&#39;</span></span></a><span class="mpre"> </span><a href="#loc_127_21_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_21_127_23&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre"> ((</span><a href="#loc_127_25_127_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_25_127_27&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_127_25_127_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_25_127_27&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_96_37_96_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_37_96_38&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) (</span><a href="#loc_127_29_127_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_29_127_30&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_120_15_120_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_15_120_19&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_127_21_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_21_127_23&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">{-
    n &lt; z -&gt; witness to test
              1373653 [2,3]
              9080191 [31,73]
              4759123141 [2,7,61]
              2152302898747 [2,3,5,7,11]
              3474749660383 [2,3,5,7,11,13]
              341550071728321 [2,3,5,7,11,13,17]
-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Probabilitic Test using Fermat primility test.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Beware of Carmichael numbers that are Fermat liars, i.e. this test</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is useless for them. always combines with some other test.</span></span><span class="mpre">
</span><a href="#loc_151_1_151_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_20&#39;)"><span class="mpre">primalityTestFermat</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ number of iterations of the algorithm</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ starting a</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ number to test for primality</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_151_1_151_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_20&#39;)"><span class="hl_fundecl"><span class="mpre">primalityTestFermat</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">n</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">a</span></span><span class="mpre"> </span><a name="loc_151_25_151_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_25_151_26&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">and</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_153_11_153_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_11_153_18&#39;)"><span class="hl_varref"><span class="mpre">expTest</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 151, srcSpanStartColumn = 47, srcSpanEndLine = 151, srcSpanEndColumn = 70}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Prime.hs&quot;, srcSpanStartLine = 151, srcSpanStartColumn = 47, srcSpanEndLine = 151, srcSpanEndColumn = 48},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Num"><span class="mpre">[a..(a+fromIntegral n)]</span></span><span class="mpre">
    where !</span><a name="loc_152_12_152_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_12_152_15&#39;)"><span class="hl_vardecl"><span class="mpre">pm1</span></span></a><span class="mpre"> = </span><a href="#loc_151_25_151_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_25_151_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
          </span><a name="loc_153_11_153_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_11_153_18&#39;)"><span class="hl_fundecl"><span class="mpre">expTest</span></span></a><span class="mpre"> </span><a name="loc_153_19_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_19_153_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.ModArithmetic.html#loc_121_1_121_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_121_1_121_15&#39;)"><span class="hl_varref"><span class="mpre">exponantiation</span></span></a><span class="mpre"> </span><a href="#loc_153_19_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_19_153_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_152_12_152_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_12_152_15&#39;)"><span class="hl_varref"><span class="mpre">pm1</span></span></a><span class="mpre"> </span><a href="#loc_151_25_151_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_25_151_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Test naively is integer is prime.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- while naive, we skip even number and stop iteration at i &gt; sqrt(n)</span></span><span class="mpre">
</span><a href="#loc_158_1_158_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_19&#39;)"><span class="mpre">primalityTestNaive</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_158_1_158_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_19&#39;)"><span class="hl_fundecl"><span class="mpre">primalityTestNaive</span></span></a><span class="mpre"> </span><a name="loc_158_20_158_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_20_158_21&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">
    | </span><a href="#loc_158_20_158_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_20_158_21&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">    = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    | </span><a href="#loc_158_20_158_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_20_158_21&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">    = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">even</span></span><span class="mpre"> </span><a href="#loc_158_20_158_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_20_158_21&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">    = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_164_15_164_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_15_164_21&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">
        where !</span><a name="loc_163_16_163_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_16_163_22&#39;)"><span class="hl_vardecl"><span class="mpre">ubound</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Number.Basic.html#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Basic.html#loc_33_1_33_6&#39;)"><span class="hl_varref"><span class="mpre">sqrti</span></span></a><span class="mpre"> </span><a href="#loc_158_20_158_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_20_158_21&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
              </span><a name="loc_164_15_164_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_15_164_21&#39;)"><span class="hl_fundecl"><span class="mpre">search</span></span></a><span class="mpre"> !</span><a name="loc_164_23_164_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_23_164_24&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
                  | </span><a href="#loc_164_23_164_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_23_164_24&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_163_16_163_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_16_163_22&#39;)"><span class="hl_varref"><span class="mpre">ubound</span></span></a><span class="mpre">    = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                  | </span><a href="#loc_164_23_164_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_23_164_24&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_222_1_222_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_8&#39;)"><span class="hl_infix"><span class="mpre">`divides`</span></span></a><span class="mpre"> </span><a href="#loc_158_20_158_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_20_158_21&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><a href="#loc_164_15_164_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_15_164_21&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> (</span><a href="#loc_164_23_164_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_23_164_24&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Test is two integer are coprime to each other</span></span><span class="mpre">
</span><a href="#loc_171_1_171_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_10&#39;)"><span class="mpre">isCoprime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_171_1_171_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_10&#39;)"><span class="hl_fundecl"><span class="mpre">isCoprime</span></span></a><span class="mpre"> </span><a name="loc_171_11_171_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_11_171_12&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_171_13_171_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_13_171_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = case </span><a href="Crypto.Number.Basic.html#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Basic.html#loc_83_1_83_12&#39;)"><span class="hl_varref"><span class="mpre">gcde_binary</span></span></a><span class="mpre"> </span><a href="#loc_171_11_171_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_11_171_12&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_171_13_171_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_13_171_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> of (_,_,</span><a name="loc_171_46_171_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_46_171_47&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_171_46_171_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_46_171_47&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | list of the first primes till 2903..</span></span><span class="mpre">
</span><a href="#loc_175_1_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_12&#39;)"><span class="mpre">firstPrimes</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">]
</span><a name="loc_175_1_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_12&#39;)"><span class="hl_vardecl"><span class="mpre">firstPrimes</span></span></a><span class="mpre"> =
    [ </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">    , </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">    , </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">    , </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">    , </span><span class="hl_num"><span class="mpre">11</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">17</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">19</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">23</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">29</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">37</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">41</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">43</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">47</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">53</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">59</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">61</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">67</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">71</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">73</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">79</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">83</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">89</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">97</span></span><span class="mpre">   , </span><span class="hl_num"><span class="mpre">101</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">103</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">107</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">109</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">113</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">127</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">131</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">137</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">139</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">149</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">151</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">157</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">163</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">167</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">173</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">179</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">181</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">191</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">193</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">197</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">199</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">211</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">223</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">227</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">229</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">233</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">239</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">241</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">251</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">257</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">263</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">269</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">271</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">277</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">281</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">283</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">293</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">307</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">311</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">313</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">317</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">331</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">337</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">347</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">349</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">353</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">359</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">367</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">373</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">379</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">383</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">389</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">397</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">401</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">409</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">419</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">421</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">431</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">433</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">439</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">443</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">449</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">457</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">461</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">463</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">467</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">479</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">487</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">491</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">499</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">503</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">509</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">521</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">523</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">541</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">547</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">557</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">563</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">569</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">571</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">577</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">587</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">593</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">599</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">601</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">607</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">613</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">617</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">619</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">631</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">641</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">643</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">647</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">653</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">659</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">661</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">673</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">677</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">683</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">691</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">701</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">709</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">719</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">727</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">733</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">739</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">743</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">751</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">757</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">761</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">769</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">773</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">787</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">797</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">809</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">811</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">821</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">823</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">827</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">829</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">839</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">853</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">857</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">859</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">863</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">877</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">881</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">883</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">887</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">907</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">911</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">919</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">929</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">937</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">941</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">947</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">953</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">967</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">971</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">977</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">983</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">991</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">997</span></span><span class="mpre">  , </span><span class="hl_num"><span class="mpre">1009</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1013</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">1019</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1021</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1031</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1033</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1039</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1049</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1051</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1061</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1063</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1069</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">1087</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1091</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1093</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1097</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1103</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1109</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1117</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1123</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1129</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1151</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">1153</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1163</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1171</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1181</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1187</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1193</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1201</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1213</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1217</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1223</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">1229</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1231</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1237</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1249</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1259</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1277</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1279</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1283</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1289</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1291</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">1297</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1301</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1303</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1307</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1319</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1321</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1327</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1361</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1367</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1373</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">1381</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1399</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1409</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1423</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1427</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1429</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1433</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1439</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1447</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1451</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">1453</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1459</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1471</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1481</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1483</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1487</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1489</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1493</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1499</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1511</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">1523</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1531</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1543</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1549</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1553</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1559</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1567</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1571</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1579</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1583</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">1597</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1601</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1607</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1609</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1613</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1619</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1621</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1627</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1637</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1657</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">1663</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1667</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1669</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1693</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1697</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1699</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1709</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1721</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1723</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1733</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">1741</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1747</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1753</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1759</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1777</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1783</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1787</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1789</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1801</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1811</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">1823</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1831</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1847</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1861</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1867</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1871</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1873</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1877</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1879</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1889</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">1901</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1907</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1913</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1931</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1933</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1949</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1951</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1973</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1979</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1987</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">1993</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1997</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">1999</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2003</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2011</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2017</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2027</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2029</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2039</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2053</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">2063</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2069</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2081</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2083</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2087</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2089</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2099</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2111</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2113</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2129</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">2131</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2137</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2141</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2143</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2153</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2161</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2179</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2203</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2207</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2213</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">2221</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2237</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2239</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2243</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2251</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2267</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2269</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2273</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2281</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2287</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">2293</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2297</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2309</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2311</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2333</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2339</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2341</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2347</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2351</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2357</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">2371</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2377</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2381</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2383</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2389</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2393</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2399</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2411</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2417</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2423</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">2437</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2441</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2447</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2459</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2467</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2473</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2477</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2503</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2521</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2531</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">2539</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2543</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2549</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2551</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2557</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2579</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2591</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2593</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2609</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2617</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">2621</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2633</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2647</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2657</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2659</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2663</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2671</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2677</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2683</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2687</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">2689</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2693</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2699</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2707</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2711</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2713</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2719</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2729</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2731</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2741</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">2749</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2753</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2767</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2777</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2789</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2791</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2797</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2801</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2803</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2819</span></span><span class="mpre">
    , </span><span class="hl_num"><span class="mpre">2833</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2837</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2843</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2851</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2857</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2861</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2879</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2887</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2897</span></span><span class="mpre"> , </span><span class="hl_num"><span class="mpre">2903</span></span><span class="mpre">
    ]

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_222_1_222_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_8&#39;)"><span class="mpre">divides</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_222_1_222_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_8&#39;)"><span class="mpre">divides</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_222_1_222_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_8&#39;)"><span class="hl_fundecl"><span class="mpre">divides</span></span></a><span class="mpre"> </span><a name="loc_222_9_222_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_9_222_10&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_222_11_222_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_11_222_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_222_11_222_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_11_222_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_222_9_222_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_9_222_10&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
</span></div></body></html>