<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.TLS.X509</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- X509 helpers</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.TLS.X509
    ( CertificateChain(..)
    , Certificate(..)
    , SignedCertificate
    , getCertificate
    , isNullCertificateChain
    , getCertificateChainLeaf
    , CertificateRejectReason(..)
    , CertificateUsage(..)
    , CertificateStore
    , ValidationCache
    , exceptionValidationCache
    , validateDefault
    , FailedReason
    , ServiceID
    , wrapCertificateChecks
    ) where

import Data.X509
import Data.X509.Validation
import Data.X509.CertificateStore

</span><a href="#loc_33_1_33_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_23&#39;)"><span class="mpre">isNullCertificateChain</span></a><span class="mpre"> :: </span><a href="Data.X509.CertificateChain.html#loc_21_9_21_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_9_21_25&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_33_1_33_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_23&#39;)"><span class="hl_fundecl"><span class="mpre">isNullCertificateChain</span></span></a><span class="mpre"> (</span><a href="Data.X509.CertificateChain.html#loc_21_28_21_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_28_21_44&#39;)"><span class="hl_conref"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> </span><a name="loc_33_42_33_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_42_33_43&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_33_42_33_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_42_33_43&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><a href="#loc_36_1_36_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_24&#39;)"><span class="mpre">getCertificateChainLeaf</span></a><span class="mpre"> :: </span><a href="Data.X509.CertificateChain.html#loc_21_9_21_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_9_21_25&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> -&gt; </span><a href="Data.X509.Signed.html#loc_65_38_65_49" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_65_38_65_49&#39;)"><span class="hl_tyconref"><span class="mpre">SignedExact</span></span></a><span class="mpre"> </span><a href="Data.X509.Cert.html#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Cert.html#loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre">
</span><a name="loc_36_1_36_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_24&#39;)"><span class="hl_fundecl"><span class="mpre">getCertificateChainLeaf</span></span></a><span class="mpre"> (</span><a href="Data.X509.CertificateChain.html#loc_21_28_21_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_28_21_44&#39;)"><span class="hl_conref"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> [])    = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;empty certificate chain&quot;</span></span><span class="mpre">
</span><a href="#loc_36_1_36_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_24&#39;)"><span class="hl_fundecl"><span class="mpre">getCertificateChainLeaf</span></span></a><span class="mpre"> (</span><a href="Data.X509.CertificateChain.html#loc_21_28_21_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_28_21_44&#39;)"><span class="hl_conref"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> (</span><a name="loc_37_44_37_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_44_37_45&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)) = </span><a href="#loc_37_44_37_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_44_37_45&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Certificate and Chain rejection reason</span></span><span class="mpre">
data </span><a name="loc_40_6_40_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_29&#39;)"><span class="hl_tycondecl"><span class="mpre">CertificateRejectReason</span></span></a><span class="mpre"> =
          </span><a name="loc_41_11_41_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_11_41_35&#39;)"><span class="hl_condecl"><span class="mpre">CertificateRejectExpired</span></span></a><span class="mpre">
        | </span><a name="loc_42_11_42_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_11_42_35&#39;)"><span class="hl_condecl"><span class="mpre">CertificateRejectRevoked</span></span></a><span class="mpre">
        | </span><a name="loc_43_11_43_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_37&#39;)"><span class="hl_condecl"><span class="mpre">CertificateRejectUnknownCA</span></span></a><span class="mpre">
        | </span><a name="loc_44_11_44_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_11_44_33&#39;)"><span class="hl_condecl"><span class="mpre">CertificateRejectOther</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/X509.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 9, srcSpanEndLine = 45, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/X509.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 9, srcSpanEndLine = 45, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/X509.hs&quot;, srcSpanStartLine = 45, srcSpanStart"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Certificate Usage callback possible returns values.</span></span><span class="mpre">
data </span><a name="loc_48_6_48_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_6_48_22&#39;)"><span class="hl_tycondecl"><span class="mpre">CertificateUsage</span></span></a><span class="mpre"> =
          </span><a name="loc_49_11_49_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_11_49_33&#39;)"><span class="hl_condecl"><span class="mpre">CertificateUsageAccept</span></span></a><span class="mpre">                         </span><span class="hl_comment"><span class="mpre">-- ^ usage of certificate accepted</span></span><span class="mpre">
        | </span><a name="loc_50_11_50_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_11_50_33&#39;)"><span class="hl_condecl"><span class="mpre">CertificateUsageReject</span></span></a><span class="mpre"> </span><a href="#loc_40_6_40_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_29&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateRejectReason</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ usage of certificate rejected</span></span><span class="mpre">
        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/X509.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 9, srcSpanEndLine = 51, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/X509.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 9, srcSpanEndLine = 51, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/X509.hs&quot;, srcSpanStartLine = 51, srcSpanStart"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><a href="#loc_54_1_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_22&#39;)"><span class="mpre">wrapCertificateChecks</span></a><span class="mpre"> :: [</span><a href="Data.X509.Validation.html#loc_47_6_47_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.html#loc_47_6_47_18&#39;)"><span class="hl_tyconref"><span class="mpre">FailedReason</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_48_6_48_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_6_48_22&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateUsage</span></span></a><span class="mpre">
</span><a name="loc_54_1_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_22&#39;)"><span class="hl_fundecl"><span class="mpre">wrapCertificateChecks</span></span></a><span class="mpre"> [] = </span><a href="#loc_49_11_49_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_11_49_33&#39;)"><span class="hl_conref"><span class="mpre">CertificateUsageAccept</span></span></a><span class="mpre">
</span><a href="#loc_54_1_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_22&#39;)"><span class="hl_fundecl"><span class="mpre">wrapCertificateChecks</span></span></a><span class="mpre"> </span><a name="loc_55_23_55_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_23_55_24&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">
    | </span><a href="Data.X509.Validation.html#loc_49_7_49_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.html#loc_49_7_49_14&#39;)"><span class="hl_conref"><span class="mpre">Expired</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_55_23_55_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_23_55_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">   = </span><a href="#loc_50_11_50_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_11_50_33&#39;)"><span class="hl_conref"><span class="mpre">CertificateUsageReject</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_41_11_41_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_11_41_35&#39;)"><span class="hl_conref"><span class="mpre">CertificateRejectExpired</span></span></a><span class="mpre">
    | </span><a href="Data.X509.Validation.html#loc_50_7_50_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.html#loc_50_7_50_15&#39;)"><span class="hl_conref"><span class="mpre">InFuture</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_55_23_55_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_23_55_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">  = </span><a href="#loc_50_11_50_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_11_50_33&#39;)"><span class="hl_conref"><span class="mpre">CertificateUsageReject</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_41_11_41_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_11_41_35&#39;)"><span class="hl_conref"><span class="mpre">CertificateRejectExpired</span></span></a><span class="mpre">
    | </span><a href="Data.X509.Validation.html#loc_52_7_52_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.html#loc_52_7_52_16&#39;)"><span class="hl_conref"><span class="mpre">UnknownCA</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_55_23_55_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_23_55_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_50_11_50_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_11_50_33&#39;)"><span class="hl_conref"><span class="mpre">CertificateUsageReject</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_43_11_43_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_37&#39;)"><span class="hl_conref"><span class="mpre">CertificateRejectUnknownCA</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">          = </span><a href="#loc_50_11_50_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_11_50_33&#39;)"><span class="hl_conref"><span class="mpre">CertificateUsageReject</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_44_11_44_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_11_44_33&#39;)"><span class="hl_conref"><span class="mpre">CertificateRejectOther</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_55_23_55_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_23_55_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
</span></div></body></html>