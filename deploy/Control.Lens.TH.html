<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
{-# LANGUAGE PatternGuards #-}
{-# LANGUAGE TemplateHaskell #-}
{-# LANGUAGE FunctionalDependencies #-}
#ifdef TRUSTWORTHY
{-# LANGUAGE Trustworthy #-}
#endif

#ifndef MIN_VERSION_template_haskell
#define MIN_VERSION_template_haskell(x,y,z) (defined(__GLASGOW_HASKELL__) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 706)
#endif
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Control.Lens.TH</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (C) 2012-14 Edward Kmett, Michael Sloan</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Edward Kmett &lt;ekmett@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
module Control.Lens.TH
  (
  </span><span class="hl_comment"><span class="mpre">-- * Constructing Lenses Automatically</span></span><span class="mpre">
    makeLenses, makeLensesFor
  , makeClassy, makeClassyFor, makeClassy_
  , makePrisms
  , makeWrapped
  , makeFields
  </span><span class="hl_comment"><span class="mpre">-- * Constructing Lenses Given a Declaration Quote</span></span><span class="mpre">
  , declareLenses, declareLensesFor
  , declareClassy, declareClassyFor
  , declarePrisms
  , declareWrapped
  , declareFields
  </span><span class="hl_comment"><span class="mpre">-- * Configuring Lenses</span></span><span class="mpre">
  , makeLensesWith
  , makeFieldsWith
  , declareLensesWith
  , declareFieldsWith
  , defaultRules
  , defaultFieldRules
  , camelCaseFields
  , underscoreFields
  , LensRules(LensRules)
  , FieldRules(FieldRules)
  , lensRules
  , classyRules
  , classyRules_
  , lensIso
  , lensField
  , lensClass
  , lensFlags
  , LensFlag(..)
  , simpleLenses
  , partialLenses
  , buildTraversals
  , handleSingletons
  , singletonIso
  , singletonRequired
  , createClass
  , createInstance
  , classRequired
  , singletonAndField
  , generateSignatures
  ) where

import Control.Applicative
import Control.Monad (</span><a href="Control.Monad.html#loc_184_1_184_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_184_1_184_6&#39;)"><span class="mpre">(&lt;=&lt;)</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="mpre">replicateM</span></a><span class="mpre">)
#if !(MIN_VERSION_template_haskell(2,7,0))
import Control.Monad (</span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="mpre">ap</span></a><span class="mpre">)
#endif
import qualified Control.Monad.Trans as Trans
import Control.Monad.Trans.Writer
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 8, srcSpanEndLine = 75, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Control.Lens.At&quot;"><span class="mpre">Control.Lens.At</span></span><span class="mpre">
import Control.Lens.Fold
import Control.Lens.Getter
import Control.Lens.Iso
import Control.Lens.Lens
import Control.Lens.Prism
import Control.Lens.Review
import Control.Lens.Setter
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 8, srcSpanEndLine = 83, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;Control.Lens.Tuple&quot;"><span class="mpre">Control.Lens.Tuple</span></span><span class="mpre">
import Control.Lens.Traversal
import Control.Lens.Wrapped
import Control.Lens.Internal.TH
import Data.Char (</span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="mpre">toLower</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_144_1_144_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_144_1_144_8&#39;)"><span class="mpre">toUpper</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_140_1_140_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_140_1_140_8&#39;)"><span class="mpre">isUpper</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 8, srcSpanEndLine = 88, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;Data.Either&quot;"><span class="mpre">Data.Either</span></span><span class="mpre"> (lefts)
import Data.Foldable hiding (</span><a href="Data.Foldable.html#loc_268_1_268_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Foldable.html#loc_268_1_268_7&#39;)"><span class="mpre">concat</span></a><span class="mpre">, </span><a href="Data.Foldable.html#loc_289_1_289_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Foldable.html#loc_289_1_289_4&#39;)"><span class="mpre">any</span></a><span class="mpre">)
import Data.Function (</span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="mpre">on</span></a><span class="mpre">)
import Data.List as List
import Data.Map as Map hiding (toList,map,filter)
import Data.Maybe as Maybe (</span><a href="Data.Maybe.html#loc_85_1_85_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_85_1_85_10&#39;)"><span class="mpre">isNothing</span></a><span class="mpre">,</span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="mpre">isJust</span></a><span class="mpre">,</span><a href="Data.Maybe.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_115_1_115_10&#39;)"><span class="mpre">catMaybes</span></a><span class="mpre">,</span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="mpre">fromJust</span></a><span class="mpre">,</span><a href="Data.Maybe.html#loc_123_1_123_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_123_1_123_9&#39;)"><span class="mpre">mapMaybe</span></a><span class="mpre">)
import Data.Monoid
import Data.Ord (</span><a href="Data.Ord.html#loc_37_1_37_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Ord.html#loc_37_1_37_10&#39;)"><span class="mpre">comparing</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 8, srcSpanEndLine = 96, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;Data.Set&quot;"><span class="mpre">Data.Set</span></span><span class="mpre"> as Set hiding (toList,map,filter)
import Data.Set.Lens
import Data.Traversable hiding (</span><a href="Data.Traversable.html#loc_160_5_160_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_160_5_160_9&#39;)"><span class="mpre">mapM</span></a><span class="mpre">)
import Language.Haskell.TH
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 100, srcSpanStartColumn = 8, srcSpanEndLine = 100, srcSpanEndColumn = 34}, srcInfoPoints = []}) &quot;Language.Haskell.TH.Syntax&quot;"><span class="mpre">Language.Haskell.TH.Syntax</span></span><span class="mpre">
import Language.Haskell.TH.Lens

#ifdef HLINT
</span><span class="warning" data-warning="DeclAnnPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 104, srcSpanStartColumn = 1, srcSpanEndLine = 104, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 104, srcSpanStartColumn = 1, srcSpanEndLine = 104, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 104, s"><span class="mpre">{-# ANN module &quot;HLint: ignore Eta reduce&quot; #-}</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclAnnPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 1, srcSpanEndLine = 105, srcSpanEndColumn = 53}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 1, srcSpanEndLine = 105, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 105, s"><span class="mpre">{-# ANN module &quot;HLint: ignore Use fewer imports&quot; #-}</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclAnnPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 1, srcSpanEndLine = 106, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 1, srcSpanEndLine = 106, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 106, s"><span class="mpre">{-# ANN module &quot;HLint: ignore Use foldl&quot; #-}</span></span><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- | Flags for &#39;Lens&#39; construction</span></span><span class="mpre">
data </span><a name="loc_110_6_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_6_110_14&#39;)"><span class="hl_tycondecl"><span class="mpre">LensFlag</span></span></a><span class="mpre">
  = </span><a name="loc_111_5_111_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_5_111_17&#39;)"><span class="hl_condecl"><span class="mpre">SimpleLenses</span></span></a><span class="mpre">
  | </span><a name="loc_112_5_112_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_5_112_18&#39;)"><span class="hl_condecl"><span class="mpre">PartialLenses</span></span></a><span class="mpre">
  | </span><a name="loc_113_5_113_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_20&#39;)"><span class="hl_condecl"><span class="mpre">BuildTraversals</span></span></a><span class="mpre">
  | </span><a name="loc_114_5_114_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_22&#39;)"><span class="hl_condecl"><span class="mpre">SingletonAndField</span></span></a><span class="mpre">
  | </span><a name="loc_115_5_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_5_115_17&#39;)"><span class="hl_condecl"><span class="mpre">SingletonIso</span></span></a><span class="mpre">
  | </span><a name="loc_116_5_116_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_5_116_21&#39;)"><span class="hl_condecl"><span class="mpre">HandleSingletons</span></span></a><span class="mpre">
  | </span><a name="loc_117_5_117_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_22&#39;)"><span class="hl_condecl"><span class="mpre">SingletonRequired</span></span></a><span class="mpre">
  | </span><a name="loc_118_5_118_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_5_118_16&#39;)"><span class="hl_condecl"><span class="mpre">CreateClass</span></span></a><span class="mpre">
  | </span><a name="loc_119_5_119_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_19&#39;)"><span class="hl_condecl"><span class="mpre">CreateInstance</span></span></a><span class="mpre">
  | </span><a name="loc_120_5_120_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_5_120_18&#39;)"><span class="hl_condecl"><span class="mpre">ClassRequired</span></span></a><span class="mpre">
  | </span><a name="loc_121_5_121_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_23&#39;)"><span class="hl_condecl"><span class="mpre">GenerateSignatures</span></span></a><span class="mpre">
  </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 3, srcSpanEndLine = 122, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 3, srcSpanEndLine = 122, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 122, s"><span class="mpre">deriving (Eq,Ord,Show,Read)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Only Generate valid &#39;Control.Lens.Type.Simple&#39; lenses.</span></span><span class="mpre">
</span><a href="#loc_126_1_126_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_13&#39;)"><span class="mpre">simpleLenses</span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_126_1_126_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_13&#39;)"><span class="hl_vardecl"><span class="mpre">simpleLenses</span></span></a><span class="mpre">       = </span><a href="#loc_209_1_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_10&#39;)"><span class="hl_varref"><span class="mpre">lensFlags</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre"> </span><a href="#loc_111_5_111_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_5_111_17&#39;)"><span class="hl_conref"><span class="mpre">SimpleLenses</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Enables the generation of partial lenses, generating runtime errors for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- every constructor that does not have a valid definition for the &#39;Lens&#39;. This</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- occurs when the constructor lacks the field, or has multiple fields mapped</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to the same &#39;Lens&#39;.</span></span><span class="mpre">
</span><a href="#loc_133_1_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_14&#39;)"><span class="mpre">partialLenses</span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_133_1_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_14&#39;)"><span class="hl_vardecl"><span class="mpre">partialLenses</span></span></a><span class="mpre">      = </span><a href="#loc_209_1_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_10&#39;)"><span class="hl_varref"><span class="mpre">lensFlags</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre"> </span><a href="#loc_112_5_112_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_5_112_18&#39;)"><span class="hl_conref"><span class="mpre">PartialLenses</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | In the situations that a &#39;Lens&#39; would be partial, when &#39;partialLenses&#39; is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- used, this flag instead causes traversals to be generated. Only one can be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- used, and if neither are, then compile-time errors are generated.</span></span><span class="mpre">
</span><a href="#loc_139_1_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_16&#39;)"><span class="mpre">buildTraversals</span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_139_1_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_16&#39;)"><span class="hl_vardecl"><span class="mpre">buildTraversals</span></span></a><span class="mpre">    = </span><a href="#loc_209_1_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_10&#39;)"><span class="hl_varref"><span class="mpre">lensFlags</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre"> </span><a href="#loc_113_5_113_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_20&#39;)"><span class="hl_conref"><span class="mpre">BuildTraversals</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Handle singleton constructors specially.</span></span><span class="mpre">
</span><a href="#loc_143_1_143_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_17&#39;)"><span class="mpre">handleSingletons</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_143_1_143_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_17&#39;)"><span class="hl_vardecl"><span class="mpre">handleSingletons</span></span></a><span class="mpre">   = </span><a href="#loc_209_1_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_10&#39;)"><span class="hl_varref"><span class="mpre">lensFlags</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre"> </span><a href="#loc_116_5_116_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_5_116_21&#39;)"><span class="hl_conref"><span class="mpre">HandleSingletons</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | When building a singleton &#39;Iso&#39; (or &#39;Lens&#39;) for a record constructor, build</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- both the &#39;Iso&#39; (or &#39;Lens&#39;) for the record and the one for the field.</span></span><span class="mpre">
</span><a href="#loc_148_1_148_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_18&#39;)"><span class="mpre">singletonAndField</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_148_1_148_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_18&#39;)"><span class="hl_vardecl"><span class="mpre">singletonAndField</span></span></a><span class="mpre">  = </span><a href="#loc_209_1_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_10&#39;)"><span class="hl_varref"><span class="mpre">lensFlags</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre"> </span><a href="#loc_114_5_114_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_22&#39;)"><span class="hl_conref"><span class="mpre">SingletonAndField</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Use &#39;Iso&#39; for singleton constructors.</span></span><span class="mpre">
</span><a href="#loc_152_1_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_13&#39;)"><span class="mpre">singletonIso</span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_152_1_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_13&#39;)"><span class="hl_vardecl"><span class="mpre">singletonIso</span></span></a><span class="mpre">       = </span><a href="#loc_209_1_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_10&#39;)"><span class="hl_varref"><span class="mpre">lensFlags</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre"> </span><a href="#loc_115_5_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_5_115_17&#39;)"><span class="hl_conref"><span class="mpre">SingletonIso</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Expect a single constructor, single field newtype or data type.</span></span><span class="mpre">
</span><a href="#loc_156_1_156_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_18&#39;)"><span class="mpre">singletonRequired</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_156_1_156_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_18&#39;)"><span class="hl_vardecl"><span class="mpre">singletonRequired</span></span></a><span class="mpre">  = </span><a href="#loc_209_1_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_10&#39;)"><span class="hl_varref"><span class="mpre">lensFlags</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre"> </span><a href="#loc_117_5_117_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_22&#39;)"><span class="hl_conref"><span class="mpre">SingletonRequired</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create the class if the constructor is &#39;Control.Lens.Type.Simple&#39; and the &#39;lensClass&#39; rule matches.</span></span><span class="mpre">
</span><a href="#loc_160_1_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_12&#39;)"><span class="mpre">createClass</span></a><span class="mpre">       :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_160_1_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_12&#39;)"><span class="hl_vardecl"><span class="mpre">createClass</span></span></a><span class="mpre">        = </span><a href="#loc_209_1_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_10&#39;)"><span class="hl_varref"><span class="mpre">lensFlags</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre"> </span><a href="#loc_118_5_118_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_5_118_16&#39;)"><span class="hl_conref"><span class="mpre">CreateClass</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create the instance if the constructor is &#39;Control.Lens.Type.Simple&#39; and the &#39;lensClass&#39; rule matches.</span></span><span class="mpre">
</span><a href="#loc_164_1_164_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_15&#39;)"><span class="mpre">createInstance</span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_164_1_164_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_15&#39;)"><span class="hl_vardecl"><span class="mpre">createInstance</span></span></a><span class="mpre">     = </span><a href="#loc_209_1_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_10&#39;)"><span class="hl_varref"><span class="mpre">lensFlags</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre"> </span><a href="#loc_119_5_119_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_19&#39;)"><span class="hl_conref"><span class="mpre">CreateInstance</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Die if the &#39;lensClass&#39; fails to match.</span></span><span class="mpre">
</span><a href="#loc_168_1_168_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_14&#39;)"><span class="mpre">classRequired</span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_168_1_168_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_14&#39;)"><span class="hl_vardecl"><span class="mpre">classRequired</span></span></a><span class="mpre">      = </span><a href="#loc_209_1_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_10&#39;)"><span class="hl_varref"><span class="mpre">lensFlags</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre"> </span><a href="#loc_120_5_120_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_5_120_18&#39;)"><span class="hl_conref"><span class="mpre">ClassRequired</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Indicate whether or not to supply the signatures for the generated</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- lenses.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Disabling this can be useful if you want to provide a more restricted type</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- signature or if you want to supply hand-written haddocks.</span></span><span class="mpre">
</span><a href="#loc_176_1_176_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_19&#39;)"><span class="mpre">generateSignatures</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_176_1_176_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_19&#39;)"><span class="hl_vardecl"><span class="mpre">generateSignatures</span></span></a><span class="mpre"> = </span><a href="#loc_209_1_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_10&#39;)"><span class="hl_varref"><span class="mpre">lensFlags</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre"> </span><a href="#loc_121_5_121_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_23&#39;)"><span class="hl_conref"><span class="mpre">GenerateSignatures</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This configuration describes the options we&#39;ll be using to make</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- isomorphisms or lenses.</span></span><span class="mpre">
data </span><a name="loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tycondecl"><span class="mpre">LensRules</span></span></a><span class="mpre"> = </span><a name="loc_180_18_180_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_27&#39;)"><span class="hl_condecl"><span class="mpre">LensRules</span></span></a><span class="mpre">
  { </span><span class="hl_fielddecl"><span class="mpre">_lensIso</span></span><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
  , </span><span class="hl_fielddecl"><span class="mpre">_lensField</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
  , </span><span class="hl_fielddecl"><span class="mpre">_lensClass</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
  , </span><span class="hl_fielddecl"><span class="mpre">_lensFlags</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Set</span></span><span class="mpre"> </span><a href="#loc_110_6_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_6_110_14&#39;)"><span class="hl_tyconref"><span class="mpre">LensFlag</span></span></a><span class="mpre">
  }

</span><span class="hl_comment"><span class="mpre">-- | &#39;Lens&#39;&#39; to access the convention for naming top level isomorphisms in our</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;LensRules&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Defaults to lowercasing the first letter of the constructor.</span></span><span class="mpre">
</span><a href="#loc_192_1_192_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_8&#39;)"><span class="mpre">lensIso</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_192_1_192_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_8&#39;)"><span class="hl_fundecl"><span class="mpre">lensIso</span></span></a><span class="mpre"> </span><a name="loc_192_9_192_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_9_192_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_180_18_180_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_27&#39;)"><span class="hl_conref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><a name="loc_192_22_192_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_22_192_23&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_192_24_192_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_24_192_25&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_192_26_192_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_26_192_27&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_192_28_192_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_28_192_29&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre">) = </span><a href="#loc_192_9_192_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_9_192_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_192_22_192_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_22_192_23&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="Control.Lens.Lens.html#loc_343_4_343_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_343_4_343_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;&amp;&gt;</span></span></a><span class="mpre"> \</span><a name="loc_192_42_192_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_42_192_44&#39;)"><span class="hl_vardecl"><span class="mpre">i&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_180_18_180_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_27&#39;)"><span class="hl_conref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><a href="#loc_192_42_192_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_42_192_44&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="mpre"> </span><a href="#loc_192_24_192_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_24_192_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_192_26_192_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_26_192_27&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_192_28_192_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_28_192_29&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | &#39;Lens&#39;&#39; to access the convention for naming fields in our &#39;LensRules&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Defaults to stripping the _ off of the field name, lowercasing the name, and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- rejecting the field if it doesn&#39;t start with an &#39;_&#39;.</span></span><span class="mpre">
</span><a href="#loc_199_1_199_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_10&#39;)"><span class="mpre">lensField</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_199_1_199_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_10&#39;)"><span class="hl_fundecl"><span class="mpre">lensField</span></span></a><span class="mpre"> </span><a name="loc_199_11_199_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_11_199_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_180_18_180_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_27&#39;)"><span class="hl_conref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><a name="loc_199_24_199_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_24_199_25&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_199_26_199_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_26_199_27&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_199_28_199_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_28_199_29&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_199_30_199_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_30_199_31&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre">) = </span><a href="#loc_199_11_199_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_11_199_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_199_26_199_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_26_199_27&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="Control.Lens.Lens.html#loc_343_4_343_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_343_4_343_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;&amp;&gt;</span></span></a><span class="mpre"> \</span><a name="loc_199_44_199_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_44_199_46&#39;)"><span class="hl_vardecl"><span class="mpre">n&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_180_18_180_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_27&#39;)"><span class="hl_conref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><a href="#loc_199_24_199_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_24_199_25&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_199_44_199_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_44_199_46&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> </span><a href="#loc_199_28_199_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_28_199_29&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_199_30_199_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_30_199_31&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Retrieve options such as the name of the class and method to put in it to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- build a class around monomorphic data types.</span></span><span class="mpre">
</span><a href="#loc_204_1_204_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_10&#39;)"><span class="mpre">lensClass</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">))
</span><a name="loc_204_1_204_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_10&#39;)"><span class="hl_fundecl"><span class="mpre">lensClass</span></span></a><span class="mpre"> </span><a name="loc_204_11_204_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_11_204_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_180_18_180_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_27&#39;)"><span class="hl_conref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><a name="loc_204_24_204_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_24_204_25&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_204_26_204_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_26_204_27&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_204_28_204_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_28_204_29&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_204_30_204_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_30_204_31&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre">) = </span><a href="#loc_204_11_204_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_11_204_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_204_28_204_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_28_204_29&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="Control.Lens.Lens.html#loc_343_4_343_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_343_4_343_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;&amp;&gt;</span></span></a><span class="mpre"> \</span><a name="loc_204_44_204_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_44_204_46&#39;)"><span class="hl_vardecl"><span class="mpre">c&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_180_18_180_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_27&#39;)"><span class="hl_conref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><a href="#loc_204_24_204_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_24_204_25&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_204_26_204_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_26_204_27&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_204_44_204_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_44_204_46&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre"> </span><a href="#loc_204_30_204_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_30_204_31&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Retrieve options such as the name of the class and method to put in it to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- build a class around monomorphic data types.</span></span><span class="mpre">
</span><a href="#loc_209_1_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_10&#39;)"><span class="mpre">lensFlags</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Lens&#39;</span></span><span class="mpre"> </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Set</span></span><span class="mpre"> </span><a href="#loc_110_6_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_6_110_14&#39;)"><span class="hl_tyconref"><span class="mpre">LensFlag</span></span></a><span class="mpre">)
</span><a name="loc_209_1_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_1_209_10&#39;)"><span class="hl_fundecl"><span class="mpre">lensFlags</span></span></a><span class="mpre"> </span><a name="loc_209_11_209_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_11_209_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_180_18_180_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_27&#39;)"><span class="hl_conref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><a name="loc_209_24_209_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_24_209_25&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_209_26_209_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_26_209_27&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_209_28_209_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_28_209_29&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_209_30_209_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_30_209_31&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre">) = </span><a href="#loc_209_11_209_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_11_209_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_209_30_209_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_30_209_31&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="Control.Lens.Lens.html#loc_343_4_343_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_343_4_343_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;&amp;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_180_18_180_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_27&#39;)"><span class="hl_conref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><a href="#loc_209_24_209_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_24_209_25&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_209_26_209_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_26_209_27&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_209_28_209_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_28_209_29&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Default &#39;LensRules&#39;.</span></span><span class="mpre">
</span><a href="#loc_213_1_213_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_13&#39;)"><span class="mpre">defaultRules</span></a><span class="mpre"> :: </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre">
</span><a name="loc_213_1_213_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_13&#39;)"><span class="hl_vardecl"><span class="mpre">defaultRules</span></span></a><span class="mpre"> = </span><a href="#loc_180_18_180_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_27&#39;)"><span class="hl_conref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><a href="#loc_220_1_220_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_11&#39;)"><span class="hl_varref"><span class="mpre">mLowerName</span></span></a><span class="mpre"> </span><a href="#loc_216_5_216_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_5_216_8&#39;)"><span class="hl_varref"><span class="mpre">fld</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">Set.fromList</span></span><span class="mpre"> [</span><a href="#loc_115_5_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_5_115_17&#39;)"><span class="hl_conref"><span class="mpre">SingletonIso</span></span></a><span class="mpre">, </span><a href="#loc_114_5_114_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_22&#39;)"><span class="hl_conref"><span class="mpre">SingletonAndField</span></span></a><span class="mpre">, </span><a href="#loc_118_5_118_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_5_118_16&#39;)"><span class="hl_conref"><span class="mpre">CreateClass</span></span></a><span class="mpre">, </span><a href="#loc_119_5_119_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_19&#39;)"><span class="hl_conref"><span class="mpre">CreateInstance</span></span></a><span class="mpre">, </span><a href="#loc_113_5_113_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_20&#39;)"><span class="hl_conref"><span class="mpre">BuildTraversals</span></span></a><span class="mpre">, </span><a href="#loc_121_5_121_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_23&#39;)"><span class="hl_conref"><span class="mpre">GenerateSignatures</span></span></a><span class="mpre">]
  where
    </span><a name="loc_216_5_216_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_5_216_8&#39;)"><span class="hl_fundecl"><span class="mpre">fld</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_216_14_216_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_14_216_16&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) = </span><a href="#loc_220_1_220_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_11&#39;)"><span class="hl_varref"><span class="mpre">mLowerName</span></span></a><span class="mpre"> </span><a href="#loc_216_14_216_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_14_216_16&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
    </span><a href="#loc_216_5_216_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_5_216_8&#39;)"><span class="hl_fundecl"><span class="mpre">fld</span></span></a><span class="mpre"> _        = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><a href="#loc_220_1_220_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_11&#39;)"><span class="mpre">mLowerName</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_220_1_220_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_11&#39;)"><span class="hl_fundecl"><span class="mpre">mLowerName</span></span></a><span class="mpre"> (</span><a name="loc_220_13_220_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_13_220_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_220_15_220_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_15_220_17&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><a href="#loc_220_13_220_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_13_220_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_220_15_220_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_15_220_17&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
</span><a href="#loc_220_1_220_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_11&#39;)"><span class="hl_fundecl"><span class="mpre">mLowerName</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Rules for making fairly simple partial lenses, ignoring the special cases</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for isomorphisms and traversals, and not making any classes.</span></span><span class="mpre">
</span><a href="#loc_226_1_226_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_10&#39;)"><span class="mpre">lensRules</span></a><span class="mpre"> :: </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre">
</span><a name="loc_226_1_226_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_10&#39;)"><span class="hl_vardecl"><span class="mpre">lensRules</span></span></a><span class="mpre"> = </span><a href="#loc_213_1_213_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_13&#39;)"><span class="hl_varref"><span class="mpre">defaultRules</span></span></a><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_8&#39;)"><span class="hl_varref"><span class="mpre">lensIso</span></span></a><span class="mpre">          </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_204_1_204_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_10&#39;)"><span class="hl_varref"><span class="mpre">lensClass</span></span></a><span class="mpre">        </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_143_1_143_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_17&#39;)"><span class="hl_varref"><span class="mpre">handleSingletons</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_133_1_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_14&#39;)"><span class="hl_varref"><span class="mpre">partialLenses</span></span></a><span class="mpre">    </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_139_1_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_16&#39;)"><span class="hl_varref"><span class="mpre">buildTraversals</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

</span><a href="#loc_234_1_234_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_1_234_13&#39;)"><span class="mpre">lensRulesFor</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre">
</span><a name="loc_234_1_234_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_1_234_13&#39;)"><span class="hl_fundecl"><span class="mpre">lensRulesFor</span></span></a><span class="mpre"> </span><a name="loc_234_14_234_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_14_234_20&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> = </span><a href="#loc_226_1_226_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_10&#39;)"><span class="hl_varref"><span class="mpre">lensRules</span></span></a><span class="mpre"> </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_199_1_199_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_10&#39;)"><span class="hl_varref"><span class="mpre">lensField</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`Prelude.lookup`</span></span><span class="mpre"> </span><a href="#loc_234_14_234_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_14_234_20&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Rules for making lenses and traversals that precompose another &#39;Lens&#39;.</span></span><span class="mpre">
</span><a href="#loc_238_1_238_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_1_238_12&#39;)"><span class="mpre">classyRules</span></a><span class="mpre"> :: </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre">
</span><a name="loc_238_1_238_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_1_238_12&#39;)"><span class="hl_vardecl"><span class="mpre">classyRules</span></span></a><span class="mpre"> = </span><a href="#loc_213_1_213_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_13&#39;)"><span class="hl_varref"><span class="mpre">defaultRules</span></span></a><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_8&#39;)"><span class="hl_varref"><span class="mpre">lensIso</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_143_1_143_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_17&#39;)"><span class="hl_varref"><span class="mpre">handleSingletons</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_204_1_204_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_10&#39;)"><span class="hl_varref"><span class="mpre">lensClass</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><a href="#loc_247_5_247_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_5_247_11&#39;)"><span class="hl_varref"><span class="mpre">classy</span></span></a><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_168_1_168_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_14&#39;)"><span class="hl_varref"><span class="mpre">classRequired</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_133_1_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_14&#39;)"><span class="hl_varref"><span class="mpre">partialLenses</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_139_1_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_16&#39;)"><span class="hl_varref"><span class="mpre">buildTraversals</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
  where
    </span><a href="#loc_247_5_247_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_5_247_11&#39;)"><span class="mpre">classy</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
    </span><a name="loc_247_5_247_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_5_247_11&#39;)"><span class="hl_fundecl"><span class="mpre">classy</span></span></a><span class="mpre"> </span><a name="loc_247_12_247_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_12_247_13&#39;)"><span class="hl_specname"><span class="mpre">n</span></span></a><span class="mpre">@(</span><a name="loc_247_15_247_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_15_247_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_247_17_247_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_17_247_19&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Has&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_247_12_247_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_12_247_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><a href="#loc_247_15_247_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_15_247_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_247_17_247_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_17_247_19&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre">)
    </span><a href="#loc_247_5_247_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_5_247_11&#39;)"><span class="hl_fundecl"><span class="mpre">classy</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><a href="#loc_252_1_252_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_1_252_15&#39;)"><span class="mpre">classyRulesFor</span></a><span class="mpre">
  :: (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)) -&gt; [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre">
</span><a name="loc_252_1_252_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_1_252_15&#39;)"><span class="hl_fundecl"><span class="mpre">classyRulesFor</span></span></a><span class="mpre"> </span><a name="loc_252_16_252_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_16_252_24&#39;)"><span class="hl_vardecl"><span class="mpre">classFun</span></span></a><span class="mpre"> </span><a name="loc_252_25_252_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_25_252_31&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> = </span><a href="#loc_238_1_238_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_1_238_12&#39;)"><span class="hl_varref"><span class="mpre">classyRules</span></span></a><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_204_1_204_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_10&#39;)"><span class="hl_varref"><span class="mpre">lensClass</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><a href="#loc_252_16_252_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_16_252_24&#39;)"><span class="hl_varref"><span class="mpre">classFun</span></span></a><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_199_1_199_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_10&#39;)"><span class="hl_varref"><span class="mpre">lensField</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`Prelude.lookup`</span></span><span class="mpre"> </span><a href="#loc_252_25_252_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_25_252_31&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">)

</span><a href="#loc_257_1_257_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_22&#39;)"><span class="mpre">underscorePrefixRules</span></a><span class="mpre"> :: </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre">
</span><a name="loc_257_1_257_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_22&#39;)"><span class="hl_vardecl"><span class="mpre">underscorePrefixRules</span></span></a><span class="mpre"> = </span><a href="#loc_180_18_180_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_18_180_27&#39;)"><span class="hl_conref"><span class="mpre">LensRules</span></span></a><span class="mpre"> </span><a href="#loc_220_1_220_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_11&#39;)"><span class="hl_varref"><span class="mpre">mLowerName</span></span></a><span class="mpre"> </span><a href="#loc_261_5_261_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_5_261_8&#39;)"><span class="hl_varref"><span class="mpre">fld</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">Set.fromList</span></span><span class="mpre"> [</span><a href="#loc_115_5_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_5_115_17&#39;)"><span class="hl_conref"><span class="mpre">SingletonIso</span></span></a><span class="mpre">, </span><a href="#loc_114_5_114_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_22&#39;)"><span class="hl_conref"><span class="mpre">SingletonAndField</span></span></a><span class="mpre">, </span><a href="#loc_118_5_118_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_5_118_16&#39;)"><span class="hl_conref"><span class="mpre">CreateClass</span></span></a><span class="mpre">,
                  </span><a href="#loc_119_5_119_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_19&#39;)"><span class="hl_conref"><span class="mpre">CreateInstance</span></span></a><span class="mpre">, </span><a href="#loc_113_5_113_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_20&#39;)"><span class="hl_conref"><span class="mpre">BuildTraversals</span></span></a><span class="mpre">, </span><a href="#loc_121_5_121_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_23&#39;)"><span class="hl_conref"><span class="mpre">GenerateSignatures</span></span></a><span class="mpre">]
  where
    </span><a name="loc_261_5_261_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_5_261_8&#39;)"><span class="hl_fundecl"><span class="mpre">fld</span></span></a><span class="mpre"> </span><a name="loc_261_9_261_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_9_261_11&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_261_9_261_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_9_261_11&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)

</span><a href="#loc_264_1_264_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_13&#39;)"><span class="mpre">classyRules_</span></a><span class="mpre"> :: </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre">
</span><a name="loc_264_1_264_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_13&#39;)"><span class="hl_vardecl"><span class="mpre">classyRules_</span></span></a><span class="mpre"> = </span><a href="#loc_257_1_257_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_22&#39;)"><span class="hl_varref"><span class="mpre">underscorePrefixRules</span></span></a><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_8&#39;)"><span class="hl_varref"><span class="mpre">lensIso</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_143_1_143_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_17&#39;)"><span class="hl_varref"><span class="mpre">handleSingletons</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_204_1_204_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_10&#39;)"><span class="hl_varref"><span class="mpre">lensClass</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><a href="#loc_273_5_273_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_5_273_11&#39;)"><span class="hl_varref"><span class="mpre">classy</span></span></a><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_168_1_168_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_14&#39;)"><span class="hl_varref"><span class="mpre">classRequired</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_133_1_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_14&#39;)"><span class="hl_varref"><span class="mpre">partialLenses</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
  </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_139_1_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_16&#39;)"><span class="hl_varref"><span class="mpre">buildTraversals</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
  where
    </span><a href="#loc_273_5_273_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_5_273_11&#39;)"><span class="mpre">classy</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
    </span><a name="loc_273_5_273_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_5_273_11&#39;)"><span class="hl_fundecl"><span class="mpre">classy</span></span></a><span class="mpre"> </span><a name="loc_273_12_273_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_12_273_13&#39;)"><span class="hl_specname"><span class="mpre">n</span></span></a><span class="mpre">@(</span><a name="loc_273_15_273_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_15_273_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_273_17_273_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_17_273_19&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Has&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_273_12_273_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_12_273_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><a href="#loc_273_15_273_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_15_273_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_273_17_273_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_17_273_19&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre">)
    </span><a href="#loc_273_5_273_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_5_273_11&#39;)"><span class="hl_fundecl"><span class="mpre">classy</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Build lenses (and traversals) with a sensible default configuration.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /e.g./</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- data FooBar</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   = Foo { _x, _y :: &#39;Int&#39; }</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   | Bar { _x :: &#39;Int&#39; }</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;makeLenses&#39; &#39;&#39;FooBar</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will create</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- x :: &#39;Lens&#39;&#39; FooBar &#39;Int&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- x f (Foo a b) = (\\a\&#39; -&gt; Foo a\&#39; b) \&lt;$\&gt; f a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- x f (Bar a)   = Bar \&lt;$\&gt; f a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- y :: &#39;Traversal&#39;&#39; FooBar &#39;Int&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- y f (Foo a b) = (\\b\&#39; -&gt; Foo a  b\&#39;) \&lt;$\&gt; f b</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- y _ c\@(Bar _) = pure c</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;makeLenses&#39; = &#39;makeLensesWith&#39; &#39;lensRules&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_302_1_302_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_1_302_11&#39;)"><span class="mpre">makeLenses</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_302_1_302_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_1_302_11&#39;)"><span class="hl_vardecl"><span class="mpre">makeLenses</span></span></a><span class="mpre"> = </span><a href="#loc_370_1_370_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_15&#39;)"><span class="hl_varref"><span class="mpre">makeLensesWith</span></span></a><span class="mpre"> </span><a href="#loc_226_1_226_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_10&#39;)"><span class="hl_varref"><span class="mpre">lensRules</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Make lenses and traversals for a type, and create a class when the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- type has no arguments.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /e.g./</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- data Foo = Foo { _fooX, _fooY :: &#39;Int&#39; }</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;makeClassy&#39; &#39;&#39;Foo</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will create</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- class HasFoo t where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   foo :: &#39;Lens&#39;&#39; t Foo</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   fooX :: &#39;Lens&#39;&#39; t &#39;Int&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   fooX = foo . go where go f (Foo x y) = (\\x\&#39; -&gt; Foo x&#39; y) \&lt;$\&gt; f x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   fooY :: &#39;Lens&#39;&#39; t &#39;Int&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   fooY = foo . go where go f (Foo x y) = (\\y\&#39; -&gt; Foo x y&#39;) \&lt;$\&gt; f y</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instance HasFoo Foo where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   foo = id</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;makeClassy&#39; = &#39;makeLensesWith&#39; &#39;classyRules&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_331_1_331_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_1_331_11&#39;)"><span class="mpre">makeClassy</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_331_1_331_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_1_331_11&#39;)"><span class="hl_vardecl"><span class="mpre">makeClassy</span></span></a><span class="mpre"> = </span><a href="#loc_370_1_370_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_15&#39;)"><span class="hl_varref"><span class="mpre">makeLensesWith</span></span></a><span class="mpre"> </span><a href="#loc_238_1_238_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_1_238_12&#39;)"><span class="hl_varref"><span class="mpre">classyRules</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Make lenses and traversals for a type, and create a class when the type</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- has no arguments.  Works the same as &#39;makeClassy&#39; except that (a) it</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- expects that record field names do not begin with an underscore, (b) all</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- record fields are made into lenses, and (c) the resulting lens is prefixed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with an underscore.</span></span><span class="mpre">
</span><a href="#loc_339_1_339_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_1_339_12&#39;)"><span class="mpre">makeClassy_</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_339_1_339_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_1_339_12&#39;)"><span class="hl_vardecl"><span class="mpre">makeClassy_</span></span></a><span class="mpre"> = </span><a href="#loc_370_1_370_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_15&#39;)"><span class="hl_varref"><span class="mpre">makeLensesWith</span></span></a><span class="mpre"> </span><a href="#loc_264_1_264_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_13&#39;)"><span class="hl_varref"><span class="mpre">classyRules_</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Derive lenses and traversals, specifying explicit pairings</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of @(fieldName, lensName)@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If you map multiple names to the same label, and it is present in the same</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- constructor then this will generate a &#39;Traversal&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /e.g./</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;makeLensesFor&#39; [(\&quot;_foo\&quot;, \&quot;fooLens\&quot;), (\&quot;baz\&quot;, \&quot;lbaz\&quot;)] &#39;&#39;Foo</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;makeLensesFor&#39; [(\&quot;_barX\&quot;, \&quot;bar\&quot;), (\&quot;_barY\&quot;, \&quot;bar\&quot;)] &#39;&#39;Bar</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_354_1_354_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_14&#39;)"><span class="mpre">makeLensesFor</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_354_1_354_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_14&#39;)"><span class="hl_fundecl"><span class="mpre">makeLensesFor</span></span></a><span class="mpre"> </span><a name="loc_354_15_354_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_15_354_21&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> = </span><a href="#loc_370_1_370_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_15&#39;)"><span class="hl_varref"><span class="mpre">makeLensesWith</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_234_1_234_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_1_234_13&#39;)"><span class="hl_varref"><span class="mpre">lensRulesFor</span></span></a><span class="mpre"> </span><a href="#loc_354_15_354_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_15_354_21&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Derive lenses and traversals, using a named wrapper class, and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- specifying explicit pairings of @(fieldName, traversalName)@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example usage:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;makeClassyFor&#39; \&quot;HasFoo\&quot; \&quot;foo\&quot; [(\&quot;_foo\&quot;, \&quot;fooLens\&quot;), (\&quot;bar\&quot;, \&quot;lbar\&quot;)] &#39;&#39;Foo</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_365_1_365_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_14&#39;)"><span class="mpre">makeClassyFor</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_365_1_365_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_14&#39;)"><span class="hl_fundecl"><span class="mpre">makeClassyFor</span></span></a><span class="mpre"> </span><a name="loc_365_15_365_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_15_365_22&#39;)"><span class="hl_vardecl"><span class="mpre">clsName</span></span></a><span class="mpre"> </span><a name="loc_365_23_365_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_23_365_30&#39;)"><span class="hl_vardecl"><span class="mpre">funName</span></span></a><span class="mpre"> </span><a name="loc_365_31_365_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_31_365_37&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> = </span><a href="#loc_370_1_370_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_15&#39;)"><span class="hl_varref"><span class="mpre">makeLensesWith</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><a href="#loc_252_1_252_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_1_252_15&#39;)"><span class="hl_varref"><span class="mpre">classyRulesFor</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_365_15_365_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_15_365_22&#39;)"><span class="hl_varref"><span class="mpre">clsName</span></span></a><span class="mpre">, </span><a href="#loc_365_23_365_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_23_365_30&#39;)"><span class="hl_varref"><span class="mpre">funName</span></span></a><span class="mpre">)) </span><a href="#loc_365_31_365_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_31_365_37&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Build lenses with a custom configuration.</span></span><span class="mpre">
</span><a href="#loc_370_1_370_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_15&#39;)"><span class="mpre">makeLensesWith</span></a><span class="mpre"> :: </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_370_1_370_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_15&#39;)"><span class="hl_fundecl"><span class="mpre">makeLensesWith</span></span></a><span class="mpre"> </span><a name="loc_370_16_370_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_16_370_19&#39;)"><span class="hl_vardecl"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a name="loc_370_20_370_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_20_370_22&#39;)"><span class="hl_vardecl"><span class="mpre">nm</span></span></a><span class="mpre"> = do
    </span><a name="loc_371_5_371_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_5_371_8&#39;)"><span class="hl_vardecl"><span class="mpre">inf</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">reify</span></span><span class="mpre"> </span><a href="#loc_370_20_370_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_20_370_22&#39;)"><span class="hl_varref"><span class="mpre">nm</span></span></a><span class="mpre">
    case </span><a href="#loc_371_5_371_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_5_371_8&#39;)"><span class="hl_varref"><span class="mpre">inf</span></span></a><span class="mpre"> of
      </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> </span><a name="loc_373_14_373_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_14_373_18&#39;)"><span class="hl_vardecl"><span class="mpre">decl</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_708_1_708_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_1_708_17&#39;)"><span class="hl_varref"><span class="mpre">makeLensesForDec</span></span></a><span class="mpre"> </span><a href="#loc_370_16_370_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_16_370_19&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a href="#loc_373_14_373_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_14_373_18&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre">
      _ -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;makeLensesWith: Expected the name of a data type or newtype&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Generate a &#39;Prism&#39; for each constructor of a data type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /e.g./</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- data FooBarBaz a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   = Foo Int</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   | Bar a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   | Baz Int Char</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- makePrisms &#39;&#39;FooBarBaz</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will create</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- _Foo :: Prism&#39; (FooBarBaz a) Int</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- _Bar :: Prism (FooBarBaz a) (FooBarBaz b) a b</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- _Baz :: Prism&#39; (FooBarBaz a) (Int, Char)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_396_1_396_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_1_396_11&#39;)"><span class="mpre">makePrisms</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_396_1_396_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_1_396_11&#39;)"><span class="hl_fundecl"><span class="mpre">makePrisms</span></span></a><span class="mpre"> </span><a name="loc_396_12_396_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_12_396_14&#39;)"><span class="hl_vardecl"><span class="mpre">nm</span></span></a><span class="mpre"> = do
    </span><a name="loc_397_5_397_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_5_397_8&#39;)"><span class="hl_vardecl"><span class="mpre">inf</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">reify</span></span><span class="mpre"> </span><a href="#loc_396_12_396_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_12_396_14&#39;)"><span class="hl_varref"><span class="mpre">nm</span></span></a><span class="mpre">
    case </span><a href="#loc_397_5_397_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_5_397_8&#39;)"><span class="hl_varref"><span class="mpre">inf</span></span></a><span class="mpre"> of
      </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> </span><a name="loc_399_14_399_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_14_399_18&#39;)"><span class="hl_vardecl"><span class="mpre">decl</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_524_1_524_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_1_524_17&#39;)"><span class="hl_varref"><span class="mpre">makePrismsForDec</span></span></a><span class="mpre"> </span><a href="#loc_399_14_399_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_14_399_18&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre">
      _ -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;makePrisms: Expected the name of a data type or newtype&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Make lenses for all records in the given declaration quote. All record</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- syntax in the input will be stripped off.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /e.g./</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- declareLenses [d|</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   data Foo = Foo { fooX, fooY :: &#39;Int&#39; }</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     deriving &#39;Show&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   |]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will create</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- data Foo = Foo &#39;Int&#39; &#39;Int&#39; deriving &#39;Show&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- fooX, fooY :: &#39;Lens&#39;&#39; Foo Int</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @ declareLenses = &#39;declareLensesWith&#39; (&#39;lensRules&#39; &#39;&amp;&#39; &#39;lensField&#39; &#39;.~&#39; &#39;Just&#39;) @</span></span><span class="mpre">
</span><a href="#loc_423_1_423_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_14&#39;)"><span class="mpre">declareLenses</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_423_1_423_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_14&#39;)"><span class="hl_vardecl"><span class="mpre">declareLenses</span></span></a><span class="mpre"> = </span><a href="#loc_500_1_500_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_18&#39;)"><span class="hl_varref"><span class="mpre">declareLensesWith</span></span></a><span class="mpre"> (</span><a href="#loc_226_1_226_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_10&#39;)"><span class="hl_varref"><span class="mpre">lensRules</span></span></a><span class="mpre"> </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_199_1_199_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_10&#39;)"><span class="hl_varref"><span class="mpre">lensField</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Similar to &#39;makeLensesFor&#39;, but takes a declaration quote.</span></span><span class="mpre">
</span><a href="#loc_427_1_427_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_1_427_17&#39;)"><span class="mpre">declareLensesFor</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_427_1_427_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_1_427_17&#39;)"><span class="hl_fundecl"><span class="mpre">declareLensesFor</span></span></a><span class="mpre"> </span><a name="loc_427_18_427_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_18_427_24&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> = </span><a href="#loc_500_1_500_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_18&#39;)"><span class="hl_varref"><span class="mpre">declareLensesWith</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><a href="#loc_234_1_234_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_1_234_13&#39;)"><span class="hl_varref"><span class="mpre">lensRulesFor</span></span></a><span class="mpre"> </span><a href="#loc_427_18_427_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_18_427_24&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre"> </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_199_1_199_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_10&#39;)"><span class="hl_varref"><span class="mpre">lensField</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | For each record in the declaration quote, make lenses and traversals for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it, and create a class when the type has no arguments. All record syntax</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in the input will be stripped off.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /e.g./</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- declareClassy [d|</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   data Foo = Foo { fooX, fooY :: &#39;Int&#39; }</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     deriving &#39;Show&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   |]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will create</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- data Foo = Foo &#39;Int&#39; &#39;Int&#39; deriving &#39;Show&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- class HasFoo t where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   foo :: &#39;Lens&#39;&#39; t Foo</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instance HasFoo Foo where foo = &#39;id&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- fooX, fooY :: HasFoo t =&gt; &#39;Lens&#39;&#39; t &#39;Int&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @ declareClassy = &#39;declareLensesWith&#39; (&#39;classyRules&#39; &#39;&amp;&#39; &#39;lensField&#39; &#39;.~&#39; &#39;Just&#39;) @</span></span><span class="mpre">
</span><a href="#loc_455_1_455_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_455_1_455_14&#39;)"><span class="mpre">declareClassy</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_455_1_455_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_455_1_455_14&#39;)"><span class="hl_vardecl"><span class="mpre">declareClassy</span></span></a><span class="mpre"> = </span><a href="#loc_500_1_500_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_18&#39;)"><span class="hl_varref"><span class="mpre">declareLensesWith</span></span></a><span class="mpre"> (</span><a href="#loc_238_1_238_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_1_238_12&#39;)"><span class="hl_varref"><span class="mpre">classyRules</span></span></a><span class="mpre"> </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_199_1_199_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_10&#39;)"><span class="hl_varref"><span class="mpre">lensField</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Similar to &#39;makeClassyFor&#39;, but takes a declaration quote.</span></span><span class="mpre">
</span><a href="#loc_459_1_459_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_1_459_17&#39;)"><span class="mpre">declareClassyFor</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">))] -&gt; [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_459_1_459_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_1_459_17&#39;)"><span class="hl_fundecl"><span class="mpre">declareClassyFor</span></span></a><span class="mpre"> </span><a name="loc_459_18_459_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_18_459_25&#39;)"><span class="hl_vardecl"><span class="mpre">classes</span></span></a><span class="mpre"> </span><a name="loc_459_26_459_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_26_459_32&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> = </span><a href="#loc_500_1_500_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_18&#39;)"><span class="hl_varref"><span class="mpre">declareLensesWith</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><a href="#loc_252_1_252_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_1_252_15&#39;)"><span class="hl_varref"><span class="mpre">classyRulesFor</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`Prelude.lookup`</span></span><a href="#loc_459_18_459_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_18_459_25&#39;)"><span class="hl_varref"><span class="mpre">classes</span></span></a><span class="mpre">) </span><a href="#loc_459_26_459_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_26_459_32&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre"> </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_199_1_199_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_10&#39;)"><span class="hl_varref"><span class="mpre">lensField</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Generate a &#39;Prism&#39; for each constructor of each data type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /e.g./</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- declarePrisms [d|</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   data Exp = Lit Int | Var String | Lambda{ bound::String, body::Exp }</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   |]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will create</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- data Exp = Lit Int | Var String | Lambda { bound::String, body::Exp }</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- _Lit :: &#39;Prism&#39;&#39; Exp Int</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- _Var :: &#39;Prism&#39;&#39; Exp String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- _Lambda :: &#39;Prism&#39;&#39; Exp (String, Exp)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_481_1_481_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_1_481_14&#39;)"><span class="mpre">declarePrisms</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_481_1_481_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_1_481_14&#39;)"><span class="hl_vardecl"><span class="mpre">declarePrisms</span></span></a><span class="mpre"> = </span><a href="#loc_1350_1_1350_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1350_1_1350_12&#39;)"><span class="hl_varref"><span class="mpre">declareWith</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_481_32_481_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_32_481_35&#39;)"><span class="hl_vardecl"><span class="mpre">dec</span></span></a><span class="mpre"> -&gt; do
  </span><a href="#loc_1361_1_1361_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1361_1_1361_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">Trans.lift</span></span></a><span class="mpre"> (</span><a href="#loc_524_1_524_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_1_524_17&#39;)"><span class="hl_varref"><span class="mpre">makePrismsForDec</span></span></a><span class="mpre"> </span><a href="#loc_481_32_481_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_32_481_35&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">)
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_481_32_481_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_32_481_35&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Build &#39;Wrapped&#39; instance for each newtype.</span></span><span class="mpre">
</span><a href="#loc_487_1_487_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_1_487_15&#39;)"><span class="mpre">declareWrapped</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_487_1_487_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_1_487_15&#39;)"><span class="hl_vardecl"><span class="mpre">declareWrapped</span></span></a><span class="mpre"> = </span><a href="#loc_1350_1_1350_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1350_1_1350_12&#39;)"><span class="hl_varref"><span class="mpre">declareWith</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_487_33_487_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_33_487_36&#39;)"><span class="hl_vardecl"><span class="mpre">dec</span></span></a><span class="mpre"> -&gt; do
  </span><a name="loc_488_3_488_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_3_488_12&#39;)"><span class="hl_vardecl"><span class="mpre">maybeDecs</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">Trans.lift</span></span></a><span class="mpre"> (</span><a href="#loc_1075_1_1075_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1075_1_1075_18&#39;)"><span class="hl_varref"><span class="mpre">makeWrappedForDec</span></span></a><span class="mpre"> </span><a href="#loc_487_33_487_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_33_487_36&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">)
  </span><a href="Data.Foldable.html#loc_237_1_237_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Foldable.html#loc_237_1_237_6&#39;)"><span class="hl_varref"><span class="mpre">forM_</span></span></a><span class="mpre"> </span><a href="#loc_488_3_488_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_3_488_12&#39;)"><span class="hl_varref"><span class="mpre">maybeDecs</span></span></a><span class="mpre"> </span><a href="#loc_1361_1_1361_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1361_1_1361_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_487_33_487_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_33_487_36&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @ declareFields = &#39;declareFieldsWith&#39; &#39;defaultFieldRules&#39; @</span></span><span class="mpre">
</span><a href="#loc_494_1_494_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_1_494_14&#39;)"><span class="mpre">declareFields</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_494_1_494_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_1_494_14&#39;)"><span class="hl_vardecl"><span class="mpre">declareFields</span></span></a><span class="mpre"> = </span><a href="#loc_508_1_508_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_1_508_18&#39;)"><span class="hl_varref"><span class="mpre">declareFieldsWith</span></span></a><span class="mpre"> </span><a href="#loc_1345_1_1345_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1345_1_1345_18&#39;)"><span class="hl_varref"><span class="mpre">defaultFieldRules</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Declare lenses for each records in the given declarations, using the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- specified &#39;LensRules&#39;. Any record syntax in the input will be stripped</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- off.</span></span><span class="mpre">
</span><a href="#loc_500_1_500_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_18&#39;)"><span class="mpre">declareLensesWith</span></a><span class="mpre"> :: </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_500_1_500_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_18&#39;)"><span class="hl_fundecl"><span class="mpre">declareLensesWith</span></span></a><span class="mpre"> </span><a name="loc_500_19_500_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_19_500_24&#39;)"><span class="hl_vardecl"><span class="mpre">rules</span></span></a><span class="mpre"> = </span><a href="#loc_1350_1_1350_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1350_1_1350_12&#39;)"><span class="hl_varref"><span class="mpre">declareWith</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_500_42_500_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_42_500_45&#39;)"><span class="hl_vardecl"><span class="mpre">dec</span></span></a><span class="mpre"> -&gt; do
  </span><a href="#loc_1361_1_1361_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1361_1_1361_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">Trans.lift</span></span></a><span class="mpre"> (</span><a href="#loc_708_1_708_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_1_708_17&#39;)"><span class="hl_varref"><span class="mpre">makeLensesForDec</span></span></a><span class="mpre"> </span><a href="#loc_500_19_500_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_19_500_24&#39;)"><span class="hl_varref"><span class="mpre">rules</span></span></a><span class="mpre"> </span><a href="#loc_500_42_500_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_42_500_45&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">)
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_1381_1_1381_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1381_1_1381_12&#39;)"><span class="hl_varref"><span class="mpre">stripFields</span></span></a><span class="mpre"> </span><a href="#loc_500_42_500_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_42_500_45&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Declare fields for each records in the given declarations, using the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- specified &#39;FieldRules&#39;. Any record syntax in the input will be stripped</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- off.</span></span><span class="mpre">
</span><a href="#loc_508_1_508_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_1_508_18&#39;)"><span class="mpre">declareFieldsWith</span></a><span class="mpre"> :: </span><a href="#loc_1165_6_1165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1165_6_1165_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldRules</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_508_1_508_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_1_508_18&#39;)"><span class="hl_fundecl"><span class="mpre">declareFieldsWith</span></span></a><span class="mpre"> </span><a name="loc_508_19_508_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_19_508_24&#39;)"><span class="hl_vardecl"><span class="mpre">rules</span></span></a><span class="mpre"> = </span><a href="#loc_1350_1_1350_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1350_1_1350_12&#39;)"><span class="hl_varref"><span class="mpre">declareWith</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_508_42_508_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_42_508_45&#39;)"><span class="hl_vardecl"><span class="mpre">dec</span></span></a><span class="mpre"> -&gt; do
  </span><a href="#loc_1361_1_1361_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1361_1_1361_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">Trans.lift</span></span></a><span class="mpre"> (</span><a href="#loc_1304_1_1304_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1304_1_1304_17&#39;)"><span class="hl_varref"><span class="mpre">makeFieldsForDec</span></span></a><span class="mpre"> </span><a href="#loc_508_19_508_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_19_508_24&#39;)"><span class="hl_varref"><span class="mpre">rules</span></span></a><span class="mpre"> </span><a href="#loc_508_42_508_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_42_508_45&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">)
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_1381_1_1381_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1381_1_1381_12&#39;)"><span class="hl_varref"><span class="mpre">stripFields</span></span></a><span class="mpre"> </span><a href="#loc_508_42_508_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_42_508_45&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Internal TH Implementation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Transform @NewtypeD@s declarations to @DataD@s and @NewtypeInstD@s to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @DataInstD@s.</span></span><span class="mpre">
</span><a href="#loc_519_1_519_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_1_519_10&#39;)"><span class="mpre">deNewtype</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">
</span><a name="loc_519_1_519_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_1_519_10&#39;)"><span class="hl_fundecl"><span class="mpre">deNewtype</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">NewtypeD</span></span><span class="mpre"> </span><a name="loc_519_21_519_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_21_519_24&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_519_25_519_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_25_519_31&#39;)"><span class="hl_vardecl"><span class="mpre">tyName</span></span></a><span class="mpre"> </span><a name="loc_519_32_519_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_32_519_36&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> </span><a name="loc_519_37_519_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_37_519_38&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_519_39_519_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_39_519_40&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">DataD</span></span><span class="mpre"> </span><a href="#loc_519_21_519_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_21_519_24&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_519_25_519_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_25_519_31&#39;)"><span class="hl_varref"><span class="mpre">tyName</span></span></a><span class="mpre"> </span><a href="#loc_519_32_519_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_32_519_36&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> [</span><a href="#loc_519_37_519_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_37_519_38&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">] </span><a href="#loc_519_39_519_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_39_519_40&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
</span><a href="#loc_519_1_519_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_1_519_10&#39;)"><span class="hl_fundecl"><span class="mpre">deNewtype</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">NewtypeInstD</span></span><span class="mpre"> </span><a name="loc_520_25_520_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_25_520_28&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_520_29_520_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_29_520_35&#39;)"><span class="hl_vardecl"><span class="mpre">tyName</span></span></a><span class="mpre"> </span><a name="loc_520_36_520_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_36_520_40&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> </span><a name="loc_520_41_520_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_41_520_42&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_520_43_520_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_43_520_44&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">DataInstD</span></span><span class="mpre"> </span><a href="#loc_520_25_520_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_25_520_28&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_520_29_520_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_29_520_35&#39;)"><span class="hl_varref"><span class="mpre">tyName</span></span></a><span class="mpre"> </span><a href="#loc_520_36_520_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_36_520_40&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> [</span><a href="#loc_520_41_520_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_41_520_42&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">] </span><a href="#loc_520_43_520_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_43_520_44&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
</span><a href="#loc_519_1_519_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_1_519_10&#39;)"><span class="hl_fundecl"><span class="mpre">deNewtype</span></span></a><span class="mpre"> </span><a name="loc_521_11_521_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_11_521_12&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><a href="#loc_521_11_521_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_11_521_12&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">

</span><a href="#loc_524_1_524_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_1_524_17&#39;)"><span class="mpre">makePrismsForDec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_524_1_524_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_1_524_17&#39;)"><span class="hl_fundecl"><span class="mpre">makePrismsForDec</span></span></a><span class="mpre"> </span><a name="loc_524_18_524_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_18_524_22&#39;)"><span class="hl_vardecl"><span class="mpre">decl</span></span></a><span class="mpre"> = case </span><a href="#loc_726_1_726_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_1_726_13&#39;)"><span class="hl_varref"><span class="mpre">makeDataDecl</span></span></a><span class="mpre"> </span><a href="#loc_524_18_524_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_18_524_22&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre"> of
  </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_525_8_525_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_8_525_16&#39;)"><span class="hl_vardecl"><span class="mpre">dataDecl</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_529_1_529_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_1_529_18&#39;)"><span class="hl_varref"><span class="mpre">makePrismsForCons</span></span></a><span class="mpre"> </span><a href="#loc_525_8_525_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_8_525_16&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">
  _ -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;makePrisms: Unsupported data type&quot;</span></span><span class="mpre">

</span><a href="#loc_529_1_529_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_1_529_18&#39;)"><span class="mpre">makePrismsForCons</span></a><span class="mpre"> :: </span><a href="#loc_754_6_754_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_6_754_14&#39;)"><span class="hl_tyconref"><span class="mpre">DataDecl</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_529_1_529_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_1_529_18&#39;)"><span class="hl_fundecl"><span class="mpre">makePrismsForCons</span></span></a><span class="mpre"> </span><a name="loc_529_19_529_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_19_529_27&#39;)"><span class="hl_specname"><span class="mpre">dataDecl</span></span></a><span class="mpre">@(</span><a href="#loc_754_17_754_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_17_754_25&#39;)"><span class="hl_conref"><span class="mpre">DataDecl</span></span></a><span class="mpre"> _ _ _ _ [_]) = case </span><a href="#loc_762_5_762_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_762_5_762_17&#39;)"><span class="hl_varref"><span class="mpre">constructors</span></span></a><span class="mpre"> </span><a href="#loc_529_19_529_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_19_529_27&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> of
  </span><span class="hl_comment"><span class="mpre">-- Iso promotion via tuples</span></span><span class="mpre">
  [</span><span class="hl_conref"><span class="mpre">NormalC</span></span><span class="mpre"> </span><a name="loc_531_12_531_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_12_531_23&#39;)"><span class="hl_vardecl"><span class="mpre">dataConName</span></span></a><span class="mpre"> </span><a name="loc_531_24_531_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_24_531_26&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">] -&gt;
    </span><a href="#loc_772_1_772_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_1_772_14&#39;)"><span class="hl_varref"><span class="mpre">makeIsoLenses</span></span></a><span class="mpre"> </span><a href="#loc_538_3_538_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_538_3_538_8&#39;)"><span class="hl_varref"><span class="mpre">rules</span></span></a><span class="mpre"> </span><a href="#loc_529_19_529_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_19_529_27&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><a href="#loc_531_12_531_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_12_531_23&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">_2</span></span><span class="mpre">) </span><a href="#loc_531_24_531_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_24_531_26&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
  [</span><span class="hl_conref"><span class="mpre">RecC</span></span><span class="mpre">    </span><a name="loc_533_12_533_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_12_533_23&#39;)"><span class="hl_vardecl"><span class="mpre">dataConName</span></span></a><span class="mpre"> </span><a name="loc_533_24_533_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_24_533_26&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">] -&gt;
    </span><a href="#loc_772_1_772_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_1_772_14&#39;)"><span class="hl_varref"><span class="mpre">makeIsoLenses</span></span></a><span class="mpre"> </span><a href="#loc_538_3_538_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_538_3_538_8&#39;)"><span class="hl_varref"><span class="mpre">rules</span></span></a><span class="mpre"> </span><a href="#loc_529_19_529_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_19_529_27&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><a href="#loc_533_12_533_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_12_533_23&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">_3</span></span><span class="mpre">) </span><a href="#loc_533_24_533_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_24_533_26&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
  _                        -&gt;
    </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;makePrismsForCons: A single-constructor data type is required&quot;</span></span><span class="mpre">
  where
  </span><a name="loc_538_3_538_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_538_3_538_8&#39;)"><span class="hl_vardecl"><span class="mpre">rules</span></span></a><span class="mpre"> = </span><a href="#loc_213_1_213_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_13&#39;)"><span class="hl_varref"><span class="mpre">defaultRules</span></span></a><span class="mpre">
        </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_143_1_143_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_17&#39;)"><span class="hl_varref"><span class="mpre">handleSingletons</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_156_1_156_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_18&#39;)"><span class="hl_varref"><span class="mpre">singletonRequired</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_148_1_148_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_18&#39;)"><span class="hl_varref"><span class="mpre">singletonAndField</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_8&#39;)"><span class="hl_varref"><span class="mpre">lensIso</span></span></a><span class="mpre">     </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">))

</span><a href="#loc_529_1_529_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_1_529_18&#39;)"><span class="hl_fundecl"><span class="mpre">makePrismsForCons</span></span></a><span class="mpre"> </span><a name="loc_544_19_544_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_19_544_27&#39;)"><span class="hl_vardecl"><span class="mpre">dataDecl</span></span></a><span class="mpre"> =
  </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> (</span><a href="#loc_556_1_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_1_556_24&#39;)"><span class="hl_varref"><span class="mpre">makePrismOrReviewForCon</span></span></a><span class="mpre"> </span><a href="#loc_544_19_544_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_19_544_27&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><a href="#loc_548_5_548_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_548_5_548_21&#39;)"><span class="hl_varref"><span class="mpre">canModifyTypeVar</span></span></a><span class="mpre"> ) (</span><a href="#loc_762_5_762_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_762_5_762_17&#39;)"><span class="hl_varref"><span class="mpre">constructors</span></span></a><span class="mpre"> </span><a href="#loc_544_19_544_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_19_544_27&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">)
  where
    </span><a name="loc_547_5_547_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_547_5_547_16&#39;)"><span class="hl_vardecl"><span class="mpre">conTypeVars</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">Set.fromList</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Lens.Fold.html#loc_543_1_543_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Fold.html#loc_543_1_543_9&#39;)"><span class="hl_varref"><span class="mpre">toListOf</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_346_1_346_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_346_1_346_9&#39;)"><span class="hl_varref"><span class="mpre">typeVars</span></span></a><span class="mpre">) (</span><a href="#loc_762_5_762_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_762_5_762_17&#39;)"><span class="hl_varref"><span class="mpre">constructors</span></span></a><span class="mpre"> </span><a href="#loc_544_19_544_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_19_544_27&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">)
    </span><a name="loc_548_5_548_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_548_5_548_21&#39;)"><span class="hl_vardecl"><span class="mpre">canModifyTypeVar</span></span></a><span class="mpre"> = (</span><span class="hl_infix"><span class="mpre">`Set.member`</span></span><span class="mpre"> </span><a href="#loc_549_5_549_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_5_549_25&#39;)"><span class="hl_varref"><span class="mpre">typeVarsOnlyInOneCon</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">
    </span><a name="loc_549_5_549_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_5_549_25&#39;)"><span class="hl_vardecl"><span class="mpre">typeVarsOnlyInOneCon</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">Set.fromList</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (\</span><a name="loc_549_61_549_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_61_549_63&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_549_61_549_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_61_549_63&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">  </span><a href="Data.List.html#loc_735_1_735_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_735_1_735_6&#39;)"><span class="hl_varref"><span class="mpre">List.group</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.List.html#loc_809_1_809_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_809_1_809_5&#39;)"><span class="hl_varref"><span class="mpre">List.sort</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_547_5_547_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_547_5_547_16&#39;)"><span class="hl_varref"><span class="mpre">conTypeVars</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Foldable.html#loc_264_1_264_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Foldable.html#loc_264_1_264_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre">

</span><a href="#loc_552_1_552_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_1_552_16&#39;)"><span class="mpre">onlyBuildReview</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_552_1_552_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_1_552_16&#39;)"><span class="hl_fundecl"><span class="mpre">onlyBuildReview</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 552, srcSpanStartColumn = 17, srcSpanEndLine = 552, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 552, srcSpanStartColumn = 24, srcSpanEndLine = 552, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 552, src"><span class="mpre">ForallC{}</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_552_1_552_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_1_552_16&#39;)"><span class="hl_fundecl"><span class="mpre">onlyBuildReview</span></span></a><span class="mpre"> _         = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><a href="#loc_556_1_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_1_556_24&#39;)"><span class="mpre">makePrismOrReviewForCon</span></a><span class="mpre"> :: </span><a href="#loc_754_6_754_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_6_754_14&#39;)"><span class="hl_tyconref"><span class="mpre">DataDecl</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">TyVarBndr</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_556_1_556_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_1_556_24&#39;)"><span class="hl_fundecl"><span class="mpre">makePrismOrReviewForCon</span></span></a><span class="mpre"> </span><a name="loc_556_25_556_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_25_556_33&#39;)"><span class="hl_vardecl"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><a name="loc_556_34_556_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_34_556_50&#39;)"><span class="hl_vardecl"><span class="mpre">canModifyTypeVar</span></span></a><span class="mpre"> </span><a name="loc_556_51_556_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_51_556_54&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre">
  | </span><a href="#loc_552_1_552_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_1_552_16&#39;)"><span class="hl_varref"><span class="mpre">onlyBuildReview</span></span></a><span class="mpre"> </span><a href="#loc_556_51_556_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_51_556_54&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre"> = </span><a href="#loc_561_1_561_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_1_561_17&#39;)"><span class="hl_varref"><span class="mpre">makeReviewForCon</span></span></a><span class="mpre"> </span><a href="#loc_556_25_556_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_25_556_33&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><a href="#loc_556_51_556_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_51_556_54&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">           = </span><a href="#loc_593_1_593_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_1_593_16&#39;)"><span class="hl_varref"><span class="mpre">makePrismForCon</span></span></a><span class="mpre"> </span><a href="#loc_556_25_556_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_25_556_33&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><a href="#loc_556_34_556_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_34_556_50&#39;)"><span class="hl_varref"><span class="mpre">canModifyTypeVar</span></span></a><span class="mpre"> </span><a href="#loc_556_51_556_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_51_556_54&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">

</span><a href="#loc_561_1_561_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_1_561_17&#39;)"><span class="mpre">makeReviewForCon</span></a><span class="mpre"> :: </span><a href="#loc_754_6_754_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_6_754_14&#39;)"><span class="hl_tyconref"><span class="mpre">DataDecl</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_561_1_561_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_1_561_17&#39;)"><span class="hl_fundecl"><span class="mpre">makeReviewForCon</span></span></a><span class="mpre"> </span><a name="loc_561_18_561_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_18_561_26&#39;)"><span class="hl_vardecl"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><a name="loc_561_27_561_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_27_561_30&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre"> = do
    let </span><a name="loc_562_9_562_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_9_562_21&#39;)"><span class="hl_vardecl"><span class="mpre">functionName</span></span></a><span class="mpre">                    = </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_563_10_563_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_10_563_21&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre">)
        (</span><a name="loc_563_10_563_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_10_563_21&#39;)"><span class="hl_vardecl"><span class="mpre">dataConName</span></span></a><span class="mpre">, </span><a name="loc_563_23_563_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_23_563_33&#39;)"><span class="hl_vardecl"><span class="mpre">fieldTypes</span></span></a><span class="mpre">)       = </span><a href="#loc_642_1_642_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_1_642_21&#39;)"><span class="hl_varref"><span class="mpre">ctrNameAndFieldTypes</span></span></a><span class="mpre"> </span><a href="#loc_561_27_561_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_27_561_30&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">

    </span><a name="loc_565_5_565_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_5_565_10&#39;)"><span class="hl_vardecl"><span class="mpre">sName</span></span></a><span class="mpre">       &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;s&quot;</span></span><span class="mpre">
    </span><a name="loc_566_5_566_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_566_5_566_10&#39;)"><span class="hl_vardecl"><span class="mpre">aName</span></span></a><span class="mpre">       &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;a&quot;</span></span><span class="mpre">
    </span><a name="loc_567_5_567_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_5_567_15&#39;)"><span class="hl_vardecl"><span class="mpre">fieldNames</span></span></a><span class="mpre">  &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_563_23_563_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_23_563_33&#39;)"><span class="hl_varref"><span class="mpre">fieldTypes</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;x&quot;</span></span><span class="mpre">)

    </span><span class="hl_comment"><span class="mpre">-- Compute the type: Constructor Constraints =&gt; Review s (Type x y z) a fieldTypes</span></span><span class="mpre">
    let </span><a name="loc_570_9_570_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_9_570_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">                = </span><a href="Language.Haskell.TH.Lib.html#loc_507_1_507_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_507_1_507_5&#39;)"><span class="hl_varref"><span class="mpre">varT</span></span></a><span class="mpre"> </span><a href="#loc_565_5_565_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_5_565_10&#39;)"><span class="hl_varref"><span class="mpre">sName</span></span></a><span class="mpre">
        </span><a name="loc_571_9_571_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_571_9_571_10&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">                = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_759_5_759_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_5_759_13&#39;)"><span class="hl_varref"><span class="mpre">fullType</span></span></a><span class="mpre"> </span><a href="#loc_561_18_561_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_18_561_26&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">VarT</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">) (</span><a href="#loc_758_5_758_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_5_758_19&#39;)"><span class="hl_varref"><span class="mpre">dataParameters</span></span></a><span class="mpre"> </span><a href="#loc_561_18_561_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_18_561_26&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">)))
        </span><a name="loc_572_9_572_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_9_572_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">                = </span><a href="Language.Haskell.TH.Lib.html#loc_507_1_507_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_507_1_507_5&#39;)"><span class="hl_varref"><span class="mpre">varT</span></span></a><span class="mpre"> </span><a href="#loc_566_5_566_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_566_5_566_10&#39;)"><span class="hl_varref"><span class="mpre">aName</span></span></a><span class="mpre">
        </span><a name="loc_573_9_573_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_9_573_10&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">                = </span><a href="Control.Lens.Internal.TH.html#loc_38_1_38_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_38_1_38_9&#39;)"><span class="hl_varref"><span class="mpre">toTupleT</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_563_23_563_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_23_563_33&#39;)"><span class="hl_varref"><span class="mpre">fieldTypes</span></span></a><span class="mpre">)

        (</span><a name="loc_575_10_575_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_10_575_19&#39;)"><span class="hl_vardecl"><span class="mpre">conTyVars</span></span></a><span class="mpre">, </span><a name="loc_575_21_575_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_21_575_27&#39;)"><span class="hl_vardecl"><span class="mpre">conCxt</span></span></a><span class="mpre">) = case </span><a href="#loc_561_27_561_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_27_561_30&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre"> of </span><span class="hl_conref"><span class="mpre">ForallC</span></span><span class="mpre"> </span><a name="loc_575_51_575_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_51_575_52&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_575_53_575_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_53_575_54&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> _ -&gt; (</span><a href="#loc_575_51_575_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_51_575_52&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_575_53_575_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_53_575_54&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
                                          _             -&gt; ([],[])

        </span><a name="loc_578_9_578_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_578_9_578_21&#39;)"><span class="hl_vardecl"><span class="mpre">functionType</span></span></a><span class="mpre">     = </span><a href="Language.Haskell.TH.Lib.html#loc_501_1_501_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_501_1_501_8&#39;)"><span class="hl_varref"><span class="mpre">forallT</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">PlainTV</span></span><span class="mpre"> [</span><a href="#loc_565_5_565_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_5_565_10&#39;)"><span class="hl_varref"><span class="mpre">sName</span></span></a><span class="mpre">, </span><a href="#loc_566_5_566_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_566_5_566_10&#39;)"><span class="hl_varref"><span class="mpre">aName</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_575_10_575_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_10_575_19&#39;)"><span class="hl_varref"><span class="mpre">conTyVars</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_758_5_758_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_5_758_19&#39;)"><span class="hl_varref"><span class="mpre">dataParameters</span></span></a><span class="mpre"> </span><a href="#loc_561_18_561_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_18_561_26&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">)
                                   (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_575_21_575_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_575_21_575_27&#39;)"><span class="hl_varref"><span class="mpre">conCxt</span></span></a><span class="mpre">)
                                   (</span><a href="Language.Haskell.TH.Lib.html#loc_510_1_510_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_510_1_510_5&#39;)"><span class="hl_varref"><span class="mpre">conT</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 580, srcSpanStartColumn = 42, srcSpanEndLine = 580, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 580, srcSpanStartColumn = 42, srcSpanEndLine = 580, srcSpanEndColumn = 44}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;&#39;Review</span></span><span class="mpre"> </span><a href="Control.Lens.Internal.TH.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">`appsT`</span></span></a><span class="mpre"> [</span><a href="#loc_570_9_570_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_9_570_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">,</span><a href="#loc_571_9_571_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_571_9_571_10&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">,</span><a href="#loc_572_9_572_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_9_572_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_573_9_573_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_9_573_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">])

    </span><span class="hl_comment"><span class="mpre">-- Compute expression: unto (\(fields) -&gt; Con fields)</span></span><span class="mpre">
    let </span><a name="loc_583_9_583_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_9_583_12&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">  = </span><a href="Control.Lens.Internal.TH.html#loc_46_1_46_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_46_1_46_9&#39;)"><span class="hl_varref"><span class="mpre">toTupleP</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_567_5_567_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_5_567_15&#39;)"><span class="hl_varref"><span class="mpre">fieldNames</span></span></a><span class="mpre">)
        </span><a name="loc_584_9_584_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_9_584_12&#39;)"><span class="hl_vardecl"><span class="mpre">lam</span></span></a><span class="mpre">  = </span><a href="Language.Haskell.TH.Lib.html#loc_249_1_249_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_249_1_249_6&#39;)"><span class="hl_varref"><span class="mpre">lam1E</span></span></a><span class="mpre"> </span><a href="#loc_583_9_583_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_9_583_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_211_1_211_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_211_1_211_5&#39;)"><span class="hl_varref"><span class="mpre">conE</span></span></a><span class="mpre"> </span><a href="#loc_563_10_563_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_10_563_21&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre"> </span><a href="Control.Lens.Internal.TH.html#loc_35_1_35_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_35_1_35_7&#39;)"><span class="hl_infix"><span class="mpre">`appsE1`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_567_5_567_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_5_567_15&#39;)"><span class="hl_varref"><span class="mpre">fieldNames</span></span></a><span class="mpre">)
        </span><a name="loc_585_9_585_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_9_585_13&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 585, srcSpanStartColumn = 21, srcSpanEndLine = 585, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 585, srcSpanStartColumn = 21, srcSpanEndLine = 585, srcSpanEndColumn = 22}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;unto</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_217_1_217_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_217_1_217_5&#39;)"><span class="hl_infix"><span class="mpre">`appE`</span></span></a><span class="mpre"> </span><a href="#loc_584_9_584_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_9_584_12&#39;)"><span class="hl_varref"><span class="mpre">lam</span></span></a><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">Prelude.sequence</span></span><span class="mpre">
      [ </span><a href="Language.Haskell.TH.Lib.html#loc_364_1_364_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_364_1_364_5&#39;)"><span class="hl_varref"><span class="mpre">sigD</span></span></a><span class="mpre"> </span><a href="#loc_562_9_562_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_9_562_21&#39;)"><span class="hl_varref"><span class="mpre">functionName</span></span></a><span class="mpre"> </span><a href="#loc_578_9_578_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_578_9_578_21&#39;)"><span class="hl_varref"><span class="mpre">functionType</span></span></a><span class="mpre">
      , </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_562_9_562_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_9_562_21&#39;)"><span class="hl_varref"><span class="mpre">functionName</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [] (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> </span><a href="#loc_585_9_585_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_9_585_13&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">) []]
      ]

</span><a href="#loc_593_1_593_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_1_593_16&#39;)"><span class="mpre">makePrismForCon</span></a><span class="mpre"> :: </span><a href="#loc_754_6_754_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_6_754_14&#39;)"><span class="hl_tyconref"><span class="mpre">DataDecl</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">TyVarBndr</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_593_1_593_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_1_593_16&#39;)"><span class="hl_fundecl"><span class="mpre">makePrismForCon</span></span></a><span class="mpre"> </span><a name="loc_593_17_593_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_17_593_25&#39;)"><span class="hl_vardecl"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><a name="loc_593_26_593_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_26_593_42&#39;)"><span class="hl_vardecl"><span class="mpre">canModifyTypeVar</span></span></a><span class="mpre"> </span><a name="loc_593_43_593_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_43_593_46&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre"> = do
    </span><a name="loc_594_5_594_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_5_594_17&#39;)"><span class="hl_vardecl"><span class="mpre">remitterName</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;remitter&quot;</span></span><span class="mpre">
    </span><a name="loc_595_5_595_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_595_5_595_17&#39;)"><span class="hl_vardecl"><span class="mpre">reviewerName</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;reviewer&quot;</span></span><span class="mpre">
    </span><a name="loc_596_5_596_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_5_596_10&#39;)"><span class="hl_vardecl"><span class="mpre">xName</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;x&quot;</span></span><span class="mpre">
    let </span><a name="loc_597_9_597_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_9_597_16&#39;)"><span class="hl_vardecl"><span class="mpre">resName</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_637_6_637_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_6_637_17&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre">
    </span><a name="loc_598_5_598_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_5_598_13&#39;)"><span class="hl_vardecl"><span class="mpre">varNames</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Traversable.html#loc_210_1_210_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_210_1_210_4&#39;)"><span class="hl_varref"><span class="mpre">for</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 598, srcSpanStartColumn = 21, srcSpanEndLine = 598, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 598, srcSpanStartColumn = 21, srcSpanEndLine = 598, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 59"><span class="mpre">[0..length fieldTypes -1]</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_598_50_598_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_50_598_51&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;x&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_598_50_598_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_50_598_51&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
    let </span><a name="loc_599_9_599_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_9_599_13&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> = </span><a href="#loc_758_5_758_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_5_758_19&#39;)"><span class="hl_varref"><span class="mpre">dataParameters</span></span></a><span class="mpre"> </span><a href="#loc_593_17_593_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_17_593_25&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">
    </span><a name="loc_600_5_600_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_5_600_16&#39;)"><span class="hl_vardecl"><span class="mpre">altArgsList</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Traversable.html#loc_215_1_215_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_215_1_215_5&#39;)"><span class="hl_varref"><span class="mpre">forM</span></span></a><span class="mpre"> (</span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> </span><a href="#loc_639_5_639_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_5_639_13&#39;)"><span class="hl_varref"><span class="mpre">isAltArg</span></span></a><span class="mpre"> </span><a href="#loc_599_9_599_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_9_599_13&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_600_65_600_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_65_600_68&#39;)"><span class="hl_vardecl"><span class="mpre">arg</span></span></a><span class="mpre"> -&gt;
      </span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> </span><a href="#loc_600_65_600_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_65_600_68&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_600_65_600_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_65_600_68&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre">)
    let </span><a name="loc_602_9_602_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_602_9_602_16&#39;)"><span class="hl_vardecl"><span class="mpre">altArgs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">Map.fromList</span></span><span class="mpre"> </span><a href="#loc_600_5_600_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_5_600_16&#39;)"><span class="hl_varref"><span class="mpre">altArgsList</span></span></a><span class="mpre">
        </span><a name="loc_603_9_603_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_603_9_603_18&#39;)"><span class="hl_vardecl"><span class="mpre">hitClause</span></span></a><span class="mpre"> =
          </span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_76_1_76_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_76_1_76_5&#39;)"><span class="hl_varref"><span class="mpre">conP</span></span></a><span class="mpre"> </span><a href="#loc_637_6_637_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_6_637_17&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_598_5_598_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_5_598_13&#39;)"><span class="hl_varref"><span class="mpre">varNames</span></span></a><span class="mpre">)]
          (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_217_1_217_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_217_1_217_5&#39;)"><span class="hl_varref"><span class="mpre">appE</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_211_1_211_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_211_1_211_5&#39;)"><span class="hl_varref"><span class="mpre">conE</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 605, srcSpanStartColumn = 33, srcSpanEndLine = 605, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 605, srcSpanStartColumn = 33, srcSpanEndLine = 605, srcSpanEndColumn = 34}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;Right</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Lens.Internal.TH.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">toTupleE</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_598_5_598_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_5_598_13&#39;)"><span class="hl_varref"><span class="mpre">varNames</span></span></a><span class="mpre">) []
        </span><a name="loc_606_9_606_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_9_606_18&#39;)"><span class="hl_vardecl"><span class="mpre">otherCons</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_593_43_593_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_43_593_46&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">) (</span><a href="#loc_762_5_762_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_762_5_762_17&#39;)"><span class="hl_varref"><span class="mpre">constructors</span></span></a><span class="mpre"> </span><a href="#loc_593_17_593_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_17_593_25&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">)
        </span><a name="loc_607_9_607_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_9_607_20&#39;)"><span class="hl_vardecl"><span class="mpre">missClauses</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> </span><a href="#loc_606_9_606_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_9_606_18&#39;)"><span class="hl_varref"><span class="mpre">otherCons</span></span></a><span class="mpre">   = []
          | </span><span class="hl_varref"><span class="mpre">Map.null</span></span><span class="mpre"> </span><a href="#loc_602_9_602_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_602_9_602_16&#39;)"><span class="hl_varref"><span class="mpre">altArgs</span></span></a><span class="mpre"> = [</span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_596_5_596_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_5_596_10&#39;)"><span class="hl_varref"><span class="mpre">xName</span></span></a><span class="mpre">] (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_217_1_217_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_217_1_217_5&#39;)"><span class="hl_varref"><span class="mpre">appE</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_211_1_211_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_211_1_211_5&#39;)"><span class="hl_varref"><span class="mpre">conE</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 609, srcSpanStartColumn = 74, srcSpanEndLine = 609, srcSpanEndColumn = 79}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 609, srcSpanStartColumn = 74, srcSpanEndLine = 609, srcSpanEndColumn = 75}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;Left</span></span><span class="mpre">) (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_596_5_596_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_5_596_10&#39;)"><span class="hl_varref"><span class="mpre">xName</span></span></a><span class="mpre">))) []]
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">        = </span><a href="#loc_650_1_650_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_1_650_17&#39;)"><span class="hl_varref"><span class="mpre">reviewerIdClause</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_606_9_606_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_9_606_18&#39;)"><span class="hl_varref"><span class="mpre">otherCons</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">Prelude.sequence</span></span><span class="mpre"> [
      </span><a href="Language.Haskell.TH.Lib.html#loc_364_1_364_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_364_1_364_5&#39;)"><span class="hl_varref"><span class="mpre">sigD</span></span></a><span class="mpre"> </span><a href="#loc_597_9_597_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_9_597_16&#39;)"><span class="hl_varref"><span class="mpre">resName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_501_1_501_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_501_1_501_8&#39;)"><span class="hl_varref"><span class="mpre">forallT</span></span></a><span class="mpre">
        (</span><a href="#loc_599_9_599_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_9_599_13&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">PlainTV</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Map.elems</span></span><span class="mpre"> </span><a href="#loc_602_9_602_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_602_9_602_16&#39;)"><span class="hl_varref"><span class="mpre">altArgs</span></span></a><span class="mpre">))
        (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.List.html#loc_314_1_314_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_314_1_314_4&#39;)"><span class="hl_varref"><span class="mpre">List.nub</span></span></a><span class="mpre"> (</span><a href="#loc_755_5_755_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_755_5_755_16&#39;)"><span class="hl_varref"><span class="mpre">dataContext</span></span></a><span class="mpre"> </span><a href="#loc_593_17_593_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_17_593_25&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_350_1_350_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_350_1_350_14&#39;)"><span class="hl_varref"><span class="mpre">substTypeVars</span></span></a><span class="mpre"> </span><a href="#loc_602_9_602_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_602_9_602_16&#39;)"><span class="hl_varref"><span class="mpre">altArgs</span></span></a><span class="mpre"> (</span><a href="#loc_755_5_755_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_755_5_755_16&#39;)"><span class="hl_varref"><span class="mpre">dataContext</span></span></a><span class="mpre"> </span><a href="#loc_593_17_593_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_17_593_25&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">))) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
         if </span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> </span><a href="#loc_600_5_600_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_5_600_16&#39;)"><span class="hl_varref"><span class="mpre">altArgsList</span></span></a><span class="mpre"> then
          </span><a href="Language.Haskell.TH.Lib.html#loc_510_1_510_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_510_1_510_5&#39;)"><span class="hl_varref"><span class="mpre">conT</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 616, srcSpanStartColumn = 16, srcSpanEndLine = 616, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 616, srcSpanStartColumn = 16, srcSpanEndLine = 616, srcSpanEndColumn = 18}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;&#39;Prism&#39;</span></span><span class="mpre"> </span><a href="Control.Lens.Internal.TH.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">`appsT`</span></span></a><span class="mpre">
            [ </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_759_5_759_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_5_759_13&#39;)"><span class="hl_varref"><span class="mpre">fullType</span></span></a><span class="mpre"> </span><a href="#loc_593_17_593_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_17_593_25&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">VarT</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_599_9_599_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_9_599_13&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">
            , </span><a href="Control.Lens.Internal.TH.html#loc_38_1_38_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_38_1_38_9&#39;)"><span class="hl_varref"><span class="mpre">toTupleT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_varref"><span class="mpre">pure</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_637_19_637_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_19_637_29&#39;)"><span class="hl_varref"><span class="mpre">fieldTypes</span></span></a><span class="mpre">
            ]
         else
          </span><a href="Language.Haskell.TH.Lib.html#loc_510_1_510_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_510_1_510_5&#39;)"><span class="hl_varref"><span class="mpre">conT</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 621, srcSpanStartColumn = 16, srcSpanEndLine = 621, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 621, srcSpanStartColumn = 16, srcSpanEndLine = 621, srcSpanEndColumn = 18}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;&#39;Prism</span></span><span class="mpre"> </span><a href="Control.Lens.Internal.TH.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">`appsT`</span></span></a><span class="mpre">
            [ </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_759_5_759_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_5_759_13&#39;)"><span class="hl_varref"><span class="mpre">fullType</span></span></a><span class="mpre"> </span><a href="#loc_593_17_593_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_17_593_25&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">VarT</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_599_9_599_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_9_599_13&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">
            , </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_759_5_759_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_5_759_13&#39;)"><span class="hl_varref"><span class="mpre">fullType</span></span></a><span class="mpre"> </span><a href="#loc_593_17_593_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_17_593_25&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">VarT</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_350_1_350_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_350_1_350_14&#39;)"><span class="hl_varref"><span class="mpre">substTypeVars</span></span></a><span class="mpre"> </span><a href="#loc_602_9_602_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_602_9_602_16&#39;)"><span class="hl_varref"><span class="mpre">altArgs</span></span></a><span class="mpre"> </span><a href="#loc_599_9_599_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_9_599_13&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">
            , </span><a href="Control.Lens.Internal.TH.html#loc_38_1_38_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_38_1_38_9&#39;)"><span class="hl_varref"><span class="mpre">toTupleT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_varref"><span class="mpre">pure</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_637_19_637_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_19_637_29&#39;)"><span class="hl_varref"><span class="mpre">fieldTypes</span></span></a><span class="mpre">
            , </span><a href="Control.Lens.Internal.TH.html#loc_38_1_38_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_38_1_38_9&#39;)"><span class="hl_varref"><span class="mpre">toTupleT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_varref"><span class="mpre">pure</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_350_1_350_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_350_1_350_14&#39;)"><span class="hl_varref"><span class="mpre">substTypeVars</span></span></a><span class="mpre"> </span><a href="#loc_602_9_602_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_602_9_602_16&#39;)"><span class="hl_varref"><span class="mpre">altArgs</span></span></a><span class="mpre"> </span><a href="#loc_637_19_637_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_19_637_29&#39;)"><span class="hl_varref"><span class="mpre">fieldTypes</span></span></a><span class="mpre">
            ]
      , </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_597_9_597_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_9_597_16&#39;)"><span class="hl_varref"><span class="mpre">resName</span></span></a><span class="mpre">
        [ </span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> []
          (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_656_1_656_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_656_1_656_6&#39;)"><span class="hl_varref"><span class="mpre">appsE</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 629, srcSpanStartColumn = 33, srcSpanEndLine = 629, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 629, srcSpanStartColumn = 33, srcSpanEndLine = 629, srcSpanEndColumn = 34}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;prism</span></span><span class="mpre">, </span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_594_5_594_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_5_594_17&#39;)"><span class="hl_varref"><span class="mpre">remitterName</span></span></a><span class="mpre">, </span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_595_5_595_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_595_5_595_17&#39;)"><span class="hl_varref"><span class="mpre">reviewerName</span></span></a><span class="mpre">]))
          [ </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_594_5_594_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_5_594_17&#39;)"><span class="hl_varref"><span class="mpre">remitterName</span></span></a><span class="mpre">
            [ </span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [</span><a href="Control.Lens.Internal.TH.html#loc_46_1_46_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_46_1_46_9&#39;)"><span class="hl_varref"><span class="mpre">toTupleP</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_598_5_598_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_5_598_13&#39;)"><span class="hl_varref"><span class="mpre">varNames</span></span></a><span class="mpre">)] (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_211_1_211_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_211_1_211_5&#39;)"><span class="hl_varref"><span class="mpre">conE</span></span></a><span class="mpre"> </span><a href="#loc_637_6_637_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_6_637_17&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre"> </span><a href="Control.Lens.Internal.TH.html#loc_35_1_35_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_35_1_35_7&#39;)"><span class="hl_infix"><span class="mpre">`appsE1`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_598_5_598_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_5_598_13&#39;)"><span class="hl_varref"><span class="mpre">varNames</span></span></a><span class="mpre">)) [] ]
          , </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_595_5_595_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_595_5_595_17&#39;)"><span class="hl_varref"><span class="mpre">reviewerName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_603_9_603_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_603_9_603_18&#39;)"><span class="hl_varref"><span class="mpre">hitClause</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_607_9_607_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_9_607_20&#39;)"><span class="hl_varref"><span class="mpre">missClauses</span></span></a><span class="mpre">
          ]
        ]
      ]
  where
    (</span><a name="loc_637_6_637_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_6_637_17&#39;)"><span class="hl_vardecl"><span class="mpre">dataConName</span></span></a><span class="mpre">, </span><a name="loc_637_19_637_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_19_637_29&#39;)"><span class="hl_vardecl"><span class="mpre">fieldTypes</span></span></a><span class="mpre">) = </span><a href="#loc_642_1_642_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_1_642_21&#39;)"><span class="hl_varref"><span class="mpre">ctrNameAndFieldTypes</span></span></a><span class="mpre"> </span><a href="#loc_593_43_593_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_43_593_46&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">
    </span><a name="loc_638_5_638_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_638_5_638_12&#39;)"><span class="hl_vardecl"><span class="mpre">conArgs</span></span></a><span class="mpre"> = </span><a href="Data.Set.Lens.html#loc_55_1_55_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Set.Lens.html#loc_55_1_55_6&#39;)"><span class="hl_varref"><span class="mpre">setOf</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_346_1_346_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_346_1_346_9&#39;)"><span class="hl_varref"><span class="mpre">typeVars</span></span></a><span class="mpre"> </span><a href="#loc_637_19_637_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_637_19_637_29&#39;)"><span class="hl_varref"><span class="mpre">fieldTypes</span></span></a><span class="mpre">
    </span><a name="loc_639_5_639_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_5_639_13&#39;)"><span class="hl_fundecl"><span class="mpre">isAltArg</span></span></a><span class="mpre"> </span><a name="loc_639_14_639_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_14_639_17&#39;)"><span class="hl_vardecl"><span class="mpre">arg</span></span></a><span class="mpre"> = </span><a href="#loc_593_26_593_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_26_593_42&#39;)"><span class="hl_varref"><span class="mpre">canModifyTypeVar</span></span></a><span class="mpre"> </span><a href="#loc_639_14_639_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_14_639_17&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_638_5_638_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_638_5_638_12&#39;)"><span class="hl_varref"><span class="mpre">conArgs</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre">(</span><a href="#loc_639_14_639_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_14_639_17&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">)

</span><a href="#loc_642_1_642_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_1_642_21&#39;)"><span class="mpre">ctrNameAndFieldTypes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">, [</span><span class="hl_tyconref"><span class="mpre">Type</span></span><span class="mpre">])
</span><a name="loc_642_1_642_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_1_642_21&#39;)"><span class="hl_fundecl"><span class="mpre">ctrNameAndFieldTypes</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">NormalC</span></span><span class="mpre"> </span><a name="loc_642_31_642_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_31_642_32&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_642_33_642_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_33_642_35&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">) = (</span><a href="#loc_642_31_642_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_31_642_32&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_642_33_642_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_33_642_35&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">)
</span><a href="#loc_642_1_642_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_1_642_21&#39;)"><span class="hl_fundecl"><span class="mpre">ctrNameAndFieldTypes</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">RecC</span></span><span class="mpre"> </span><a name="loc_643_28_643_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_643_28_643_29&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_643_30_643_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_643_30_643_32&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">) = (</span><a href="#loc_643_28_643_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_643_28_643_29&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">_3</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_643_30_643_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_643_30_643_32&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">)
</span><a href="#loc_642_1_642_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_1_642_21&#39;)"><span class="hl_fundecl"><span class="mpre">ctrNameAndFieldTypes</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">InfixC</span></span><span class="mpre"> </span><a name="loc_644_30_644_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_30_644_31&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_644_32_644_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_32_644_33&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_644_34_644_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_34_644_35&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = (</span><a href="#loc_644_32_644_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_32_644_33&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, [</span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_644_30_644_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_30_644_31&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_644_34_644_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_34_644_35&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">])
</span><a href="#loc_642_1_642_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_1_642_21&#39;)"><span class="hl_fundecl"><span class="mpre">ctrNameAndFieldTypes</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ForallC</span></span><span class="mpre"> _ _ </span><a name="loc_645_35_645_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_35_645_36&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) = </span><a href="#loc_642_1_642_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_1_642_21&#39;)"><span class="hl_varref"><span class="mpre">ctrNameAndFieldTypes</span></span></a><span class="mpre"> </span><a href="#loc_645_35_645_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_645_35_645_36&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- When a &#39;Prism&#39; can change type variables it needs to pattern match on all</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- other data constructors and rebuild the data so it will have the new type.</span></span><span class="mpre">
</span><a href="#loc_650_1_650_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_1_650_17&#39;)"><span class="mpre">reviewerIdClause</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ClauseQ</span></span><span class="mpre">
</span><a name="loc_650_1_650_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_1_650_17&#39;)"><span class="hl_fundecl"><span class="mpre">reviewerIdClause</span></span></a><span class="mpre"> </span><a name="loc_650_18_650_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_18_650_21&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre"> = do
  let (</span><a name="loc_651_8_651_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_651_8_651_19&#39;)"><span class="hl_vardecl"><span class="mpre">dataConName</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">fieldTypes</span></span><span class="mpre">) = </span><a href="#loc_642_1_642_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_1_642_21&#39;)"><span class="hl_varref"><span class="mpre">ctrNameAndFieldTypes</span></span></a><span class="mpre"> </span><a href="#loc_650_18_650_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_18_650_21&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">
  </span><a name="loc_652_3_652_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_3_652_11&#39;)"><span class="hl_vardecl"><span class="mpre">varNames</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Traversable.html#loc_210_1_210_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_210_1_210_4&#39;)"><span class="hl_varref"><span class="mpre">for</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 652, srcSpanStartColumn = 19, srcSpanEndLine = 652, srcSpanEndColumn = 47}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 652, srcSpanStartColumn = 19, srcSpanEndLine = 652, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 65"><span class="mpre">[0 .. length fieldTypes - 1]</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_652_51_652_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_51_652_52&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> -&gt;
                </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;x&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_652_51_652_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_51_652_52&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
  </span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_76_1_76_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_76_1_76_5&#39;)"><span class="hl_varref"><span class="mpre">conP</span></span></a><span class="mpre"> </span><a href="#loc_651_8_651_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_651_8_651_19&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_652_3_652_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_3_652_11&#39;)"><span class="hl_varref"><span class="mpre">varNames</span></span></a><span class="mpre">)]
         (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_217_1_217_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_217_1_217_5&#39;)"><span class="hl_varref"><span class="mpre">appE</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_211_1_211_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_211_1_211_5&#39;)"><span class="hl_varref"><span class="mpre">conE</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 655, srcSpanStartColumn = 31, srcSpanEndLine = 655, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 655, srcSpanStartColumn = 31, srcSpanEndLine = 655, srcSpanEndColumn = 32}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;Left</span></span><span class="mpre">) (</span><a href="Language.Haskell.TH.Lib.html#loc_211_1_211_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_211_1_211_5&#39;)"><span class="hl_varref"><span class="mpre">conE</span></span></a><span class="mpre"> </span><a href="#loc_651_8_651_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_651_8_651_19&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre"> </span><a href="Control.Lens.Internal.TH.html#loc_35_1_35_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_35_1_35_7&#39;)"><span class="hl_infix"><span class="mpre">`appsE1`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_652_3_652_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_652_3_652_11&#39;)"><span class="hl_varref"><span class="mpre">varNames</span></span></a><span class="mpre">)))
         []

</span><span class="hl_comment"><span class="mpre">-- | Given a set of names, build a map from those names to a set of fresh names</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- based on them.</span></span><span class="mpre">
</span><a href="#loc_661_1_661_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_1_661_9&#39;)"><span class="mpre">freshMap</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Set</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Map</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">)
</span><a name="loc_661_1_661_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_1_661_9&#39;)"><span class="hl_fundecl"><span class="mpre">freshMap</span></span></a><span class="mpre"> </span><a name="loc_661_10_661_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_10_661_12&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">Map.fromList</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Data.Traversable.html#loc_210_1_210_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_210_1_210_4&#39;)"><span class="hl_varref"><span class="mpre">for</span></span></a><span class="mpre"> (</span><a href="Data.Foldable.html#loc_264_1_264_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Foldable.html#loc_264_1_264_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_661_10_661_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_10_661_12&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">) (\ </span><a name="loc_661_51_661_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_51_661_52&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> </span><a href="#loc_661_51_661_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_51_661_52&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_661_51_661_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_51_661_52&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- i.e. AppT (AppT (TupleT 2) (ConT GHC.Types.Int)) (ConT GHC.Base.String)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- --&gt; (\(x, y) -&gt; Rect x y)</span></span><span class="mpre">
</span><a href="#loc_666_1_666_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_666_1_666_12&#39;)"><span class="mpre">makeIsoFrom</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Type</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> ([</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">], </span><span class="hl_tyconref"><span class="mpre">Exp</span></span><span class="mpre">)
</span><a name="loc_666_1_666_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_666_1_666_12&#39;)"><span class="hl_fundecl"><span class="mpre">makeIsoFrom</span></span></a><span class="mpre"> </span><a name="loc_666_13_666_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_666_13_666_15&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre"> </span><a name="loc_666_16_666_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_666_16_666_23&#39;)"><span class="hl_vardecl"><span class="mpre">conName</span></span></a><span class="mpre"> = </span><a href="#loc_668_5_668_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_5_668_8&#39;)"><span class="hl_varref"><span class="mpre">lam</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_669_5_669_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_669_5_669_10&#39;)"><span class="hl_varref"><span class="mpre">deCom</span></span></a><span class="mpre"> </span><a href="#loc_666_13_666_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_666_13_666_15&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre">
  where
    </span><a name="loc_668_5_668_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_5_668_8&#39;)"><span class="hl_fundecl"><span class="mpre">lam</span></span></a><span class="mpre"> (</span><a name="loc_668_10_668_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_10_668_12&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre">, </span><a name="loc_668_14_668_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_14_668_15&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) = (</span><a href="#loc_668_10_668_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_10_668_12&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">LamE</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">TupP</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">VarP</span></span><span class="mpre"> </span><a href="#loc_668_10_668_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_10_668_12&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">)] </span><a href="#loc_668_14_668_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_668_14_668_15&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
    </span><a name="loc_669_5_669_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_669_5_669_10&#39;)"><span class="hl_fundecl"><span class="mpre">deCom</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">TupleT</span></span><span class="mpre"> _) = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> ([], </span><span class="hl_conref"><span class="mpre">ConE</span></span><span class="mpre"> </span><a href="#loc_666_16_666_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_666_16_666_23&#39;)"><span class="hl_varref"><span class="mpre">conName</span></span></a><span class="mpre">)
    </span><a href="#loc_669_5_669_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_669_5_669_10&#39;)"><span class="hl_fundecl"><span class="mpre">deCom</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">AppT</span></span><span class="mpre"> </span><a name="loc_670_17_670_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_670_17_670_18&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> _) = do
      (</span><a name="loc_671_8_671_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_8_671_10&#39;)"><span class="hl_vardecl"><span class="mpre">ln</span></span></a><span class="mpre">, </span><a name="loc_671_12_671_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_12_671_14&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_669_5_669_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_669_5_669_10&#39;)"><span class="hl_varref"><span class="mpre">deCom</span></span></a><span class="mpre"> </span><a href="#loc_670_17_670_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_670_17_670_18&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
      </span><a name="loc_672_7_672_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_672_7_672_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;x&quot;</span></span><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_671_8_671_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_8_671_10&#39;)"><span class="hl_varref"><span class="mpre">ln</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_672_7_672_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_672_7_672_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">], </span><span class="hl_conref"><span class="mpre">AppE</span></span><span class="mpre"> </span><a href="#loc_671_12_671_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_671_12_671_14&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">VarE</span></span><span class="mpre"> </span><a href="#loc_672_7_672_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_672_7_672_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">))
    </span><a href="#loc_669_5_669_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_669_5_669_10&#39;)"><span class="hl_fundecl"><span class="mpre">deCom</span></span></a><span class="mpre"> </span><a name="loc_674_11_674_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_11_674_12&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unable to create isomorphism for: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_674_11_674_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_674_11_674_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- i.e. AppT (AppT (TupleT 2) (ConT GHC.Types.Int)) (ConT GHC.Base.String)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- --&gt; (\(Rect x y) -&gt; (x, y))</span></span><span class="mpre">
</span><a href="#loc_679_1_679_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_1_679_10&#39;)"><span class="mpre">makeIsoTo</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ExpQ</span></span><span class="mpre">
</span><a name="loc_679_1_679_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_1_679_10&#39;)"><span class="hl_fundecl"><span class="mpre">makeIsoTo</span></span></a><span class="mpre"> </span><a name="loc_679_11_679_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_11_679_13&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre"> </span><a name="loc_679_14_679_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_14_679_21&#39;)"><span class="hl_vardecl"><span class="mpre">conName</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_243_1_243_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_243_1_243_5&#39;)"><span class="hl_varref"><span class="mpre">lamE</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_76_1_76_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_76_1_76_5&#39;)"><span class="hl_varref"><span class="mpre">conP</span></span></a><span class="mpre"> </span><a href="#loc_679_14_679_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_14_679_21&#39;)"><span class="hl_varref"><span class="mpre">conName</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_679_11_679_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_11_679_13&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">)]
                          </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_255_1_255_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_255_1_255_5&#39;)"><span class="hl_varref"><span class="mpre">tupE</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_679_11_679_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_11_679_13&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">

</span><a href="#loc_683_1_683_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_1_683_12&#39;)"><span class="mpre">makeIsoBody</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Exp</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Exp</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DecQ</span></span><span class="mpre">
</span><a name="loc_683_1_683_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_1_683_12&#39;)"><span class="hl_fundecl"><span class="mpre">makeIsoBody</span></span></a><span class="mpre"> </span><a name="loc_683_13_683_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_13_683_21&#39;)"><span class="hl_vardecl"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><a name="loc_683_22_683_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_22_683_23&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_683_24_683_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_24_683_25&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_683_13_683_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_13_683_21&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [] (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> </span><a href="#loc_684_3_684_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_3_684_7&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">) []] where
  </span><a name="loc_684_3_684_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_684_3_684_7&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_656_1_656_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_656_1_656_6&#39;)"><span class="hl_varref"><span class="mpre">appsE</span></span></a><span class="mpre"> [ </span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 684, srcSpanStartColumn = 23, srcSpanEndLine = 684, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 684, srcSpanStartColumn = 23, srcSpanEndLine = 684, srcSpanEndColumn = 24}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;iso</span></span><span class="mpre">
               , </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_683_22_683_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_22_683_23&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
               , </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_683_24_683_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_24_683_25&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
               ]

</span><a href="#loc_690_1_690_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_1_690_13&#39;)"><span class="mpre">makeLensBody</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Exp</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Exp</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DecQ</span></span><span class="mpre">
</span><a name="loc_690_1_690_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_1_690_13&#39;)"><span class="hl_fundecl"><span class="mpre">makeLensBody</span></span></a><span class="mpre"> </span><a name="loc_690_14_690_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_14_690_22&#39;)"><span class="hl_vardecl"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><a name="loc_690_23_690_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_23_690_24&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_690_25_690_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_25_690_26&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> = do
  </span><a name="loc_691_3_691_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_3_691_4&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;f&quot;</span></span><span class="mpre">
  </span><a name="loc_692_3_692_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_692_3_692_4&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;a&quot;</span></span><span class="mpre">
  </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_690_14_690_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_14_690_22&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [] (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> (
    </span><a href="Language.Haskell.TH.Lib.html#loc_243_1_243_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_243_1_243_5&#39;)"><span class="hl_varref"><span class="mpre">lamE</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_691_3_691_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_3_691_4&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">, </span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_692_3_692_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_692_3_692_4&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
      </span><a href="Language.Haskell.TH.Lib.html#loc_656_1_656_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_656_1_656_6&#39;)"><span class="hl_varref"><span class="mpre">appsE</span></span></a><span class="mpre"> [ </span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 695, srcSpanStartColumn = 20, srcSpanEndLine = 695, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 695, srcSpanStartColumn = 20, srcSpanEndLine = 695, srcSpanEndColumn = 21}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;fmap</span></span><span class="mpre">
            , </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_690_25_690_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_25_690_26&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">
            , </span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_691_3_691_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_691_3_691_4&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_217_1_217_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_217_1_217_5&#39;)"><span class="hl_infix"><span class="mpre">`appE`</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_690_23_690_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_23_690_24&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_217_1_217_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_217_1_217_5&#39;)"><span class="hl_infix"><span class="mpre">`appE`</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_692_3_692_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_692_3_692_4&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
            ])) []]

</span><a href="#loc_701_1_701_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_1_701_6&#39;)"><span class="mpre">plain</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TyVarBndr</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">TyVarBndr</span></span><span class="mpre">
</span><a name="loc_701_1_701_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_1_701_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">KindedTV</span></span><span class="mpre"> </span><a name="loc_701_17_701_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_17_701_18&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> _) = </span><span class="hl_conref"><span class="mpre">PlainTV</span></span><span class="mpre"> </span><a href="#loc_701_17_701_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_17_701_18&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
</span><a href="#loc_701_1_701_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_1_701_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">PlainTV</span></span><span class="mpre"> </span><a name="loc_702_16_702_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_702_16_702_17&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">PlainTV</span></span><span class="mpre"> </span><a href="#loc_702_16_702_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_702_16_702_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><a href="#loc_705_1_705_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_5&#39;)"><span class="mpre">apps</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Type</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Type</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Type</span></span><span class="mpre">
</span><a name="loc_705_1_705_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_5&#39;)"><span class="hl_vardecl"><span class="mpre">apps</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">Prelude.foldl</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">AppT</span></span><span class="mpre">

</span><a href="#loc_708_1_708_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_1_708_17&#39;)"><span class="mpre">makeLensesForDec</span></a><span class="mpre"> :: </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_708_1_708_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_1_708_17&#39;)"><span class="hl_fundecl"><span class="mpre">makeLensesForDec</span></span></a><span class="mpre"> </span><a name="loc_708_18_708_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_18_708_21&#39;)"><span class="hl_vardecl"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a name="loc_708_22_708_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_22_708_26&#39;)"><span class="hl_vardecl"><span class="mpre">decl</span></span></a><span class="mpre"> = case </span><a href="#loc_726_1_726_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_1_726_13&#39;)"><span class="hl_varref"><span class="mpre">makeDataDecl</span></span></a><span class="mpre"> </span><a href="#loc_708_22_708_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_22_708_26&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre"> of
  </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_709_8_709_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_709_8_709_16&#39;)"><span class="hl_vardecl"><span class="mpre">dataDecl</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_713_1_713_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_1_713_18&#39;)"><span class="hl_varref"><span class="mpre">makeLensesForCons</span></span></a><span class="mpre"> </span><a href="#loc_708_18_708_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_18_708_21&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a href="#loc_709_8_709_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_709_8_709_16&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">
  </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;makeLensesWith: Unsupported data type&quot;</span></span><span class="mpre">

</span><a href="#loc_713_1_713_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_1_713_18&#39;)"><span class="mpre">makeLensesForCons</span></a><span class="mpre"> :: </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_754_6_754_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_6_754_14&#39;)"><span class="hl_tyconref"><span class="mpre">DataDecl</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_713_1_713_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_1_713_18&#39;)"><span class="hl_fundecl"><span class="mpre">makeLensesForCons</span></span></a><span class="mpre"> </span><a name="loc_713_19_713_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_19_713_22&#39;)"><span class="hl_vardecl"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a name="loc_713_23_713_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_23_713_31&#39;)"><span class="hl_vardecl"><span class="mpre">dataDecl</span></span></a><span class="mpre"> = case </span><a href="#loc_762_5_762_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_762_5_762_17&#39;)"><span class="hl_varref"><span class="mpre">constructors</span></span></a><span class="mpre"> </span><a href="#loc_713_23_713_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_23_713_31&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> of
  [</span><span class="hl_conref"><span class="mpre">NormalC</span></span><span class="mpre"> </span><a name="loc_714_12_714_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_12_714_23&#39;)"><span class="hl_vardecl"><span class="mpre">dataConName</span></span></a><span class="mpre"> [(    _,</span><a name="loc_714_32_714_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_32_714_34&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre">)]]
    | </span><a href="#loc_713_19_713_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_19_713_22&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_143_1_143_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_17&#39;)"><span class="hl_varref"><span class="mpre">handleSingletons</span></span></a><span class="mpre">  -&gt;
      </span><a href="#loc_772_1_772_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_1_772_14&#39;)"><span class="hl_varref"><span class="mpre">makeIsoLenses</span></span></a><span class="mpre"> </span><a href="#loc_713_19_713_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_19_713_22&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a href="#loc_713_23_713_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_23_713_31&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><a href="#loc_714_12_714_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_12_714_23&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> [</span><a href="#loc_714_32_714_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_32_714_34&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre">]
  [</span><span class="hl_conref"><span class="mpre">RecC</span></span><span class="mpre">    </span><a name="loc_717_12_717_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_12_717_23&#39;)"><span class="hl_vardecl"><span class="mpre">dataConName</span></span></a><span class="mpre"> [(</span><a name="loc_717_26_717_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_26_717_29&#39;)"><span class="hl_vardecl"><span class="mpre">fld</span></span></a><span class="mpre">,_,</span><a name="loc_717_32_717_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_32_717_34&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre">)]]
    | </span><a href="#loc_713_19_713_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_19_713_22&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_143_1_143_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_17&#39;)"><span class="hl_varref"><span class="mpre">handleSingletons</span></span></a><span class="mpre">  -&gt;
      </span><a href="#loc_772_1_772_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_1_772_14&#39;)"><span class="hl_varref"><span class="mpre">makeIsoLenses</span></span></a><span class="mpre"> </span><a href="#loc_713_19_713_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_19_713_22&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a href="#loc_713_23_713_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_23_713_31&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><a href="#loc_717_12_717_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_12_717_23&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_717_26_717_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_26_717_29&#39;)"><span class="hl_varref"><span class="mpre">fld</span></span></a><span class="mpre">) [</span><a href="#loc_717_32_717_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_717_32_717_34&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre">]
  _ | </span><a href="#loc_713_19_713_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_19_713_22&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_156_1_156_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_18&#39;)"><span class="hl_varref"><span class="mpre">singletonRequired</span></span></a><span class="mpre"> -&gt;
      </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;makeLensesWith: A single-constructor single-argument data type is required&quot;</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">              -&gt;
      </span><a href="#loc_927_1_927_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_1_927_16&#39;)"><span class="hl_varref"><span class="mpre">makeFieldLenses</span></span></a><span class="mpre"> </span><a href="#loc_713_19_713_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_19_713_22&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a href="#loc_713_23_713_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_713_23_713_31&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">

</span><a href="#loc_726_1_726_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_1_726_13&#39;)"><span class="mpre">makeDataDecl</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_754_6_754_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_6_754_14&#39;)"><span class="hl_tyconref"><span class="mpre">DataDecl</span></span></a><span class="mpre">
</span><a name="loc_726_1_726_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_1_726_13&#39;)"><span class="hl_fundecl"><span class="mpre">makeDataDecl</span></span></a><span class="mpre"> </span><a name="loc_726_14_726_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_14_726_17&#39;)"><span class="hl_vardecl"><span class="mpre">dec</span></span></a><span class="mpre"> = case </span><a href="#loc_519_1_519_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_1_519_10&#39;)"><span class="hl_varref"><span class="mpre">deNewtype</span></span></a><span class="mpre"> </span><a href="#loc_726_14_726_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_14_726_17&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre"> of
  </span><span class="hl_conref"><span class="mpre">DataD</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ctx</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">tyName</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">args</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">cons</span></span><span class="mpre"> _ -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 727, srcSpanStartColumn = 40, srcSpanEndLine = 733, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 728, srcSpanStartColumn = 5, srcSpanEndLine = 728, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 729, s"><span class="mpre">DataDecl
    { dataContext = ctx
    , tyConName = Just tyName
    , dataParameters = args
    , fullType = apps $ ConT tyName
    , constructors = cons
    }</span></span><span class="mpre">
  </span><span class="hl_conref"><span class="mpre">DataInstD</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ctx</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">familyName</span></span><span class="mpre"> </span><a name="loc_734_28_734_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_28_734_32&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">cons</span></span><span class="mpre"> _ -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 734, srcSpanStartColumn = 48, srcSpanEndLine = 741, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 735, srcSpanStartColumn = 5, srcSpanEndLine = 735, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 736, s"><span class="mpre">DataDecl
    { dataContext = ctx
    , tyConName = Nothing
    , dataParameters = map PlainTV vars
    , fullType = \tys -&gt; apps (ConT familyName) $
        substType (Map.fromList $ zip vars tys) args
    , constructors = cons
    }</span></span><span class="mpre">
    where
      </span><span class="hl_comment"><span class="mpre">-- The list of &quot;type parameters&quot; to a data family instance is not</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- explicitly specified in the source. Here we define it to be</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- the set of distinct type variables that appear in the LHS. e.g.</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- data instance F a Int (Maybe (a, b)) = G</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- has 2 type parameters: a and b.</span></span><span class="mpre">
      </span><span class="hl_vardecl"><span class="mpre">vars</span></span><span class="mpre"> = </span><a href="Data.Foldable.html#loc_264_1_264_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Foldable.html#loc_264_1_264_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Set.Lens.html#loc_55_1_55_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Set.Lens.html#loc_55_1_55_6&#39;)"><span class="hl_varref"><span class="mpre">setOf</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_346_1_346_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_346_1_346_9&#39;)"><span class="hl_varref"><span class="mpre">typeVars</span></span></a><span class="mpre"> </span><a href="#loc_734_28_734_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_28_734_32&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">
  _ -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A data, newtype, data instance or newtype instance declaration.</span></span><span class="mpre">
data </span><a name="loc_754_6_754_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_6_754_14&#39;)"><span class="hl_tycondecl"><span class="mpre">DataDecl</span></span></a><span class="mpre"> = </span><a name="loc_754_17_754_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_17_754_25&#39;)"><span class="hl_condecl"><span class="mpre">DataDecl</span></span></a><span class="mpre">
  { </span><a name="loc_755_5_755_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_755_5_755_16&#39;)"><span class="hl_fielddecl"><span class="mpre">dataContext</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Cxt</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Datatype context.</span></span><span class="mpre">
  , </span><a name="loc_756_5_756_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_756_5_756_14&#39;)"><span class="hl_fielddecl"><span class="mpre">tyConName</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ^ Type constructor name, or Nothing for a data family instance.</span></span><span class="mpre">
  , </span><a name="loc_758_5_758_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_5_758_19&#39;)"><span class="hl_fielddecl"><span class="mpre">dataParameters</span></span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">TyVarBndr</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ List of type parameters</span></span><span class="mpre">
  , </span><a name="loc_759_5_759_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_5_759_13&#39;)"><span class="hl_fielddecl"><span class="mpre">fullType</span></span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Type</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Type</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ^ Create a concrete record type given a substitution to</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- &#39;detaParameters&#39;.</span></span><span class="mpre">
  , </span><a name="loc_762_5_762_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_762_5_762_17&#39;)"><span class="hl_fielddecl"><span class="mpre">constructors</span></span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ Constructors</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- , derivings :: [Name] -- currently not needed</span></span><span class="mpre">
  }

</span><a href="#loc_772_1_772_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_1_772_14&#39;)"><span class="mpre">makeIsoLenses</span></a><span class="mpre"> :: </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre">
              -&gt; </span><a href="#loc_754_6_754_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_6_754_14&#39;)"><span class="hl_tyconref"><span class="mpre">DataDecl</span></span></a><span class="mpre">
              -&gt; </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">
              -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">
              -&gt; [</span><span class="hl_tyconref"><span class="mpre">Type</span></span><span class="mpre">]
              -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_772_1_772_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_1_772_14&#39;)"><span class="hl_fundecl"><span class="mpre">makeIsoLenses</span></span></a><span class="mpre"> </span><a name="loc_772_15_772_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_15_772_18&#39;)"><span class="hl_vardecl"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a name="loc_772_19_772_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_19_772_27&#39;)"><span class="hl_vardecl"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><a name="loc_772_28_772_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_28_772_39&#39;)"><span class="hl_vardecl"><span class="mpre">dataConName</span></span></a><span class="mpre"> </span><a name="loc_772_40_772_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_40_772_54&#39;)"><span class="hl_vardecl"><span class="mpre">maybeFieldName</span></span></a><span class="mpre"> </span><a name="loc_772_55_772_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_55_772_61&#39;)"><span class="hl_vardecl"><span class="mpre">partTy</span></span></a><span class="mpre"> = do
  let </span><a name="loc_773_7_773_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_773_7_773_13&#39;)"><span class="hl_vardecl"><span class="mpre">tyArgs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_701_1_701_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_1_701_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><a href="#loc_758_5_758_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_5_758_19&#39;)"><span class="hl_varref"><span class="mpre">dataParameters</span></span></a><span class="mpre"> </span><a href="#loc_772_19_772_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_19_772_27&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">)
  </span><a name="loc_774_3_774_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_774_3_774_4&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_661_1_661_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_1_661_9&#39;)"><span class="hl_varref"><span class="mpre">freshMap</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Set.Lens.html#loc_55_1_55_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Set.Lens.html#loc_55_1_55_6&#39;)"><span class="hl_varref"><span class="mpre">setOf</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_346_1_346_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_346_1_346_9&#39;)"><span class="hl_varref"><span class="mpre">typeVars</span></span></a><span class="mpre"> </span><a href="#loc_773_7_773_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_773_7_773_13&#39;)"><span class="hl_varref"><span class="mpre">tyArgs</span></span></a><span class="mpre">
  let </span><a name="loc_775_7_775_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_775_7_775_10&#39;)"><span class="hl_vardecl"><span class="mpre">aty</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">List.foldl&#39;</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">AppT</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">TupleT</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_772_55_772_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_55_772_61&#39;)"><span class="hl_varref"><span class="mpre">partTy</span></span></a><span class="mpre">) </span><a href="#loc_772_55_772_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_55_772_61&#39;)"><span class="hl_varref"><span class="mpre">partTy</span></span></a><span class="mpre">
      </span><a name="loc_776_7_776_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_776_7_776_10&#39;)"><span class="hl_vardecl"><span class="mpre">bty</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lens.html#loc_350_1_350_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_350_1_350_14&#39;)"><span class="hl_varref"><span class="mpre">substTypeVars</span></span></a><span class="mpre"> </span><a href="#loc_774_3_774_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_774_3_774_4&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_775_7_775_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_775_7_775_10&#39;)"><span class="hl_varref"><span class="mpre">aty</span></span></a><span class="mpre">
      </span><a name="loc_777_7_777_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_777_7_777_10&#39;)"><span class="hl_vardecl"><span class="mpre">sty</span></span></a><span class="mpre"> = </span><a href="#loc_759_5_759_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_5_759_13&#39;)"><span class="hl_varref"><span class="mpre">fullType</span></span></a><span class="mpre"> </span><a href="#loc_772_19_772_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_19_772_27&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">VarT</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">) </span><a href="#loc_773_7_773_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_773_7_773_13&#39;)"><span class="hl_varref"><span class="mpre">tyArgs</span></span></a><span class="mpre">
      </span><a name="loc_778_7_778_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_7_778_10&#39;)"><span class="hl_vardecl"><span class="mpre">tty</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lens.html#loc_350_1_350_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_350_1_350_14&#39;)"><span class="hl_varref"><span class="mpre">substTypeVars</span></span></a><span class="mpre"> </span><a href="#loc_774_3_774_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_774_3_774_4&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_777_7_777_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_777_7_777_10&#39;)"><span class="hl_varref"><span class="mpre">sty</span></span></a><span class="mpre">
      </span><a name="loc_779_7_779_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_779_7_779_17&#39;)"><span class="hl_vardecl"><span class="mpre">quantified</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">ForallT</span></span><span class="mpre"> (</span><a href="#loc_773_7_773_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_773_7_773_13&#39;)"><span class="hl_varref"><span class="mpre">tyArgs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_350_1_350_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_350_1_350_14&#39;)"><span class="hl_varref"><span class="mpre">substTypeVars</span></span></a><span class="mpre"> </span><a href="#loc_774_3_774_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_774_3_774_4&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_773_7_773_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_773_7_773_13&#39;)"><span class="hl_varref"><span class="mpre">tyArgs</span></span></a><span class="mpre">)
        (</span><a href="#loc_755_5_755_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_755_5_755_16&#39;)"><span class="hl_varref"><span class="mpre">dataContext</span></span></a><span class="mpre"> </span><a href="#loc_772_19_772_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_19_772_27&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_350_1_350_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_350_1_350_14&#39;)"><span class="hl_varref"><span class="mpre">substTypeVars</span></span></a><span class="mpre"> </span><a href="#loc_774_3_774_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_774_3_774_4&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><a href="#loc_755_5_755_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_755_5_755_16&#39;)"><span class="hl_varref"><span class="mpre">dataContext</span></span></a><span class="mpre"> </span><a href="#loc_772_19_772_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_19_772_27&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">))
      </span><a name="loc_781_7_781_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_781_7_781_19&#39;)"><span class="hl_vardecl"><span class="mpre">maybeIsoName</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="#loc_192_1_192_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_8&#39;)"><span class="hl_varref"><span class="mpre">lensIso</span></span></a><span class="mpre"> </span><a href="#loc_772_15_772_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_15_772_18&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_772_28_772_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_28_772_39&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre">)
      </span><a name="loc_782_7_782_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_782_7_782_15&#39;)"><span class="hl_vardecl"><span class="mpre">lensOnly</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_772_15_772_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_15_772_18&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_152_1_152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_13&#39;)"><span class="hl_varref"><span class="mpre">singletonIso</span></span></a><span class="mpre">
      </span><a name="loc_783_7_783_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_783_7_783_13&#39;)"><span class="hl_vardecl"><span class="mpre">isoCon</span></span></a><span class="mpre">   | </span><a href="#loc_782_7_782_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_782_7_782_15&#39;)"><span class="hl_varref"><span class="mpre">lensOnly</span></span></a><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">ConT</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 783, srcSpanStartColumn = 35, srcSpanEndLine = 783, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 783, srcSpanStartColumn = 35, srcSpanEndLine = 783, srcSpanEndColumn = 37}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;&#39;Lens</span></span><span class="mpre">
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">ConT</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 784, srcSpanStartColumn = 35, srcSpanEndLine = 784, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 784, srcSpanStartColumn = 35, srcSpanEndLine = 784, srcSpanEndColumn = 37}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;&#39;Iso</span></span><span class="mpre">
      </span><a name="loc_785_7_785_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_785_7_785_14&#39;)"><span class="hl_vardecl"><span class="mpre">isoCon&#39;</span></span></a><span class="mpre">  | </span><a href="#loc_782_7_782_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_782_7_782_15&#39;)"><span class="hl_varref"><span class="mpre">lensOnly</span></span></a><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">ConT</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 785, srcSpanStartColumn = 35, srcSpanEndLine = 785, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 785, srcSpanStartColumn = 35, srcSpanEndLine = 785, srcSpanEndColumn = 37}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;&#39;Lens&#39;</span></span><span class="mpre">
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">ConT</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 786, srcSpanStartColumn = 35, srcSpanEndLine = 786, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 786, srcSpanStartColumn = 35, srcSpanEndLine = 786, srcSpanEndColumn = 37}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;&#39;Iso&#39;</span></span><span class="mpre">
      </span><a name="loc_787_7_787_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_7_787_15&#39;)"><span class="hl_vardecl"><span class="mpre">makeBody</span></span></a><span class="mpre"> | </span><a href="#loc_782_7_782_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_782_7_782_15&#39;)"><span class="hl_varref"><span class="mpre">lensOnly</span></span></a><span class="mpre">  = </span><a href="#loc_690_1_690_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_690_1_690_13&#39;)"><span class="hl_varref"><span class="mpre">makeLensBody</span></span></a><span class="mpre">
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_683_1_683_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_683_1_683_12&#39;)"><span class="hl_varref"><span class="mpre">makeIsoBody</span></span></a><span class="mpre">
  </span><a name="loc_789_3_789_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_789_3_789_11&#39;)"><span class="hl_vardecl"><span class="mpre">isoDecls</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [])) </span><a href="#loc_781_7_781_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_781_7_781_19&#39;)"><span class="hl_varref"><span class="mpre">maybeIsoName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_789_56_789_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_789_56_789_63&#39;)"><span class="hl_vardecl"><span class="mpre">isoName</span></span></a><span class="mpre"> -&gt; do
    let </span><a name="loc_790_9_790_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_9_790_13&#39;)"><span class="hl_vardecl"><span class="mpre">decl</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">SigD</span></span><span class="mpre"> </span><a href="#loc_789_56_789_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_789_56_789_63&#39;)"><span class="hl_varref"><span class="mpre">isoName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_779_7_779_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_779_7_779_17&#39;)"><span class="hl_varref"><span class="mpre">quantified</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
          if </span><a href="#loc_772_15_772_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_15_772_18&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_126_1_126_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_13&#39;)"><span class="hl_varref"><span class="mpre">simpleLenses</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Map.null</span></span><span class="mpre"> </span><a href="#loc_774_3_774_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_774_3_774_4&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
            then </span><a href="#loc_785_7_785_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_785_7_785_14&#39;)"><span class="hl_varref"><span class="mpre">isoCon&#39;</span></span></a><span class="mpre"> </span><a href="#loc_705_1_705_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_5&#39;)"><span class="hl_infix"><span class="mpre">`apps`</span></span></a><span class="mpre"> [</span><a href="#loc_777_7_777_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_777_7_777_10&#39;)"><span class="hl_varref"><span class="mpre">sty</span></span></a><span class="mpre">,</span><a href="#loc_775_7_775_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_775_7_775_10&#39;)"><span class="hl_varref"><span class="mpre">aty</span></span></a><span class="mpre">]
            else </span><a href="#loc_783_7_783_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_783_7_783_13&#39;)"><span class="hl_varref"><span class="mpre">isoCon</span></span></a><span class="mpre">  </span><a href="#loc_705_1_705_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_5&#39;)"><span class="hl_infix"><span class="mpre">`apps`</span></span></a><span class="mpre"> [</span><a href="#loc_777_7_777_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_777_7_777_10&#39;)"><span class="hl_varref"><span class="mpre">sty</span></span></a><span class="mpre">,</span><a href="#loc_778_7_778_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_7_778_10&#39;)"><span class="hl_varref"><span class="mpre">tty</span></span></a><span class="mpre">,</span><a href="#loc_775_7_775_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_775_7_775_10&#39;)"><span class="hl_varref"><span class="mpre">aty</span></span></a><span class="mpre">,</span><a href="#loc_776_7_776_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_776_7_776_10&#39;)"><span class="hl_varref"><span class="mpre">bty</span></span></a><span class="mpre">]
    (</span><a name="loc_794_6_794_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_794_6_794_8&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre">, </span><a name="loc_794_10_794_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_794_10_794_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_666_1_666_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_666_1_666_12&#39;)"><span class="hl_varref"><span class="mpre">makeIsoFrom</span></span></a><span class="mpre"> </span><a href="#loc_775_7_775_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_775_7_775_10&#39;)"><span class="hl_varref"><span class="mpre">aty</span></span></a><span class="mpre"> </span><a href="#loc_772_28_772_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_28_772_39&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre">
    </span><a name="loc_795_5_795_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_795_5_795_6&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_679_1_679_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_1_679_10&#39;)"><span class="hl_varref"><span class="mpre">makeIsoTo</span></span></a><span class="mpre"> </span><a href="#loc_794_6_794_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_794_6_794_8&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre"> </span><a href="#loc_772_28_772_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_28_772_39&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre">
    </span><a name="loc_796_5_796_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_796_5_796_9&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_787_7_787_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_7_787_15&#39;)"><span class="hl_varref"><span class="mpre">makeBody</span></span></a><span class="mpre"> </span><a href="#loc_789_56_789_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_789_56_789_63&#39;)"><span class="hl_varref"><span class="mpre">isoName</span></span></a><span class="mpre"> </span><a href="#loc_795_5_795_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_795_5_795_6&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_794_10_794_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_794_10_794_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
#ifndef INLINING
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> if </span><a href="#loc_772_15_772_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_15_772_18&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_176_1_176_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_19&#39;)"><span class="hl_varref"><span class="mpre">generateSignatures</span></span></a><span class="mpre"> then [</span><a href="#loc_790_9_790_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_9_790_13&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre">, </span><a href="#loc_796_5_796_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_796_5_796_9&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">] else [</span><a href="#loc_796_5_796_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_796_5_796_9&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">]
#else
    </span><a name="loc_800_5_800_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_800_5_800_13&#39;)"><span class="hl_vardecl"><span class="mpre">inlining</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_1152_1_1152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1152_1_1152_13&#39;)"><span class="hl_varref"><span class="mpre">inlinePragma</span></span></a><span class="mpre"> </span><a href="#loc_789_56_789_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_789_56_789_63&#39;)"><span class="hl_varref"><span class="mpre">isoName</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> if </span><a href="#loc_772_15_772_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_15_772_18&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_176_1_176_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_19&#39;)"><span class="hl_varref"><span class="mpre">generateSignatures</span></span></a><span class="mpre"> then [</span><a href="#loc_790_9_790_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_9_790_13&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre">, </span><a href="#loc_796_5_796_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_796_5_796_9&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">, </span><a href="#loc_800_5_800_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_800_5_800_13&#39;)"><span class="hl_varref"><span class="mpre">inlining</span></span></a><span class="mpre">] else [</span><a href="#loc_796_5_796_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_796_5_796_9&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">, </span><a href="#loc_800_5_800_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_800_5_800_13&#39;)"><span class="hl_varref"><span class="mpre">inlining</span></span></a><span class="mpre">]
#endif
  </span><a name="loc_803_3_803_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_803_3_803_16&#39;)"><span class="hl_vardecl"><span class="mpre">accessorDecls</span></span></a><span class="mpre"> &lt;- case </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> (</span><a href="#loc_772_40_772_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_40_772_54&#39;)"><span class="hl_varref"><span class="mpre">maybeFieldName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="#loc_199_1_199_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_10&#39;)"><span class="hl_varref"><span class="mpre">lensField</span></span></a><span class="mpre"> </span><a href="#loc_772_15_772_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_15_772_18&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre">) of
    </span><a name="loc_804_5_804_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_804_5_804_8&#39;)"><span class="hl_specname"><span class="mpre">jfn</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_804_15_804_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_804_15_804_23&#39;)"><span class="hl_vardecl"><span class="mpre">lensName</span></span></a><span class="mpre">)
      | (</span><a href="#loc_804_5_804_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_804_5_804_8&#39;)"><span class="hl_varref"><span class="mpre">jfn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_781_7_781_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_781_7_781_19&#39;)"><span class="hl_varref"><span class="mpre">maybeIsoName</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_85_1_85_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_85_1_85_10&#39;)"><span class="hl_varref"><span class="mpre">isNothing</span></span></a><span class="mpre"> </span><a href="#loc_781_7_781_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_781_7_781_19&#39;)"><span class="hl_varref"><span class="mpre">maybeIsoName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_772_15_772_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_15_772_18&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_148_1_148_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_18&#39;)"><span class="hl_varref"><span class="mpre">singletonAndField</span></span></a><span class="mpre">) -&gt; do
      let </span><a name="loc_806_11_806_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_11_806_15&#39;)"><span class="hl_vardecl"><span class="mpre">decl</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">SigD</span></span><span class="mpre"> </span><a href="#loc_804_15_804_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_804_15_804_23&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_779_7_779_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_779_7_779_17&#39;)"><span class="hl_varref"><span class="mpre">quantified</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
            if </span><a href="#loc_772_15_772_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_15_772_18&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_126_1_126_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_13&#39;)"><span class="hl_varref"><span class="mpre">simpleLenses</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Map.null</span></span><span class="mpre"> </span><a href="#loc_774_3_774_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_774_3_774_4&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
            then </span><a href="#loc_785_7_785_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_785_7_785_14&#39;)"><span class="hl_varref"><span class="mpre">isoCon&#39;</span></span></a><span class="mpre"> </span><a href="#loc_705_1_705_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_5&#39;)"><span class="hl_infix"><span class="mpre">`apps`</span></span></a><span class="mpre"> [</span><a href="#loc_777_7_777_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_777_7_777_10&#39;)"><span class="hl_varref"><span class="mpre">sty</span></span></a><span class="mpre">,</span><a href="#loc_775_7_775_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_775_7_775_10&#39;)"><span class="hl_varref"><span class="mpre">aty</span></span></a><span class="mpre">]
            else </span><a href="#loc_783_7_783_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_783_7_783_13&#39;)"><span class="hl_varref"><span class="mpre">isoCon</span></span></a><span class="mpre"> </span><a href="#loc_705_1_705_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_5&#39;)"><span class="hl_infix"><span class="mpre">`apps`</span></span></a><span class="mpre"> [</span><a href="#loc_777_7_777_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_777_7_777_10&#39;)"><span class="hl_varref"><span class="mpre">sty</span></span></a><span class="mpre">,</span><a href="#loc_778_7_778_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_778_7_778_10&#39;)"><span class="hl_varref"><span class="mpre">tty</span></span></a><span class="mpre">,</span><a href="#loc_775_7_775_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_775_7_775_10&#39;)"><span class="hl_varref"><span class="mpre">aty</span></span></a><span class="mpre">,</span><a href="#loc_776_7_776_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_776_7_776_10&#39;)"><span class="hl_varref"><span class="mpre">bty</span></span></a><span class="mpre">]
      (</span><a name="loc_810_8_810_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_810_8_810_10&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre">, </span><a name="loc_810_12_810_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_810_12_810_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_666_1_666_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_666_1_666_12&#39;)"><span class="hl_varref"><span class="mpre">makeIsoFrom</span></span></a><span class="mpre"> </span><a href="#loc_775_7_775_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_775_7_775_10&#39;)"><span class="hl_varref"><span class="mpre">aty</span></span></a><span class="mpre"> </span><a href="#loc_772_28_772_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_28_772_39&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre">
      </span><a name="loc_811_7_811_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_811_7_811_8&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_679_1_679_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_679_1_679_10&#39;)"><span class="hl_varref"><span class="mpre">makeIsoTo</span></span></a><span class="mpre"> </span><a href="#loc_810_8_810_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_810_8_810_10&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre"> </span><a href="#loc_772_28_772_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_28_772_39&#39;)"><span class="hl_varref"><span class="mpre">dataConName</span></span></a><span class="mpre">
      </span><a name="loc_812_7_812_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_812_7_812_11&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_787_7_787_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_7_787_15&#39;)"><span class="hl_varref"><span class="mpre">makeBody</span></span></a><span class="mpre"> </span><a href="#loc_804_15_804_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_804_15_804_23&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><a href="#loc_811_7_811_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_811_7_811_8&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_810_12_810_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_810_12_810_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
#ifndef INLINING
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> if </span><a href="#loc_772_15_772_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_15_772_18&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_176_1_176_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_19&#39;)"><span class="hl_varref"><span class="mpre">generateSignatures</span></span></a><span class="mpre"> then [</span><a href="#loc_806_11_806_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_11_806_15&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre">, </span><a href="#loc_812_7_812_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_812_7_812_11&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">] else [</span><a href="#loc_812_7_812_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_812_7_812_11&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">]
#else
      </span><a name="loc_816_7_816_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_816_7_816_15&#39;)"><span class="hl_vardecl"><span class="mpre">inlining</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_1152_1_1152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1152_1_1152_13&#39;)"><span class="hl_varref"><span class="mpre">inlinePragma</span></span></a><span class="mpre"> </span><a href="#loc_804_15_804_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_804_15_804_23&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> if </span><a href="#loc_772_15_772_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_15_772_18&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_176_1_176_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_19&#39;)"><span class="hl_varref"><span class="mpre">generateSignatures</span></span></a><span class="mpre"> then [</span><a href="#loc_806_11_806_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_11_806_15&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre">, </span><a href="#loc_812_7_812_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_812_7_812_11&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">, </span><a href="#loc_816_7_816_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_816_7_816_15&#39;)"><span class="hl_varref"><span class="mpre">inlining</span></span></a><span class="mpre">] else [</span><a href="#loc_812_7_812_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_812_7_812_11&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">, </span><a href="#loc_816_7_816_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_816_7_816_15&#39;)"><span class="hl_varref"><span class="mpre">inlining</span></span></a><span class="mpre">]
#endif
    _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_789_3_789_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_789_3_789_11&#39;)"><span class="hl_varref"><span class="mpre">isoDecls</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_803_3_803_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_803_3_803_16&#39;)"><span class="hl_varref"><span class="mpre">accessorDecls</span></span></a><span class="mpre">

</span><a href="#loc_823_1_823_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_823_1_823_20&#39;)"><span class="mpre">makeFieldGetterBody</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre">, [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">])] -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">
</span><a name="loc_823_1_823_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_823_1_823_20&#39;)"><span class="hl_fundecl"><span class="mpre">makeFieldGetterBody</span></span></a><span class="mpre"> </span><a name="loc_823_21_823_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_823_21_823_27&#39;)"><span class="hl_vardecl"><span class="mpre">isFold</span></span></a><span class="mpre"> </span><a name="loc_823_28_823_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_823_28_823_36&#39;)"><span class="hl_vardecl"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><a name="loc_823_37_823_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_823_37_823_44&#39;)"><span class="hl_vardecl"><span class="mpre">conList</span></span></a><span class="mpre"> </span><a name="loc_823_45_823_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_823_45_823_60&#39;)"><span class="hl_vardecl"><span class="mpre">maybeMethodName</span></span></a><span class="mpre">
  = case </span><a href="#loc_823_45_823_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_823_45_823_60&#39;)"><span class="hl_varref"><span class="mpre">maybeMethodName</span></span></a><span class="mpre"> of
      </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_825_12_825_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_825_12_825_22&#39;)"><span class="hl_vardecl"><span class="mpre">methodName</span></span></a><span class="mpre"> -&gt; do
         </span><a name="loc_826_10_826_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_10_826_12&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;go&quot;</span></span><span class="mpre">
         let </span><a name="loc_827_14_827_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_827_14_827_18&#39;)"><span class="hl_vardecl"><span class="mpre">expr</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_236_1_236_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_236_1_236_9&#39;)"><span class="hl_varref"><span class="mpre">infixApp</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_825_12_825_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_825_12_825_22&#39;)"><span class="hl_varref"><span class="mpre">methodName</span></span></a><span class="mpre">) (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 827, srcSpanStartColumn = 54, srcSpanEndLine = 827, srcSpanEndColumn = 66}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 827, srcSpanStartColumn = 54, srcSpanEndLine = 827, srcSpanEndColumn = 55}]}) (Qual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control"><span class="mpre">&#39;(Prelude..)</span></span><span class="mpre">) (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_826_10_826_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_10_826_12&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">)
         </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_823_28_823_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_823_28_823_36&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> [ </span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [] (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> </span><a href="#loc_827_14_827_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_827_14_827_18&#39;)"><span class="hl_varref"><span class="mpre">expr</span></span></a><span class="mpre">) [</span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_826_10_826_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_10_826_12&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_831_5_831_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_831_5_831_12&#39;)"><span class="hl_varref"><span class="mpre">clauses</span></span></a><span class="mpre">] ]
      </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_823_28_823_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_823_28_823_36&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><a href="#loc_831_5_831_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_831_5_831_12&#39;)"><span class="hl_varref"><span class="mpre">clauses</span></span></a><span class="mpre">
  where
    </span><a name="loc_831_5_831_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_831_5_831_12&#39;)"><span class="hl_vardecl"><span class="mpre">clauses</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_833_5_833_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_5_833_16&#39;)"><span class="hl_varref"><span class="mpre">buildClause</span></span></a><span class="mpre"> </span><a href="#loc_823_37_823_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_823_37_823_44&#39;)"><span class="hl_varref"><span class="mpre">conList</span></span></a><span class="mpre">

    </span><a name="loc_833_5_833_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_5_833_16&#39;)"><span class="hl_fundecl"><span class="mpre">buildClause</span></span></a><span class="mpre"> (</span><a name="loc_833_18_833_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_18_833_21&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre">, </span><a name="loc_833_23_833_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_23_833_29&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre">) | </span><a href="#loc_866_1_866_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_866_1_866_9&#39;)"><span class="hl_varref"><span class="mpre">isRecord</span></span></a><span class="mpre"> </span><a href="#loc_833_18_833_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_18_833_21&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre"> = do
      </span><a name="loc_834_7_834_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_834_7_834_8&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;_f&quot;</span></span><span class="mpre">
      </span><a name="loc_835_7_835_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_835_7_835_11&#39;)"><span class="hl_vardecl"><span class="mpre">vars</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Traversable.html#loc_210_1_210_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_210_1_210_4&#39;)"><span class="hl_varref"><span class="mpre">for</span></span></a><span class="mpre"> (</span><a href="#loc_833_18_833_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_18_833_21&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="hl_infix"><span class="mpre">^..</span></span><a href="Language.Haskell.TH.Lens.html#loc_384_1_384_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_384_1_384_15&#39;)"><span class="hl_varref"><span class="mpre">conNamedFields</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">_1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_835_48_835_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_835_48_835_51&#39;)"><span class="hl_vardecl"><span class="mpre">fld</span></span></a><span class="mpre"> -&gt;
          if </span><a href="#loc_835_48_835_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_835_48_835_51&#39;)"><span class="hl_varref"><span class="mpre">fld</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`List.elem`</span></span><span class="mpre"> </span><a href="#loc_833_23_833_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_23_833_29&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">
        then </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre">  </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_835_48_835_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_835_48_835_51&#39;)"><span class="hl_varref"><span class="mpre">fld</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">))
        else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
      let </span><a name="loc_839_11_839_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_839_11_839_16&#39;)"><span class="hl_vardecl"><span class="mpre">cpats</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_100_1_100_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_100_1_100_6&#39;)"><span class="hl_varref"><span class="mpre">wildP</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_835_7_835_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_835_7_835_11&#39;)"><span class="hl_varref"><span class="mpre">vars</span></span></a><span class="mpre">               </span><span class="hl_comment"><span class="mpre">-- Deconstruction</span></span><span class="mpre">
          </span><a name="loc_840_11_840_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_840_11_840_16&#39;)"><span class="hl_vardecl"><span class="mpre">fvals</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_217_1_217_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_217_1_217_5&#39;)"><span class="hl_varref"><span class="mpre">appE</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_834_7_834_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_834_7_834_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre">) (</span><a href="Data.Maybe.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_115_1_115_10&#39;)"><span class="hl_varref"><span class="mpre">catMaybes</span></span></a><span class="mpre"> </span><a href="#loc_835_7_835_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_835_7_835_11&#39;)"><span class="hl_varref"><span class="mpre">vars</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- Functor applications</span></span><span class="mpre">
          </span><a name="loc_841_11_841_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_11_841_18&#39;)"><span class="hl_vardecl"><span class="mpre">conName</span></span></a><span class="mpre"> = </span><a href="#loc_833_18_833_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_18_833_21&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">

          </span><a name="loc_843_11_843_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_843_11_843_15&#39;)"><span class="hl_vardecl"><span class="mpre">fpat</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> </span><a href="#loc_840_11_840_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_840_11_840_16&#39;)"><span class="hl_varref"><span class="mpre">fvals</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_100_1_100_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_100_1_100_6&#39;)"><span class="hl_varref"><span class="mpre">wildP</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       = </span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_834_7_834_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_834_7_834_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

          </span><a name="loc_847_11_847_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_847_11_847_15&#39;)"><span class="hl_vardecl"><span class="mpre">expr</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><a href="#loc_823_21_823_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_823_21_823_27&#39;)"><span class="hl_varref"><span class="mpre">isFold</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_833_23_833_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_23_833_29&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
              = </span><a href="Language.Haskell.TH.Lib.html#loc_217_1_217_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_217_1_217_5&#39;)"><span class="hl_varref"><span class="mpre">appE</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 849, srcSpanStartColumn = 28, srcSpanEndLine = 849, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 849, srcSpanStartColumn = 28, srcSpanEndLine = 849, srcSpanEndColumn = 29}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;error</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_214_1_214_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_214_1_214_5&#39;)"><span class="hl_varref"><span class="mpre">litE</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_61_1_61_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_61_1_61_8&#39;)"><span class="hl_varref"><span class="mpre">stringL</span></span></a><span class="mpre">
              </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_823_28_823_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_823_28_823_36&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: expected a single matching field in &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_841_11_841_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_11_841_18&#39;)"><span class="hl_varref"><span class="mpre">conName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;, found &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_833_23_833_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_23_833_29&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">)
            | </span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> </span><a href="#loc_833_23_833_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_23_833_29&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">
              = </span><span class="warning" data-warning="ExpBracketExp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 852, srcSpanStartColumn = 17, srcSpanEndLine = 852, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 852, srcSpanStartColumn = 17, srcSpanEndLine = 852, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 85"><span class="mpre">[| coerce (pure ()) |]</span></span><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> </span><a href="#loc_840_11_840_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_840_11_840_16&#39;)"><span class="hl_varref"><span class="mpre">fvals</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpBracketExp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 853, srcSpanStartColumn = 33, srcSpanEndLine = 853, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 853, srcSpanStartColumn = 33, srcSpanEndLine = 853, srcSpanEndColumn = 35},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 85"><span class="mpre">[| coerce (pure ()) |]</span></span><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">
              = let </span><span class="hl_fundecl"><span class="mpre">add</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">x</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">y</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpBracketExp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 855, srcSpanStartColumn = 31, srcSpanEndLine = 855, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 855, srcSpanStartColumn = 31, srcSpanEndLine = 855, srcSpanEndColumn = 33},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 85"><span class="mpre">[| $x *&gt; $y |]</span></span><span class="mpre">
                in </span><span class="warning" data-warning="ExpBracketExp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 856, srcSpanStartColumn = 20, srcSpanEndLine = 856, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 856, srcSpanStartColumn = 20, srcSpanEndLine = 856, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 85"><span class="mpre">[| coerce $(List.foldl1 add fvals) |]</span></span><span class="mpre">
      </span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [</span><a href="#loc_843_11_843_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_843_11_843_15&#39;)"><span class="hl_varref"><span class="mpre">fpat</span></span></a><span class="mpre">, </span><a href="Language.Haskell.TH.Lib.html#loc_76_1_76_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_76_1_76_5&#39;)"><span class="hl_varref"><span class="mpre">conP</span></span></a><span class="mpre"> </span><a href="#loc_841_11_841_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_11_841_18&#39;)"><span class="hl_varref"><span class="mpre">conName</span></span></a><span class="mpre"> </span><a href="#loc_839_11_839_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_839_11_839_16&#39;)"><span class="hl_varref"><span class="mpre">cpats</span></span></a><span class="mpre">] (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> </span><a href="#loc_847_11_847_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_847_11_847_15&#39;)"><span class="hl_varref"><span class="mpre">expr</span></span></a><span class="mpre">) []

    </span><span class="hl_comment"><span class="mpre">-- Non-record are never the target of a generated field lens body</span></span><span class="mpre">
    </span><a href="#loc_833_5_833_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_833_5_833_16&#39;)"><span class="hl_fundecl"><span class="mpre">buildClause</span></span></a><span class="mpre"> (</span><a name="loc_860_18_860_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_860_18_860_21&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">_fields</span></span><span class="mpre">) =
      </span><span class="hl_comment"><span class="mpre">-- clause:  _ c@Con{} = expr</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- expr:    pure c</span></span><span class="mpre">
      </span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_100_1_100_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_100_1_100_6&#39;)"><span class="hl_varref"><span class="mpre">wildP</span></span></a><span class="mpre">, </span><a href="Language.Haskell.TH.Lib.html#loc_102_1_102_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_102_1_102_5&#39;)"><span class="hl_varref"><span class="mpre">recP</span></span></a><span class="mpre"> (</span><a href="#loc_860_18_860_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_860_18_860_21&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">) []] (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpBracketExp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 863, srcSpanStartColumn = 52, srcSpanEndLine = 863, srcSpanEndColumn = 74}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 863, srcSpanStartColumn = 52, srcSpanEndLine = 863, srcSpanEndColumn = 54},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 86"><span class="mpre">[| coerce (pure ()) |]</span></span><span class="mpre">) []

</span><a href="#loc_866_1_866_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_866_1_866_9&#39;)"><span class="mpre">isRecord</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_866_1_866_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_866_1_866_9&#39;)"><span class="hl_fundecl"><span class="mpre">isRecord</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 866, srcSpanStartColumn = 10, srcSpanEndLine = 866, srcSpanEndColumn = 16}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 866, srcSpanStartColumn = 14, srcSpanEndLine = 866, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 866, src"><span class="mpre">RecC{}</span></span><span class="mpre">          = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_866_1_866_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_866_1_866_9&#39;)"><span class="hl_fundecl"><span class="mpre">isRecord</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 867, srcSpanStartColumn = 10, srcSpanEndLine = 867, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 867, srcSpanStartColumn = 17, srcSpanEndLine = 867, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 867, src"><span class="mpre">NormalC{}</span></span><span class="mpre">       = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_866_1_866_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_866_1_866_9&#39;)"><span class="hl_fundecl"><span class="mpre">isRecord</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 868, srcSpanStartColumn = 10, srcSpanEndLine = 868, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 868, srcSpanStartColumn = 16, srcSpanEndLine = 868, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 868, src"><span class="mpre">InfixC{}</span></span><span class="mpre">        = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_866_1_866_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_866_1_866_9&#39;)"><span class="hl_fundecl"><span class="mpre">isRecord</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ForallC</span></span><span class="mpre"> _ _ </span><a name="loc_869_23_869_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_23_869_24&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) = </span><a href="#loc_866_1_866_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_866_1_866_9&#39;)"><span class="hl_varref"><span class="mpre">isRecord</span></span></a><span class="mpre"> </span><a href="#loc_869_23_869_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_23_869_24&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><a href="#loc_872_1_872_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_1_872_18&#39;)"><span class="mpre">makeFieldLensBody</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre">, [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">])] -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">
</span><a name="loc_872_1_872_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_1_872_18&#39;)"><span class="hl_fundecl"><span class="mpre">makeFieldLensBody</span></span></a><span class="mpre"> </span><a name="loc_872_19_872_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_19_872_30&#39;)"><span class="hl_vardecl"><span class="mpre">isTraversal</span></span></a><span class="mpre"> </span><a name="loc_872_31_872_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_31_872_39&#39;)"><span class="hl_vardecl"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><a name="loc_872_40_872_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_40_872_47&#39;)"><span class="hl_vardecl"><span class="mpre">conList</span></span></a><span class="mpre"> </span><a name="loc_872_48_872_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_48_872_63&#39;)"><span class="hl_vardecl"><span class="mpre">maybeMethodName</span></span></a><span class="mpre"> = case </span><a href="#loc_872_48_872_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_48_872_63&#39;)"><span class="hl_varref"><span class="mpre">maybeMethodName</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_873_10_873_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_873_10_873_20&#39;)"><span class="hl_vardecl"><span class="mpre">methodName</span></span></a><span class="mpre"> -&gt; do
       </span><a name="loc_874_8_874_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_874_8_874_10&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;go&quot;</span></span><span class="mpre">
       let </span><a name="loc_875_12_875_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_875_12_875_16&#39;)"><span class="hl_vardecl"><span class="mpre">expr</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_236_1_236_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_236_1_236_9&#39;)"><span class="hl_varref"><span class="mpre">infixApp</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_873_10_873_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_873_10_873_20&#39;)"><span class="hl_varref"><span class="mpre">methodName</span></span></a><span class="mpre">) (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 875, srcSpanStartColumn = 52, srcSpanEndLine = 875, srcSpanEndColumn = 64}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 875, srcSpanStartColumn = 52, srcSpanEndLine = 875, srcSpanEndColumn = 53}]}) (Qual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control"><span class="mpre">&#39;(Prelude..)</span></span><span class="mpre">) (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_874_8_874_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_874_8_874_10&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">)
       </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_872_31_872_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_31_872_39&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> [ </span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [] (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> </span><a href="#loc_875_12_875_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_875_12_875_16&#39;)"><span class="hl_varref"><span class="mpre">expr</span></span></a><span class="mpre">) [</span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_874_8_874_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_874_8_874_10&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_879_5_879_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_879_5_879_12&#39;)"><span class="hl_varref"><span class="mpre">clauses</span></span></a><span class="mpre">] ]
    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_872_31_872_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_31_872_39&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><a href="#loc_879_5_879_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_879_5_879_12&#39;)"><span class="hl_varref"><span class="mpre">clauses</span></span></a><span class="mpre">
  where
    </span><a name="loc_879_5_879_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_879_5_879_12&#39;)"><span class="hl_vardecl"><span class="mpre">clauses</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_881_5_881_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_881_5_881_16&#39;)"><span class="hl_varref"><span class="mpre">buildClause</span></span></a><span class="mpre"> </span><a href="#loc_872_40_872_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_40_872_47&#39;)"><span class="hl_varref"><span class="mpre">conList</span></span></a><span class="mpre">

    </span><a name="loc_881_5_881_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_881_5_881_16&#39;)"><span class="hl_fundecl"><span class="mpre">buildClause</span></span></a><span class="mpre"> (</span><a name="loc_881_18_881_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_881_18_881_21&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre">, </span><a name="loc_881_23_881_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_881_23_881_29&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre">) | </span><a href="#loc_866_1_866_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_866_1_866_9&#39;)"><span class="hl_varref"><span class="mpre">isRecord</span></span></a><span class="mpre"> </span><a href="#loc_881_18_881_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_881_18_881_21&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre"> = do
      </span><a name="loc_882_7_882_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_882_7_882_8&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;_f&quot;</span></span><span class="mpre">
      </span><a name="loc_883_7_883_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_883_7_883_11&#39;)"><span class="hl_vardecl"><span class="mpre">vars</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Traversable.html#loc_210_1_210_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_210_1_210_4&#39;)"><span class="hl_varref"><span class="mpre">for</span></span></a><span class="mpre"> (</span><a href="#loc_881_18_881_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_881_18_881_21&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="hl_infix"><span class="mpre">^..</span></span><a href="Language.Haskell.TH.Lens.html#loc_384_1_384_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_384_1_384_15&#39;)"><span class="hl_varref"><span class="mpre">conNamedFields</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">_1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_883_48_883_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_883_48_883_51&#39;)"><span class="hl_vardecl"><span class="mpre">fld</span></span></a><span class="mpre"> -&gt;
          if </span><a href="#loc_883_48_883_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_883_48_883_51&#39;)"><span class="hl_varref"><span class="mpre">fld</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`List.elem`</span></span><span class="mpre"> </span><a href="#loc_881_23_881_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_881_23_881_29&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">
        then </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">  </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_883_48_883_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_883_48_883_51&#39;)"><span class="hl_varref"><span class="mpre">fld</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;&#39;&quot;</span></span><span class="mpre">)) </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_883_48_883_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_883_48_883_51&#39;)"><span class="hl_varref"><span class="mpre">fld</span></span></a><span class="mpre">))
        else </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_883_48_883_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_883_48_883_51&#39;)"><span class="hl_varref"><span class="mpre">fld</span></span></a><span class="mpre">)
      let </span><a name="loc_887_11_887_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_887_11_887_16&#39;)"><span class="hl_vardecl"><span class="mpre">cpats</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">) </span><a href="#loc_883_7_883_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_883_7_883_11&#39;)"><span class="hl_varref"><span class="mpre">vars</span></span></a><span class="mpre">               </span><span class="hl_comment"><span class="mpre">-- Deconstruction</span></span><span class="mpre">
          </span><a name="loc_888_11_888_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_888_11_888_16&#39;)"><span class="hl_vardecl"><span class="mpre">cvals</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">) </span><a href="#loc_883_7_883_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_883_7_883_11&#39;)"><span class="hl_varref"><span class="mpre">vars</span></span></a><span class="mpre">               </span><span class="hl_comment"><span class="mpre">-- Reconstruction</span></span><span class="mpre">
          </span><a name="loc_889_11_889_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_889_11_889_16&#39;)"><span class="hl_vardecl"><span class="mpre">fpats</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">)                 </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">lefts</span></span><span class="mpre"> </span><a href="#loc_883_7_883_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_883_7_883_11&#39;)"><span class="hl_varref"><span class="mpre">vars</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- Lambda patterns</span></span><span class="mpre">
          </span><a name="loc_890_11_890_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_890_11_890_16&#39;)"><span class="hl_vardecl"><span class="mpre">fvals</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_217_1_217_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_217_1_217_5&#39;)"><span class="hl_varref"><span class="mpre">appE</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_882_7_882_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_882_7_882_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">lefts</span></span><span class="mpre"> </span><a href="#loc_883_7_883_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_883_7_883_11&#39;)"><span class="hl_varref"><span class="mpre">vars</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- Functor applications</span></span><span class="mpre">
          </span><a name="loc_891_11_891_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_891_11_891_18&#39;)"><span class="hl_vardecl"><span class="mpre">conName</span></span></a><span class="mpre"> = </span><a href="#loc_881_18_881_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_881_18_881_21&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">
          </span><a name="loc_892_11_892_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_11_892_16&#39;)"><span class="hl_vardecl"><span class="mpre">recon</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_211_1_211_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_211_1_211_5&#39;)"><span class="hl_varref"><span class="mpre">conE</span></span></a><span class="mpre"> </span><a href="#loc_891_11_891_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_891_11_891_18&#39;)"><span class="hl_varref"><span class="mpre">conName</span></span></a><span class="mpre"> </span><a href="Control.Lens.Internal.TH.html#loc_35_1_35_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_35_1_35_7&#39;)"><span class="hl_infix"><span class="mpre">`appsE1`</span></span></a><span class="mpre"> </span><a href="#loc_888_11_888_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_888_11_888_16&#39;)"><span class="hl_varref"><span class="mpre">cvals</span></span></a><span class="mpre">

          </span><a name="loc_894_11_894_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_11_894_15&#39;)"><span class="hl_vardecl"><span class="mpre">fpat</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> </span><a href="#loc_881_23_881_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_881_23_881_29&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_100_1_100_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_100_1_100_6&#39;)"><span class="hl_varref"><span class="mpre">wildP</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">        = </span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_882_7_882_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_882_7_882_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
          </span><a name="loc_897_11_897_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_897_11_897_15&#39;)"><span class="hl_vardecl"><span class="mpre">expr</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><a href="#loc_872_19_872_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_19_872_30&#39;)"><span class="hl_varref"><span class="mpre">isTraversal</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_881_23_881_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_881_23_881_29&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
              = </span><a href="Language.Haskell.TH.Lib.html#loc_217_1_217_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_217_1_217_5&#39;)"><span class="hl_varref"><span class="mpre">appE</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 899, srcSpanStartColumn = 28, srcSpanEndLine = 899, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 899, srcSpanStartColumn = 28, srcSpanEndLine = 899, srcSpanEndColumn = 29}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;error</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_214_1_214_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_214_1_214_5&#39;)"><span class="hl_varref"><span class="mpre">litE</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_61_1_61_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_61_1_61_8&#39;)"><span class="hl_varref"><span class="mpre">stringL</span></span></a><span class="mpre">
              </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_872_31_872_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_31_872_39&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: expected a single matching field in &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_891_11_891_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_891_11_891_18&#39;)"><span class="hl_varref"><span class="mpre">conName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;, found &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_881_23_881_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_881_23_881_29&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">)
            | </span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> </span><a href="#loc_881_23_881_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_881_23_881_29&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">
              = </span><a href="Language.Haskell.TH.Lib.html#loc_217_1_217_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_217_1_217_5&#39;)"><span class="hl_varref"><span class="mpre">appE</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 902, srcSpanStartColumn = 28, srcSpanEndLine = 902, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 902, srcSpanStartColumn = 28, srcSpanEndLine = 902, srcSpanEndColumn = 29}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;pure</span></span><span class="mpre">) </span><a href="#loc_892_11_892_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_11_892_16&#39;)"><span class="hl_varref"><span class="mpre">recon</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">
              = let </span><a name="loc_904_21_904_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_904_21_904_25&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><a name="loc_904_34_904_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_904_34_904_35&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_227_1_227_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_227_1_227_7&#39;)"><span class="hl_varref"><span class="mpre">infixE</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_243_1_243_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_243_1_243_5&#39;)"><span class="hl_varref"><span class="mpre">lamE</span></span></a><span class="mpre"> </span><a href="#loc_889_11_889_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_889_11_889_16&#39;)"><span class="hl_varref"><span class="mpre">fpats</span></span></a><span class="mpre"> </span><a href="#loc_892_11_892_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_11_892_16&#39;)"><span class="hl_varref"><span class="mpre">recon</span></span></a><span class="mpre">) (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 904, srcSpanStartColumn = 84, srcSpanEndLine = 904, srcSpanEndColumn = 90}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 904, srcSpanStartColumn = 84, srcSpanEndLine = 904, srcSpanEndColumn = 85}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;(&lt;$&gt;)</span></span><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_904_34_904_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_904_34_904_35&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
                    </span><a href="#loc_904_21_904_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_904_21_904_25&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_905_32_905_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_905_32_905_33&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) </span><a name="loc_905_35_905_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_905_35_905_36&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_227_1_227_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_227_1_227_7&#39;)"><span class="hl_varref"><span class="mpre">infixE</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_905_32_905_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_905_32_905_33&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 905, srcSpanStartColumn = 68, srcSpanEndLine = 905, srcSpanEndColumn = 74}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 905, srcSpanStartColumn = 68, srcSpanEndLine = 905, srcSpanEndColumn = 69}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Contr"><span class="mpre">&#39;(&lt;*&gt;)</span></span><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_905_35_905_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_905_35_905_36&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
                in  </span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">List.foldl</span></span><span class="mpre"> </span><a href="#loc_904_21_904_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_904_21_904_25&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><a href="#loc_890_11_890_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_890_11_890_16&#39;)"><span class="hl_varref"><span class="mpre">fvals</span></span></a><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">-- = infixE (Just $ lamE fpats recon) (varE &#39;(&lt;$&gt;)) $ Just $ List.foldl1 (\l r -&gt; infixE (Just l) (varE &#39;(&lt;*&gt;)) (Just r)) fvals</span></span><span class="mpre">
      </span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [</span><a href="#loc_894_11_894_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_894_11_894_15&#39;)"><span class="hl_varref"><span class="mpre">fpat</span></span></a><span class="mpre">, </span><a href="Language.Haskell.TH.Lib.html#loc_76_1_76_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_76_1_76_5&#39;)"><span class="hl_varref"><span class="mpre">conP</span></span></a><span class="mpre"> </span><a href="#loc_891_11_891_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_891_11_891_18&#39;)"><span class="hl_varref"><span class="mpre">conName</span></span></a><span class="mpre"> </span><a href="#loc_887_11_887_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_887_11_887_16&#39;)"><span class="hl_varref"><span class="mpre">cpats</span></span></a><span class="mpre">] (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> </span><a href="#loc_897_11_897_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_897_11_897_15&#39;)"><span class="hl_varref"><span class="mpre">expr</span></span></a><span class="mpre">) []

    </span><span class="hl_comment"><span class="mpre">-- Non-record are never the target of a generated field lens body</span></span><span class="mpre">
    </span><a href="#loc_881_5_881_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_881_5_881_16&#39;)"><span class="hl_fundecl"><span class="mpre">buildClause</span></span></a><span class="mpre"> (</span><a name="loc_911_18_911_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_911_18_911_21&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">_fields</span></span><span class="mpre">) = do
      let </span><a name="loc_912_11_912_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_912_11_912_21&#39;)"><span class="hl_vardecl"><span class="mpre">fieldCount</span></span></a><span class="mpre"> = </span><a href="Control.Lens.Fold.html#loc_1081_1_1081_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Fold.html#loc_1081_1_1081_9&#39;)"><span class="hl_varref"><span class="mpre">lengthOf</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_376_1_376_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_376_1_376_10&#39;)"><span class="hl_varref"><span class="mpre">conFields</span></span></a><span class="mpre"> </span><a href="#loc_911_18_911_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_911_18_911_21&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">
      </span><a name="loc_913_7_913_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_913_7_913_11&#39;)"><span class="hl_vardecl"><span class="mpre">vars</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><a href="#loc_912_11_912_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_912_11_912_21&#39;)"><span class="hl_varref"><span class="mpre">fieldCount</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;x&quot;</span></span><span class="mpre">)
      let </span><a name="loc_914_11_914_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_11_914_18&#39;)"><span class="hl_vardecl"><span class="mpre">conName</span></span></a><span class="mpre"> = </span><a href="#loc_911_18_911_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_911_18_911_21&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">
          </span><a name="loc_915_11_915_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_915_11_915_15&#39;)"><span class="hl_vardecl"><span class="mpre">expr</span></span></a><span class="mpre">
            | </span><a href="#loc_872_19_872_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_19_872_30&#39;)"><span class="hl_varref"><span class="mpre">isTraversal</span></span></a><span class="mpre">       = </span><span class="warning" data-warning="ExpBracketExp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 916, srcSpanStartColumn = 35, srcSpanEndLine = 916, srcSpanEndColumn = 84}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 916, srcSpanStartColumn = 35, srcSpanEndLine = 916, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 91"><span class="mpre">[| pure $(conE conName `appsE1` map varE vars) |]</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- We must rebuild the value to support type changing</span></span><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         = </span><span class="warning" data-warning="ExpBracketExp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 917, srcSpanStartColumn = 35, srcSpanEndLine = 917, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 917, srcSpanStartColumn = 35, srcSpanEndLine = 917, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 91"><span class="mpre">[| error errorMsg |]</span></span><span class="mpre">
            where </span><span class="hl_vardecl"><span class="mpre">errorMsg</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_872_31_872_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_31_872_39&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: non-record constructors require traversals to be generated&quot;</span></span><span class="mpre">

      </span><span class="hl_comment"><span class="mpre">-- clause:  _ c@Con{} = expr</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- expr:    pure c</span></span><span class="mpre">
      </span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_100_1_100_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_100_1_100_6&#39;)"><span class="hl_varref"><span class="mpre">wildP</span></span></a><span class="mpre">, </span><a href="Language.Haskell.TH.Lib.html#loc_76_1_76_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_76_1_76_5&#39;)"><span class="hl_varref"><span class="mpre">conP</span></span></a><span class="mpre"> </span><a href="#loc_914_11_914_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_11_914_18&#39;)"><span class="hl_varref"><span class="mpre">conName</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_913_7_913_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_913_7_913_11&#39;)"><span class="hl_varref"><span class="mpre">vars</span></span></a><span class="mpre">)] (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> </span><a href="#loc_915_11_915_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_915_11_915_15&#39;)"><span class="hl_varref"><span class="mpre">expr</span></span></a><span class="mpre">) []

</span><a href="#loc_927_1_927_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_1_927_16&#39;)"><span class="mpre">makeFieldLenses</span></a><span class="mpre"> :: </span><a href="#loc_180_6_180_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_6_180_15&#39;)"><span class="hl_tyconref"><span class="mpre">LensRules</span></span></a><span class="mpre">
                -&gt; </span><a href="#loc_754_6_754_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_6_754_14&#39;)"><span class="hl_tyconref"><span class="mpre">DataDecl</span></span></a><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_927_1_927_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_1_927_16&#39;)"><span class="hl_fundecl"><span class="mpre">makeFieldLenses</span></span></a><span class="mpre"> </span><a name="loc_927_17_927_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_17_927_20&#39;)"><span class="hl_vardecl"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a name="loc_927_21_927_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_21_927_29&#39;)"><span class="hl_vardecl"><span class="mpre">dataDecl</span></span></a><span class="mpre"> = do
  let </span><a name="loc_928_7_928_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_928_7_928_13&#39;)"><span class="hl_vardecl"><span class="mpre">tyArgs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_701_1_701_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_1_701_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_758_5_758_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_5_758_19&#39;)"><span class="hl_varref"><span class="mpre">dataParameters</span></span></a><span class="mpre"> </span><a href="#loc_927_21_927_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_21_927_29&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">
      </span><a name="loc_929_7_929_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_7_929_21&#39;)"><span class="hl_vardecl"><span class="mpre">maybeLensClass</span></span></a><span class="mpre"> = </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="#loc_204_1_204_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_10&#39;)"><span class="hl_varref"><span class="mpre">lensClass</span></span></a><span class="mpre"> </span><a href="#loc_927_17_927_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_17_927_20&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><a href="#loc_756_5_756_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_756_5_756_14&#39;)"><span class="hl_varref"><span class="mpre">tyConName</span></span></a><span class="mpre"> </span><a href="#loc_927_21_927_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_21_927_29&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">
      </span><a name="loc_930_7_930_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_930_7_930_21&#39;)"><span class="hl_vardecl"><span class="mpre">maybeClassName</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">_1</span></span><span class="hl_infix"><span class="mpre">.</span></span><a href="Control.Lens.Getter.html#loc_121_1_121_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_121_1_121_3&#39;)"><span class="hl_varref"><span class="mpre">to</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre">) </span><a href="#loc_929_7_929_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_7_929_21&#39;)"><span class="hl_varref"><span class="mpre">maybeLensClass</span></span></a><span class="mpre">
      </span><a name="loc_931_7_931_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_931_7_931_11&#39;)"><span class="hl_vardecl"><span class="mpre">cons</span></span></a><span class="mpre"> = </span><a href="#loc_762_5_762_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_762_5_762_17&#39;)"><span class="hl_varref"><span class="mpre">constructors</span></span></a><span class="mpre"> </span><a href="#loc_927_21_927_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_21_927_29&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">
  </span><a name="loc_932_3_932_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_932_3_932_4&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;t&quot;</span></span><span class="mpre">
  </span><a name="loc_933_3_933_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_933_3_933_4&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;a&quot;</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">--TODO: there&#39;s probably a more efficient way to do this.</span></span><span class="mpre">
  </span><a name="loc_936_3_936_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_936_3_936_13&#39;)"><span class="hl_vardecl"><span class="mpre">lensFields</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\</span><a name="loc_936_23_936_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_936_23_936_25&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_936_23_936_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_936_23_936_25&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_936_23_936_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_936_23_936_25&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">))
              </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.List.html#loc_739_1_739_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_739_1_739_8&#39;)"><span class="hl_varref"><span class="mpre">groupBy</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">(==)</span></span><span class="mpre"> </span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="hl_infix"><span class="mpre">`on`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.List.html#loc_810_1_810_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_810_1_810_7&#39;)"><span class="hl_varref"><span class="mpre">sortBy</span></span></a><span class="mpre"> (</span><a href="Data.Ord.html#loc_37_1_37_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Ord.html#loc_37_1_37_10&#39;)"><span class="hl_varref"><span class="mpre">comparing</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">)
              </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre">
            </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> (</span><a href="#loc_1043_1_1043_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1043_1_1043_14&#39;)"><span class="hl_varref"><span class="mpre">getLensFields</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="#loc_199_1_199_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_10&#39;)"><span class="hl_varref"><span class="mpre">lensField</span></span></a><span class="mpre"> </span><a href="#loc_927_17_927_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_17_927_20&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="mpre">) </span><a href="#loc_931_7_931_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_931_7_931_11&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- varMultiSet knows how many usages of the type variables there are.</span></span><span class="mpre">
  let </span><a name="loc_942_7_942_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_942_7_942_18&#39;)"><span class="hl_vardecl"><span class="mpre">varMultiSet</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">List.concatMap</span></span><span class="mpre"> (</span><a href="Control.Lens.Fold.html#loc_543_1_543_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Fold.html#loc_543_1_543_9&#39;)"><span class="hl_varref"><span class="mpre">toListOf</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lens.html#loc_376_1_376_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_376_1_376_10&#39;)"><span class="hl_varref"><span class="mpre">conFields</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">_2</span></span><span class="hl_infix"><span class="mpre">.</span></span><a href="Language.Haskell.TH.Lens.html#loc_346_1_346_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_346_1_346_9&#39;)"><span class="hl_varref"><span class="mpre">typeVars</span></span></a><span class="mpre">)) </span><a href="#loc_931_7_931_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_931_7_931_11&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre">
      </span><a name="loc_943_7_943_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_943_7_943_13&#39;)"><span class="hl_vardecl"><span class="mpre">varSet</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">Set.fromList</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">) </span><a href="#loc_928_7_928_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_928_7_928_13&#39;)"><span class="hl_varref"><span class="mpre">tyArgs</span></span></a><span class="mpre">

  </span><a name="loc_945_3_945_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_3_945_9&#39;)"><span class="hl_vardecl"><span class="mpre">bodies</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Traversable.html#loc_210_1_210_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_210_1_210_4&#39;)"><span class="hl_varref"><span class="mpre">for</span></span></a><span class="mpre"> </span><a href="#loc_936_3_936_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_936_3_936_13&#39;)"><span class="hl_varref"><span class="mpre">lensFields</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \(</span><a name="loc_945_32_945_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_32_945_40&#39;)"><span class="hl_vardecl"><span class="mpre">lensName</span></span></a><span class="mpre">, </span><a name="loc_945_42_945_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_42_945_48&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre">) -&gt; do
    let </span><a name="loc_946_9_946_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_946_9_946_19&#39;)"><span class="hl_vardecl"><span class="mpre">fieldTypes</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">_3</span></span><span class="mpre">) </span><a href="#loc_945_42_945_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_42_945_48&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- All of the polymorphic variables not involved in these fields</span></span><span class="mpre">
        </span><a name="loc_948_9_948_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_948_9_948_18&#39;)"><span class="hl_vardecl"><span class="mpre">otherVars</span></span></a><span class="mpre"> = </span><a href="#loc_942_7_942_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_942_7_942_18&#39;)"><span class="hl_varref"><span class="mpre">varMultiSet</span></span></a><span class="mpre"> </span><a href="Data.List.html#loc_378_1_378_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_378_1_378_5&#39;)"><span class="hl_infix"><span class="mpre">List.\\</span></span></a><span class="mpre"> </span><a href="#loc_946_9_946_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_946_9_946_19&#39;)"><span class="hl_varref"><span class="mpre">fieldTypes</span></span></a><span class="hl_infix"><span class="mpre">^..</span></span><a href="Language.Haskell.TH.Lens.html#loc_346_1_346_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_346_1_346_9&#39;)"><span class="hl_varref"><span class="mpre">typeVars</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- New type variable binders, and the type to represent the selected fields</span></span><span class="mpre">
    (</span><a name="loc_950_6_950_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_6_950_13&#39;)"><span class="hl_vardecl"><span class="mpre">tyArgs&#39;</span></span></a><span class="mpre">, </span><a name="loc_950_15_950_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_15_950_18&#39;)"><span class="hl_vardecl"><span class="mpre">cty</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_1062_1_1062_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1062_1_1062_11&#39;)"><span class="hl_varref"><span class="mpre">unifyTypes</span></span></a><span class="mpre"> </span><a href="#loc_928_7_928_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_928_7_928_13&#39;)"><span class="hl_varref"><span class="mpre">tyArgs</span></span></a><span class="mpre"> </span><a href="#loc_946_9_946_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_946_9_946_19&#39;)"><span class="hl_varref"><span class="mpre">fieldTypes</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Map for the polymorphic variables that are only involved in these fields, to new names for them.</span></span><span class="mpre">
    </span><a name="loc_952_5_952_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_952_5_952_6&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_661_1_661_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_1_661_9&#39;)"><span class="hl_varref"><span class="mpre">freshMap</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Set.difference</span></span><span class="mpre"> </span><a href="#loc_943_7_943_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_943_7_943_13&#39;)"><span class="hl_varref"><span class="mpre">varSet</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Set.fromList</span></span><span class="mpre"> </span><a href="#loc_948_9_948_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_948_9_948_18&#39;)"><span class="hl_varref"><span class="mpre">otherVars</span></span></a><span class="mpre">
    let </span><a name="loc_953_9_953_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_953_9_953_12&#39;)"><span class="hl_vardecl"><span class="mpre">aty</span></span></a><span class="mpre"> | </span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> </span><a href="#loc_930_7_930_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_930_7_930_21&#39;)"><span class="hl_varref"><span class="mpre">maybeClassName</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">VarT</span></span><span class="mpre"> </span><a href="#loc_932_3_932_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_932_3_932_4&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">             = </span><a href="#loc_759_5_759_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_5_759_13&#39;)"><span class="hl_varref"><span class="mpre">fullType</span></span></a><span class="mpre"> </span><a href="#loc_927_21_927_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_21_927_29&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">VarT</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">) </span><a href="#loc_950_6_950_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_6_950_13&#39;)"><span class="hl_varref"><span class="mpre">tyArgs&#39;</span></span></a><span class="mpre">
        </span><a name="loc_955_9_955_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_955_9_955_12&#39;)"><span class="hl_vardecl"><span class="mpre">bty</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lens.html#loc_350_1_350_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_350_1_350_14&#39;)"><span class="hl_varref"><span class="mpre">substTypeVars</span></span></a><span class="mpre"> </span><a href="#loc_952_5_952_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_952_5_952_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_953_9_953_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_953_9_953_12&#39;)"><span class="hl_varref"><span class="mpre">aty</span></span></a><span class="mpre">
        </span><a name="loc_956_9_956_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_956_9_956_12&#39;)"><span class="hl_vardecl"><span class="mpre">dty</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lens.html#loc_350_1_350_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_350_1_350_14&#39;)"><span class="hl_varref"><span class="mpre">substTypeVars</span></span></a><span class="mpre"> </span><a href="#loc_952_5_952_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_952_5_952_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_950_15_950_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_15_950_18&#39;)"><span class="hl_varref"><span class="mpre">cty</span></span></a><span class="mpre">

        </span><a name="loc_958_9_958_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_958_9_958_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="Data.Set.Lens.html#loc_55_1_55_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Set.Lens.html#loc_55_1_55_6&#39;)"><span class="hl_varref"><span class="mpre">setOf</span></span></a><span class="mpre"> </span><a href="Control.Lens.Fold.html#loc_218_1_218_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Fold.html#loc_218_1_218_7&#39;)"><span class="hl_varref"><span class="mpre">folded</span></span></a><span class="mpre"> </span><a href="#loc_952_5_952_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_952_5_952_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
        </span><a name="loc_959_9_959_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_959_9_959_21&#39;)"><span class="hl_fundecl"><span class="mpre">relevantBndr</span></span></a><span class="mpre"> </span><a name="loc_959_22_959_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_959_22_959_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_958_9_958_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_958_9_958_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><span class="hl_varref"><span class="mpre">contains</span></span><span class="mpre"> (</span><a href="#loc_959_22_959_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_959_22_959_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">)
        </span><a name="loc_960_9_960_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_960_9_960_20&#39;)"><span class="hl_vardecl"><span class="mpre">relevantCtx</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Set.null</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Set.intersection</span></span><span class="mpre"> </span><a href="#loc_958_9_958_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_958_9_958_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Set.Lens.html#loc_55_1_55_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Set.Lens.html#loc_55_1_55_6&#39;)"><span class="hl_varref"><span class="mpre">setOf</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_346_1_346_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_346_1_346_9&#39;)"><span class="hl_varref"><span class="mpre">typeVars</span></span></a><span class="mpre">
        </span><a name="loc_961_9_961_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_961_9_961_12&#39;)"><span class="hl_vardecl"><span class="mpre">tvs</span></span></a><span class="mpre"> = </span><a href="#loc_950_6_950_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_6_950_13&#39;)"><span class="hl_varref"><span class="mpre">tyArgs&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> </span><a href="#loc_959_9_959_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_959_9_959_21&#39;)"><span class="hl_varref"><span class="mpre">relevantBndr</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lens.html#loc_350_1_350_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_350_1_350_14&#39;)"><span class="hl_varref"><span class="mpre">substTypeVars</span></span></a><span class="mpre"> </span><a href="#loc_952_5_952_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_952_5_952_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_950_6_950_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_6_950_13&#39;)"><span class="hl_varref"><span class="mpre">tyArgs&#39;</span></span></a><span class="mpre">)
        </span><a name="loc_962_9_962_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_962_9_962_12&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> = </span><a href="#loc_755_5_755_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_755_5_755_16&#39;)"><span class="hl_varref"><span class="mpre">dataContext</span></span></a><span class="mpre"> </span><a href="#loc_927_21_927_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_21_927_29&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">
        </span><a name="loc_963_9_963_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_963_9_963_11&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> </span><a href="#loc_960_9_960_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_960_9_960_20&#39;)"><span class="hl_varref"><span class="mpre">relevantCtx</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lens.html#loc_350_1_350_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_350_1_350_14&#39;)"><span class="hl_varref"><span class="mpre">substTypeVars</span></span></a><span class="mpre"> </span><a href="#loc_952_5_952_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_952_5_952_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_962_9_962_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_962_9_962_12&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre">)
        </span><a name="loc_964_9_964_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_964_9_964_11&#39;)"><span class="hl_vardecl"><span class="mpre">qs</span></span></a><span class="mpre"> = case </span><a href="#loc_930_7_930_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_930_7_930_21&#39;)"><span class="hl_varref"><span class="mpre">maybeClassName</span></span></a><span class="mpre"> of
#if MIN_VERSION_template_haskell(2,10,0)
           </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_966_17_966_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_966_17_966_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_927_17_927_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_17_927_20&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_160_1_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_12&#39;)"><span class="hl_varref"><span class="mpre">createClass</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">AppT</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ConT</span></span><span class="mpre"> </span><a href="#loc_966_17_966_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_966_17_966_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">VarT</span></span><span class="mpre"> </span><a href="#loc_932_3_932_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_932_3_932_4&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (</span><a href="#loc_962_9_962_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_962_9_962_12&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_963_9_963_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_963_9_963_11&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">)
#else
           </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_968_17_968_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_17_968_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_927_17_927_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_17_927_20&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_160_1_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_12&#39;)"><span class="hl_varref"><span class="mpre">createClass</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">ClassP</span></span><span class="mpre"> </span><a href="#loc_968_17_968_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_17_968_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">VarT</span></span><span class="mpre"> </span><a href="#loc_932_3_932_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_932_3_932_4&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (</span><a href="#loc_962_9_962_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_962_9_962_12&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_963_9_963_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_963_9_963_11&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">)
#endif
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">              -&gt; </span><a href="#loc_963_9_963_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_963_9_963_11&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">
           _                               -&gt; </span><a href="#loc_962_9_962_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_962_9_962_12&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_963_9_963_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_963_9_963_11&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">
        </span><a name="loc_972_9_972_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_972_9_972_13&#39;)"><span class="hl_vardecl"><span class="mpre">tvs&#39;</span></span></a><span class="mpre"> = case </span><a href="#loc_930_7_930_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_930_7_930_21&#39;)"><span class="hl_varref"><span class="mpre">maybeClassName</span></span></a><span class="mpre"> of
           </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> _ | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_927_17_927_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_17_927_20&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_160_1_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_12&#39;)"><span class="hl_varref"><span class="mpre">createClass</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">PlainTV</span></span><span class="mpre"> </span><a href="#loc_932_3_932_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_932_3_932_4&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_961_9_961_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_961_9_961_12&#39;)"><span class="hl_varref"><span class="mpre">tvs</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">              -&gt; []
           _                               -&gt; </span><a href="#loc_961_9_961_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_961_9_961_12&#39;)"><span class="hl_varref"><span class="mpre">tvs</span></span></a><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">--TODO: Better way to write this?</span></span><span class="mpre">
        </span><a name="loc_978_9_978_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_9_978_17&#39;)"><span class="hl_vardecl"><span class="mpre">fieldMap</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromListWith</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(++)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(</span><a name="loc_978_47_978_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_47_978_49&#39;)"><span class="hl_vardecl"><span class="mpre">cn</span></span></a><span class="mpre">,</span><a name="loc_978_50_978_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_50_978_52&#39;)"><span class="hl_vardecl"><span class="mpre">fn</span></span></a><span class="mpre">,_) -&gt; (</span><a href="#loc_978_47_978_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_47_978_49&#39;)"><span class="hl_varref"><span class="mpre">cn</span></span></a><span class="mpre">, [</span><a href="#loc_978_50_978_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_50_978_52&#39;)"><span class="hl_varref"><span class="mpre">fn</span></span></a><span class="mpre">])) </span><a href="#loc_945_42_945_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_42_945_48&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">
        </span><a name="loc_979_9_979_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_979_9_979_16&#39;)"><span class="hl_vardecl"><span class="mpre">conList</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\</span><a name="loc_979_25_979_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_979_25_979_26&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_979_25_979_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_979_25_979_26&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">Map.findWithDefault</span></span><span class="mpre"> [] (</span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_979_25_979_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_979_25_979_26&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_978_9_978_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_978_9_978_17&#39;)"><span class="hl_varref"><span class="mpre">fieldMap</span></span></a><span class="mpre">)) </span><a href="#loc_931_7_931_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_931_7_931_11&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre">
        </span><a name="loc_980_9_980_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_9_980_24&#39;)"><span class="hl_vardecl"><span class="mpre">maybeMethodName</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">_2</span></span><span class="mpre">) </span><a href="#loc_929_7_929_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_7_929_21&#39;)"><span class="hl_varref"><span class="mpre">maybeLensClass</span></span></a><span class="mpre">

    </span><a name="loc_982_5_982_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_982_5_982_16&#39;)"><span class="hl_vardecl"><span class="mpre">isTraversal</span></span></a><span class="mpre"> &lt;- do
      let </span><a name="loc_983_11_983_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_983_11_983_22&#39;)"><span class="hl_vardecl"><span class="mpre">notSingular</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">) </span><a href="#loc_979_9_979_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_979_9_979_16&#39;)"><span class="hl_varref"><span class="mpre">conList</span></span></a><span class="mpre">
          </span><a name="loc_984_11_984_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_11_984_18&#39;)"><span class="hl_fundecl"><span class="mpre">showCon</span></span></a><span class="mpre"> (</span><a name="loc_984_20_984_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_20_984_21&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">, </span><a name="loc_984_23_984_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_23_984_25&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre">) = </span><a href="Language.Haskell.TH.Ppr.html#loc_34_1_34_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Ppr.html#loc_34_1_34_7&#39;)"><span class="hl_varref"><span class="mpre">pprint</span></span></a><span class="mpre"> (</span><a href="#loc_984_20_984_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_20_984_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; { &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="hl_varref"><span class="mpre">intercalate</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;, &quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Ppr.html#loc_34_1_34_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Ppr.html#loc_34_1_34_7&#39;)"><span class="hl_varref"><span class="mpre">pprint</span></span></a><span class="mpre"> </span><a href="#loc_984_23_984_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_23_984_25&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; }&quot;</span></span><span class="mpre">
      case (</span><a href="#loc_927_17_927_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_17_927_20&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_139_1_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_16&#39;)"><span class="hl_varref"><span class="mpre">buildTraversals</span></span></a><span class="mpre">, </span><a href="#loc_927_17_927_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_17_927_20&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_133_1_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_14&#39;)"><span class="hl_varref"><span class="mpre">partialLenses</span></span></a><span class="mpre">) of
        (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,  </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Cannot makeLensesWith both of the flags buildTraversals and partialLenses.&quot;</span></span><span class="mpre">
        (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
        (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,  </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> </span><a href="#loc_983_11_983_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_983_11_983_22&#39;)"><span class="hl_varref"><span class="mpre">notSingular</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
                       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> </span><a href="#loc_983_11_983_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_983_11_983_22&#39;)"><span class="hl_varref"><span class="mpre">notSingular</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
                       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.List.html#loc_1060_1_1060_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1060_1_1060_8&#39;)"><span class="hl_varref"><span class="mpre">unlines</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
          [ </span><span class="hl_string"><span class="mpre">&quot;Cannot use &#39;makeLensesWith&#39; with constructors that don&#39;t map just one field&quot;</span></span><span class="mpre">
          , </span><span class="hl_string"><span class="mpre">&quot;to a lens, without using either the buildTraversals or partialLenses flags.&quot;</span></span><span class="mpre">
          , if </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_979_9_979_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_979_9_979_16&#39;)"><span class="hl_varref"><span class="mpre">conList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
            then </span><span class="hl_string"><span class="mpre">&quot;The following constructor failed this criterion for the &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Ppr.html#loc_34_1_34_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Ppr.html#loc_34_1_34_7&#39;)"><span class="hl_varref"><span class="mpre">pprint</span></span></a><span class="mpre"> </span><a href="#loc_945_32_945_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_32_945_40&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; lens:&quot;</span></span><span class="mpre">
            else </span><span class="hl_string"><span class="mpre">&quot;The following constructors failed this criterion for the &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Ppr.html#loc_34_1_34_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Ppr.html#loc_34_1_34_7&#39;)"><span class="hl_varref"><span class="mpre">pprint</span></span></a><span class="mpre"> </span><a href="#loc_945_32_945_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_32_945_40&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; lens:&quot;</span></span><span class="mpre">
          ] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_984_11_984_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_984_11_984_18&#39;)"><span class="hl_varref"><span class="mpre">showCon</span></span></a><span class="mpre"> </span><a href="#loc_979_9_979_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_979_9_979_16&#39;)"><span class="hl_varref"><span class="mpre">conList</span></span></a><span class="mpre">

    let </span><a name="loc_999_9_999_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_999_9_999_13&#39;)"><span class="hl_vardecl"><span class="mpre">decl</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">SigD</span></span><span class="mpre"> </span><a href="#loc_945_32_945_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_32_945_40&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre">
             </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> case </span><a href="#loc_950_15_950_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_15_950_18&#39;)"><span class="hl_varref"><span class="mpre">cty</span></span></a><span class="mpre"> of
                 </span><span class="hl_conref"><span class="mpre">ForallT</span></span><span class="mpre"> </span><a name="loc_1001_26_1001_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1001_26_1001_34&#39;)"><span class="hl_vardecl"><span class="mpre">innerTys</span></span></a><span class="mpre"> </span><a name="loc_1001_35_1001_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1001_35_1001_43&#39;)"><span class="hl_vardecl"><span class="mpre">innerCxt</span></span></a><span class="mpre"> </span><a name="loc_1001_44_1001_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1001_44_1001_48&#39;)"><span class="hl_vardecl"><span class="mpre">cty&#39;</span></span></a><span class="mpre"> -&gt;
                   </span><span class="hl_conref"><span class="mpre">ForallT</span></span><span class="mpre"> (</span><a href="#loc_972_9_972_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_972_9_972_13&#39;)"><span class="hl_varref"><span class="mpre">tvs&#39;</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_1001_26_1001_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1001_26_1001_34&#39;)"><span class="hl_varref"><span class="mpre">innerTys</span></span></a><span class="mpre">) (</span><a href="#loc_964_9_964_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_964_9_964_11&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_1001_35_1001_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1001_35_1001_43&#39;)"><span class="hl_varref"><span class="mpre">innerCxt</span></span></a><span class="mpre">)
                    </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_705_1_705_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_5&#39;)"><span class="hl_varref"><span class="mpre">apps</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ConT</span></span><span class="mpre"> (if </span><a href="#loc_982_5_982_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_982_5_982_16&#39;)"><span class="hl_varref"><span class="mpre">isTraversal</span></span></a><span class="mpre"> then </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1003, srcSpanStartColumn = 55, srcSpanEndLine = 1003, srcSpanEndColumn = 61}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1003, srcSpanStartColumn = 55, srcSpanEndLine = 1003, srcSpanEndColumn = 57}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/C"><span class="mpre">&#39;&#39;Fold</span></span><span class="mpre"> else </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1003, srcSpanStartColumn = 67, srcSpanEndLine = 1003, srcSpanEndColumn = 75}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1003, srcSpanStartColumn = 67, srcSpanEndLine = 1003, srcSpanEndColumn = 69}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/C"><span class="mpre">&#39;&#39;Getter</span></span><span class="mpre">)) [</span><a href="#loc_953_9_953_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_953_9_953_12&#39;)"><span class="hl_varref"><span class="mpre">aty</span></span></a><span class="mpre">,</span><a href="#loc_1001_44_1001_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1001_44_1001_48&#39;)"><span class="hl_varref"><span class="mpre">cty&#39;</span></span></a><span class="mpre">]
                 _ -&gt;
                   </span><span class="hl_conref"><span class="mpre">ForallT</span></span><span class="mpre"> </span><a href="#loc_972_9_972_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_972_9_972_13&#39;)"><span class="hl_varref"><span class="mpre">tvs&#39;</span></span></a><span class="mpre"> </span><a href="#loc_964_9_964_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_964_9_964_11&#39;)"><span class="hl_varref"><span class="mpre">qs</span></span></a><span class="mpre">
                    </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> if </span><a href="#loc_953_9_953_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_953_9_953_12&#39;)"><span class="hl_varref"><span class="mpre">aty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_955_9_955_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_955_9_955_12&#39;)"><span class="hl_varref"><span class="mpre">bty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_950_15_950_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_15_950_18&#39;)"><span class="hl_varref"><span class="mpre">cty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_956_9_956_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_956_9_956_12&#39;)"><span class="hl_varref"><span class="mpre">dty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_927_17_927_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_17_927_20&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_126_1_126_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_13&#39;)"><span class="hl_varref"><span class="mpre">simpleLenses</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> </span><a href="#loc_930_7_930_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_930_7_930_21&#39;)"><span class="hl_varref"><span class="mpre">maybeClassName</span></span></a><span class="mpre">
                      then </span><a href="#loc_705_1_705_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_5&#39;)"><span class="hl_varref"><span class="mpre">apps</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ConT</span></span><span class="mpre"> (if </span><a href="#loc_982_5_982_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_982_5_982_16&#39;)"><span class="hl_varref"><span class="mpre">isTraversal</span></span></a><span class="mpre"> then </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1007, srcSpanStartColumn = 60, srcSpanEndLine = 1007, srcSpanEndColumn = 72}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1007, srcSpanStartColumn = 60, srcSpanEndLine = 1007, srcSpanEndColumn = 62}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/C"><span class="mpre">&#39;&#39;Traversal&#39;</span></span><span class="mpre"> else </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1007, srcSpanStartColumn = 78, srcSpanEndLine = 1007, srcSpanEndColumn = 85}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1007, srcSpanStartColumn = 78, srcSpanEndLine = 1007, srcSpanEndColumn = 80}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/C"><span class="mpre">&#39;&#39;Lens&#39;</span></span><span class="mpre">)) [</span><a href="#loc_953_9_953_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_953_9_953_12&#39;)"><span class="hl_varref"><span class="mpre">aty</span></span></a><span class="mpre">,</span><a href="#loc_950_15_950_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_15_950_18&#39;)"><span class="hl_varref"><span class="mpre">cty</span></span></a><span class="mpre">]
                      else </span><a href="#loc_705_1_705_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_5&#39;)"><span class="hl_varref"><span class="mpre">apps</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ConT</span></span><span class="mpre"> (if </span><a href="#loc_982_5_982_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_982_5_982_16&#39;)"><span class="hl_varref"><span class="mpre">isTraversal</span></span></a><span class="mpre"> then </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1008, srcSpanStartColumn = 60, srcSpanEndLine = 1008, srcSpanEndColumn = 71}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1008, srcSpanStartColumn = 60, srcSpanEndLine = 1008, srcSpanEndColumn = 62}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/C"><span class="mpre">&#39;&#39;Traversal</span></span><span class="mpre"> else </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1008, srcSpanStartColumn = 77, srcSpanEndLine = 1008, srcSpanEndColumn = 83}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1008, srcSpanStartColumn = 77, srcSpanEndLine = 1008, srcSpanEndColumn = 79}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/C"><span class="mpre">&#39;&#39;Lens</span></span><span class="mpre">)) [</span><a href="#loc_953_9_953_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_953_9_953_12&#39;)"><span class="hl_varref"><span class="mpre">aty</span></span></a><span class="mpre">,</span><a href="#loc_955_9_955_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_955_9_955_12&#39;)"><span class="hl_varref"><span class="mpre">bty</span></span></a><span class="mpre">,</span><a href="#loc_950_15_950_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_15_950_18&#39;)"><span class="hl_varref"><span class="mpre">cty</span></span></a><span class="mpre">,</span><a href="#loc_956_9_956_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_956_9_956_12&#39;)"><span class="hl_varref"><span class="mpre">dty</span></span></a><span class="mpre">]

    </span><a name="loc_1010_5_1010_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1010_5_1010_9&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> &lt;- case </span><a href="#loc_950_15_950_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_950_15_950_18&#39;)"><span class="hl_varref"><span class="mpre">cty</span></span></a><span class="mpre"> of
              </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1011, srcSpanStartColumn = 15, srcSpanEndLine = 1011, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1011, srcSpanStartColumn = 23, srcSpanEndLine = 1011, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1011"><span class="mpre">ForallT {}</span></span><span class="mpre"> -&gt; </span><a href="#loc_823_1_823_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_823_1_823_20&#39;)"><span class="hl_varref"><span class="mpre">makeFieldGetterBody</span></span></a><span class="mpre"> </span><a href="#loc_982_5_982_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_982_5_982_16&#39;)"><span class="hl_varref"><span class="mpre">isTraversal</span></span></a><span class="mpre"> </span><a href="#loc_945_32_945_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_32_945_40&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><a href="#loc_979_9_979_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_979_9_979_16&#39;)"><span class="hl_varref"><span class="mpre">conList</span></span></a><span class="mpre"> </span><a href="#loc_980_9_980_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_9_980_24&#39;)"><span class="hl_varref"><span class="mpre">maybeMethodName</span></span></a><span class="mpre">
              _          -&gt; </span><a href="#loc_872_1_872_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_1_872_18&#39;)"><span class="hl_varref"><span class="mpre">makeFieldLensBody</span></span></a><span class="mpre"> </span><a href="#loc_982_5_982_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_982_5_982_16&#39;)"><span class="hl_varref"><span class="mpre">isTraversal</span></span></a><span class="mpre"> </span><a href="#loc_945_32_945_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_32_945_40&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><a href="#loc_979_9_979_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_979_9_979_16&#39;)"><span class="hl_varref"><span class="mpre">conList</span></span></a><span class="mpre"> </span><a href="#loc_980_9_980_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_9_980_24&#39;)"><span class="hl_varref"><span class="mpre">maybeMethodName</span></span></a><span class="mpre">
#ifndef INLINING
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> if </span><a href="#loc_927_17_927_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_17_927_20&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_176_1_176_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_19&#39;)"><span class="hl_varref"><span class="mpre">generateSignatures</span></span></a><span class="mpre"> then [</span><a href="#loc_999_9_999_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_999_9_999_13&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre">, </span><a href="#loc_1010_5_1010_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1010_5_1010_9&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">] else [</span><a href="#loc_1010_5_1010_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1010_5_1010_9&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">]
#else
    </span><a name="loc_1016_5_1016_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1016_5_1016_13&#39;)"><span class="hl_vardecl"><span class="mpre">inlining</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_1152_1_1152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1152_1_1152_13&#39;)"><span class="hl_varref"><span class="mpre">inlinePragma</span></span></a><span class="mpre"> </span><a href="#loc_945_32_945_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_32_945_40&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> if </span><a href="#loc_927_17_927_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_17_927_20&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_176_1_176_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_19&#39;)"><span class="hl_varref"><span class="mpre">generateSignatures</span></span></a><span class="mpre"> then [</span><a href="#loc_999_9_999_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_999_9_999_13&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre">, </span><a href="#loc_1010_5_1010_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1010_5_1010_9&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">, </span><a href="#loc_1016_5_1016_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1016_5_1016_13&#39;)"><span class="hl_varref"><span class="mpre">inlining</span></span></a><span class="mpre">] else [</span><a href="#loc_1010_5_1010_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1010_5_1010_9&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">, </span><a href="#loc_1016_5_1016_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1016_5_1016_13&#39;)"><span class="hl_varref"><span class="mpre">inlining</span></span></a><span class="mpre">]
#endif
  let </span><a name="loc_1019_7_1019_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1019_7_1019_11&#39;)"><span class="hl_vardecl"><span class="mpre">defs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">Prelude.concat</span></span><span class="mpre"> </span><a href="#loc_945_3_945_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_945_3_945_9&#39;)"><span class="hl_varref"><span class="mpre">bodies</span></span></a><span class="mpre">
  case </span><a href="#loc_929_7_929_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_7_929_21&#39;)"><span class="hl_varref"><span class="mpre">maybeLensClass</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_1019_7_1019_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1019_7_1019_11&#39;)"><span class="hl_varref"><span class="mpre">defs</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_1022_11_1022_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1022_11_1022_24&#39;)"><span class="hl_vardecl"><span class="mpre">clsNameString</span></span></a><span class="mpre">, </span><a name="loc_1022_26_1022_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1022_26_1022_42&#39;)"><span class="hl_vardecl"><span class="mpre">methodNameString</span></span></a><span class="mpre">) -&gt; do
      let </span><a name="loc_1023_11_1023_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1023_11_1023_18&#39;)"><span class="hl_vardecl"><span class="mpre">clsName</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><a href="#loc_1022_11_1022_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1022_11_1022_24&#39;)"><span class="hl_varref"><span class="mpre">clsNameString</span></span></a><span class="mpre">
          </span><a name="loc_1024_11_1024_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1024_11_1024_21&#39;)"><span class="hl_vardecl"><span class="mpre">methodName</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><a href="#loc_1022_26_1022_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1022_26_1022_42&#39;)"><span class="hl_varref"><span class="mpre">methodNameString</span></span></a><span class="mpre">
          </span><a name="loc_1025_11_1025_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1025_11_1025_18&#39;)"><span class="hl_vardecl"><span class="mpre">varArgs</span></span></a><span class="mpre">    = </span><a href="Language.Haskell.TH.Lib.html#loc_507_1_507_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_507_1_507_5&#39;)"><span class="hl_varref"><span class="mpre">varT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_928_7_928_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_928_7_928_13&#39;)"><span class="hl_varref"><span class="mpre">tyArgs</span></span></a><span class="mpre">
          </span><a name="loc_1026_11_1026_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1026_11_1026_21&#39;)"><span class="hl_vardecl"><span class="mpre">appliedCon</span></span></a><span class="mpre"> = </span><a href="#loc_759_5_759_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_5_759_13&#39;)"><span class="hl_varref"><span class="mpre">fullType</span></span></a><span class="mpre"> </span><a href="#loc_927_21_927_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_21_927_29&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Data.Traversable.html#loc_155_5_155_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_155_5_155_14&#39;)"><span class="hl_varref"><span class="mpre">sequenceA</span></span></a><span class="mpre"> </span><a href="#loc_1025_11_1025_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1025_11_1025_18&#39;)"><span class="hl_varref"><span class="mpre">varArgs</span></span></a><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">Prelude.sequence</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (\_ -&gt; </span><a href="#loc_927_17_927_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_17_927_20&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_160_1_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_12&#39;)"><span class="hl_varref"><span class="mpre">createClass</span></span></a><span class="mpre">) [
          </span><a href="Language.Haskell.TH.Lib.html#loc_349_1_349_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_349_1_349_7&#39;)"><span class="hl_varref"><span class="mpre">classD</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []) </span><a href="#loc_1023_11_1023_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1023_11_1023_18&#39;)"><span class="hl_varref"><span class="mpre">clsName</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">PlainTV</span></span><span class="mpre"> </span><a href="#loc_932_3_932_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_932_3_932_4&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_928_7_928_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_928_7_928_13&#39;)"><span class="hl_varref"><span class="mpre">tyArgs</span></span></a><span class="mpre">) (if </span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> </span><a href="#loc_928_7_928_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_928_7_928_13&#39;)"><span class="hl_varref"><span class="mpre">tyArgs</span></span></a><span class="mpre"> then [] else [</span><span class="hl_conref"><span class="mpre">FunDep</span></span><span class="mpre"> [</span><a href="#loc_932_3_932_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_932_3_932_4&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">] (</span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_928_7_928_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_928_7_928_13&#39;)"><span class="hl_varref"><span class="mpre">tyArgs</span></span></a><span class="mpre">)]) (
            </span><a href="Language.Haskell.TH.Lib.html#loc_364_1_364_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_364_1_364_5&#39;)"><span class="hl_varref"><span class="mpre">sigD</span></span></a><span class="mpre"> </span><a href="#loc_1024_11_1024_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1024_11_1024_21&#39;)"><span class="hl_varref"><span class="mpre">methodName</span></span></a><span class="mpre"> (</span><a href="Control.Lens.Internal.TH.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_32_1_32_6&#39;)"><span class="hl_varref"><span class="mpre">appsT</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_510_1_510_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_510_1_510_5&#39;)"><span class="hl_varref"><span class="mpre">conT</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1030, srcSpanStartColumn = 42, srcSpanEndLine = 1030, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1030, srcSpanStartColumn = 42, srcSpanEndLine = 1030, srcSpanEndColumn = 44}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/C"><span class="mpre">&#39;&#39;Lens&#39;</span></span><span class="mpre">) [</span><a href="Language.Haskell.TH.Lib.html#loc_507_1_507_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_507_1_507_5&#39;)"><span class="hl_varref"><span class="mpre">varT</span></span></a><span class="mpre"> </span><a href="#loc_932_3_932_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_932_3_932_4&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">, </span><a href="#loc_1026_11_1026_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1026_11_1026_21&#39;)"><span class="hl_varref"><span class="mpre">appliedCon</span></span></a><span class="mpre">]) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_1019_7_1019_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1019_7_1019_11&#39;)"><span class="hl_varref"><span class="mpre">defs</span></span></a><span class="mpre">)]
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (\_ -&gt; </span><a href="#loc_927_17_927_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_17_927_20&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_164_1_164_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_15&#39;)"><span class="hl_varref"><span class="mpre">createInstance</span></span></a><span class="mpre">) [
          </span><a href="Language.Haskell.TH.Lib.html#loc_356_1_356_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_356_1_356_10&#39;)"><span class="hl_varref"><span class="mpre">instanceD</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []) ((</span><a href="Language.Haskell.TH.Lib.html#loc_510_1_510_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_510_1_510_5&#39;)"><span class="hl_varref"><span class="mpre">conT</span></span></a><span class="mpre"> </span><a href="#loc_1023_11_1023_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1023_11_1023_18&#39;)"><span class="hl_varref"><span class="mpre">clsName</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_513_1_513_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_513_1_513_5&#39;)"><span class="hl_infix"><span class="mpre">`appT`</span></span></a><span class="mpre"> </span><a href="#loc_1026_11_1026_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1026_11_1026_21&#39;)"><span class="hl_varref"><span class="mpre">appliedCon</span></span></a><span class="mpre">) </span><a href="Control.Lens.Internal.TH.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">`appsT`</span></span></a><span class="mpre"> </span><a href="#loc_1025_11_1025_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1025_11_1025_18&#39;)"><span class="hl_varref"><span class="mpre">varArgs</span></span></a><span class="mpre">) [
            </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_1024_11_1024_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1024_11_1024_21&#39;)"><span class="hl_varref"><span class="mpre">methodName</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_933_3_933_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_933_3_933_4&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">] (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_933_3_933_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_933_3_933_4&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)) []]
#ifdef INLINING
            , </span><a href="#loc_1152_1_1152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1152_1_1152_13&#39;)"><span class="hl_varref"><span class="mpre">inlinePragma</span></span></a><span class="mpre"> </span><a href="#loc_1024_11_1024_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1024_11_1024_21&#39;)"><span class="hl_varref"><span class="mpre">methodName</span></span></a><span class="mpre">
#endif
            ]]
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (\_ -&gt; </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_927_17_927_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_927_17_927_20&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="hl_infix"><span class="mpre">^.</span></span><a href="#loc_160_1_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_12&#39;)"><span class="hl_varref"><span class="mpre">createClass</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_1019_7_1019_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1019_7_1019_11&#39;)"><span class="hl_varref"><span class="mpre">defs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Gets @[(lens name, (constructor name, field name, type))]@ from a record constructor.</span></span><span class="mpre">
</span><a href="#loc_1043_1_1043_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1043_1_1043_14&#39;)"><span class="mpre">getLensFields</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [(</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">, (</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Type</span></span><span class="mpre">))]
</span><a name="loc_1043_1_1043_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1043_1_1043_14&#39;)"><span class="hl_fundecl"><span class="mpre">getLensFields</span></span></a><span class="mpre"> </span><a name="loc_1043_15_1043_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1043_15_1043_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">RecC</span></span><span class="mpre"> </span><a name="loc_1043_23_1043_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1043_23_1043_25&#39;)"><span class="hl_vardecl"><span class="mpre">cn</span></span></a><span class="mpre"> </span><a name="loc_1043_26_1043_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1043_26_1043_28&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre">)
  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_115_1_115_10&#39;)"><span class="hl_varref"><span class="mpre">catMaybes</span></span></a><span class="mpre">
  </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_1043_26_1043_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1043_26_1043_28&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre"> </span><a href="Control.Lens.Lens.html#loc_343_4_343_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_343_4_343_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;&amp;&gt;</span></span></a><span class="mpre"> \(</span><a name="loc_1045_14_1045_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1045_14_1045_16&#39;)"><span class="hl_vardecl"><span class="mpre">fn</span></span></a><span class="mpre">,_,</span><a name="loc_1045_19_1045_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1045_19_1045_20&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_1043_15_1043_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1043_15_1043_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_1045_14_1045_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1045_14_1045_16&#39;)"><span class="hl_varref"><span class="mpre">fn</span></span></a><span class="mpre">) </span><a href="Control.Lens.Lens.html#loc_343_4_343_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_343_4_343_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;&amp;&gt;</span></span></a><span class="mpre"> \</span><a name="loc_1045_46_1045_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1045_46_1045_48&#39;)"><span class="hl_vardecl"><span class="mpre">ln</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><a href="#loc_1045_46_1045_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1045_46_1045_48&#39;)"><span class="hl_varref"><span class="mpre">ln</span></span></a><span class="mpre">, (</span><a href="#loc_1043_23_1043_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1043_23_1043_25&#39;)"><span class="hl_varref"><span class="mpre">cn</span></span></a><span class="mpre">,</span><a href="#loc_1045_14_1045_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1045_14_1045_16&#39;)"><span class="hl_varref"><span class="mpre">fn</span></span></a><span class="mpre">,</span><a href="#loc_1045_19_1045_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1045_19_1045_20&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">))
</span><a href="#loc_1043_1_1043_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1043_1_1043_14&#39;)"><span class="hl_fundecl"><span class="mpre">getLensFields</span></span></a><span class="mpre"> </span><a name="loc_1046_15_1046_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1046_15_1046_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ForallC</span></span><span class="mpre"> </span><a name="loc_1046_26_1046_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1046_26_1046_29&#39;)"><span class="hl_vardecl"><span class="mpre">tvs</span></span></a><span class="mpre"> </span><a name="loc_1046_30_1046_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1046_30_1046_34&#39;)"><span class="hl_vardecl"><span class="mpre">cxts</span></span></a><span class="mpre"> </span><a name="loc_1046_35_1046_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1046_35_1046_38&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> </span><a href="#loc_1051_3_1051_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1051_3_1051_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) (</span><a href="#loc_1043_1_1043_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1043_1_1043_14&#39;)"><span class="hl_varref"><span class="mpre">getLensFields</span></span></a><span class="mpre"> </span><a href="#loc_1046_15_1046_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1046_15_1046_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_1046_35_1046_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1046_35_1046_38&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">)
  where
  </span><span class="hl_comment"><span class="mpre">-- Only select fields which do not mention existentially</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- quantified type variables or variables mentioned in internal class constraints</span></span><span class="mpre">
  </span><a name="loc_1050_3_1050_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1050_3_1050_18&#39;)"><span class="hl_vardecl"><span class="mpre">prohibitedTypes</span></span></a><span class="mpre"> = </span><a href="#loc_1046_26_1046_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1046_26_1046_29&#39;)"><span class="hl_varref"><span class="mpre">tvs</span></span></a><span class="hl_infix"><span class="mpre">^..</span></span><a href="Language.Haskell.TH.Lens.html#loc_346_1_346_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_346_1_346_9&#39;)"><span class="hl_varref"><span class="mpre">typeVars</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_1046_30_1046_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1046_30_1046_34&#39;)"><span class="hl_varref"><span class="mpre">cxts</span></span></a><span class="hl_infix"><span class="mpre">^..</span></span><a href="Language.Haskell.TH.Lens.html#loc_346_1_346_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_346_1_346_9&#39;)"><span class="hl_varref"><span class="mpre">typeVars</span></span></a><span class="mpre">
  </span><a name="loc_1051_3_1051_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1051_3_1051_4&#39;)"><span class="hl_fundecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_1051_5_1051_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1051_5_1051_10&#39;)"><span class="hl_vardecl"><span class="mpre">field</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">any</span></span><span class="mpre"> (\</span><a name="loc_1051_24_1051_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1051_24_1051_25&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> -&gt; </span><a href="Control.Lens.Fold.html#loc_982_1_982_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Fold.html#loc_982_1_982_7&#39;)"><span class="hl_varref"><span class="mpre">elemOf</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">_2</span></span><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">_3</span></span><span class="hl_infix"><span class="mpre">.</span></span><a href="Language.Haskell.TH.Lens.html#loc_346_1_346_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_346_1_346_9&#39;)"><span class="hl_varref"><span class="mpre">typeVars</span></span></a><span class="mpre">) </span><a href="#loc_1051_24_1051_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1051_24_1051_25&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_1051_5_1051_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1051_5_1051_10&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre">) </span><a href="#loc_1050_3_1050_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1050_3_1050_18&#39;)"><span class="hl_varref"><span class="mpre">prohibitedTypes</span></span></a><span class="mpre">)

</span><a href="#loc_1043_1_1043_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1043_1_1043_14&#39;)"><span class="hl_fundecl"><span class="mpre">getLensFields</span></span></a><span class="mpre"> _ _
  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []

</span><span class="hl_comment"><span class="mpre">-- TODO: properly fill this out</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Ideally this would unify the different field types, and figure out which polymorphic variables</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- need to be the same.  For now it just leaves them the same and yields the first type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (This leaves us open to inscrutable compile errors in the generated code)</span></span><span class="mpre">
</span><a href="#loc_1062_1_1062_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1062_1_1062_11&#39;)"><span class="mpre">unifyTypes</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">TyVarBndr</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Type</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> ([</span><span class="hl_tyconref"><span class="mpre">TyVarBndr</span></span><span class="mpre">], </span><span class="hl_tyconref"><span class="mpre">Type</span></span><span class="mpre">)
</span><a name="loc_1062_1_1062_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1062_1_1062_11&#39;)"><span class="hl_fundecl"><span class="mpre">unifyTypes</span></span></a><span class="mpre"> </span><a name="loc_1062_12_1062_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1062_12_1062_15&#39;)"><span class="hl_vardecl"><span class="mpre">tvs</span></span></a><span class="mpre"> </span><a name="loc_1062_16_1062_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1062_16_1062_19&#39;)"><span class="hl_vardecl"><span class="mpre">tys</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_1062_12_1062_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1062_12_1062_15&#39;)"><span class="hl_varref"><span class="mpre">tvs</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_1062_16_1062_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1062_16_1062_19&#39;)"><span class="hl_varref"><span class="mpre">tys</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Build &#39;Wrapped&#39; instance for a given newtype</span></span><span class="mpre">
</span><a href="#loc_1066_1_1066_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1066_1_1066_12&#39;)"><span class="mpre">makeWrapped</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DecsQ</span></span><span class="mpre">
</span><a name="loc_1066_1_1066_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1066_1_1066_12&#39;)"><span class="hl_fundecl"><span class="mpre">makeWrapped</span></span></a><span class="mpre"> </span><a name="loc_1066_13_1066_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1066_13_1066_15&#39;)"><span class="hl_vardecl"><span class="mpre">nm</span></span></a><span class="mpre"> = do
  </span><a name="loc_1067_3_1067_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_3_1067_6&#39;)"><span class="hl_vardecl"><span class="mpre">inf</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">reify</span></span><span class="mpre"> </span><a href="#loc_1066_13_1066_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1066_13_1066_15&#39;)"><span class="hl_varref"><span class="mpre">nm</span></span></a><span class="mpre">
  case </span><a href="#loc_1067_3_1067_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_3_1067_6&#39;)"><span class="hl_varref"><span class="mpre">inf</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> </span><a name="loc_1069_12_1069_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1069_12_1069_16&#39;)"><span class="hl_vardecl"><span class="mpre">decl</span></span></a><span class="mpre"> -&gt; do
      </span><a name="loc_1070_7_1070_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1070_7_1070_16&#39;)"><span class="hl_vardecl"><span class="mpre">maybeDecs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_1075_1_1075_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1075_1_1075_18&#39;)"><span class="hl_varref"><span class="mpre">makeWrappedForDec</span></span></a><span class="mpre"> </span><a href="#loc_1069_12_1069_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1069_12_1069_16&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;makeWrapped: Unsupported data type&quot;</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_1070_7_1070_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1070_7_1070_16&#39;)"><span class="hl_varref"><span class="mpre">maybeDecs</span></span></a><span class="mpre">
    _ -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;makeWrapped: Expected the name of a newtype or datatype&quot;</span></span><span class="mpre">

</span><a href="#loc_1075_1_1075_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1075_1_1075_18&#39;)"><span class="mpre">makeWrappedForDec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">])
</span><a name="loc_1075_1_1075_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1075_1_1075_18&#39;)"><span class="hl_fundecl"><span class="mpre">makeWrappedForDec</span></span></a><span class="mpre"> </span><a name="loc_1075_19_1075_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1075_19_1075_23&#39;)"><span class="hl_vardecl"><span class="mpre">decl</span></span></a><span class="mpre"> = case </span><a href="#loc_726_1_726_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_1_726_13&#39;)"><span class="hl_varref"><span class="mpre">makeDataDecl</span></span></a><span class="mpre"> </span><a href="#loc_1075_19_1075_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1075_19_1075_23&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre"> of
  </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_1076_8_1076_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_8_1076_16&#39;)"><span class="hl_vardecl"><span class="mpre">dataDecl</span></span></a><span class="mpre"> | [</span><a name="loc_1076_20_1076_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_20_1076_23&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre">]   &lt;- </span><a href="#loc_762_5_762_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_762_5_762_17&#39;)"><span class="hl_varref"><span class="mpre">constructors</span></span></a><span class="mpre"> </span><a href="#loc_1076_8_1076_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_8_1076_16&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">
                , [</span><a name="loc_1077_20_1077_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1077_20_1077_25&#39;)"><span class="hl_vardecl"><span class="mpre">field</span></span></a><span class="mpre">] &lt;- </span><a href="Control.Lens.Fold.html#loc_543_1_543_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Fold.html#loc_543_1_543_9&#39;)"><span class="hl_varref"><span class="mpre">toListOf</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lens.html#loc_376_1_376_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_376_1_376_10&#39;)"><span class="hl_varref"><span class="mpre">conFields</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">_2</span></span><span class="mpre">) </span><a href="#loc_1076_20_1076_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_20_1076_23&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">
    -&gt; do </span><a name="loc_1078_11_1078_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1078_11_1078_18&#39;)"><span class="hl_vardecl"><span class="mpre">wrapped</span></span></a><span class="mpre">   &lt;- </span><a href="#loc_1114_1_1114_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1114_1_1114_20&#39;)"><span class="hl_varref"><span class="mpre">makeWrappedInstance</span></span></a><span class="mpre"> </span><a href="#loc_1076_8_1076_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_8_1076_16&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><a href="#loc_1076_20_1076_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_20_1076_23&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre"> </span><a href="#loc_1077_20_1077_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1077_20_1077_25&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre">
          </span><a name="loc_1079_11_1079_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1079_11_1079_20&#39;)"><span class="hl_vardecl"><span class="mpre">rewrapped</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_1084_1_1084_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1084_1_1084_22&#39;)"><span class="hl_varref"><span class="mpre">makeRewrappedInstance</span></span></a><span class="mpre"> </span><a href="#loc_1076_8_1076_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_8_1076_16&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">
          </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> [</span><a href="#loc_1079_11_1079_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1079_11_1079_20&#39;)"><span class="hl_varref"><span class="mpre">rewrapped</span></span></a><span class="mpre">, </span><a href="#loc_1078_11_1078_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1078_11_1078_18&#39;)"><span class="hl_varref"><span class="mpre">wrapped</span></span></a><span class="mpre">])
  _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><a href="#loc_1084_1_1084_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1084_1_1084_22&#39;)"><span class="mpre">makeRewrappedInstance</span></a><span class="mpre"> :: </span><a href="#loc_754_6_754_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_6_754_14&#39;)"><span class="hl_tyconref"><span class="mpre">DataDecl</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DecQ</span></span><span class="mpre">
</span><a name="loc_1084_1_1084_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1084_1_1084_22&#39;)"><span class="hl_fundecl"><span class="mpre">makeRewrappedInstance</span></span></a><span class="mpre"> </span><a name="loc_1084_23_1084_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1084_23_1084_31&#39;)"><span class="hl_vardecl"><span class="mpre">dataDecl</span></span></a><span class="mpre"> = do

   </span><a name="loc_1086_4_1086_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1086_4_1086_5&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> &lt;- </span><a href="Language.Haskell.TH.Lib.html#loc_507_1_507_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_507_1_507_5&#39;)"><span class="hl_varref"><span class="mpre">varT</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;t&quot;</span></span><span class="mpre">

   let </span><a name="loc_1088_8_1088_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1088_8_1088_16&#39;)"><span class="hl_vardecl"><span class="mpre">typeArgs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">) (</span><a href="#loc_758_5_758_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_5_758_19&#39;)"><span class="hl_varref"><span class="mpre">dataParameters</span></span></a><span class="mpre"> </span><a href="#loc_1084_23_1084_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1084_23_1084_31&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">)

   </span><a name="loc_1090_4_1090_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1090_4_1090_13&#39;)"><span class="hl_vardecl"><span class="mpre">typeArgs&#39;</span></span></a><span class="mpre"> &lt;- do
     </span><a name="loc_1091_6_1091_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1091_6_1091_7&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_661_1_661_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_661_1_661_9&#39;)"><span class="hl_varref"><span class="mpre">freshMap</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">Set.fromList</span></span><span class="mpre"> </span><a href="#loc_1088_8_1088_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1088_8_1088_16&#39;)"><span class="hl_varref"><span class="mpre">typeArgs</span></span></a><span class="mpre">)
     </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Language.Haskell.TH.Lens.html#loc_350_1_350_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_350_1_350_14&#39;)"><span class="hl_varref"><span class="mpre">substTypeVars</span></span></a><span class="mpre"> </span><a href="#loc_1091_6_1091_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1091_6_1091_7&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_1088_8_1088_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1088_8_1088_16&#39;)"><span class="hl_varref"><span class="mpre">typeArgs</span></span></a><span class="mpre">)

       </span><span class="hl_comment"><span class="mpre">-- Con a b c...</span></span><span class="mpre">
   let </span><a name="loc_1095_8_1095_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1095_8_1095_19&#39;)"><span class="hl_vardecl"><span class="mpre">appliedType</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_759_5_759_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_5_759_13&#39;)"><span class="hl_varref"><span class="mpre">fullType</span></span></a><span class="mpre"> </span><a href="#loc_1084_23_1084_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1084_23_1084_31&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">VarT</span></span><span class="mpre"> </span><a href="#loc_1088_8_1088_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1088_8_1088_16&#39;)"><span class="hl_varref"><span class="mpre">typeArgs</span></span></a><span class="mpre">))

       </span><span class="hl_comment"><span class="mpre">-- Con a&#39; b&#39; c&#39;...</span></span><span class="mpre">
       </span><a name="loc_1098_8_1098_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1098_8_1098_20&#39;)"><span class="hl_vardecl"><span class="mpre">appliedType&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_759_5_759_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_5_759_13&#39;)"><span class="hl_varref"><span class="mpre">fullType</span></span></a><span class="mpre"> </span><a href="#loc_1084_23_1084_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1084_23_1084_31&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">VarT</span></span><span class="mpre"> </span><a href="#loc_1090_4_1090_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1090_4_1090_13&#39;)"><span class="hl_varref"><span class="mpre">typeArgs&#39;</span></span></a><span class="mpre">))

       </span><span class="hl_comment"><span class="mpre">-- Con a&#39; b&#39; c&#39;... ~ t</span></span><span class="mpre">
#if MIN_VERSION_template_haskell(2,10,0)
       </span><a name="loc_1102_8_1102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1102_8_1102_10&#39;)"><span class="hl_vardecl"><span class="mpre">eq</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">AppT</span></span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">AppT</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">EqualityT</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_1098_8_1098_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1098_8_1098_20&#39;)"><span class="hl_varref"><span class="mpre">appliedType&#39;</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_1086_4_1086_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1086_4_1086_5&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
#else
       </span><span class="hl_vardecl"><span class="mpre">eq</span></span><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_476_1_476_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_476_1_476_7&#39;)"><span class="hl_varref"><span class="mpre">equalP</span></span></a><span class="mpre"> </span><a href="#loc_1098_8_1098_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1098_8_1098_20&#39;)"><span class="hl_varref"><span class="mpre">appliedType&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1086_4_1086_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1086_4_1086_5&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
#endif

       </span><span class="hl_comment"><span class="mpre">-- Rewrapped (Con a b c...) t</span></span><span class="mpre">
       </span><a name="loc_1108_8_1108_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1108_8_1108_13&#39;)"><span class="hl_vardecl"><span class="mpre">klass</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_510_1_510_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_510_1_510_5&#39;)"><span class="hl_varref"><span class="mpre">conT</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1108, srcSpanStartColumn = 21, srcSpanEndLine = 1108, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1108, srcSpanStartColumn = 21, srcSpanEndLine = 1108, srcSpanEndColumn = 23}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/C"><span class="mpre">&#39;&#39;Rewrapped</span></span><span class="mpre"> </span><a href="Control.Lens.Internal.TH.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">`appsT`</span></span></a><span class="mpre"> [</span><a href="#loc_1095_8_1095_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1095_8_1095_19&#39;)"><span class="hl_varref"><span class="mpre">appliedType</span></span></a><span class="mpre">, </span><a href="#loc_1086_4_1086_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1086_4_1086_5&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">]

   </span><span class="hl_comment"><span class="mpre">-- instance (Con a&#39; b&#39; c&#39;... ~ t) =&gt; Rewrapped (Con a b c...) t</span></span><span class="mpre">
   </span><a href="Language.Haskell.TH.Lib.html#loc_356_1_356_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_356_1_356_10&#39;)"><span class="hl_varref"><span class="mpre">instanceD</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_467_1_467_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_467_1_467_4&#39;)"><span class="hl_varref"><span class="mpre">cxt</span></span></a><span class="mpre"> [</span><a href="#loc_1102_8_1102_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1102_8_1102_10&#39;)"><span class="hl_varref"><span class="mpre">eq</span></span></a><span class="mpre">]) </span><a href="#loc_1108_8_1108_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1108_8_1108_13&#39;)"><span class="hl_varref"><span class="mpre">klass</span></span></a><span class="mpre"> []

</span><a href="#loc_1114_1_1114_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1114_1_1114_20&#39;)"><span class="mpre">makeWrappedInstance</span></a><span class="mpre"> :: </span><a href="#loc_754_6_754_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_754_6_754_14&#39;)"><span class="hl_tyconref"><span class="mpre">DataDecl</span></span></a><span class="mpre">-&gt; </span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Type</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DecQ</span></span><span class="mpre">
</span><a name="loc_1114_1_1114_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1114_1_1114_20&#39;)"><span class="hl_fundecl"><span class="mpre">makeWrappedInstance</span></span></a><span class="mpre"> </span><a name="loc_1114_21_1114_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1114_21_1114_29&#39;)"><span class="hl_vardecl"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><a name="loc_1114_30_1114_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1114_30_1114_33&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre"> </span><a name="loc_1114_34_1114_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1114_34_1114_43&#39;)"><span class="hl_vardecl"><span class="mpre">fieldType</span></span></a><span class="mpre"> = do

  let </span><a name="loc_1116_7_1116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1116_7_1116_14&#39;)"><span class="hl_vardecl"><span class="mpre">conName</span></span></a><span class="mpre"> = </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_1114_30_1114_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1114_30_1114_33&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">
  let </span><a name="loc_1117_7_1117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1117_7_1117_15&#39;)"><span class="hl_vardecl"><span class="mpre">typeArgs</span></span></a><span class="mpre"> = </span><a href="Control.Lens.Fold.html#loc_543_1_543_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Fold.html#loc_543_1_543_9&#39;)"><span class="hl_varref"><span class="mpre">toListOf</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_346_1_346_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_346_1_346_9&#39;)"><span class="hl_varref"><span class="mpre">typeVars</span></span></a><span class="mpre"> (</span><a href="#loc_758_5_758_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_5_758_19&#39;)"><span class="hl_varref"><span class="mpre">dataParameters</span></span></a><span class="mpre"> </span><a href="#loc_1114_21_1114_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1114_21_1114_29&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">)

  </span><span class="hl_comment"><span class="mpre">-- Con a b c...</span></span><span class="mpre">
  let </span><a name="loc_1120_7_1120_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1120_7_1120_18&#39;)"><span class="hl_vardecl"><span class="mpre">appliedType</span></span></a><span class="mpre">  = </span><a href="#loc_759_5_759_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_5_759_13&#39;)"><span class="hl_varref"><span class="mpre">fullType</span></span></a><span class="mpre"> </span><a href="#loc_1114_21_1114_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1114_21_1114_29&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">VarT</span></span><span class="mpre"> </span><a href="#loc_1117_7_1117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1117_7_1117_15&#39;)"><span class="hl_varref"><span class="mpre">typeArgs</span></span></a><span class="mpre">)

  </span><span class="hl_comment"><span class="mpre">-- type Unwrapped (Con a b c...) = $fieldType</span></span><span class="mpre">
  let </span><a name="loc_1123_7_1123_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1123_7_1123_19&#39;)"><span class="hl_vardecl"><span class="mpre">unwrappedATF</span></span></a><span class="mpre"> = </span><a href="Control.Lens.Internal.TH.html#loc_26_1_26_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_26_1_26_12&#39;)"><span class="hl_varref"><span class="mpre">tySynInstD&#39;</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1123, srcSpanStartColumn = 34, srcSpanEndLine = 1123, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1123, srcSpanStartColumn = 34, srcSpanEndLine = 1123, srcSpanEndColumn = 36}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/C"><span class="mpre">&#39;&#39;Unwrapped</span></span><span class="mpre"> [</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_1120_7_1120_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1120_7_1120_18&#39;)"><span class="hl_varref"><span class="mpre">appliedType</span></span></a><span class="mpre">] (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_1114_34_1114_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1114_34_1114_43&#39;)"><span class="hl_varref"><span class="mpre">fieldType</span></span></a><span class="mpre">)

  </span><span class="hl_comment"><span class="mpre">-- Wrapped (Con a b c...)</span></span><span class="mpre">
  let </span><a name="loc_1126_7_1126_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1126_7_1126_12&#39;)"><span class="hl_vardecl"><span class="mpre">klass</span></span></a><span class="mpre">        = </span><a href="Language.Haskell.TH.Lib.html#loc_510_1_510_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_510_1_510_5&#39;)"><span class="hl_varref"><span class="mpre">conT</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1126, srcSpanStartColumn = 27, srcSpanEndLine = 1126, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1126, srcSpanStartColumn = 27, srcSpanEndLine = 1126, srcSpanEndColumn = 29}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/C"><span class="mpre">&#39;&#39;Wrapped</span></span><span class="mpre"> </span><a href="Language.Haskell.TH.Lib.html#loc_513_1_513_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_513_1_513_5&#39;)"><span class="hl_infix"><span class="mpre">`appT`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_1120_7_1120_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1120_7_1120_18&#39;)"><span class="hl_varref"><span class="mpre">appliedType</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- _Wrapped&#39; = iso (\(Con x) -&gt; x) Con</span></span><span class="mpre">
  let </span><span class="hl_vardecl"><span class="mpre">wrapFun</span></span><span class="mpre">      = </span><a href="Language.Haskell.TH.Lib.html#loc_211_1_211_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_211_1_211_5&#39;)"><span class="hl_varref"><span class="mpre">conE</span></span></a><span class="mpre"> </span><a href="#loc_1116_7_1116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1116_7_1116_14&#39;)"><span class="hl_varref"><span class="mpre">conName</span></span></a><span class="mpre">
  let </span><span class="hl_vardecl"><span class="mpre">unwrapFun</span></span><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;x&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_1130_39_1130_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1130_39_1130_40&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="Language.Haskell.TH.Lib.html#loc_249_1_249_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_249_1_249_6&#39;)"><span class="hl_varref"><span class="mpre">lam1E</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_76_1_76_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_76_1_76_5&#39;)"><span class="hl_varref"><span class="mpre">conP</span></span></a><span class="mpre"> </span><a href="#loc_1116_7_1116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1116_7_1116_14&#39;)"><span class="hl_varref"><span class="mpre">conName</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_70_1_70_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_70_1_70_5&#39;)"><span class="hl_varref"><span class="mpre">varP</span></span></a><span class="mpre"> </span><a href="#loc_1130_39_1130_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1130_39_1130_40&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]) (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_1130_39_1130_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1130_39_1130_40&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
  let </span><a name="loc_1131_7_1131_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1131_7_1131_16&#39;)"><span class="hl_vardecl"><span class="mpre">isoMethod</span></span></a><span class="mpre">    = </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpVarQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1131, srcSpanStartColumn = 27, srcSpanEndLine = 1131, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1131, srcSpanStartColumn = 27, srcSpanEndLine = 1131, srcSpanEndColumn = 28}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/C"><span class="mpre">&#39;_Wrapped&#39;</span></span><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [] (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpBracketExp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1131, srcSpanStartColumn = 58, srcSpanEndLine = 1131, srcSpanEndColumn = 85}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1131, srcSpanStartColumn = 58, srcSpanEndLine = 1131, srcSpanEndColumn = 60},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine "><span class="mpre">[|iso $unwrapFun $wrapFun|]</span></span><span class="mpre">) []]

  </span><span class="hl_comment"><span class="mpre">-- instance Wrapped (Con a b c...) where</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">--   type Unwrapped (Con a b c...) = fieldType</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">--   _Wrapped&#39; = iso (\(Con x) -&gt; x) Con</span></span><span class="mpre">
  </span><a href="Language.Haskell.TH.Lib.html#loc_356_1_356_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_356_1_356_10&#39;)"><span class="hl_varref"><span class="mpre">instanceD</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_467_1_467_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_467_1_467_4&#39;)"><span class="hl_varref"><span class="mpre">cxt</span></span></a><span class="mpre"> []) </span><a href="#loc_1126_7_1126_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1126_7_1126_12&#39;)"><span class="hl_varref"><span class="mpre">klass</span></span></a><span class="mpre"> [</span><a href="#loc_1123_7_1123_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1123_7_1123_19&#39;)"><span class="hl_varref"><span class="mpre">unwrappedATF</span></span></a><span class="mpre">, </span><a href="#loc_1131_7_1131_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1131_7_1131_16&#39;)"><span class="hl_varref"><span class="mpre">isoMethod</span></span></a><span class="mpre">]

#if !(MIN_VERSION_template_haskell(2,7,0))
</span><span class="hl_comment"><span class="mpre">-- | The orphan instance for old versions is bad, but programming without &#39;Applicative&#39; is worse.</span></span><span class="mpre">
instance </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> where
  </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_vardecl"><span class="mpre">pure</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">
  </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;*&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="hl_varref"><span class="mpre">ap</span></span></a><span class="mpre">
#endif

#ifdef INLINING

</span><a href="#loc_1152_1_1152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1152_1_1152_13&#39;)"><span class="mpre">inlinePragma</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">
#if MIN_VERSION_template_haskell(2,8,0)

# ifdef OLD_INLINE_PRAGMAS
</span><span class="hl_comment"><span class="mpre">-- 7.6rc1?</span></span><span class="mpre">
</span><a name="loc_1152_1_1152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1152_1_1152_13&#39;)"><span class="hl_fundecl"><span class="mpre">inlinePragma</span></span></a><span class="mpre"> </span><a name="loc_1152_14_1152_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1152_14_1152_24&#39;)"><span class="hl_vardecl"><span class="mpre">methodName</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_381_1_381_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_381_1_381_9&#39;)"><span class="hl_varref"><span class="mpre">pragInlD</span></span></a><span class="mpre"> </span><a href="#loc_1152_14_1152_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1152_14_1152_24&#39;)"><span class="hl_varref"><span class="mpre">methodName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">inlineSpecNoPhase</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Inline</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
# else
</span><span class="hl_comment"><span class="mpre">-- 7.7.20120830</span></span><span class="mpre">
</span><a href="#loc_1152_1_1152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1152_1_1152_13&#39;)"><span class="hl_fundecl"><span class="mpre">inlinePragma</span></span></a><span class="mpre"> </span><a name="loc_1155_14_1155_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1155_14_1155_24&#39;)"><span class="hl_vardecl"><span class="mpre">methodName</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_381_1_381_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_381_1_381_9&#39;)"><span class="hl_varref"><span class="mpre">pragInlD</span></span></a><span class="mpre"> </span><a href="#loc_1155_14_1155_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1155_14_1155_24&#39;)"><span class="hl_varref"><span class="mpre">methodName</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Inline</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">FunLike</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">AllPhases</span></span><span class="mpre">
# endif

#else
</span><span class="hl_comment"><span class="mpre">-- GHC &lt;7.6, TH &lt;2.8.0</span></span><span class="mpre">
</span><a href="#loc_1152_1_1152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1152_1_1152_13&#39;)"><span class="hl_fundecl"><span class="mpre">inlinePragma</span></span></a><span class="mpre"> </span><a name="loc_1160_14_1160_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1160_14_1160_24&#39;)"><span class="hl_vardecl"><span class="mpre">methodName</span></span></a><span class="mpre"> = </span><a href="Language.Haskell.TH.Lib.html#loc_381_1_381_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_381_1_381_9&#39;)"><span class="hl_varref"><span class="mpre">pragInlD</span></span></a><span class="mpre"> </span><a href="#loc_1160_14_1160_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1160_14_1160_24&#39;)"><span class="hl_varref"><span class="mpre">methodName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">inlineSpecNoPhase</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
#endif

#endif

data </span><a name="loc_1165_6_1165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1165_6_1165_16&#39;)"><span class="hl_tycondecl"><span class="mpre">FieldRules</span></span></a><span class="mpre"> = </span><a name="loc_1165_19_1165_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1165_19_1165_29&#39;)"><span class="hl_condecl"><span class="mpre">FieldRules</span></span></a><span class="mpre">
    { </span><span class="hl_fielddecl"><span class="mpre">_getPrefix</span></span><span class="mpre">          :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><span class="hl_fielddecl"><span class="mpre">_rawLensNaming</span></span><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><span class="hl_fielddecl"><span class="mpre">_niceLensNaming</span></span><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><span class="hl_fielddecl"><span class="mpre">_classNaming</span></span><span class="mpre">        :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    }

data </span><a name="loc_1172_6_1172_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_6_1172_11&#39;)"><span class="hl_tycondecl"><span class="mpre">Field</span></span></a><span class="mpre"> = </span><a name="loc_1172_14_1172_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_14_1172_19&#39;)"><span class="hl_condecl"><span class="mpre">Field</span></span></a><span class="mpre">
    { </span><span class="hl_fielddecl"><span class="mpre">_fieldName</span></span><span class="mpre">          :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">
    , </span><a name="loc_1174_7_1174_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1174_7_1174_23&#39;)"><span class="hl_fielddecl"><span class="mpre">_fieldLensPrefix</span></span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    , </span><span class="hl_fielddecl"><span class="mpre">_fieldLensName</span></span><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">
    , </span><span class="hl_fielddecl"><span class="mpre">_fieldClassName</span></span><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">
    , </span><span class="hl_fielddecl"><span class="mpre">_fieldClassLensName</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">
    , </span><span class="hl_fielddecl"><span class="mpre">_fieldNameType</span></span><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">Type</span></span><span class="mpre">
    }

</span><a href="#loc_1182_1_1182_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_1_1182_9&#39;)"><span class="mpre">overHead</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_1182_1_1182_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_1_1182_9&#39;)"><span class="hl_fundecl"><span class="mpre">overHead</span></span></a><span class="mpre"> _ []     = []
</span><a href="#loc_1182_1_1182_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_1_1182_9&#39;)"><span class="hl_fundecl"><span class="mpre">overHead</span></span></a><span class="mpre"> </span><a name="loc_1183_10_1183_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1183_10_1183_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a name="loc_1183_13_1183_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1183_13_1183_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1183_15_1183_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1183_15_1183_17&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_1183_10_1183_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1183_10_1183_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_1183_13_1183_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1183_13_1183_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1183_15_1183_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1183_15_1183_17&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Field rules for fields in the form @ _prefix_fieldname @</span></span><span class="mpre">
</span><a href="#loc_1187_1_1187_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1187_1_1187_17&#39;)"><span class="mpre">underscoreFields</span></a><span class="mpre"> :: </span><a href="#loc_1165_6_1165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1165_6_1165_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldRules</span></span></a><span class="mpre">
</span><a name="loc_1187_1_1187_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1187_1_1187_17&#39;)"><span class="hl_vardecl"><span class="mpre">underscoreFields</span></span></a><span class="mpre"> = </span><a href="#loc_1165_19_1165_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1165_19_1165_29&#39;)"><span class="hl_conref"><span class="mpre">FieldRules</span></span></a><span class="mpre"> </span><a href="#loc_1189_5_1189_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_5_1189_11&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><a href="#loc_1191_5_1191_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1191_5_1191_12&#39;)"><span class="hl_varref"><span class="mpre">rawLens</span></span></a><span class="mpre"> </span><a href="#loc_1192_5_1192_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_5_1192_13&#39;)"><span class="hl_varref"><span class="mpre">niceLens</span></span></a><span class="mpre"> </span><a href="#loc_1193_5_1193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1193_5_1193_16&#39;)"><span class="hl_varref"><span class="mpre">classNaming</span></span></a><span class="mpre">
  where
    </span><a name="loc_1189_5_1189_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_5_1189_11&#39;)"><span class="hl_fundecl"><span class="mpre">prefix</span></span></a><span class="mpre"> _ (</span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1189_19_1189_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_19_1189_21&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) | </span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`List.elem`</span></span><span class="mpre"> </span><a href="#loc_1189_19_1189_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_19_1189_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">takeWhile</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="mpre">) </span><a href="#loc_1189_19_1189_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_19_1189_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
    </span><a href="#loc_1189_5_1189_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_5_1189_11&#39;)"><span class="hl_fundecl"><span class="mpre">prefix</span></span></a><span class="mpre"> _ _                             = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    </span><a name="loc_1191_5_1191_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1191_5_1191_12&#39;)"><span class="hl_fundecl"><span class="mpre">rawLens</span></span></a><span class="mpre">     </span><a name="loc_1191_17_1191_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1191_17_1191_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_1191_17_1191_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1191_17_1191_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;_lens&quot;</span></span><span class="mpre">
    </span><a name="loc_1192_5_1192_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_5_1192_13&#39;)"><span class="hl_fundecl"><span class="mpre">niceLens</span></span></a><span class="mpre">    </span><a name="loc_1192_17_1192_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_17_1192_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_1189_5_1189_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_5_1189_11&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre"> [] </span><a href="#loc_1192_17_1192_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_17_1192_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Control.Lens.Lens.html#loc_343_4_343_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_343_4_343_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;&amp;&gt;</span></span></a><span class="mpre"> \</span><a name="loc_1192_38_1192_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_38_1192_39&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_1192_38_1192_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_38_1192_39&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_1192_17_1192_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_17_1192_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    </span><a name="loc_1193_5_1193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1193_5_1193_16&#39;)"><span class="hl_fundecl"><span class="mpre">classNaming</span></span></a><span class="mpre"> </span><a name="loc_1193_17_1193_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1193_17_1193_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_1192_5_1192_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_5_1192_13&#39;)"><span class="hl_varref"><span class="mpre">niceLens</span></span></a><span class="mpre"> </span><a href="#loc_1193_17_1193_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1193_17_1193_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Control.Lens.Lens.html#loc_343_4_343_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_343_4_343_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;&amp;&gt;</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Has_&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Field rules for fields in the form @ prefixFieldname or _prefixFieldname @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If you want all fields to be lensed, then there is no reason to use an @_@ before the prefix.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If any of the record fields leads with an @_@ then it is assume a field without an @_@ should not have a lens created.</span></span><span class="mpre">
</span><a href="#loc_1199_1_1199_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1199_1_1199_16&#39;)"><span class="mpre">camelCaseFields</span></a><span class="mpre"> :: </span><a href="#loc_1165_6_1165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1165_6_1165_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldRules</span></span></a><span class="mpre">
</span><a name="loc_1199_1_1199_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1199_1_1199_16&#39;)"><span class="hl_vardecl"><span class="mpre">camelCaseFields</span></span></a><span class="mpre"> = </span><a href="#loc_1165_19_1165_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1165_19_1165_29&#39;)"><span class="hl_conref"><span class="mpre">FieldRules</span></span></a><span class="mpre"> </span><a href="#loc_1205_5_1205_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1205_5_1205_11&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><a href="#loc_1207_5_1207_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1207_5_1207_12&#39;)"><span class="hl_varref"><span class="mpre">rawLens</span></span></a><span class="mpre"> </span><a href="#loc_1208_5_1208_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_5_1208_13&#39;)"><span class="hl_varref"><span class="mpre">niceLens</span></span></a><span class="mpre"> </span><a href="#loc_1209_5_1209_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_5_1209_16&#39;)"><span class="hl_varref"><span class="mpre">classNaming</span></span></a><span class="mpre">
  where
    </span><a name="loc_1201_5_1201_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_5_1201_13&#39;)"><span class="hl_fundecl"><span class="mpre">sepUpper</span></span></a><span class="mpre"> </span><a name="loc_1201_14_1201_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_14_1201_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_140_1_140_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_140_1_140_8&#39;)"><span class="hl_varref"><span class="mpre">isUpper</span></span></a><span class="mpre"> </span><a href="#loc_1201_14_1201_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_14_1201_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
        (</span><a name="loc_1202_10_1202_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1202_10_1202_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">, </span><a name="loc_1202_13_1202_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1202_13_1202_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> </span><a href="#loc_1202_10_1202_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1202_10_1202_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> </span><a href="#loc_1202_13_1202_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1202_13_1202_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                  -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_1202_10_1202_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1202_10_1202_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_1202_13_1202_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1202_13_1202_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

    </span><a name="loc_1205_5_1205_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1205_5_1205_11&#39;)"><span class="hl_fundecl"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><a name="loc_1205_12_1205_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1205_12_1205_18&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1201_5_1201_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_5_1201_13&#39;)"><span class="hl_varref"><span class="mpre">sepUpper</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_184_1_184_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_184_1_184_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;=&lt;</span></span></a><span class="mpre"> </span><a href="#loc_1212_5_1212_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_5_1212_14&#39;)"><span class="hl_varref"><span class="mpre">dealWith_</span></span></a><span class="mpre"> </span><a href="#loc_1205_12_1205_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1205_12_1205_18&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">

    </span><a name="loc_1207_5_1207_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1207_5_1207_12&#39;)"><span class="hl_fundecl"><span class="mpre">rawLens</span></span></a><span class="mpre">     </span><a name="loc_1207_17_1207_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1207_17_1207_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_1207_17_1207_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1207_17_1207_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Lens&quot;</span></span><span class="mpre">
    </span><a name="loc_1208_5_1208_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_5_1208_13&#39;)"><span class="hl_fundecl"><span class="mpre">niceLens</span></span></a><span class="mpre">    </span><a name="loc_1208_17_1208_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_17_1208_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_1182_1_1182_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_1_1182_9&#39;)"><span class="hl_varref"><span class="mpre">overHead</span></span></a><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">toLower</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_1201_5_1201_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_5_1201_13&#39;)"><span class="hl_varref"><span class="mpre">sepUpper</span></span></a><span class="mpre"> </span><a href="#loc_1208_17_1208_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_17_1208_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    </span><a name="loc_1209_5_1209_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_5_1209_16&#39;)"><span class="hl_fundecl"><span class="mpre">classNaming</span></span></a><span class="mpre"> </span><a name="loc_1209_17_1209_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_17_1209_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_1208_5_1208_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_5_1208_13&#39;)"><span class="hl_varref"><span class="mpre">niceLens</span></span></a><span class="mpre"> </span><a href="#loc_1209_17_1209_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_17_1209_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Control.Lens.Lens.html#loc_343_4_343_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_343_4_343_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;&amp;&gt;</span></span></a><span class="mpre"> \ (</span><a name="loc_1209_39_1209_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_39_1209_40&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1209_41_1209_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_41_1209_43&#39;)"><span class="hl_vardecl"><span class="mpre">ns</span></span></a><span class="mpre">) -&gt; </span><span class="hl_string"><span class="mpre">&quot;Has&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_144_1_144_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_144_1_144_8&#39;)"><span class="hl_varref"><span class="mpre">toUpper</span></span></a><span class="mpre"> </span><a href="#loc_1209_39_1209_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_39_1209_40&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1209_41_1209_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_41_1209_43&#39;)"><span class="hl_varref"><span class="mpre">ns</span></span></a><span class="mpre">

    </span><a href="#loc_1212_5_1212_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_5_1212_14&#39;)"><span class="mpre">dealWith_</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    </span><a name="loc_1212_5_1212_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_5_1212_14&#39;)"><span class="hl_fundecl"><span class="mpre">dealWith_</span></span></a><span class="mpre"> </span><a name="loc_1212_15_1212_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_15_1212_21&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> </span><a name="loc_1212_22_1212_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_22_1212_27&#39;)"><span class="hl_vardecl"><span class="mpre">field</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">any</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1215_9_1215_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1215_9_1215_17&#39;)"><span class="hl_varref"><span class="mpre">leading_</span></span></a><span class="mpre">) </span><a href="#loc_1212_15_1212_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_15_1212_21&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_1212_22_1212_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_22_1212_27&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre">
                           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = if </span><a href="#loc_1217_10_1217_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1217_10_1217_17&#39;)"><span class="hl_varref"><span class="mpre">leading</span></span></a><span class="mpre"> then </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_1217_19_1217_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1217_19_1217_27&#39;)"><span class="hl_varref"><span class="mpre">trailing</span></span></a><span class="mpre"> else </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
      where
        </span><a name="loc_1215_9_1215_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1215_9_1215_17&#39;)"><span class="hl_fundecl"><span class="mpre">leading_</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1215_23_1215_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1215_23_1215_25&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a href="#loc_1215_23_1215_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1215_23_1215_25&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
        </span><a href="#loc_1215_9_1215_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1215_9_1215_17&#39;)"><span class="hl_fundecl"><span class="mpre">leading_</span></span></a><span class="mpre">      </span><a name="loc_1216_23_1216_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1216_23_1216_25&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">  = (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><a href="#loc_1216_23_1216_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1216_23_1216_25&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
        (</span><a name="loc_1217_10_1217_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1217_10_1217_17&#39;)"><span class="hl_vardecl"><span class="mpre">leading</span></span></a><span class="mpre">, </span><a name="loc_1217_19_1217_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1217_19_1217_27&#39;)"><span class="hl_vardecl"><span class="mpre">trailing</span></span></a><span class="mpre">) = </span><a href="#loc_1215_9_1215_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1215_9_1215_17&#39;)"><span class="hl_varref"><span class="mpre">leading_</span></span></a><span class="mpre"> </span><a href="#loc_1212_22_1212_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_22_1212_27&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre">



</span><a href="#loc_1222_1_1222_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1222_1_1222_15&#39;)"><span class="mpre">collectRecords</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">VarStrictType</span></span><span class="mpre">]
</span><a name="loc_1222_1_1222_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1222_1_1222_15&#39;)"><span class="hl_fundecl"><span class="mpre">collectRecords</span></span></a><span class="mpre"> </span><a name="loc_1222_16_1222_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1222_16_1222_20&#39;)"><span class="hl_vardecl"><span class="mpre">cons</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_330_1_330_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_330_1_330_6&#39;)"><span class="hl_varref"><span class="mpre">nubBy</span></span></a><span class="mpre"> </span><a href="#loc_1224_5_1224_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1224_5_1224_10&#39;)"><span class="hl_varref"><span class="mpre">varEq</span></span></a><span class="mpre"> </span><a href="#loc_1225_5_1225_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1225_5_1225_20&#39;)"><span class="hl_varref"><span class="mpre">allRecordFields</span></span></a><span class="mpre">
  where
    </span><a name="loc_1224_5_1224_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1224_5_1224_10&#39;)"><span class="hl_fundecl"><span class="mpre">varEq</span></span></a><span class="mpre"> (</span><a name="loc_1224_12_1224_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1224_12_1224_17&#39;)"><span class="hl_vardecl"><span class="mpre">name1</span></span></a><span class="mpre">,_,_) (</span><a name="loc_1224_24_1224_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1224_24_1224_29&#39;)"><span class="hl_vardecl"><span class="mpre">name2</span></span></a><span class="mpre">,_,_) = </span><a href="#loc_1224_12_1224_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1224_12_1224_17&#39;)"><span class="hl_varref"><span class="mpre">name1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_1224_24_1224_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1224_24_1224_29&#39;)"><span class="hl_varref"><span class="mpre">name2</span></span></a><span class="mpre">
    </span><a name="loc_1225_5_1225_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1225_5_1225_20&#39;)"><span class="hl_vardecl"><span class="mpre">allRecordFields</span></span></a><span class="mpre"> = [ </span><a href="#loc_1225_57_1225_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1225_57_1225_62&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre"> | </span><span class="hl_conref"><span class="mpre">RecC</span></span><span class="mpre"> _ </span><a name="loc_1225_40_1225_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1225_40_1225_46&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_1222_16_1222_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1222_16_1222_20&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre"> , </span><a name="loc_1225_57_1225_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1225_57_1225_62&#39;)"><span class="hl_vardecl"><span class="mpre">field</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_1225_40_1225_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1225_40_1225_46&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre"> ]

</span><a href="#loc_1228_1_1228_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_1_1228_14&#39;)"><span class="mpre">verboseLenses</span></a><span class="mpre"> :: </span><a href="#loc_1165_6_1165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1165_6_1165_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldRules</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_1228_1_1228_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_1_1228_14&#39;)"><span class="hl_fundecl"><span class="mpre">verboseLenses</span></span></a><span class="mpre"> </span><a name="loc_1228_15_1228_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_15_1228_16&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_1228_17_1228_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_17_1228_21&#39;)"><span class="hl_vardecl"><span class="mpre">decl</span></span></a><span class="mpre"> = do
  </span><a name="loc_1229_3_1229_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1229_3_1229_7&#39;)"><span class="hl_vardecl"><span class="mpre">cons</span></span></a><span class="mpre"> &lt;- case </span><a href="#loc_519_1_519_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_1_519_10&#39;)"><span class="hl_varref"><span class="mpre">deNewtype</span></span></a><span class="mpre"> </span><a href="#loc_1228_17_1228_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_17_1228_21&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">DataD</span></span><span class="mpre"> _ _ _ </span><a name="loc_1230_17_1230_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_17_1230_21&#39;)"><span class="hl_vardecl"><span class="mpre">cons</span></span></a><span class="mpre"> _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_1230_17_1230_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_17_1230_21&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">DataInstD</span></span><span class="mpre"> _ _ _ </span><a name="loc_1231_21_1231_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_21_1231_25&#39;)"><span class="hl_vardecl"><span class="mpre">cons</span></span></a><span class="mpre"> _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_1231_21_1231_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_21_1231_25&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre">
    _ -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;verboseLenses: Unsupported data type&quot;</span></span><span class="mpre">
  let </span><a name="loc_1233_7_1233_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1233_7_1233_9&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> = </span><a href="#loc_1222_1_1222_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1222_1_1222_15&#39;)"><span class="hl_varref"><span class="mpre">collectRecords</span></span></a><span class="mpre"> </span><a href="#loc_1229_3_1229_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1229_3_1229_7&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre">
  if </span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> </span><a href="#loc_1233_7_1233_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1233_7_1233_9&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
    then </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;verboseLenses: Expected the name of a record type&quot;</span></span><span class="mpre">
    else </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="#loc_1240_5_1240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1240_5_1240_16&#39;)"><span class="hl_varref"><span class="mpre">makeLenses&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1228_17_1228_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_17_1228_21&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_1247_1_1247_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_1_1247_9&#39;)"><span class="hl_varref"><span class="mpre">mkFields</span></span></a><span class="mpre"> </span><a href="#loc_1228_15_1228_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_15_1228_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_1233_7_1233_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1233_7_1233_9&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
            </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(</span><a href="#loc_1172_14_1172_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_14_1172_19&#39;)"><span class="hl_conref"><span class="mpre">Field</span></span></a><span class="mpre"> </span><a name="loc_1238_28_1238_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1238_28_1238_29&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ </span><a name="loc_1238_32_1238_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1238_32_1238_33&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> _ _ _) -&gt; (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_1238_28_1238_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1238_28_1238_29&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_1238_32_1238_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1238_32_1238_33&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">))
  where
    </span><a name="loc_1240_5_1240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1240_5_1240_16&#39;)"><span class="hl_fundecl"><span class="mpre">makeLenses&#39;</span></span></a><span class="mpre"> </span><a name="loc_1240_17_1240_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1240_17_1240_24&#39;)"><span class="hl_vardecl"><span class="mpre">fields&#39;</span></span></a><span class="mpre"> =
        </span><a href="#loc_708_1_708_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_1_708_17&#39;)"><span class="hl_varref"><span class="mpre">makeLensesForDec</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_226_1_226_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_10&#39;)"><span class="hl_varref"><span class="mpre">lensRules</span></span></a><span class="mpre">
            </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_199_1_199_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_1_199_10&#39;)"><span class="hl_varref"><span class="mpre">lensField</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`Prelude.lookup`</span></span><span class="mpre"> </span><a href="#loc_1240_17_1240_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1240_17_1240_24&#39;)"><span class="hl_varref"><span class="mpre">fields&#39;</span></span></a><span class="mpre">)
            </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_139_1_139_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_16&#39;)"><span class="hl_varref"><span class="mpre">buildTraversals</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
            </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_133_1_133_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_14&#39;)"><span class="hl_varref"><span class="mpre">partialLenses</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.~</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

</span><a href="#loc_1247_1_1247_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_1_1247_9&#39;)"><span class="mpre">mkFields</span></a><span class="mpre"> :: </span><a href="#loc_1165_6_1165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1165_6_1165_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldRules</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">VarStrictType</span></span><span class="mpre">] -&gt; [</span><a href="#loc_1172_6_1172_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_6_1172_11&#39;)"><span class="hl_tyconref"><span class="mpre">Field</span></span></a><span class="mpre">]
</span><a name="loc_1247_1_1247_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_1_1247_9&#39;)"><span class="hl_fundecl"><span class="mpre">mkFields</span></span></a><span class="mpre"> (</span><a href="#loc_1165_19_1165_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1165_19_1165_29&#39;)"><span class="hl_conref"><span class="mpre">FieldRules</span></span></a><span class="mpre"> </span><a name="loc_1247_22_1247_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_22_1247_29&#39;)"><span class="hl_vardecl"><span class="mpre">prefix&#39;</span></span></a><span class="mpre"> </span><a name="loc_1247_30_1247_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_30_1247_34&#39;)"><span class="hl_vardecl"><span class="mpre">raw&#39;</span></span></a><span class="mpre"> </span><a name="loc_1247_35_1247_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_35_1247_40&#39;)"><span class="hl_vardecl"><span class="mpre">nice&#39;</span></span></a><span class="mpre"> </span><a name="loc_1247_41_1247_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_41_1247_46&#39;)"><span class="hl_vardecl"><span class="mpre">clas&#39;</span></span></a><span class="mpre">) </span><a name="loc_1247_48_1247_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_48_1247_50&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">
    = </span><a href="Data.Maybe.html#loc_123_1_123_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_123_1_123_9&#39;)"><span class="hl_varref"><span class="mpre">Maybe.mapMaybe</span></span></a><span class="mpre"> </span><a href="#loc_1257_5_1257_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1257_5_1257_10&#39;)"><span class="hl_varref"><span class="mpre">namer</span></span></a><span class="mpre"> </span><a href="#loc_1254_5_1254_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1254_5_1254_23&#39;)"><span class="hl_varref"><span class="mpre">fieldNamesAndTypes</span></span></a><span class="mpre">
    </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="Data.List.html#loc_739_1_739_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_739_1_739_8&#39;)"><span class="hl_varref"><span class="mpre">List.groupBy</span></span></a><span class="mpre"> (</span><a href="Data.Function.html#loc_87_7_87_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Function.html#loc_87_7_87_11&#39;)"><span class="hl_varref"><span class="mpre">on</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(==)</span></span><span class="mpre"> </span><a href="#loc_1174_7_1174_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1174_7_1174_23&#39;)"><span class="hl_varref"><span class="mpre">_fieldLensPrefix</span></span></a><span class="mpre">)
    </span><a href="Control.Lens.Lens.html#loc_334_3_334_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Lens.html#loc_334_3_334_4&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> (\ </span><a name="loc_1250_10_1250_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1250_10_1250_12&#39;)"><span class="hl_vardecl"><span class="mpre">gs</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_1250_10_1250_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1250_10_1250_12&#39;)"><span class="hl_varref"><span class="mpre">gs</span></span></a><span class="mpre"> of
        </span><a name="loc_1251_9_1251_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1251_9_1251_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_ -&gt; </span><a href="#loc_1251_9_1251_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1251_9_1251_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        _   -&gt; [])
  where
    </span><a name="loc_1254_5_1254_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1254_5_1254_23&#39;)"><span class="hl_vardecl"><span class="mpre">fieldNamesAndTypes</span></span></a><span class="mpre"> = [(</span><span class="hl_varref"><span class="mpre">nameBase</span></span><span class="mpre"> </span><a href="#loc_1254_46_1254_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1254_46_1254_47&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, </span><a href="#loc_1254_50_1254_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1254_50_1254_51&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) | (</span><a name="loc_1254_46_1254_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1254_46_1254_47&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">,_,</span><a name="loc_1254_50_1254_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1254_50_1254_51&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_1247_48_1247_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_48_1247_50&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">]
    </span><a name="loc_1255_5_1255_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1255_5_1255_15&#39;)"><span class="hl_vardecl"><span class="mpre">fieldNames</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="#loc_1254_5_1254_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1254_5_1254_23&#39;)"><span class="hl_varref"><span class="mpre">fieldNamesAndTypes</span></span></a><span class="mpre">

    </span><a name="loc_1257_5_1257_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1257_5_1257_10&#39;)"><span class="hl_fundecl"><span class="mpre">namer</span></span></a><span class="mpre"> (</span><a name="loc_1257_12_1257_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1257_12_1257_17&#39;)"><span class="hl_vardecl"><span class="mpre">field</span></span></a><span class="mpre">, </span><a name="loc_1257_19_1257_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1257_19_1257_28&#39;)"><span class="hl_vardecl"><span class="mpre">fieldType</span></span></a><span class="mpre">) = do
        let </span><a name="loc_1258_13_1258_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1258_13_1258_20&#39;)"><span class="hl_vardecl"><span class="mpre">rawlens</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> (</span><a href="#loc_1247_30_1247_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_30_1247_34&#39;)"><span class="hl_varref"><span class="mpre">raw&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1257_12_1257_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1257_12_1257_17&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre">)
        </span><a name="loc_1259_9_1259_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1259_9_1259_15&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_1247_22_1247_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_22_1247_29&#39;)"><span class="hl_varref"><span class="mpre">prefix&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1255_5_1255_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1255_5_1255_15&#39;)"><span class="hl_varref"><span class="mpre">fieldNames</span></span></a><span class="mpre"> </span><a href="#loc_1257_12_1257_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1257_12_1257_17&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre">
        </span><a name="loc_1260_9_1260_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1260_9_1260_13&#39;)"><span class="hl_vardecl"><span class="mpre">nice</span></span></a><span class="mpre">   &lt;- </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_1247_35_1247_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_35_1247_40&#39;)"><span class="hl_varref"><span class="mpre">nice&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1257_12_1257_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1257_12_1257_17&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre">
        </span><a name="loc_1261_9_1261_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1261_9_1261_13&#39;)"><span class="hl_vardecl"><span class="mpre">clas</span></span></a><span class="mpre">   &lt;- </span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_1247_41_1247_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_41_1247_46&#39;)"><span class="hl_varref"><span class="mpre">clas&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1257_12_1257_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1257_12_1257_17&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_1172_14_1172_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_14_1172_19&#39;)"><span class="hl_conref"><span class="mpre">Field</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mkName</span></span><span class="mpre"> </span><a href="#loc_1257_12_1257_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1257_12_1257_17&#39;)"><span class="hl_varref"><span class="mpre">field</span></span></a><span class="mpre">) </span><a href="#loc_1259_9_1259_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1259_9_1259_15&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><a href="#loc_1258_13_1258_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1258_13_1258_20&#39;)"><span class="hl_varref"><span class="mpre">rawlens</span></span></a><span class="mpre"> </span><a href="#loc_1261_9_1261_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1261_9_1261_13&#39;)"><span class="hl_varref"><span class="mpre">clas</span></span></a><span class="mpre"> </span><a href="#loc_1260_9_1260_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1260_9_1260_13&#39;)"><span class="hl_varref"><span class="mpre">nice</span></span></a><span class="mpre"> </span><a href="#loc_1257_19_1257_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1257_19_1257_28&#39;)"><span class="hl_varref"><span class="mpre">fieldType</span></span></a><span class="mpre">)

</span><a href="#loc_1265_1_1265_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_1_1265_20&#39;)"><span class="mpre">hasClassAndInstance</span></a><span class="mpre"> :: </span><a href="#loc_1165_6_1165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1165_6_1165_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldRules</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_1265_1_1265_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_1_1265_20&#39;)"><span class="hl_fundecl"><span class="mpre">hasClassAndInstance</span></span></a><span class="mpre"> </span><a name="loc_1265_21_1265_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_21_1265_24&#39;)"><span class="hl_vardecl"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a name="loc_1265_25_1265_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_25_1265_29&#39;)"><span class="hl_vardecl"><span class="mpre">decl</span></span></a><span class="mpre"> = do
    </span><a name="loc_1266_5_1266_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1266_5_1266_6&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;c&quot;</span></span><span class="mpre">
    </span><a name="loc_1267_5_1267_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1267_5_1267_6&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newName</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;e&quot;</span></span><span class="mpre">
    </span><a name="loc_1268_5_1268_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_5_1268_13&#39;)"><span class="hl_vardecl"><span class="mpre">dataDecl</span></span></a><span class="mpre"> &lt;- case </span><a href="#loc_726_1_726_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_1_726_13&#39;)"><span class="hl_varref"><span class="mpre">makeDataDecl</span></span></a><span class="mpre"> </span><a href="#loc_1265_25_1265_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_25_1265_29&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_1269_14_1269_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1269_14_1269_22&#39;)"><span class="hl_vardecl"><span class="mpre">dataDecl</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_1269_14_1269_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1269_14_1269_22&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">
        _ -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;hasClassAndInstance: Unsupported data type&quot;</span></span><span class="mpre">
    let </span><a name="loc_1271_9_1271_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1271_9_1271_11&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> = </span><a href="#loc_1222_1_1222_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1222_1_1222_15&#39;)"><span class="hl_varref"><span class="mpre">collectRecords</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_762_5_762_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_762_5_762_17&#39;)"><span class="hl_varref"><span class="mpre">constructors</span></span></a><span class="mpre"> </span><a href="#loc_1268_5_1268_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_5_1268_13&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">List.null</span></span><span class="mpre"> </span><a href="#loc_1271_9_1271_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1271_9_1271_11&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;hasClassAndInstance: Expected the name of a record type&quot;</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Traversable.html#loc_215_1_215_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_215_1_215_5&#39;)"><span class="hl_varref"><span class="mpre">forM</span></span></a><span class="mpre"> (</span><a href="#loc_1247_1_1247_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_1_1247_9&#39;)"><span class="hl_varref"><span class="mpre">mkFields</span></span></a><span class="mpre"> </span><a href="#loc_1265_21_1265_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_21_1265_24&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a href="#loc_1271_9_1271_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1271_9_1271_11&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \(</span><a href="#loc_1172_14_1172_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_14_1172_19&#39;)"><span class="hl_conref"><span class="mpre">Field</span></span></a><span class="mpre"> _ _ </span><a name="loc_1274_56_1274_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_56_1274_68&#39;)"><span class="hl_vardecl"><span class="mpre">fullLensName</span></span></a><span class="mpre"> </span><a name="loc_1274_69_1274_78" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_69_1274_78&#39;)"><span class="hl_vardecl"><span class="mpre">className</span></span></a><span class="mpre"> </span><a name="loc_1274_79_1274_87" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_79_1274_87&#39;)"><span class="hl_vardecl"><span class="mpre">lensName</span></span></a><span class="mpre"> </span><a name="loc_1274_88_1274_97" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_88_1274_97&#39;)"><span class="hl_vardecl"><span class="mpre">fieldType</span></span></a><span class="mpre">) -&gt; do
        </span><a name="loc_1275_9_1275_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1275_9_1275_17&#39;)"><span class="hl_vardecl"><span class="mpre">classHas</span></span></a><span class="mpre"> &lt;- </span><a href="Language.Haskell.TH.Lib.html#loc_349_1_349_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_349_1_349_7&#39;)"><span class="hl_varref"><span class="mpre">classD</span></span></a><span class="mpre">
            (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [])
            </span><a href="#loc_1274_69_1274_78" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_69_1274_78&#39;)"><span class="hl_varref"><span class="mpre">className</span></span></a><span class="mpre">
            [ </span><span class="hl_conref"><span class="mpre">PlainTV</span></span><span class="mpre"> </span><a href="#loc_1266_5_1266_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1266_5_1266_6&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">PlainTV</span></span><span class="mpre"> </span><a href="#loc_1267_5_1267_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1267_5_1267_6&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> ]
            [ </span><span class="hl_conref"><span class="mpre">FunDep</span></span><span class="mpre"> [</span><a href="#loc_1266_5_1266_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1266_5_1266_6&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">] [</span><a href="#loc_1267_5_1267_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1267_5_1267_6&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">] ]
            [ </span><a href="Language.Haskell.TH.Lib.html#loc_364_1_364_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_364_1_364_5&#39;)"><span class="hl_varref"><span class="mpre">sigD</span></span></a><span class="mpre"> </span><a href="#loc_1274_79_1274_87" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_79_1274_87&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_510_1_510_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_510_1_510_5&#39;)"><span class="hl_varref"><span class="mpre">conT</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpTypQuote (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1280, srcSpanStartColumn = 35, srcSpanEndLine = 1280, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1280, srcSpanStartColumn = 35, srcSpanEndLine = 1280, srcSpanEndColumn = 37}]}) (UnQual (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/C"><span class="mpre">&#39;&#39;Lens&#39;</span></span><span class="mpre"> </span><a href="Control.Lens.Internal.TH.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.TH.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">`appsT`</span></span></a><span class="mpre"> [</span><a href="Language.Haskell.TH.Lib.html#loc_507_1_507_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_507_1_507_5&#39;)"><span class="hl_varref"><span class="mpre">varT</span></span></a><span class="mpre"> </span><a href="#loc_1266_5_1266_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1266_5_1266_6&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><a href="Language.Haskell.TH.Lib.html#loc_507_1_507_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_507_1_507_5&#39;)"><span class="hl_varref"><span class="mpre">varT</span></span></a><span class="mpre"> </span><a href="#loc_1267_5_1267_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1267_5_1267_6&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">])]
        </span><a name="loc_1281_9_1281_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1281_9_1281_20&#39;)"><span class="hl_vardecl"><span class="mpre">instanceHas</span></span></a><span class="mpre"> &lt;- </span><a href="Language.Haskell.TH.Lib.html#loc_356_1_356_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_356_1_356_10&#39;)"><span class="hl_varref"><span class="mpre">instanceD</span></span></a><span class="mpre">
            (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [])
            (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ConT</span></span><span class="mpre"> </span><a href="#loc_1274_69_1274_78" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_69_1274_78&#39;)"><span class="hl_varref"><span class="mpre">className</span></span></a><span class="mpre"> </span><a href="#loc_705_1_705_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_705_1_705_5&#39;)"><span class="hl_infix"><span class="mpre">`apps`</span></span></a><span class="mpre">
              [</span><a href="#loc_759_5_759_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_5_759_13&#39;)"><span class="hl_varref"><span class="mpre">fullType</span></span></a><span class="mpre"> </span><a href="#loc_1268_5_1268_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_5_1268_13&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">VarT</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Lens.Getter.html#loc_201_1_201_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Getter.html#loc_201_1_201_5&#39;)"><span class="hl_varref"><span class="mpre">view</span></span></a><span class="mpre"> </span><a href="Language.Haskell.TH.Lens.html#loc_287_3_287_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lens.html#loc_287_3_287_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">) (</span><a href="#loc_758_5_758_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_5_758_19&#39;)"><span class="hl_varref"><span class="mpre">dataParameters</span></span></a><span class="mpre"> </span><a href="#loc_1268_5_1268_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_5_1268_13&#39;)"><span class="hl_varref"><span class="mpre">dataDecl</span></span></a><span class="mpre">)
              , </span><a href="#loc_1274_88_1274_97" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_88_1274_97&#39;)"><span class="hl_varref"><span class="mpre">fieldType</span></span></a><span class="mpre">])
            [
#ifdef INLINING
              </span><a href="#loc_1152_1_1152_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1152_1_1152_13&#39;)"><span class="hl_varref"><span class="mpre">inlinePragma</span></span></a><span class="mpre"> </span><a href="#loc_1274_79_1274_87" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_79_1274_87&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre">,
#endif
              </span><a href="Language.Haskell.TH.Lib.html#loc_326_1_326_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_326_1_326_5&#39;)"><span class="hl_varref"><span class="mpre">funD</span></span></a><span class="mpre"> </span><a href="#loc_1274_79_1274_87" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_79_1274_87&#39;)"><span class="hl_varref"><span class="mpre">lensName</span></span></a><span class="mpre"> [ </span><a href="Language.Haskell.TH.Lib.html#loc_189_1_189_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_189_1_189_7&#39;)"><span class="hl_varref"><span class="mpre">clause</span></span></a><span class="mpre"> [] (</span><a href="Language.Haskell.TH.Lib.html#loc_155_1_155_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_155_1_155_8&#39;)"><span class="hl_varref"><span class="mpre">normalB</span></span></a><span class="mpre"> (</span><a href="Language.Haskell.TH.Lib.html#loc_208_1_208_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.TH.Lib.html#loc_208_1_208_5&#39;)"><span class="hl_varref"><span class="mpre">varE</span></span></a><span class="mpre"> </span><a href="#loc_1274_56_1274_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_56_1274_68&#39;)"><span class="hl_varref"><span class="mpre">fullLensName</span></span></a><span class="mpre">)) [] ]
            ]
        </span><a name="loc_1292_9_1292_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1292_9_1292_27&#39;)"><span class="hl_vardecl"><span class="mpre">classAlreadyExists</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">lookupTypeName</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_1274_69_1274_78" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_69_1274_78&#39;)"><span class="hl_varref"><span class="mpre">className</span></span></a><span class="mpre">)
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (if </span><a href="#loc_1292_9_1292_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1292_9_1292_27&#39;)"><span class="hl_varref"><span class="mpre">classAlreadyExists</span></span></a><span class="mpre"> then [</span><a href="#loc_1281_9_1281_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1281_9_1281_20&#39;)"><span class="hl_varref"><span class="mpre">instanceHas</span></span></a><span class="mpre">] else [</span><a href="#loc_1275_9_1275_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1275_9_1275_17&#39;)"><span class="hl_varref"><span class="mpre">classHas</span></span></a><span class="mpre">, </span><a href="#loc_1281_9_1281_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1281_9_1281_20&#39;)"><span class="hl_varref"><span class="mpre">instanceHas</span></span></a><span class="mpre">])

</span><span class="hl_comment"><span class="mpre">-- | Make fields with the specified &#39;FieldRules&#39;.</span></span><span class="mpre">
</span><a href="#loc_1297_1_1297_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1297_1_1297_15&#39;)"><span class="mpre">makeFieldsWith</span></a><span class="mpre"> :: </span><a href="#loc_1165_6_1165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1165_6_1165_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldRules</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_1297_1_1297_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1297_1_1297_15&#39;)"><span class="hl_fundecl"><span class="mpre">makeFieldsWith</span></span></a><span class="mpre"> </span><a name="loc_1297_16_1297_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1297_16_1297_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_1297_18_1297_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1297_18_1297_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = do
  </span><a name="loc_1298_3_1298_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1298_3_1298_6&#39;)"><span class="hl_vardecl"><span class="mpre">inf</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">reify</span></span><span class="mpre"> </span><a href="#loc_1297_18_1297_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1297_18_1297_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
  case </span><a href="#loc_1298_3_1298_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1298_3_1298_6&#39;)"><span class="hl_varref"><span class="mpre">inf</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">TyConI</span></span><span class="mpre"> </span><a name="loc_1300_12_1300_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1300_12_1300_16&#39;)"><span class="hl_vardecl"><span class="mpre">decl</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_1304_1_1304_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1304_1_1304_17&#39;)"><span class="hl_varref"><span class="mpre">makeFieldsForDec</span></span></a><span class="mpre"> </span><a href="#loc_1297_16_1297_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1297_16_1297_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_1300_12_1300_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1300_12_1300_16&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre">
    _ -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;makeFieldsWith: Expected the name of a data type or newtype&quot;</span></span><span class="mpre">

</span><a href="#loc_1304_1_1304_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1304_1_1304_17&#39;)"><span class="mpre">makeFieldsForDec</span></a><span class="mpre"> :: </span><a href="#loc_1165_6_1165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1165_6_1165_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldRules</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_1304_1_1304_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1304_1_1304_17&#39;)"><span class="hl_fundecl"><span class="mpre">makeFieldsForDec</span></span></a><span class="mpre"> </span><a name="loc_1304_18_1304_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1304_18_1304_21&#39;)"><span class="hl_vardecl"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a name="loc_1304_22_1304_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1304_22_1304_26&#39;)"><span class="hl_vardecl"><span class="mpre">decl</span></span></a><span class="mpre"> = </span><a href="Control.Applicative.html#loc_317_1_317_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_317_1_317_7&#39;)"><span class="hl_varref"><span class="mpre">liftA2</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(++)</span></span><span class="mpre">
  (</span><a href="#loc_1228_1_1228_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_1_1228_14&#39;)"><span class="hl_varref"><span class="mpre">verboseLenses</span></span></a><span class="mpre"> </span><a href="#loc_1304_18_1304_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1304_18_1304_21&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a href="#loc_1304_22_1304_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1304_22_1304_26&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre">)
  (</span><a href="#loc_1265_1_1265_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_1_1265_20&#39;)"><span class="hl_varref"><span class="mpre">hasClassAndInstance</span></span></a><span class="mpre"> </span><a href="#loc_1304_18_1304_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1304_18_1304_21&#39;)"><span class="hl_varref"><span class="mpre">cfg</span></span></a><span class="mpre"> </span><a href="#loc_1304_22_1304_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1304_22_1304_26&#39;)"><span class="hl_varref"><span class="mpre">decl</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Generate overloaded field accessors.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /e.g/</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- data Foo a = Foo { _fooX :: &#39;Int&#39;, _fooY : a }</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- newtype Bar = Bar { _barX :: &#39;Char&#39; }</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- makeFields &#39;&#39;Foo</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- makeFields &#39;&#39;Bar</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will create</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- _fooXLens :: Lens&#39; (Foo a) Int</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- _fooYLens :: Lens (Foo a) (Foo b) a b</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- class HasX s a | s -&gt; a where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   x :: Lens&#39; s a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instance HasX (Foo a) Int where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   x = _fooXLens</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- class HasY s a | s -&gt; a where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   y :: Lens&#39; s a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instance HasY (Foo a) a where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   y = _fooYLens</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- _barXLens :: Iso&#39; Bar Char</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instance HasX Bar Char where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   x = _barXLens</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- makeFields = &#39;makeFieldsWith&#39; &#39;defaultFieldRules&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_1341_1_1341_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1341_1_1341_11&#39;)"><span class="mpre">makeFields</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_1341_1_1341_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1341_1_1341_11&#39;)"><span class="hl_vardecl"><span class="mpre">makeFields</span></span></a><span class="mpre"> = </span><a href="#loc_1297_1_1297_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1297_1_1297_15&#39;)"><span class="hl_varref"><span class="mpre">makeFieldsWith</span></span></a><span class="mpre"> </span><a href="#loc_1345_1_1345_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1345_1_1345_18&#39;)"><span class="hl_varref"><span class="mpre">defaultFieldRules</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @ defaultFieldRules = &#39;camelCaseFields&#39; @</span></span><span class="mpre">
</span><a href="#loc_1345_1_1345_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1345_1_1345_18&#39;)"><span class="mpre">defaultFieldRules</span></a><span class="mpre"> :: </span><a href="#loc_1165_6_1165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1165_6_1165_16&#39;)"><span class="hl_tyconref"><span class="mpre">FieldRules</span></span></a><span class="mpre">
</span><a name="loc_1345_1_1345_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1345_1_1345_18&#39;)"><span class="hl_vardecl"><span class="mpre">defaultFieldRules</span></span></a><span class="mpre"> = </span><a href="#loc_1199_1_1199_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1199_1_1199_16&#39;)"><span class="hl_varref"><span class="mpre">camelCaseFields</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Declaration quote stuff</span></span><span class="mpre">

</span><a href="#loc_1350_1_1350_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1350_1_1350_12&#39;)"><span class="mpre">declareWith</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Declare</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_1350_1_1350_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1350_1_1350_12&#39;)"><span class="hl_fundecl"><span class="mpre">declareWith</span></span></a><span class="mpre"> </span><a name="loc_1350_13_1350_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1350_13_1350_16&#39;)"><span class="hl_vardecl"><span class="mpre">fun</span></span></a><span class="mpre"> = (</span><a href="#loc_1356_1_1356_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1356_1_1356_11&#39;)"><span class="hl_varref"><span class="mpre">runDeclare</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1366_1_1366_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1366_1_1366_23&#39;)"><span class="hl_varref"><span class="mpre">traverseDataAndNewtype</span></span></a><span class="mpre"> </span><a href="#loc_1350_13_1350_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1350_13_1350_16&#39;)"><span class="hl_varref"><span class="mpre">fun</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Monad for emitting top-level declarations as a side effect.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1353, srcSpanStartColumn = 1, srcSpanEndLine = 1353, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1353, srcSpanStartColumn = 1, srcSpanEndLine = 1353, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 135"><span class="mpre">type Declare = WriterT (Endo [Dec]) Q</span></span><span class="mpre">

</span><a href="#loc_1356_1_1356_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1356_1_1356_11&#39;)"><span class="mpre">runDeclare</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Declare</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Q</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_1356_1_1356_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1356_1_1356_11&#39;)"><span class="hl_fundecl"><span class="mpre">runDeclare</span></span></a><span class="mpre"> </span><a name="loc_1356_12_1356_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1356_12_1356_15&#39;)"><span class="hl_vardecl"><span class="mpre">dec</span></span></a><span class="mpre"> = do
  (</span><a name="loc_1357_4_1357_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1357_4_1357_7&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre">, </span><a name="loc_1357_9_1357_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1357_9_1357_13&#39;)"><span class="hl_vardecl"><span class="mpre">endo</span></span></a><span class="mpre">) &lt;- </span><a href="Control.Monad.Trans.Writer.Lazy.html#loc_95_35_95_45" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Writer.Lazy.html#loc_95_35_95_45&#39;)"><span class="hl_varref"><span class="mpre">runWriterT</span></span></a><span class="mpre"> </span><a href="#loc_1356_12_1356_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1356_12_1356_15&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_1357_4_1357_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1357_4_1357_7&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_162_25_162_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_162_25_162_32&#39;)"><span class="hl_varref"><span class="mpre">appEndo</span></span></a><span class="mpre"> </span><a href="#loc_1357_9_1357_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1357_9_1357_13&#39;)"><span class="hl_varref"><span class="mpre">endo</span></span></a><span class="mpre"> []

</span><a href="#loc_1361_1_1361_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1361_1_1361_5&#39;)"><span class="mpre">emit</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Declare</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_1361_1_1361_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1361_1_1361_5&#39;)"><span class="hl_fundecl"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a name="loc_1361_6_1361_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1361_6_1361_10&#39;)"><span class="hl_vardecl"><span class="mpre">decs</span></span></a><span class="mpre"> = </span><a href="Control.Monad.Trans.Writer.Lazy.html#loc_156_1_156_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Writer.Lazy.html#loc_156_1_156_5&#39;)"><span class="hl_varref"><span class="mpre">tell</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Endo</span></span><span class="mpre"> (</span><a href="#loc_1361_6_1361_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1361_6_1361_10&#39;)"><span class="hl_varref"><span class="mpre">decs</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Traverse each data, newtype, data instance or newtype instance</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- declaration.</span></span><span class="mpre">
</span><a href="#loc_1366_1_1366_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1366_1_1366_23&#39;)"><span class="mpre">traverseDataAndNewtype</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1365, srcSpanStartColumn = 27, srcSpanEndLine = 1365, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1365, srcSpanStartColumn = 27, srcSpanEndLine = 1365, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1"><span class="mpre">(Applicative f) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">) -&gt; [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">]
</span><a name="loc_1366_1_1366_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1366_1_1366_23&#39;)"><span class="hl_fundecl"><span class="mpre">traverseDataAndNewtype</span></span></a><span class="mpre"> </span><a name="loc_1366_24_1366_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1366_24_1366_25&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_1366_26_1366_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1366_26_1366_30&#39;)"><span class="hl_vardecl"><span class="mpre">decs</span></span></a><span class="mpre"> = </span><a href="Data.Traversable.html#loc_150_5_150_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_150_5_150_13&#39;)"><span class="hl_varref"><span class="mpre">traverse</span></span></a><span class="mpre"> </span><a href="#loc_1368_5_1368_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1368_5_1368_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_1366_26_1366_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1366_26_1366_30&#39;)"><span class="hl_varref"><span class="mpre">decs</span></span></a><span class="mpre">
  where
    </span><a name="loc_1368_5_1368_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1368_5_1368_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_1368_8_1368_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1368_8_1368_11&#39;)"><span class="hl_vardecl"><span class="mpre">dec</span></span></a><span class="mpre"> = case </span><a href="#loc_1368_8_1368_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1368_8_1368_11&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre"> of
      </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1369, srcSpanStartColumn = 7, srcSpanEndLine = 1369, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1369, srcSpanStartColumn = 12, srcSpanEndLine = 1369, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1369,"><span class="mpre">DataD{}</span></span><span class="mpre"> -&gt; </span><a href="#loc_1366_24_1366_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1366_24_1366_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_1368_8_1368_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1368_8_1368_11&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">
      </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1370, srcSpanStartColumn = 7, srcSpanEndLine = 1370, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1370, srcSpanStartColumn = 15, srcSpanEndLine = 1370, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1370,"><span class="mpre">NewtypeD{}</span></span><span class="mpre"> -&gt; </span><a href="#loc_1366_24_1366_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1366_24_1366_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_1368_8_1368_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1368_8_1368_11&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">
      </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1371, srcSpanStartColumn = 7, srcSpanEndLine = 1371, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1371, srcSpanStartColumn = 16, srcSpanEndLine = 1371, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1371,"><span class="mpre">DataInstD{}</span></span><span class="mpre"> -&gt; </span><a href="#loc_1366_24_1366_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1366_24_1366_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_1368_8_1368_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1368_8_1368_11&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">
      </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1372, srcSpanStartColumn = 7, srcSpanEndLine = 1372, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1372, srcSpanStartColumn = 19, srcSpanEndLine = 1372, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1372,"><span class="mpre">NewtypeInstD{}</span></span><span class="mpre"> -&gt; </span><a href="#loc_1366_24_1366_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1366_24_1366_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_1368_8_1368_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1368_8_1368_11&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">

      </span><span class="hl_comment"><span class="mpre">-- Recurse into instance declarations because they main contain</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- associated data family instances.</span></span><span class="mpre">
      </span><span class="hl_conref"><span class="mpre">InstanceD</span></span><span class="mpre"> </span><a name="loc_1376_17_1376_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1376_17_1376_20&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_1376_21_1376_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1376_21_1376_25&#39;)"><span class="hl_vardecl"><span class="mpre">inst</span></span></a><span class="mpre"> </span><a name="loc_1376_26_1376_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1376_26_1376_30&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">InstanceD</span></span><span class="mpre"> </span><a href="#loc_1376_17_1376_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1376_17_1376_20&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_1376_21_1376_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1376_21_1376_25&#39;)"><span class="hl_varref"><span class="mpre">inst</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Data.Traversable.html#loc_150_5_150_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Traversable.html#loc_150_5_150_13&#39;)"><span class="hl_varref"><span class="mpre">traverse</span></span></a><span class="mpre"> </span><a href="#loc_1368_5_1368_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1368_5_1368_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_1376_26_1376_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1376_26_1376_30&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">

      _ -&gt; </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_varref"><span class="mpre">pure</span></span></a><span class="mpre"> </span><a href="#loc_1368_8_1368_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1368_8_1368_11&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">

</span><a href="#loc_1381_1_1381_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1381_1_1381_12&#39;)"><span class="mpre">stripFields</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Dec</span></span><span class="mpre">
</span><a name="loc_1381_1_1381_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1381_1_1381_12&#39;)"><span class="hl_fundecl"><span class="mpre">stripFields</span></span></a><span class="mpre"> </span><a name="loc_1381_13_1381_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1381_13_1381_16&#39;)"><span class="hl_vardecl"><span class="mpre">dec</span></span></a><span class="mpre"> = case </span><a href="#loc_1381_13_1381_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1381_13_1381_16&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre"> of
  </span><span class="hl_conref"><span class="mpre">DataD</span></span><span class="mpre"> </span><a name="loc_1382_9_1382_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1382_9_1382_12&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_1382_13_1382_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1382_13_1382_19&#39;)"><span class="hl_vardecl"><span class="mpre">tyName</span></span></a><span class="mpre"> </span><a name="loc_1382_20_1382_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1382_20_1382_26&#39;)"><span class="hl_vardecl"><span class="mpre">tyArgs</span></span></a><span class="mpre"> </span><a name="loc_1382_27_1382_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1382_27_1382_31&#39;)"><span class="hl_vardecl"><span class="mpre">cons</span></span></a><span class="mpre"> </span><a name="loc_1382_32_1382_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1382_32_1382_41&#39;)"><span class="hl_vardecl"><span class="mpre">derivings</span></span></a><span class="mpre"> -&gt;
    </span><span class="hl_conref"><span class="mpre">DataD</span></span><span class="mpre"> </span><a href="#loc_1382_9_1382_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1382_9_1382_12&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_1382_13_1382_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1382_13_1382_19&#39;)"><span class="hl_varref"><span class="mpre">tyName</span></span></a><span class="mpre"> </span><a href="#loc_1382_20_1382_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1382_20_1382_26&#39;)"><span class="hl_varref"><span class="mpre">tyArgs</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_1393_1_1393_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1393_1_1393_9&#39;)"><span class="hl_varref"><span class="mpre">deRecord</span></span></a><span class="mpre"> </span><a href="#loc_1382_27_1382_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1382_27_1382_31&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre">) </span><a href="#loc_1382_32_1382_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1382_32_1382_41&#39;)"><span class="hl_varref"><span class="mpre">derivings</span></span></a><span class="mpre">
  </span><span class="hl_conref"><span class="mpre">NewtypeD</span></span><span class="mpre"> </span><a name="loc_1384_12_1384_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1384_12_1384_15&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_1384_16_1384_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1384_16_1384_22&#39;)"><span class="hl_vardecl"><span class="mpre">tyName</span></span></a><span class="mpre"> </span><a name="loc_1384_23_1384_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1384_23_1384_29&#39;)"><span class="hl_vardecl"><span class="mpre">tyArgs</span></span></a><span class="mpre"> </span><a name="loc_1384_30_1384_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1384_30_1384_33&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre"> </span><a name="loc_1384_34_1384_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1384_34_1384_43&#39;)"><span class="hl_vardecl"><span class="mpre">derivings</span></span></a><span class="mpre"> -&gt;
    </span><span class="hl_conref"><span class="mpre">NewtypeD</span></span><span class="mpre"> </span><a href="#loc_1384_12_1384_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1384_12_1384_15&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_1384_16_1384_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1384_16_1384_22&#39;)"><span class="hl_varref"><span class="mpre">tyName</span></span></a><span class="mpre"> </span><a href="#loc_1384_23_1384_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1384_23_1384_29&#39;)"><span class="hl_varref"><span class="mpre">tyArgs</span></span></a><span class="mpre"> (</span><a href="#loc_1393_1_1393_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1393_1_1393_9&#39;)"><span class="hl_varref"><span class="mpre">deRecord</span></span></a><span class="mpre"> </span><a href="#loc_1384_30_1384_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1384_30_1384_33&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">) </span><a href="#loc_1384_34_1384_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1384_34_1384_43&#39;)"><span class="hl_varref"><span class="mpre">derivings</span></span></a><span class="mpre">
  </span><span class="hl_conref"><span class="mpre">DataInstD</span></span><span class="mpre"> </span><a name="loc_1386_13_1386_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1386_13_1386_16&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_1386_17_1386_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1386_17_1386_23&#39;)"><span class="hl_vardecl"><span class="mpre">tyName</span></span></a><span class="mpre"> </span><a name="loc_1386_24_1386_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1386_24_1386_30&#39;)"><span class="hl_vardecl"><span class="mpre">tyArgs</span></span></a><span class="mpre"> </span><a name="loc_1386_31_1386_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1386_31_1386_35&#39;)"><span class="hl_vardecl"><span class="mpre">cons</span></span></a><span class="mpre"> </span><a name="loc_1386_36_1386_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1386_36_1386_45&#39;)"><span class="hl_vardecl"><span class="mpre">derivings</span></span></a><span class="mpre"> -&gt;
    </span><span class="hl_conref"><span class="mpre">DataInstD</span></span><span class="mpre"> </span><a href="#loc_1386_13_1386_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1386_13_1386_16&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_1386_17_1386_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1386_17_1386_23&#39;)"><span class="hl_varref"><span class="mpre">tyName</span></span></a><span class="mpre"> </span><a href="#loc_1386_24_1386_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1386_24_1386_30&#39;)"><span class="hl_varref"><span class="mpre">tyArgs</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_1393_1_1393_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1393_1_1393_9&#39;)"><span class="hl_varref"><span class="mpre">deRecord</span></span></a><span class="mpre"> </span><a href="#loc_1386_31_1386_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1386_31_1386_35&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre">) </span><a href="#loc_1386_36_1386_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1386_36_1386_45&#39;)"><span class="hl_varref"><span class="mpre">derivings</span></span></a><span class="mpre">
  </span><span class="hl_conref"><span class="mpre">NewtypeInstD</span></span><span class="mpre"> </span><a name="loc_1388_16_1388_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1388_16_1388_19&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_1388_20_1388_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1388_20_1388_26&#39;)"><span class="hl_vardecl"><span class="mpre">tyName</span></span></a><span class="mpre"> </span><a name="loc_1388_27_1388_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1388_27_1388_33&#39;)"><span class="hl_vardecl"><span class="mpre">tyArgs</span></span></a><span class="mpre"> </span><a name="loc_1388_34_1388_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1388_34_1388_37&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre"> </span><a name="loc_1388_38_1388_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1388_38_1388_47&#39;)"><span class="hl_vardecl"><span class="mpre">derivings</span></span></a><span class="mpre"> -&gt;
    </span><span class="hl_conref"><span class="mpre">NewtypeInstD</span></span><span class="mpre"> </span><a href="#loc_1388_16_1388_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1388_16_1388_19&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_1388_20_1388_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1388_20_1388_26&#39;)"><span class="hl_varref"><span class="mpre">tyName</span></span></a><span class="mpre"> </span><a href="#loc_1388_27_1388_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1388_27_1388_33&#39;)"><span class="hl_varref"><span class="mpre">tyArgs</span></span></a><span class="mpre"> (</span><a href="#loc_1393_1_1393_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1393_1_1393_9&#39;)"><span class="hl_varref"><span class="mpre">deRecord</span></span></a><span class="mpre"> </span><a href="#loc_1388_34_1388_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1388_34_1388_37&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">) </span><a href="#loc_1388_38_1388_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1388_38_1388_47&#39;)"><span class="hl_varref"><span class="mpre">derivings</span></span></a><span class="mpre">
  _ -&gt; </span><a href="#loc_1381_13_1381_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1381_13_1381_16&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre">

</span><a href="#loc_1393_1_1393_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1393_1_1393_9&#39;)"><span class="mpre">deRecord</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Con</span></span><span class="mpre">
</span><a name="loc_1393_1_1393_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1393_1_1393_9&#39;)"><span class="hl_fundecl"><span class="mpre">deRecord</span></span></a><span class="mpre"> </span><a name="loc_1393_10_1393_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1393_10_1393_13&#39;)"><span class="hl_specname"><span class="mpre">con</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1393, srcSpanStartColumn = 14, srcSpanEndLine = 1393, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1393, srcSpanStartColumn = 21, srcSpanEndLine = 1393, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1393"><span class="mpre">NormalC{}</span></span><span class="mpre"> = </span><a href="#loc_1393_10_1393_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1393_10_1393_13&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">
</span><a href="#loc_1393_1_1393_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1393_1_1393_9&#39;)"><span class="hl_fundecl"><span class="mpre">deRecord</span></span></a><span class="mpre"> </span><a name="loc_1394_10_1394_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1394_10_1394_13&#39;)"><span class="hl_specname"><span class="mpre">con</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1394, srcSpanStartColumn = 14, srcSpanEndLine = 1394, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1394, srcSpanStartColumn = 20, srcSpanEndLine = 1394, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/TH.hs&quot;, srcSpanStartLine = 1394"><span class="mpre">InfixC{}</span></span><span class="mpre"> = </span><a href="#loc_1394_10_1394_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1394_10_1394_13&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">
</span><a href="#loc_1393_1_1393_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1393_1_1393_9&#39;)"><span class="hl_fundecl"><span class="mpre">deRecord</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ForallC</span></span><span class="mpre"> </span><a name="loc_1395_19_1395_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1395_19_1395_25&#39;)"><span class="hl_vardecl"><span class="mpre">tyVars</span></span></a><span class="mpre"> </span><a name="loc_1395_26_1395_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1395_26_1395_29&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_1395_30_1395_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1395_30_1395_33&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">ForallC</span></span><span class="mpre"> </span><a href="#loc_1395_19_1395_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1395_19_1395_25&#39;)"><span class="hl_varref"><span class="mpre">tyVars</span></span></a><span class="mpre"> </span><a href="#loc_1395_26_1395_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1395_26_1395_29&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_1393_1_1393_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1393_1_1393_9&#39;)"><span class="hl_varref"><span class="mpre">deRecord</span></span></a><span class="mpre"> </span><a href="#loc_1395_30_1395_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1395_30_1395_33&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">
</span><a href="#loc_1393_1_1393_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1393_1_1393_9&#39;)"><span class="hl_fundecl"><span class="mpre">deRecord</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">RecC</span></span><span class="mpre"> </span><a name="loc_1396_16_1396_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1396_16_1396_23&#39;)"><span class="hl_vardecl"><span class="mpre">conName</span></span></a><span class="mpre"> </span><a name="loc_1396_24_1396_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1396_24_1396_30&#39;)"><span class="hl_vardecl"><span class="mpre">fields</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">NormalC</span></span><span class="mpre"> </span><a href="#loc_1396_16_1396_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1396_16_1396_23&#39;)"><span class="hl_varref"><span class="mpre">conName</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_1397_9_1397_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1397_9_1397_22&#39;)"><span class="hl_varref"><span class="mpre">dropFieldName</span></span></a><span class="mpre"> </span><a href="#loc_1396_24_1396_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1396_24_1396_30&#39;)"><span class="hl_varref"><span class="mpre">fields</span></span></a><span class="mpre">)
  where </span><a name="loc_1397_9_1397_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1397_9_1397_22&#39;)"><span class="hl_fundecl"><span class="mpre">dropFieldName</span></span></a><span class="mpre"> (_, </span><a name="loc_1397_27_1397_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1397_27_1397_30&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">, </span><a name="loc_1397_32_1397_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1397_32_1397_35&#39;)"><span class="hl_vardecl"><span class="mpre">typ</span></span></a><span class="mpre">) = (</span><a href="#loc_1397_27_1397_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1397_27_1397_30&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">, </span><a href="#loc_1397_32_1397_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1397_32_1397_35&#39;)"><span class="hl_varref"><span class="mpre">typ</span></span></a><span class="mpre">)
</span></div></body></html>