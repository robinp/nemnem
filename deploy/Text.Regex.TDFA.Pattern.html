<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | This &quot;Text.Regex.TDFA.Pattern&quot; module provides the &#39;Pattern&#39; data</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- type and its subtypes.  This &#39;Pattern&#39; type is used to represent</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the parsed form of a Regular Expression.  </span></span><span class="mpre">
module Text.Regex.TDFA.Pattern
    (Pattern(..)
    ,PatternSet(..)
    ,PatternSetCharacterClass(..)
    ,PatternSetCollatingElement(..)
    ,PatternSetEquivalenceClass(..)
    ,GroupIndex
    ,DoPa(..)
    ,showPattern
</span><span class="hl_comment"><span class="mpre">-- ** Internal use</span></span><span class="mpre">
    ,starTrans
</span><span class="hl_comment"><span class="mpre">-- ** Internal use, Operations to support debugging under ghci</span></span><span class="mpre">
    ,starTrans&#39;,simplify&#39;,dfsPattern
    ) where

</span><span class="hl_comment"><span class="mpre">{- By Chris Kuklewicz, 2007. BSD License, see the LICENSE file. -}</span></span><span class="mpre">

import Data.List(</span><a href="Data.List.html#loc_427_1_427_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_427_1_427_12&#39;)"><span class="mpre">intersperse</span></a><span class="mpre">,</span><a href="Data.List.html#loc_464_1_464_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_464_1_464_10&#39;)"><span class="mpre">partition</span></a><span class="mpre">)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 18, srcSpanEndLine = 22, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;Data.Set&quot;"><span class="mpre">Data.Set</span></span><span class="mpre"> as Set(toAscList,toList)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 8, srcSpanEndLine = 23, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;Data.Set&quot;"><span class="mpre">Data.Set</span></span><span class="mpre">(Set) </span><span class="hl_comment"><span class="mpre">-- XXX EnumSet</span></span><span class="mpre">
import Text.Regex.TDFA.Common(</span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="mpre">DoPa</span></a><span class="mpre">(..),GroupIndex,</span><a href="Text.Regex.TDFA.Common.html#loc_29_1_29_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_29_1_29_13&#39;)"><span class="mpre">common_error</span></a><span class="mpre">)

</span><a href="#loc_27_1_27_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_4&#39;)"><span class="mpre">err</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_27_1_27_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_4&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> = </span><a href="Text.Regex.TDFA.Common.html#loc_29_1_29_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_29_1_29_13&#39;)"><span class="hl_varref"><span class="mpre">common_error</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Text.Regex.TDFA.Pattern&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Pattern is the type returned by the regular expression parser.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is consumed by the CorePattern module and the tender leaves</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- are nibbled by the TNFA module.</span></span><span class="mpre">
data </span><a name="loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tycondecl"><span class="mpre">Pattern</span></span></a><span class="mpre"> = </span><a name="loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_condecl"><span class="mpre">PEmpty</span></span></a><span class="mpre">
             | </span><a name="loc_33_16_33_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_16_33_22&#39;)"><span class="hl_condecl"><span class="mpre">PGroup</span></span></a><span class="mpre">  (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">GroupIndex</span></span><span class="mpre">) </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- Nothing to indicate non-matching PGroup (Nothing never used!)</span></span><span class="mpre">
             | </span><a name="loc_34_16_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_16_34_19&#39;)"><span class="hl_condecl"><span class="mpre">POr</span></span></a><span class="mpre">     [</span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">]                  </span><span class="hl_comment"><span class="mpre">-- flattened by starTrans</span></span><span class="mpre">
             | </span><a name="loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_condecl"><span class="mpre">PConcat</span></span></a><span class="mpre"> [</span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">]                  </span><span class="hl_comment"><span class="mpre">-- flattened by starTrans</span></span><span class="mpre">
             | </span><a name="loc_36_16_36_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_16_36_22&#39;)"><span class="hl_condecl"><span class="mpre">PQuest</span></span></a><span class="mpre">  </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">                    </span><span class="hl_comment"><span class="mpre">-- eliminated by starTrans</span></span><span class="mpre">
             | </span><a name="loc_37_16_37_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_16_37_21&#39;)"><span class="hl_condecl"><span class="mpre">PPlus</span></span></a><span class="mpre">   </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">                    </span><span class="hl_comment"><span class="mpre">-- eliminated by starTrans</span></span><span class="mpre">
             | </span><a name="loc_38_16_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_21&#39;)"><span class="hl_condecl"><span class="mpre">PStar</span></span></a><span class="mpre">   </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">               </span><span class="hl_comment"><span class="mpre">-- True means mayFirstBeNull is True</span></span><span class="mpre">
             | </span><a name="loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_condecl"><span class="mpre">PBound</span></span></a><span class="mpre">  </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- eliminated by starTrans</span></span><span class="mpre">
             </span><span class="hl_comment"><span class="mpre">-- The rest of these need an index of where in the regex string it is from</span></span><span class="mpre">
             | </span><a name="loc_41_16_41_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_16_41_22&#39;)"><span class="hl_condecl"><span class="mpre">PCarat</span></span></a><span class="mpre">  {</span><a name="loc_41_25_41_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_25_41_32&#39;)"><span class="hl_fielddecl"><span class="mpre">getDoPa</span></span></a><span class="mpre">::</span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="hl_tyconref"><span class="mpre">DoPa</span></span></a><span class="mpre">}
             | </span><a name="loc_42_16_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_16_42_23&#39;)"><span class="hl_condecl"><span class="mpre">PDollar</span></span></a><span class="mpre"> {</span><span class="hl_fielddecl"><span class="mpre">getDoPa</span></span><span class="mpre">::</span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="hl_tyconref"><span class="mpre">DoPa</span></span></a><span class="mpre">}
             </span><span class="hl_comment"><span class="mpre">-- The following test and accept a single character</span></span><span class="mpre">
             | </span><a name="loc_44_16_44_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_16_44_20&#39;)"><span class="hl_condecl"><span class="mpre">PDot</span></span></a><span class="mpre">    {</span><span class="hl_fielddecl"><span class="mpre">getDoPa</span></span><span class="mpre">::</span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="hl_tyconref"><span class="mpre">DoPa</span></span></a><span class="mpre">}            </span><span class="hl_comment"><span class="mpre">-- Any character (newline?) at all</span></span><span class="mpre">
             | </span><a name="loc_45_16_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_16_45_20&#39;)"><span class="hl_condecl"><span class="mpre">PAny</span></span></a><span class="mpre">    {</span><span class="hl_fielddecl"><span class="mpre">getDoPa</span></span><span class="mpre">::</span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="hl_tyconref"><span class="mpre">DoPa</span></span></a><span class="mpre">,</span><a name="loc_45_39_45_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_39_45_52&#39;)"><span class="hl_fielddecl"><span class="mpre">getPatternSet</span></span></a><span class="mpre">::</span><a href="#loc_92_6_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_6_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">PatternSet</span></span></a><span class="mpre">} </span><span class="hl_comment"><span class="mpre">-- Square bracketed things</span></span><span class="mpre">
             | </span><a name="loc_46_16_46_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_16_46_23&#39;)"><span class="hl_condecl"><span class="mpre">PAnyNot</span></span></a><span class="mpre"> {</span><span class="hl_fielddecl"><span class="mpre">getDoPa</span></span><span class="mpre">::</span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="hl_tyconref"><span class="mpre">DoPa</span></span></a><span class="mpre">,</span><span class="hl_fielddecl"><span class="mpre">getPatternSet</span></span><span class="mpre">::</span><a href="#loc_92_6_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_6_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">PatternSet</span></span></a><span class="mpre">} </span><span class="hl_comment"><span class="mpre">-- Inverted square bracketed things</span></span><span class="mpre">
             | </span><a name="loc_47_16_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_16_47_23&#39;)"><span class="hl_condecl"><span class="mpre">PEscape</span></span></a><span class="mpre"> {</span><span class="hl_fielddecl"><span class="mpre">getDoPa</span></span><span class="mpre">::</span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="hl_tyconref"><span class="mpre">DoPa</span></span></a><span class="mpre">,</span><a name="loc_47_39_47_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_39_47_53&#39;)"><span class="hl_fielddecl"><span class="mpre">getPatternChar</span></span></a><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">}      </span><span class="hl_comment"><span class="mpre">-- Backslashed Character</span></span><span class="mpre">
             | </span><a name="loc_48_16_48_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_16_48_21&#39;)"><span class="hl_condecl"><span class="mpre">PChar</span></span></a><span class="mpre">   {</span><span class="hl_fielddecl"><span class="mpre">getDoPa</span></span><span class="mpre">::</span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="hl_tyconref"><span class="mpre">DoPa</span></span></a><span class="mpre">,</span><span class="hl_fielddecl"><span class="mpre">getPatternChar</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">}      </span><span class="hl_comment"><span class="mpre">-- Specific Character</span></span><span class="mpre">
             </span><span class="hl_comment"><span class="mpre">-- The following are semantic tags created in starTrans, not the parser</span></span><span class="mpre">
             | </span><a name="loc_50_16_50_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_16_50_27&#39;)"><span class="hl_condecl"><span class="mpre">PNonCapture</span></span></a><span class="mpre"> </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">               </span><span class="hl_comment"><span class="mpre">-- introduced by starTrans</span></span><span class="mpre">
             | </span><a name="loc_51_16_51_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_16_51_25&#39;)"><span class="hl_condecl"><span class="mpre">PNonEmpty</span></span></a><span class="mpre"> </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">                 </span><span class="hl_comment"><span class="mpre">-- introduced by starTrans</span></span><span class="mpre">
               </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 16, srcSpanEndLine = 52, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 16, srcSpanEndLine = 52, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Patt"><span class="mpre">deriving (Eq,Show)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | I have not been checking, but this should have the property that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- parsing the resulting string should result in an identical Pattern.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is not true if starTrans has created PNonCapture and PNonEmpty</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- values or a (PStar False).  The contents of a &quot;[ ]&quot; grouping are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- always shown in a sorted canonical order.</span></span><span class="mpre">
</span><a href="#loc_60_1_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_12&#39;)"><span class="mpre">showPattern</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_60_1_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_12&#39;)"><span class="hl_fundecl"><span class="mpre">showPattern</span></span></a><span class="mpre"> </span><a name="loc_60_13_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_13_60_16&#39;)"><span class="hl_vardecl"><span class="mpre">pIn</span></span></a><span class="mpre"> =
  case </span><a href="#loc_60_13_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_13_60_16&#39;)"><span class="hl_varref"><span class="mpre">pIn</span></span></a><span class="mpre"> of
    </span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre"> -&gt; </span><span class="hl_string"><span class="mpre">&quot;()&quot;</span></span><span class="mpre">
    </span><a href="#loc_33_16_33_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_16_33_22&#39;)"><span class="hl_conref"><span class="mpre">PGroup</span></span></a><span class="mpre"> _ </span><a name="loc_63_14_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_14_63_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_90_9_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_9_90_14&#39;)"><span class="hl_varref"><span class="mpre">paren</span></span></a><span class="mpre"> (</span><a href="#loc_60_1_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_12&#39;)"><span class="hl_varref"><span class="mpre">showPattern</span></span></a><span class="mpre"> </span><a href="#loc_63_14_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_14_63_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
    </span><a href="#loc_34_16_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_16_34_19&#39;)"><span class="hl_conref"><span class="mpre">POr</span></span></a><span class="mpre"> </span><a name="loc_64_9_64_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_9_64_11&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.List.html#loc_427_1_427_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_427_1_427_12&#39;)"><span class="hl_varref"><span class="mpre">intersperse</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;|&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_60_1_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_12&#39;)"><span class="hl_varref"><span class="mpre">showPattern</span></span></a><span class="mpre"> </span><a href="#loc_64_9_64_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_9_64_11&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">)
    </span><a href="#loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_conref"><span class="mpre">PConcat</span></span></a><span class="mpre"> </span><a name="loc_65_13_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_13_65_15&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_60_1_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_12&#39;)"><span class="hl_varref"><span class="mpre">showPattern</span></span></a><span class="mpre"> </span><a href="#loc_65_13_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_13_65_15&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">
    </span><a href="#loc_36_16_36_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_16_36_22&#39;)"><span class="hl_conref"><span class="mpre">PQuest</span></span></a><span class="mpre"> </span><a name="loc_66_12_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_12_66_13&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_60_1_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_12&#39;)"><span class="hl_varref"><span class="mpre">showPattern</span></span></a><span class="mpre"> </span><a href="#loc_66_12_66_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_12_66_13&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;?&quot;</span></span><span class="mpre">
    </span><a href="#loc_37_16_37_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_16_37_21&#39;)"><span class="hl_conref"><span class="mpre">PPlus</span></span></a><span class="mpre"> </span><a name="loc_67_11_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_11_67_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_60_1_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_12&#39;)"><span class="hl_varref"><span class="mpre">showPattern</span></span></a><span class="mpre"> </span><a href="#loc_67_11_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_11_67_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;+&quot;</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- If PStar has mayFirstBeNull False then reparsing will forget this flag</span></span><span class="mpre">
    </span><a href="#loc_38_16_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_21&#39;)"><span class="hl_conref"><span class="mpre">PStar</span></span></a><span class="mpre"> _ </span><a name="loc_69_13_69_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_13_69_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_60_1_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_12&#39;)"><span class="hl_varref"><span class="mpre">showPattern</span></span></a><span class="mpre"> </span><a href="#loc_69_13_69_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_13_69_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;*&quot;</span></span><span class="mpre">
    </span><a href="#loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_conref"><span class="mpre">PBound</span></span></a><span class="mpre"> </span><a name="loc_70_12_70_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_12_70_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_70_20_70_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_20_70_21&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre">) </span><a name="loc_70_23_70_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_23_70_24&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> | </span><a href="#loc_70_12_70_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_12_70_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><a href="#loc_70_20_70_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_20_70_21&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_60_1_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_12&#39;)"><span class="hl_varref"><span class="mpre">showPattern</span></span></a><span class="mpre"> </span><a href="#loc_70_23_70_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_23_70_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_70_12_70_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_12_70_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;}&quot;</span></span><span class="mpre">
    </span><a href="#loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_conref"><span class="mpre">PBound</span></span></a><span class="mpre"> </span><a name="loc_71_12_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_12_71_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_71_14_71_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_14_71_16&#39;)"><span class="hl_vardecl"><span class="mpre">mj</span></span></a><span class="mpre"> </span><a name="loc_71_17_71_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_17_71_18&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_60_1_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_12&#39;)"><span class="hl_varref"><span class="mpre">showPattern</span></span></a><span class="mpre"> </span><a href="#loc_71_17_71_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_17_71_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_71_12_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_12_71_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;,}&quot;</span></span><span class="mpre"> (\</span><a name="loc_71_68_71_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_68_71_69&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> -&gt; </span><span class="hl_char"><span class="mpre">&#39;,&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_71_68_71_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_68_71_69&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;}&quot;</span></span><span class="mpre">) </span><a href="#loc_71_14_71_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_14_71_16&#39;)"><span class="hl_varref"><span class="mpre">mj</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><a href="#loc_41_16_41_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_16_41_22&#39;)"><span class="hl_conref"><span class="mpre">PCarat</span></span></a><span class="mpre"> _ -&gt; </span><span class="hl_string"><span class="mpre">&quot;^&quot;</span></span><span class="mpre">
    </span><a href="#loc_42_16_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_16_42_23&#39;)"><span class="hl_conref"><span class="mpre">PDollar</span></span></a><span class="mpre"> _ -&gt; </span><span class="hl_string"><span class="mpre">&quot;$&quot;</span></span><span class="mpre">
    </span><a href="#loc_44_16_44_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_16_44_20&#39;)"><span class="hl_conref"><span class="mpre">PDot</span></span></a><span class="mpre"> _ -&gt; </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre">
    </span><a href="#loc_45_16_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_16_45_20&#39;)"><span class="hl_conref"><span class="mpre">PAny</span></span></a><span class="mpre"> _ </span><a name="loc_76_12_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_14&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_char"><span class="mpre">&#39;[&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_76_12_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_14&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;]&quot;</span></span><span class="mpre">
    </span><a href="#loc_46_16_46_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_16_46_23&#39;)"><span class="hl_conref"><span class="mpre">PAnyNot</span></span></a><span class="mpre"> _ </span><a name="loc_77_15_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_15_77_17&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> -&gt;  (</span><span class="hl_char"><span class="mpre">&#39;[&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;^&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_77_15_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_15_77_17&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;]&quot;</span></span><span class="mpre">
    </span><a href="#loc_47_16_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_16_47_23&#39;)"><span class="hl_conref"><span class="mpre">PEscape</span></span></a><span class="mpre"> _ </span><a name="loc_78_15_78_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_15_78_16&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><span class="hl_char"><span class="mpre">&#39;\\&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_78_15_78_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_15_78_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[]
    </span><a href="#loc_48_16_48_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_16_48_21&#39;)"><span class="hl_conref"><span class="mpre">PChar</span></span></a><span class="mpre"> _ </span><a name="loc_79_13_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_79_13_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">]
    </span><span class="hl_comment"><span class="mpre">-- The following were not directly from the parser, and will not be parsed in properly</span></span><span class="mpre">
    </span><a href="#loc_50_16_50_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_16_50_27&#39;)"><span class="hl_conref"><span class="mpre">PNonCapture</span></span></a><span class="mpre"> </span><a name="loc_81_17_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_18&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_60_1_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_12&#39;)"><span class="hl_varref"><span class="mpre">showPattern</span></span></a><span class="mpre"> </span><a href="#loc_81_17_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    </span><a href="#loc_51_16_51_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_16_51_25&#39;)"><span class="hl_conref"><span class="mpre">PNonEmpty</span></span></a><span class="mpre"> </span><a name="loc_82_15_82_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_15_82_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_60_1_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_12&#39;)"><span class="hl_varref"><span class="mpre">showPattern</span></span></a><span class="mpre"> </span><a href="#loc_82_15_82_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_15_82_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
  where </span><span class="hl_comment"><span class="mpre">{-
        groupRange x n (y:ys) = if (fromEnum y)-(fromEnum x) == n then groupRange x (succ n) ys
                                else (if n &lt;=3 then take n [x..]
                                      else x:&#39;-&#39;:(toEnum (pred n+fromEnum x)):[]) ++ groupRange y 1 ys
        groupRange x n [] = if n &lt;=3 then take n [x..]
                            else x:&#39;-&#39;:(toEnum (pred n+fromEnum x)):[]
-}</span></span><span class="mpre">
        </span><a name="loc_90_9_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_9_90_14&#39;)"><span class="hl_fundecl"><span class="mpre">paren</span></span></a><span class="mpre"> </span><a name="loc_90_15_90_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_15_90_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = (</span><span class="hl_char"><span class="mpre">&#39;(&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_90_15_90_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_15_90_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="mpre">
       
data </span><a name="loc_92_6_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_6_92_16&#39;)"><span class="hl_tycondecl"><span class="mpre">PatternSet</span></span></a><span class="mpre"> = </span><a name="loc_92_19_92_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_29&#39;)"><span class="hl_condecl"><span class="mpre">PatternSet</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Set</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">))
                             (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Set</span></span><span class="mpre"> </span><a href="#loc_117_9_117_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_33&#39;)"><span class="hl_tyconref"><span class="mpre">PatternSetCharacterClass</span></span></a><span class="mpre">))
                             (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Set</span></span><span class="mpre"> </span><a href="#loc_119_9_119_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_9_119_35&#39;)"><span class="hl_tyconref"><span class="mpre">PatternSetCollatingElement</span></span></a><span class="mpre">))
                             (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Set</span></span><span class="mpre"> </span><a href="#loc_121_9_121_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_35&#39;)"><span class="hl_tyconref"><span class="mpre">PatternSetEquivalenceClass</span></span></a><span class="mpre">))
                             </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 30, srcSpanEndLine = 96, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 30, srcSpanEndLine = 96, srcSpanEndColumn = 38},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Patt"><span class="mpre">deriving (Eq)</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_92_6_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_6_92_16&#39;)"><span class="hl_tyconref"><span class="mpre">PatternSet</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">showsPrec</span></span><span class="mpre"> </span><a name="loc_99_13_99_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_13_99_14&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="#loc_92_19_92_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_19_92_29&#39;)"><span class="hl_conref"><span class="mpre">PatternSet</span></span></a><span class="mpre"> </span><a name="loc_99_27_99_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_27_99_28&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_99_29_99_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_29_99_32&#39;)"><span class="hl_vardecl"><span class="mpre">scc</span></span></a><span class="mpre"> </span><a name="loc_99_33_99_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_33_99_36&#39;)"><span class="hl_vardecl"><span class="mpre">sce</span></span></a><span class="mpre"> </span><a name="loc_99_37_99_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_37_99_40&#39;)"><span class="hl_vardecl"><span class="mpre">sec</span></span></a><span class="mpre">) =
    let (</span><a name="loc_100_10_100_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_10_100_17&#39;)"><span class="hl_vardecl"><span class="mpre">special</span></span></a><span class="mpre">,</span><a name="loc_100_18_100_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_18_100_24&#39;)"><span class="hl_vardecl"><span class="mpre">normal</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">) ((</span><a href="Data.List.html#loc_464_1_464_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_464_1_464_10&#39;)"><span class="hl_varref"><span class="mpre">partition</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;]-&quot;</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Set.toAscList</span></span><span class="mpre">) </span><a href="#loc_99_27_99_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_27_99_28&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
        </span><a name="loc_101_9_101_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_17&#39;)"><span class="hl_vardecl"><span class="mpre">charSpec</span></span></a><span class="mpre"> = (if </span><span class="hl_char"><span class="mpre">&#39;]&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_100_10_100_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_10_100_17&#39;)"><span class="hl_varref"><span class="mpre">special</span></span></a><span class="mpre"> then (</span><span class="hl_char"><span class="mpre">&#39;]&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) else </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">) (</span><a href="#loc_108_11_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_11_108_18&#39;)"><span class="hl_varref"><span class="mpre">byRange</span></span></a><span class="mpre"> </span><a href="#loc_100_18_100_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_18_100_24&#39;)"><span class="hl_varref"><span class="mpre">normal</span></span></a><span class="mpre">)
        </span><a name="loc_102_9_102_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_13&#39;)"><span class="hl_vardecl"><span class="mpre">scc&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> ((</span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Set.toList</span></span><span class="mpre">) </span><a href="#loc_99_29_99_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_29_99_32&#39;)"><span class="hl_varref"><span class="mpre">scc</span></span></a><span class="mpre">
        </span><a name="loc_103_9_103_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_13&#39;)"><span class="hl_vardecl"><span class="mpre">sce&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> ((</span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Set.toList</span></span><span class="mpre">) </span><a href="#loc_99_33_99_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_33_99_36&#39;)"><span class="hl_varref"><span class="mpre">sce</span></span></a><span class="mpre">
        </span><a name="loc_104_9_104_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_13&#39;)"><span class="hl_vardecl"><span class="mpre">sec&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> ((</span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Set.toList</span></span><span class="mpre">) </span><a href="#loc_99_37_99_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_37_99_40&#39;)"><span class="hl_varref"><span class="mpre">sec</span></span></a><span class="mpre">
    in </span><span class="hl_varref"><span class="mpre">shows</span></span><span class="mpre"> </span><a href="#loc_101_9_101_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_17&#39;)"><span class="hl_varref"><span class="mpre">charSpec</span></span></a><span class="mpre">
       </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showsPrec</span></span><span class="mpre"> </span><a href="#loc_99_13_99_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_13_99_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_102_9_102_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_13&#39;)"><span class="hl_varref"><span class="mpre">scc&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showsPrec</span></span><span class="mpre"> </span><a href="#loc_99_13_99_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_13_99_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_103_9_103_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_13&#39;)"><span class="hl_varref"><span class="mpre">sce&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showsPrec</span></span><span class="mpre"> </span><a href="#loc_99_13_99_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_13_99_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_104_9_104_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_13&#39;)"><span class="hl_varref"><span class="mpre">sec&#39;</span></span></a><span class="mpre">
       </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> if </span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_100_10_100_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_10_100_17&#39;)"><span class="hl_varref"><span class="mpre">special</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
    where </span><a name="loc_108_11_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_11_108_18&#39;)"><span class="hl_fundecl"><span class="mpre">byRange</span></span></a><span class="mpre"> </span><a name="loc_108_19_108_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_19_108_23&#39;)"><span class="hl_specname"><span class="mpre">xAll</span></span></a><span class="mpre">@(</span><a name="loc_108_25_108_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_25_108_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_108_27_108_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_27_108_29&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_108_19_108_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_19_108_23&#39;)"><span class="hl_varref"><span class="mpre">xAll</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> = </span><a href="#loc_108_19_108_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_19_108_23&#39;)"><span class="hl_varref"><span class="mpre">xAll</span></span></a><span class="mpre">
                              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_111_11_111_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_21&#39;)"><span class="hl_varref"><span class="mpre">groupRange</span></span></a><span class="mpre"> </span><a href="#loc_108_25_108_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_25_108_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_108_27_108_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_27_108_29&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
          </span><a href="#loc_108_11_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_11_108_18&#39;)"><span class="hl_fundecl"><span class="mpre">byRange</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
          </span><a name="loc_111_11_111_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_21&#39;)"><span class="hl_fundecl"><span class="mpre">groupRange</span></span></a><span class="mpre"> </span><a name="loc_111_22_111_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_22_111_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_111_24_111_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_24_111_25&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a name="loc_111_27_111_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_27_111_28&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_111_29_111_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_29_111_31&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = if (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_111_27_111_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_27_111_28&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre">(</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_111_22_111_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_22_111_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_111_24_111_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_24_111_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> then </span><a href="#loc_111_11_111_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_21&#39;)"><span class="hl_varref"><span class="mpre">groupRange</span></span></a><span class="mpre"> </span><a href="#loc_111_22_111_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_22_111_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">succ</span></span><span class="mpre"> </span><a href="#loc_111_24_111_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_24_111_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><a href="#loc_111_29_111_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_29_111_31&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
                                  else (if </span><a href="#loc_111_24_111_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_24_111_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_111_24_111_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_24_111_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 112, srcSpanStartColumn = 62, srcSpanEndLine = 112, srcSpanEndColumn = 67}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 112, srcSpanStartColumn = 62, srcSpanEndLine = 112, srcSpanEndColumn = 63},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/"><span class="mpre">[x..]</span></span><span class="mpre">
                                        else </span><a href="#loc_111_22_111_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_22_111_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">pred</span></span><span class="mpre"> </span><a href="#loc_111_24_111_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_24_111_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_111_22_111_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_22_111_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">))</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[]) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_111_11_111_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_21&#39;)"><span class="hl_varref"><span class="mpre">groupRange</span></span></a><span class="mpre"> </span><a href="#loc_111_27_111_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_27_111_28&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_111_29_111_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_29_111_31&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
          </span><a href="#loc_111_11_111_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_21&#39;)"><span class="hl_fundecl"><span class="mpre">groupRange</span></span></a><span class="mpre"> </span><a name="loc_114_22_114_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_22_114_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_114_24_114_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_24_114_25&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> [] = if </span><a href="#loc_114_24_114_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_24_114_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_114_24_114_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_24_114_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 114, srcSpanStartColumn = 52, srcSpanEndLine = 114, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 114, srcSpanStartColumn = 52, srcSpanEndLine = 114, srcSpanEndColumn = 53},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/"><span class="mpre">[x..]</span></span><span class="mpre">
                              else </span><a href="#loc_114_22_114_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_22_114_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">pred</span></span><span class="mpre"> </span><a href="#loc_114_24_114_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_24_114_25&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_114_22_114_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_22_114_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">))</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[]

newtype </span><a name="loc_117_9_117_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_33&#39;)"><span class="hl_tycondecl"><span class="mpre">PatternSetCharacterClass</span></span></a><span class="mpre">   = </span><span class="hl_condecl"><span class="mpre">PatternSetCharacterClass</span></span><span class="mpre">   {</span><a name="loc_117_66_117_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_66_117_71&#39;)"><span class="hl_fielddecl"><span class="mpre">unSCC</span></span></a><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">}
  </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 118, srcSpanStartColumn = 3, srcSpanEndLine = 118, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 118, srcSpanStartColumn = 3, srcSpanEndLine = 118, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pa"><span class="mpre">deriving (Eq,Ord)</span></span><span class="mpre">
newtype </span><a name="loc_119_9_119_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_9_119_35&#39;)"><span class="hl_tycondecl"><span class="mpre">PatternSetCollatingElement</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">PatternSetCollatingElement</span></span><span class="mpre"> {</span><a name="loc_119_66_119_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_66_119_71&#39;)"><span class="hl_fielddecl"><span class="mpre">unSCE</span></span></a><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">}
  </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 3, srcSpanEndLine = 120, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 3, srcSpanEndLine = 120, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pa"><span class="mpre">deriving (Eq,Ord)</span></span><span class="mpre">
newtype </span><a name="loc_121_9_121_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_35&#39;)"><span class="hl_tycondecl"><span class="mpre">PatternSetEquivalenceClass</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">PatternSetEquivalenceClass</span></span><span class="mpre"> {</span><a name="loc_121_66_121_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_66_121_71&#39;)"><span class="hl_fielddecl"><span class="mpre">unSEC</span></span></a><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">}
  </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 3, srcSpanEndLine = 122, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 122, srcSpanStartColumn = 3, srcSpanEndLine = 122, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pa"><span class="mpre">deriving (Eq,Ord)</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_117_9_117_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_33&#39;)"><span class="hl_tyconref"><span class="mpre">PatternSetCharacterClass</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">showsPrec</span></span><span class="mpre"> _ </span><a name="loc_125_15_125_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_15_125_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;[&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">shows</span></span><span class="mpre"> (</span><a href="#loc_117_66_117_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_66_117_71&#39;)"><span class="hl_varref"><span class="mpre">unSCC</span></span></a><span class="mpre"> </span><a href="#loc_125_15_125_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_15_125_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;]&#39;</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_119_9_119_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_9_119_35&#39;)"><span class="hl_tyconref"><span class="mpre">PatternSetCollatingElement</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">showsPrec</span></span><span class="mpre"> _ </span><a name="loc_127_15_127_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_15_127_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;[&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">shows</span></span><span class="mpre"> (</span><a href="#loc_119_66_119_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_66_119_71&#39;)"><span class="hl_varref"><span class="mpre">unSCE</span></span></a><span class="mpre"> </span><a href="#loc_127_15_127_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_15_127_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;]&#39;</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_121_9_121_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_35&#39;)"><span class="hl_tyconref"><span class="mpre">PatternSetEquivalenceClass</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">showsPrec</span></span><span class="mpre"> _ </span><a name="loc_129_15_129_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_15_129_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;[&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">shows</span></span><span class="mpre"> (</span><a href="#loc_121_66_121_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_66_121_71&#39;)"><span class="hl_varref"><span class="mpre">unSEC</span></span></a><span class="mpre"> </span><a href="#loc_129_15_129_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_15_129_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;]&#39;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == </span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Do the transformation and simplification in a single traversal.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This removes the PPlus, PQuest, and PBound values, changing to POr</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and PEmpty and PStar True/False.  For some PBound values it adds</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- PNonEmpty and PNonCapture semantic marker.  It also simplifies to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- flatten out nested POr and PConcat instances and eliminate some</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- unneeded PEmpty values.</span></span><span class="mpre">
</span><a href="#loc_140_1_140_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_10&#39;)"><span class="mpre">starTrans</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">
</span><a name="loc_140_1_140_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_10&#39;)"><span class="hl_vardecl"><span class="mpre">starTrans</span></span></a><span class="mpre"> = </span><a href="#loc_146_1_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_11&#39;)"><span class="hl_varref"><span class="mpre">dfsPattern</span></span></a><span class="mpre"> (</span><a href="#loc_326_1_326_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_10&#39;)"><span class="hl_varref"><span class="mpre">simplify&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">starTrans&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Apply a Pattern transfomation function depth first</span></span><span class="mpre">
</span><a href="#loc_146_1_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_11&#39;)"><span class="mpre">dfsPattern</span></a><span class="mpre"> :: (</span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">)  </span><span class="hl_comment"><span class="mpre">-- ^ The transformation function</span></span><span class="mpre">
           -&gt; </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">               </span><span class="hl_comment"><span class="mpre">-- ^ The Pattern to transform</span></span><span class="mpre">
           -&gt; </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">               </span><span class="hl_comment"><span class="mpre">-- ^ The transformed Pattern</span></span><span class="mpre">
</span><a name="loc_146_1_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_11&#39;)"><span class="hl_fundecl"><span class="mpre">dfsPattern</span></span></a><span class="mpre"> </span><a name="loc_146_12_146_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_12_146_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_148_8_148_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_8_148_11&#39;)"><span class="hl_varref"><span class="mpre">dfs</span></span></a><span class="mpre">
 where </span><a name="loc_147_8_147_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_8_147_13&#39;)"><span class="hl_fundecl"><span class="mpre">unary</span></span></a><span class="mpre"> </span><a name="loc_147_14_147_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_14_147_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_146_12_146_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_12_146_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_147_14_147_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_14_147_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_148_8_148_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_8_148_11&#39;)"><span class="hl_varref"><span class="mpre">dfs</span></span></a><span class="mpre">
       </span><a name="loc_148_8_148_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_8_148_11&#39;)"><span class="hl_fundecl"><span class="mpre">dfs</span></span></a><span class="mpre"> </span><a name="loc_148_12_148_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_12_148_19&#39;)"><span class="hl_vardecl"><span class="mpre">pattern</span></span></a><span class="mpre"> = case </span><a href="#loc_148_12_148_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_12_148_19&#39;)"><span class="hl_varref"><span class="mpre">pattern</span></span></a><span class="mpre"> of
                       </span><a href="#loc_34_16_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_16_34_19&#39;)"><span class="hl_conref"><span class="mpre">POr</span></span></a><span class="mpre"> </span><a name="loc_149_28_149_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_28_149_30&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_146_12_146_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_12_146_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_34_16_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_16_34_19&#39;)"><span class="hl_conref"><span class="mpre">POr</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_148_8_148_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_8_148_11&#39;)"><span class="hl_varref"><span class="mpre">dfs</span></span></a><span class="mpre"> </span><a href="#loc_149_28_149_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_28_149_30&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">))
                       </span><a href="#loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_conref"><span class="mpre">PConcat</span></span></a><span class="mpre"> </span><a name="loc_150_32_150_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_32_150_34&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_146_12_146_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_12_146_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_conref"><span class="mpre">PConcat</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_148_8_148_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_8_148_11&#39;)"><span class="hl_varref"><span class="mpre">dfs</span></span></a><span class="mpre"> </span><a href="#loc_150_32_150_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_32_150_34&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">))
                       </span><a href="#loc_33_16_33_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_16_33_22&#39;)"><span class="hl_conref"><span class="mpre">PGroup</span></span></a><span class="mpre"> </span><a name="loc_151_31_151_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_31_151_32&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_151_33_151_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_33_151_34&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_147_8_147_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_8_147_13&#39;)"><span class="hl_varref"><span class="mpre">unary</span></span></a><span class="mpre"> (</span><a href="#loc_33_16_33_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_16_33_22&#39;)"><span class="hl_conref"><span class="mpre">PGroup</span></span></a><span class="mpre"> </span><a href="#loc_151_31_151_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_31_151_32&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><a href="#loc_151_33_151_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_33_151_34&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                       </span><a href="#loc_36_16_36_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_16_36_22&#39;)"><span class="hl_conref"><span class="mpre">PQuest</span></span></a><span class="mpre"> </span><a name="loc_152_31_152_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_31_152_32&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_147_8_147_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_8_147_13&#39;)"><span class="hl_varref"><span class="mpre">unary</span></span></a><span class="mpre"> </span><a href="#loc_36_16_36_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_16_36_22&#39;)"><span class="hl_conref"><span class="mpre">PQuest</span></span></a><span class="mpre"> </span><a href="#loc_152_31_152_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_31_152_32&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                       </span><a href="#loc_37_16_37_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_16_37_21&#39;)"><span class="hl_conref"><span class="mpre">PPlus</span></span></a><span class="mpre"> </span><a name="loc_153_30_153_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_30_153_31&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_147_8_147_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_8_147_13&#39;)"><span class="hl_varref"><span class="mpre">unary</span></span></a><span class="mpre"> </span><a href="#loc_37_16_37_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_16_37_21&#39;)"><span class="hl_conref"><span class="mpre">PPlus</span></span></a><span class="mpre"> </span><a href="#loc_153_30_153_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_30_153_31&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                       </span><a href="#loc_38_16_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_21&#39;)"><span class="hl_conref"><span class="mpre">PStar</span></span></a><span class="mpre"> </span><a name="loc_154_30_154_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_30_154_31&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_154_32_154_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_32_154_33&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_147_8_147_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_8_147_13&#39;)"><span class="hl_varref"><span class="mpre">unary</span></span></a><span class="mpre"> (</span><a href="#loc_38_16_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_21&#39;)"><span class="hl_conref"><span class="mpre">PStar</span></span></a><span class="mpre"> </span><a href="#loc_154_30_154_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_30_154_31&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><a href="#loc_154_32_154_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_32_154_33&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                       </span><a href="#loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_conref"><span class="mpre">PBound</span></span></a><span class="mpre"> </span><a name="loc_155_31_155_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_31_155_32&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_155_33_155_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_33_155_35&#39;)"><span class="hl_vardecl"><span class="mpre">mi</span></span></a><span class="mpre"> </span><a name="loc_155_36_155_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_36_155_37&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_147_8_147_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_8_147_13&#39;)"><span class="hl_varref"><span class="mpre">unary</span></span></a><span class="mpre"> (</span><a href="#loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_conref"><span class="mpre">PBound</span></span></a><span class="mpre"> </span><a href="#loc_155_31_155_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_31_155_32&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_155_33_155_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_33_155_35&#39;)"><span class="hl_varref"><span class="mpre">mi</span></span></a><span class="mpre">) </span><a href="#loc_155_36_155_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_36_155_37&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                       _ -&gt; </span><a href="#loc_146_12_146_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_12_146_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_148_12_148_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_12_148_19&#39;)"><span class="hl_varref"><span class="mpre">pattern</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- Replace by PNonCapture
unCapture = dfsPattern unCapture&#39; where
  unCapture&#39; (PGroup (Just _) p) = PGroup Nothing p
  unCapture&#39; x = x
-}</span></span><span class="mpre">
</span><a href="#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_8&#39;)"><span class="mpre">reGroup</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">
</span><a name="loc_164_1_164_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_8&#39;)"><span class="hl_fundecl"><span class="mpre">reGroup</span></span></a><span class="mpre"> </span><a name="loc_164_9_164_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_9_164_10&#39;)"><span class="hl_specname"><span class="mpre">p</span></span></a><span class="mpre">@(</span><a href="#loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_conref"><span class="mpre">PConcat</span></span></a><span class="mpre"> </span><a name="loc_164_20_164_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_20_164_22&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) | </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_164_20_164_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_20_164_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_33_16_33_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_16_33_22&#39;)"><span class="hl_conref"><span class="mpre">PGroup</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><a href="#loc_164_9_164_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_9_164_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
</span><a href="#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_8&#39;)"><span class="hl_fundecl"><span class="mpre">reGroup</span></span></a><span class="mpre"> </span><a name="loc_165_9_165_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_9_165_10&#39;)"><span class="hl_specname"><span class="mpre">p</span></span></a><span class="mpre">@(</span><a href="#loc_34_16_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_16_34_19&#39;)"><span class="hl_conref"><span class="mpre">POr</span></span></a><span class="mpre"> </span><a name="loc_165_16_165_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_16_165_18&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)     | </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_165_16_165_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_16_165_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_33_16_33_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_16_33_22&#39;)"><span class="hl_conref"><span class="mpre">PGroup</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><a href="#loc_165_9_165_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_9_165_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
</span><a href="#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_8&#39;)"><span class="hl_fundecl"><span class="mpre">reGroup</span></span></a><span class="mpre"> </span><a name="loc_166_9_166_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_166_9_166_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><a href="#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_11&#39;)"><span class="mpre">starTrans&#39;</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">
</span><a name="loc_169_1_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_11&#39;)"><span class="hl_fundecl"><span class="mpre">starTrans&#39;</span></span></a><span class="mpre"> </span><a name="loc_169_12_169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_12_169_15&#39;)"><span class="hl_vardecl"><span class="mpre">pIn</span></span></a><span class="mpre"> =
  case </span><a href="#loc_169_12_169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_12_169_15&#39;)"><span class="hl_varref"><span class="mpre">pIn</span></span></a><span class="mpre"> of </span><span class="hl_comment"><span class="mpre">-- We know that &quot;p&quot; has been simplified in each of these cases:</span></span><span class="mpre">
    </span><a href="#loc_36_16_36_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_16_36_22&#39;)"><span class="hl_conref"><span class="mpre">PQuest</span></span></a><span class="mpre"> </span><a name="loc_171_12_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_12_171_13&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_34_16_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_16_34_19&#39;)"><span class="hl_conref"><span class="mpre">POr</span></span></a><span class="mpre"> [</span><a href="#loc_171_12_171_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_12_171_13&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">{- The PStar should not capture 0 characters on its first iteration,
   so set its mayFirstBeNull flag to False
 -}</span></span><span class="mpre">
    </span><a href="#loc_37_16_37_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_16_37_21&#39;)"><span class="hl_conref"><span class="mpre">PPlus</span></span></a><span class="mpre"> </span><a name="loc_176_11_176_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_11_176_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> | </span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_varref"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a href="#loc_176_11_176_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_11_176_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_176_11_176_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_11_176_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="#loc_319_5_319_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_5_319_12&#39;)"><span class="hl_varref"><span class="mpre">asGroup</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_conref"><span class="mpre">PConcat</span></span></a><span class="mpre"> [</span><a href="#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_8&#39;)"><span class="hl_varref"><span class="mpre">reGroup</span></span></a><span class="mpre"> </span><a href="#loc_176_11_176_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_11_176_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_38_16_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_21&#39;)"><span class="hl_conref"><span class="mpre">PStar</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_176_11_176_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_11_176_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">{- &quot;An ERE matching a single character repeated by an &#39;*&#39; , &#39;?&#39; , or
   an interval expression shall not match a null expression unless
   this is the only match for the repetition or it is necessary to
   satisfy the exact or minimum number of occurrences for the interval
   expression.&quot;
 -}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{- p? is p|PEmpty which prefers even a 0-character match for p
   p{0,1} is p? is POr [p,PEmpty]
   p{0,2} is (pp?)? NOT p?p?
   p{0,3} is (p(pp?)?)?
   p{1,2} is like pp{0,1} is like pp? but see below
   p{2,5} is ppp{0,3} is pp(p(pp?)?)?

   But this is not always right.  Because if the second use of p in
   p?p? matches 0 characters then the perhaps non 0 character match of
   the first p is overwritten.

   We need a new operation &quot;p!&quot; that means &quot;p?&quot; unless &quot;p&quot; match 0
   characters, in which case skip p as if it failed in &quot;p?&quot;.  Thus
   when p cannot accept 0 characters p! and p? are equivalent.  And
   when p can only match 0 characters p! is PEmpty.  So for
   simplicity, only use ! when p can match 0 characters but not only 0
   characters.

   Call this (PNonEmpty p) in the Pattern type. 
   p! is PNonEmpty p is POr [PEmpty,p]
   IS THIS TRUE?  Use QuickCheck?

   Note that if p cannot match 0 characters then p! is p? and vice versa

   The p{0,1} is still always p? and POr [p,PEmpty]
   Now p{0,2} means p?p! or (pp!)? and p{0,3} means (p(pp!)!)? or p?p!p!
   Equivalently p?p! and p?p!p!
   And p{2,2} is p&#39;p and p{3,3} is p&#39;p&#39;p and p{4} is p&#39;p&#39;p&#39;p
   The p{1,2} is pp! and p{1,3} is pp!p! or p(pp!)!
   And p{2,4} means p&#39;pp!p! and p{3,6} is p&#39;p&#39;pp!p!p! or p&#39;p&#39;p(p(pp!)!)!

   But this second form still has a problem: the (pp!)! can have the first
   p match 0 and the second p match non-zero. This showed up for (.|$){1,3}
   since ($.!)! should not be a valid path but altered the qt_win commands.

   Thus only p&#39;p&#39;pp!p!p! has the right semantics.  For completeness:

   if p can only match only 0 characters then the cases are
   p{0,0} is (), p{0,_} = p?, p{_,_} is p

   if p can match 0 or non-zero characters then cases are
   p{0,0} is (), p{0,1} is (p)?, p{0,2} is (pp!)?, p{0,3} is (pp!p!)?
   p{1,1} is p, p{1,2} is pp!, p{1,3} is pp!p!, p{1,4} is pp!p!p!
   p{2,2} is p&#39;p, 
   p{2,3} is p&#39;pp!, 
   p{2,4} is p&#39;pp!p! or p&#39;p(pp!)!
   p{2,5} is p&#39;pp!p!p! or p&#39;p(p(pp!)!)!
   p{3,3} is p&#39;p&#39;p, p{3,4} is p&#39;p&#39;pp!, p{3,5} is p&#39;p&#39;pp!p!, p{3,6} is p&#39;p&#39;pp!p!p!

   if p can only match 1 or more characters then cases are
   p{0,0} is ()
   p{0,1} is p?, p{0,2} is (pp?)?, p{0,3} is (p(pp?)?)?, p{0,4} is (pp{0,3})?
   p{1,1} is p, p{1,j} is pp{0,pred j}
   p{2,2} is p&#39;p, p{2,3} is p&#39;pp?, p{2,4} is p&#39;p(pp?)?, p{2,5} = p&#39;p{1,4} = p&#39;(pp{0,3})
   p{3,3} is p&#39;p&#39;p, p{3,4} is p&#39;p&#39;pp?, p{3,5} is p&#39;p&#39;p(pp?)?, p{3,6} is 

   And by this logic, the PStar False is really p*!  So p{0,} is p*
   and p{1,} is pp*! and p{2,} is p&#39;pp*! and p{3,} is p&#39;p&#39;pp*!

   The (nonEmpty&#39; p) below is the only way PNonEmpty is introduced
   into the Pattern.  It is always preceded by p inside a PConcat
   list.  The p involved never simplifies to PEmpty.  Thus it is
   impossible to have PNonEmpty directly nested, i.e. (PNonEmpty
   (PNonEmpty _)) never occurs even after simplifications.

   The (nonCapture&#39; p) below is the only way PNonCapture is
   introduced into the Pattern. It is always followed by p inside a
   PConcat list.

-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Easy cases</span></span><span class="mpre">
    </span><a href="#loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_conref"><span class="mpre">PBound</span></span></a><span class="mpre"> </span><a name="loc_256_12_256_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_12_256_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> _        _ | </span><a href="#loc_256_12_256_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_12_256_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> -&gt; </span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- impossibly malformed</span></span><span class="mpre">
    </span><a href="#loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_conref"><span class="mpre">PBound</span></span></a><span class="mpre"> </span><a name="loc_257_12_257_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_12_257_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_257_20_257_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_20_257_21&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre">) _ | </span><a href="#loc_257_12_257_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_12_257_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">&gt;</span></span><a href="#loc_257_20_257_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_20_257_21&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- impossibly malformed</span></span><span class="mpre">
    </span><a href="#loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_conref"><span class="mpre">PBound</span></span></a><span class="mpre"> _ (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) _ -&gt; </span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Medium cases</span></span><span class="mpre">
    </span><a href="#loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_conref"><span class="mpre">PBound</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  </span><a name="loc_260_23_260_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_23_260_24&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> | </span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_varref"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a href="#loc_260_23_260_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_23_260_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_313_5_313_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_5_313_10&#39;)"><span class="hl_varref"><span class="mpre">quest</span></span></a><span class="mpre"> </span><a href="#loc_260_23_260_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_23_260_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="#loc_38_16_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_21&#39;)"><span class="hl_conref"><span class="mpre">PStar</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_260_23_260_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_23_260_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    </span><a href="#loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_conref"><span class="mpre">PBound</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a name="loc_262_23_262_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_23_262_24&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_313_5_313_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_5_313_10&#39;)"><span class="hl_varref"><span class="mpre">quest</span></span></a><span class="mpre"> </span><a href="#loc_262_23_262_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_23_262_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Hard cases</span></span><span class="mpre">
    </span><a href="#loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_conref"><span class="mpre">PBound</span></span></a><span class="mpre"> </span><a name="loc_264_12_264_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_12_264_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  </span><a name="loc_264_23_264_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_23_264_24&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> | </span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_varref"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a href="#loc_264_23_264_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_23_264_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_264_23_264_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_23_264_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="#loc_319_5_319_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_5_319_12&#39;)"><span class="hl_varref"><span class="mpre">asGroup</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_conref"><span class="mpre">PConcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_318_5_318_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_5_318_10&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> (</span><a href="#loc_266_13_266_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_13_266_17&#39;)"><span class="hl_varref"><span class="mpre">nc&#39;p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">pred</span></span><span class="mpre"> </span><a href="#loc_264_12_264_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_12_264_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) [</span><a href="#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_8&#39;)"><span class="hl_varref"><span class="mpre">reGroup</span></span></a><span class="mpre"> </span><a href="#loc_264_23_264_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_23_264_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_38_16_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_21&#39;)"><span class="hl_conref"><span class="mpre">PStar</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_264_23_264_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_23_264_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">]
      where </span><a name="loc_266_13_266_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_13_266_17&#39;)"><span class="hl_vardecl"><span class="mpre">nc&#39;p</span></span></a><span class="mpre"> = </span><a href="#loc_317_5_317_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_5_317_16&#39;)"><span class="hl_varref"><span class="mpre">nonCapture&#39;</span></span></a><span class="mpre"> </span><a href="#loc_264_23_264_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_23_264_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    </span><a href="#loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_conref"><span class="mpre">PBound</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_267_20_267_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_20_267_21&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre">) </span><a name="loc_267_23_267_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_23_267_24&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> | </span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_varref"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a href="#loc_267_23_267_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_23_267_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_313_5_313_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_5_313_10&#39;)"><span class="hl_varref"><span class="mpre">quest</span></span></a><span class="mpre"> </span><a href="#loc_267_23_267_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_23_267_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                        </span><span class="hl_comment"><span class="mpre">-- The first operation is quest NOT nonEmpty. This can be tested with</span></span><span class="mpre">
                        </span><span class="hl_comment"><span class="mpre">-- &quot;a\nb&quot; &quot;((^)?|b){0,3}&quot; and &quot;a\nb&quot; &quot;((^)|b){0,3}&quot;</span></span><span class="mpre">
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="#loc_313_5_313_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_5_313_10&#39;)"><span class="hl_varref"><span class="mpre">quest</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_315_5_315_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_5_315_12&#39;)"><span class="hl_varref"><span class="mpre">concat&#39;</span></span></a><span class="mpre"> </span><a href="#loc_267_23_267_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_23_267_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                        </span><a href="#loc_318_5_318_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_5_318_10&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> (</span><a href="#loc_316_5_316_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_5_316_14&#39;)"><span class="hl_varref"><span class="mpre">nonEmpty&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_315_5_315_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_5_315_12&#39;)"><span class="hl_varref"><span class="mpre">concat&#39;</span></span></a><span class="mpre"> </span><a href="#loc_267_23_267_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_23_267_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)) (</span><a href="#loc_267_20_267_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_20_267_21&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) (</span><a href="#loc_316_5_316_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_5_316_14&#39;)"><span class="hl_varref"><span class="mpre">nonEmpty&#39;</span></span></a><span class="mpre"> </span><a href="#loc_267_23_267_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_23_267_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">{- 0.99.6 remove
| cannotMatchNull p -&gt; apply (quest&#39; . (concat&#39; p)) (pred j) (quest&#39; p)
| otherwise -&gt; POr [ simplify&#39; (PConcat (p : replicate (pred j) (nonEmpty&#39; p))) , PEmpty ]
-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{- 0.99.6 add, 0.99.7 remove
    PBound i (Just j) p | canOnlyMatchNull p -&gt; p
                        | i == j -&gt; PConcat $ apply (p&#39;:) (pred i) [p]
                        | otherwise -&gt; PConcat $ apply (p&#39;:) (pred i)
                                        [p,apply (nonEmpty&#39; . (concat&#39; p)) (j-i-1) (nonEmpty&#39; p) ]
      where p&#39; = nonCapture&#39; p
-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{- 0.99.7 add -}</span></span><span class="mpre">
    </span><a href="#loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_conref"><span class="mpre">PBound</span></span></a><span class="mpre"> </span><a name="loc_284_12_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_12_284_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_284_20_284_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_20_284_21&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre">) </span><a name="loc_284_23_284_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_23_284_24&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> | </span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_varref"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a href="#loc_284_23_284_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_23_284_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_284_23_284_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_23_284_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                        | </span><a href="#loc_284_12_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_12_284_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_284_20_284_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_20_284_21&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_319_5_319_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_5_319_12&#39;)"><span class="hl_varref"><span class="mpre">asGroup</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_conref"><span class="mpre">PConcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_318_5_318_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_5_318_10&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> (</span><a href="#loc_288_13_288_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_13_288_17&#39;)"><span class="hl_varref"><span class="mpre">nc&#39;p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">pred</span></span><span class="mpre"> </span><a href="#loc_284_12_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_12_284_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) [</span><a href="#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_8&#39;)"><span class="hl_varref"><span class="mpre">reGroup</span></span></a><span class="mpre"> </span><a href="#loc_284_23_284_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_23_284_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">]
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="#loc_319_5_319_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_5_319_12&#39;)"><span class="hl_varref"><span class="mpre">asGroup</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_conref"><span class="mpre">PConcat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_318_5_318_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_5_318_10&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> (</span><a href="#loc_288_13_288_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_13_288_17&#39;)"><span class="hl_varref"><span class="mpre">nc&#39;p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">pred</span></span><span class="mpre"> </span><a href="#loc_284_12_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_12_284_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
                                        [</span><a href="#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_8&#39;)"><span class="hl_varref"><span class="mpre">reGroup</span></span></a><span class="mpre"> </span><a href="#loc_284_23_284_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_23_284_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_318_5_318_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_5_318_10&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> (</span><a href="#loc_316_5_316_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_5_316_14&#39;)"><span class="hl_varref"><span class="mpre">nonEmpty&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_315_5_315_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_5_315_12&#39;)"><span class="hl_varref"><span class="mpre">concat&#39;</span></span></a><span class="mpre"> </span><a href="#loc_284_23_284_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_23_284_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)) (</span><a href="#loc_284_20_284_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_20_284_21&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_284_12_284_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_12_284_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_289_13_289_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_13_289_17&#39;)"><span class="hl_varref"><span class="mpre">ne&#39;p</span></span></a><span class="mpre">) ]
      where </span><a name="loc_288_13_288_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_13_288_17&#39;)"><span class="hl_vardecl"><span class="mpre">nc&#39;p</span></span></a><span class="mpre"> = </span><a href="#loc_317_5_317_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_5_317_16&#39;)"><span class="hl_varref"><span class="mpre">nonCapture&#39;</span></span></a><span class="mpre"> </span><a href="#loc_284_23_284_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_23_284_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
            </span><a name="loc_289_13_289_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_13_289_17&#39;)"><span class="hl_vardecl"><span class="mpre">ne&#39;p</span></span></a><span class="mpre"> = </span><a href="#loc_316_5_316_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_5_316_14&#39;)"><span class="hl_varref"><span class="mpre">nonEmpty&#39;</span></span></a><span class="mpre"> </span><a href="#loc_284_23_284_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_23_284_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{- 0.99.6
| cannotMatchNull p -&gt; PConcat $ apply (p&#39;:) (pred i) $ (p:) $
  [apply (quest&#39; . (concat&#39; p)) (pred (j-i)) (quest&#39; p)]
| otherwise -&gt; PConcat $ (replicate (pred i) p&#39;) ++ p : (replicate (j-i) (nonEmpty&#39; p))
-}</span></span><span class="mpre">
    </span><a href="#loc_38_16_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_21&#39;)"><span class="hl_conref"><span class="mpre">PStar</span></span></a><span class="mpre"> </span><a name="loc_295_11_295_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_11_295_25&#39;)"><span class="hl_vardecl"><span class="mpre">mayFirstBeNull</span></span></a><span class="mpre"> </span><a name="loc_295_26_295_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_26_295_27&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> | </span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_varref"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a href="#loc_295_26_295_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_26_295_27&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; if </span><a href="#loc_295_11_295_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_11_295_25&#39;)"><span class="hl_varref"><span class="mpre">mayFirstBeNull</span></span></a><span class="mpre"> then </span><a href="#loc_313_5_313_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_5_313_10&#39;)"><span class="hl_varref"><span class="mpre">quest</span></span></a><span class="mpre"> </span><a href="#loc_295_26_295_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_26_295_27&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                                                                    else </span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre">
                           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><a href="#loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Left intact</span></span><span class="mpre">
    </span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 300, srcSpanStartColumn = 5, srcSpanEndLine = 300, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 300, srcSpanStartColumn = 12, srcSpanEndLine = 300, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Patte"><span class="mpre">PGroup {}</span></span><span class="mpre"> -&gt; </span><a href="#loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 301, srcSpanStartColumn = 5, srcSpanEndLine = 301, srcSpanEndColumn = 11}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 301, srcSpanStartColumn = 9, srcSpanEndLine = 301, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Patter"><span class="mpre">POr {}</span></span><span class="mpre"> -&gt; </span><a href="#loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 302, srcSpanStartColumn = 5, srcSpanEndLine = 302, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 302, srcSpanStartColumn = 13, srcSpanEndLine = 302, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Patte"><span class="mpre">PConcat {}</span></span><span class="mpre"> -&gt; </span><a href="#loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 303, srcSpanStartColumn = 5, srcSpanEndLine = 303, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 303, srcSpanStartColumn = 12, srcSpanEndLine = 303, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Patte"><span class="mpre">PCarat {}</span></span><span class="mpre"> -&gt; </span><a href="#loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 304, srcSpanStartColumn = 5, srcSpanEndLine = 304, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 304, srcSpanStartColumn = 13, srcSpanEndLine = 304, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Patte"><span class="mpre">PDollar {}</span></span><span class="mpre"> -&gt; </span><a href="#loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 305, srcSpanStartColumn = 5, srcSpanEndLine = 305, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 305, srcSpanStartColumn = 10, srcSpanEndLine = 305, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Patte"><span class="mpre">PDot {}</span></span><span class="mpre"> -&gt; </span><a href="#loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 306, srcSpanStartColumn = 5, srcSpanEndLine = 306, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 306, srcSpanStartColumn = 10, srcSpanEndLine = 306, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Patte"><span class="mpre">PAny {}</span></span><span class="mpre"> -&gt; </span><a href="#loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 307, srcSpanStartColumn = 5, srcSpanEndLine = 307, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 307, srcSpanStartColumn = 13, srcSpanEndLine = 307, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Patte"><span class="mpre">PAnyNot {}</span></span><span class="mpre"> -&gt; </span><a href="#loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 308, srcSpanStartColumn = 5, srcSpanEndLine = 308, srcSpanEndColumn = 15}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 308, srcSpanStartColumn = 13, srcSpanEndLine = 308, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Patte"><span class="mpre">PEscape {}</span></span><span class="mpre"> -&gt; </span><a href="#loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 309, srcSpanStartColumn = 5, srcSpanEndLine = 309, srcSpanEndColumn = 13}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 309, srcSpanStartColumn = 11, srcSpanEndLine = 309, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Patte"><span class="mpre">PChar {}</span></span><span class="mpre"> -&gt; </span><a href="#loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 310, srcSpanStartColumn = 5, srcSpanEndLine = 310, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 310, srcSpanStartColumn = 17, srcSpanEndLine = 310, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Patte"><span class="mpre">PNonCapture {}</span></span><span class="mpre"> -&gt; </span><a href="#loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 311, srcSpanStartColumn = 5, srcSpanEndLine = 311, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Pattern.hs&quot;, srcSpanStartLine = 311, srcSpanStartColumn = 15, srcSpanEndLine = 311, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/Patte"><span class="mpre">PNonEmpty {}</span></span><span class="mpre"> -&gt; </span><a href="#loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_varref"><span class="mpre">pass</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- TODO : remove PNonEmpty from program</span></span><span class="mpre">
  where
    </span><a name="loc_313_5_313_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_5_313_10&#39;)"><span class="hl_vardecl"><span class="mpre">quest</span></span></a><span class="mpre"> = (\ </span><a name="loc_313_16_313_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_16_313_17&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_34_16_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_16_34_19&#39;)"><span class="hl_conref"><span class="mpre">POr</span></span></a><span class="mpre"> [</span><a href="#loc_313_16_313_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_16_313_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre">])  </span><span class="hl_comment"><span class="mpre">-- require p to have been simplified</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    quest&#39; = (\ p -&gt; simplify&#39; $ POr [p,PEmpty])  -- require p to have been simplified</span></span><span class="mpre">
    </span><a name="loc_315_5_315_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_5_315_12&#39;)"><span class="hl_fundecl"><span class="mpre">concat&#39;</span></span></a><span class="mpre"> </span><a name="loc_315_13_315_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_14&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_315_15_315_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_15_315_16&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_326_1_326_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_10&#39;)"><span class="hl_varref"><span class="mpre">simplify&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_conref"><span class="mpre">PConcat</span></span></a><span class="mpre"> [</span><a href="#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_8&#39;)"><span class="hl_varref"><span class="mpre">reGroup</span></span></a><span class="mpre"> </span><a href="#loc_315_13_315_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_14&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_8&#39;)"><span class="hl_varref"><span class="mpre">reGroup</span></span></a><span class="mpre"> </span><a href="#loc_315_15_315_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_15_315_16&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">]      </span><span class="hl_comment"><span class="mpre">-- require a and b to have been simplified</span></span><span class="mpre">
    </span><a name="loc_316_5_316_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_5_316_14&#39;)"><span class="hl_vardecl"><span class="mpre">nonEmpty&#39;</span></span></a><span class="mpre"> = (\ </span><a name="loc_316_20_316_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_20_316_21&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_326_1_326_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_10&#39;)"><span class="hl_varref"><span class="mpre">simplify&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_34_16_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_16_34_19&#39;)"><span class="hl_conref"><span class="mpre">POr</span></span></a><span class="mpre"> [</span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre">,</span><a href="#loc_316_20_316_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_20_316_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">]) </span><span class="hl_comment"><span class="mpre">-- 2009-01-19 : this was PNonEmpty</span></span><span class="mpre">
    </span><a name="loc_317_5_317_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_5_317_16&#39;)"><span class="hl_vardecl"><span class="mpre">nonCapture&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_50_16_50_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_16_50_27&#39;)"><span class="hl_conref"><span class="mpre">PNonCapture</span></span></a><span class="mpre">
    </span><a name="loc_318_5_318_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_5_318_10&#39;)"><span class="hl_fundecl"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a name="loc_318_11_318_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_11_318_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_318_13_318_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_13_318_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_318_15_318_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_15_318_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">($)</span></span><span class="mpre"> </span><a href="#loc_318_15_318_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_15_318_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> </span><a href="#loc_318_13_318_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_13_318_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_318_11_318_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_11_318_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- function f applied n times to x : f^n(x)</span></span><span class="mpre">
    </span><a name="loc_319_5_319_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_5_319_12&#39;)"><span class="hl_fundecl"><span class="mpre">asGroup</span></span></a><span class="mpre"> </span><a name="loc_319_13_319_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_13_319_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_33_16_33_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_16_33_22&#39;)"><span class="hl_conref"><span class="mpre">PGroup</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> (</span><a href="#loc_326_1_326_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_10&#39;)"><span class="hl_varref"><span class="mpre">simplify&#39;</span></span></a><span class="mpre"> </span><a href="#loc_319_13_319_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_13_319_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
    </span><a name="loc_320_5_320_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_5_320_9&#39;)"><span class="hl_vardecl"><span class="mpre">pass</span></span></a><span class="mpre"> = </span><a href="#loc_169_12_169_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_12_169_15&#39;)"><span class="hl_varref"><span class="mpre">pIn</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Function to transform a pattern into an equivalent, but less</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- redundant form.  Nested &#39;POr&#39; and &#39;PConcat&#39; are flattened. PEmpty</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is propagated.</span></span><span class="mpre">
</span><a href="#loc_326_1_326_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_10&#39;)"><span class="mpre">simplify&#39;</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">
</span><a name="loc_326_1_326_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_10&#39;)"><span class="hl_fundecl"><span class="mpre">simplify&#39;</span></span></a><span class="mpre"> </span><a name="loc_326_11_326_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_11_326_12&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@(</span><a href="#loc_34_16_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_16_34_19&#39;)"><span class="hl_conref"><span class="mpre">POr</span></span></a><span class="mpre"> _) = 
  let </span><a name="loc_327_7_327_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_7_327_10&#39;)"><span class="hl_vardecl"><span class="mpre">ps&#39;</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> </span><a href="#loc_356_1_356_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_10&#39;)"><span class="hl_varref"><span class="mpre">notPEmpty</span></span></a><span class="mpre"> (</span><a href="#loc_347_1_347_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_1_347_8&#39;)"><span class="hl_varref"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><a href="#loc_326_11_326_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_11_326_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) of
              (</span><a name="loc_328_16_328_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_16_328_24&#39;)"><span class="hl_vardecl"><span class="mpre">notEmpty</span></span></a><span class="mpre">,[]) -&gt; </span><a href="#loc_328_16_328_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_16_328_24&#39;)"><span class="hl_varref"><span class="mpre">notEmpty</span></span></a><span class="mpre">
              (</span><a name="loc_329_16_329_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_16_329_24&#39;)"><span class="hl_vardecl"><span class="mpre">notEmpty</span></span></a><span class="mpre">,_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_329_27_329_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_27_329_31&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_329_16_329_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_16_329_24&#39;)"><span class="hl_varref"><span class="mpre">notEmpty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> (</span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> </span><a href="#loc_356_1_356_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_10&#39;)"><span class="hl_varref"><span class="mpre">notPEmpty</span></span></a><span class="mpre"> </span><a href="#loc_329_27_329_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_27_329_31&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- keep 1st PEmpty only</span></span><span class="mpre">
  in case </span><a href="#loc_327_7_327_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_7_327_10&#39;)"><span class="hl_varref"><span class="mpre">ps&#39;</span></span></a><span class="mpre"> of
       [] -&gt; </span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre">
       [</span><a name="loc_332_9_332_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_9_332_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_332_9_332_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_9_332_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
       _ -&gt; </span><a href="#loc_34_16_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_16_34_19&#39;)"><span class="hl_conref"><span class="mpre">POr</span></span></a><span class="mpre"> </span><a href="#loc_327_7_327_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_7_327_10&#39;)"><span class="hl_varref"><span class="mpre">ps&#39;</span></span></a><span class="mpre">
</span><a href="#loc_326_1_326_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_10&#39;)"><span class="hl_fundecl"><span class="mpre">simplify&#39;</span></span></a><span class="mpre"> </span><a name="loc_334_11_334_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_11_334_12&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@(</span><a href="#loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_conref"><span class="mpre">PConcat</span></span></a><span class="mpre"> _) =
  let </span><a name="loc_335_7_335_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_7_335_10&#39;)"><span class="hl_vardecl"><span class="mpre">ps&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> </span><a href="#loc_356_1_356_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_10&#39;)"><span class="hl_varref"><span class="mpre">notPEmpty</span></span></a><span class="mpre"> (</span><a href="#loc_347_1_347_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_1_347_8&#39;)"><span class="hl_varref"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><a href="#loc_334_11_334_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_11_334_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
  in case </span><a href="#loc_335_7_335_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_7_335_10&#39;)"><span class="hl_varref"><span class="mpre">ps&#39;</span></span></a><span class="mpre"> of
       [] -&gt; </span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre">
       [</span><a name="loc_338_9_338_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_9_338_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_338_9_338_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_9_338_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
       _ -&gt; </span><a href="#loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_conref"><span class="mpre">PConcat</span></span></a><span class="mpre"> </span><a href="#loc_335_7_335_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_7_335_10&#39;)"><span class="hl_varref"><span class="mpre">ps&#39;</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- PConcat ps&#39;</span></span><span class="mpre">
</span><a href="#loc_326_1_326_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_10&#39;)"><span class="hl_fundecl"><span class="mpre">simplify&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_38_16_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_21&#39;)"><span class="hl_conref"><span class="mpre">PStar</span></span></a><span class="mpre"> _ </span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre">) = </span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre">
</span><a href="#loc_326_1_326_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_10&#39;)"><span class="hl_fundecl"><span class="mpre">simplify&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_50_16_50_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_16_50_27&#39;)"><span class="hl_conref"><span class="mpre">PNonCapture</span></span></a><span class="mpre"> </span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre">) = </span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- 2009, perhaps useful</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--simplify&#39; (PNonEmpty PEmpty) = err &quot;simplify&#39; (PNonEmpty PEmpty) = should be Impossible!&quot; -- 2009</span></span><span class="mpre">
</span><a href="#loc_326_1_326_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_10&#39;)"><span class="hl_fundecl"><span class="mpre">simplify&#39;</span></span></a><span class="mpre"> </span><a name="loc_343_11_343_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_11_343_16&#39;)"><span class="hl_vardecl"><span class="mpre">other</span></span></a><span class="mpre"> = </span><a href="#loc_343_11_343_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_11_343_16&#39;)"><span class="hl_varref"><span class="mpre">other</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Function to flatten nested POr or nested PConcat applicataions.</span></span><span class="mpre">
</span><a href="#loc_347_1_347_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_1_347_8&#39;)"><span class="mpre">flatten</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">]
</span><a name="loc_347_1_347_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_1_347_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> (</span><a href="#loc_34_16_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_16_34_19&#39;)"><span class="hl_conref"><span class="mpre">POr</span></span></a><span class="mpre"> </span><a name="loc_347_14_347_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_14_347_16&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">) = (</span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (\</span><a name="loc_347_33_347_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_33_347_34&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_347_33_347_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_33_347_34&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
                                       </span><a href="#loc_34_16_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_16_34_19&#39;)"><span class="hl_conref"><span class="mpre">POr</span></span></a><span class="mpre"> </span><a name="loc_348_44_348_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_44_348_47&#39;)"><span class="hl_vardecl"><span class="mpre">ps&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_348_44_348_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_44_348_47&#39;)"><span class="hl_varref"><span class="mpre">ps&#39;</span></span></a><span class="mpre">
                                       </span><a name="loc_349_40_349_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_40_349_41&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_349_40_349_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_40_349_41&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">]) </span><a href="#loc_347_14_347_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_14_347_16&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">)
</span><a href="#loc_347_1_347_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_1_347_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> (</span><a href="#loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_conref"><span class="mpre">PConcat</span></span></a><span class="mpre"> </span><a name="loc_350_18_350_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_18_350_20&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">) = (</span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (\</span><a name="loc_350_37_350_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_37_350_38&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_350_37_350_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_37_350_38&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
                                           </span><a href="#loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_conref"><span class="mpre">PConcat</span></span></a><span class="mpre"> </span><a name="loc_351_52_351_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_52_351_55&#39;)"><span class="hl_vardecl"><span class="mpre">ps&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_351_52_351_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_52_351_55&#39;)"><span class="hl_varref"><span class="mpre">ps&#39;</span></span></a><span class="mpre">
                                           </span><a name="loc_352_44_352_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_44_352_45&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_352_44_352_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_44_352_45&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">]) </span><a href="#loc_350_18_350_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_18_350_20&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">)
</span><a href="#loc_347_1_347_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_1_347_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> _ = </span><a href="#loc_27_1_27_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_4&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;flatten can only be applied to POr or PConcat&quot;</span></span><span class="mpre">

</span><a href="#loc_356_1_356_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_10&#39;)"><span class="mpre">notPEmpty</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_356_1_356_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_10&#39;)"><span class="hl_fundecl"><span class="mpre">notPEmpty</span></span></a><span class="mpre"> </span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_356_1_356_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_10&#39;)"><span class="hl_fundecl"><span class="mpre">notPEmpty</span></span></a><span class="mpre"> _      = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Determines if pIn will fail or accept [] and never accept any</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- characters. Treat PCarat and PDollar as True.</span></span><span class="mpre">
</span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="mpre">canOnlyMatchNull</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_fundecl"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a name="loc_362_18_362_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_18_362_21&#39;)"><span class="hl_vardecl"><span class="mpre">pIn</span></span></a><span class="mpre"> =
  case </span><a href="#loc_362_18_362_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_18_362_21&#39;)"><span class="hl_varref"><span class="mpre">pIn</span></span></a><span class="mpre"> of
    </span><a href="#loc_32_16_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_16_32_22&#39;)"><span class="hl_conref"><span class="mpre">PEmpty</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_33_16_33_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_16_33_22&#39;)"><span class="hl_conref"><span class="mpre">PGroup</span></span></a><span class="mpre"> _ </span><a name="loc_365_14_365_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_14_365_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_varref"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a href="#loc_365_14_365_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_14_365_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    </span><a href="#loc_34_16_34_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_16_34_19&#39;)"><span class="hl_conref"><span class="mpre">POr</span></span></a><span class="mpre"> </span><a name="loc_366_9_366_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_9_366_11&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_varref"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a href="#loc_366_9_366_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_9_366_11&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">
    </span><a href="#loc_35_16_35_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_16_35_23&#39;)"><span class="hl_conref"><span class="mpre">PConcat</span></span></a><span class="mpre"> </span><a name="loc_367_13_367_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_13_367_15&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_varref"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a href="#loc_367_13_367_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_13_367_15&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">
    </span><a href="#loc_36_16_36_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_16_36_22&#39;)"><span class="hl_conref"><span class="mpre">PQuest</span></span></a><span class="mpre"> </span><a name="loc_368_12_368_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_12_368_13&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_varref"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a href="#loc_368_12_368_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_12_368_13&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    </span><a href="#loc_37_16_37_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_16_37_21&#39;)"><span class="hl_conref"><span class="mpre">PPlus</span></span></a><span class="mpre"> </span><a name="loc_369_11_369_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_11_369_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_varref"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a href="#loc_369_11_369_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_11_369_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    </span><a href="#loc_38_16_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_21&#39;)"><span class="hl_conref"><span class="mpre">PStar</span></span></a><span class="mpre"> _ </span><a name="loc_370_13_370_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_13_370_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_varref"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a href="#loc_370_13_370_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_13_370_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    </span><a href="#loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_conref"><span class="mpre">PBound</span></span></a><span class="mpre"> _ (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) _ -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_39_16_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_22&#39;)"><span class="hl_conref"><span class="mpre">PBound</span></span></a><span class="mpre"> _ _ </span><a name="loc_372_16_372_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_16_372_17&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_varref"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a href="#loc_372_16_372_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_16_372_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    </span><a href="#loc_41_16_41_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_16_41_22&#39;)"><span class="hl_conref"><span class="mpre">PCarat</span></span></a><span class="mpre"> _ -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_42_16_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_16_42_23&#39;)"><span class="hl_conref"><span class="mpre">PDollar</span></span></a><span class="mpre"> _ -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_50_16_50_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_16_50_27&#39;)"><span class="hl_conref"><span class="mpre">PNonCapture</span></span></a><span class="mpre"> </span><a name="loc_375_17_375_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_17_375_18&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_362_1_362_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_17&#39;)"><span class="hl_varref"><span class="mpre">canOnlyMatchNull</span></span></a><span class="mpre"> </span><a href="#loc_375_17_375_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_17_375_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    PNonEmpty p -&gt; canOnlyMatchNull p -- like PQuest</span></span><span class="mpre">
    _ -&gt;</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-

-- | If &#39;cannotMatchNull&#39; returns &#39;True&#39; then it is known that the
-- &#39;Pattern&#39; will never accept an empty string.  If &#39;cannotMatchNull&#39;
-- returns &#39;False&#39; then it is possible but not definite that the
-- &#39;Pattern&#39; could accept an empty string.
cannotMatchNull :: Pattern -&gt; Bool
cannotMatchNull pIn =
  case pIn of
    PEmpty -&gt; False
    PGroup _ p -&gt; cannotMatchNull p
    POr [] -&gt; False
    POr ps -&gt; all cannotMatchNull ps
    PConcat [] -&gt; False
    PConcat ps -&gt; any cannotMatchNull ps
    PQuest _ -&gt; False
    PPlus p -&gt; cannotMatchNull p
    PStar {} -&gt; False
    PBound 0 _ _ -&gt; False
    PBound _ _ p -&gt; cannotMatchNull p
    PCarat _ -&gt; False
    PDollar _ -&gt; False
    PNonCapture p -&gt; cannotMatchNull p
--    PNonEmpty _ -&gt; False -- like PQuest
    _ -&gt; True
-}</span></span><span class="mpre">
</span></div></body></html>