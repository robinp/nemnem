<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE RecordWildCards #-}
module System.Console.CmdArgs.Explicit.ExpandArgsAt(expandArgsAt) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cmdargs-0.10.7/System/Console/CmdArgs/Explicit/ExpandArgsAt.hs&quot;, srcSpanStartLine = 4, srcSpanStartColumn = 8, srcSpanEndLine = 4, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;System.FilePath&quot;"><span class="mpre">System.FilePath</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Expand @\@@ directives in a list of arguments, usually obtained from &#39;getArgs&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   As an example, given the file @test.txt@ with the lines @hello@ and @world@:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; expandArgsAt [&quot;@test.txt&quot;,&quot;!&quot;] == [&quot;hello&quot;,&quot;world&quot;,&quot;!&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Any @\@@ directives in the files will be recursively expanded (raising an error</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   if there is infinite recursion).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   To supress @\@@ expansion, pass any @\@@ arguments after @--@.</span></span><span class="mpre">
</span><a href="#loc_17_1_17_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_13&#39;)"><span class="mpre">expandArgsAt</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
</span><a name="loc_17_1_17_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_13&#39;)"><span class="hl_fundecl"><span class="mpre">expandArgsAt</span></span></a><span class="mpre"> </span><a name="loc_17_14_17_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_14_17_18&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> = do
        </span><a name="loc_18_9_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_16&#39;)"><span class="hl_vardecl"><span class="mpre">ebefore</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> (</span><a href="#loc_23_9_23_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_9_23_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> [] </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre">) </span><a href="#loc_21_10_21_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_10_21_16&#39;)"><span class="hl_varref"><span class="mpre">before</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_18_9_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_9_18_16&#39;)"><span class="hl_varref"><span class="mpre">ebefore</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_21_17_21_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_17_21_22&#39;)"><span class="hl_varref"><span class="mpre">after</span></span></a><span class="mpre">
    where
        (</span><a name="loc_21_10_21_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_10_21_16&#39;)"><span class="hl_vardecl"><span class="mpre">before</span></span></a><span class="mpre">,</span><a name="loc_21_17_21_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_17_21_22&#39;)"><span class="hl_vardecl"><span class="mpre">after</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="mpre">) </span><a href="#loc_17_14_17_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_14_17_18&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">

        </span><a name="loc_23_9_23_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_9_23_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_23_11_23_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_15&#39;)"><span class="hl_vardecl"><span class="mpre">seen</span></span></a><span class="mpre"> </span><a name="loc_23_16_23_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_16_23_19&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;@&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_23_25_23_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_25_23_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)
            | </span><a href="#loc_23_25_23_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_25_23_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_23_11_23_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_15&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unlines</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                </span><span class="hl_string"><span class="mpre">&quot;System.Console.CmdArgs.Explicit.expandArgsAt, recursion in @ directives:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;  &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_23_25_23_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_25_23_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_23_11_23_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_15&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre">)
            | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_23_11_23_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_15&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unlines</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                </span><span class="hl_string"><span class="mpre">&quot;System.Console.CmdArgs.Explicit.expandArgsAt, over 15 @ directives deep:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;  &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_23_11_23_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_15&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre">)
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
                </span><a name="loc_31_17_31_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_17_31_20&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">readFile</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_23_16_23_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_16_23_19&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_23_25_23_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_25_23_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> (</span><a href="#loc_23_9_23_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_9_23_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_23_25_23_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_25_23_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_23_11_23_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_15&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">takeDirectory</span></span><span class="mpre"> </span><a href="#loc_23_25_23_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_25_23_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">lines</span></span><span class="mpre"> </span><a href="#loc_31_17_31_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_17_31_20&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
        </span><a href="#loc_23_9_23_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_9_23_10&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> _ _ </span><a name="loc_33_15_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_15_33_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_33_15_33_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_15_33_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]
</span></div></body></html>