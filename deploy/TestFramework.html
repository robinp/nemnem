<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) 2011 Duncan Coutts</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- test-framework stub API</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Currently we cannot use the nice test-framework package for this testsuite</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- since test-framework indirectly depends on bytestring and this makes cabal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- think we&#39;ve got a circular dependency.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- On the other hand, it&#39;s very nice to have the testsuite run automatically</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- rather than being a totally separate package (which would fix).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- So until we can fix that we implement our own trivial layer.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module TestFramework where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 8, srcSpanEndLine = 17, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Test.QuickCheck&quot;"><span class="mpre">Test.QuickCheck</span></span><span class="mpre"> (Testable(..))
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 8, srcSpanEndLine = 18, srcSpanEndColumn = 28}, srcInfoPoints = []}) &quot;Test.QuickCheck.Test&quot;"><span class="mpre">Test.QuickCheck.Test</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 8, srcSpanEndLine = 20, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;Text.Printf&quot;"><span class="mpre">Text.Printf</span></span><span class="mpre">
import System.Environment
import Control.Monad
import Control.Exception

</span><span class="hl_comment"><span class="mpre">-- Ideally we&#39;d be using:</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--import Test.Framework</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--import Test.Framework.Providers.QuickCheck2</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 1, srcSpanEndLine = 30, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 1, srcSpanEndLine = 30, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs"><span class="mpre">type TestName = String</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 1, srcSpanEndLine = 31, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 1, srcSpanEndLine = 31, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs"><span class="mpre">type Test     = [(TestName, Int -&gt; IO (Bool, Int))]</span></span><span class="mpre">

</span><a href="#loc_34_1_34_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_10&#39;)"><span class="mpre">testGroup</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_34_1_34_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_10&#39;)"><span class="hl_fundecl"><span class="mpre">testGroup</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre">

</span><a href="#loc_37_1_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_13&#39;)"><span class="mpre">testProperty</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 17, srcSpanEndLine = 36, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 28, srcSpanEndLine = 36, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/"><span class="mpre">Testable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_37_1_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_13&#39;)"><span class="hl_fundecl"><span class="mpre">testProperty</span></span></a><span class="mpre"> </span><a name="loc_37_14_37_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_14_37_18&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_37_19_37_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_19_37_20&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = [(</span><a href="#loc_37_14_37_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_14_37_18&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">, </span><a href="#loc_39_5_39_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_14&#39;)"><span class="hl_varref"><span class="mpre">runQcTest</span></span></a><span class="mpre">)]
  where
    </span><a name="loc_39_5_39_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_14&#39;)"><span class="hl_fundecl"><span class="mpre">runQcTest</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">n</span></span><span class="mpre"> = do
        </span><a name="loc_40_9_40_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_15&#39;)"><span class="hl_vardecl"><span class="mpre">result</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">quickCheckWithResult</span></span><span class="mpre"> </span><a href="#loc_45_9_45_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_17&#39;)"><span class="hl_varref"><span class="mpre">testArgs</span></span></a><span class="mpre"> </span><a href="#loc_37_19_37_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_19_37_20&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
        case </span><a href="#loc_40_9_40_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_15&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre"> of
          </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 11, srcSpanEndLine = 42, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 19, srcSpanEndLine = 42, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs&quot;"><span class="mpre">Success {}</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,  </span><span class="hl_varref"><span class="mpre">numTests</span></span><span class="mpre"> </span><a href="#loc_40_9_40_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_15&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre">)
          _          -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">numTests</span></span><span class="mpre"> </span><a href="#loc_40_9_40_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_9_40_15&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre">)
      where
        </span><a name="loc_45_9_45_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_17&#39;)"><span class="hl_vardecl"><span class="mpre">testArgs</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 20, srcSpanEndLine = 48, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramework.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 28, srcSpanEndLine = 45, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/tests/TestFramewor"><span class="mpre">stdArgs {
                     maxSuccess = n
                     </span><span class="hl_comment"><span class="mpre">--chatty   = ... if we want to increase verbosity</span></span><span class="mpre">
                   }</span></span><span class="mpre">

</span><a href="#loc_51_1_51_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_11&#39;)"><span class="mpre">assertBool</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_51_1_51_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_11&#39;)"><span class="hl_fundecl"><span class="mpre">assertBool</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">

</span><a href="#loc_54_1_54_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_9&#39;)"><span class="mpre">testCase</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_54_1_54_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_9&#39;)"><span class="hl_fundecl"><span class="mpre">testCase</span></span></a><span class="mpre"> </span><a name="loc_54_10_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_10_54_14&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_vardecl"><span class="mpre">tst</span></span></a><span class="mpre"> = [(</span><a href="#loc_54_10_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_10_54_14&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">, </span><a href="#loc_56_5_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_5_56_17&#39;)"><span class="hl_varref"><span class="mpre">runPlainTest</span></span></a><span class="mpre">)]
  where
    </span><a name="loc_56_5_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_5_56_17&#39;)"><span class="hl_fundecl"><span class="mpre">runPlainTest</span></span></a><span class="mpre"> _ = do
      </span><a name="loc_57_7_57_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_8&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.html#loc_480_1_480_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_480_1_480_9&#39;)"><span class="hl_varref"><span class="mpre">evaluate</span></span></a><span class="mpre"> </span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_varref"><span class="mpre">tst</span></span></a><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;+++ OK, passed test.&quot;</span></span><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_57_7_57_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_8&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

</span><a href="#loc_62_1_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_12&#39;)"><span class="mpre">defaultMain</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_62_1_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_12&#39;)"><span class="hl_vardecl"><span class="mpre">defaultMain</span></span></a><span class="mpre"> = </span><a href="#loc_65_1_65_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_9&#39;)"><span class="hl_varref"><span class="mpre">runTests</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre">

</span><a href="#loc_65_1_65_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_9&#39;)"><span class="mpre">runTests</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">))] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_65_1_65_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_9&#39;)"><span class="hl_fundecl"><span class="mpre">runTests</span></span></a><span class="mpre"> </span><a name="loc_65_10_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_10_65_15&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = do
    </span><a name="loc_66_5_66_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_6&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">getArgs</span></span><span class="mpre">
    let </span><a name="loc_67_9_67_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_66_5_66_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">read</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_66_5_66_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    (</span><a name="loc_68_6_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_6_68_13&#39;)"><span class="hl_vardecl"><span class="mpre">results</span></span></a><span class="mpre">, </span><a name="loc_68_15_68_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_15_68_21&#39;)"><span class="hl_vardecl"><span class="mpre">passed</span></span></a><span class="mpre">) &lt;- </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unzip</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_111_1_111_5&#39;)"><span class="hl_varref"><span class="mpre">mapM</span></span></a><span class="mpre"> (\(</span><a name="loc_68_48_68_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_48_68_49&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">,</span><a name="loc_68_50_68_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_50_68_51&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">printf</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;%-40s: &quot;</span></span><span class="mpre"> </span><a href="#loc_68_48_68_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_48_68_49&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_68_50_68_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_50_68_51&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_67_9_67_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><a href="#loc_65_10_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_10_65_15&#39;)"><span class="hl_varref"><span class="mpre">tests</span></span></a><span class="mpre">
    _ &lt;- </span><span class="hl_varref"><span class="mpre">printf</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Passed %d tests!\n&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">sum</span></span><span class="mpre"> </span><a href="#loc_68_15_68_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_15_68_21&#39;)"><span class="hl_varref"><span class="mpre">passed</span></span></a><span class="mpre">)
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">and</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_68_6_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_6_68_13&#39;)"><span class="hl_varref"><span class="mpre">results</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Not all tests passed!&quot;</span></span><span class="mpre">
</span></div></body></html>