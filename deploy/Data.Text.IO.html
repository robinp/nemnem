<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns, CPP, RecordWildCards, ScopedTypeVariables #-}
#if __GLASGOW_HASKELL__ &gt;= 702
{-# LANGUAGE Trustworthy #-}
#endif
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.Text.IO</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) 2009, 2010 Bryan O&#39;Sullivan,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               (c) 2009 Simon Marlow</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : bos@serpentine.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : GHC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Efficient locale-sensitive support for text I\/O.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Skip past the synopsis for some important notes on performance and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- portability across different versions of GHC.</span></span><span class="mpre">

module Data.Text.IO
    (
    </span><span class="hl_comment"><span class="mpre">-- * Performance</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- $performance</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- * Locale support</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- $locale</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- * File-at-a-time operations</span></span><span class="mpre">
      readFile
    , writeFile
    , appendFile
    </span><span class="hl_comment"><span class="mpre">-- * Operations on handles</span></span><span class="mpre">
    , hGetContents
    , hGetChunk
    , hGetLine
    , hPutStr
    , hPutStrLn
    </span><span class="hl_comment"><span class="mpre">-- * Special cases for standard input and output</span></span><span class="mpre">
    , interact
    , getContents
    , getLine
    , putStr
    , putStrLn
    ) where

import Data.Text (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="mpre">Text</span></a><span class="mpre">)
import Prelude hiding (appendFile, getContents, getLine, interact,
                       putStr, putStrLn, readFile, writeFile)
import System.IO (</span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="mpre">Handle</span></a><span class="mpre">, </span><a href="GHC.IO.IOMode.html#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_6_28_12&#39;)"><span class="mpre">IOMode</span></a><span class="mpre">(..), </span><a href="GHC.IO.Handle.Text.html#loc_468_1_468_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_468_1_468_9&#39;)"><span class="mpre">hPutChar</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.FD.html#loc_150_1_150_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_150_1_150_9&#39;)"><span class="mpre">openFile</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.FD.html#loc_52_1_52_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_52_1_52_6&#39;)"><span class="mpre">stdin</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="mpre">stdout</span></a><span class="mpre">,
                  </span><a href="System.IO.html#loc_390_1_390_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_390_1_390_9&#39;)"><span class="mpre">withFile</span></a><span class="mpre">)
import qualified Control.Exception as E
import Control.Monad (</span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="mpre">liftM2</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">)
import Data.IORef (</span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="mpre">readIORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="mpre">writeIORef</span></a><span class="mpre">)
import qualified Data.Text as T
import Data.Text.Internal.Fusion (</span><a href="Data.Text.Internal.Fusion.html#loc_71_1_71_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.html#loc_71_1_71_7&#39;)"><span class="mpre">stream</span></a><span class="mpre">)
import Data.Text.Internal.Fusion.Types (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_59_6_59_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_59_6_59_10&#39;)"><span class="mpre">Step</span></a><span class="mpre">(..), </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="mpre">Stream</span></a><span class="mpre">(..))
import Data.Text.Internal.IO (</span><a href="Data.Text.Internal.IO.html#loc_44_1_44_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.IO.html#loc_44_1_44_13&#39;)"><span class="mpre">hGetLineWith</span></a><span class="mpre">, </span><a href="Data.Text.Internal.IO.html#loc_156_1_156_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.IO.html#loc_156_1_156_10&#39;)"><span class="mpre">readChunk</span></a><span class="mpre">)
import GHC.IO.Buffer (</span><a href="GHC.IO.Buffer.html#loc_180_6_180_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_180_6_180_12&#39;)"><span class="mpre">Buffer</span></a><span class="mpre">(..), </span><a href="GHC.IO.Buffer.html#loc_195_6_195_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_195_6_195_17&#39;)"><span class="mpre">BufferState</span></a><span class="mpre">(..), CharBufElem, CharBuffer,
                      RawCharBuffer, </span><a href="GHC.IO.Buffer.html#loc_240_1_240_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_240_1_240_12&#39;)"><span class="mpre">emptyBuffer</span></a><span class="mpre">, </span><a href="GHC.IO.Buffer.html#loc_204_1_204_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_204_1_204_14&#39;)"><span class="mpre">isEmptyBuffer</span></a><span class="mpre">, </span><a href="GHC.IO.Buffer.html#loc_247_1_247_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_247_1_247_14&#39;)"><span class="mpre">newCharBuffer</span></a><span class="mpre">,
                      </span><a href="GHC.IO.Buffer.html#loc_123_1_123_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_123_1_123_13&#39;)"><span class="mpre">writeCharBuf</span></a><span class="mpre">)
import GHC.IO.Exception (</span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="mpre">IOException</span></a><span class="mpre">(</span><a href="GHC.IO.Exception.html#loc_242_6_242_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_242_6_242_14&#39;)"><span class="mpre">ioe_type</span></a><span class="mpre">), </span><a href="GHC.IO.Exception.html#loc_257_6_257_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_257_6_257_17&#39;)"><span class="mpre">IOErrorType</span></a><span class="mpre">(</span><a href="GHC.IO.Exception.html#loc_273_5_273_22" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_273_5_273_22&#39;)"><span class="mpre">InappropriateType</span></a><span class="mpre">))
import GHC.IO.Handle.Internals (</span><a href="GHC.IO.Handle.Internals.html#loc_213_1_213_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_213_1_213_15&#39;)"><span class="mpre">augmentIOError</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.Internals.html#loc_732_1_732_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_732_1_732_12&#39;)"><span class="mpre">hClose_help</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.Internals.html#loc_261_1_261_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_261_1_261_19&#39;)"><span class="mpre">wantReadableHandle</span></a><span class="mpre">,
                                </span><a href="GHC.IO.Handle.Internals.html#loc_225_1_225_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_225_1_225_19&#39;)"><span class="mpre">wantWritableHandle</span></a><span class="mpre">)
import GHC.IO.Handle.Text (</span><a href="GHC.IO.Handle.Text.html#loc_650_1_650_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_650_1_650_14&#39;)"><span class="mpre">commitBuffer&#39;</span></a><span class="mpre">)
import GHC.IO.Handle.Types (</span><a href="GHC.IO.Handle.Types.html#loc_147_6_147_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_147_6_147_16&#39;)"><span class="mpre">BufferList</span></a><span class="mpre">(..), </span><a href="GHC.IO.Handle.Types.html#loc_246_6_246_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_246_6_246_16&#39;)"><span class="mpre">BufferMode</span></a><span class="mpre">(..), </span><a href="GHC.IO.Handle.Types.html#loc_124_6_124_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_124_6_124_14&#39;)"><span class="mpre">Handle__</span></a><span class="mpre">(..),
                            </span><a href="GHC.IO.Handle.Types.html#loc_154_6_154_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_154_6_154_16&#39;)"><span class="mpre">HandleType</span></a><span class="mpre">(..), </span><a href="GHC.IO.Handle.Types.html#loc_354_6_354_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_354_6_354_13&#39;)"><span class="mpre">Newline</span></a><span class="mpre">(..))
import System.IO (</span><a href="GHC.IO.Handle.html#loc_493_1_493_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_493_1_493_14&#39;)"><span class="mpre">hGetBuffering</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.html#loc_113_1_113_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_113_1_113_10&#39;)"><span class="mpre">hFileSize</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.html#loc_204_1_204_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_204_1_204_14&#39;)"><span class="mpre">hSetBuffering</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.html#loc_417_1_417_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_417_1_417_6&#39;)"><span class="mpre">hTell</span></a><span class="mpre">)
import System.IO.Error (</span><a href="System.IO.Error.html#loc_152_1_152_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_152_1_152_11&#39;)"><span class="mpre">isEOFError</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- $performance</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- #performance#</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The functions in this module obey the runtime system&#39;s locale,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- character set encoding, and line ending conversion settings.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If you know in advance that you will be working with data that has</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a specific encoding (e.g. UTF-8), and your application is highly</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- performance sensitive, you may find that it is faster to perform</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- I\/O with bytestrings and to encode and decode yourself than to use</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the functions in this module.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Whether this will hold depends on the version of GHC you are using,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the platform you are working on, the data you are working with, and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the encodings you are using, so be sure to test for yourself.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The &#39;readFile&#39; function reads a file and returns the contents of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the file as a string.  The entire file is read strictly, as with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;getContents&#39;.</span></span><span class="mpre">
</span><a href="#loc_88_1_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_9&#39;)"><span class="mpre">readFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_88_1_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_9&#39;)"><span class="hl_fundecl"><span class="mpre">readFile</span></span></a><span class="mpre"> </span><a name="loc_88_10_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_10_88_14&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> = </span><a href="GHC.IO.Handle.FD.html#loc_150_1_150_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_150_1_150_9&#39;)"><span class="hl_varref"><span class="mpre">openFile</span></span></a><span class="mpre"> </span><a href="#loc_88_10_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_10_88_14&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ReadMode</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_135_1_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_13&#39;)"><span class="hl_varref"><span class="mpre">hGetContents</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a string to a file.  The file is truncated to zero length</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- before writing begins.</span></span><span class="mpre">
</span><a href="#loc_93_1_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_10&#39;)"><span class="mpre">writeFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_93_1_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_10&#39;)"><span class="hl_fundecl"><span class="mpre">writeFile</span></span></a><span class="mpre"> </span><a name="loc_93_11_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_11_93_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="System.IO.html#loc_390_1_390_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_390_1_390_9&#39;)"><span class="hl_varref"><span class="mpre">withFile</span></span></a><span class="mpre"> </span><a href="#loc_93_11_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_11_93_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">WriteMode</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="#loc_174_1_174_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_8&#39;)"><span class="hl_varref"><span class="mpre">hPutStr</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a string the end of a file.</span></span><span class="mpre">
</span><a href="#loc_97_1_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_11&#39;)"><span class="mpre">appendFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_97_1_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_11&#39;)"><span class="hl_fundecl"><span class="mpre">appendFile</span></span></a><span class="mpre"> </span><a name="loc_97_12_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_12_97_13&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="System.IO.html#loc_390_1_390_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_390_1_390_9&#39;)"><span class="hl_varref"><span class="mpre">withFile</span></span></a><span class="mpre"> </span><a href="#loc_97_12_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_12_97_13&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">AppendMode</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="#loc_174_1_174_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_8&#39;)"><span class="hl_varref"><span class="mpre">hPutStr</span></span></a><span class="mpre">

</span><a href="#loc_100_1_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_11&#39;)"><span class="mpre">catchError</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Handle.Types.html#loc_124_6_124_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_124_6_124_14&#39;)"><span class="hl_tyconref"><span class="mpre">Handle__</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IOError</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_100_1_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_11&#39;)"><span class="hl_fundecl"><span class="mpre">catchError</span></span></a><span class="mpre"> </span><a name="loc_100_12_100_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_12_100_18&#39;)"><span class="hl_vardecl"><span class="mpre">caller</span></span></a><span class="mpre"> </span><a name="loc_100_19_100_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_19_100_20&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 100, srcSpanStartColumn = 21, srcSpanEndLine = 100, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 100, srcSpanStartColumn = 29, srcSpanEndLine = 100, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 100, srcSpanStart"><span class="mpre">Handle__{..}</span></span><span class="mpre"> </span><a name="loc_100_34_100_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_34_100_37&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">
    | </span><a href="System.IO.Error.html#loc_152_1_152_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_152_1_152_11&#39;)"><span class="hl_varref"><span class="mpre">isEOFError</span></span></a><span class="mpre"> </span><a href="#loc_100_34_100_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_34_100_37&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre"> = do
        </span><a name="loc_102_9_102_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_12&#39;)"><span class="hl_vardecl"><span class="mpre">buf</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_132_7_132_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_132_7_132_19&#39;)"><span class="hl_varref"><span class="mpre">haCharBuffer</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> if </span><a href="GHC.IO.Buffer.html#loc_204_1_204_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_204_1_204_14&#39;)"><span class="hl_varref"><span class="mpre">isEmptyBuffer</span></span></a><span class="mpre"> </span><a href="#loc_102_9_102_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_12&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre">
                 then </span><a href="Data.Text.Internal.html#loc_72_1_72_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_72_1_72_6&#39;)"><span class="hl_varref"><span class="mpre">T.empty</span></span></a><span class="mpre">
                 else </span><a href="Data.Text.html#loc_411_1_411_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_411_1_411_10&#39;)"><span class="hl_varref"><span class="mpre">T.singleton</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\r&#39;</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">E.throwIO</span></span></a><span class="mpre"> (</span><a href="GHC.IO.Handle.Internals.html#loc_213_1_213_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_213_1_213_15&#39;)"><span class="hl_varref"><span class="mpre">augmentIOError</span></span></a><span class="mpre"> </span><a href="#loc_100_34_100_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_34_100_37&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre"> </span><a href="#loc_100_12_100_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_12_100_18&#39;)"><span class="hl_varref"><span class="mpre">caller</span></span></a><span class="mpre"> </span><a href="#loc_100_19_100_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_19_100_20&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | /Experimental./ Read a single chunk of strict text from a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Handle&#39;. The size of the chunk depends on the amount of input</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- currently buffered.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function blocks only if there is no data available, and EOF</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- has not yet been reached. Once EOF is reached, this function</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- returns an empty string instead of throwing an exception.</span></span><span class="mpre">
</span><a href="#loc_116_1_116_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_10&#39;)"><span class="mpre">hGetChunk</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_116_1_116_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_10&#39;)"><span class="hl_fundecl"><span class="mpre">hGetChunk</span></span></a><span class="mpre"> </span><a name="loc_116_11_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_12&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = </span><a href="GHC.IO.Handle.Internals.html#loc_261_1_261_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_261_1_261_19&#39;)"><span class="hl_varref"><span class="mpre">wantReadableHandle</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;hGetChunk&quot;</span></span><span class="mpre"> </span><a href="#loc_116_11_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_12&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_118_3_118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_3_118_18&#39;)"><span class="hl_varref"><span class="mpre">readSingleChunk</span></span></a><span class="mpre">
 where
  </span><a name="loc_118_3_118_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_3_118_18&#39;)"><span class="hl_fundecl"><span class="mpre">readSingleChunk</span></span></a><span class="mpre"> </span><a name="loc_118_19_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_19_118_21&#39;)"><span class="hl_specname"><span class="mpre">hh</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 118, srcSpanStartColumn = 22, srcSpanEndLine = 118, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 118, srcSpanStartColumn = 30, srcSpanEndLine = 118, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 118, srcSpanStart"><span class="mpre">Handle__{..}</span></span><span class="mpre"> = do
    </span><a name="loc_119_5_119_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_8&#39;)"><span class="hl_vardecl"><span class="mpre">buf</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_132_7_132_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_132_7_132_19&#39;)"><span class="hl_varref"><span class="mpre">haCharBuffer</span></span></a><span class="mpre">
    </span><a name="loc_120_5_120_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_5_120_6&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Text.Internal.IO.html#loc_156_1_156_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.IO.html#loc_156_1_156_10&#39;)"><span class="hl_varref"><span class="mpre">readChunk</span></span></a><span class="mpre"> </span><a href="#loc_118_19_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_19_118_21&#39;)"><span class="hl_varref"><span class="mpre">hh</span></span></a><span class="mpre"> </span><a href="#loc_119_5_119_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_8&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre"> </span><a href="Control.Exception.Base.html#loc_150_1_150_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_150_1_150_6&#39;)"><span class="hl_infix"><span class="mpre">`E.catch`</span></span></a><span class="mpre"> </span><a href="#loc_100_1_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_11&#39;)"><span class="hl_varref"><span class="mpre">catchError</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;hGetChunk&quot;</span></span><span class="mpre"> </span><a href="#loc_116_11_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_12&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_118_19_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_19_118_21&#39;)"><span class="hl_varref"><span class="mpre">hh</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_118_19_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_19_118_21&#39;)"><span class="hl_varref"><span class="mpre">hh</span></span></a><span class="mpre">, </span><a href="#loc_120_5_120_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_5_120_6&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Read the remaining contents of a &#39;Handle&#39; as a string.  The</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Handle&#39; is closed once the contents have been read, or if an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- exception is thrown.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Internally, this function reads a chunk at a time from the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- lower-level buffering abstraction, and concatenates the chunks into</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a single string once the entire file has been read.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- As a result, it requires approximately twice as much memory as its</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- result to construct its result.  For files more than a half of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- available RAM in size, this may result in memory exhaustion.</span></span><span class="mpre">
</span><a href="#loc_135_1_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_13&#39;)"><span class="mpre">hGetContents</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_135_1_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_13&#39;)"><span class="hl_fundecl"><span class="mpre">hGetContents</span></span></a><span class="mpre"> </span><a name="loc_135_14_135_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_14_135_15&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = do
  </span><a href="#loc_156_1_156_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_20&#39;)"><span class="hl_varref"><span class="mpre">chooseGoodBuffering</span></span></a><span class="mpre"> </span><a href="#loc_135_14_135_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_14_135_15&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
  </span><a href="GHC.IO.Handle.Internals.html#loc_261_1_261_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_261_1_261_19&#39;)"><span class="hl_varref"><span class="mpre">wantReadableHandle</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;hGetContents&quot;</span></span><span class="mpre"> </span><a href="#loc_135_14_135_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_14_135_15&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_139_3_139_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_3_139_10&#39;)"><span class="hl_varref"><span class="mpre">readAll</span></span></a><span class="mpre">
 where
  </span><a name="loc_139_3_139_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_3_139_10&#39;)"><span class="hl_fundecl"><span class="mpre">readAll</span></span></a><span class="mpre"> </span><a name="loc_139_11_139_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_11_139_13&#39;)"><span class="hl_specname"><span class="mpre">hh</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 139, srcSpanStartColumn = 14, srcSpanEndLine = 139, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 139, srcSpanStartColumn = 22, srcSpanEndLine = 139, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 139, srcSpanStart"><span class="mpre">Handle__{..}</span></span><span class="mpre"> = do
    let </span><a name="loc_140_9_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_19&#39;)"><span class="hl_vardecl"><span class="mpre">readChunks</span></span></a><span class="mpre"> = do
          </span><a name="loc_141_11_141_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_11_141_14&#39;)"><span class="hl_vardecl"><span class="mpre">buf</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_132_7_132_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_132_7_132_19&#39;)"><span class="hl_varref"><span class="mpre">haCharBuffer</span></span></a><span class="mpre">
          </span><a name="loc_142_11_142_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_11_142_12&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Text.Internal.IO.html#loc_156_1_156_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.IO.html#loc_156_1_156_10&#39;)"><span class="hl_varref"><span class="mpre">readChunk</span></span></a><span class="mpre"> </span><a href="#loc_139_11_139_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_11_139_13&#39;)"><span class="hl_varref"><span class="mpre">hh</span></span></a><span class="mpre"> </span><a href="#loc_141_11_141_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_11_141_14&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre"> </span><a href="Control.Exception.Base.html#loc_150_1_150_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_150_1_150_6&#39;)"><span class="hl_infix"><span class="mpre">`E.catch`</span></span></a><span class="mpre"> </span><a href="#loc_100_1_100_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_11&#39;)"><span class="hl_varref"><span class="mpre">catchError</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;hGetContents&quot;</span></span><span class="mpre"> </span><a href="#loc_135_14_135_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_14_135_15&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_139_11_139_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_11_139_13&#39;)"><span class="hl_varref"><span class="mpre">hh</span></span></a><span class="mpre">
          if </span><a href="Data.Text.html#loc_531_1_531_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_531_1_531_5&#39;)"><span class="hl_varref"><span class="mpre">T.null</span></span></a><span class="mpre"> </span><a href="#loc_142_11_142_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_11_142_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
            then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_142_11_142_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_11_142_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">]
            else (</span><a href="#loc_142_11_142_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_11_142_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="#loc_140_9_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_19&#39;)"><span class="hl_varref"><span class="mpre">readChunks</span></span></a><span class="mpre">
    </span><a name="loc_146_5_146_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_5_146_7&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_140_9_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_19&#39;)"><span class="hl_varref"><span class="mpre">readChunks</span></span></a><span class="mpre">
    (</span><span class="hl_vardecl"><span class="mpre">hh&#39;</span></span><span class="mpre">, _) &lt;- </span><a href="GHC.IO.Handle.Internals.html#loc_732_1_732_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_732_1_732_12&#39;)"><span class="hl_varref"><span class="mpre">hClose_help</span></span></a><span class="mpre"> </span><a href="#loc_139_11_139_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_11_139_13&#39;)"><span class="hl_varref"><span class="mpre">hh</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 148, srcSpanStartColumn = 13, srcSpanEndLine = 148, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 148, srcSpanStartColumn = 16, srcSpanEndLine = 148, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 148, srcSpan"><span class="mpre">hh&#39;{haType=ClosedHandle}</span></span><span class="mpre">, </span><a href="Data.Text.html#loc_849_1_849_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_849_1_849_7&#39;)"><span class="hl_varref"><span class="mpre">T.concat</span></span></a><span class="mpre"> </span><a href="#loc_146_5_146_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_5_146_7&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Use a more efficient buffer size if we&#39;re reading in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- block-buffered mode with the default buffer size.  When we can</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- determine the size of the handle we&#39;re reading, set the buffer size</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to that, so that we can read the entire file in one chunk.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Otherwise, use a buffer size of at least 16KB.</span></span><span class="mpre">
</span><a href="#loc_156_1_156_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_20&#39;)"><span class="mpre">chooseGoodBuffering</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_156_1_156_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_20&#39;)"><span class="hl_fundecl"><span class="mpre">chooseGoodBuffering</span></span></a><span class="mpre"> </span><a name="loc_156_21_156_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_21_156_22&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = do
  </span><a name="loc_157_3_157_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_3_157_10&#39;)"><span class="hl_vardecl"><span class="mpre">bufMode</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Handle.html#loc_493_1_493_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_493_1_493_14&#39;)"><span class="hl_varref"><span class="mpre">hGetBuffering</span></span></a><span class="mpre"> </span><a href="#loc_156_21_156_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_21_156_22&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
  case </span><a href="#loc_157_3_157_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_3_157_10&#39;)"><span class="hl_varref"><span class="mpre">bufMode</span></span></a><span class="mpre"> of
    </span><a href="GHC.IO.Handle.Types.html#loc_250_4_250_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_250_4_250_18&#39;)"><span class="hl_conref"><span class="mpre">BlockBuffering</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; do
      </span><a name="loc_160_7_160_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_7_160_8&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Exception.Base.html#loc_150_1_150_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_150_1_150_6&#39;)"><span class="hl_varref"><span class="mpre">E.catch</span></span></a><span class="mpre"> (</span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="hl_varref"><span class="mpre">liftM2</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(-)</span></span><span class="mpre"> (</span><a href="GHC.IO.Handle.html#loc_113_1_113_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_113_1_113_10&#39;)"><span class="hl_varref"><span class="mpre">hFileSize</span></span></a><span class="mpre"> </span><a href="#loc_156_21_156_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_21_156_22&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) (</span><a href="GHC.IO.Handle.html#loc_417_1_417_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_417_1_417_6&#39;)"><span class="hl_varref"><span class="mpre">hTell</span></span></a><span class="mpre"> </span><a href="#loc_156_21_156_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_21_156_22&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \(</span><a name="loc_160_61_160_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_61_160_62&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">::</span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">IOException</span></span></a><span class="mpre">) -&gt;
           if </span><a href="GHC.IO.Exception.html#loc_242_6_242_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_242_6_242_14&#39;)"><span class="hl_varref"><span class="mpre">ioe_type</span></span></a><span class="mpre"> </span><a href="#loc_160_61_160_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_61_160_62&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="GHC.IO.Exception.html#loc_273_5_273_22" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_273_5_273_22&#39;)"><span class="hl_conref"><span class="mpre">InappropriateType</span></span></a><span class="mpre">
           then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">16384</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- faster than the 2KB default</span></span><span class="mpre">
           else </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">E.throwIO</span></span></a><span class="mpre"> </span><a href="#loc_160_61_160_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_61_160_62&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
      </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_160_7_160_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_7_160_8&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.html#loc_204_1_204_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_204_1_204_14&#39;)"><span class="hl_varref"><span class="mpre">hSetBuffering</span></span></a><span class="mpre"> </span><a href="#loc_156_21_156_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_21_156_22&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_250_4_250_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_250_4_250_18&#39;)"><span class="hl_conref"><span class="mpre">BlockBuffering</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_160_7_160_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_7_160_8&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
    _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Read a single line from a handle.</span></span><span class="mpre">
</span><a href="#loc_169_1_169_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_9&#39;)"><span class="mpre">hGetLine</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_169_1_169_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_9&#39;)"><span class="hl_vardecl"><span class="mpre">hGetLine</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.IO.html#loc_44_1_44_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.IO.html#loc_44_1_44_13&#39;)"><span class="hl_varref"><span class="mpre">hGetLineWith</span></span></a><span class="mpre"> </span><a href="Data.Text.html#loc_849_1_849_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_849_1_849_7&#39;)"><span class="hl_varref"><span class="mpre">T.concat</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a string to a handle.</span></span><span class="mpre">
</span><a href="#loc_174_1_174_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_8&#39;)"><span class="mpre">hPutStr</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function is lifted almost verbatim from GHC.IO.Handle.Text.</span></span><span class="mpre">
</span><a name="loc_174_1_174_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_8&#39;)"><span class="hl_fundecl"><span class="mpre">hPutStr</span></span></a><span class="mpre"> </span><a name="loc_174_9_174_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_10&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_174_11_174_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_11_174_12&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = do
  (</span><a name="loc_175_4_175_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_4_175_15&#39;)"><span class="hl_vardecl"><span class="mpre">buffer_mode</span></span></a><span class="mpre">, </span><a name="loc_175_17_175_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_17_175_19&#39;)"><span class="hl_vardecl"><span class="mpre">nl</span></span></a><span class="mpre">) &lt;-
       </span><a href="GHC.IO.Handle.Internals.html#loc_225_1_225_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_225_1_225_19&#39;)"><span class="hl_varref"><span class="mpre">wantWritableHandle</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;hPutStr&quot;</span></span><span class="mpre"> </span><a href="#loc_174_9_174_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_10&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_176_42_176_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_42_176_44&#39;)"><span class="hl_vardecl"><span class="mpre">h_</span></span></a><span class="mpre"> -&gt; do
                     </span><a name="loc_177_22_177_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_22_177_27&#39;)"><span class="hl_vardecl"><span class="mpre">bmode</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_257_1_257_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_15&#39;)"><span class="hl_varref"><span class="mpre">getSpareBuffer</span></span></a><span class="mpre"> </span><a href="#loc_176_42_176_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_42_176_44&#39;)"><span class="hl_varref"><span class="mpre">h_</span></span></a><span class="mpre">
                     </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_177_22_177_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_22_177_27&#39;)"><span class="hl_varref"><span class="mpre">bmode</span></span></a><span class="mpre">, </span><a href="GHC.IO.Handle.Types.html#loc_138_7_138_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_138_7_138_17&#39;)"><span class="hl_varref"><span class="mpre">haOutputNL</span></span></a><span class="mpre"> </span><a href="#loc_176_42_176_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_42_176_44&#39;)"><span class="hl_varref"><span class="mpre">h_</span></span></a><span class="mpre">)
  let </span><a name="loc_179_7_179_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_7_179_10&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Fusion.html#loc_71_1_71_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.html#loc_71_1_71_7&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre"> </span><a href="#loc_174_11_174_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_11_174_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
  case </span><a href="#loc_175_4_175_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_4_175_15&#39;)"><span class="hl_varref"><span class="mpre">buffer_mode</span></span></a><span class="mpre"> of
     (</span><a href="GHC.IO.Handle.Types.html#loc_247_4_247_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_247_4_247_15&#39;)"><span class="hl_conref"><span class="mpre">NoBuffering</span></span></a><span class="mpre">, _)        -&gt; </span><a href="#loc_188_1_188_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_10&#39;)"><span class="hl_varref"><span class="mpre">hPutChars</span></span></a><span class="mpre"> </span><a href="#loc_174_9_174_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_10&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_179_7_179_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_7_179_10&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
     (</span><a href="GHC.IO.Handle.Types.html#loc_248_4_248_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_248_4_248_17&#39;)"><span class="hl_conref"><span class="mpre">LineBuffering</span></span></a><span class="mpre">, </span><a name="loc_182_22_182_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_22_182_25&#39;)"><span class="hl_vardecl"><span class="mpre">buf</span></span></a><span class="mpre">)    -&gt; </span><a href="#loc_206_1_206_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_11&#39;)"><span class="hl_varref"><span class="mpre">writeLines</span></span></a><span class="mpre"> </span><a href="#loc_174_9_174_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_10&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_175_17_175_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_17_175_19&#39;)"><span class="hl_varref"><span class="mpre">nl</span></span></a><span class="mpre"> </span><a href="#loc_182_22_182_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_22_182_25&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre"> </span><a href="#loc_179_7_179_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_7_179_10&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
     (</span><a href="GHC.IO.Handle.Types.html#loc_250_4_250_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_250_4_250_18&#39;)"><span class="hl_conref"><span class="mpre">BlockBuffering</span></span></a><span class="mpre"> _, </span><a name="loc_183_25_183_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_25_183_28&#39;)"><span class="hl_vardecl"><span class="mpre">buf</span></span></a><span class="mpre">)
         | </span><a href="#loc_175_17_175_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_17_175_19&#39;)"><span class="hl_varref"><span class="mpre">nl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_355_16_355_20" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_355_16_355_20&#39;)"><span class="hl_conref"><span class="mpre">CRLF</span></span></a><span class="mpre">        -&gt; </span><a href="#loc_226_1_226_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_16&#39;)"><span class="hl_varref"><span class="mpre">writeBlocksCRLF</span></span></a><span class="mpre"> </span><a href="#loc_174_9_174_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_10&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_183_25_183_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_25_183_28&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre"> </span><a href="#loc_179_7_179_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_7_179_10&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
         | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         -&gt; </span><a href="#loc_242_1_242_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_15&#39;)"><span class="hl_varref"><span class="mpre">writeBlocksRaw</span></span></a><span class="mpre"> </span><a href="#loc_174_9_174_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_9_174_10&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_183_25_183_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_25_183_28&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre"> </span><a href="#loc_179_7_179_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_7_179_10&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">

</span><a href="#loc_188_1_188_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_10&#39;)"><span class="mpre">hPutChars</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_188_1_188_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_10&#39;)"><span class="hl_fundecl"><span class="mpre">hPutChars</span></span></a><span class="mpre"> </span><a name="loc_188_11_188_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_11_188_12&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21&#39;)"><span class="hl_conref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><a name="loc_188_21_188_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_21_188_26&#39;)"><span class="hl_vardecl"><span class="mpre">next0</span></span></a><span class="mpre"> </span><a name="loc_188_27_188_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_27_188_29&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_len</span></span><span class="mpre">) = </span><a href="#loc_190_5_190_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_188_27_188_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_27_188_29&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre">
  where
    </span><a name="loc_190_5_190_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_9&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_190_11_190_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_11_190_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = case </span><a href="#loc_188_21_188_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_21_188_26&#39;)"><span class="hl_varref"><span class="mpre">next0</span></span></a><span class="mpre"> </span><a href="#loc_190_11_190_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_11_190_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
                </span><a href="Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">       -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
                </span><a href="Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21&#39;)"><span class="hl_conref"><span class="mpre">Skip</span></span></a><span class="mpre"> </span><a name="loc_192_22_192_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_22_192_24&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">    -&gt; </span><a href="#loc_190_5_190_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_192_22_192_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_22_192_24&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
                </span><a href="Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22&#39;)"><span class="hl_conref"><span class="mpre">Yield</span></span></a><span class="mpre"> </span><a name="loc_193_23_193_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_23_193_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_193_25_193_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_25_193_27&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Handle.Text.html#loc_468_1_468_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_468_1_468_9&#39;)"><span class="hl_varref"><span class="mpre">hPutChar</span></span></a><span class="mpre"> </span><a href="#loc_188_11_188_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_11_188_12&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_193_23_193_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_23_193_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_190_5_190_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_5_190_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_193_25_193_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_25_193_27&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- The following functions are largely lifted from GHC.IO.Handle.Text,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- but adapted to a coinductive stream of data instead of an inductive</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- list.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We have several variations of more or less the same code for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- performance reasons.  Splitting the original buffered write</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- function into line- and block-oriented versions gave us a 2.1x</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- performance improvement.  Lifting out the raw/cooked newline</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- handling gave a few more percent on top.</span></span><span class="mpre">

</span><a href="#loc_206_1_206_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_11&#39;)"><span class="mpre">writeLines</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Handle.Types.html#loc_354_6_354_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_354_6_354_13&#39;)"><span class="hl_tyconref"><span class="mpre">Newline</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Buffer.html#loc_180_6_180_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_180_6_180_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CharBufElem</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_206_1_206_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_11&#39;)"><span class="hl_fundecl"><span class="mpre">writeLines</span></span></a><span class="mpre"> </span><a name="loc_206_12_206_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_12_206_13&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_vardecl"><span class="mpre">nl</span></span></a><span class="mpre"> </span><a name="loc_206_17_206_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_17_206_21&#39;)"><span class="hl_vardecl"><span class="mpre">buf0</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21&#39;)"><span class="hl_conref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><a name="loc_206_30_206_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_30_206_35&#39;)"><span class="hl_vardecl"><span class="mpre">next0</span></span></a><span class="mpre"> </span><a name="loc_206_36_206_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_36_206_38&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_len</span></span><span class="mpre">) = </span><a href="#loc_208_3_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_3_208_8&#39;)"><span class="hl_varref"><span class="mpre">outer</span></span></a><span class="mpre"> </span><a href="#loc_206_36_206_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_36_206_38&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a href="#loc_206_17_206_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_17_206_21&#39;)"><span class="hl_varref"><span class="mpre">buf0</span></span></a><span class="mpre">
 where
  </span><a name="loc_208_3_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_3_208_8&#39;)"><span class="hl_fundecl"><span class="mpre">outer</span></span></a><span class="mpre"> </span><a name="loc_208_9_208_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_9_208_11&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 208, srcSpanStartColumn = 12, srcSpanEndLine = 208, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 208, srcSpanStartColumn = 18, srcSpanEndLine = 208, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 208, srcSpanStart"><span class="mpre">Buffer{bufRaw=raw, bufSize=len}</span></span><span class="mpre"> = </span><a href="#loc_210_5_210_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_5_210_10&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_208_9_208_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_9_208_11&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
   where
    </span><a name="loc_210_5_210_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_5_210_10&#39;)"><span class="hl_fundecl"><span class="mpre">inner</span></span></a><span class="mpre"> !</span><a name="loc_210_12_210_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_12_210_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> !</span><a name="loc_210_15_210_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_15_210_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
      case </span><a href="#loc_206_30_206_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_30_206_35&#39;)"><span class="hl_varref"><span class="mpre">next0</span></span></a><span class="mpre"> </span><a href="#loc_210_12_210_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_12_210_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
        </span><a href="Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_223_5_223_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_5_223_11&#39;)"><span class="hl_varref"><span class="mpre">commit</span></span></a><span class="mpre"> </span><a href="#loc_210_15_210_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_15_210_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="hl_comment"><span class="mpre">{-no flush-}</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="hl_comment"><span class="mpre">{-release-}</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        </span><a href="Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21&#39;)"><span class="hl_conref"><span class="mpre">Skip</span></span></a><span class="mpre"> </span><a name="loc_213_14_213_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_14_213_16&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_210_5_210_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_5_210_10&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_213_14_213_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_14_213_16&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><a href="#loc_210_15_210_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_15_210_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
        </span><a href="Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22&#39;)"><span class="hl_conref"><span class="mpre">Yield</span></span></a><span class="mpre"> </span><a name="loc_214_15_214_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_15_214_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_214_17_214_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_17_214_19&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">
          | </span><a href="#loc_210_15_210_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_15_210_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">len</span></span><span class="mpre"> -&gt; </span><a href="#loc_223_5_223_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_5_223_11&#39;)"><span class="hl_varref"><span class="mpre">commit</span></span></a><span class="mpre"> </span><a href="#loc_210_15_210_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_15_210_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="hl_comment"><span class="mpre">{-needs flush-}</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_208_3_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_3_208_8&#39;)"><span class="hl_varref"><span class="mpre">outer</span></span></a><span class="mpre"> </span><a href="#loc_210_12_210_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_12_210_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
          | </span><a href="#loc_214_15_214_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_15_214_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">    -&gt; do
                   </span><a name="loc_217_20_217_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_20_217_22&#39;)"><span class="hl_vardecl"><span class="mpre">n&#39;</span></span></a><span class="mpre"> &lt;- if </span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">nl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_355_16_355_20" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_355_16_355_20&#39;)"><span class="hl_conref"><span class="mpre">CRLF</span></span></a><span class="mpre">
                         then do </span><a name="loc_218_34_218_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_34_218_36&#39;)"><span class="hl_vardecl"><span class="mpre">n1</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_123_1_123_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_123_1_123_13&#39;)"><span class="hl_varref"><span class="mpre">writeCharBuf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">raw</span></span><span class="mpre"> </span><a href="#loc_210_15_210_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_15_210_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\r&#39;</span></span><span class="mpre">
                                 </span><a href="GHC.IO.Buffer.html#loc_123_1_123_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_123_1_123_13&#39;)"><span class="hl_varref"><span class="mpre">writeCharBuf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">raw</span></span><span class="mpre"> </span><a href="#loc_218_34_218_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_34_218_36&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">
                         else </span><a href="GHC.IO.Buffer.html#loc_123_1_123_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_123_1_123_13&#39;)"><span class="hl_varref"><span class="mpre">writeCharBuf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">raw</span></span><span class="mpre"> </span><a href="#loc_210_15_210_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_15_210_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_214_15_214_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_15_214_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                   </span><a href="#loc_223_5_223_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_5_223_11&#39;)"><span class="hl_varref"><span class="mpre">commit</span></span></a><span class="mpre"> </span><a href="#loc_217_20_217_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_20_217_22&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="hl_comment"><span class="mpre">{-needs flush-}</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_208_3_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_3_208_8&#39;)"><span class="hl_varref"><span class="mpre">outer</span></span></a><span class="mpre"> </span><a href="#loc_214_17_214_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_17_214_19&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">    -&gt; </span><a href="GHC.IO.Buffer.html#loc_123_1_123_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_123_1_123_13&#39;)"><span class="hl_varref"><span class="mpre">writeCharBuf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">raw</span></span><span class="mpre"> </span><a href="#loc_210_15_210_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_15_210_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_214_15_214_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_15_214_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_210_5_210_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_5_210_10&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_214_17_214_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_17_214_19&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
    </span><a name="loc_223_5_223_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_5_223_11&#39;)"><span class="hl_vardecl"><span class="mpre">commit</span></span></a><span class="mpre"> = </span><a href="#loc_278_1_278_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_13&#39;)"><span class="hl_varref"><span class="mpre">commitBuffer</span></span></a><span class="mpre"> </span><a href="#loc_206_12_206_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_12_206_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">raw</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">len</span></span><span class="mpre">

</span><a href="#loc_226_1_226_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_16&#39;)"><span class="mpre">writeBlocksCRLF</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Buffer.html#loc_180_6_180_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_180_6_180_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CharBufElem</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_226_1_226_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_16&#39;)"><span class="hl_fundecl"><span class="mpre">writeBlocksCRLF</span></span></a><span class="mpre"> </span><a name="loc_226_17_226_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_17_226_18&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_226_19_226_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_19_226_23&#39;)"><span class="hl_vardecl"><span class="mpre">buf0</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21&#39;)"><span class="hl_conref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><a name="loc_226_32_226_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_32_226_37&#39;)"><span class="hl_vardecl"><span class="mpre">next0</span></span></a><span class="mpre"> </span><a name="loc_226_38_226_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_38_226_40&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_len</span></span><span class="mpre">) = </span><a href="#loc_228_3_228_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_3_228_8&#39;)"><span class="hl_varref"><span class="mpre">outer</span></span></a><span class="mpre"> </span><a href="#loc_226_38_226_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_38_226_40&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a href="#loc_226_19_226_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_19_226_23&#39;)"><span class="hl_varref"><span class="mpre">buf0</span></span></a><span class="mpre">
 where
  </span><a name="loc_228_3_228_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_3_228_8&#39;)"><span class="hl_fundecl"><span class="mpre">outer</span></span></a><span class="mpre"> </span><a name="loc_228_9_228_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_9_228_11&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 228, srcSpanStartColumn = 12, srcSpanEndLine = 228, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 228, srcSpanStartColumn = 18, srcSpanEndLine = 228, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 228, srcSpanStart"><span class="mpre">Buffer{bufRaw=raw, bufSize=len}</span></span><span class="mpre"> = </span><a href="#loc_230_5_230_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_5_230_10&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_228_9_228_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_9_228_11&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
   where
    </span><a name="loc_230_5_230_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_5_230_10&#39;)"><span class="hl_fundecl"><span class="mpre">inner</span></span></a><span class="mpre"> !</span><a name="loc_230_12_230_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_12_230_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> !</span><a name="loc_230_15_230_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_15_230_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
      case </span><a href="#loc_226_32_226_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_32_226_37&#39;)"><span class="hl_varref"><span class="mpre">next0</span></span></a><span class="mpre"> </span><a href="#loc_230_12_230_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_12_230_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
        </span><a href="Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_239_5_239_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_5_239_11&#39;)"><span class="hl_varref"><span class="mpre">commit</span></span></a><span class="mpre"> </span><a href="#loc_230_15_230_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_15_230_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="hl_comment"><span class="mpre">{-no flush-}</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="hl_comment"><span class="mpre">{-release-}</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        </span><a href="Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21&#39;)"><span class="hl_conref"><span class="mpre">Skip</span></span></a><span class="mpre"> </span><a name="loc_233_14_233_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_14_233_16&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_230_5_230_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_5_230_10&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_233_14_233_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_14_233_16&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><a href="#loc_230_15_230_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_15_230_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
        </span><a href="Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22&#39;)"><span class="hl_conref"><span class="mpre">Yield</span></span></a><span class="mpre"> </span><a name="loc_234_15_234_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_15_234_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_234_17_234_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_17_234_19&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">
          | </span><a href="#loc_230_15_230_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_15_230_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">len</span></span><span class="mpre"> -&gt; </span><a href="#loc_239_5_239_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_5_239_11&#39;)"><span class="hl_varref"><span class="mpre">commit</span></span></a><span class="mpre"> </span><a href="#loc_230_15_230_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_15_230_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="hl_comment"><span class="mpre">{-needs flush-}</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_228_3_228_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_3_228_8&#39;)"><span class="hl_varref"><span class="mpre">outer</span></span></a><span class="mpre"> </span><a href="#loc_230_12_230_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_12_230_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
          | </span><a href="#loc_234_15_234_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_15_234_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">    -&gt; do </span><a name="loc_236_32_236_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_32_236_34&#39;)"><span class="hl_vardecl"><span class="mpre">n1</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_123_1_123_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_123_1_123_13&#39;)"><span class="hl_varref"><span class="mpre">writeCharBuf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">raw</span></span><span class="mpre"> </span><a href="#loc_230_15_230_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_15_230_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\r&#39;</span></span><span class="mpre">
                               </span><a href="GHC.IO.Buffer.html#loc_123_1_123_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_123_1_123_13&#39;)"><span class="hl_varref"><span class="mpre">writeCharBuf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">raw</span></span><span class="mpre"> </span><a href="#loc_236_32_236_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_32_236_34&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_230_5_230_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_5_230_10&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_234_17_234_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_17_234_19&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">    -&gt; </span><a href="GHC.IO.Buffer.html#loc_123_1_123_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_123_1_123_13&#39;)"><span class="hl_varref"><span class="mpre">writeCharBuf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">raw</span></span><span class="mpre"> </span><a href="#loc_230_15_230_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_15_230_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_234_15_234_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_15_234_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_230_5_230_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_5_230_10&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_234_17_234_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_17_234_19&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
    </span><a name="loc_239_5_239_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_5_239_11&#39;)"><span class="hl_vardecl"><span class="mpre">commit</span></span></a><span class="mpre"> = </span><a href="#loc_278_1_278_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_13&#39;)"><span class="hl_varref"><span class="mpre">commitBuffer</span></span></a><span class="mpre"> </span><a href="#loc_226_17_226_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_17_226_18&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">raw</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">len</span></span><span class="mpre">

</span><a href="#loc_242_1_242_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_15&#39;)"><span class="mpre">writeBlocksRaw</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Buffer.html#loc_180_6_180_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_180_6_180_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CharBufElem</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_242_1_242_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_15&#39;)"><span class="hl_fundecl"><span class="mpre">writeBlocksRaw</span></span></a><span class="mpre"> </span><a name="loc_242_16_242_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_16_242_17&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_242_18_242_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_18_242_22&#39;)"><span class="hl_vardecl"><span class="mpre">buf0</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_89_15_89_21&#39;)"><span class="hl_conref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><a name="loc_242_31_242_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_31_242_36&#39;)"><span class="hl_vardecl"><span class="mpre">next0</span></span></a><span class="mpre"> </span><a name="loc_242_37_242_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_37_242_39&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_len</span></span><span class="mpre">) = </span><a href="#loc_244_3_244_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_3_244_8&#39;)"><span class="hl_varref"><span class="mpre">outer</span></span></a><span class="mpre"> </span><a href="#loc_242_37_242_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_37_242_39&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a href="#loc_242_18_242_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_18_242_22&#39;)"><span class="hl_varref"><span class="mpre">buf0</span></span></a><span class="mpre">
 where
  </span><a name="loc_244_3_244_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_3_244_8&#39;)"><span class="hl_fundecl"><span class="mpre">outer</span></span></a><span class="mpre"> </span><a name="loc_244_9_244_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_9_244_11&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 244, srcSpanStartColumn = 12, srcSpanEndLine = 244, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 244, srcSpanStartColumn = 18, srcSpanEndLine = 244, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 244, srcSpanStart"><span class="mpre">Buffer{bufRaw=raw, bufSize=len}</span></span><span class="mpre"> = </span><a href="#loc_246_5_246_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_5_246_10&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_244_9_244_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_9_244_11&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
   where
    </span><a name="loc_246_5_246_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_5_246_10&#39;)"><span class="hl_fundecl"><span class="mpre">inner</span></span></a><span class="mpre"> !</span><a name="loc_246_12_246_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_12_246_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> !</span><a name="loc_246_15_246_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_15_246_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
      case </span><a href="#loc_242_31_242_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_31_242_36&#39;)"><span class="hl_varref"><span class="mpre">next0</span></span></a><span class="mpre"> </span><a href="#loc_246_12_246_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_12_246_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
        </span><a href="Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_59_17_59_21&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_253_5_253_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_5_253_11&#39;)"><span class="hl_varref"><span class="mpre">commit</span></span></a><span class="mpre"> </span><a href="#loc_246_15_246_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_15_246_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="hl_comment"><span class="mpre">{-no flush-}</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="hl_comment"><span class="mpre">{-release-}</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        </span><a href="Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_60_17_60_21&#39;)"><span class="hl_conref"><span class="mpre">Skip</span></span></a><span class="mpre"> </span><a name="loc_249_14_249_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_14_249_16&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_246_5_246_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_5_246_10&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_249_14_249_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_14_249_16&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><a href="#loc_246_15_246_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_15_246_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
        </span><a href="Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_61_17_61_22&#39;)"><span class="hl_conref"><span class="mpre">Yield</span></span></a><span class="mpre"> </span><a name="loc_250_15_250_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_15_250_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_250_17_250_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_17_250_19&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">
          | </span><a href="#loc_246_15_246_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_15_246_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">len</span></span><span class="mpre"> -&gt; </span><a href="#loc_253_5_253_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_5_253_11&#39;)"><span class="hl_varref"><span class="mpre">commit</span></span></a><span class="mpre"> </span><a href="#loc_246_15_246_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_15_246_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="hl_comment"><span class="mpre">{-needs flush-}</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_244_3_244_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_3_244_8&#39;)"><span class="hl_varref"><span class="mpre">outer</span></span></a><span class="mpre"> </span><a href="#loc_246_12_246_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_12_246_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">    -&gt; </span><a href="GHC.IO.Buffer.html#loc_123_1_123_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_123_1_123_13&#39;)"><span class="hl_varref"><span class="mpre">writeCharBuf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">raw</span></span><span class="mpre"> </span><a href="#loc_246_15_246_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_15_246_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_250_15_250_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_15_250_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_246_5_246_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_5_246_10&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_250_17_250_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_17_250_19&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
    </span><a name="loc_253_5_253_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_5_253_11&#39;)"><span class="hl_vardecl"><span class="mpre">commit</span></span></a><span class="mpre"> = </span><a href="#loc_278_1_278_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_13&#39;)"><span class="hl_varref"><span class="mpre">commitBuffer</span></span></a><span class="mpre"> </span><a href="#loc_242_16_242_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_16_242_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">raw</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">len</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- This function is completely lifted from GHC.IO.Handle.Text.</span></span><span class="mpre">
</span><a href="#loc_257_1_257_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_15&#39;)"><span class="mpre">getSpareBuffer</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_124_6_124_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_124_6_124_14&#39;)"><span class="hl_tyconref"><span class="mpre">Handle__</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="GHC.IO.Handle.Types.html#loc_246_6_246_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_246_6_246_16&#39;)"><span class="hl_tyconref"><span class="mpre">BufferMode</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">CharBuffer</span></span><span class="mpre">)
</span><a name="loc_257_1_257_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_15&#39;)"><span class="hl_fundecl"><span class="mpre">getSpareBuffer</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 257, srcSpanStartColumn = 16, srcSpanEndLine = 259, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 257, srcSpanStartColumn = 24, srcSpanEndLine = 257, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/IO.hs&quot;, srcSpanStartLine = 257, srcSpanStart"><span class="mpre">Handle__{haCharBuffer=ref,
                        haBuffers=spare_ref,
                        haBufferMode=mode}</span></span><span class="mpre">
 = do
   case </span><span class="hl_varref"><span class="mpre">mode</span></span><span class="mpre"> of
     </span><a href="GHC.IO.Handle.Types.html#loc_247_4_247_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_247_4_247_15&#39;)"><span class="hl_conref"><span class="mpre">NoBuffering</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mode</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;no buffer!&quot;</span></span><span class="mpre">)
     _ -&gt; do
          </span><a name="loc_264_11_264_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_11_264_15&#39;)"><span class="hl_vardecl"><span class="mpre">bufs</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">spare_ref</span></span><span class="mpre">
          </span><a name="loc_265_11_265_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_11_265_14&#39;)"><span class="hl_vardecl"><span class="mpre">buf</span></span></a><span class="mpre">  &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ref</span></span><span class="mpre">
          case </span><a href="#loc_264_11_264_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_11_264_15&#39;)"><span class="hl_varref"><span class="mpre">bufs</span></span></a><span class="mpre"> of
            </span><a href="GHC.IO.Handle.Types.html#loc_149_5_149_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_149_5_149_19&#39;)"><span class="hl_conref"><span class="mpre">BufferListCons</span></span></a><span class="mpre"> </span><a name="loc_267_28_267_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_28_267_29&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_267_30_267_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_30_267_34&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> -&gt; do
                </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">spare_ref</span></span><span class="mpre"> </span><a href="#loc_267_30_267_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_30_267_34&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> ( </span><span class="hl_varref"><span class="mpre">mode</span></span><span class="mpre">, </span><a href="GHC.IO.Buffer.html#loc_240_1_240_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_240_1_240_12&#39;)"><span class="hl_varref"><span class="mpre">emptyBuffer</span></span></a><span class="mpre"> </span><a href="#loc_267_28_267_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_28_267_29&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (</span><a href="GHC.IO.Buffer.html#loc_184_9_184_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_184_9_184_16&#39;)"><span class="hl_varref"><span class="mpre">bufSize</span></span></a><span class="mpre"> </span><a href="#loc_265_11_265_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_11_265_14&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre">) </span><a href="GHC.IO.Buffer.html#loc_195_33_195_44" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_195_33_195_44&#39;)"><span class="hl_conref"><span class="mpre">WriteBuffer</span></span></a><span class="mpre">)
            </span><a href="GHC.IO.Handle.Types.html#loc_148_5_148_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_148_5_148_18&#39;)"><span class="hl_conref"><span class="mpre">BufferListNil</span></span></a><span class="mpre"> -&gt; do
                </span><a name="loc_271_17_271_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_17_271_24&#39;)"><span class="hl_vardecl"><span class="mpre">new_buf</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_247_1_247_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_247_1_247_14&#39;)"><span class="hl_varref"><span class="mpre">newCharBuffer</span></span></a><span class="mpre"> (</span><a href="GHC.IO.Buffer.html#loc_184_9_184_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_184_9_184_16&#39;)"><span class="hl_varref"><span class="mpre">bufSize</span></span></a><span class="mpre"> </span><a href="#loc_265_11_265_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_11_265_14&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre">) </span><a href="GHC.IO.Buffer.html#loc_195_33_195_44" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_195_33_195_44&#39;)"><span class="hl_conref"><span class="mpre">WriteBuffer</span></span></a><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mode</span></span><span class="mpre">, </span><a href="#loc_271_17_271_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_17_271_24&#39;)"><span class="hl_varref"><span class="mpre">new_buf</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- This function is completely lifted from GHC.IO.Handle.Text.</span></span><span class="mpre">
</span><a href="#loc_278_1_278_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_13&#39;)"><span class="mpre">commitBuffer</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">RawCharBuffer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CharBuffer</span></span><span class="mpre">
</span><a name="loc_278_1_278_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_13&#39;)"><span class="hl_fundecl"><span class="mpre">commitBuffer</span></span></a><span class="mpre"> </span><a name="loc_278_14_278_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_14_278_17&#39;)"><span class="hl_vardecl"><span class="mpre">hdl</span></span></a><span class="mpre"> !</span><a name="loc_278_19_278_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_19_278_22&#39;)"><span class="hl_vardecl"><span class="mpre">raw</span></span></a><span class="mpre"> !</span><a name="loc_278_24_278_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_24_278_26&#39;)"><span class="hl_vardecl"><span class="mpre">sz</span></span></a><span class="mpre"> !</span><a name="loc_278_28_278_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_28_278_33&#39;)"><span class="hl_vardecl"><span class="mpre">count</span></span></a><span class="mpre"> </span><a name="loc_278_34_278_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_34_278_39&#39;)"><span class="hl_vardecl"><span class="mpre">flush</span></span></a><span class="mpre"> </span><a name="loc_278_40_278_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_40_278_47&#39;)"><span class="hl_vardecl"><span class="mpre">release</span></span></a><span class="mpre"> =
  </span><a href="GHC.IO.Handle.Internals.html#loc_225_1_225_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_225_1_225_19&#39;)"><span class="hl_varref"><span class="mpre">wantWritableHandle</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;commitAndReleaseBuffer&quot;</span></span><span class="mpre"> </span><a href="#loc_278_14_278_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_14_278_17&#39;)"><span class="hl_varref"><span class="mpre">hdl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
     </span><a href="GHC.IO.Handle.Text.html#loc_650_1_650_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_650_1_650_14&#39;)"><span class="hl_varref"><span class="mpre">commitBuffer&#39;</span></span></a><span class="mpre"> </span><a href="#loc_278_19_278_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_19_278_22&#39;)"><span class="hl_varref"><span class="mpre">raw</span></span></a><span class="mpre"> </span><a href="#loc_278_24_278_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_24_278_26&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre"> </span><a href="#loc_278_28_278_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_28_278_33&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><a href="#loc_278_34_278_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_34_278_39&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre"> </span><a href="#loc_278_40_278_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_40_278_47&#39;)"><span class="hl_varref"><span class="mpre">release</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_278_1_278_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_13&#39;)"><span class="mpre">commitBuffer</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a string to a handle, followed by a newline.</span></span><span class="mpre">
</span><a href="#loc_285_1_285_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_1_285_10&#39;)"><span class="mpre">hPutStrLn</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_285_1_285_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_1_285_10&#39;)"><span class="hl_fundecl"><span class="mpre">hPutStrLn</span></span></a><span class="mpre"> </span><a name="loc_285_11_285_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_11_285_12&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_285_13_285_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_13_285_14&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_174_1_174_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_8&#39;)"><span class="hl_varref"><span class="mpre">hPutStr</span></span></a><span class="mpre"> </span><a href="#loc_285_11_285_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_11_285_12&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_285_13_285_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_13_285_14&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Text.html#loc_468_1_468_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_468_1_468_9&#39;)"><span class="hl_varref"><span class="mpre">hPutChar</span></span></a><span class="mpre"> </span><a href="#loc_285_11_285_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_11_285_12&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The &#39;interact&#39; function takes a function of type @Text -&gt; Text@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as its argument. The entire input from the standard input device is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- passed to this function as its argument, and the resulting string</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is output on the standard output device.</span></span><span class="mpre">
</span><a href="#loc_292_1_292_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_1_292_9&#39;)"><span class="mpre">interact</span></a><span class="mpre"> :: (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_292_1_292_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_1_292_9&#39;)"><span class="hl_fundecl"><span class="mpre">interact</span></span></a><span class="mpre"> </span><a name="loc_292_10_292_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_10_292_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_304_1_304_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_1_304_7&#39;)"><span class="hl_varref"><span class="mpre">putStr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_292_10_292_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_10_292_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span></a><span class="mpre"> </span><a href="#loc_296_1_296_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_1_296_12&#39;)"><span class="hl_varref"><span class="mpre">getContents</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Read all user input on &#39;stdin&#39; as a single string.</span></span><span class="mpre">
</span><a href="#loc_296_1_296_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_1_296_12&#39;)"><span class="mpre">getContents</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_296_1_296_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_1_296_12&#39;)"><span class="hl_vardecl"><span class="mpre">getContents</span></span></a><span class="mpre"> = </span><a href="#loc_135_1_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_13&#39;)"><span class="hl_varref"><span class="mpre">hGetContents</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_52_1_52_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_52_1_52_6&#39;)"><span class="hl_varref"><span class="mpre">stdin</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Read a single line of user input from &#39;stdin&#39;.</span></span><span class="mpre">
</span><a href="#loc_300_1_300_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_1_300_8&#39;)"><span class="mpre">getLine</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_300_1_300_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_1_300_8&#39;)"><span class="hl_vardecl"><span class="mpre">getLine</span></span></a><span class="mpre"> = </span><a href="#loc_169_1_169_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_9&#39;)"><span class="hl_varref"><span class="mpre">hGetLine</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_52_1_52_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_52_1_52_6&#39;)"><span class="hl_varref"><span class="mpre">stdin</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a string to &#39;stdout&#39;.</span></span><span class="mpre">
</span><a href="#loc_304_1_304_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_1_304_7&#39;)"><span class="mpre">putStr</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_304_1_304_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_1_304_7&#39;)"><span class="hl_vardecl"><span class="mpre">putStr</span></span></a><span class="mpre"> = </span><a href="#loc_174_1_174_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_8&#39;)"><span class="hl_varref"><span class="mpre">hPutStr</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a string to &#39;stdout&#39;, followed by a newline.</span></span><span class="mpre">
</span><a href="#loc_308_1_308_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_1_308_9&#39;)"><span class="mpre">putStrLn</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_308_1_308_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_1_308_9&#39;)"><span class="hl_vardecl"><span class="mpre">putStrLn</span></span></a><span class="mpre"> = </span><a href="#loc_285_1_285_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_1_285_10&#39;)"><span class="hl_varref"><span class="mpre">hPutStrLn</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- $locale</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Note/: The behaviour of functions in this module depends on the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- version of GHC you are using.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Beginning with GHC 6.12, text I\/O is performed using the system or</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- handle&#39;s current locale and line ending conventions.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Under GHC 6.10 and earlier, the system I\/O libraries do not</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- support locale-sensitive I\/O or line ending conversion.  On these</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- versions of GHC, functions in this library all use UTF-8.  What</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- does this mean in practice?</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * All data that is read will be decoded as UTF-8.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Before data is written, it is first encoded as UTF-8.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * On both reading and writing, the platform&#39;s native newline</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   conversion is performed.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If you must use a non-UTF-8 locale on an older version of GHC, you</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will have to perform the transcoding yourself, e.g. as follows:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; import qualified Data.ByteString as B</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; import Data.Text (Text)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; import Data.Text.Encoding (encodeUtf16)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; putStr_Utf16LE :: Text -&gt; IO ()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; putStr_Utf16LE t = B.putStr (encodeUtf16LE t)</span></span><span class="mpre">
</span></div></body></html>