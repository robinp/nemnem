<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
{-# LANGUAGE GADTs #-}
{-# LANGUAGE Rank2Types #-}
{-# LANGUAGE TypeFamilies #-}
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Control.Lens.Equality</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (C) 2012-14 Edward Kmett</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Edward Kmett &lt;ekmett@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  Rank2Types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------------</span></span><span class="mpre">
module Control.Lens.Equality
  (
  </span><span class="hl_comment"><span class="mpre">-- * Type Equality</span></span><span class="mpre">
    Equality, Equality&#39;
  , AnEquality, AnEquality&#39;
  , runEq
  , substEq
  , mapEq
  , fromEq
  , simply
  </span><span class="hl_comment"><span class="mpre">-- * The Trivial Equality</span></span><span class="mpre">
  , simple
  </span><span class="hl_comment"><span class="mpre">-- * Implementation Details</span></span><span class="mpre">
  , Identical(..)
  ) where

import Control.Lens.Type
import Data.Functor.Identity

#ifdef HLINT
</span><span class="warning" data-warning="DeclAnnPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 1, srcSpanEndLine = 35, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 1, srcSpanEndLine = 35, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStar"><span class="mpre">{-# ANN module &quot;HLint: ignore Use id&quot; #-}</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclAnnPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 1, srcSpanEndLine = 36, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 1, srcSpanEndLine = 36, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStar"><span class="mpre">{-# ANN module &quot;HLint: ignore Eta reduce&quot; #-}</span></span><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- $setup</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; import Control.Lens</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Equality</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Provides witness that @(s ~ a, b ~ t)@ holds.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclGDataDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 1, srcSpanEndLine = 51, srcSpanEndColumn = 0}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 24, srcSpanEndLine = 47, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanSta"><span class="mpre">data Identical a b s t where
  Identical :: Identical a b a b

</span><span class="hl_comment"><span class="mpre">-- | When you see this as an argument to a function, it expects an &#39;Equality&#39;.</span></span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 1, srcSpanEndLine = 51, srcSpanEndColumn = 109}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 1, srcSpanEndLine = 51, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStar"><span class="mpre">type AnEquality s t a b = Identical a (Identity b) a (Identity b) -&gt; Identical a (Identity b) s (Identity t)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A &#39;Simple&#39; &#39;AnEquality&#39;.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStartLine = 54, srcSpanStartColumn = 1, srcSpanEndLine = 54, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStartLine = 54, srcSpanStartColumn = 1, srcSpanEndLine = 54, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStart"><span class="mpre">type AnEquality&#39; s a = AnEquality s s a a</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Extract a witness of type &#39;Equality&#39;.</span></span><span class="mpre">
</span><a href="#loc_58_1_58_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_6&#39;)"><span class="mpre">runEq</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">AnEquality</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Identical</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_58_1_58_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_6&#39;)"><span class="hl_fundecl"><span class="mpre">runEq</span></span></a><span class="mpre"> </span><a name="loc_58_7_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_7_58_8&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = case </span><a href="#loc_58_7_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_7_58_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Identical</span></span><span class="mpre"> of </span><span class="hl_conref"><span class="mpre">Identical</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Identical</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_58_1_58_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_6&#39;)"><span class="mpre">runEq</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Substituting types with &#39;Equality&#39;.</span></span><span class="mpre">
</span><a href="#loc_63_1_63_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_8&#39;)"><span class="mpre">substEq</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">AnEquality</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; (</span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 35, srcSpanEndLine = 62, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 35, srcSpanEndLine = 62, srcSpanEndColumn = 36},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Equality.hs&quot;, srcSpanSta"><span class="mpre">(s ~ a, t ~ b) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_63_1_63_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_8&#39;)"><span class="hl_fundecl"><span class="mpre">substEq</span></span></a><span class="mpre"> </span><a name="loc_63_9_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_10&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = case </span><a href="#loc_58_1_58_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_6&#39;)"><span class="hl_varref"><span class="mpre">runEq</span></span></a><span class="mpre"> </span><a href="#loc_63_9_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> of
  </span><span class="hl_conref"><span class="mpre">Identical</span></span><span class="mpre"> -&gt; \</span><a name="loc_64_17_64_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_17_64_18&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_64_17_64_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_17_64_18&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_63_1_63_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_8&#39;)"><span class="mpre">substEq</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | We can use &#39;Equality&#39; to do substitution into anything.</span></span><span class="mpre">
</span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="mpre">mapEq</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">AnEquality</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_fundecl"><span class="mpre">mapEq</span></span></a><span class="mpre"> </span><a name="loc_69_7_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_7_69_8&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_69_9_69_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_10&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_63_1_63_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_8&#39;)"><span class="hl_varref"><span class="mpre">substEq</span></span></a><span class="mpre"> </span><a href="#loc_69_7_69_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_7_69_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_69_9_69_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_10&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="mpre">mapEq</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | &#39;Equality&#39; is symmetric.</span></span><span class="mpre">
</span><a href="#loc_74_1_74_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_7&#39;)"><span class="mpre">fromEq</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">AnEquality</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Equality</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_74_1_74_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_7&#39;)"><span class="hl_fundecl"><span class="mpre">fromEq</span></span></a><span class="mpre"> </span><a name="loc_74_8_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_8_74_9&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_63_1_63_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_8&#39;)"><span class="hl_varref"><span class="mpre">substEq</span></span></a><span class="mpre"> </span><a href="#loc_74_8_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_8_74_9&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_74_1_74_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_7&#39;)"><span class="mpre">fromEq</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This is an adverb that can be used to modify many other &#39;Lens&#39; combinators to make them require</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- simple lenses, simple traversals, simple prisms or simple isos as input.</span></span><span class="mpre">
</span><a href="#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_7&#39;)"><span class="mpre">simply</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Optic&#39;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Optic&#39;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_80_1_80_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_7&#39;)"><span class="hl_vardecl"><span class="mpre">simply</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_7&#39;)"><span class="mpre">simply</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Composition with this isomorphism is occasionally useful when your &#39;Lens&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Control.Lens.Traversal.Traversal&#39; or &#39;Iso&#39; has a constraint on an unused</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- argument to force that argument to agree with the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- type of a used argument and avoid @ScopedTypeVariables@ or other ugliness.</span></span><span class="mpre">
</span><a href="#loc_88_1_88_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_7&#39;)"><span class="mpre">simple</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Equality&#39;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_88_1_88_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_7&#39;)"><span class="hl_vardecl"><span class="mpre">simple</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_88_1_88_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_7&#39;)"><span class="mpre">simple</span></a><span class="mpre"> #-}</span></span></div></body></html>