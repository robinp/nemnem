<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
{-# LANGUAGE Rank2Types #-}
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE GeneralizedNewtypeDeriving #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.TLS.State</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the State module contains calls related to state initialization/manipulation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which is use by the Receiving module and the Sending module.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.TLS.State
    ( TLSState(..)
    , TLSSt
    , runTLSState
    , newTLSState
    , withTLSRNG
    , updateVerifiedData
    , finishHandshakeTypeMaterial
    , finishHandshakeMaterial
    , certVerifyHandshakeTypeMaterial
    , certVerifyHandshakeMaterial
    , setVersion
    , setVersionIfUnset
    , getVersion
    , getVersionWithDefault
    , setSecureRenegotiation
    , getSecureRenegotiation
    , setExtensionNPN
    , getExtensionNPN
    , setNegotiatedProtocol
    , getNegotiatedProtocol
    , setServerNextProtocolSuggest
    , getServerNextProtocolSuggest
    , getClientCertificateChain
    , setClientCertificateChain
    , getVerifiedData
    , setSession
    , getSession
    , isSessionResuming
    , isClientContext
    </span><span class="hl_comment"><span class="mpre">-- * random</span></span><span class="mpre">
    , genRandom
    , withRNG
    ) where

import Control.Applicative
import Network.TLS.Struct
import Network.TLS.RNG
import Network.TLS.Types (</span><a href="Network.TLS.Types.html#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_44_6_44_10&#39;)"><span class="mpre">Role</span></a><span class="mpre">(..))
import Network.TLS.Wire (GetContinuation)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 18, srcSpanEndLine = 55, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Control.Monad.State
import Control.Monad.Error
import Crypto.Random
import Data.X509 (</span><a href="Data.X509.CertificateChain.html#loc_21_9_21_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_9_21_25&#39;)"><a href="Data.X509.CertificateChain.html#loc_21_28_21_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_28_21_44&#39;)"><span class="mpre">CertificateChain</span></a></a><span class="mpre">)

data </span><a name="loc_61_6_61_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_14&#39;)"><span class="hl_tycondecl"><span class="mpre">TLSState</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">TLSState</span></span><span class="mpre">
    { </span><a name="loc_62_7_62_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_16&#39;)"><span class="hl_fielddecl"><span class="mpre">stSession</span></span></a><span class="mpre">             :: </span><a href="Network.TLS.Struct.html#loc_161_9_161_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_161_9_161_16&#39;)"><span class="hl_tyconref"><span class="mpre">Session</span></span></a><span class="mpre">
    , </span><a name="loc_63_7_63_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_7_63_24&#39;)"><span class="hl_fielddecl"><span class="mpre">stSessionResuming</span></span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    , </span><a name="loc_64_7_64_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_7_64_28&#39;)"><span class="hl_fielddecl"><span class="mpre">stSecureRenegotiation</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- RFC 5746</span></span><span class="mpre">
    , </span><a name="loc_65_7_65_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_7_65_27&#39;)"><span class="hl_fielddecl"><span class="mpre">stClientVerifiedData</span></span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- RFC 5746</span></span><span class="mpre">
    , </span><a name="loc_66_7_66_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_7_66_27&#39;)"><span class="hl_fielddecl"><span class="mpre">stServerVerifiedData</span></span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- RFC 5746</span></span><span class="mpre">
    , </span><a name="loc_67_7_67_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_7_67_21&#39;)"><span class="hl_fielddecl"><span class="mpre">stExtensionNPN</span></span></a><span class="mpre">        :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- NPN draft extension</span></span><span class="mpre">
    , </span><a name="loc_68_7_68_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_7_68_28&#39;)"><span class="hl_fielddecl"><span class="mpre">stHandshakeRecordCont</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GetContinuation</span></span><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_212_6_212_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_212_6_212_19&#39;)"><span class="hl_tyconref"><span class="mpre">HandshakeType</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">))
    , </span><a name="loc_69_7_69_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_7_69_27&#39;)"><span class="hl_fielddecl"><span class="mpre">stNegotiatedProtocol</span></span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- NPN protocol</span></span><span class="mpre">
    , </span><a name="loc_70_7_70_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_7_70_34&#39;)"><span class="hl_fielddecl"><span class="mpre">stServerNextProtocolSuggest</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">]
    , </span><a name="loc_71_7_71_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_7_71_31&#39;)"><span class="hl_fielddecl"><span class="mpre">stClientCertificateChain</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.X509.CertificateChain.html#loc_21_9_21_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_9_21_25&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateChain</span></span></a><span class="mpre">
    , </span><a name="loc_72_7_72_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_7_72_18&#39;)"><span class="hl_fielddecl"><span class="mpre">stRandomGen</span></span></a><span class="mpre">           :: </span><a href="Network.TLS.RNG.html#loc_9_6_9_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.RNG.html#loc_9_6_9_14&#39;)"><span class="hl_tyconref"><span class="mpre">StateRNG</span></span></a><span class="mpre">
    , </span><a name="loc_73_7_73_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_7_73_16&#39;)"><span class="hl_fielddecl"><span class="mpre">stVersion</span></span></a><span class="mpre">             :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">
    , </span><a name="loc_74_7_74_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_7_74_22&#39;)"><span class="hl_fielddecl"><span class="mpre">stClientContext</span></span></a><span class="mpre">       :: </span><a href="Network.TLS.Types.html#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Role</span></span></a><span class="mpre">
    }

newtype </span><a name="loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tycondecl"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_77_19_77_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_19_77_24&#39;)"><span class="hl_condecl"><span class="mpre">TLSSt</span></span></a><span class="mpre"> { </span><a name="loc_77_27_77_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_27_77_35&#39;)"><span class="hl_fielddecl"><span class="mpre">runTLSSt</span></span></a><span class="mpre"> :: </span><a href="Control.Monad.Trans.Error.html#loc_155_9_155_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Error.html#loc_155_9_155_15&#39;)"><span class="hl_tyconref"><span class="mpre">ErrorT</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_121_6_121_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_121_6_121_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSError</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">State</span></span><span class="mpre"> </span><a href="#loc_61_6_61_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSState</span></span></a><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> }
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 78, srcSpanStartColumn = 5, srcSpanEndLine = 78, srcSpanEndColumn = 64}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 78, srcSpanStartColumn = 5, srcSpanEndLine = 78, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 78, srcSpanSt"><span class="mpre">deriving (Monad, MonadError TLSError, Functor, Applicative)</span></span><span class="mpre">

instance </span><a href="Control.Monad.State.Class.html#loc_53_18_53_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_53_18_53_28&#39;)"><span class="hl_classref"><span class="mpre">MonadState</span></span></a><span class="mpre"> </span><a href="#loc_61_6_61_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSState</span></span></a><span class="mpre"> </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">put</span></span><span class="mpre"> </span><a name="loc_81_9_81_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_77_19_77_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_19_77_24&#39;)"><span class="hl_conref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> (</span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">put</span></span><span class="mpre"> </span><a href="#loc_81_9_81_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
    </span><span class="hl_vardecl"><span class="mpre">get</span></span><span class="mpre">   = </span><a href="#loc_77_19_77_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_19_77_24&#39;)"><span class="hl_conref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> (</span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">get</span></span><span class="mpre">)
#if MIN_VERSION_mtl(2,1,0)
    </span><span class="hl_fundecl"><span class="mpre">state</span></span><span class="mpre"> </span><a name="loc_84_11_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_11_84_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_77_19_77_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_19_77_24&#39;)"><span class="hl_conref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> (</span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">state</span></span><span class="mpre"> </span><a href="#loc_84_11_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_11_84_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
#endif

</span><a href="#loc_88_1_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_12&#39;)"><span class="mpre">runTLSState</span></a><span class="mpre"> :: </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_61_6_61_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSState</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_121_6_121_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_121_6_121_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSError</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><a href="#loc_61_6_61_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSState</span></span></a><span class="mpre">)
</span><a name="loc_88_1_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_12&#39;)"><span class="hl_fundecl"><span class="mpre">runTLSState</span></span></a><span class="mpre"> </span><a name="loc_88_13_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_13_88_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_88_15_88_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_15_88_17&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> = </span><a href="Control.Monad.Trans.State.Lazy.html#loc_98_1_98_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Lazy.html#loc_98_1_98_9&#39;)"><span class="hl_varref"><span class="mpre">runState</span></span></a><span class="mpre"> (</span><a href="Control.Monad.Trans.Error.html#loc_155_33_155_42" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Error.html#loc_155_33_155_42&#39;)"><span class="hl_varref"><span class="mpre">runErrorT</span></span></a><span class="mpre"> (</span><a href="#loc_77_27_77_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_27_77_35&#39;)"><span class="hl_varref"><span class="mpre">runTLSSt</span></span></a><span class="mpre"> </span><a href="#loc_88_13_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_13_88_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)) </span><a href="#loc_88_15_88_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_15_88_17&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">

</span><a href="#loc_91_1_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_12&#39;)"><span class="mpre">newTLSState</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 16, srcSpanEndLine = 90, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 23, srcSpanEndLine = 90, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/St"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Types.html#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Role</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_61_6_61_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSState</span></span></a><span class="mpre">
</span><a name="loc_91_1_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_12&#39;)"><span class="hl_fundecl"><span class="mpre">newTLSState</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">rng</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">clientContext</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 33, srcSpanEndLine = 105, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 5, srcSpanEndLine = 92, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 93, srcSpanS"><span class="mpre">TLSState
    { stSession             = Session Nothing
    , stSessionResuming     = False
    , stSecureRenegotiation = False
    , stClientVerifiedData  = B.empty
    , stServerVerifiedData  = B.empty
    , stExtensionNPN        = False
    , stHandshakeRecordCont = Nothing
    , stNegotiatedProtocol  = Nothing
    , stServerNextProtocolSuggest = Nothing
    , stClientCertificateChain = Nothing
    , stRandomGen           = StateRNG rng
    , stVersion             = Nothing
    , stClientContext       = clientContext
    }</span></span><span class="mpre">

</span><a href="#loc_108_1_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_19&#39;)"><span class="mpre">updateVerifiedData</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Role</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_108_1_108_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_19&#39;)"><span class="hl_fundecl"><span class="mpre">updateVerifiedData</span></span></a><span class="mpre"> </span><a name="loc_108_20_108_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_20_108_27&#39;)"><span class="hl_vardecl"><span class="mpre">sending</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">bs</span></span><span class="mpre"> = do
    </span><a name="loc_109_5_109_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_5_109_7&#39;)"><span class="hl_vardecl"><span class="mpre">cc</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_204_1_204_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_16&#39;)"><span class="hl_varref"><span class="mpre">isClientContext</span></span></a><span class="mpre">
    if </span><a href="#loc_109_5_109_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_5_109_7&#39;)"><span class="hl_varref"><span class="mpre">cc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_108_20_108_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_20_108_27&#39;)"><span class="hl_varref"><span class="mpre">sending</span></span></a><span class="mpre">
        then </span><a href="Control.Monad.State.Class.html#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_85_1_85_7&#39;)"><span class="hl_varref"><span class="mpre">modify</span></span></a><span class="mpre"> (\</span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 29, srcSpanEndLine = 111, srcSpanEndColumn = 61}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 32, srcSpanEndLine = 111, srcSpanEndColumn = 33},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 111, s"><span class="mpre">st { stServerVerifiedData = bs }</span></span><span class="mpre">)
        else </span><a href="Control.Monad.State.Class.html#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_85_1_85_7&#39;)"><span class="hl_varref"><span class="mpre">modify</span></span></a><span class="mpre"> (\</span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 112, srcSpanStartColumn = 29, srcSpanEndLine = 112, srcSpanEndColumn = 61}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 112, srcSpanStartColumn = 32, srcSpanEndLine = 112, srcSpanEndColumn = 33},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 112, s"><span class="mpre">st { stClientVerifiedData = bs }</span></span><span class="mpre">)

</span><a href="#loc_115_1_115_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_28&#39;)"><span class="mpre">finishHandshakeTypeMaterial</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_212_6_212_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_212_6_212_19&#39;)"><span class="hl_tyconref"><span class="mpre">HandshakeType</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_115_1_115_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_28&#39;)"><span class="hl_fundecl"><span class="mpre">finishHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_214_7_214_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_214_7_214_32&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ClientHello</span></span></a><span class="mpre">     = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_115_1_115_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_28&#39;)"><span class="hl_fundecl"><span class="mpre">finishHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_215_7_215_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_215_7_215_32&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ServerHello</span></span></a><span class="mpre">     = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_115_1_115_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_28&#39;)"><span class="hl_fundecl"><span class="mpre">finishHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_216_7_216_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_216_7_216_32&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_Certificate</span></span></a><span class="mpre">     = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_115_1_115_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_28&#39;)"><span class="hl_fundecl"><span class="mpre">finishHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_213_7_213_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_213_7_213_33&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_HelloRequest</span></span></a><span class="mpre">    = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_115_1_115_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_28&#39;)"><span class="hl_fundecl"><span class="mpre">finishHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_219_7_219_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_219_7_219_36&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ServerHelloDone</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_115_1_115_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_28&#39;)"><span class="hl_fundecl"><span class="mpre">finishHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_221_7_221_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_221_7_221_34&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ClientKeyXchg</span></span></a><span class="mpre">   = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_115_1_115_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_28&#39;)"><span class="hl_fundecl"><span class="mpre">finishHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_217_7_217_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_217_7_217_34&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ServerKeyXchg</span></span></a><span class="mpre">   = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_115_1_115_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_28&#39;)"><span class="hl_fundecl"><span class="mpre">finishHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_218_7_218_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_218_7_218_32&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_CertRequest</span></span></a><span class="mpre">     = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_115_1_115_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_28&#39;)"><span class="hl_fundecl"><span class="mpre">finishHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_220_7_220_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_220_7_220_31&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_CertVerify</span></span></a><span class="mpre">      = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_115_1_115_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_28&#39;)"><span class="hl_fundecl"><span class="mpre">finishHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_222_7_222_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_222_7_222_29&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_Finished</span></span></a><span class="mpre">        = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_115_1_115_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_28&#39;)"><span class="hl_fundecl"><span class="mpre">finishHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_223_7_223_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_223_7_223_24&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_NPN</span></span></a><span class="mpre">             = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

</span><a href="#loc_128_1_128_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_24&#39;)"><span class="mpre">finishHandshakeMaterial</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_128_1_128_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_24&#39;)"><span class="hl_vardecl"><span class="mpre">finishHandshakeMaterial</span></span></a><span class="mpre"> = </span><a href="#loc_115_1_115_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_28&#39;)"><span class="hl_varref"><span class="mpre">finishHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_273_1_273_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_273_1_273_16&#39;)"><span class="hl_varref"><span class="mpre">typeOfHandshake</span></span></a><span class="mpre">

</span><a href="#loc_131_1_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_32&#39;)"><span class="mpre">certVerifyHandshakeTypeMaterial</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_212_6_212_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_212_6_212_19&#39;)"><span class="hl_tyconref"><span class="mpre">HandshakeType</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_131_1_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_32&#39;)"><span class="hl_fundecl"><span class="mpre">certVerifyHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_214_7_214_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_214_7_214_32&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ClientHello</span></span></a><span class="mpre">     = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_131_1_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_32&#39;)"><span class="hl_fundecl"><span class="mpre">certVerifyHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_215_7_215_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_215_7_215_32&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ServerHello</span></span></a><span class="mpre">     = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_131_1_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_32&#39;)"><span class="hl_fundecl"><span class="mpre">certVerifyHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_216_7_216_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_216_7_216_32&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_Certificate</span></span></a><span class="mpre">     = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_131_1_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_32&#39;)"><span class="hl_fundecl"><span class="mpre">certVerifyHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_213_7_213_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_213_7_213_33&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_HelloRequest</span></span></a><span class="mpre">    = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_131_1_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_32&#39;)"><span class="hl_fundecl"><span class="mpre">certVerifyHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_219_7_219_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_219_7_219_36&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ServerHelloDone</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_131_1_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_32&#39;)"><span class="hl_fundecl"><span class="mpre">certVerifyHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_221_7_221_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_221_7_221_34&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ClientKeyXchg</span></span></a><span class="mpre">   = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_131_1_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_32&#39;)"><span class="hl_fundecl"><span class="mpre">certVerifyHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_217_7_217_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_217_7_217_34&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ServerKeyXchg</span></span></a><span class="mpre">   = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_131_1_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_32&#39;)"><span class="hl_fundecl"><span class="mpre">certVerifyHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_218_7_218_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_218_7_218_32&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_CertRequest</span></span></a><span class="mpre">     = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_131_1_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_32&#39;)"><span class="hl_fundecl"><span class="mpre">certVerifyHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_220_7_220_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_220_7_220_31&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_CertVerify</span></span></a><span class="mpre">      = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_131_1_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_32&#39;)"><span class="hl_fundecl"><span class="mpre">certVerifyHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_222_7_222_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_222_7_222_29&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_Finished</span></span></a><span class="mpre">        = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_131_1_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_32&#39;)"><span class="hl_fundecl"><span class="mpre">certVerifyHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_223_7_223_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_223_7_223_24&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_NPN</span></span></a><span class="mpre">             = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><a href="#loc_144_1_144_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_28&#39;)"><span class="mpre">certVerifyHandshakeMaterial</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_144_1_144_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_28&#39;)"><span class="hl_vardecl"><span class="mpre">certVerifyHandshakeMaterial</span></span></a><span class="mpre"> = </span><a href="#loc_131_1_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_32&#39;)"><span class="hl_varref"><span class="mpre">certVerifyHandshakeTypeMaterial</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_273_1_273_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_273_1_273_16&#39;)"><span class="hl_varref"><span class="mpre">typeOfHandshake</span></span></a><span class="mpre">

</span><a href="#loc_147_1_147_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_11&#39;)"><span class="mpre">setSession</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_161_9_161_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_161_9_161_16&#39;)"><span class="hl_tyconref"><span class="mpre">Session</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_147_1_147_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_11&#39;)"><span class="hl_fundecl"><span class="mpre">setSession</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">session</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">resuming</span></span><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_85_1_85_7&#39;)"><span class="hl_varref"><span class="mpre">modify</span></span></a><span class="mpre"> (\</span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 147, srcSpanStartColumn = 46, srcSpanEndLine = 147, srcSpanEndColumn = 102}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 147, srcSpanStartColumn = 49, srcSpanEndLine = 147, srcSpanEndColumn = 50},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 147, "><span class="mpre">st { stSession = session, stSessionResuming = resuming }</span></span><span class="mpre">)

</span><a href="#loc_150_1_150_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_11&#39;)"><span class="mpre">getSession</span></a><span class="mpre"> :: </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_161_9_161_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_161_9_161_16&#39;)"><span class="hl_tyconref"><span class="mpre">Session</span></span></a><span class="mpre">
</span><a name="loc_150_1_150_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_11&#39;)"><span class="hl_vardecl"><span class="mpre">getSession</span></span></a><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="#loc_62_7_62_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_16&#39;)"><span class="hl_varref"><span class="mpre">stSession</span></span></a><span class="mpre">

</span><a href="#loc_153_1_153_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_18&#39;)"><span class="mpre">isSessionResuming</span></a><span class="mpre"> :: </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_153_1_153_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_1_153_18&#39;)"><span class="hl_vardecl"><span class="mpre">isSessionResuming</span></span></a><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="#loc_63_7_63_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_7_63_24&#39;)"><span class="hl_varref"><span class="mpre">stSessionResuming</span></span></a><span class="mpre">

</span><a href="#loc_156_1_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_11&#39;)"><span class="mpre">setVersion</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_156_1_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_11&#39;)"><span class="hl_fundecl"><span class="mpre">setVersion</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ver</span></span><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_85_1_85_7&#39;)"><span class="hl_varref"><span class="mpre">modify</span></span></a><span class="mpre"> (\</span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 156, srcSpanStartColumn = 33, srcSpanEndLine = 156, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 156, srcSpanStartColumn = 36, srcSpanEndLine = 156, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 156, s"><span class="mpre">st { stVersion = Just ver }</span></span><span class="mpre">)

</span><a href="#loc_159_1_159_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_18&#39;)"><span class="mpre">setVersionIfUnset</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_159_1_159_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_18&#39;)"><span class="hl_fundecl"><span class="mpre">setVersionIfUnset</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ver</span></span><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_85_1_85_7&#39;)"><span class="hl_varref"><span class="mpre">modify</span></span></a><span class="mpre"> </span><a href="#loc_160_9_160_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_17&#39;)"><span class="hl_varref"><span class="mpre">maybeSet</span></span></a><span class="mpre">
  where </span><a name="loc_160_9_160_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_17&#39;)"><span class="hl_fundecl"><span class="mpre">maybeSet</span></span></a><span class="mpre"> </span><a name="loc_160_18_160_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_18_160_20&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> = case </span><a href="#loc_73_7_73_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_7_73_16&#39;)"><span class="hl_varref"><span class="mpre">stVersion</span></span></a><span class="mpre"> </span><a href="#loc_160_18_160_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_18_160_20&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> of
                           </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 161, srcSpanStartColumn = 39, srcSpanEndLine = 161, srcSpanEndColumn = 66}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 161, srcSpanStartColumn = 42, srcSpanEndLine = 161, srcSpanEndColumn = 43},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 161, s"><span class="mpre">st { stVersion = Just ver }</span></span><span class="mpre">
                           </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> _  -&gt; </span><a href="#loc_160_18_160_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_18_160_20&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">

</span><a href="#loc_165_1_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_11&#39;)"><span class="mpre">getVersion</span></a><span class="mpre"> :: </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">
</span><a name="loc_165_1_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_11&#39;)"><span class="hl_vardecl"><span class="mpre">getVersion</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;internal error: version hasn&#39;t been set yet&quot;</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Control.Monad.State.Class.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="#loc_73_7_73_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_7_73_16&#39;)"><span class="hl_varref"><span class="mpre">stVersion</span></span></a><span class="mpre">

</span><a href="#loc_168_1_168_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_22&#39;)"><span class="mpre">getVersionWithDefault</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">
</span><a name="loc_168_1_168_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_22&#39;)"><span class="hl_fundecl"><span class="mpre">getVersionWithDefault</span></span></a><span class="mpre"> </span><a name="loc_168_23_168_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_23_168_33&#39;)"><span class="hl_vardecl"><span class="mpre">defaultVer</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><a href="#loc_168_23_168_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_23_168_33&#39;)"><span class="hl_varref"><span class="mpre">defaultVer</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Control.Monad.State.Class.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="#loc_73_7_73_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_7_73_16&#39;)"><span class="hl_varref"><span class="mpre">stVersion</span></span></a><span class="mpre">

</span><a href="#loc_171_1_171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_23&#39;)"><span class="mpre">setSecureRenegotiation</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_171_1_171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_23&#39;)"><span class="hl_fundecl"><span class="mpre">setSecureRenegotiation</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">b</span></span><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_85_1_85_7&#39;)"><span class="hl_varref"><span class="mpre">modify</span></span></a><span class="mpre"> (\</span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 171, srcSpanStartColumn = 43, srcSpanEndLine = 171, srcSpanEndColumn = 75}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 171, srcSpanStartColumn = 46, srcSpanEndLine = 171, srcSpanEndColumn = 47},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 171, s"><span class="mpre">st { stSecureRenegotiation = b }</span></span><span class="mpre">)

</span><a href="#loc_174_1_174_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_23&#39;)"><span class="mpre">getSecureRenegotiation</span></a><span class="mpre"> :: </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_174_1_174_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_23&#39;)"><span class="hl_vardecl"><span class="mpre">getSecureRenegotiation</span></span></a><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="#loc_64_7_64_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_7_64_28&#39;)"><span class="hl_varref"><span class="mpre">stSecureRenegotiation</span></span></a><span class="mpre">

</span><a href="#loc_177_1_177_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_16&#39;)"><span class="mpre">setExtensionNPN</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_177_1_177_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_16&#39;)"><span class="hl_fundecl"><span class="mpre">setExtensionNPN</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">b</span></span><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_85_1_85_7&#39;)"><span class="hl_varref"><span class="mpre">modify</span></span></a><span class="mpre"> (\</span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 177, srcSpanStartColumn = 36, srcSpanEndLine = 177, srcSpanEndColumn = 61}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 177, srcSpanStartColumn = 39, srcSpanEndLine = 177, srcSpanEndColumn = 40},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 177, s"><span class="mpre">st { stExtensionNPN = b }</span></span><span class="mpre">)

</span><a href="#loc_180_1_180_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_1_180_16&#39;)"><span class="mpre">getExtensionNPN</span></a><span class="mpre"> :: </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_180_1_180_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_1_180_16&#39;)"><span class="hl_vardecl"><span class="mpre">getExtensionNPN</span></span></a><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="#loc_67_7_67_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_7_67_21&#39;)"><span class="hl_varref"><span class="mpre">stExtensionNPN</span></span></a><span class="mpre">

</span><a href="#loc_183_1_183_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_22&#39;)"><span class="mpre">setNegotiatedProtocol</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_183_1_183_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_22&#39;)"><span class="hl_fundecl"><span class="mpre">setNegotiatedProtocol</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">s</span></span><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_85_1_85_7&#39;)"><span class="hl_varref"><span class="mpre">modify</span></span></a><span class="mpre"> (\</span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 183, srcSpanStartColumn = 42, srcSpanEndLine = 183, srcSpanEndColumn = 78}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 183, srcSpanStartColumn = 45, srcSpanEndLine = 183, srcSpanEndColumn = 46},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 183, s"><span class="mpre">st { stNegotiatedProtocol = Just s }</span></span><span class="mpre">)

</span><a href="#loc_186_1_186_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_22&#39;)"><span class="mpre">getNegotiatedProtocol</span></a><span class="mpre"> :: </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
</span><a name="loc_186_1_186_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_22&#39;)"><span class="hl_vardecl"><span class="mpre">getNegotiatedProtocol</span></span></a><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="#loc_69_7_69_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_7_69_27&#39;)"><span class="hl_varref"><span class="mpre">stNegotiatedProtocol</span></span></a><span class="mpre">

</span><a href="#loc_189_1_189_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_29&#39;)"><span class="mpre">setServerNextProtocolSuggest</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">] -&gt; </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_189_1_189_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_29&#39;)"><span class="hl_fundecl"><span class="mpre">setServerNextProtocolSuggest</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ps</span></span><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_85_1_85_7&#39;)"><span class="hl_varref"><span class="mpre">modify</span></span></a><span class="mpre"> (\</span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 189, srcSpanStartColumn = 50, srcSpanEndLine = 189, srcSpanEndColumn = 93}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 189, srcSpanStartColumn = 53, srcSpanEndLine = 189, srcSpanEndColumn = 54},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 189, s"><span class="mpre">st { stServerNextProtocolSuggest = Just ps}</span></span><span class="mpre">)

</span><a href="#loc_192_1_192_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_29&#39;)"><span class="mpre">getServerNextProtocolSuggest</span></a><span class="mpre"> :: </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">])
</span><a name="loc_192_1_192_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_29&#39;)"><span class="hl_vardecl"><span class="mpre">getServerNextProtocolSuggest</span></span></a><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="#loc_70_7_70_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_7_70_34&#39;)"><span class="hl_varref"><span class="mpre">stServerNextProtocolSuggest</span></span></a><span class="mpre">

</span><a href="#loc_195_1_195_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_26&#39;)"><span class="mpre">setClientCertificateChain</span></a><span class="mpre"> :: </span><a href="Data.X509.CertificateChain.html#loc_21_9_21_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_9_21_25&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_195_1_195_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_1_195_26&#39;)"><span class="hl_fundecl"><span class="mpre">setClientCertificateChain</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">s</span></span><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_85_1_85_7&#39;)"><span class="hl_varref"><span class="mpre">modify</span></span></a><span class="mpre"> (\</span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 195, srcSpanStartColumn = 46, srcSpanEndLine = 195, srcSpanEndColumn = 86}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 195, srcSpanStartColumn = 49, srcSpanEndLine = 195, srcSpanEndColumn = 50},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 195, s"><span class="mpre">st { stClientCertificateChain = Just s }</span></span><span class="mpre">)

</span><a href="#loc_198_1_198_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_26&#39;)"><span class="mpre">getClientCertificateChain</span></a><span class="mpre"> :: </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.X509.CertificateChain.html#loc_21_9_21_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_9_21_25&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateChain</span></span></a><span class="mpre">)
</span><a name="loc_198_1_198_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_26&#39;)"><span class="hl_vardecl"><span class="mpre">getClientCertificateChain</span></span></a><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="#loc_71_7_71_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_7_71_31&#39;)"><span class="hl_varref"><span class="mpre">stClientCertificateChain</span></span></a><span class="mpre">

</span><a href="#loc_201_1_201_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_16&#39;)"><span class="mpre">getVerifiedData</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Role</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_201_1_201_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_16&#39;)"><span class="hl_fundecl"><span class="mpre">getVerifiedData</span></span></a><span class="mpre"> </span><a name="loc_201_17_201_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_17_201_23&#39;)"><span class="hl_vardecl"><span class="mpre">client</span></span></a><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> (if </span><a href="#loc_201_17_201_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_17_201_23&#39;)"><span class="hl_varref"><span class="mpre">client</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Network.TLS.Types.html#loc_44_13_44_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_44_13_44_23&#39;)"><span class="hl_conref"><span class="mpre">ClientRole</span></span></a><span class="mpre"> then </span><a href="#loc_65_7_65_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_7_65_27&#39;)"><span class="hl_varref"><span class="mpre">stClientVerifiedData</span></span></a><span class="mpre"> else </span><a href="#loc_66_7_66_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_7_66_27&#39;)"><span class="hl_varref"><span class="mpre">stServerVerifiedData</span></span></a><span class="mpre">)

</span><a href="#loc_204_1_204_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_16&#39;)"><span class="mpre">isClientContext</span></a><span class="mpre"> :: </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><a href="Network.TLS.Types.html#loc_44_6_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_44_6_44_10&#39;)"><span class="hl_tyconref"><span class="mpre">Role</span></span></a><span class="mpre">
</span><a name="loc_204_1_204_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_1_204_16&#39;)"><span class="hl_vardecl"><span class="mpre">isClientContext</span></span></a><span class="mpre"> = </span><a href="Control.Monad.State.Class.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">gets</span></span></a><span class="mpre"> </span><a href="#loc_74_7_74_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_7_74_22&#39;)"><span class="hl_varref"><span class="mpre">stClientContext</span></span></a><span class="mpre">

</span><a href="#loc_207_1_207_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_1_207_10&#39;)"><span class="mpre">genRandom</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_207_1_207_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_1_207_10&#39;)"><span class="hl_fundecl"><span class="mpre">genRandom</span></span></a><span class="mpre"> </span><a name="loc_207_11_207_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_11_207_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = do
    </span><a name="loc_208_5_208_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_5_208_7&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">get</span></span><span class="mpre">
    case </span><a href="Network.TLS.RNG.html#loc_15_1_15_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.RNG.html#loc_15_1_15_11&#39;)"><span class="hl_varref"><span class="mpre">withTLSRNG</span></span></a><span class="mpre"> (</span><a href="#loc_72_7_72_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_7_72_18&#39;)"><span class="hl_varref"><span class="mpre">stRandomGen</span></span></a><span class="mpre"> </span><a href="#loc_208_5_208_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_5_208_7&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">cprgGenerate</span></span><span class="mpre"> </span><a href="#loc_207_11_207_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_11_207_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) of
            (</span><a name="loc_210_14_210_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_14_210_19&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">put</span></span><span class="mpre"> (</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 210, srcSpanStartColumn = 35, srcSpanEndLine = 210, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 210, srcSpanStartColumn = 38, srcSpanEndLine = 210, srcSpanEndColumn = 39},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 210, s"><span class="mpre">st { stRandomGen = rng&#39; }</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_210_14_210_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_14_210_19&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">

</span><a href="#loc_213_1_213_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_8&#39;)"><span class="mpre">withRNG</span></a><span class="mpre"> :: (forall </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> . </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 212, srcSpanStartColumn = 24, srcSpanEndLine = 212, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 212, srcSpanStartColumn = 31, srcSpanEndLine = 212, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TL"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)) -&gt; </span><a href="#loc_77_9_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSt</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_213_1_213_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_1_213_8&#39;)"><span class="hl_fundecl"><span class="mpre">withRNG</span></span></a><span class="mpre"> </span><a name="loc_213_9_213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_9_213_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
    </span><a name="loc_214_5_214_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_5_214_7&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">get</span></span><span class="mpre">
    let (</span><a name="loc_215_10_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_10_215_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span><span class="mpre">) = </span><a href="Network.TLS.RNG.html#loc_15_1_15_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.RNG.html#loc_15_1_15_11&#39;)"><span class="hl_varref"><span class="mpre">withTLSRNG</span></span></a><span class="mpre"> (</span><a href="#loc_72_7_72_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_7_72_18&#39;)"><span class="hl_varref"><span class="mpre">stRandomGen</span></span></a><span class="mpre"> </span><a href="#loc_214_5_214_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_5_214_7&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">) </span><a href="#loc_213_9_213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_9_213_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">put</span></span><span class="mpre"> (</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 216, srcSpanStartColumn = 10, srcSpanEndLine = 216, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 216, srcSpanStartColumn = 13, srcSpanEndLine = 216, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/State.hs&quot;, srcSpanStartLine = 216, s"><span class="mpre">st { stRandomGen = rng&#39; }</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_215_10_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_10_215_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
</span></div></body></html>