<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, DeriveDataTypeable, FlexibleInstances, ScopedTypeVariables #-}
#if __GLASGOW_HASKELL__ &gt;= 703
{-# LANGUAGE Trustworthy #-}
#endif
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : judah.jacobson@gmail.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : portable (FFI)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module provides a low-level interface to the C functions of the </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- terminfo library. </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- NOTE: Since this library is built on top of the curses interface, it is not thread-safe.</span></span><span class="mpre">

module System.Console.Terminfo.Base(
                            </span><span class="hl_comment"><span class="mpre">-- *  Initialization</span></span><span class="mpre">
                            Terminal(),
                            setupTerm,
                            setupTermFromEnv,
                            SetupTermError,
                            </span><span class="hl_comment"><span class="mpre">-- * Capabilities</span></span><span class="mpre">
                            Capability,
                            getCapability,
                            tiGetFlag,
                            tiGuardFlag,
                            tiGetNum,
                            tiGetStr,
                            </span><span class="hl_comment"><span class="mpre">-- * Output</span></span><span class="mpre">
                            </span><span class="hl_comment"><span class="mpre">-- $outputdoc</span></span><span class="mpre">
                            tiGetOutput1,
                            OutputCap,
                            TermStr,
                            </span><span class="hl_comment"><span class="mpre">-- ** TermOutput</span></span><span class="mpre">
                            TermOutput(),
                            runTermOutput,
                            hRunTermOutput,
                            termText,
                            tiGetOutput,
                            LinesAffected,
                            </span><span class="hl_comment"><span class="mpre">-- ** Monoid functions</span></span><span class="mpre">
                            Monoid(..),
                            (&lt;#&gt;),
                            ) where


import Control.Applicative
import Control.Monad
import Data.Monoid
import Foreign.C
import Foreign.ForeignPtr
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 8, srcSpanEndLine = 51, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;Foreign.Ptr&quot;"><span class="mpre">Foreign.Ptr</span></span><span class="mpre">
import Foreign.Marshal
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 8, srcSpanEndLine = 53, srcSpanEndColumn = 24}, srcInfoPoints = []}) &quot;Foreign.Storable&quot;"><span class="mpre">Foreign.Storable</span></span><span class="mpre"> (peek,poke)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 54, srcSpanStartColumn = 8, srcSpanEndLine = 54, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;System.Environment&quot;"><span class="mpre">System.Environment</span></span><span class="mpre"> (getEnv)
import System.IO.Unsafe (</span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="mpre">unsafePerformIO</span></a><span class="mpre">)
import System.IO
import Control.Exception
import Data.Typeable


data </span><a name="loc_61_6_61_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_14&#39;)"><span class="hl_tycondecl"><span class="mpre">TERMINAL</span></span></a><span class="mpre">
newtype </span><a name="loc_62_9_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_17&#39;)"><span class="hl_tycondecl"><span class="mpre">Terminal</span></span></a><span class="mpre"> = </span><a name="loc_62_20_62_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_20_62_28&#39;)"><span class="hl_condecl"><span class="mpre">Terminal</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span><span class="mpre"> </span><a href="#loc_61_6_61_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_6_61_14&#39;)"><span class="hl_tyconref"><span class="mpre">TERMINAL</span></span></a><span class="mpre">)

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 1, srcSpanEndLine = 64, srcSpanEndColumn = 56}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 1, srcSpanEndLine = 64, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/"><span class="mpre">foreign import ccall &quot;&amp;&quot; cur_term :: Ptr (Ptr TERMINAL)</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 1, srcSpanEndLine = 65, srcSpanEndColumn = 70}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 1, srcSpanEndLine = 65, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/"><span class="mpre">foreign import ccall set_curterm :: Ptr TERMINAL -&gt; IO (Ptr TERMINAL)</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 66, srcSpanStartColumn = 1, srcSpanEndLine = 66, srcSpanEndColumn = 71}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 66, srcSpanStartColumn = 1, srcSpanEndLine = 66, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/"><span class="mpre">foreign import ccall &quot;&amp;&quot; del_curterm :: FunPtr (Ptr TERMINAL -&gt; IO ())</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 1, srcSpanEndLine = 68, srcSpanEndColumn = 71}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 1, srcSpanEndLine = 68, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/"><span class="mpre">foreign import ccall setupterm :: CString -&gt; CInt -&gt; Ptr CInt -&gt; IO ()</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Initialize the terminfo library to the given terminal entry.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Throws a &#39;SetupTermError&#39; if the terminfo database could not be read.</span></span><span class="mpre">
</span><a href="#loc_74_1_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_10&#39;)"><span class="mpre">setupTerm</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_62_9_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_17&#39;)"><span class="hl_tyconref"><span class="mpre">Terminal</span></span></a><span class="mpre">
</span><a name="loc_74_1_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_10&#39;)"><span class="hl_fundecl"><span class="mpre">setupTerm</span></span></a><span class="mpre"> </span><a name="loc_74_11_74_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_11_74_15&#39;)"><span class="hl_vardecl"><span class="mpre">term</span></span></a><span class="mpre"> = </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">bracket</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">cur_term</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">cur_term</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ -&gt; 
    </span><a href="Foreign.C.String.html#loc_176_1_176_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.String.html#loc_176_1_176_12&#39;)"><span class="hl_varref"><span class="mpre">withCString</span></span></a><span class="mpre"> </span><a href="#loc_74_11_74_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_11_74_15&#39;)"><span class="hl_varref"><span class="mpre">term</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_75_25_75_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_25_75_31&#39;)"><span class="hl_vardecl"><span class="mpre">c_term</span></span></a><span class="mpre"> -&gt;
    </span><a href="Foreign.Marshal.Utils.html#loc_84_1_84_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Utils.html#loc_84_1_84_5&#39;)"><span class="hl_varref"><span class="mpre">with</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_76_15_76_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_15_76_22&#39;)"><span class="hl_vardecl"><span class="mpre">ret_ptr</span></span></a><span class="mpre"> -&gt; do
        </span><span class="hl_comment"><span class="mpre">-- NOTE: I believe that for the way we use terminfo</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- (i.e. custom output function)</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- this parameter does not affect anything.</span></span><span class="mpre">
        let </span><a name="loc_80_13_80_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_13_80_22&#39;)"><span class="hl_vardecl"><span class="mpre">stdOutput</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">{-- Force ncurses to return a new struct rather than
        a copy of the current one (which it would do if the
        terminal names are the same).  This prevents problems
        when calling del_term on a struct shared by more than one
        Terminal. --}</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">cur_term</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- Call setupterm and check the return value.</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">setupterm</span></span><span class="mpre"> </span><a href="#loc_75_25_75_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_25_75_31&#39;)"><span class="hl_varref"><span class="mpre">c_term</span></span></a><span class="mpre"> </span><a href="#loc_80_13_80_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_13_80_22&#39;)"><span class="hl_varref"><span class="mpre">stdOutput</span></span></a><span class="mpre"> </span><a href="#loc_76_15_76_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_15_76_22&#39;)"><span class="hl_varref"><span class="mpre">ret_ptr</span></span></a><span class="mpre">
        </span><a name="loc_89_9_89_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_9_89_12&#39;)"><span class="hl_vardecl"><span class="mpre">ret</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><a href="#loc_76_15_76_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_15_76_22&#39;)"><span class="hl_varref"><span class="mpre">ret_ptr</span></span></a><span class="mpre">
        if (</span><a href="#loc_89_9_89_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_9_89_12&#39;)"><span class="hl_varref"><span class="mpre">ret</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
            then </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_97_23_97_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_23_97_37&#39;)"><span class="hl_conref"><span class="mpre">SetupTermError</span></span></a><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Couldn&#39;t look up terminfo entry &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_74_11_74_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_11_74_15&#39;)"><span class="hl_varref"><span class="mpre">term</span></span></a><span class="mpre">
            else do
                </span><a name="loc_94_17_94_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_17_94_22&#39;)"><span class="hl_vardecl"><span class="mpre">cterm</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">cur_term</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_62_20_62_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_20_62_28&#39;)"><span class="hl_conref"><span class="mpre">Terminal</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">newForeignPtr</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">del_curterm</span></span><span class="mpre"> </span><a href="#loc_94_17_94_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_17_94_22&#39;)"><span class="hl_varref"><span class="mpre">cterm</span></span></a><span class="mpre">

data </span><a name="loc_97_6_97_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_20&#39;)"><span class="hl_tycondecl"><span class="mpre">SetupTermError</span></span></a><span class="mpre"> = </span><a name="loc_97_23_97_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_23_97_37&#39;)"><span class="hl_condecl"><span class="mpre">SetupTermError</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 25, srcSpanEndLine = 98, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 25, srcSpanEndLine = 98, srcSpanEndColumn = 33}]}) [IHead (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/n"><span class="mpre">deriving Typeable</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_97_6_97_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_20&#39;)"><span class="hl_tyconref"><span class="mpre">SetupTermError</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_97_23_97_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_23_97_37&#39;)"><span class="hl_conref"><span class="mpre">SetupTermError</span></span></a><span class="mpre"> </span><a name="loc_101_26_101_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_26_101_29&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">) = </span><span class="hl_string"><span class="mpre">&quot;setupTerm: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_101_26_101_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_26_101_29&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Exception</span></span><span class="mpre"> </span><a href="#loc_97_6_97_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_6_97_20&#39;)"><span class="hl_tyconref"><span class="mpre">SetupTermError</span></span></a><span class="mpre"> where

</span><span class="hl_comment"><span class="mpre">-- | Initialize the terminfo library, using the @TERM@ environmental variable.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If @TERM@ is not set, we use the generic, minimal entry @dumb@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Throws a &#39;SetupTermError&#39; if the terminfo database could not be read.</span></span><span class="mpre">
</span><a href="#loc_110_1_110_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_17&#39;)"><span class="mpre">setupTermFromEnv</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_62_9_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_17&#39;)"><span class="hl_tyconref"><span class="mpre">Terminal</span></span></a><span class="mpre">
</span><a name="loc_110_1_110_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_17&#39;)"><span class="hl_vardecl"><span class="mpre">setupTermFromEnv</span></span></a><span class="mpre"> = do
    </span><a name="loc_111_5_111_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_5_111_13&#39;)"><span class="hl_vardecl"><span class="mpre">env_term</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Exception.Base.html#loc_181_1_181_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_181_1_181_7&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre"> </span><a href="#loc_116_5_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_5_116_17&#39;)"><span class="hl_varref"><span class="mpre">handleBadEnv</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">getEnv</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;TERM&quot;</span></span><span class="mpre"> 
    let </span><a name="loc_112_9_112_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_13&#39;)"><span class="hl_vardecl"><span class="mpre">term</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_111_5_111_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_5_111_13&#39;)"><span class="hl_varref"><span class="mpre">env_term</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;dumb&quot;</span></span><span class="mpre"> else </span><a href="#loc_111_5_111_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_5_111_13&#39;)"><span class="hl_varref"><span class="mpre">env_term</span></span></a><span class="mpre">
    </span><a href="#loc_74_1_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_10&#39;)"><span class="hl_varref"><span class="mpre">setupTerm</span></span></a><span class="mpre"> </span><a href="#loc_112_9_112_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_13&#39;)"><span class="hl_varref"><span class="mpre">term</span></span></a><span class="mpre">
  where
    </span><a href="#loc_116_5_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_5_116_17&#39;)"><span class="mpre">handleBadEnv</span></a><span class="mpre"> :: </span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">IOException</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    </span><a name="loc_116_5_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_5_116_17&#39;)"><span class="hl_fundecl"><span class="mpre">handleBadEnv</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- TODO: this isn&#39;t really thread-safe...</span></span><span class="mpre">
</span><a href="#loc_120_1_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_12&#39;)"><span class="mpre">withCurTerm</span></a><span class="mpre"> :: </span><a href="#loc_62_9_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_17&#39;)"><span class="hl_tyconref"><span class="mpre">Terminal</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_120_1_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_12&#39;)"><span class="hl_fundecl"><span class="mpre">withCurTerm</span></span></a><span class="mpre"> (</span><a href="#loc_62_20_62_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_20_62_28&#39;)"><span class="hl_conref"><span class="mpre">Terminal</span></span></a><span class="mpre"> </span><a name="loc_120_23_120_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_23_120_27&#39;)"><span class="hl_vardecl"><span class="mpre">term</span></span></a><span class="mpre">) </span><a name="loc_120_29_120_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_29_120_30&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_120_23_120_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_23_120_27&#39;)"><span class="hl_varref"><span class="mpre">term</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_120_56_120_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_56_120_61&#39;)"><span class="hl_vardecl"><span class="mpre">cterm</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_121_9_121_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_17&#39;)"><span class="hl_vardecl"><span class="mpre">old_term</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">cur_term</span></span><span class="mpre">
        if </span><a href="#loc_121_9_121_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_17&#39;)"><span class="hl_varref"><span class="mpre">old_term</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_120_56_120_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_56_120_61&#39;)"><span class="hl_varref"><span class="mpre">cterm</span></span></a><span class="mpre">
            then do
                    _ &lt;- </span><span class="hl_varref"><span class="mpre">set_curterm</span></span><span class="mpre"> </span><a href="#loc_120_56_120_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_56_120_61&#39;)"><span class="hl_varref"><span class="mpre">cterm</span></span></a><span class="mpre">
                    </span><a name="loc_125_21_125_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_21_125_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_120_29_120_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_29_120_30&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
                    _ &lt;- </span><span class="hl_varref"><span class="mpre">set_curterm</span></span><span class="mpre"> </span><a href="#loc_121_9_121_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_17&#39;)"><span class="hl_varref"><span class="mpre">old_term</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_125_21_125_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_21_125_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
            else </span><a href="#loc_120_29_120_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_29_120_30&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">----------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Note I&#39;m relying on this working even for strings with unset parameters.</span></span><span class="mpre">
</span><a href="#loc_135_1_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_14&#39;)"><span class="mpre">strHasPadding</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_135_1_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_14&#39;)"><span class="hl_fundecl"><span class="mpre">strHasPadding</span></span></a><span class="mpre"> [] = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_135_1_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_14&#39;)"><span class="hl_fundecl"><span class="mpre">strHasPadding</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;$&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;&lt;&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_135_1_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_14&#39;)"><span class="hl_fundecl"><span class="mpre">strHasPadding</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_137_18_137_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_18_137_20&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) = </span><a href="#loc_135_1_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_14&#39;)"><span class="hl_varref"><span class="mpre">strHasPadding</span></span></a><span class="mpre"> </span><a href="#loc_137_18_137_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_18_137_20&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | An action which sends output to the terminal.  That output may mix plain text with control</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- characters and escape sequences, along with delays (called \&quot;padding\&quot;) required by some older</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- terminals.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- We structure this similarly to ShowS, so that appends don&#39;t cause space leaks.</span></span><span class="mpre">
newtype </span><a name="loc_144_9_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_19&#39;)"><span class="hl_tycondecl"><span class="mpre">TermOutput</span></span></a><span class="mpre"> = </span><a name="loc_144_22_144_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_22_144_32&#39;)"><span class="hl_condecl"><span class="mpre">TermOutput</span></span></a><span class="mpre"> ([</span><a href="#loc_146_6_146_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_20&#39;)"><span class="hl_tyconref"><span class="mpre">TermOutputType</span></span></a><span class="mpre">] -&gt; [</span><a href="#loc_146_6_146_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_20&#39;)"><span class="hl_tyconref"><span class="mpre">TermOutputType</span></span></a><span class="mpre">])

data </span><a name="loc_146_6_146_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_20&#39;)"><span class="hl_tycondecl"><span class="mpre">TermOutputType</span></span></a><span class="mpre"> = </span><a name="loc_146_23_146_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_23_146_28&#39;)"><span class="hl_condecl"><span class="mpre">TOCmd</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">LinesAffected</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                    | </span><a name="loc_147_23_147_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_23_147_28&#39;)"><span class="hl_condecl"><span class="mpre">TOStr</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">

instance </span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="hl_classref"><span class="mpre">Monoid</span></span></a><span class="mpre"> </span><a href="#loc_144_9_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_19&#39;)"><span class="hl_tyconref"><span class="mpre">TermOutput</span></span></a><span class="mpre"> where
    </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">mempty</span></span></a><span class="mpre"> = </span><a href="#loc_144_22_144_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_22_144_32&#39;)"><span class="hl_conref"><span class="mpre">TermOutput</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
    </span><a href="#loc_144_22_144_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_22_144_32&#39;)"><span class="hl_conref"><span class="mpre">TermOutput</span></span></a><span class="mpre"> </span><a name="loc_151_16_151_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_16_151_18&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_144_22_144_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_22_144_32&#39;)"><span class="hl_conref"><span class="mpre">TermOutput</span></span></a><span class="mpre"> </span><a name="loc_151_40_151_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_40_151_42&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre"> = </span><a href="#loc_144_22_144_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_22_144_32&#39;)"><span class="hl_conref"><span class="mpre">TermOutput</span></span></a><span class="mpre"> (</span><a href="#loc_151_16_151_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_16_151_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_151_40_151_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_40_151_42&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">)

</span><a href="#loc_154_1_154_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_9&#39;)"><span class="mpre">termText</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_144_9_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_19&#39;)"><span class="hl_tyconref"><span class="mpre">TermOutput</span></span></a><span class="mpre"> 
</span><a name="loc_154_1_154_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_9&#39;)"><span class="hl_fundecl"><span class="mpre">termText</span></span></a><span class="mpre"> </span><a name="loc_154_10_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_10_154_13&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = </span><a href="#loc_144_22_144_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_22_144_32&#39;)"><span class="hl_conref"><span class="mpre">TermOutput</span></span></a><span class="mpre"> (</span><a href="#loc_147_23_147_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_23_147_28&#39;)"><span class="hl_conref"><span class="mpre">TOStr</span></span></a><span class="mpre"> </span><a href="#loc_154_10_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_10_154_13&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Write the terminal output to the standard output device.</span></span><span class="mpre">
</span><a href="#loc_158_1_158_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_14&#39;)"><span class="mpre">runTermOutput</span></a><span class="mpre"> :: </span><a href="#loc_62_9_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_17&#39;)"><span class="hl_tyconref"><span class="mpre">Terminal</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_144_9_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_19&#39;)"><span class="hl_tyconref"><span class="mpre">TermOutput</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_158_1_158_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_14&#39;)"><span class="hl_vardecl"><span class="mpre">runTermOutput</span></span></a><span class="mpre"> = </span><a href="#loc_163_1_163_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_15&#39;)"><span class="hl_varref"><span class="mpre">hRunTermOutput</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write the terminal output to the terminal or file managed by the given</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Handle&#39;.</span></span><span class="mpre">
</span><a href="#loc_163_1_163_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_15&#39;)"><span class="mpre">hRunTermOutput</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Handle</span></span><span class="mpre"> -&gt; </span><a href="#loc_62_9_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_17&#39;)"><span class="hl_tyconref"><span class="mpre">Terminal</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_144_9_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_19&#39;)"><span class="hl_tyconref"><span class="mpre">TermOutput</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_163_1_163_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_15&#39;)"><span class="hl_fundecl"><span class="mpre">hRunTermOutput</span></span></a><span class="mpre"> </span><a name="loc_163_16_163_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_16_163_17&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_163_18_163_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_18_163_22&#39;)"><span class="hl_vardecl"><span class="mpre">term</span></span></a><span class="mpre"> (</span><a href="#loc_144_22_144_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_22_144_32&#39;)"><span class="hl_conref"><span class="mpre">TermOutput</span></span></a><span class="mpre"> </span><a name="loc_163_35_163_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_35_163_37&#39;)"><span class="hl_vardecl"><span class="mpre">to</span></span></a><span class="mpre">) = do
    </span><a name="loc_164_5_164_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_5_164_13&#39;)"><span class="hl_vardecl"><span class="mpre">putc_ptr</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">mkCallback</span></span><span class="mpre"> </span><a href="#loc_169_5_169_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_5_169_9&#39;)"><span class="hl_varref"><span class="mpre">putc</span></span></a><span class="mpre">
    </span><a href="#loc_120_1_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_12&#39;)"><span class="hl_varref"><span class="mpre">withCurTerm</span></span></a><span class="mpre"> </span><a href="#loc_163_18_163_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_18_163_22&#39;)"><span class="hl_varref"><span class="mpre">term</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (</span><a href="#loc_175_1_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_12&#39;)"><span class="hl_varref"><span class="mpre">writeToTerm</span></span></a><span class="mpre"> </span><a href="#loc_164_5_164_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_5_164_13&#39;)"><span class="hl_varref"><span class="mpre">putc_ptr</span></span></a><span class="mpre"> </span><a href="#loc_163_16_163_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_16_163_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) (</span><a href="#loc_163_35_163_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_35_163_37&#39;)"><span class="hl_varref"><span class="mpre">to</span></span></a><span class="mpre"> [])
    </span><span class="hl_varref"><span class="mpre">freeHaskellFunPtr</span></span><span class="mpre"> </span><a href="#loc_164_5_164_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_5_164_13&#39;)"><span class="hl_varref"><span class="mpre">putc_ptr</span></span></a><span class="mpre">
    </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">hFlush</span></span></a><span class="mpre"> </span><a href="#loc_163_16_163_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_16_163_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
  where
    </span><a name="loc_169_5_169_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_5_169_9&#39;)"><span class="hl_fundecl"><span class="mpre">putc</span></span></a><span class="mpre"> </span><a name="loc_169_10_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_10_169_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = let </span><a name="loc_169_18_169_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_18_169_20&#39;)"><span class="hl_vardecl"><span class="mpre">c&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_169_10_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_10_169_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
             in </span><span class="hl_varref"><span class="mpre">hPutChar</span></span><span class="mpre"> </span><a href="#loc_163_16_163_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_16_163_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_169_18_169_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_18_169_20&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">hFlush</span></span></a><span class="mpre"> </span><a href="#loc_163_16_163_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_16_163_17&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_169_10_169_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_10_169_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- NOTE: Currently, the output is checked every time tparm is called.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It might be faster to check for padding once in tiGetOutput1.</span></span><span class="mpre">
</span><a href="#loc_175_1_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_12&#39;)"><span class="mpre">writeToTerm</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FunPtr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CharOutput</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Handle</span></span><span class="mpre"> -&gt; </span><a href="#loc_146_6_146_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_20&#39;)"><span class="hl_tyconref"><span class="mpre">TermOutputType</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_175_1_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_12&#39;)"><span class="hl_fundecl"><span class="mpre">writeToTerm</span></span></a><span class="mpre"> </span><a name="loc_175_13_175_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_13_175_17&#39;)"><span class="hl_vardecl"><span class="mpre">putc</span></span></a><span class="mpre"> </span><a name="loc_175_18_175_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_18_175_19&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> (</span><a href="#loc_146_23_146_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_23_146_28&#39;)"><span class="hl_conref"><span class="mpre">TOCmd</span></span></a><span class="mpre"> </span><a name="loc_175_27_175_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_27_175_35&#39;)"><span class="hl_vardecl"><span class="mpre">numLines</span></span></a><span class="mpre"> </span><a name="loc_175_36_175_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_36_175_37&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)
    | </span><a href="#loc_135_1_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_14&#39;)"><span class="hl_varref"><span class="mpre">strHasPadding</span></span></a><span class="mpre"> </span><a href="#loc_175_36_175_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_36_175_37&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_312_1_312_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_6&#39;)"><span class="hl_varref"><span class="mpre">tPuts</span></span></a><span class="mpre"> </span><a href="#loc_175_36_175_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_36_175_37&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_175_27_175_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_27_175_35&#39;)"><span class="hl_varref"><span class="mpre">numLines</span></span></a><span class="mpre"> </span><a href="#loc_175_13_175_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_13_175_17&#39;)"><span class="hl_varref"><span class="mpre">putc</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">hPutStr</span></span><span class="mpre"> </span><a href="#loc_175_18_175_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_18_175_19&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_175_36_175_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_36_175_37&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_175_1_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_12&#39;)"><span class="hl_fundecl"><span class="mpre">writeToTerm</span></span></a><span class="mpre"> _ </span><a name="loc_178_15_178_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_15_178_16&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> (</span><a href="#loc_147_23_147_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_23_147_28&#39;)"><span class="hl_conref"><span class="mpre">TOStr</span></span></a><span class="mpre"> </span><a name="loc_178_24_178_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_24_178_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">hPutStr</span></span><span class="mpre"> </span><a href="#loc_178_15_178_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_15_178_16&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_178_24_178_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_24_178_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 180, srcSpanStartColumn = 1, srcSpanEndLine = 180, srcSpanEndColumn = 13}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 180, srcSpanStartColumn = 8, srcSpanEndLine = 180, srcSpanEndColumn = 9}]}) (AssocLeft (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vag"><span class="mpre">infixl 2 &lt;#&gt;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | An operator version of &#39;mappend&#39;.</span></span><span class="mpre">
</span><a href="#loc_184_1_184_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_1_184_6&#39;)"><span class="mpre">(&lt;#&gt;)</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 183, srcSpanStartColumn = 10, srcSpanEndLine = 183, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 183, srcSpanStartColumn = 19, srcSpanEndLine = 183, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagr"><span class="mpre">Monoid m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">
</span><a name="loc_184_1_184_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_1_184_6&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;#&gt;)</span></span></a><span class="mpre"> = </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_varref"><span class="mpre">mappend</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">---------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A feature or operation which a &#39;Terminal&#39; may define.</span></span><span class="mpre">
newtype </span><a name="loc_188_9_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_19&#39;)"><span class="hl_tycondecl"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_condecl"><span class="mpre">Capability</span></span></a><span class="mpre"> (</span><a href="#loc_62_9_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_17&#39;)"><span class="hl_tyconref"><span class="mpre">Terminal</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))

</span><a href="#loc_191_1_191_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_1_191_14&#39;)"><span class="mpre">getCapability</span></a><span class="mpre"> :: </span><a href="#loc_62_9_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_17&#39;)"><span class="hl_tyconref"><span class="mpre">Terminal</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_191_1_191_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_1_191_14&#39;)"><span class="hl_fundecl"><span class="mpre">getCapability</span></span></a><span class="mpre"> </span><a name="loc_191_15_191_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_15_191_19&#39;)"><span class="hl_vardecl"><span class="mpre">term</span></span></a><span class="mpre"> (</span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><a name="loc_191_32_191_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_32_191_33&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_120_1_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_12&#39;)"><span class="hl_varref"><span class="mpre">withCurTerm</span></span></a><span class="mpre"> </span><a href="#loc_191_15_191_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_15_191_19&#39;)"><span class="hl_varref"><span class="mpre">term</span></span></a><span class="mpre"> (</span><a href="#loc_191_32_191_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_32_191_33&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_191_15_191_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_15_191_19&#39;)"><span class="hl_varref"><span class="mpre">term</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Note that the instances for Capability of Functor, Monad and MonadPlus </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- use the corresponding instances for Maybe.</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_196_10_196_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_10_196_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><a name="loc_196_24_196_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_24_196_25&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) = </span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_196_43_196_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_43_196_44&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_196_10_196_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_10_196_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) (</span><a href="#loc_196_24_196_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_24_196_25&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_196_43_196_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_43_196_44&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)

instance </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> </span><a href="#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> where
    </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_vardecl"><span class="mpre">pure</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">
    </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;*&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_312_1_312_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_312_1_312_3&#39;)"><span class="hl_varref"><span class="mpre">ap</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> </span><a href="#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> where
    </span><span class="hl_vardecl"><span class="mpre">return</span></span><span class="mpre"> = </span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre">
    </span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><a name="loc_204_16_204_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_16_204_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_204_22_204_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_22_204_23&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_204_40_204_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_40_204_41&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_205_9_205_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_11&#39;)"><span class="hl_vardecl"><span class="mpre">mx</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_204_16_204_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_16_204_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_204_40_204_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_40_204_41&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
        case </span><a href="#loc_205_9_205_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_11&#39;)"><span class="hl_varref"><span class="mpre">mx</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_208_18_208_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_18_208_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; let </span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><a name="loc_208_38_208_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_38_208_40&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_204_22_204_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_22_204_23&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_208_18_208_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_18_208_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> in </span><a href="#loc_208_38_208_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_38_208_40&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre"> </span><a href="#loc_204_40_204_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_40_204_41&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

instance </span><a href="Control.Applicative.html#loc_138_24_138_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_138_24_138_35&#39;)"><span class="hl_classref"><span class="mpre">Alternative</span></span></a><span class="mpre"> </span><a href="#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> where
    </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_vardecl"><span class="mpre">(&lt;|&gt;)</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_varref"><span class="mpre">mplus</span></span></a><span class="mpre">
    </span><a href="Control.Applicative.html#loc_140_5_140_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_140_5_140_10&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_varref"><span class="mpre">mzero</span></span></a><span class="mpre">

instance </span><a href="Control.Monad.html#loc_122_18_122_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_122_18_122_27&#39;)"><span class="hl_classref"><span class="mpre">MonadPlus</span></span></a><span class="mpre"> </span><a href="#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> where
    </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_vardecl"><span class="mpre">mzero</span></span></a><span class="mpre"> = </span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)
    </span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><a name="loc_216_16_216_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_16_216_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><a name="loc_216_37_216_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_37_216_38&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_216_55_216_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_55_216_56&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_217_9_217_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_9_217_11&#39;)"><span class="hl_vardecl"><span class="mpre">mx</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_216_16_216_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_16_216_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_216_55_216_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_55_216_56&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
        case </span><a href="#loc_217_9_217_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_9_217_11&#39;)"><span class="hl_varref"><span class="mpre">mx</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_216_37_216_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_37_216_38&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_216_55_216_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_55_216_56&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
            _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_217_9_217_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_9_217_11&#39;)"><span class="hl_varref"><span class="mpre">mx</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 222, srcSpanStartColumn = 1, srcSpanEndLine = 222, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 222, srcSpanStartColumn = 1, srcSpanEndLine = 222, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Cons"><span class="mpre">foreign import ccall tigetnum :: CString -&gt; IO CInt</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Look up a numeric capability in the terminfo database.</span></span><span class="mpre">
</span><a href="#loc_226_1_226_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_9&#39;)"><span class="mpre">tiGetNum</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> 
</span><a name="loc_226_1_226_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_9&#39;)"><span class="hl_fundecl"><span class="mpre">tiGetNum</span></span></a><span class="mpre"> </span><a name="loc_226_10_226_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_10_226_13&#39;)"><span class="hl_vardecl"><span class="mpre">cap</span></span></a><span class="mpre"> = </span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
                </span><a name="loc_227_17_227_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_17_227_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> (</span><a href="Foreign.C.String.html#loc_176_1_176_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.String.html#loc_176_1_176_12&#39;)"><span class="hl_varref"><span class="mpre">withCString</span></span></a><span class="mpre"> </span><a href="#loc_226_10_226_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_10_226_13&#39;)"><span class="hl_varref"><span class="mpre">cap</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">tigetnum</span></span><span class="mpre">)
                if </span><a href="#loc_227_17_227_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_17_227_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                    then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_227_17_227_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_17_227_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
                    else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 232, srcSpanStartColumn = 1, srcSpanEndLine = 232, srcSpanEndColumn = 53}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 232, srcSpanStartColumn = 1, srcSpanEndLine = 232, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Cons"><span class="mpre">foreign import ccall tigetflag :: CString -&gt; IO CInt</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Look up a boolean capability in the terminfo database.  </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Unlike &#39;tiGuardFlag&#39;, this capability never fails; it returns &#39;False&#39; if the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- capability is absent or set to false, and returns &#39;True&#39; otherwise.  </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><a href="#loc_239_1_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_10&#39;)"><span class="mpre">tiGetFlag</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_239_1_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_10&#39;)"><span class="hl_fundecl"><span class="mpre">tiGetFlag</span></span></a><span class="mpre"> </span><a name="loc_239_11_239_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_11_239_14&#39;)"><span class="hl_vardecl"><span class="mpre">cap</span></span></a><span class="mpre"> = </span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                        </span><a href="Foreign.C.String.html#loc_176_1_176_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.String.html#loc_176_1_176_12&#39;)"><span class="hl_varref"><span class="mpre">withCString</span></span></a><span class="mpre"> </span><a href="#loc_239_11_239_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_11_239_14&#39;)"><span class="hl_varref"><span class="mpre">cap</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">tigetflag</span></span><span class="mpre">
                
</span><span class="hl_comment"><span class="mpre">-- | Look up a boolean capability in the terminfo database, and fail if</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it\&#39;s not defined.</span></span><span class="mpre">
</span><a href="#loc_245_1_245_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_12&#39;)"><span class="mpre">tiGuardFlag</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_245_1_245_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_12&#39;)"><span class="hl_fundecl"><span class="mpre">tiGuardFlag</span></span></a><span class="mpre"> </span><a name="loc_245_13_245_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_13_245_16&#39;)"><span class="hl_vardecl"><span class="mpre">cap</span></span></a><span class="mpre"> = </span><a href="#loc_239_1_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_10&#39;)"><span class="hl_varref"><span class="mpre">tiGetFlag</span></span></a><span class="mpre"> </span><a href="#loc_245_13_245_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_13_245_16&#39;)"><span class="hl_varref"><span class="mpre">cap</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_148_1_148_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_148_1_148_6&#39;)"><span class="hl_varref"><span class="mpre">guard</span></span></a><span class="mpre">
                
</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 247, srcSpanStartColumn = 1, srcSpanEndLine = 247, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 247, srcSpanStartColumn = 1, srcSpanEndLine = 247, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Cons"><span class="mpre">foreign import ccall tigetstr :: CString -&gt; IO CString</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 249, srcSpanStartColumn = 1, srcSpanEndLine = 249, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 249, srcSpanStartColumn = 1, srcSpanEndLine = 249, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/Sy"><span class="mpre">{-# DEPRECATED tiGetStr &quot;use tiGetOutput instead.&quot; #-}</span></span><span class="mpre"> 
</span><span class="hl_comment"><span class="mpre">-- | Look up a string capability in the terminfo database.  NOTE: This function is deprecated; use</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;tiGetOutput1&#39; instead.</span></span><span class="mpre">
</span><a href="#loc_253_1_253_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_1_253_9&#39;)"><span class="mpre">tiGetStr</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_253_1_253_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_1_253_9&#39;)"><span class="hl_fundecl"><span class="mpre">tiGetStr</span></span></a><span class="mpre"> </span><a name="loc_253_10_253_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_10_253_13&#39;)"><span class="hl_vardecl"><span class="mpre">cap</span></span></a><span class="mpre"> = </span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
                </span><a name="loc_254_17_254_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_17_254_23&#39;)"><span class="hl_vardecl"><span class="mpre">result</span></span></a><span class="mpre"> &lt;- </span><a href="Foreign.C.String.html#loc_176_1_176_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.String.html#loc_176_1_176_12&#39;)"><span class="hl_varref"><span class="mpre">withCString</span></span></a><span class="mpre"> </span><a href="#loc_253_10_253_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_10_253_13&#39;)"><span class="hl_varref"><span class="mpre">cap</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">tigetstr</span></span><span class="mpre"> 
                if </span><a href="#loc_254_17_254_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_17_254_23&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_254_17_254_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_17_254_23&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_260_9_260_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_9_260_16&#39;)"><span class="hl_varref"><span class="mpre">neg1Ptr</span></span></a><span class="mpre">
                    then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                    else </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="Foreign.C.String.html#loc_138_1_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.String.html#loc_138_1_138_12&#39;)"><span class="hl_varref"><span class="mpre">peekCString</span></span></a><span class="mpre"> </span><a href="#loc_254_17_254_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_17_254_23&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre">)
    where
        </span><span class="hl_comment"><span class="mpre">-- hack; tigetstr sometimes returns (-1)</span></span><span class="mpre">
        </span><a name="loc_260_9_260_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_9_260_16&#39;)"><span class="hl_vardecl"><span class="mpre">neg1Ptr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (-</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">---------------</span></span><span class="mpre">


                    
</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 267, srcSpanStartColumn = 1, srcSpanEndLine = 270, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 267, srcSpanStartColumn = 1, srcSpanEndLine = 267, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Cons"><span class="mpre">foreign import ccall tparm ::
    CString -&gt; CLong -&gt; CLong -&gt; CLong -&gt; CLong -&gt; CLong -&gt; CLong 
    -&gt; CLong -&gt; CLong -&gt; CLong </span><span class="hl_comment"><span class="mpre">-- p1,...,p9</span></span><span class="mpre">
    -&gt; IO CString</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Note: I may want to cut out the middleman and pipe tGoto/tGetStr together</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with tput without a String marshall in the middle.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- directly without </span></span><span class="mpre">

</span><a href="#loc_277_1_277_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_1_277_6&#39;)"><span class="mpre">tParm</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> ([</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_277_1_277_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_1_277_6&#39;)"><span class="hl_fundecl"><span class="mpre">tParm</span></span></a><span class="mpre"> </span><a name="loc_277_7_277_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_7_277_10&#39;)"><span class="hl_vardecl"><span class="mpre">cap</span></span></a><span class="mpre"> = </span><a href="#loc_188_24_188_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_24_188_34&#39;)"><span class="hl_conref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_277_27_277_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_27_277_28&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> 
        </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_278_12_278_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_12_278_14&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_120_1_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_12&#39;)"><span class="hl_varref"><span class="mpre">withCurTerm</span></span></a><span class="mpre"> </span><a href="#loc_277_27_277_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_27_277_28&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                    </span><a href="#loc_280_11_280_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_11_280_17&#39;)"><span class="hl_varref"><span class="mpre">tparm&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_278_12_278_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_12_278_14&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
    where </span><a name="loc_280_11_280_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_11_280_17&#39;)"><span class="hl_fundecl"><span class="mpre">tparm&#39;</span></span></a><span class="mpre"> (</span><a name="loc_280_19_280_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_19_280_21&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_280_22_280_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_22_280_24&#39;)"><span class="hl_vardecl"><span class="mpre">p2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_280_25_280_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_25_280_27&#39;)"><span class="hl_vardecl"><span class="mpre">p3</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_280_28_280_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_28_280_30&#39;)"><span class="hl_vardecl"><span class="mpre">p4</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_280_31_280_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_31_280_33&#39;)"><span class="hl_vardecl"><span class="mpre">p5</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_280_34_280_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_34_280_36&#39;)"><span class="hl_vardecl"><span class="mpre">p6</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_280_37_280_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_37_280_39&#39;)"><span class="hl_vardecl"><span class="mpre">p7</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_280_40_280_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_40_280_42&#39;)"><span class="hl_vardecl"><span class="mpre">p8</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_280_43_280_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_43_280_45&#39;)"><span class="hl_vardecl"><span class="mpre">p9</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)
            = </span><a href="Foreign.C.String.html#loc_176_1_176_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.String.html#loc_176_1_176_12&#39;)"><span class="hl_varref"><span class="mpre">withCString</span></span></a><span class="mpre"> </span><a href="#loc_277_7_277_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_7_277_10&#39;)"><span class="hl_varref"><span class="mpre">cap</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_281_34_281_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_34_281_39&#39;)"><span class="hl_vardecl"><span class="mpre">c_cap</span></span></a><span class="mpre"> -&gt; do
                </span><a name="loc_282_17_282_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_17_282_23&#39;)"><span class="hl_vardecl"><span class="mpre">result</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">tparm</span></span><span class="mpre"> </span><a href="#loc_281_34_281_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_34_281_39&#39;)"><span class="hl_varref"><span class="mpre">c_cap</span></span></a><span class="mpre"> </span><a href="#loc_280_19_280_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_19_280_21&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre"> </span><a href="#loc_280_22_280_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_22_280_24&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre"> </span><a href="#loc_280_25_280_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_25_280_27&#39;)"><span class="hl_varref"><span class="mpre">p3</span></span></a><span class="mpre"> </span><a href="#loc_280_28_280_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_28_280_30&#39;)"><span class="hl_varref"><span class="mpre">p4</span></span></a><span class="mpre"> </span><a href="#loc_280_31_280_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_31_280_33&#39;)"><span class="hl_varref"><span class="mpre">p5</span></span></a><span class="mpre"> </span><a href="#loc_280_34_280_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_34_280_36&#39;)"><span class="hl_varref"><span class="mpre">p6</span></span></a><span class="mpre"> </span><a href="#loc_280_37_280_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_37_280_39&#39;)"><span class="hl_varref"><span class="mpre">p7</span></span></a><span class="mpre"> </span><a href="#loc_280_40_280_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_40_280_42&#39;)"><span class="hl_varref"><span class="mpre">p8</span></span></a><span class="mpre"> </span><a href="#loc_280_43_280_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_43_280_45&#39;)"><span class="hl_varref"><span class="mpre">p9</span></span></a><span class="mpre">
                if </span><a href="#loc_282_17_282_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_17_282_23&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre">
                    then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
                    else </span><a href="Foreign.C.String.html#loc_138_1_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.String.html#loc_138_1_138_12&#39;)"><span class="hl_varref"><span class="mpre">peekCString</span></span></a><span class="mpre"> </span><a href="#loc_282_17_282_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_17_282_23&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre">
          </span><a href="#loc_280_11_280_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_11_280_17&#39;)"><span class="hl_fundecl"><span class="mpre">tparm&#39;</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;tParm: List too short&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Look up an output capability in the terminfo database.  </span></span><span class="mpre">
</span><a href="#loc_290_1_290_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_12&#39;)"><span class="mpre">tiGetOutput</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> ([</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">LinesAffected</span></span><span class="mpre"> -&gt; </span><a href="#loc_144_9_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_19&#39;)"><span class="hl_tyconref"><span class="mpre">TermOutput</span></span></a><span class="mpre">)
</span><a name="loc_290_1_290_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_12&#39;)"><span class="hl_fundecl"><span class="mpre">tiGetOutput</span></span></a><span class="mpre"> </span><a name="loc_290_13_290_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_13_290_16&#39;)"><span class="hl_vardecl"><span class="mpre">cap</span></span></a><span class="mpre"> = do
    </span><a name="loc_291_5_291_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_5_291_8&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_253_1_253_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_1_253_9&#39;)"><span class="hl_varref"><span class="mpre">tiGetStr</span></span></a><span class="mpre"> </span><a href="#loc_290_13_290_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_13_290_16&#39;)"><span class="hl_varref"><span class="mpre">cap</span></span></a><span class="mpre">
    </span><a name="loc_292_5_292_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_5_292_6&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_277_1_277_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_1_277_6&#39;)"><span class="hl_varref"><span class="mpre">tParm</span></span></a><span class="mpre"> </span><a href="#loc_291_5_291_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_5_291_8&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_293_15_293_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_15_293_17&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a name="loc_293_18_293_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_18_293_20&#39;)"><span class="hl_vardecl"><span class="mpre">la</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_296_1_296_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_1_296_8&#39;)"><span class="hl_varref"><span class="mpre">fromStr</span></span></a><span class="mpre"> </span><a href="#loc_293_18_293_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_18_293_20&#39;)"><span class="hl_varref"><span class="mpre">la</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_292_5_292_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_5_292_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_293_15_293_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_15_293_17&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">

</span><a href="#loc_296_1_296_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_1_296_8&#39;)"><span class="mpre">fromStr</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">LinesAffected</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_144_9_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_19&#39;)"><span class="hl_tyconref"><span class="mpre">TermOutput</span></span></a><span class="mpre">
</span><a name="loc_296_1_296_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_1_296_8&#39;)"><span class="hl_fundecl"><span class="mpre">fromStr</span></span></a><span class="mpre"> </span><a name="loc_296_9_296_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_9_296_11&#39;)"><span class="hl_vardecl"><span class="mpre">la</span></span></a><span class="mpre"> </span><a name="loc_296_12_296_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_12_296_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_144_22_144_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_22_144_32&#39;)"><span class="hl_conref"><span class="mpre">TermOutput</span></span></a><span class="mpre"> (</span><a href="#loc_146_23_146_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_23_146_28&#39;)"><span class="hl_conref"><span class="mpre">TOCmd</span></span></a><span class="mpre"> </span><a href="#loc_296_9_296_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_9_296_11&#39;)"><span class="hl_varref"><span class="mpre">la</span></span></a><span class="mpre"> </span><a href="#loc_296_12_296_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_12_296_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 298, srcSpanStartColumn = 1, srcSpanEndLine = 298, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 298, srcSpanStartColumn = 1, srcSpanEndLine = 298, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Co"><span class="mpre">type CharOutput = CInt -&gt; IO CInt</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 300, srcSpanStartColumn = 1, srcSpanEndLine = 300, srcSpanEndColumn = 82}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 300, srcSpanStartColumn = 1, srcSpanEndLine = 300, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Cons"><span class="mpre">foreign import ccall &quot;wrapper&quot; mkCallback :: CharOutput -&gt; IO (FunPtr CharOutput)</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 302, srcSpanStartColumn = 1, srcSpanEndLine = 302, srcSpanEndColumn = 76}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 302, srcSpanStartColumn = 1, srcSpanEndLine = 302, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Cons"><span class="mpre">foreign import ccall tputs :: CString -&gt; CInt -&gt; FunPtr CharOutput -&gt; IO ()</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A parameter to specify the number of lines affected.  Some capabilities</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (e.g., @clear@ and @dch1@) use</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- this parameter on some terminals to compute variable-length padding.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 307, srcSpanStartColumn = 1, srcSpanEndLine = 307, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 307, srcSpanStartColumn = 1, srcSpanEndLine = 307, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Co"><span class="mpre">type LinesAffected = Int</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Output a string capability.  Applys padding information to the string if</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- necessary.</span></span><span class="mpre">
</span><a href="#loc_312_1_312_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_6&#39;)"><span class="mpre">tPuts</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">LinesAffected</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FunPtr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CharOutput</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_312_1_312_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_6&#39;)"><span class="hl_fundecl"><span class="mpre">tPuts</span></span></a><span class="mpre"> </span><a name="loc_312_7_312_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_7_312_8&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_312_9_312_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_9_312_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_312_11_312_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_11_312_15&#39;)"><span class="hl_vardecl"><span class="mpre">putc</span></span></a><span class="mpre"> = </span><a href="Foreign.C.String.html#loc_176_1_176_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.String.html#loc_176_1_176_12&#39;)"><span class="hl_varref"><span class="mpre">withCString</span></span></a><span class="mpre"> </span><a href="#loc_312_7_312_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_7_312_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_312_35_312_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_35_312_40&#39;)"><span class="hl_vardecl"><span class="mpre">c_str</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">tputs</span></span><span class="mpre"> </span><a href="#loc_312_35_312_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_35_312_40&#39;)"><span class="hl_varref"><span class="mpre">c_str</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_312_9_312_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_9_312_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><a href="#loc_312_11_312_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_11_312_15&#39;)"><span class="hl_varref"><span class="mpre">putc</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Look up an output capability which takes a fixed number of parameters</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (for example, @Int -&gt; Int -&gt; TermOutput@).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For capabilities which may contain variable-length</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- padding, use &#39;tiGetOutput&#39; instead.</span></span><span class="mpre">
</span><a href="#loc_321_1_321_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_1_321_13&#39;)"><span class="mpre">tiGetOutput1</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> . </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 320, srcSpanStartColumn = 28, srcSpanEndLine = 320, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 320, srcSpanStartColumn = 40, srcSpanEndLine = 320, srcSpanEndColumn = 42}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagr"><span class="mpre">OutputCap f =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre">
</span><a name="loc_321_1_321_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_1_321_13&#39;)"><span class="hl_fundecl"><span class="mpre">tiGetOutput1</span></span></a><span class="mpre"> </span><a name="loc_321_14_321_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_14_321_17&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = do
    </span><a name="loc_322_5_322_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_5_322_8&#39;)"><span class="hl_vardecl"><span class="mpre">cap</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_253_1_253_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_1_253_9&#39;)"><span class="hl_varref"><span class="mpre">tiGetStr</span></span></a><span class="mpre"> </span><a href="#loc_321_14_321_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_14_321_17&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_148_1_148_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_148_1_148_6&#39;)"><span class="hl_varref"><span class="mpre">guard</span></span></a><span class="mpre"> (</span><a href="#loc_330_5_330_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_5_330_17&#39;)"><span class="hl_varref"><span class="mpre">hasOkPadding</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre">) </span><a href="#loc_322_5_322_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_5_322_8&#39;)"><span class="hl_varref"><span class="mpre">cap</span></span></a><span class="mpre">)
    </span><a name="loc_324_5_324_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_5_324_6&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_277_1_277_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_1_277_6&#39;)"><span class="hl_varref"><span class="mpre">tParm</span></span></a><span class="mpre"> </span><a href="#loc_322_5_322_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_5_322_8&#39;)"><span class="hl_varref"><span class="mpre">cap</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_331_5_331_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_14&#39;)"><span class="hl_varref"><span class="mpre">outputCap</span></span></a><span class="mpre"> </span><a href="#loc_324_5_324_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_5_324_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> []


</span><span class="hl_comment"><span class="mpre">-- OK, this is the structure that I want:</span></span><span class="mpre">
class </span><a name="loc_329_7_329_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_7_329_16&#39;)"><span class="hl_classdecl"><span class="mpre">OutputCap</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> where
    </span><a name="loc_330_5_330_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_5_330_17&#39;)"><span class="mpre">hasOkPadding</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    </span><a name="loc_331_5_331_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_14&#39;)"><span class="mpre">outputCap</span></a><span class="mpre"> :: ([</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) -&gt; [</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre">

instance </span><a href="#loc_329_7_329_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_7_329_16&#39;)"><span class="hl_classref"><span class="mpre">OutputCap</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">] where
    </span><a href="#loc_330_5_330_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_5_330_17&#39;)"><span class="hl_fundecl"><span class="mpre">hasOkPadding</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_135_1_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_14&#39;)"><span class="hl_varref"><span class="mpre">strHasPadding</span></span></a><span class="mpre"> 
    </span><a href="#loc_331_5_331_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_14&#39;)"><span class="hl_fundecl"><span class="mpre">outputCap</span></span></a><span class="mpre"> </span><a name="loc_335_15_335_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_15_335_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_335_17_335_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_17_335_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_335_15_335_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_15_335_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_335_17_335_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_17_335_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

instance </span><a href="#loc_329_7_329_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_7_329_16&#39;)"><span class="hl_classref"><span class="mpre">OutputCap</span></span></a><span class="mpre"> </span><a href="#loc_144_9_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_19&#39;)"><span class="hl_tyconref"><span class="mpre">TermOutput</span></span></a><span class="mpre"> where
    </span><a href="#loc_330_5_330_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_5_330_17&#39;)"><span class="hl_fundecl"><span class="mpre">hasOkPadding</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_331_5_331_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_14&#39;)"><span class="hl_fundecl"><span class="mpre">outputCap</span></span></a><span class="mpre"> </span><a name="loc_339_15_339_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_15_339_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_339_17_339_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_17_339_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="#loc_296_1_296_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_1_296_8&#39;)"><span class="hl_varref"><span class="mpre">fromStr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_339_15_339_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_15_339_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_339_17_339_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_17_339_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 341, srcSpanStartColumn = 10, srcSpanEndLine = 341, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 341, srcSpanStartColumn = 10, srcSpanEndLine = 341, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/"><span class="mpre">(Enum p, OutputCap f) =&gt;</span></span><span class="mpre"> </span><a href="#loc_329_7_329_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_7_329_16&#39;)"><span class="hl_classref"><span class="mpre">OutputCap</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">p</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre">) where
    </span><a href="#loc_331_5_331_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_14&#39;)"><span class="hl_fundecl"><span class="mpre">outputCap</span></span></a><span class="mpre"> </span><a name="loc_342_15_342_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_15_342_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_342_17_342_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_17_342_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = \</span><a name="loc_342_23_342_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_23_342_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_331_5_331_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_14&#39;)"><span class="hl_varref"><span class="mpre">outputCap</span></span></a><span class="mpre"> </span><a href="#loc_342_15_342_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_15_342_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_342_23_342_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_23_342_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_342_17_342_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_17_342_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
    </span><a href="#loc_330_5_330_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_5_330_17&#39;)"><span class="hl_fundecl"><span class="mpre">hasOkPadding</span></span></a><span class="mpre"> _ = </span><a href="#loc_330_5_330_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_5_330_17&#39;)"><span class="hl_varref"><span class="mpre">hasOkPadding</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">{- $outputdoc
Terminfo contains many string capabilities for special effects.
For example, the @cuu1@ capability moves the cursor up one line; on ANSI terminals
this is accomplished by printing the control sequence @\&quot;\\ESC[A\&quot;@.
However, some older terminals also require \&quot;padding\&quot;, or short pauses, after certain commands.
For example, when @TERM=vt100@ the @cuu1@ capability is @\&quot;\\ESC[A$\&lt;2\&gt;\&quot;@, which instructs terminfo
to pause for two milliseconds after outputting the control sequence.

The &#39;TermOutput&#39; monoid abstracts away all padding and control
sequence output.  Unfortunately, that datatype is difficult to integrate into existing &#39;String&#39;-based APIs
such as pretty-printers.  Thus, as a workaround, &#39;tiGetOutput1&#39; also lets us access the control sequences as &#39;String&#39;s.  The one caveat is that it will not allow you to access padded control sequences as Strings.  For example:

   &gt; &gt; t &lt;- setupTerm &quot;vt100&quot;
   &gt; &gt; isJust (getCapability t (tiGetOutput1 &quot;cuu1&quot;) :: Maybe String)
   &gt; False
   &gt; &gt; isJust (getCapability t (tiGetOutput1 &quot;cuu1&quot;) :: Maybe TermOutput)
   &gt; True

&#39;String&#39; capabilities will work with software-based terminal types such as @xterm@ and @linux@.
However, you should use &#39;TermOutput&#39; if compatibility with older terminals is important.
Additionally, the @visualBell@ capability which flashes the screen usually produces its effect with a padding directive, so it will only work with &#39;TermOutput&#39;.

-}</span></span><span class="mpre">


class </span><span class="warning" data-warning="ClassDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 371, srcSpanStartColumn = 7, srcSpanEndLine = 371, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Base.hs&quot;, srcSpanStartLine = 371, srcSpanStartColumn = 7, srcSpanEndLine = 371, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Con"><span class="mpre">(Monoid s, OutputCap s) =&gt;</span></span><span class="mpre"> </span><a name="loc_371_34_371_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_34_371_41&#39;)"><span class="hl_classdecl"><span class="mpre">TermStr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">

instance </span><a href="#loc_371_34_371_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_34_371_41&#39;)"><span class="hl_classref"><span class="mpre">TermStr</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]
instance </span><a href="#loc_371_34_371_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_34_371_41&#39;)"><span class="hl_classref"><span class="mpre">TermStr</span></span></a><span class="mpre"> </span><a href="#loc_144_9_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_19&#39;)"><span class="hl_tyconref"><span class="mpre">TermOutput</span></span></a><span class="mpre">
</span></div></body></html>