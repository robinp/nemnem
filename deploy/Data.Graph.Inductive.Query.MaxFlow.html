<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | Maximum Flow algorithm</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We are given a flow network G=(V,E) with source s and sink t where each</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- edge (u,v) in E has a nonnegative capacity c(u,v)&gt;=0, and we wish to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- find a flow of maximum value from s to t.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A flow in G=(V,E) is a real-valued function f:VxV-&gt;R that satisfies:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For all u,v in V, f(u,v)\&lt;=c(u,v)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For all u,v in V, f(u,v)=-f(v,u)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For all u in V-{s,t}, Sum{f(u,v):v in V } = 0</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The value of a flow f is defined as |f|=Sum {f(s,v)|v in V}, i.e.,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the total net flow out of the source.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In this module we implement the Edmonds-Karp algorithm, which is the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Ford-Fulkerson method but using the shortest path from s to t as the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- augmenting path along which the flow is incremented.</span></span><span class="mpre">

module Data.Graph.Inductive.Query.MaxFlow(
    getRevEdges, augmentGraph, updAdjList, updateFlow, mfmg, mf, maxFlowgraph,
    maxFlow
) where


import Data.List

import Data.Graph.Inductive.Basic
import Data.Graph.Inductive.Graph
</span><span class="hl_comment"><span class="mpre">--import Data.Graph.Inductive.Tree</span></span><span class="mpre">
import Data.Graph.Inductive.Query.BFS

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                 i                                 0</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For each edge a---&gt;b this function returns edge b---&gt;a .</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--          i</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Edges a\&lt;---&gt;b are ignored</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--          j</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="mpre">getRevEdges</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 16, srcSpanEndLine = 42, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 16, srcSpanEndLine = 42, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Ind"><span class="mpre">(Num b,Ord b) =&gt;</span></span><span class="mpre"> [(</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">)] -&gt; [(</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)]
</span><a name="loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="hl_fundecl"><span class="mpre">getRevEdges</span></span></a><span class="mpre"> [] = []
</span><a href="#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="hl_fundecl"><span class="mpre">getRevEdges</span></span></a><span class="mpre"> ((</span><a name="loc_44_15_44_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_15_44_16&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">,</span><a name="loc_44_17_44_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_17_44_18&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_44_20_44_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_20_44_22&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">notElem</span></span><span class="mpre"> (</span><a href="#loc_44_17_44_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_17_44_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_44_15_44_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_15_44_16&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">) </span><a href="#loc_44_20_44_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_20_44_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre"> = (</span><a href="#loc_44_17_44_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_17_44_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_44_15_44_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_15_44_16&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="hl_varref"><span class="mpre">getRevEdges</span></span></a><span class="mpre"> </span><a href="#loc_44_20_44_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_20_44_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">
                       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">        = </span><a href="#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="hl_varref"><span class="mpre">getRevEdges</span></span></a><span class="mpre"> (</span><a href="Data.List.html#loc_360_1_360_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_360_1_360_7&#39;)"><span class="hl_varref"><span class="mpre">delete</span></span></a><span class="mpre"> (</span><a href="#loc_44_17_44_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_17_44_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_44_15_44_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_15_44_16&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">) </span><a href="#loc_44_20_44_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_20_44_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                 i                                  0</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For each edge a---&gt;b insert into graph the edge a\&lt;---b . Then change the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                            i         (i,0,i)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- label of every edge from a----&gt;b to a-------&gt;b</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- where label (x,y,z)=(Max Capacity, Current flow, Residual capacity)</span></span><span class="mpre">
</span><a href="#loc_57_1_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_13&#39;)"><span class="mpre">augmentGraph</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 17, srcSpanEndLine = 56, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 17, srcSpanEndLine = 56, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Ind"><span class="mpre">(DynGraph gr,Num b,Ord b) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_57_1_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_13&#39;)"><span class="hl_fundecl"><span class="mpre">augmentGraph</span></span></a><span class="mpre"> </span><a name="loc_57_14_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_14_57_15&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="Data.Graph.Inductive.Graph.html#loc_227_1_227_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_227_1_227_5&#39;)"><span class="hl_varref"><span class="mpre">emap</span></span></a><span class="mpre"> (\</span><a name="loc_57_25_57_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_25_57_26&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">-&gt;(</span><a href="#loc_57_25_57_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_25_57_26&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><a href="#loc_57_25_57_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_25_57_26&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)) (</span><a href="Data.Graph.Inductive.Graph.html#loc_277_1_277_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_277_1_277_9&#39;)"><span class="hl_varref"><span class="mpre">insEdges</span></span></a><span class="mpre"> (</span><a href="#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="hl_varref"><span class="mpre">getRevEdges</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Graph.html#loc_236_1_236_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_236_1_236_6&#39;)"><span class="hl_varref"><span class="mpre">edges</span></span></a><span class="mpre"> </span><a href="#loc_57_14_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_14_57_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)) </span><a href="#loc_57_14_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_14_57_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
                                                
</span><span class="hl_comment"><span class="mpre">-- | Given a successor or predecessor list for node u and given node v, find</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the label corresponding to edge (u,v) and update the flow and residual</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- capacity of that edge&#39;s label. Then return the updated list.</span></span><span class="mpre">
</span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="mpre">updAdjList</span></a><span class="mpre">::</span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 13, srcSpanEndLine = 62, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 13, srcSpanEndLine = 62, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Ind"><span class="mpre">(Num b,Ord b) =&gt;</span></span><span class="mpre"> [((</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">),</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">)]-&gt;</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">-&gt;</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">-&gt;[((</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">),</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">)]
</span><a name="loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_fundecl"><span class="mpre">updAdjList</span></span></a><span class="mpre"> </span><a name="loc_63_12_63_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_12_63_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_63_14_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_14_63_15&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_63_16_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_16_63_18&#39;)"><span class="hl_vardecl"><span class="mpre">cf</span></span></a><span class="mpre"> </span><a name="loc_63_19_63_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_19_63_22&#39;)"><span class="hl_vardecl"><span class="mpre">fwd</span></span></a><span class="mpre"> | </span><a href="#loc_63_19_63_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_19_63_22&#39;)"><span class="hl_varref"><span class="mpre">fwd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> = ((</span><a href="#loc_65_33_65_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_33_65_34&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_65_35_65_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_35_65_36&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_63_16_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_16_63_18&#39;)"><span class="hl_varref"><span class="mpre">cf</span></span></a><span class="mpre">,</span><a href="#loc_65_37_65_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_37_65_38&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_63_16_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_16_63_18&#39;)"><span class="hl_varref"><span class="mpre">cf</span></span></a><span class="mpre">),</span><a href="#loc_65_40_65_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_40_65_41&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_66_31_66_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_31_66_33&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
                      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">   = ((</span><a href="#loc_65_33_65_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_33_65_34&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_65_35_65_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_35_65_36&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_63_16_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_16_63_18&#39;)"><span class="hl_varref"><span class="mpre">cf</span></span></a><span class="mpre">,</span><a href="#loc_65_37_65_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_37_65_38&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_63_16_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_16_63_18&#39;)"><span class="hl_varref"><span class="mpre">cf</span></span></a><span class="mpre">),</span><a href="#loc_65_40_65_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_40_65_41&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_66_31_66_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_31_66_33&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
                        where ((</span><a name="loc_65_33_65_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_33_65_34&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_65_35_65_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_35_65_36&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_65_37_65_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_37_65_38&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">),</span><a name="loc_65_40_65_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_40_65_41&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (\(_,</span><a name="loc_65_63_65_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_63_65_65&#39;)"><span class="hl_vardecl"><span class="mpre">w&#39;</span></span></a><span class="mpre">)-&gt;</span><a href="#loc_63_14_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_14_63_15&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><a href="#loc_65_63_65_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_63_65_65&#39;)"><span class="hl_varref"><span class="mpre">w&#39;</span></span></a><span class="mpre">) </span><a href="#loc_63_12_63_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_12_63_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
                              </span><a name="loc_66_31_66_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_31_66_33&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">          = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (\(_,</span><a name="loc_66_57_66_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_57_66_59&#39;)"><span class="hl_vardecl"><span class="mpre">w&#39;</span></span></a><span class="mpre">)-&gt;</span><a href="#loc_63_14_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_14_63_15&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">/=</span></span><a href="#loc_66_57_66_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_57_66_59&#39;)"><span class="hl_varref"><span class="mpre">w&#39;</span></span></a><span class="mpre">) </span><a href="#loc_63_12_63_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_12_63_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Update flow and residual capacity along augmenting path from s to t in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- graph G. For a path [u,v,w,...] find the node u in G and its successor and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- predecessor list, then update the corresponding edges (u,v) and (v,u) on</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- those lists by using the minimum residual capacity of the path.</span></span><span class="mpre">
</span><a href="#loc_73_1_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_11&#39;)"><span class="mpre">updateFlow</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 15, srcSpanEndLine = 72, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 15, srcSpanEndLine = 72, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Ind"><span class="mpre">(DynGraph gr,Num b,Ord b) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Path</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_73_1_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_11&#39;)"><span class="hl_fundecl"><span class="mpre">updateFlow</span></span></a><span class="mpre"> []             _ </span><a name="loc_73_29_73_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_29_73_30&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_73_29_73_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_29_73_30&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
</span><a href="#loc_73_1_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_11&#39;)"><span class="hl_fundecl"><span class="mpre">updateFlow</span></span></a><span class="mpre"> [_]       _ </span><a name="loc_74_24_74_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_24_74_25&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_74_24_74_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_24_74_25&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
</span><a href="#loc_73_1_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_11&#39;)"><span class="hl_fundecl"><span class="mpre">updateFlow</span></span></a><span class="mpre"> (</span><a name="loc_75_13_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_14&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_75_15_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_16&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_75_17_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_17_75_19&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre">) </span><a name="loc_75_21_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_23&#39;)"><span class="hl_vardecl"><span class="mpre">cf</span></span></a><span class="mpre"> </span><a name="loc_75_24_75_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_24_75_25&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = case </span><a href="Data.Graph.Inductive.Graph.html#loc_182_3_182_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_182_3_182_8&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_75_13_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_14&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><a href="#loc_75_24_75_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_24_75_25&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> of
                             (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">,</span><a name="loc_76_39_76_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_39_76_41&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">)        -&gt; </span><a href="#loc_76_39_76_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_39_76_41&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
                             (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_77_37_77_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_37_77_38&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><a name="loc_77_39_77_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_39_77_41&#39;)"><span class="hl_vardecl"><span class="mpre">u&#39;</span></span></a><span class="mpre">,</span><a name="loc_77_42_77_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_42_77_43&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">,</span><a name="loc_77_44_77_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_44_77_45&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">),</span><a name="loc_77_47_77_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_47_77_49&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_80_39_80_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_39_80_41&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre">,</span><a href="#loc_77_39_77_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_39_77_41&#39;)"><span class="hl_varref"><span class="mpre">u&#39;</span></span></a><span class="mpre">,</span><a href="#loc_77_42_77_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_42_77_43&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">,</span><a href="#loc_79_39_79_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_39_79_41&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">) </span><a href="Data.Graph.Inductive.Graph.html#loc_208_3_208_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_208_3_208_6&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_78_39_78_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_39_78_41&#39;)"><span class="hl_varref"><span class="mpre">g2</span></span></a><span class="mpre">
                                where </span><a name="loc_78_39_78_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_39_78_41&#39;)"><span class="hl_vardecl"><span class="mpre">g2</span></span></a><span class="mpre"> = </span><a href="#loc_73_1_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_11&#39;)"><span class="hl_varref"><span class="mpre">updateFlow</span></span></a><span class="mpre"> (</span><a href="#loc_75_15_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_16&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_75_17_75_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_17_75_19&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">) </span><a href="#loc_75_21_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_23&#39;)"><span class="hl_varref"><span class="mpre">cf</span></span></a><span class="mpre"> </span><a href="#loc_77_47_77_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_47_77_49&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
                                      </span><a name="loc_79_39_79_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_39_79_41&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_varref"><span class="mpre">updAdjList</span></span></a><span class="mpre"> </span><a href="#loc_77_44_77_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_44_77_45&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_75_15_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_16&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_75_21_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_23&#39;)"><span class="hl_varref"><span class="mpre">cf</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                                      </span><a name="loc_80_39_80_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_39_80_41&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_varref"><span class="mpre">updAdjList</span></span></a><span class="mpre"> </span><a href="#loc_77_37_77_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_37_77_38&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_75_15_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_16&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_75_21_75_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_23&#39;)"><span class="hl_varref"><span class="mpre">cf</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Compute the flow from s to t on a graph whose edges are labeled with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (x,y,z)=(max capacity,current flow,residual capacity) and all edges</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- are of the form a\&lt;----&gt;b. First compute the residual graph, that is,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- delete those edges whose residual capacity is zero. Then compute the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- shortest augmenting path from s to t, and finally update the flow and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- residual capacity along that path by using the minimum capacity of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that path. Repeat this process until no shortest path from s to t exist.</span></span><span class="mpre">
</span><a href="#loc_90_1_90_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_5&#39;)"><span class="mpre">mfmg</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 9, srcSpanEndLine = 89, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 9, srcSpanEndLine = 89, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Induc"><span class="mpre">(DynGraph gr,Num b,Ord b) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_90_1_90_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_5&#39;)"><span class="hl_fundecl"><span class="mpre">mfmg</span></span></a><span class="mpre"> </span><a name="loc_90_6_90_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_7&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_90_8_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_8_90_9&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_90_10_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_10_90_11&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> | </span><a href="#loc_93_20_93_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_20_93_27&#39;)"><span class="hl_varref"><span class="mpre">augPath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> [] = </span><a href="#loc_90_6_90_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_7&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><a href="#loc_90_1_90_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_5&#39;)"><span class="hl_varref"><span class="mpre">mfmg</span></span></a><span class="mpre"> (</span><a href="#loc_73_1_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_11&#39;)"><span class="hl_varref"><span class="mpre">updateFlow</span></span></a><span class="mpre"> </span><a href="#loc_93_20_93_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_20_93_27&#39;)"><span class="hl_varref"><span class="mpre">augPath</span></span></a><span class="mpre"> </span><a href="#loc_92_20_92_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_20_92_24&#39;)"><span class="hl_varref"><span class="mpre">minC</span></span></a><span class="mpre"> </span><a href="#loc_90_6_90_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_7&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) </span><a href="#loc_90_8_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_8_90_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_90_10_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_10_90_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
             where </span><a name="loc_92_20_92_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_20_92_24&#39;)"><span class="hl_vardecl"><span class="mpre">minC</span></span></a><span class="mpre">        = </span><a href="Data.List.html#loc_544_1_544_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_544_1_544_8&#39;)"><span class="hl_varref"><span class="mpre">minimum</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> ((\(_,_,</span><a name="loc_92_55_92_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_55_92_56&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">)-&gt;</span><a href="#loc_92_55_92_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_55_92_56&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">)(</span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><a href="#loc_94_23_94_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_23_94_31&#39;)"><span class="hl_varref"><span class="mpre">augLPath</span></span></a><span class="mpre">))
                   </span><a name="loc_93_20_93_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_20_93_27&#39;)"><span class="hl_vardecl"><span class="mpre">augPath</span></span></a><span class="mpre">     = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="#loc_94_23_94_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_23_94_31&#39;)"><span class="hl_varref"><span class="mpre">augLPath</span></span></a><span class="mpre">
                   </span><a href="Data.Graph.Inductive.Graph.html#loc_149_19_149_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_149_19_149_21&#39;)"><span class="hl_conref"><span class="mpre">LP</span></span></a><span class="mpre"> </span><a name="loc_94_23_94_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_23_94_31&#39;)"><span class="hl_vardecl"><span class="mpre">augLPath</span></span></a><span class="mpre"> = </span><a href="Data.Graph.Inductive.Query.BFS.html#loc_130_1_130_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Query.BFS.html#loc_130_1_130_5&#39;)"><span class="hl_varref"><span class="mpre">lesp</span></span></a><span class="mpre"> </span><a href="#loc_90_8_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_8_90_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_90_10_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_10_90_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_95_20_95_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_20_95_22&#39;)"><span class="hl_varref"><span class="mpre">gf</span></span></a><span class="mpre">
                   </span><a name="loc_95_20_95_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_20_95_22&#39;)"><span class="hl_vardecl"><span class="mpre">gf</span></span></a><span class="mpre">          = </span><a href="Data.Graph.Inductive.Basic.html#loc_65_1_65_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Basic.html#loc_65_1_65_9&#39;)"><span class="hl_varref"><span class="mpre">elfilter</span></span></a><span class="mpre"> (\(_,_,</span><a name="loc_95_50_95_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_50_95_51&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">)-&gt;</span><a href="#loc_95_50_95_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_50_95_51&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="hl_infix"><span class="mpre">/=</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><a href="#loc_90_6_90_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_7&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Compute the flow from s to t on a graph whose edges are labeled with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- x, which is the max capacity and where not all edges need to be of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- form a\&lt;----&gt;b. Return the flow as a grap whose edges are labeled with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (x,y,z)=(max capacity,current flow,residual capacity) and all edges</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- are of the form a\&lt;----&gt;b</span></span><span class="mpre">
</span><a href="#loc_103_1_103_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_3&#39;)"><span class="mpre">mf</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 102, srcSpanStartColumn = 7, srcSpanEndLine = 102, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 102, srcSpanStartColumn = 7, srcSpanEndLine = 102, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/In"><span class="mpre">(DynGraph gr,Num b,Ord b) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_103_1_103_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_3&#39;)"><span class="hl_fundecl"><span class="mpre">mf</span></span></a><span class="mpre"> </span><a name="loc_103_4_103_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_4_103_5&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_103_6_103_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_6_103_7&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_103_8_103_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_8_103_9&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_90_1_90_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_5&#39;)"><span class="hl_varref"><span class="mpre">mfmg</span></span></a><span class="mpre"> (</span><a href="#loc_57_1_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_13&#39;)"><span class="hl_varref"><span class="mpre">augmentGraph</span></span></a><span class="mpre"> </span><a href="#loc_103_4_103_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_4_103_5&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) </span><a href="#loc_103_6_103_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_6_103_7&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_103_8_103_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_8_103_9&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Compute the maximum flow from s to t on a graph whose edges are labeled</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with x, which is the max capacity and where not all edges need to be of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the form a\&lt;----&gt;b. Return the flow as a grap whose edges are labeled with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (y,x) = (current flow, max capacity).</span></span><span class="mpre">
</span><a href="#loc_110_1_110_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_13&#39;)"><span class="mpre">maxFlowgraph</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 109, srcSpanStartColumn = 17, srcSpanEndLine = 109, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 109, srcSpanStartColumn = 17, srcSpanEndLine = 109, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph"><span class="mpre">(DynGraph gr,Num b,Ord b) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_110_1_110_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_13&#39;)"><span class="hl_fundecl"><span class="mpre">maxFlowgraph</span></span></a><span class="mpre"> </span><a name="loc_110_14_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_14_110_15&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_110_16_110_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_16_110_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_110_18_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_18_110_19&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="Data.Graph.Inductive.Graph.html#loc_227_1_227_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_227_1_227_5&#39;)"><span class="hl_varref"><span class="mpre">emap</span></span></a><span class="mpre"> (\(</span><a name="loc_110_30_110_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_30_110_31&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">,</span><a name="loc_110_32_110_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_32_110_33&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,_)-&gt;(</span><a href="#loc_110_32_110_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_32_110_33&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_110_30_110_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_30_110_31&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">)) </span><a href="#loc_111_34_111_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_34_111_36&#39;)"><span class="hl_varref"><span class="mpre">g2</span></span></a><span class="mpre">
                           where </span><a name="loc_111_34_111_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_34_111_36&#39;)"><span class="hl_vardecl"><span class="mpre">g2</span></span></a><span class="mpre"> = </span><a href="Data.Graph.Inductive.Basic.html#loc_65_1_65_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Basic.html#loc_65_1_65_9&#39;)"><span class="hl_varref"><span class="mpre">elfilter</span></span></a><span class="mpre"> (\(</span><a name="loc_111_51_111_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_51_111_52&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,_,_)-&gt;</span><a href="#loc_111_51_111_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_51_111_52&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">/=</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><a href="#loc_112_34_112_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_34_112_36&#39;)"><span class="hl_varref"><span class="mpre">g1</span></span></a><span class="mpre">
                                 </span><a name="loc_112_34_112_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_34_112_36&#39;)"><span class="hl_vardecl"><span class="mpre">g1</span></span></a><span class="mpre"> = </span><a href="#loc_103_1_103_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_3&#39;)"><span class="hl_varref"><span class="mpre">mf</span></span></a><span class="mpre"> </span><a href="#loc_110_14_110_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_14_110_15&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_110_16_110_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_16_110_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_110_18_110_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_18_110_19&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Compute the value of a maximumflow</span></span><span class="mpre">
</span><a href="#loc_116_1_116_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_8&#39;)"><span class="mpre">maxFlow</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 115, srcSpanStartColumn = 12, srcSpanEndLine = 115, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/MaxFlow.hs&quot;, srcSpanStartLine = 115, srcSpanStartColumn = 12, srcSpanEndLine = 115, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph"><span class="mpre">(DynGraph gr,Num b,Ord b) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_116_1_116_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_8&#39;)"><span class="hl_fundecl"><span class="mpre">maxFlow</span></span></a><span class="mpre"> </span><a name="loc_116_9_116_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_10&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_116_11_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_116_13_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_13_116_14&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(+)</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(_,_,(</span><a name="loc_116_42_116_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_42_116_43&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,_))-&gt;</span><a href="#loc_116_42_116_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_42_116_43&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)(</span><a href="Data.Graph.Inductive.Graph.html#loc_335_1_335_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_335_1_335_4&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre"> (</span><a href="#loc_110_1_110_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_13&#39;)"><span class="hl_varref"><span class="mpre">maxFlowgraph</span></span></a><span class="mpre"> </span><a href="#loc_116_9_116_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_116_11_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_116_13_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_13_116_14&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><a href="#loc_116_11_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Some test cases: clr595 is from the CLR textbook, page 595. The value of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the maximum flow for s=1 and t=6 (23) coincides with the example but the </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- flow itself is slightly different since the textbook does not compute the </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- shortest augmenting path from s to t, but just any path. However remember </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that for a given flow graph the maximum flow is not unique.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (gr595 is defined in GraphData.hs)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">


</span></div></body></html>