<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | Miscellaneous testing utilities</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
{-# LANGUAGE ScopedTypeVariables #-}
module Tests.Utils
    (
      (=^=)
    , withRedirect
    , withTempFile
    ) where

import Control.Exception (SomeException, </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="mpre">bracket</span></a><span class="mpre">, </span><a href="Control.Exception.Base.html#loc_282_1_282_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_282_1_282_9&#39;)"><span class="mpre">bracket_</span></a><span class="mpre">, </span><a href="GHC.IO.html#loc_480_1_480_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_480_1_480_9&#39;)"><span class="mpre">evaluate</span></a><span class="mpre">, </span><a href="Control.Exception.Base.html#loc_212_1_212_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_212_1_212_4&#39;)"><span class="mpre">try</span></a><span class="mpre">)
import Control.Monad (</span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">)
import Debug.Trace (</span><a href="Debug.Trace.html#loc_103_1_103_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Debug.Trace.html#loc_103_1_103_6&#39;)"><span class="mpre">trace</span></a><span class="mpre">)
import GHC.IO.Handle.Internals (</span><a href="GHC.IO.Handle.Internals.html#loc_125_1_125_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_125_1_125_11&#39;)"><span class="mpre">withHandle</span></a><span class="mpre">)
import System.Directory (</span><a href="System.Directory.html#loc_400_1_400_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_400_1_400_11&#39;)"><span class="mpre">removeFile</span></a><span class="mpre">)
import System.IO (</span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="mpre">Handle</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="mpre">hClose</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="mpre">hFlush</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.html#loc_447_1_447_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_447_1_447_8&#39;)"><span class="mpre">hIsOpen</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.html#loc_481_1_481_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_481_1_481_12&#39;)"><span class="mpre">hIsWritable</span></a><span class="mpre">, </span><a href="System.IO.html#loc_445_1_445_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_445_1_445_13&#39;)"><span class="mpre">openTempFile</span></a><span class="mpre">)
import System.IO.Unsafe (</span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="mpre">unsafePerformIO</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Ensure that two potentially bottom values (in the sense of crashing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for some inputs, not looping infinitely) either both crash, or both</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- give comparable results for some input.</span></span><span class="mpre">
</span><a href="#loc_23_3_23_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_3_23_6&#39;)"><span class="mpre">(=^=)</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/tests/Tests/Utils.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 10, srcSpanEndLine = 22, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/tests/Tests/Utils.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 10, srcSpanEndLine = 22, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/tests/Tests/Utils.hs&quot;, srcSpanStartLine = 22,"><span class="mpre">(Eq a, Show a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_23_1_23_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_2&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_23_3_23_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_3_23_6&#39;)"><span class="hl_fundecl"><span class="mpre">=^=</span></span></a><span class="mpre"> </span><a name="loc_23_7_23_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_7_23_8&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
  </span><a name="loc_24_3_24_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_3_24_4&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Exception.Base.html#loc_212_1_212_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_212_1_212_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> (</span><a href="GHC.IO.html#loc_480_1_480_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_480_1_480_9&#39;)"><span class="hl_varref"><span class="mpre">evaluate</span></span></a><span class="mpre"> </span><a href="#loc_23_1_23_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_2&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
  </span><a name="loc_25_3_25_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_3_25_4&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Exception.Base.html#loc_212_1_212_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_212_1_212_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> (</span><a href="GHC.IO.html#loc_480_1_480_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_480_1_480_9&#39;)"><span class="hl_varref"><span class="mpre">evaluate</span></span></a><span class="mpre"> </span><a href="#loc_23_7_23_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_7_23_8&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">)
  case (</span><a href="#loc_24_3_24_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_3_24_4&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_25_3_25_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_3_25_4&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) of
    (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (_ :: </span><span class="hl_tyconref"><span class="mpre">SomeException</span></span><span class="mpre">), </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (_ :: </span><span class="hl_tyconref"><span class="mpre">SomeException</span></span><span class="mpre">))
                       -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_29_12_29_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_12_29_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_29_21_29_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_21_29_22&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_29_12_29_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_12_29_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_29_21_29_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_21_29_22&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
    </span><a name="loc_30_5_30_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_5_30_6&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">                  -&gt; </span><a href="Debug.Trace.html#loc_103_1_103_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Debug.Trace.html#loc_103_1_103_6&#39;)"><span class="hl_varref"><span class="mpre">trace</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;*** Divergence: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_30_5_30_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_5_30_6&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">) </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/tests/Tests/Utils.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 1, srcSpanEndLine = 31, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/tests/Tests/Utils.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 7, srcSpanEndLine = 31, srcSpanEndColumn = 8}]}) (AssocNone (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/test"><span class="mpre">infix 4 =^=</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_23_3_23_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_3_23_6&#39;)"><span class="mpre">(=^=)</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="mpre">withTempFile</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_35_1_35_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_13&#39;)"><span class="hl_vardecl"><span class="mpre">withTempFile</span></span></a><span class="mpre"> = </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">bracket</span></span></a><span class="mpre"> (</span><a href="System.IO.html#loc_445_1_445_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_445_1_445_13&#39;)"><span class="hl_varref"><span class="mpre">openTempFile</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;crashy.txt&quot;</span></span><span class="mpre">) </span><a href="#loc_37_5_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_16&#39;)"><span class="hl_varref"><span class="mpre">cleanupTemp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">uncurry</span></span><span class="mpre">
  where
    </span><a name="loc_37_5_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_16&#39;)"><span class="hl_fundecl"><span class="mpre">cleanupTemp</span></span></a><span class="mpre"> (</span><a name="loc_37_18_37_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_18_37_22&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre">,</span><a name="loc_37_23_37_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_23_37_24&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">) = do
      </span><a name="loc_38_7_38_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_11&#39;)"><span class="hl_vardecl"><span class="mpre">open</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Handle.html#loc_447_1_447_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_447_1_447_8&#39;)"><span class="hl_varref"><span class="mpre">hIsOpen</span></span></a><span class="mpre"> </span><a href="#loc_37_23_37_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_23_37_24&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
      </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> </span><a href="#loc_38_7_38_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_11&#39;)"><span class="hl_varref"><span class="mpre">open</span></span></a><span class="mpre"> (</span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre"> </span><a href="#loc_37_23_37_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_23_37_24&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">)
      </span><a href="System.Directory.html#loc_400_1_400_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_400_1_400_11&#39;)"><span class="hl_varref"><span class="mpre">removeFile</span></span></a><span class="mpre"> </span><a href="#loc_37_18_37_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_18_37_22&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">

</span><a href="#loc_43_1_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_13&#39;)"><span class="mpre">withRedirect</span></a><span class="mpre"> :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_43_1_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_13&#39;)"><span class="hl_fundecl"><span class="mpre">withRedirect</span></span></a><span class="mpre"> </span><a name="loc_43_14_43_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_14_43_17&#39;)"><span class="hl_vardecl"><span class="mpre">tmp</span></span></a><span class="mpre"> </span><a name="loc_43_18_43_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_18_43_19&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = </span><a href="Control.Exception.Base.html#loc_282_1_282_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_282_1_282_9&#39;)"><span class="hl_varref"><span class="mpre">bracket_</span></span></a><span class="mpre"> </span><a href="#loc_46_5_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_9&#39;)"><span class="hl_varref"><span class="mpre">swap</span></span></a><span class="mpre"> </span><a href="#loc_46_5_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_9&#39;)"><span class="hl_varref"><span class="mpre">swap</span></span></a><span class="mpre">
  where
    </span><a name="loc_45_5_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_10&#39;)"><span class="hl_fundecl"><span class="mpre">whenM</span></span></a><span class="mpre"> </span><a name="loc_45_11_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_11_45_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_45_13_45_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_14&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_45_11_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_11_45_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> (</span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_infix"><span class="mpre">`when`</span></span></a><span class="mpre"> </span><a href="#loc_45_13_45_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_14&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
    </span><a name="loc_46_5_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_9&#39;)"><span class="hl_vardecl"><span class="mpre">swap</span></span></a><span class="mpre"> = do
      </span><a href="#loc_45_5_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_10&#39;)"><span class="hl_varref"><span class="mpre">whenM</span></span></a><span class="mpre"> (</span><a href="GHC.IO.Handle.html#loc_447_1_447_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_447_1_447_8&#39;)"><span class="hl_varref"><span class="mpre">hIsOpen</span></span></a><span class="mpre"> </span><a href="#loc_43_14_43_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_14_43_17&#39;)"><span class="hl_varref"><span class="mpre">tmp</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_45_5_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_10&#39;)"><span class="hl_varref"><span class="mpre">whenM</span></span></a><span class="mpre"> (</span><a href="GHC.IO.Handle.html#loc_481_1_481_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_481_1_481_12&#39;)"><span class="hl_varref"><span class="mpre">hIsWritable</span></span></a><span class="mpre"> </span><a href="#loc_43_14_43_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_14_43_17&#39;)"><span class="hl_varref"><span class="mpre">tmp</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">hFlush</span></span></a><span class="mpre"> </span><a href="#loc_43_14_43_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_14_43_17&#39;)"><span class="hl_varref"><span class="mpre">tmp</span></span></a><span class="mpre">
      </span><a href="#loc_45_5_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_10&#39;)"><span class="hl_varref"><span class="mpre">whenM</span></span></a><span class="mpre"> (</span><a href="GHC.IO.Handle.html#loc_447_1_447_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_447_1_447_8&#39;)"><span class="hl_varref"><span class="mpre">hIsOpen</span></span></a><span class="mpre"> </span><a href="#loc_43_18_43_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_18_43_19&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_45_5_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_10&#39;)"><span class="hl_varref"><span class="mpre">whenM</span></span></a><span class="mpre"> (</span><a href="GHC.IO.Handle.html#loc_481_1_481_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_481_1_481_12&#39;)"><span class="hl_varref"><span class="mpre">hIsWritable</span></span></a><span class="mpre"> </span><a href="#loc_43_18_43_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_18_43_19&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">hFlush</span></span></a><span class="mpre"> </span><a href="#loc_43_18_43_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_18_43_19&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
      </span><a href="GHC.IO.Handle.Internals.html#loc_125_1_125_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_125_1_125_11&#39;)"><span class="hl_varref"><span class="mpre">withHandle</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;spam&quot;</span></span><span class="mpre"> </span><a href="#loc_43_14_43_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_14_43_17&#39;)"><span class="hl_varref"><span class="mpre">tmp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_49_32_49_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_32_49_36&#39;)"><span class="hl_vardecl"><span class="mpre">tmph</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_50_9_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_11&#39;)"><span class="hl_vardecl"><span class="mpre">hh</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Handle.Internals.html#loc_125_1_125_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Internals.html#loc_125_1_125_11&#39;)"><span class="hl_varref"><span class="mpre">withHandle</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;spam&quot;</span></span><span class="mpre"> </span><a href="#loc_43_18_43_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_18_43_19&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_50_38_50_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_38_50_40&#39;)"><span class="hl_vardecl"><span class="mpre">hh</span></span></a><span class="mpre"> -&gt;
          </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_49_32_49_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_32_49_36&#39;)"><span class="hl_varref"><span class="mpre">tmph</span></span></a><span class="mpre">,</span><a href="#loc_50_38_50_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_38_50_40&#39;)"><span class="hl_varref"><span class="mpre">hh</span></span></a><span class="mpre">)
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_50_9_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_11&#39;)"><span class="hl_varref"><span class="mpre">hh</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)
</span></div></body></html>