<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
#if __GLASGOW_HASKELL__ &gt;= 703
{-# LANGUAGE Safe #-}
#endif
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : judah.jacobson@gmail.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : portable (FFI)</span></span><span class="mpre">
module System.Console.Terminfo.Color(
                    termColors,
                    Color(..),
                    </span><span class="hl_comment"><span class="mpre">-- ColorPair,</span></span><span class="mpre">
                    withForegroundColor,
                    withBackgroundColor,
                    </span><span class="hl_comment"><span class="mpre">-- withColorPair,</span></span><span class="mpre">
                    setForegroundColor,
                    setBackgroundColor,
                    </span><span class="hl_comment"><span class="mpre">-- setColorPair,</span></span><span class="mpre">
                    restoreDefaultColors
                    ) where

import System.Console.Terminfo.Base
import Control.Monad (</span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="mpre">mplus</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- TODOs:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- examples</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- try with xterm-256-colors (?)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Color pairs, and HP terminals.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- TODO: this &quot;white&quot; looks more like a grey.  (What does ncurses do?)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- NB: for all the terminals in ncurses&#39; terminfo.src, colors&gt;=8 when it&#39;s</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- set.  So we don&#39;t need to perform that check.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The maximum number of of colors on the screen.</span></span><span class="mpre">
</span><a href="#loc_36_1_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_11&#39;)"><span class="mpre">termColors</span></a><span class="mpre"> :: </span><a href="System.Console.Terminfo.Base.html#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_36_1_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_11&#39;)"><span class="hl_vardecl"><span class="mpre">termColors</span></span></a><span class="mpre"> = </span><a href="System.Console.Terminfo.Base.html#loc_226_1_226_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_226_1_226_9&#39;)"><span class="hl_varref"><span class="mpre">tiGetNum</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;colors&quot;</span></span><span class="mpre">

data </span><a name="loc_38_6_38_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_11&#39;)"><span class="hl_tycondecl"><span class="mpre">Color</span></span></a><span class="mpre"> = </span><a name="loc_38_14_38_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_14_38_19&#39;)"><span class="hl_condecl"><span class="mpre">Black</span></span></a><span class="mpre"> | </span><a name="loc_38_22_38_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_22_38_25&#39;)"><span class="hl_condecl"><span class="mpre">Red</span></span></a><span class="mpre"> | </span><a name="loc_38_28_38_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_28_38_33&#39;)"><span class="hl_condecl"><span class="mpre">Green</span></span></a><span class="mpre"> | </span><a name="loc_38_36_38_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_36_38_42&#39;)"><span class="hl_condecl"><span class="mpre">Yellow</span></span></a><span class="mpre"> | </span><a name="loc_38_45_38_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_45_38_49&#39;)"><span class="hl_condecl"><span class="mpre">Blue</span></span></a><span class="mpre"> | </span><a name="loc_38_52_38_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_52_38_59&#39;)"><span class="hl_condecl"><span class="mpre">Magenta</span></span></a><span class="mpre"> | </span><a name="loc_38_62_38_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_62_38_66&#39;)"><span class="hl_condecl"><span class="mpre">Cyan</span></span></a><span class="mpre">
            | </span><a name="loc_39_15_39_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_15_39_20&#39;)"><span class="hl_condecl"><span class="mpre">White</span></span></a><span class="mpre"> | </span><a name="loc_39_23_39_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_23_39_34&#39;)"><span class="hl_condecl"><span class="mpre">ColorNumber</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Color.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 9, srcSpanEndLine = 40, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Color.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 9, srcSpanEndLine = 40, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Con"><span class="mpre">deriving (Show,Eq,Ord)</span></span><span class="mpre">



</span><a href="#loc_45_1_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_10&#39;)"><span class="mpre">colorIntA</span></a><span class="mpre">, </span><a href="#loc_55_1_55_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_9&#39;)"><span class="mpre">colorInt</span></a><span class="mpre"> :: </span><a href="#loc_38_6_38_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_11&#39;)"><span class="hl_tyconref"><span class="mpre">Color</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_45_1_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_10&#39;)"><span class="hl_fundecl"><span class="mpre">colorIntA</span></span></a><span class="mpre"> </span><a name="loc_45_11_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_11_45_12&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = case </span><a href="#loc_45_11_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_11_45_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> of
    </span><a href="#loc_38_14_38_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_14_38_19&#39;)"><span class="hl_conref"><span class="mpre">Black</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><a href="#loc_38_22_38_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_22_38_25&#39;)"><span class="hl_conref"><span class="mpre">Red</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    </span><a href="#loc_38_28_38_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_28_38_33&#39;)"><span class="hl_conref"><span class="mpre">Green</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
    </span><a href="#loc_38_36_38_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_36_38_42&#39;)"><span class="hl_conref"><span class="mpre">Yellow</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">
    </span><a href="#loc_38_45_38_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_45_38_49&#39;)"><span class="hl_conref"><span class="mpre">Blue</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">
    </span><a href="#loc_38_52_38_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_52_38_59&#39;)"><span class="hl_conref"><span class="mpre">Magenta</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">
    </span><a href="#loc_38_62_38_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_62_38_66&#39;)"><span class="hl_conref"><span class="mpre">Cyan</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">
    </span><a href="#loc_39_15_39_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_15_39_20&#39;)"><span class="hl_conref"><span class="mpre">White</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">
    </span><a href="#loc_39_23_39_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_23_39_34&#39;)"><span class="hl_conref"><span class="mpre">ColorNumber</span></span></a><span class="mpre"> </span><a name="loc_54_17_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_54_17_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_17_54_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
</span><a name="loc_55_1_55_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_9&#39;)"><span class="hl_fundecl"><span class="mpre">colorInt</span></span></a><span class="mpre"> </span><a name="loc_55_10_55_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_10_55_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = case </span><a href="#loc_55_10_55_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_10_55_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> of
    </span><a href="#loc_38_14_38_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_14_38_19&#39;)"><span class="hl_conref"><span class="mpre">Black</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><a href="#loc_38_45_38_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_45_38_49&#39;)"><span class="hl_conref"><span class="mpre">Blue</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    </span><a href="#loc_38_28_38_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_28_38_33&#39;)"><span class="hl_conref"><span class="mpre">Green</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
    </span><a href="#loc_38_62_38_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_62_38_66&#39;)"><span class="hl_conref"><span class="mpre">Cyan</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">
    </span><a href="#loc_38_22_38_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_22_38_25&#39;)"><span class="hl_conref"><span class="mpre">Red</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">
    </span><a href="#loc_38_52_38_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_52_38_59&#39;)"><span class="hl_conref"><span class="mpre">Magenta</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">
    </span><a href="#loc_38_36_38_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_36_38_42&#39;)"><span class="hl_conref"><span class="mpre">Yellow</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">
    </span><a href="#loc_39_15_39_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_15_39_20&#39;)"><span class="hl_conref"><span class="mpre">White</span></span></a><span class="mpre"> -&gt; </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre">
    </span><a href="#loc_39_23_39_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_23_39_34&#39;)"><span class="hl_conref"><span class="mpre">ColorNumber</span></span></a><span class="mpre"> </span><a name="loc_64_17_64_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_17_64_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_64_17_64_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_17_64_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- NB these aren&#39;t available on HP systems.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- also do we want to handle case when they&#39;re not available?</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This capability temporarily sets the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- terminal&#39;s foreground color while outputting the given text, and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- then restores the terminal to its default foreground and background</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- colors.</span></span><span class="mpre">
</span><a href="#loc_75_1_75_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_20&#39;)"><span class="mpre">withForegroundColor</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Color.hs&quot;, srcSpanStartLine = 74, srcSpanStartColumn = 24, srcSpanEndLine = 74, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Color.hs&quot;, srcSpanStartLine = 74, srcSpanStartColumn = 34, srcSpanEndLine = 74, srcSpanEndColumn = 36}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">TermStr s =&gt;</span></span><span class="mpre"> </span><a href="System.Console.Terminfo.Base.html#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> (</span><a href="#loc_38_6_38_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_11&#39;)"><span class="hl_tyconref"><span class="mpre">Color</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)
</span><a name="loc_75_1_75_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_20&#39;)"><span class="hl_vardecl"><span class="mpre">withForegroundColor</span></span></a><span class="mpre"> = </span><a href="#loc_86_1_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_13&#39;)"><span class="hl_varref"><span class="mpre">withColorCmd</span></span></a><span class="mpre"> </span><a href="#loc_94_1_94_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_19&#39;)"><span class="hl_varref"><span class="mpre">setForegroundColor</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This capability temporarily sets the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- terminal&#39;s background color while outputting the given text, and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- then restores the terminal to its default foreground and background</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- colors.</span></span><span class="mpre">
</span><a href="#loc_82_1_82_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_20&#39;)"><span class="mpre">withBackgroundColor</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Color.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 24, srcSpanEndLine = 81, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Color.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 34, srcSpanEndLine = 81, srcSpanEndColumn = 36}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">TermStr s =&gt;</span></span><span class="mpre"> </span><a href="System.Console.Terminfo.Base.html#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> (</span><a href="#loc_38_6_38_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_11&#39;)"><span class="hl_tyconref"><span class="mpre">Color</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)
</span><a name="loc_82_1_82_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_20&#39;)"><span class="hl_vardecl"><span class="mpre">withBackgroundColor</span></span></a><span class="mpre"> = </span><a href="#loc_86_1_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_13&#39;)"><span class="hl_varref"><span class="mpre">withColorCmd</span></span></a><span class="mpre"> </span><a href="#loc_102_1_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_19&#39;)"><span class="hl_varref"><span class="mpre">setBackgroundColor</span></span></a><span class="mpre">

</span><a href="#loc_86_1_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_13&#39;)"><span class="mpre">withColorCmd</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Color.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 17, srcSpanEndLine = 84, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Color.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 27, srcSpanEndLine = 84, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">TermStr s =&gt;</span></span><span class="mpre"> </span><a href="System.Console.Terminfo.Base.html#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)
            -&gt; </span><a href="System.Console.Terminfo.Base.html#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)
</span><a name="loc_86_1_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_13&#39;)"><span class="hl_fundecl"><span class="mpre">withColorCmd</span></span></a><span class="mpre"> </span><a name="loc_86_14_86_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_20&#39;)"><span class="hl_vardecl"><span class="mpre">getSet</span></span></a><span class="mpre"> = do
    </span><a name="loc_87_5_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_8&#39;)"><span class="hl_vardecl"><span class="mpre">set</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_86_14_86_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_20&#39;)"><span class="hl_varref"><span class="mpre">getSet</span></span></a><span class="mpre">
    </span><a name="loc_88_5_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_5_88_12&#39;)"><span class="hl_vardecl"><span class="mpre">restore</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_124_1_124_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_21&#39;)"><span class="hl_varref"><span class="mpre">restoreDefaultColors</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_89_15_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_15_89_16&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_89_17_89_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_17_89_18&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_87_5_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_8&#39;)"><span class="hl_varref"><span class="mpre">set</span></span></a><span class="mpre"> </span><a href="#loc_89_15_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_15_89_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="System.Console.Terminfo.Base.html#loc_184_1_184_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_184_1_184_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;#&gt;</span></span></a><span class="mpre"> </span><a href="#loc_89_17_89_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_17_89_18&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="System.Console.Terminfo.Base.html#loc_184_1_184_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_184_1_184_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;#&gt;</span></span></a><span class="mpre"> </span><a href="#loc_88_5_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_5_88_12&#39;)"><span class="hl_varref"><span class="mpre">restore</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Sets the foreground color of all further text output, using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- either the @setaf@ or @setf@ capability.</span></span><span class="mpre">
</span><a href="#loc_94_1_94_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_19&#39;)"><span class="mpre">setForegroundColor</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Color.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 23, srcSpanEndLine = 93, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Color.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 33, srcSpanEndLine = 93, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagran"><span class="mpre">TermStr s =&gt;</span></span><span class="mpre"> </span><a href="System.Console.Terminfo.Base.html#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> (</span><a href="#loc_38_6_38_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_11&#39;)"><span class="hl_tyconref"><span class="mpre">Color</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)
</span><a name="loc_94_1_94_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_19&#39;)"><span class="hl_vardecl"><span class="mpre">setForegroundColor</span></span></a><span class="mpre"> = </span><a href="#loc_96_9_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_9_96_14&#39;)"><span class="hl_varref"><span class="mpre">setaf</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_97_9_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_13&#39;)"><span class="hl_varref"><span class="mpre">setf</span></span></a><span class="mpre">
    where
        </span><a name="loc_96_9_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_9_96_14&#39;)"><span class="hl_vardecl"><span class="mpre">setaf</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_45_1_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_10&#39;)"><span class="hl_varref"><span class="mpre">colorIntA</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.Console.Terminfo.Base.html#loc_321_1_321_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_321_1_321_13&#39;)"><span class="hl_varref"><span class="mpre">tiGetOutput1</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;setaf&quot;</span></span><span class="mpre">
        </span><a name="loc_97_9_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_13&#39;)"><span class="hl_vardecl"><span class="mpre">setf</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_55_1_55_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_9&#39;)"><span class="hl_varref"><span class="mpre">colorInt</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.Console.Terminfo.Base.html#loc_321_1_321_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_321_1_321_13&#39;)"><span class="hl_varref"><span class="mpre">tiGetOutput1</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;setf&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Sets the background color of all further text output, using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- either the @setab@ or @setb@ capability.</span></span><span class="mpre">
</span><a href="#loc_102_1_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_19&#39;)"><span class="mpre">setBackgroundColor</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Color.hs&quot;, srcSpanStartLine = 101, srcSpanStartColumn = 23, srcSpanEndLine = 101, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Color.hs&quot;, srcSpanStartLine = 101, srcSpanStartColumn = 33, srcSpanEndLine = 101, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/va"><span class="mpre">TermStr s =&gt;</span></span><span class="mpre"> </span><a href="System.Console.Terminfo.Base.html#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> (</span><a href="#loc_38_6_38_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_11&#39;)"><span class="hl_tyconref"><span class="mpre">Color</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)
</span><a name="loc_102_1_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_19&#39;)"><span class="hl_vardecl"><span class="mpre">setBackgroundColor</span></span></a><span class="mpre"> = </span><a href="#loc_104_9_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_14&#39;)"><span class="hl_varref"><span class="mpre">setab</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_105_9_105_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_13&#39;)"><span class="hl_varref"><span class="mpre">setb</span></span></a><span class="mpre">
    where
        </span><a name="loc_104_9_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_14&#39;)"><span class="hl_vardecl"><span class="mpre">setab</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_45_1_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_10&#39;)"><span class="hl_varref"><span class="mpre">colorIntA</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.Console.Terminfo.Base.html#loc_321_1_321_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_321_1_321_13&#39;)"><span class="hl_varref"><span class="mpre">tiGetOutput1</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;setab&quot;</span></span><span class="mpre">
        </span><a name="loc_105_9_105_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_9_105_13&#39;)"><span class="hl_vardecl"><span class="mpre">setb</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_55_1_55_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_9&#39;)"><span class="hl_varref"><span class="mpre">colorInt</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.Console.Terminfo.Base.html#loc_321_1_321_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_321_1_321_13&#39;)"><span class="hl_varref"><span class="mpre">tiGetOutput1</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;setb&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
withColorPair :: TermStr s =&gt; Capability (ColorPair -&gt; s -&gt; s)
withColorPair = withColorCmd setColorPair

setColorPair :: TermStr s =&gt; Capability (ColorPair -&gt; s)
setColorPair = do
    setf &lt;- setForegroundColor
    setb &lt;- setBackgroundColor
    return (\(f,b) -&gt; setf f &lt;#&gt; setb b)

type ColorPair = (Color,Color)
-}</span></span><span class="mpre">  


</span><span class="hl_comment"><span class="mpre">-- | Restores foreground/background colors to their original</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- settings.</span></span><span class="mpre">
</span><a href="#loc_124_1_124_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_21&#39;)"><span class="mpre">restoreDefaultColors</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Color.hs&quot;, srcSpanStartLine = 123, srcSpanStartColumn = 25, srcSpanEndLine = 123, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/terminfo-0.4.0.0/System/Console/Terminfo/Color.hs&quot;, srcSpanStartLine = 123, srcSpanStartColumn = 35, srcSpanEndLine = 123, srcSpanEndColumn = 37}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/va"><span class="mpre">TermStr s =&gt;</span></span><span class="mpre"> </span><a href="System.Console.Terminfo.Base.html#loc_188_9_188_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_188_9_188_19&#39;)"><span class="hl_tyconref"><span class="mpre">Capability</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> 
</span><a name="loc_124_1_124_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_21&#39;)"><span class="hl_vardecl"><span class="mpre">restoreDefaultColors</span></span></a><span class="mpre"> = </span><a href="System.Console.Terminfo.Base.html#loc_321_1_321_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Terminfo.Base.html#loc_321_1_321_13&#39;)"><span class="hl_varref"><span class="mpre">tiGetOutput1</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;op&quot;</span></span><span class="mpre">
</span></div></body></html>