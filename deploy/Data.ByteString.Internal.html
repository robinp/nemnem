<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, ForeignFunctionInterface, BangPatterns #-}
#if __GLASGOW_HASKELL__
{-# LANGUAGE UnliftedFFITypes, MagicHash,
            UnboxedTuples, DeriveDataTypeable #-}
#if __GLASGOW_HASKELL__ &gt;= 701
{-# LANGUAGE Unsafe #-}
#endif
#endif
{-# OPTIONS_HADDOCK hide #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.ByteString.Internal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) Don Stewart 2006-2008</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               (c) Duncan Coutts 2006-2012</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : dons00@gmail.com, duncan@community.haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : unstable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : non-portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A module containing semi-public &#39;ByteString&#39; internals. This exposes the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;ByteString&#39; representation and low level construction functions. As such</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- all the functions in this module are unsafe. The API is also not stable.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Where possible application should instead use the functions from the normal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- public interface modules, such as &quot;Data.ByteString.Unsafe&quot;. Packages that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- extend the ByteString system at a low level will need to use this module.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.ByteString.Internal (

        </span><span class="hl_comment"><span class="mpre">-- * The @ByteString@ type and representation</span></span><span class="mpre">
        ByteString(..),         </span><span class="hl_comment"><span class="mpre">-- instances: Eq, Ord, Show, Read, Data, Typeable</span></span><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- * Conversion with lists: packing and unpacking</span></span><span class="mpre">
        packBytes, packUptoLenBytes, unsafePackLenBytes,
        packChars, packUptoLenChars, unsafePackLenChars,
        unpackBytes, unpackAppendBytesLazy, unpackAppendBytesStrict,
        unpackChars, unpackAppendCharsLazy, unpackAppendCharsStrict,
#if defined(__GLASGOW_HASKELL__)
        unsafePackAddress,
#endif

        </span><span class="hl_comment"><span class="mpre">-- * Low level imperative construction</span></span><span class="mpre">
        create,                 </span><span class="hl_comment"><span class="mpre">-- :: Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString</span></span><span class="mpre">
        createUptoN,            </span><span class="hl_comment"><span class="mpre">-- :: Int -&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO ByteString</span></span><span class="mpre">
        createAndTrim,          </span><span class="hl_comment"><span class="mpre">-- :: Int -&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO  ByteString</span></span><span class="mpre">
        createAndTrim&#39;,         </span><span class="hl_comment"><span class="mpre">-- :: Int -&gt; (Ptr Word8 -&gt; IO (Int, Int, a)) -&gt; IO (ByteString, a)</span></span><span class="mpre">
        unsafeCreate,           </span><span class="hl_comment"><span class="mpre">-- :: Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt;  ByteString</span></span><span class="mpre">
        unsafeCreateUptoN,      </span><span class="hl_comment"><span class="mpre">-- :: Int -&gt; (Ptr Word8 -&gt; IO Int) -&gt;  ByteString</span></span><span class="mpre">
        mallocByteString,       </span><span class="hl_comment"><span class="mpre">-- :: Int -&gt; IO (ForeignPtr a)</span></span><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- * Conversion to and from ForeignPtrs</span></span><span class="mpre">
        fromForeignPtr,         </span><span class="hl_comment"><span class="mpre">-- :: ForeignPtr Word8 -&gt; Int -&gt; Int -&gt; ByteString</span></span><span class="mpre">
        toForeignPtr,           </span><span class="hl_comment"><span class="mpre">-- :: ByteString -&gt; (ForeignPtr Word8, Int, Int)</span></span><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- * Utilities</span></span><span class="mpre">
        inlinePerformIO,        </span><span class="hl_comment"><span class="mpre">-- :: IO a -&gt; a</span></span><span class="mpre">
        nullForeignPtr,         </span><span class="hl_comment"><span class="mpre">-- :: ForeignPtr Word8</span></span><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- * Standard C Functions</span></span><span class="mpre">
        c_strlen,               </span><span class="hl_comment"><span class="mpre">-- :: CString -&gt; IO CInt</span></span><span class="mpre">
        c_free_finalizer,       </span><span class="hl_comment"><span class="mpre">-- :: FunPtr (Ptr Word8 -&gt; IO ())</span></span><span class="mpre">

        memchr,                 </span><span class="hl_comment"><span class="mpre">-- :: Ptr Word8 -&gt; Word8 -&gt; CSize -&gt; IO Ptr Word8</span></span><span class="mpre">
        memcmp,                 </span><span class="hl_comment"><span class="mpre">-- :: Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO CInt</span></span><span class="mpre">
        memcpy,                 </span><span class="hl_comment"><span class="mpre">-- :: Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()</span></span><span class="mpre">
        memset,                 </span><span class="hl_comment"><span class="mpre">-- :: Ptr Word8 -&gt; Word8 -&gt; CSize -&gt; IO (Ptr Word8)</span></span><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- * cbits functions</span></span><span class="mpre">
        c_reverse,              </span><span class="hl_comment"><span class="mpre">-- :: Ptr Word8 -&gt; Ptr Word8 -&gt; CInt -&gt; IO ()</span></span><span class="mpre">
        c_intersperse,          </span><span class="hl_comment"><span class="mpre">-- :: Ptr Word8 -&gt; Ptr Word8 -&gt; CInt -&gt; Word8 -&gt; IO ()</span></span><span class="mpre">
        c_maximum,              </span><span class="hl_comment"><span class="mpre">-- :: Ptr Word8 -&gt; CInt -&gt; IO Word8</span></span><span class="mpre">
        c_minimum,              </span><span class="hl_comment"><span class="mpre">-- :: Ptr Word8 -&gt; CInt -&gt; IO Word8</span></span><span class="mpre">
        c_count,                </span><span class="hl_comment"><span class="mpre">-- :: Ptr Word8 -&gt; CInt -&gt; Word8 -&gt; IO CInt</span></span><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- * Chars</span></span><span class="mpre">
        w2c, c2w, isSpaceWord8, isSpaceChar8

  ) where

import Prelude hiding (concat)
import qualified Data.List as List

import Foreign.ForeignPtr       (ForeignPtr, </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="mpre">withForeignPtr</span></a><span class="mpre">)
import Foreign.Ptr              (Ptr, FunPtr, plusPtr)
import Foreign.Storable         (Storable(..))
#if MIN_VERSION_base(4,5,0) || __GLASGOW_HASKELL__ &gt;= 703
import Foreign.C.Types          (CInt(..), CSize(..), CULong(..))
#else
import Foreign.C.Types          (CInt, CSize, CULong)
#endif
import Foreign.C.String         (CString)

import Data.Monoid              (</span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="mpre">Monoid</span></a><span class="mpre">(..))
import Control.DeepSeq          (</span><a href="Control.DeepSeq.html#loc_110_7_110_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_110_7_110_13&#39;)"><span class="mpre">NFData</span></a><span class="mpre">)

#if MIN_VERSION_base(3,0,0)
import Data.String              (</span><a href="Data.String.html#loc_34_7_34_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.String.html#loc_34_7_34_15&#39;)"><span class="mpre">IsString</span></a><span class="mpre">(..))
#endif

#ifndef __NHC__
import Control.Exception        (assert)
#endif

import Data.Char                (ord)
import Data.Word                (Word8)

import Data.Typeable            (</span><a href="Data.Typeable.Internal.html#loc_196_7_196_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Typeable.Internal.html#loc_196_7_196_15&#39;)"><span class="mpre">Typeable</span></a><span class="mpre">)
#if MIN_VERSION_base(4,1,0)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 109, srcSpanStartColumn = 8, srcSpanEndLine = 109, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre">                (Data(..))
#if MIN_VERSION_base(4,2,0)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 8, srcSpanEndLine = 111, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre">                (mkNoRepType)
#else
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 113, srcSpanStartColumn = 8, srcSpanEndLine = 113, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre">                (mkNorepType)
#endif
#else
import Data.Generics            (Data(..), mkNorepType)
#endif

#ifdef __GLASGOW_HASKELL__
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 8, srcSpanEndLine = 120, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre">                 (realWorld#,unsafeChr)
#if MIN_VERSION_base(4,4,0)
import GHC.CString              (</span><a href="GHC.CString.html#loc_42_1_42_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.CString.html#loc_42_1_42_15&#39;)"><span class="mpre">unpackCString#</span></a><span class="mpre">)
#else
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 124, srcSpanStartColumn = 8, srcSpanEndLine = 124, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre">                 (unpackCString#)
#endif
import GHC.Prim                 (</span><a href="GHC.Prim.html#loc_2279_6_2279_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2279_6_2279_11&#39;)"><span class="mpre">Addr#</span></a><span class="mpre">)
#if __GLASGOW_HASKELL__ &gt;= 611
import GHC.IO                   (IO(IO))
#else
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 130, srcSpanStartColumn = 8, srcSpanEndLine = 130, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;GHC.IOBase&quot;"><span class="mpre">GHC.IOBase</span></span><span class="mpre">               (IO(IO),RawBuffer)
#endif
#if __GLASGOW_HASKELL__ &gt;= 611
import GHC.IO                   (</span><a href="GHC.IO.html#loc_182_1_182_23" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_182_1_182_23&#39;)"><span class="mpre">unsafeDupablePerformIO</span></a><span class="mpre">)
#else
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 135, srcSpanStartColumn = 8, srcSpanEndLine = 135, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;GHC.IOBase&quot;"><span class="mpre">GHC.IOBase</span></span><span class="mpre">               (unsafeDupablePerformIO)
#endif
#else
import Data.Char                (</span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="mpre">chr</span></a><span class="mpre">)
import System.IO.Unsafe         (</span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="mpre">unsafePerformIO</span></a><span class="mpre">)
#endif

#ifdef __GLASGOW_HASKELL__
import GHC.ForeignPtr           (</span><a href="GHC.ForeignPtr.html#loc_371_1_371_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.ForeignPtr.html#loc_371_1_371_15&#39;)"><span class="mpre">newForeignPtr_</span></a><span class="mpre">, </span><a href="GHC.ForeignPtr.html#loc_227_1_227_27" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.ForeignPtr.html#loc_227_1_227_27&#39;)"><span class="mpre">mallocPlainForeignPtrBytes</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 144, srcSpanStartColumn = 8, srcSpanEndLine = 144, srcSpanEndColumn = 15}, srcInfoPoints = []}) &quot;GHC.Ptr&quot;"><span class="mpre">GHC.Ptr</span></span><span class="mpre">                  (Ptr(..), castPtr)
#else
import Foreign.ForeignPtr       (mallocForeignPtrBytes)
#endif

#ifdef __GLASGOW_HASKELL__
import GHC.ForeignPtr           (</span><a href="GHC.ForeignPtr.html#loc_73_6_73_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.ForeignPtr.html#loc_73_6_73_16&#39;)"><span class="mpre">ForeignPtr</span></a><span class="mpre">(</span><a href="GHC.ForeignPtr.html#loc_73_21_73_31" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.ForeignPtr.html#loc_73_21_73_31&#39;)"><span class="mpre">ForeignPtr</span></a><span class="mpre">))
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 151, srcSpanStartColumn = 8, srcSpanEndLine = 151, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre">                 (nullAddr#)
#else
import Foreign.Ptr              (nullPtr)
#endif

#if __HUGS__
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 157, srcSpanStartColumn = 8, srcSpanEndLine = 157, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Hugs.ForeignPtr&quot;"><span class="mpre">Hugs.ForeignPtr</span></span><span class="mpre">          (newForeignPtr_)
#elif __GLASGOW_HASKELL__&lt;=604
import Foreign.ForeignPtr       (newForeignPtr_)
#endif

</span><span class="hl_comment"><span class="mpre">-- CFILES stuff is Hugs only</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-# CFILES cbits/fpstring.c #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- An alternative to Control.Exception (assert) for nhc98</span></span><span class="mpre">
#ifdef __NHC__
#define assert        assertS &quot;__FILE__ : __LINE__&quot;
</span><a href="#loc_169_1_169_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_8&#39;)"><span class="mpre">assertS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_169_1_169_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_8&#39;)"><span class="hl_fundecl"><span class="mpre">assertS</span></span></a><span class="mpre"> _ </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><a href="#loc_169_1_169_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_8&#39;)"><span class="hl_fundecl"><span class="mpre">assertS</span></span></a><span class="mpre"> </span><a name="loc_170_9_170_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_9_170_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;assertion failed at &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_170_9_170_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_9_170_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
#endif

</span><span class="hl_comment"><span class="mpre">-- -----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Useful macros, until we have bang patterns</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

#define STRICT1(f) f a | a `seq` False = undefined
#define STRICT2(f) f a b | a `seq` b `seq` False = undefined
#define STRICT3(f) f a b c | a `seq` b `seq` c `seq` False = undefined
#define STRICT4(f) f a b c d | a `seq` b `seq` c `seq` d `seq` False = undefined
#define STRICT5(f) f a b c d e | a `seq` b `seq` c `seq` d `seq` e `seq` False = undefined

</span><span class="hl_comment"><span class="mpre">-- -----------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A space-efficient representation of a &#39;Word8&#39; vector, supporting many</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- efficient operations.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A &#39;ByteString&#39; contains 8-bit bytes, or by using the operations from</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;Data.ByteString.Char8&quot; it can be interpreted as containing 8-bit</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- characters.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
data </span><a name="loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tycondecl"><span class="mpre">ByteString</span></span></a><span class="mpre"> = </span><a name="loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_condecl"><span class="mpre">PS</span></span></a><span class="mpre"> {-# UNPACK #-} !(</span><a href="GHC.ForeignPtr.html#loc_73_6_73_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.ForeignPtr.html#loc_73_6_73_16&#39;)"><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- payload</span></span><span class="mpre">
                     {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- offset</span></span><span class="mpre">
                     {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- length</span></span><span class="mpre">

#if defined(__GLASGOW_HASKELL__)
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 198, srcSpanStartColumn = 5, srcSpanEndLine = 198, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 198, srcSpanStartColumn = 5, srcSpanEndLine = 198, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/By"><span class="mpre">deriving (Typeable)</span></span><span class="mpre">
#endif

instance </span><span class="hl_classref"><span class="mpre">Eq</span></span><span class="mpre">  </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> where
    </span><span class="hl_vardecl"><span class="mpre">(==)</span></span><span class="mpre">    = </span><a href="#loc_501_1_501_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_1_501_3&#39;)"><span class="hl_varref"><span class="mpre">eq</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Ord</span></span><span class="mpre"> </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> where
    </span><span class="hl_vardecl"><span class="mpre">compare</span></span><span class="mpre"> = </span><a href="#loc_509_1_509_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_509_1_509_13&#39;)"><span class="hl_varref"><span class="mpre">compareBytes</span></span></a><span class="mpre">

instance </span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="hl_classref"><span class="mpre">Monoid</span></span></a><span class="mpre"> </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> where
    </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">mempty</span></span></a><span class="mpre">  = </span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_381_1_381_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_15&#39;)"><span class="hl_varref"><span class="mpre">nullForeignPtr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_vardecl"><span class="mpre">mappend</span></span></a><span class="mpre"> = </span><a href="#loc_520_1_520_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_1_520_7&#39;)"><span class="hl_varref"><span class="mpre">append</span></span></a><span class="mpre">
    </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_vardecl"><span class="mpre">mconcat</span></span></a><span class="mpre"> = </span><a href="#loc_529_1_529_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_1_529_7&#39;)"><span class="hl_varref"><span class="mpre">concat</span></span></a><span class="mpre">

instance </span><a href="Control.DeepSeq.html#loc_110_7_110_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_110_7_110_13&#39;)"><span class="hl_classref"><span class="mpre">NFData</span></span></a><span class="mpre"> </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">showsPrec</span></span><span class="mpre"> </span><a name="loc_215_15_215_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_15_215_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_215_17_215_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_17_215_19&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a name="loc_215_20_215_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_20_215_21&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">showsPrec</span></span><span class="mpre"> </span><a href="#loc_215_15_215_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_15_215_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a href="#loc_331_1_331_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_1_331_12&#39;)"><span class="hl_varref"><span class="mpre">unpackChars</span></span></a><span class="mpre"> </span><a href="#loc_215_17_215_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_17_215_19&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">) </span><a href="#loc_215_20_215_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_20_215_21&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Read</span></span><span class="mpre"> </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">readsPrec</span></span><span class="mpre"> </span><a name="loc_218_15_218_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_15_218_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_218_17_218_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_17_218_20&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = [ (</span><a href="#loc_242_1_242_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_10&#39;)"><span class="hl_varref"><span class="mpre">packChars</span></span></a><span class="mpre"> </span><a href="#loc_218_45_218_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_45_218_46&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_218_48_218_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_48_218_49&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) | (</span><a name="loc_218_45_218_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_45_218_46&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_218_48_218_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_48_218_49&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">readsPrec</span></span><span class="mpre"> </span><a href="#loc_218_15_218_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_15_218_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_218_17_218_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_17_218_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> ]

#if MIN_VERSION_base(3,0,0)
instance </span><a href="Data.String.html#loc_34_7_34_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.String.html#loc_34_7_34_15&#39;)"><span class="hl_classref"><span class="mpre">IsString</span></span></a><span class="mpre"> </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> where
    </span><a href="Data.String.html#loc_35_5_35_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.String.html#loc_35_5_35_15&#39;)"><span class="hl_vardecl"><span class="mpre">fromString</span></span></a><span class="mpre"> = </span><a href="#loc_242_1_242_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_10&#39;)"><span class="hl_varref"><span class="mpre">packChars</span></span></a><span class="mpre">
#endif

instance </span><span class="hl_classref"><span class="mpre">Data</span></span><span class="mpre"> </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">gfoldl</span></span><span class="mpre"> </span><a name="loc_226_10_226_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_10_226_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_226_12_226_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_12_226_13&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> </span><a name="loc_226_14_226_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_14_226_17&#39;)"><span class="hl_vardecl"><span class="mpre">txt</span></span></a><span class="mpre"> = </span><a href="#loc_226_12_226_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_12_226_13&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_239_1_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_10&#39;)"><span class="hl_varref"><span class="mpre">packBytes</span></span></a><span class="mpre"> </span><a href="#loc_226_10_226_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_10_226_11&#39;)"><span class="hl_infix"><span class="mpre">`f`</span></span></a><span class="mpre"> (</span><a href="#loc_328_1_328_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_12&#39;)"><span class="hl_varref"><span class="mpre">unpackBytes</span></span></a><span class="mpre"> </span><a href="#loc_226_14_226_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_14_226_17&#39;)"><span class="hl_varref"><span class="mpre">txt</span></span></a><span class="mpre">)
  </span><span class="hl_fundecl"><span class="mpre">toConstr</span></span><span class="mpre"> _     = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Data.ByteString.ByteString.toConstr&quot;</span></span><span class="mpre">
  </span><span class="hl_fundecl"><span class="mpre">gunfold</span></span><span class="mpre"> _ _    = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Data.ByteString.ByteString.gunfold&quot;</span></span><span class="mpre">
#if MIN_VERSION_base(4,2,0)
  </span><a name="loc_230_3_230_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_3_230_13&#39;)"><span class="hl_fundecl"><span class="mpre">dataTypeOf</span></span></a><span class="mpre"> _   = </span><span class="hl_varref"><span class="mpre">mkNoRepType</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Data.ByteString.ByteString&quot;</span></span><span class="mpre">
#else
  </span><a href="#loc_230_3_230_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_3_230_13&#39;)"><span class="hl_fundecl"><span class="mpre">dataTypeOf</span></span></a><span class="mpre"> _   = </span><span class="hl_varref"><span class="mpre">mkNorepType</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Data.ByteString.ByteString&quot;</span></span><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Packing and unpacking from lists</span></span><span class="mpre">

</span><a href="#loc_239_1_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_10&#39;)"><span class="mpre">packBytes</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_239_1_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_10&#39;)"><span class="hl_fundecl"><span class="mpre">packBytes</span></span></a><span class="mpre"> </span><a name="loc_239_11_239_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_11_239_13&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre"> = </span><a href="#loc_254_1_254_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_19&#39;)"><span class="hl_varref"><span class="mpre">unsafePackLenBytes</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">List.length</span></span><span class="mpre"> </span><a href="#loc_239_11_239_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_11_239_13&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">) </span><a href="#loc_239_11_239_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_11_239_13&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">

</span><a href="#loc_242_1_242_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_10&#39;)"><span class="mpre">packChars</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">] -&gt; </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_242_1_242_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_10&#39;)"><span class="hl_fundecl"><span class="mpre">packChars</span></span></a><span class="mpre"> </span><a name="loc_242_11_242_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_11_242_13&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = </span><a href="#loc_261_1_261_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_19&#39;)"><span class="hl_varref"><span class="mpre">unsafePackLenChars</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">List.length</span></span><span class="mpre"> </span><a href="#loc_242_11_242_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_11_242_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">) </span><a href="#loc_242_11_242_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_11_242_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

#if defined(__GLASGOW_HASKELL__)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_242_1_242_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_10&#39;)"><span class="mpre">packChars</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# RULES
&quot;ByteString packChars/packAddress&quot; forall s .
   packChars (unpackCString# s) = inlinePerformIO (unsafePackAddress s)
 #-}</span></span><span class="mpre">
#endif

</span><a href="#loc_254_1_254_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_19&#39;)"><span class="mpre">unsafePackLenBytes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_254_1_254_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_19&#39;)"><span class="hl_fundecl"><span class="mpre">unsafePackLenBytes</span></span></a><span class="mpre"> </span><a name="loc_254_20_254_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_20_254_23&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> </span><a name="loc_254_24_254_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_24_254_27&#39;)"><span class="hl_vardecl"><span class="mpre">xs0</span></span></a><span class="mpre"> =
    </span><a href="#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_13&#39;)"><span class="hl_varref"><span class="mpre">unsafeCreate</span></span></a><span class="mpre"> </span><a href="#loc_254_20_254_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_20_254_23&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_255_25_255_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_25_255_26&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_257_5_257_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_5_257_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_255_25_255_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_25_255_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_254_24_254_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_24_254_27&#39;)"><span class="hl_varref"><span class="mpre">xs0</span></span></a><span class="mpre">
  where
    </span><a name="loc_257_5_257_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_5_257_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !_ []     = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
    </span><a href="#loc_257_5_257_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_5_257_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_258_9_258_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_9_258_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a name="loc_258_12_258_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_12_258_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_258_14_258_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_14_258_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_258_9_258_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_9_258_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_258_12_258_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_12_258_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_257_5_257_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_5_257_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_258_9_258_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_9_258_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_258_14_258_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_14_258_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><a href="#loc_261_1_261_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_19&#39;)"><span class="mpre">unsafePackLenChars</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">] -&gt; </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_261_1_261_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_1_261_19&#39;)"><span class="hl_fundecl"><span class="mpre">unsafePackLenChars</span></span></a><span class="mpre"> </span><a name="loc_261_20_261_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_20_261_23&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> </span><a name="loc_261_24_261_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_24_261_27&#39;)"><span class="hl_vardecl"><span class="mpre">cs0</span></span></a><span class="mpre"> =
    </span><a href="#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_13&#39;)"><span class="hl_varref"><span class="mpre">unsafeCreate</span></span></a><span class="mpre"> </span><a href="#loc_261_20_261_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_20_261_23&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_262_25_262_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_25_262_26&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_264_5_264_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_5_264_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_262_25_262_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_25_262_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_261_24_261_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_24_261_27&#39;)"><span class="hl_varref"><span class="mpre">cs0</span></span></a><span class="mpre">
  where
    </span><a name="loc_264_5_264_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_5_264_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !_ []     = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
    </span><a href="#loc_264_5_264_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_5_264_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_265_9_265_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_9_265_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a name="loc_265_12_265_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_12_265_13&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_265_14_265_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_14_265_16&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_265_9_265_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_9_265_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a href="#loc_554_1_554_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_1_554_4&#39;)"><span class="hl_varref"><span class="mpre">c2w</span></span></a><span class="mpre"> </span><a href="#loc_265_12_265_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_12_265_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_264_5_264_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_5_264_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_265_9_265_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_9_265_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_265_14_265_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_14_265_16&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

#if defined(__GLASGOW_HASKELL__)
</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ Pack a null-terminated sequence of bytes, pointed to by an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Addr\# (an arbitrary machine address assumed to point outside the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- garbage-collected heap) into a @ByteString@. A much faster way to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- create an Addr\# is with an unboxed string literal, than to pack a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- boxed string. A unboxed string literal is compiled to a static @char</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- []@ by GHC. Establishing the length of the string requires a call to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @strlen(3)@, so the Addr# must point to a null-terminated buffer (as</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is the case with &quot;string&quot;# literals in GHC). Use &#39;unsafePackAddressLen&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- if you know the length of the string statically.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- An example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; literalFS = unsafePackAddress &quot;literal&quot;#</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function is /unsafe/. If you modify the buffer pointed to by the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- original Addr# this modification will be reflected in the resulting</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @ByteString@, breaking referential transparency.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note this also won&#39;t work if your Addr# has embedded &#39;\0&#39; characters in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the string, as @strlen@ will return too short a length.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_290_1_290_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_18&#39;)"><span class="mpre">unsafePackAddress</span></a><span class="mpre"> :: </span><a href="GHC.Prim.html#loc_2279_6_2279_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Prim.html#loc_2279_6_2279_11&#39;)"><span class="hl_tyconref"><span class="mpre">Addr#</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_290_1_290_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_18&#39;)"><span class="hl_fundecl"><span class="mpre">unsafePackAddress</span></span></a><span class="mpre"> </span><a name="loc_290_19_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_19_290_24&#39;)"><span class="hl_vardecl"><span class="mpre">addr#</span></span></a><span class="mpre"> = do
    </span><a name="loc_291_5_291_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_5_291_6&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.ForeignPtr.html#loc_371_1_371_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.ForeignPtr.html#loc_371_1_371_15&#39;)"><span class="hl_varref"><span class="mpre">newForeignPtr_</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_296_5_296_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_5_296_9&#39;)"><span class="hl_varref"><span class="mpre">cstr</span></span></a><span class="mpre">)
    </span><a name="loc_292_5_292_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_5_292_6&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">c_strlen</span></span><span class="mpre"> </span><a href="#loc_296_5_296_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_5_296_9&#39;)"><span class="hl_varref"><span class="mpre">cstr</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_291_5_291_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_5_291_6&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_292_5_292_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_5_292_6&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
  where
    </span><a href="#loc_296_5_296_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_5_296_9&#39;)"><span class="mpre">cstr</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CString</span></span><span class="mpre">
    </span><a name="loc_296_5_296_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_5_296_9&#39;)"><span class="hl_vardecl"><span class="mpre">cstr</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><a href="#loc_290_19_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_19_290_24&#39;)"><span class="hl_varref"><span class="mpre">addr#</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_290_1_290_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_1_290_18&#39;)"><span class="mpre">unsafePackAddress</span></a><span class="mpre"> #-}</span></span><span class="mpre">
#endif

</span><a href="#loc_301_1_301_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_1_301_17&#39;)"><span class="mpre">packUptoLenBytes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; (</span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">, [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">])
</span><a name="loc_301_1_301_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_1_301_17&#39;)"><span class="hl_fundecl"><span class="mpre">packUptoLenBytes</span></span></a><span class="mpre"> </span><a name="loc_301_18_301_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_18_301_21&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> </span><a name="loc_301_22_301_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_22_301_25&#39;)"><span class="hl_vardecl"><span class="mpre">xs0</span></span></a><span class="mpre"> =
    </span><a href="#loc_423_1_423_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_19&#39;)"><span class="hl_varref"><span class="mpre">unsafeCreateUptoN&#39;</span></span></a><span class="mpre"> </span><a href="#loc_301_18_301_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_18_301_21&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_302_31_302_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_31_302_32&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_304_5_304_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_5_304_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_302_31_302_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_31_302_32&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_301_18_301_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_18_301_21&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_301_22_301_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_22_301_25&#39;)"><span class="hl_varref"><span class="mpre">xs0</span></span></a><span class="mpre">
  where
    </span><a name="loc_304_5_304_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_5_304_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !_ !</span><a name="loc_304_12_304_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_12_304_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> []     = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_301_18_301_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_18_301_21&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_304_12_304_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_12_304_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, [])
    </span><a href="#loc_304_5_304_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_5_304_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !_ !</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_305_14_305_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_14_305_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">     = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_301_18_301_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_18_301_21&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">,   </span><a href="#loc_305_14_305_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_14_305_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
    </span><a href="#loc_304_5_304_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_5_304_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_306_9_306_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_9_306_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> !</span><a name="loc_306_12_306_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_12_306_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a name="loc_306_15_306_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_15_306_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_306_17_306_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_17_306_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_306_9_306_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_9_306_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_306_15_306_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_15_306_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_304_5_304_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_5_304_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_306_9_306_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_9_306_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_306_12_306_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_12_306_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_306_17_306_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_17_306_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><a href="#loc_309_1_309_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_17&#39;)"><span class="mpre">packUptoLenChars</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">] -&gt; (</span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">, [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">])
</span><a name="loc_309_1_309_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_1_309_17&#39;)"><span class="hl_fundecl"><span class="mpre">packUptoLenChars</span></span></a><span class="mpre"> </span><a name="loc_309_18_309_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_18_309_21&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> </span><a name="loc_309_22_309_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_22_309_25&#39;)"><span class="hl_vardecl"><span class="mpre">cs0</span></span></a><span class="mpre"> =
    </span><a href="#loc_423_1_423_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_19&#39;)"><span class="hl_varref"><span class="mpre">unsafeCreateUptoN&#39;</span></span></a><span class="mpre"> </span><a href="#loc_309_18_309_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_18_309_21&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_310_31_310_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_31_310_32&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_312_5_312_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_5_312_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_310_31_310_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_310_31_310_32&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_309_18_309_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_18_309_21&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_309_22_309_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_22_309_25&#39;)"><span class="hl_varref"><span class="mpre">cs0</span></span></a><span class="mpre">
  where
    </span><a name="loc_312_5_312_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_5_312_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !_ !</span><a name="loc_312_12_312_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_12_312_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> []     = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_309_18_309_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_18_309_21&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_312_12_312_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_12_312_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">, [])
    </span><a href="#loc_312_5_312_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_5_312_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !_ !</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_313_14_313_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_14_313_16&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">     = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_309_18_309_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_18_309_21&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">,   </span><a href="#loc_313_14_313_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_14_313_16&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
    </span><a href="#loc_312_5_312_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_5_312_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_314_9_314_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_9_314_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> !</span><a name="loc_314_12_314_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_12_314_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a name="loc_314_15_314_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_15_314_16&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_314_17_314_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_17_314_19&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_314_9_314_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_9_314_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a href="#loc_554_1_554_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_1_554_4&#39;)"><span class="hl_varref"><span class="mpre">c2w</span></span></a><span class="mpre"> </span><a href="#loc_314_15_314_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_15_314_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_312_5_312_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_5_312_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_314_9_314_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_9_314_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_314_12_314_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_12_314_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_314_17_314_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_17_314_19&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Unpacking bytestrings into lists effeciently is a tradeoff: on the one hand</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- we would like to write a tight loop that just blats the list into memory, on</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the other hand we want it to be unpacked lazily so we don&#39;t end up with a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- massive list data structure in memory.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Our strategy is to combine both: we will unpack lazily in reasonable sized</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- chunks, where each chunk is unpacked strictly.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- unpackBytes and unpackChars do the lazy loop, while unpackAppendBytes and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- unpackAppendChars do the chunks strictly.</span></span><span class="mpre">

</span><a href="#loc_328_1_328_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_12&#39;)"><span class="mpre">unpackBytes</span></a><span class="mpre"> :: </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_328_1_328_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_12&#39;)"><span class="hl_fundecl"><span class="mpre">unpackBytes</span></span></a><span class="mpre"> </span><a name="loc_328_13_328_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_13_328_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_334_1_334_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_22&#39;)"><span class="hl_varref"><span class="mpre">unpackAppendBytesLazy</span></span></a><span class="mpre"> </span><a href="#loc_328_13_328_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_13_328_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> []

</span><a href="#loc_331_1_331_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_1_331_12&#39;)"><span class="mpre">unpackChars</span></a><span class="mpre"> :: </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]
</span><a name="loc_331_1_331_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_1_331_12&#39;)"><span class="hl_fundecl"><span class="mpre">unpackChars</span></span></a><span class="mpre"> </span><a name="loc_331_13_331_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_13_331_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_345_1_345_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_1_345_22&#39;)"><span class="hl_varref"><span class="mpre">unpackAppendCharsLazy</span></span></a><span class="mpre"> </span><a href="#loc_331_13_331_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_13_331_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> []

</span><a href="#loc_334_1_334_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_22&#39;)"><span class="mpre">unpackAppendBytesLazy</span></a><span class="mpre"> :: </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_334_1_334_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_22&#39;)"><span class="hl_fundecl"><span class="mpre">unpackAppendBytesLazy</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_334_27_334_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_27_334_29&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_334_30_334_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_30_334_33&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_334_34_334_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_34_334_37&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) </span><a name="loc_334_39_334_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_39_334_41&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">
  | </span><a href="#loc_334_34_334_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_34_334_37&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre"> = </span><a href="#loc_357_1_357_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_24&#39;)"><span class="hl_varref"><span class="mpre">unpackAppendBytesStrict</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_334_27_334_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_27_334_29&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_334_30_334_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_30_334_33&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_334_34_334_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_34_334_37&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">) </span><a href="#loc_334_39_334_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_39_334_41&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><a href="#loc_357_1_357_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_24&#39;)"><span class="hl_varref"><span class="mpre">unpackAppendBytesStrict</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_334_27_334_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_27_334_29&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_334_30_334_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_30_334_33&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre">) </span><a href="#loc_338_5_338_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_5_338_14&#39;)"><span class="hl_varref"><span class="mpre">remainder</span></span></a><span class="mpre">
  where
    </span><a name="loc_338_5_338_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_5_338_14&#39;)"><span class="hl_vardecl"><span class="mpre">remainder</span></span></a><span class="mpre">  = </span><a href="#loc_334_1_334_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_1_334_22&#39;)"><span class="hl_varref"><span class="mpre">unpackAppendBytesLazy</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_334_27_334_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_27_334_29&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> (</span><a href="#loc_334_30_334_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_30_334_33&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre">) (</span><a href="#loc_334_34_334_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_34_334_37&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre">)) </span><a href="#loc_334_39_334_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_334_39_334_41&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Why 100 bytes you ask? Because on a 64bit machine the list we allocate</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- takes just shy of 4k which seems like a reasonable amount.</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- (5 words per list element, 8 bytes per word, 100 elements = 4000 bytes)</span></span><span class="mpre">

</span><a href="#loc_345_1_345_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_1_345_22&#39;)"><span class="mpre">unpackAppendCharsLazy</span></a><span class="mpre"> :: </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]
</span><a name="loc_345_1_345_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_1_345_22&#39;)"><span class="hl_fundecl"><span class="mpre">unpackAppendCharsLazy</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_345_27_345_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_27_345_29&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_345_30_345_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_30_345_33&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_345_34_345_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_34_345_37&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) </span><a name="loc_345_39_345_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_39_345_41&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">
  | </span><a href="#loc_345_34_345_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_34_345_37&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre"> = </span><a href="#loc_367_1_367_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_24&#39;)"><span class="hl_varref"><span class="mpre">unpackAppendCharsStrict</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_345_27_345_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_27_345_29&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_345_30_345_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_30_345_33&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_345_34_345_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_34_345_37&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">) </span><a href="#loc_345_39_345_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_39_345_41&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><a href="#loc_367_1_367_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_24&#39;)"><span class="hl_varref"><span class="mpre">unpackAppendCharsStrict</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_345_27_345_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_27_345_29&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_345_30_345_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_30_345_33&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre">) </span><a href="#loc_349_5_349_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_5_349_14&#39;)"><span class="hl_varref"><span class="mpre">remainder</span></span></a><span class="mpre">
  where
    </span><a name="loc_349_5_349_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_5_349_14&#39;)"><span class="hl_vardecl"><span class="mpre">remainder</span></span></a><span class="mpre">  = </span><a href="#loc_345_1_345_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_1_345_22&#39;)"><span class="hl_varref"><span class="mpre">unpackAppendCharsLazy</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_345_27_345_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_27_345_29&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> (</span><a href="#loc_345_30_345_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_30_345_33&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre">) (</span><a href="#loc_345_34_345_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_34_345_37&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre">)) </span><a href="#loc_345_39_345_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_39_345_41&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- For these unpack functions, since we&#39;re unpacking the whole list strictly we</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- build up the result list in an accumulator. This means we have to build up</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the list starting at the end. So our traversal starts at the end of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- buffer and loops down until we hit the sentinal:</span></span><span class="mpre">

</span><a href="#loc_357_1_357_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_24&#39;)"><span class="mpre">unpackAppendBytesStrict</span></a><span class="mpre"> :: </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_357_1_357_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_24&#39;)"><span class="hl_fundecl"><span class="mpre">unpackAppendBytesStrict</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_357_29_357_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_29_357_31&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_357_32_357_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_32_357_35&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_357_36_357_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_36_357_39&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) </span><a name="loc_357_41_357_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_41_357_43&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> =
    </span><a href="#loc_592_1_592_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_1_592_16&#39;)"><span class="hl_varref"><span class="mpre">inlinePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_357_29_357_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_29_357_31&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_358_44_358_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_44_358_48&#39;)"><span class="hl_vardecl"><span class="mpre">base</span></span></a><span class="mpre"> -&gt; do
      </span><a href="#loc_361_5_361_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_5_361_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_358_44_358_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_44_358_48&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_357_32_357_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_32_357_35&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)) (</span><a href="#loc_358_44_358_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_44_358_48&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_357_32_357_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_32_357_35&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_357_36_357_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_36_357_39&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">)) </span><a href="#loc_357_41_357_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_41_357_43&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
  where
    </span><a name="loc_361_5_361_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_5_361_9&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_361_11_361_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_11_361_19&#39;)"><span class="hl_vardecl"><span class="mpre">sentinal</span></span></a><span class="mpre"> !</span><a name="loc_361_21_361_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_21_361_22&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_361_23_361_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_23_361_26&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre">
      | </span><a href="#loc_361_21_361_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_21_361_22&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_361_11_361_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_11_361_19&#39;)"><span class="hl_varref"><span class="mpre">sentinal</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_361_23_361_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_23_361_26&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = do </span><a name="loc_363_28_363_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_28_363_29&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><a href="#loc_361_21_361_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_21_361_22&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                           </span><a href="#loc_361_5_361_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_5_361_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_361_11_361_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_11_361_19&#39;)"><span class="hl_varref"><span class="mpre">sentinal</span></span></a><span class="mpre"> (</span><a href="#loc_361_21_361_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_21_361_22&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (-</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)) (</span><a href="#loc_363_28_363_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_28_363_29&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_361_23_361_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_23_361_26&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)

</span><a href="#loc_367_1_367_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_24&#39;)"><span class="mpre">unpackAppendCharsStrict</span></a><span class="mpre"> :: </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]
</span><a name="loc_367_1_367_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_24&#39;)"><span class="hl_fundecl"><span class="mpre">unpackAppendCharsStrict</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_367_29_367_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_29_367_31&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_367_32_367_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_32_367_35&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_367_36_367_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_36_367_39&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) </span><a name="loc_367_41_367_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_41_367_43&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> =
    </span><a href="#loc_592_1_592_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_1_592_16&#39;)"><span class="hl_varref"><span class="mpre">inlinePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_367_29_367_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_29_367_31&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_368_44_368_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_44_368_48&#39;)"><span class="hl_vardecl"><span class="mpre">base</span></span></a><span class="mpre"> -&gt;
      </span><a href="#loc_371_5_371_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_5_371_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_368_44_368_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_44_368_48&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_367_32_367_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_32_367_35&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)) (</span><a href="#loc_368_44_368_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_44_368_48&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_367_32_367_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_32_367_35&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_367_36_367_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_36_367_39&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">)) </span><a href="#loc_367_41_367_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_41_367_43&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
  where
    </span><a name="loc_371_5_371_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_5_371_9&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_371_11_371_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_11_371_19&#39;)"><span class="hl_vardecl"><span class="mpre">sentinal</span></span></a><span class="mpre"> !</span><a name="loc_371_21_371_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_21_371_22&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_371_23_371_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_23_371_26&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre">
      | </span><a href="#loc_371_21_371_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_21_371_22&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_371_11_371_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_11_371_19&#39;)"><span class="hl_varref"><span class="mpre">sentinal</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_371_23_371_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_23_371_26&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = do </span><a name="loc_373_28_373_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_28_373_29&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><a href="#loc_371_21_371_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_21_371_22&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                           </span><a href="#loc_371_5_371_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_5_371_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_371_11_371_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_11_371_19&#39;)"><span class="hl_varref"><span class="mpre">sentinal</span></span></a><span class="mpre"> (</span><a href="#loc_371_21_371_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_21_371_22&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (-</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)) (</span><a href="#loc_544_1_544_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_1_544_4&#39;)"><span class="hl_varref"><span class="mpre">w2c</span></span></a><span class="mpre"> </span><a href="#loc_373_28_373_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_28_373_29&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_371_23_371_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_23_371_26&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The 0 pointer. Used to indicate the empty Bytestring.</span></span><span class="mpre">
</span><a href="#loc_381_1_381_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_15&#39;)"><span class="mpre">nullForeignPtr</span></a><span class="mpre"> :: </span><a href="GHC.ForeignPtr.html#loc_73_6_73_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.ForeignPtr.html#loc_73_6_73_16&#39;)"><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
#ifdef __GLASGOW_HASKELL__
</span><a name="loc_381_1_381_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_15&#39;)"><span class="hl_vardecl"><span class="mpre">nullForeignPtr</span></span></a><span class="mpre"> = </span><a href="GHC.ForeignPtr.html#loc_73_21_73_31" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.ForeignPtr.html#loc_73_21_73_31&#39;)"><span class="hl_conref"><span class="mpre">ForeignPtr</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullAddr#</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;nullForeignPtr&quot;</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">--TODO: should ForeignPtrContents be strict?</span></span><span class="mpre">
#else
</span><span class="hl_vardecl"><span class="mpre">nullForeignPtr</span></span><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.ForeignPtr.html#loc_371_1_371_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.ForeignPtr.html#loc_371_1_371_15&#39;)"><span class="hl_varref"><span class="mpre">newForeignPtr_</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_381_1_381_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_15&#39;)"><span class="mpre">nullForeignPtr</span></a><span class="mpre"> #-}</span></span><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Low level constructors</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(1)/ Build a ByteString from a ForeignPtr.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If you do not need the offset parameter then you do should be using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Data.ByteString.Unsafe.unsafePackCStringLen&#39; or</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Data.ByteString.Unsafe.unsafePackCStringFinalizer&#39; instead.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_400_1_400_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_1_400_15&#39;)"><span class="mpre">fromForeignPtr</span></a><span class="mpre"> :: </span><a href="GHC.ForeignPtr.html#loc_73_6_73_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.ForeignPtr.html#loc_73_6_73_16&#39;)"><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Offset</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Length</span></span><span class="mpre">
               -&gt; </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_400_1_400_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_1_400_15&#39;)"><span class="hl_fundecl"><span class="mpre">fromForeignPtr</span></span></a><span class="mpre"> </span><a name="loc_400_16_400_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_16_400_18&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_400_19_400_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_19_400_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_400_21_400_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_21_400_22&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_400_16_400_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_16_400_18&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_400_19_400_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_19_400_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_400_21_400_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_21_400_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_400_1_400_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_1_400_15&#39;)"><span class="mpre">fromForeignPtr</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(1)/ Deconstruct a ForeignPtr from a ByteString</span></span><span class="mpre">
</span><a href="#loc_405_1_405_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_1_405_13&#39;)"><span class="mpre">toForeignPtr</span></a><span class="mpre"> :: </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; (</span><a href="GHC.ForeignPtr.html#loc_73_6_73_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.ForeignPtr.html#loc_73_6_73_16&#39;)"><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ (ptr, offset, length)</span></span><span class="mpre">
</span><a name="loc_405_1_405_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_1_405_13&#39;)"><span class="hl_fundecl"><span class="mpre">toForeignPtr</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_405_18_405_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_18_405_20&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a name="loc_405_21_405_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_21_405_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_405_23_405_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_23_405_24&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = (</span><a href="#loc_405_18_405_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_18_405_20&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a href="#loc_405_21_405_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_21_405_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_405_23_405_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_23_405_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_405_1_405_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_1_405_13&#39;)"><span class="mpre">toForeignPtr</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A way of creating ByteStrings outside the IO monad. The @Int@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- argument gives the final size of the ByteString.</span></span><span class="mpre">
</span><a href="#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_13&#39;)"><span class="mpre">unsafeCreate</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_411_1_411_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_13&#39;)"><span class="hl_fundecl"><span class="mpre">unsafeCreate</span></span></a><span class="mpre"> </span><a name="loc_411_14_411_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_14_411_15&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_411_16_411_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_16_411_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_429_1_429_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_1_429_23&#39;)"><span class="hl_varref"><span class="mpre">unsafeDupablePerformIO</span></span></a><span class="mpre"> (</span><a href="#loc_434_1_434_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_1_434_7&#39;)"><span class="hl_varref"><span class="mpre">create</span></span></a><span class="mpre"> </span><a href="#loc_411_14_411_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_14_411_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_411_16_411_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_16_411_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_13&#39;)"><span class="mpre">unsafeCreate</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like &#39;unsafeCreate&#39; but instead of giving the final size of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ByteString, it is just an upper bound. The inner action returns</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the actual size. Unlike &#39;createAndTrim&#39; the ByteString is not</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- reallocated if the final size is less than the estimated size.</span></span><span class="mpre">
</span><a href="#loc_419_1_419_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_1_419_18&#39;)"><span class="mpre">unsafeCreateUptoN</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_419_1_419_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_1_419_18&#39;)"><span class="hl_fundecl"><span class="mpre">unsafeCreateUptoN</span></span></a><span class="mpre"> </span><a name="loc_419_19_419_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_19_419_20&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_419_21_419_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_21_419_22&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_429_1_429_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_1_429_23&#39;)"><span class="hl_varref"><span class="mpre">unsafeDupablePerformIO</span></span></a><span class="mpre"> (</span><a href="#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_1_443_12&#39;)"><span class="hl_varref"><span class="mpre">createUptoN</span></span></a><span class="mpre"> </span><a href="#loc_419_19_419_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_19_419_20&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_419_21_419_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_21_419_22&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_419_1_419_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_1_419_18&#39;)"><span class="mpre">unsafeCreateUptoN</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_423_1_423_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_19&#39;)"><span class="mpre">unsafeCreateUptoN&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)) -&gt; (</span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_423_1_423_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_19&#39;)"><span class="hl_fundecl"><span class="mpre">unsafeCreateUptoN&#39;</span></span></a><span class="mpre"> </span><a name="loc_423_20_423_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_20_423_21&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_423_22_423_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_22_423_23&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_429_1_429_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_1_429_23&#39;)"><span class="hl_varref"><span class="mpre">unsafeDupablePerformIO</span></span></a><span class="mpre"> (</span><a href="#loc_451_1_451_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_1_451_13&#39;)"><span class="hl_varref"><span class="mpre">createUptoN&#39;</span></span></a><span class="mpre"> </span><a href="#loc_423_20_423_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_20_423_21&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_423_22_423_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_22_423_23&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_423_1_423_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_19&#39;)"><span class="mpre">unsafeCreateUptoN&#39;</span></a><span class="mpre"> #-}</span></span><span class="mpre">

#ifndef __GLASGOW_HASKELL__
</span><span class="hl_comment"><span class="mpre">-- for Hugs, NHC etc</span></span><span class="mpre">
</span><a href="#loc_429_1_429_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_1_429_23&#39;)"><span class="mpre">unsafeDupablePerformIO</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_429_1_429_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_1_429_23&#39;)"><span class="hl_vardecl"><span class="mpre">unsafeDupablePerformIO</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- | Create ByteString of size @l@ and use action @f@ to fill it&#39;s contents.</span></span><span class="mpre">
</span><a href="#loc_434_1_434_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_1_434_7&#39;)"><span class="mpre">create</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_434_1_434_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_1_434_7&#39;)"><span class="hl_fundecl"><span class="mpre">create</span></span></a><span class="mpre"> </span><a name="loc_434_8_434_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_8_434_9&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_434_10_434_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_10_434_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
    </span><a name="loc_435_5_435_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_5_435_7&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_1_489_17&#39;)"><span class="hl_varref"><span class="mpre">mallocByteString</span></span></a><span class="mpre"> </span><a href="#loc_434_8_434_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_8_434_9&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
    </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_435_5_435_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_5_435_7&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_436_26_436_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_26_436_27&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_434_10_434_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_10_434_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_436_26_436_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_26_436_27&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_435_5_435_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_5_435_7&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_434_8_434_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_8_434_9&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_434_1_434_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_1_434_7&#39;)"><span class="mpre">create</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create ByteString of up to size size @l@ and use action @f@ to fill it&#39;s</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- contents which returns its true size.</span></span><span class="mpre">
</span><a href="#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_1_443_12&#39;)"><span class="mpre">createUptoN</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_443_1_443_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_1_443_12&#39;)"><span class="hl_fundecl"><span class="mpre">createUptoN</span></span></a><span class="mpre"> </span><a name="loc_443_13_443_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_13_443_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_443_15_443_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_15_443_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
    </span><a name="loc_444_5_444_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_5_444_7&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_1_489_17&#39;)"><span class="hl_varref"><span class="mpre">mallocByteString</span></span></a><span class="mpre"> </span><a href="#loc_443_13_443_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_13_443_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
    </span><a name="loc_445_5_445_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_5_445_7&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_444_5_444_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_5_444_7&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_445_32_445_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_32_445_33&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_443_15_443_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_15_443_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_445_32_445_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_32_445_33&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><a href="#loc_445_5_445_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_5_445_7&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_443_13_443_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_13_443_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_444_5_444_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_5_444_7&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_445_5_445_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_5_445_7&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_1_443_12&#39;)"><span class="mpre">createUptoN</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create ByteString of up to size @l@ and use action @f@ to fill it&#39;s contents which returns its true size.</span></span><span class="mpre">
</span><a href="#loc_451_1_451_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_1_451_13&#39;)"><span class="mpre">createUptoN&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_451_1_451_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_1_451_13&#39;)"><span class="hl_fundecl"><span class="mpre">createUptoN&#39;</span></span></a><span class="mpre"> </span><a name="loc_451_14_451_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_14_451_15&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_451_16_451_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_16_451_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
    </span><a name="loc_452_5_452_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_5_452_7&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_1_489_17&#39;)"><span class="hl_varref"><span class="mpre">mallocByteString</span></span></a><span class="mpre"> </span><a href="#loc_451_14_451_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_14_451_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
    (</span><a name="loc_453_6_453_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_6_453_8&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre">, </span><a name="loc_453_10_453_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_10_453_13&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre">) &lt;- </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_452_5_452_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_5_452_7&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_453_39_453_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_39_453_40&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_451_16_451_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_16_451_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_453_39_453_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_39_453_40&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><a href="#loc_453_6_453_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_6_453_8&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_451_14_451_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_14_451_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_452_5_452_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_5_452_7&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_453_6_453_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_6_453_8&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">, </span><a href="#loc_453_10_453_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_10_453_13&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_451_1_451_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_1_451_13&#39;)"><span class="mpre">createUptoN&#39;</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Given the maximum size needed and a function to make the contents</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of a ByteString, createAndTrim makes the &#39;ByteString&#39;. The generating</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- function is required to return the actual final size (&lt;= the maximum</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- size), and the resulting byte array is realloced to this size.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- createAndTrim is the main mechanism for creating custom, efficient</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ByteString functions, using Haskell or C functions to fill the space.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_466_1_466_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_1_466_14&#39;)"><span class="mpre">createAndTrim</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_466_1_466_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_1_466_14&#39;)"><span class="hl_fundecl"><span class="mpre">createAndTrim</span></span></a><span class="mpre"> </span><a name="loc_466_15_466_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_15_466_16&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_466_17_466_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_17_466_18&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
    </span><a name="loc_467_5_467_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_5_467_7&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_1_489_17&#39;)"><span class="hl_varref"><span class="mpre">mallocByteString</span></span></a><span class="mpre"> </span><a href="#loc_466_15_466_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_15_466_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
    </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_467_5_467_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_5_467_7&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_468_26_468_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_26_468_27&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_469_9_469_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_9_469_11&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_466_17_466_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_17_466_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_468_26_468_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_26_468_27&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
        if </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><a href="#loc_469_9_469_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_9_469_11&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_466_15_466_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_15_466_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_469_9_469_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_9_469_11&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_466_15_466_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_15_466_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
            then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_467_5_467_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_5_467_7&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_466_15_466_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_15_466_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
            else </span><a href="#loc_434_1_434_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_1_434_7&#39;)"><span class="hl_varref"><span class="mpre">create</span></span></a><span class="mpre"> </span><a href="#loc_469_9_469_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_9_469_11&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_472_31_472_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_472_31_472_33&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_1_624_7&#39;)"><span class="hl_varref"><span class="mpre">memcpy</span></span></a><span class="mpre"> </span><a href="#loc_472_31_472_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_472_31_472_33&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre"> </span><a href="#loc_468_26_468_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_26_468_27&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_469_9_469_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_9_469_11&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_466_1_466_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_1_466_14&#39;)"><span class="mpre">createAndTrim</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_476_1_476_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_1_476_15&#39;)"><span class="mpre">createAndTrim&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_476_1_476_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_1_476_15&#39;)"><span class="hl_fundecl"><span class="mpre">createAndTrim&#39;</span></span></a><span class="mpre"> </span><a name="loc_476_16_476_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_16_476_17&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_476_18_476_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_18_476_19&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
    </span><a name="loc_477_5_477_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_5_477_7&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_1_489_17&#39;)"><span class="hl_varref"><span class="mpre">mallocByteString</span></span></a><span class="mpre"> </span><a href="#loc_476_16_476_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_16_476_17&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
    </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_477_5_477_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_5_477_7&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_478_26_478_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_26_478_27&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; do
        (</span><a name="loc_479_10_479_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_10_479_13&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre">, </span><a name="loc_479_15_479_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_15_479_17&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre">, </span><a name="loc_479_19_479_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_19_479_22&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_476_18_476_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_18_476_19&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_478_26_478_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_26_478_27&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
        if </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><a href="#loc_479_15_479_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_15_479_17&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_476_16_476_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_16_476_17&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_479_15_479_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_15_479_17&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_476_16_476_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_16_476_17&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
            then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_477_5_477_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_5_477_7&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_476_16_476_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_16_476_17&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">, </span><a href="#loc_479_19_479_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_19_479_22&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">)
            else do </span><a name="loc_482_21_482_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_21_482_23&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_434_1_434_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_1_434_7&#39;)"><span class="hl_varref"><span class="mpre">create</span></span></a><span class="mpre"> </span><a href="#loc_479_15_479_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_15_479_17&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_482_40_482_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_40_482_42&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre"> -&gt;
                            </span><a href="#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_1_624_7&#39;)"><span class="hl_varref"><span class="mpre">memcpy</span></span></a><span class="mpre"> </span><a href="#loc_482_40_482_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_40_482_42&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_478_26_478_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_26_478_27&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_479_10_479_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_10_479_13&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre">) </span><a href="#loc_479_15_479_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_15_479_17&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> (</span><a href="#loc_482_21_482_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_21_482_23&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">, </span><a href="#loc_479_19_479_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_19_479_22&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Wrapper of &#39;mallocForeignPtrBytes&#39; with faster implementation for GHC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_1_489_17&#39;)"><span class="mpre">mallocByteString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="GHC.ForeignPtr.html#loc_73_6_73_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.ForeignPtr.html#loc_73_6_73_16&#39;)"><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_489_1_489_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_1_489_17&#39;)"><span class="hl_fundecl"><span class="mpre">mallocByteString</span></span></a><span class="mpre"> </span><a name="loc_489_18_489_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_18_489_19&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = do
#ifdef __GLASGOW_HASKELL__
    </span><a href="GHC.ForeignPtr.html#loc_227_1_227_27" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.ForeignPtr.html#loc_227_1_227_27&#39;)"><span class="hl_varref"><span class="mpre">mallocPlainForeignPtrBytes</span></span></a><span class="mpre"> </span><a href="#loc_489_18_489_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_18_489_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
#else
    </span><span class="hl_varref"><span class="mpre">mallocForeignPtrBytes</span></span><span class="mpre"> </span><a href="#loc_489_18_489_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_18_489_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
#endif
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_1_489_17&#39;)"><span class="mpre">mallocByteString</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Implementations for Eq, Ord and Monoid instances</span></span><span class="mpre">

</span><a href="#loc_501_1_501_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_1_501_3&#39;)"><span class="mpre">eq</span></a><span class="mpre"> :: </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_501_1_501_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_1_501_3&#39;)"><span class="hl_fundecl"><span class="mpre">eq</span></span></a><span class="mpre"> </span><a name="loc_501_4_501_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_4_501_5&#39;)"><span class="hl_specname"><span class="mpre">a</span></span></a><span class="mpre">@(</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_501_10_501_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_10_501_12&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_501_13_501_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_13_501_16&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_501_17_501_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_17_501_20&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) </span><a name="loc_501_22_501_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_22_501_23&#39;)"><span class="hl_specname"><span class="mpre">b</span></span></a><span class="mpre">@(</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_501_28_501_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_28_501_31&#39;)"><span class="hl_vardecl"><span class="mpre">fp&#39;</span></span></a><span class="mpre"> </span><a name="loc_501_32_501_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_32_501_36&#39;)"><span class="hl_vardecl"><span class="mpre">off&#39;</span></span></a><span class="mpre"> </span><a name="loc_501_37_501_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_37_501_41&#39;)"><span class="hl_vardecl"><span class="mpre">len&#39;</span></span></a><span class="mpre">)
  | </span><a href="#loc_501_17_501_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_17_501_20&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_501_37_501_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_37_501_41&#39;)"><span class="hl_varref"><span class="mpre">len&#39;</span></span></a><span class="mpre">              = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- short cut on length</span></span><span class="mpre">
  | </span><a href="#loc_501_10_501_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_10_501_12&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_501_28_501_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_28_501_31&#39;)"><span class="hl_varref"><span class="mpre">fp&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_501_13_501_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_13_501_16&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_501_32_501_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_32_501_36&#39;)"><span class="hl_varref"><span class="mpre">off&#39;</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- short cut for the same string</span></span><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                = </span><a href="#loc_509_1_509_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_509_1_509_13&#39;)"><span class="hl_varref"><span class="mpre">compareBytes</span></span></a><span class="mpre"> </span><a href="#loc_501_4_501_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_4_501_5&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_501_22_501_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_22_501_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_501_1_501_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_1_501_3&#39;)"><span class="mpre">eq</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ^ still needed</span></span><span class="mpre">

</span><a href="#loc_509_1_509_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_509_1_509_13&#39;)"><span class="mpre">compareBytes</span></a><span class="mpre"> :: </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ordering</span></span><span class="mpre">
</span><a name="loc_509_1_509_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_509_1_509_13&#39;)"><span class="hl_fundecl"><span class="mpre">compareBytes</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> _   _    </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)    (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> _   _    </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)    = </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- short cut for empty strings</span></span><span class="mpre">
</span><a href="#loc_509_1_509_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_509_1_509_13&#39;)"><span class="hl_fundecl"><span class="mpre">compareBytes</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_510_18_510_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_18_510_21&#39;)"><span class="hl_vardecl"><span class="mpre">fp1</span></span></a><span class="mpre"> </span><a name="loc_510_22_510_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_22_510_26&#39;)"><span class="hl_vardecl"><span class="mpre">off1</span></span></a><span class="mpre"> </span><a name="loc_510_27_510_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_27_510_31&#39;)"><span class="hl_vardecl"><span class="mpre">len1</span></span></a><span class="mpre">) (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_510_37_510_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_37_510_40&#39;)"><span class="hl_vardecl"><span class="mpre">fp2</span></span></a><span class="mpre"> </span><a name="loc_510_41_510_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_41_510_45&#39;)"><span class="hl_vardecl"><span class="mpre">off2</span></span></a><span class="mpre"> </span><a name="loc_510_46_510_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_46_510_50&#39;)"><span class="hl_vardecl"><span class="mpre">len2</span></span></a><span class="mpre">) =
    </span><a href="#loc_592_1_592_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_1_592_16&#39;)"><span class="hl_varref"><span class="mpre">inlinePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
      </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_510_18_510_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_18_510_21&#39;)"><span class="hl_varref"><span class="mpre">fp1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_512_29_512_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_512_29_512_31&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="mpre"> -&gt;
      </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_510_37_510_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_37_510_40&#39;)"><span class="hl_varref"><span class="mpre">fp2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_513_29_513_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_29_513_31&#39;)"><span class="hl_vardecl"><span class="mpre">p2</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_514_9_514_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_9_514_10&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_618_1_618_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_1_618_7&#39;)"><span class="hl_varref"><span class="mpre">memcmp</span></span></a><span class="mpre"> (</span><a href="#loc_512_29_512_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_512_29_512_31&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_510_22_510_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_22_510_26&#39;)"><span class="hl_varref"><span class="mpre">off1</span></span></a><span class="mpre">) (</span><a href="#loc_513_29_513_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_29_513_31&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_510_41_510_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_41_510_45&#39;)"><span class="hl_varref"><span class="mpre">off2</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> </span><a href="#loc_510_27_510_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_27_510_31&#39;)"><span class="hl_varref"><span class="mpre">len1</span></span></a><span class="mpre"> </span><a href="#loc_510_46_510_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_46_510_50&#39;)"><span class="hl_varref"><span class="mpre">len2</span></span></a><span class="mpre">)
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> case </span><a href="#loc_514_9_514_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_9_514_10&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`compare`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> of
                    </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre">  -&gt; </span><a href="#loc_510_27_510_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_27_510_31&#39;)"><span class="hl_varref"><span class="mpre">len1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`compare`</span></span><span class="mpre"> </span><a href="#loc_510_46_510_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_510_46_510_50&#39;)"><span class="hl_varref"><span class="mpre">len2</span></span></a><span class="mpre">
                    </span><a name="loc_517_21_517_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_21_517_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">   -&gt; </span><a href="#loc_517_21_517_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_21_517_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_520_1_520_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_1_520_7&#39;)"><span class="mpre">append</span></a><span class="mpre"> :: </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_520_1_520_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_1_520_7&#39;)"><span class="hl_fundecl"><span class="mpre">append</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> _   _    </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)    </span><a name="loc_520_27_520_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_27_520_28&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">                  = </span><a href="#loc_520_27_520_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_27_520_28&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
</span><a href="#loc_520_1_520_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_1_520_7&#39;)"><span class="hl_fundecl"><span class="mpre">append</span></span></a><span class="mpre"> </span><a name="loc_521_8_521_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_8_521_9&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">                  (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> _   _    </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)    = </span><a href="#loc_521_8_521_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_8_521_9&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
</span><a href="#loc_520_1_520_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_1_520_7&#39;)"><span class="hl_fundecl"><span class="mpre">append</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_522_12_522_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_12_522_15&#39;)"><span class="hl_vardecl"><span class="mpre">fp1</span></span></a><span class="mpre"> </span><a name="loc_522_16_522_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_16_522_20&#39;)"><span class="hl_vardecl"><span class="mpre">off1</span></span></a><span class="mpre"> </span><a name="loc_522_21_522_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_21_522_25&#39;)"><span class="hl_vardecl"><span class="mpre">len1</span></span></a><span class="mpre">) (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_522_31_522_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_31_522_34&#39;)"><span class="hl_vardecl"><span class="mpre">fp2</span></span></a><span class="mpre"> </span><a name="loc_522_35_522_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_35_522_39&#39;)"><span class="hl_vardecl"><span class="mpre">off2</span></span></a><span class="mpre"> </span><a name="loc_522_40_522_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_40_522_44&#39;)"><span class="hl_vardecl"><span class="mpre">len2</span></span></a><span class="mpre">) =
    </span><a href="#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_13&#39;)"><span class="hl_varref"><span class="mpre">unsafeCreate</span></span></a><span class="mpre"> (</span><a href="#loc_522_21_522_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_21_522_25&#39;)"><span class="hl_varref"><span class="mpre">len1</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_522_40_522_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_40_522_44&#39;)"><span class="hl_varref"><span class="mpre">len2</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_523_33_523_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_33_523_41&#39;)"><span class="hl_vardecl"><span class="mpre">destptr1</span></span></a><span class="mpre"> -&gt; do
      let </span><a name="loc_524_11_524_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_11_524_19&#39;)"><span class="hl_vardecl"><span class="mpre">destptr2</span></span></a><span class="mpre"> = </span><a href="#loc_523_33_523_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_33_523_41&#39;)"><span class="hl_varref"><span class="mpre">destptr1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_522_21_522_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_21_522_25&#39;)"><span class="hl_varref"><span class="mpre">len1</span></span></a><span class="mpre">
      </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_522_12_522_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_12_522_15&#39;)"><span class="hl_varref"><span class="mpre">fp1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_525_29_525_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_29_525_31&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_1_624_7&#39;)"><span class="hl_varref"><span class="mpre">memcpy</span></span></a><span class="mpre"> </span><a href="#loc_523_33_523_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_33_523_41&#39;)"><span class="hl_varref"><span class="mpre">destptr1</span></span></a><span class="mpre"> (</span><a href="#loc_525_29_525_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_29_525_31&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_522_16_522_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_16_522_20&#39;)"><span class="hl_varref"><span class="mpre">off1</span></span></a><span class="mpre">) </span><a href="#loc_522_21_522_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_21_522_25&#39;)"><span class="hl_varref"><span class="mpre">len1</span></span></a><span class="mpre">
      </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_522_31_522_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_31_522_34&#39;)"><span class="hl_varref"><span class="mpre">fp2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_526_29_526_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_29_526_31&#39;)"><span class="hl_vardecl"><span class="mpre">p2</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_1_624_7&#39;)"><span class="hl_varref"><span class="mpre">memcpy</span></span></a><span class="mpre"> </span><a href="#loc_524_11_524_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_11_524_19&#39;)"><span class="hl_varref"><span class="mpre">destptr2</span></span></a><span class="mpre"> (</span><a href="#loc_526_29_526_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_29_526_31&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_522_35_522_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_35_522_39&#39;)"><span class="hl_varref"><span class="mpre">off2</span></span></a><span class="mpre">) </span><a href="#loc_522_40_522_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_40_522_44&#39;)"><span class="hl_varref"><span class="mpre">len2</span></span></a><span class="mpre">

</span><a href="#loc_529_1_529_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_1_529_7&#39;)"><span class="mpre">concat</span></a><span class="mpre"> :: [</span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_529_1_529_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_1_529_7&#39;)"><span class="hl_fundecl"><span class="mpre">concat</span></span></a><span class="mpre"> []     = </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
</span><a href="#loc_529_1_529_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_1_529_7&#39;)"><span class="hl_fundecl"><span class="mpre">concat</span></span></a><span class="mpre"> [</span><a name="loc_530_9_530_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_9_530_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">]   = </span><a href="#loc_530_9_530_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_9_530_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
</span><a href="#loc_529_1_529_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_1_529_7&#39;)"><span class="hl_fundecl"><span class="mpre">concat</span></span></a><span class="mpre"> </span><a name="loc_531_8_531_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_8_531_12&#39;)"><span class="hl_vardecl"><span class="mpre">bss0</span></span></a><span class="mpre">   = </span><a href="#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_13&#39;)"><span class="hl_varref"><span class="mpre">unsafeCreate</span></span></a><span class="mpre"> </span><a href="#loc_533_5_533_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_5_533_13&#39;)"><span class="hl_varref"><span class="mpre">totalLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_531_42_531_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_42_531_45&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_534_5_534_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_534_5_534_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_531_8_531_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_8_531_12&#39;)"><span class="hl_varref"><span class="mpre">bss0</span></span></a><span class="mpre"> </span><a href="#loc_531_42_531_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_42_531_45&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">
  where
    </span><a name="loc_533_5_533_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_5_533_13&#39;)"><span class="hl_vardecl"><span class="mpre">totalLen</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_1025_1_1025_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1025_1_1025_4&#39;)"><span class="hl_varref"><span class="mpre">List.sum</span></span></a><span class="mpre"> [ </span><a href="#loc_533_41_533_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_41_533_44&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> | (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> _ _ </span><a name="loc_533_41_533_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_41_533_44&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_531_8_531_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_531_8_531_12&#39;)"><span class="hl_varref"><span class="mpre">bss0</span></span></a><span class="mpre"> ]
    </span><a name="loc_534_5_534_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_534_5_534_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> []                  !_   = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
    </span><a href="#loc_534_5_534_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_534_5_534_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a name="loc_535_12_535_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_12_535_14&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_535_15_535_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_15_535_18&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_535_19_535_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_19_535_22&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_535_23_535_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_23_535_26&#39;)"><span class="hl_vardecl"><span class="mpre">bss</span></span></a><span class="mpre">) !</span><a name="loc_535_29_535_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_29_535_32&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> = do
      </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_535_12_535_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_12_535_14&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_536_28_536_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_28_536_29&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_1_624_7&#39;)"><span class="hl_varref"><span class="mpre">memcpy</span></span></a><span class="mpre"> </span><a href="#loc_535_29_535_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_29_535_32&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><a href="#loc_536_28_536_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_28_536_29&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_535_15_535_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_15_535_18&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre">) </span><a href="#loc_535_19_535_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_19_535_22&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
      </span><a href="#loc_534_5_534_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_534_5_534_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_535_23_535_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_23_535_26&#39;)"><span class="hl_varref"><span class="mpre">bss</span></span></a><span class="mpre"> (</span><a href="#loc_535_29_535_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_29_535_32&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_535_19_535_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_19_535_22&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Conversion between &#39;Word8&#39; and &#39;Char&#39;. Should compile to a no-op.</span></span><span class="mpre">
</span><a href="#loc_544_1_544_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_1_544_4&#39;)"><span class="mpre">w2c</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
#if !defined(__GLASGOW_HASKELL__)
</span><a name="loc_544_1_544_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_1_544_4&#39;)"><span class="hl_vardecl"><span class="mpre">w2c</span></span></a><span class="mpre"> = </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">
#else
</span><span class="hl_vardecl"><span class="mpre">w2c</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeChr</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">
#endif
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_544_1_544_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_1_544_4&#39;)"><span class="mpre">w2c</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Unsafe conversion between &#39;Char&#39; and &#39;Word8&#39;. This is a no-op and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- silently truncates to 8 bits Chars &gt; &#39;\255&#39;. It is provided as</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- convenience for ByteString construction.</span></span><span class="mpre">
</span><a href="#loc_554_1_554_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_1_554_4&#39;)"><span class="mpre">c2w</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
</span><a name="loc_554_1_554_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_1_554_4&#39;)"><span class="hl_vardecl"><span class="mpre">c2w</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_554_1_554_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_1_554_4&#39;)"><span class="mpre">c2w</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Selects words corresponding to white-space characters in the Latin-1 range</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ordered by frequency.</span></span><span class="mpre">
</span><a href="#loc_560_1_560_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_1_560_13&#39;)"><span class="mpre">isSpaceWord8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_560_1_560_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_1_560_13&#39;)"><span class="hl_fundecl"><span class="mpre">isSpaceWord8</span></span></a><span class="mpre"> </span><a name="loc_560_14_560_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_14_560_15&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> =
    </span><a href="#loc_560_14_560_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_14_560_15&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x20</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre">
    </span><a href="#loc_560_14_560_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_14_560_15&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x0A</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- LF, \n</span></span><span class="mpre">
    </span><a href="#loc_560_14_560_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_14_560_15&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x09</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- HT, \t</span></span><span class="mpre">
    </span><a href="#loc_560_14_560_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_14_560_15&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x0C</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- FF, \f</span></span><span class="mpre">
    </span><a href="#loc_560_14_560_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_14_560_15&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x0D</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- CR, \r</span></span><span class="mpre">
    </span><a href="#loc_560_14_560_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_14_560_15&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x0B</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- VT, \v</span></span><span class="mpre">
    </span><a href="#loc_560_14_560_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_14_560_15&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xA0</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- spotted by QC..</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_560_1_560_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_1_560_13&#39;)"><span class="mpre">isSpaceWord8</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Selects white-space characters in the Latin-1 range</span></span><span class="mpre">
</span><a href="#loc_572_1_572_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_1_572_13&#39;)"><span class="mpre">isSpaceChar8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_572_1_572_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_1_572_13&#39;)"><span class="hl_fundecl"><span class="mpre">isSpaceChar8</span></span></a><span class="mpre"> </span><a name="loc_572_14_572_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_14_572_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> =
    </span><a href="#loc_572_14_572_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_14_572_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre">     </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre">
    </span><a href="#loc_572_14_572_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_14_572_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\t&#39;</span></span><span class="mpre">    </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre">
    </span><a href="#loc_572_14_572_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_14_572_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">    </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre">
    </span><a href="#loc_572_14_572_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_14_572_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\r&#39;</span></span><span class="mpre">    </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre">
    </span><a href="#loc_572_14_572_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_14_572_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\f&#39;</span></span><span class="mpre">    </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre">
    </span><a href="#loc_572_14_572_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_14_572_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\v&#39;</span></span><span class="mpre">    </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre">
    </span><a href="#loc_572_14_572_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_14_572_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\xa0&#39;</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_572_1_572_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_572_1_572_13&#39;)"><span class="mpre">isSpaceChar8</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Just like unsafePerformIO, but we inline it. Big performance gains as</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it exposes lots of things to further inlining. /Very unsafe/. In</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- particular, you should do no memory allocation inside an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;inlinePerformIO&#39; block. On Hugs this is just @unsafePerformIO@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_592_1_592_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_1_592_16&#39;)"><span class="mpre">inlinePerformIO</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_592_1_592_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_1_592_16&#39;)"><span class="mpre">inlinePerformIO</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
#if defined(__GLASGOW_HASKELL__)
</span><a name="loc_592_1_592_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_1_592_16&#39;)"><span class="hl_fundecl"><span class="mpre">inlinePerformIO</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">IO</span></span><span class="mpre"> </span><a name="loc_592_21_592_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_21_592_22&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) = case </span><a href="#loc_592_21_592_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_21_592_22&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">realWorld#</span></span><span class="mpre"> of (# _, </span><a name="loc_592_53_592_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_53_592_54&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> #) -&gt; </span><a href="#loc_592_53_592_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_53_592_54&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
#else
</span><span class="hl_vardecl"><span class="mpre">inlinePerformIO</span></span><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Standard C functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 602, srcSpanStartColumn = 1, srcSpanEndLine = 603, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 602, srcSpanStartColumn = 1, srcSpanEndLine = 602, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteS"><span class="mpre">foreign import ccall unsafe &quot;string.h strlen&quot; c_strlen
    :: CString -&gt; IO CSize</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 605, srcSpanStartColumn = 1, srcSpanEndLine = 606, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 605, srcSpanStartColumn = 1, srcSpanEndLine = 605, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteS"><span class="mpre">foreign import ccall unsafe &quot;static stdlib.h &amp;free&quot; c_free_finalizer
    :: FunPtr (Ptr Word8 -&gt; IO ())</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 608, srcSpanStartColumn = 1, srcSpanEndLine = 609, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 608, srcSpanStartColumn = 1, srcSpanEndLine = 608, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteS"><span class="mpre">foreign import ccall unsafe &quot;string.h memchr&quot; c_memchr
    :: Ptr Word8 -&gt; CInt -&gt; CSize -&gt; IO (Ptr Word8)</span></span><span class="mpre">

</span><a href="#loc_612_1_612_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_612_1_612_7&#39;)"><span class="mpre">memchr</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CSize</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
</span><a name="loc_612_1_612_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_612_1_612_7&#39;)"><span class="hl_fundecl"><span class="mpre">memchr</span></span></a><span class="mpre"> </span><a name="loc_612_8_612_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_612_8_612_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_612_10_612_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_612_10_612_11&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_612_12_612_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_612_12_612_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">c_memchr</span></span><span class="mpre"> </span><a href="#loc_612_8_612_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_612_8_612_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_612_10_612_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_612_10_612_11&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) </span><a href="#loc_612_12_612_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_612_12_612_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 614, srcSpanStartColumn = 1, srcSpanEndLine = 615, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 614, srcSpanStartColumn = 1, srcSpanEndLine = 614, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteS"><span class="mpre">foreign import ccall unsafe &quot;string.h memcmp&quot; c_memcmp
    :: Ptr Word8 -&gt; Ptr Word8 -&gt; CSize -&gt; IO CInt</span></span><span class="mpre">

</span><a href="#loc_618_1_618_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_1_618_7&#39;)"><span class="mpre">memcmp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CInt</span></span><span class="mpre">
</span><a name="loc_618_1_618_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_1_618_7&#39;)"><span class="hl_fundecl"><span class="mpre">memcmp</span></span></a><span class="mpre"> </span><a name="loc_618_8_618_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_8_618_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_618_10_618_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_10_618_11&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> </span><a name="loc_618_12_618_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_12_618_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">c_memcmp</span></span><span class="mpre"> </span><a href="#loc_618_8_618_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_8_618_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_618_10_618_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_10_618_11&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_618_12_618_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_12_618_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 620, srcSpanStartColumn = 1, srcSpanEndLine = 621, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 620, srcSpanStartColumn = 1, srcSpanEndLine = 620, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteS"><span class="mpre">foreign import ccall unsafe &quot;string.h memcpy&quot; c_memcpy
    :: Ptr Word8 -&gt; Ptr Word8 -&gt; CSize -&gt; IO (Ptr Word8)</span></span><span class="mpre">

</span><a href="#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_1_624_7&#39;)"><span class="mpre">memcpy</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_624_1_624_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_1_624_7&#39;)"><span class="hl_fundecl"><span class="mpre">memcpy</span></span></a><span class="mpre"> </span><a name="loc_624_8_624_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_8_624_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_624_10_624_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_10_624_11&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> </span><a name="loc_624_12_624_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_12_624_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">c_memcpy</span></span><span class="mpre"> </span><a href="#loc_624_8_624_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_8_624_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_624_10_624_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_10_624_11&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_624_12_624_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_12_624_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
foreign import ccall unsafe &quot;string.h memmove&quot; c_memmove
    :: Ptr Word8 -&gt; Ptr Word8 -&gt; CSize -&gt; IO (Ptr Word8)

memmove :: Ptr Word8 -&gt; Ptr Word8 -&gt; CSize -&gt; IO ()
memmove p q s = do c_memmove p q s
                   return ()
-}</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 635, srcSpanStartColumn = 1, srcSpanEndLine = 636, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 635, srcSpanStartColumn = 1, srcSpanEndLine = 635, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteS"><span class="mpre">foreign import ccall unsafe &quot;string.h memset&quot; c_memset
    :: Ptr Word8 -&gt; CInt -&gt; CSize -&gt; IO (Ptr Word8)</span></span><span class="mpre">

</span><a href="#loc_639_1_639_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_1_639_7&#39;)"><span class="mpre">memset</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CSize</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
</span><a name="loc_639_1_639_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_1_639_7&#39;)"><span class="hl_fundecl"><span class="mpre">memset</span></span></a><span class="mpre"> </span><a name="loc_639_8_639_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_8_639_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_639_10_639_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_10_639_11&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_639_12_639_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_12_639_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">c_memset</span></span><span class="mpre"> </span><a href="#loc_639_8_639_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_8_639_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_639_10_639_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_10_639_11&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) </span><a href="#loc_639_12_639_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_12_639_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Uses our C code</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 646, srcSpanStartColumn = 1, srcSpanEndLine = 647, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 646, srcSpanStartColumn = 1, srcSpanEndLine = 646, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteS"><span class="mpre">foreign import ccall unsafe &quot;static fpstring.h fps_reverse&quot; c_reverse
    :: Ptr Word8 -&gt; Ptr Word8 -&gt; CULong -&gt; IO ()</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 649, srcSpanStartColumn = 1, srcSpanEndLine = 650, srcSpanEndColumn = 58}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 649, srcSpanStartColumn = 1, srcSpanEndLine = 649, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteS"><span class="mpre">foreign import ccall unsafe &quot;static fpstring.h fps_intersperse&quot; c_intersperse
    :: Ptr Word8 -&gt; Ptr Word8 -&gt; CULong -&gt; Word8 -&gt; IO ()</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 652, srcSpanStartColumn = 1, srcSpanEndLine = 653, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 652, srcSpanStartColumn = 1, srcSpanEndLine = 652, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteS"><span class="mpre">foreign import ccall unsafe &quot;static fpstring.h fps_maximum&quot; c_maximum
    :: Ptr Word8 -&gt; CULong -&gt; IO Word8</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 655, srcSpanStartColumn = 1, srcSpanEndLine = 656, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 655, srcSpanStartColumn = 1, srcSpanEndLine = 655, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteS"><span class="mpre">foreign import ccall unsafe &quot;static fpstring.h fps_minimum&quot; c_minimum
    :: Ptr Word8 -&gt; CULong -&gt; IO Word8</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 658, srcSpanStartColumn = 1, srcSpanEndLine = 659, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteString/Internal.hs&quot;, srcSpanStartLine = 658, srcSpanStartColumn = 1, srcSpanEndLine = 658, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/bytestring-0.10.4.0/Data/ByteS"><span class="mpre">foreign import ccall unsafe &quot;static fpstring.h fps_count&quot; c_count
    :: Ptr Word8 -&gt; CULong -&gt; Word8 -&gt; IO CULong</span></span><span class="mpre">

</span></div></body></html>