<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS -fglasgow-exts #-}

module FreeNames (tests) where

</span><span class="hl_comment"><span class="mpre">{-

This example illustrates the kind of traversals that naturally show up
in language processing. That is, the free names (say, variables) are
derived for a given program fragment. To this end, we need several
worker functions that extract declaring and referencing occurrences
from given program fragments; see &quot;decsExpr&quot;, &quot;decsEqua&quot;,
etc. below. Then, we need a traversal &quot;freeNames&quot; that traverses over
the program fragment in a bottom-up manner so that free names from
subterms do not escape to the top when corresponding declarations are
provided. The &quot;freeNames&quot; algorithm uses set operations &quot;union&quot; and
&quot;//&quot; to compute sets of free names from the declared and referenced
names of the root term and free names of the immediate subterms.

Contributed by Ralf Laemmel, ralf@cwi.nl

-}</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 8, srcSpanEndLine = 23, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">

import Data.Generics
import Data.List

data </span><a name="loc_28_6_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_12&#39;)"><span class="hl_tycondecl"><span class="mpre">System</span></span></a><span class="mpre">     = </span><a name="loc_28_19_28_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_19_28_20&#39;)"><span class="hl_condecl"><span class="mpre">S</span></span></a><span class="mpre"> [</span><a href="#loc_30_6_30_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_14&#39;)"><span class="hl_tyconref"><span class="mpre">Function</span></span></a><span class="mpre">]                     </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 52, srcSpanEndLine = 28, srcSpanEndColumn = 77}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 52, srcSpanEndLine = 28, srcSpanEndColumn = 60},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 28, srcSpanStartC"><span class="mpre">deriving (Typeable, Data)</span></span><span class="mpre">

data </span><a name="loc_30_6_30_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_14&#39;)"><span class="hl_tycondecl"><span class="mpre">Function</span></span></a><span class="mpre">   = </span><a name="loc_30_19_30_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_19_30_20&#39;)"><span class="hl_condecl"><span class="mpre">F</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> [</span><a href="#loc_32_6_32_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_14&#39;)"><span class="hl_tyconref"><span class="mpre">Equation</span></span></a><span class="mpre">]                </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 52, srcSpanEndLine = 30, srcSpanEndColumn = 77}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 52, srcSpanEndLine = 30, srcSpanEndColumn = 60},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 30, srcSpanStartC"><span class="mpre">deriving (Typeable, Data)</span></span><span class="mpre">

data </span><a name="loc_32_6_32_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_14&#39;)"><span class="hl_tycondecl"><span class="mpre">Equation</span></span></a><span class="mpre">   = </span><a name="loc_32_19_32_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_20&#39;)"><span class="hl_condecl"><span class="mpre">E</span></span></a><span class="mpre"> [</span><a href="#loc_34_6_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_6_34_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">] </span><a href="#loc_37_6_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_16&#39;)"><span class="hl_tyconref"><span class="mpre">Expression</span></span></a><span class="mpre"> </span><a href="#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_12&#39;)"><span class="hl_tyconref"><span class="mpre">System</span></span></a><span class="mpre">    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 52, srcSpanEndLine = 32, srcSpanEndColumn = 77}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 52, srcSpanEndLine = 32, srcSpanEndColumn = 60},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 32, srcSpanStartC"><span class="mpre">deriving (Typeable, Data)</span></span><span class="mpre">

data </span><a name="loc_34_6_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_6_34_13&#39;)"><span class="hl_tycondecl"><span class="mpre">Pattern</span></span></a><span class="mpre">    = </span><a name="loc_34_19_34_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_19_34_23&#39;)"><span class="hl_condecl"><span class="mpre">PVar</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">
                | </span><a name="loc_35_19_35_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_19_35_24&#39;)"><span class="hl_condecl"><span class="mpre">PTerm</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> [</span><a href="#loc_34_6_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_6_34_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">]             </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 52, srcSpanEndLine = 35, srcSpanEndColumn = 77}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 52, srcSpanEndLine = 35, srcSpanEndColumn = 60},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 35, srcSpanStartC"><span class="mpre">deriving (Typeable, Data)</span></span><span class="mpre">

data </span><a name="loc_37_6_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_16&#39;)"><span class="hl_tycondecl"><span class="mpre">Expression</span></span></a><span class="mpre"> = </span><a name="loc_37_19_37_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_19_37_22&#39;)"><span class="hl_condecl"><span class="mpre">Var</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">
                | </span><span class="hl_condecl"><span class="mpre">App</span></span><span class="mpre"> </span><a href="#loc_37_6_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_16&#39;)"><span class="hl_tyconref"><span class="mpre">Expression</span></span></a><span class="mpre"> </span><a href="#loc_37_6_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_16&#39;)"><span class="hl_tyconref"><span class="mpre">Expression</span></span></a><span class="mpre">
                | </span><a name="loc_39_19_39_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_19_39_25&#39;)"><span class="hl_condecl"><span class="mpre">Lambda</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre"> </span><a href="#loc_37_6_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_16&#39;)"><span class="hl_tyconref"><span class="mpre">Expression</span></span></a><span class="mpre">           </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 52, srcSpanEndLine = 39, srcSpanEndColumn = 77}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 52, srcSpanEndLine = 39, srcSpanEndColumn = 60},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 39, srcSpanStartC"><span class="mpre">deriving (Typeable, Data)</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 1, srcSpanEndLine = 41, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 1, srcSpanEndLine = 41, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 41, srcSpanStartColu"><span class="mpre">type Name       = String</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- A little sample program</span></span><span class="mpre">

</span><a name="loc_45_1_45_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_5&#39;)"><span class="hl_vardecl"><span class="mpre">sys1</span></span></a><span class="mpre">   = </span><a href="#loc_28_19_28_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_19_28_20&#39;)"><span class="hl_conref"><span class="mpre">S</span></span></a><span class="mpre"> [</span><a href="#loc_46_1_46_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_3&#39;)"><span class="hl_varref"><span class="mpre">f1</span></span></a><span class="mpre">,</span><a href="#loc_47_1_47_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_3&#39;)"><span class="hl_varref"><span class="mpre">f2</span></span></a><span class="mpre">]
</span><a name="loc_46_1_46_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_3&#39;)"><span class="hl_vardecl"><span class="mpre">f1</span></span></a><span class="mpre">     = </span><a href="#loc_30_19_30_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_19_30_20&#39;)"><span class="hl_conref"><span class="mpre">F</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;f1&quot;</span></span><span class="mpre"> [</span><a href="#loc_48_1_48_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_4&#39;)"><span class="hl_varref"><span class="mpre">e11</span></span></a><span class="mpre">]
</span><a name="loc_47_1_47_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_3&#39;)"><span class="hl_vardecl"><span class="mpre">f2</span></span></a><span class="mpre">     = </span><a href="#loc_30_19_30_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_19_30_20&#39;)"><span class="hl_conref"><span class="mpre">F</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;f2&quot;</span></span><span class="mpre"> [</span><a href="#loc_49_1_49_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_4&#39;)"><span class="hl_varref"><span class="mpre">e21</span></span></a><span class="mpre">,</span><a href="#loc_50_1_50_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_4&#39;)"><span class="hl_varref"><span class="mpre">e22</span></span></a><span class="mpre">]
</span><a name="loc_48_1_48_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_4&#39;)"><span class="hl_vardecl"><span class="mpre">e11</span></span></a><span class="mpre">    = </span><a href="#loc_32_19_32_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_20&#39;)"><span class="hl_conref"><span class="mpre">E</span></span></a><span class="mpre"> [] (</span><a href="#loc_37_19_37_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_19_37_22&#39;)"><span class="hl_conref"><span class="mpre">Var</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;id&quot;</span></span><span class="mpre">) (</span><a href="#loc_28_19_28_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_19_28_20&#39;)"><span class="hl_conref"><span class="mpre">S</span></span></a><span class="mpre"> [])
</span><a name="loc_49_1_49_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_4&#39;)"><span class="hl_vardecl"><span class="mpre">e21</span></span></a><span class="mpre">    = </span><a href="#loc_32_19_32_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_20&#39;)"><span class="hl_conref"><span class="mpre">E</span></span></a><span class="mpre"> [ </span><a href="#loc_35_19_35_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_19_35_24&#39;)"><span class="hl_conref"><span class="mpre">PTerm</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;C&quot;</span></span><span class="mpre"> [ </span><a href="#loc_34_19_34_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_19_34_23&#39;)"><span class="hl_conref"><span class="mpre">PVar</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;x&quot;</span></span><span class="mpre"> ] ] (</span><a href="#loc_37_19_37_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_19_37_22&#39;)"><span class="hl_conref"><span class="mpre">Var</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;x&quot;</span></span><span class="mpre">) (</span><a href="#loc_28_19_28_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_19_28_20&#39;)"><span class="hl_conref"><span class="mpre">S</span></span></a><span class="mpre"> [])
</span><a name="loc_50_1_50_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_4&#39;)"><span class="hl_vardecl"><span class="mpre">e22</span></span></a><span class="mpre">    = </span><a href="#loc_32_19_32_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_20&#39;)"><span class="hl_conref"><span class="mpre">E</span></span></a><span class="mpre"> [] (</span><a href="#loc_37_19_37_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_19_37_22&#39;)"><span class="hl_conref"><span class="mpre">Var</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;id&quot;</span></span><span class="mpre">) (</span><a href="#loc_28_19_28_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_19_28_20&#39;)"><span class="hl_conref"><span class="mpre">S</span></span></a><span class="mpre"> [])


</span><span class="hl_comment"><span class="mpre">-- Names declared in an expression</span></span><span class="mpre">
</span><a href="#loc_55_1_55_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_9&#39;)"><span class="mpre">decsExpr</span></a><span class="mpre"> :: </span><a href="#loc_37_6_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_16&#39;)"><span class="hl_tyconref"><span class="mpre">Expression</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">]
</span><a name="loc_55_1_55_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_9&#39;)"><span class="hl_fundecl"><span class="mpre">decsExpr</span></span></a><span class="mpre"> (</span><a href="#loc_39_19_39_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_19_39_25&#39;)"><span class="hl_conref"><span class="mpre">Lambda</span></span></a><span class="mpre"> </span><a name="loc_55_18_55_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_18_55_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _) = [</span><a href="#loc_55_18_55_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_18_55_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">]
</span><a href="#loc_55_1_55_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_9&#39;)"><span class="hl_fundecl"><span class="mpre">decsExpr</span></span></a><span class="mpre"> _            = []

</span><span class="hl_comment"><span class="mpre">-- Names declared in an equation</span></span><span class="mpre">
</span><a href="#loc_60_1_60_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_9&#39;)"><span class="mpre">decsEqua</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_14&#39;)"><span class="hl_tyconref"><span class="mpre">Equation</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">]
</span><a name="loc_60_1_60_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_9&#39;)"><span class="hl_fundecl"><span class="mpre">decsEqua</span></span></a><span class="mpre"> (</span><a href="#loc_32_19_32_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_20&#39;)"><span class="hl_conref"><span class="mpre">E</span></span></a><span class="mpre"> </span><a name="loc_60_13_60_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_13_60_15&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> _ _) = </span><a href="Data.Generics.Schemes.html#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Schemes.html#loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">everything</span></span></a><span class="mpre"> </span><a href="Data.List.html#loc_392_1_392_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_392_1_392_6&#39;)"><span class="hl_varref"><span class="mpre">union</span></span></a><span class="mpre"> ([] </span><a href="Data.Generics.Aliases.html#loc_100_4_100_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_100_4_100_9&#39;)"><span class="hl_infix"><span class="mpre">`mkQ`</span></span></a><span class="mpre"> </span><a href="#loc_62_5_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_9&#39;)"><span class="hl_varref"><span class="mpre">pvar</span></span></a><span class="mpre">) </span><a href="#loc_60_13_60_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_13_60_15&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">
  where
    </span><a name="loc_62_5_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_9&#39;)"><span class="hl_fundecl"><span class="mpre">pvar</span></span></a><span class="mpre"> (</span><a href="#loc_34_19_34_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_19_34_23&#39;)"><span class="hl_conref"><span class="mpre">PVar</span></span></a><span class="mpre"> </span><a name="loc_62_16_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_16_62_17&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) = [</span><a href="#loc_62_16_62_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_16_62_17&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">]
    </span><a href="#loc_62_5_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_9&#39;)"><span class="hl_fundecl"><span class="mpre">pvar</span></span></a><span class="mpre"> _        = []

</span><span class="hl_comment"><span class="mpre">-- Names declared in a system</span></span><span class="mpre">
</span><a href="#loc_67_1_67_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_9&#39;)"><span class="mpre">decsSyst</span></a><span class="mpre"> :: </span><a href="#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_6_28_12&#39;)"><span class="hl_tyconref"><span class="mpre">System</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">]
</span><a name="loc_67_1_67_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_9&#39;)"><span class="hl_fundecl"><span class="mpre">decsSyst</span></span></a><span class="mpre"> (</span><a href="#loc_28_19_28_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_19_28_20&#39;)"><span class="hl_conref"><span class="mpre">S</span></span></a><span class="mpre"> </span><a name="loc_67_13_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_13_67_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = </span><a href="Data.List.html#loc_314_1_314_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_314_1_314_4&#39;)"><span class="hl_varref"><span class="mpre">nub</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(</span><a href="#loc_30_19_30_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_19_30_20&#39;)"><span class="hl_conref"><span class="mpre">F</span></span></a><span class="mpre"> </span><a name="loc_67_33_67_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_33_67_34&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _) -&gt; </span><a href="#loc_67_33_67_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_33_67_34&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><a href="#loc_67_13_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_13_67_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Names referenced in an expression</span></span><span class="mpre">
</span><a href="#loc_71_1_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_9&#39;)"><span class="mpre">refsExpr</span></a><span class="mpre"> :: </span><a href="#loc_37_6_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_16&#39;)"><span class="hl_tyconref"><span class="mpre">Expression</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">]
</span><a name="loc_71_1_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_9&#39;)"><span class="hl_fundecl"><span class="mpre">refsExpr</span></span></a><span class="mpre"> (</span><a href="#loc_37_19_37_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_19_37_22&#39;)"><span class="hl_conref"><span class="mpre">Var</span></span></a><span class="mpre"> </span><a name="loc_71_15_71_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_15_71_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) = [</span><a href="#loc_71_15_71_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_15_71_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- Names referenced in an equation</span></span><span class="mpre">
</span><a href="#loc_75_1_75_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_9&#39;)"><span class="mpre">refsEqua</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_14&#39;)"><span class="hl_tyconref"><span class="mpre">Equation</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">]
</span><a name="loc_75_1_75_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_9&#39;)"><span class="hl_fundecl"><span class="mpre">refsEqua</span></span></a><span class="mpre"> (</span><a href="#loc_32_19_32_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_20&#39;)"><span class="hl_conref"><span class="mpre">E</span></span></a><span class="mpre"> </span><a name="loc_75_13_75_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_15&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> _ _) = </span><a href="Data.Generics.Schemes.html#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Schemes.html#loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">everything</span></span></a><span class="mpre"> </span><a href="Data.List.html#loc_392_1_392_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_392_1_392_6&#39;)"><span class="hl_varref"><span class="mpre">union</span></span></a><span class="mpre"> ([] </span><a href="Data.Generics.Aliases.html#loc_100_4_100_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_100_4_100_9&#39;)"><span class="hl_infix"><span class="mpre">`mkQ`</span></span></a><span class="mpre"> </span><a href="#loc_77_5_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_10&#39;)"><span class="hl_varref"><span class="mpre">pterm</span></span></a><span class="mpre">) </span><a href="#loc_75_13_75_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_15&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">
  where
    </span><a name="loc_77_5_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_10&#39;)"><span class="hl_fundecl"><span class="mpre">pterm</span></span></a><span class="mpre"> (</span><a href="#loc_35_19_35_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_19_35_24&#39;)"><span class="hl_conref"><span class="mpre">PTerm</span></span></a><span class="mpre"> </span><a name="loc_77_18_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _) = [</span><a href="#loc_77_18_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">]
    </span><a href="#loc_77_5_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_10&#39;)"><span class="hl_fundecl"><span class="mpre">pterm</span></span></a><span class="mpre"> _           = []

</span><span class="hl_comment"><span class="mpre">-- Combine the above type-specific cases to obtain</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- generic functions that find declared and referenced names</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_84_1_84_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_8&#39;)"><span class="mpre">decsFun</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 12, srcSpanEndLine = 83, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 19, srcSpanEndLine = 83, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">]
</span><a name="loc_84_1_84_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_8&#39;)"><span class="hl_vardecl"><span class="mpre">decsFun</span></span></a><span class="mpre"> =  </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> [] </span><a href="Data.Generics.Aliases.html#loc_177_1_177_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_177_1_177_5&#39;)"><span class="hl_infix"><span class="mpre">`extQ`</span></span></a><span class="mpre"> </span><a href="#loc_55_1_55_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_9&#39;)"><span class="hl_varref"><span class="mpre">decsExpr</span></span></a><span class="mpre"> </span><a href="Data.Generics.Aliases.html#loc_177_1_177_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_177_1_177_5&#39;)"><span class="hl_infix"><span class="mpre">`extQ`</span></span></a><span class="mpre"> </span><a href="#loc_60_1_60_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_9&#39;)"><span class="hl_varref"><span class="mpre">decsEqua</span></span></a><span class="mpre"> </span><a href="Data.Generics.Aliases.html#loc_177_1_177_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_177_1_177_5&#39;)"><span class="hl_infix"><span class="mpre">`extQ`</span></span></a><span class="mpre"> </span><a href="#loc_67_1_67_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_9&#39;)"><span class="hl_varref"><span class="mpre">decsSyst</span></span></a><span class="mpre">

</span><a href="#loc_87_1_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_8&#39;)"><span class="mpre">refsFun</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 12, srcSpanEndLine = 86, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 19, srcSpanEndLine = 86, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">]
</span><a name="loc_87_1_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_8&#39;)"><span class="hl_vardecl"><span class="mpre">refsFun</span></span></a><span class="mpre"> =  </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> [] </span><a href="Data.Generics.Aliases.html#loc_177_1_177_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_177_1_177_5&#39;)"><span class="hl_infix"><span class="mpre">`extQ`</span></span></a><span class="mpre"> </span><a href="#loc_71_1_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_9&#39;)"><span class="hl_varref"><span class="mpre">refsExpr</span></span></a><span class="mpre"> </span><a href="Data.Generics.Aliases.html#loc_177_1_177_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_177_1_177_5&#39;)"><span class="hl_infix"><span class="mpre">`extQ`</span></span></a><span class="mpre"> </span><a href="#loc_75_1_75_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_9&#39;)"><span class="hl_varref"><span class="mpre">refsEqua</span></span></a><span class="mpre">



</span><span class="hl_comment"><span class="mpre">{-

Free name analysis: Take the union of free names obtained from the
immediate subterms (via gmapQ) and the names being referred to at the
root of the present term, but subtract all the names that are declared
at the root.

-}</span></span><span class="mpre">
 
</span><a href="#loc_101_1_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_10&#39;)"><span class="mpre">freeNames</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 100, srcSpanStartColumn = 14, srcSpanEndLine = 100, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeNames.hs&quot;, srcSpanStartLine = 100, srcSpanStartColumn = 21, srcSpanEndLine = 100, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/FreeName"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Name</span></span><span class="mpre">]
</span><a name="loc_101_1_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_10&#39;)"><span class="hl_fundecl"><span class="mpre">freeNames</span></span></a><span class="mpre"> </span><a name="loc_101_11_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_11_101_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = ( (</span><a href="#loc_87_1_87_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_8&#39;)"><span class="hl_varref"><span class="mpre">refsFun</span></span></a><span class="mpre"> </span><a href="#loc_101_11_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_11_101_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
                </span><a href="Data.List.html#loc_392_1_392_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_392_1_392_6&#39;)"><span class="hl_infix"><span class="mpre">`union`</span></span></a><span class="mpre">
                (</span><a href="Data.List.html#loc_314_1_314_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_314_1_314_4&#39;)"><span class="hl_varref"><span class="mpre">nub</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> </span><a href="#loc_101_1_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_10&#39;)"><span class="hl_varref"><span class="mpre">freeNames</span></span></a><span class="mpre">) </span><a href="#loc_101_11_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_11_101_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
              ) </span><a href="Data.List.html#loc_378_1_378_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_378_1_378_5&#39;)"><span class="hl_infix"><span class="mpre">\\</span></span></a><span class="mpre"> </span><a href="#loc_84_1_84_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_8&#39;)"><span class="hl_varref"><span class="mpre">decsFun</span></span></a><span class="mpre"> </span><a href="#loc_101_11_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_11_101_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-

Print the free names for the sample program sys1; see module
FunDatatypes.hs. This should print the list [&quot;id&quot;,&quot;C&quot;] because the
&quot;Prelude&quot; function &quot;id&quot; is used in the sample program, and also the
term constructor &quot;C&quot; occurs in a pattern; we assume a language without
explicit datatype declarations ;-)

-}</span></span><span class="mpre">

</span><a name="loc_116_1_116_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = </span><a href="#loc_101_1_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_10&#39;)"><span class="hl_varref"><span class="mpre">freeNames</span></span></a><span class="mpre"> </span><a href="#loc_45_1_45_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_5&#39;)"><span class="hl_varref"><span class="mpre">sys1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">~=?</span></span><span class="mpre"> </span><a href="#loc_118_1_118_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_7&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">

</span><a name="loc_118_1_118_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_7&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = [</span><span class="hl_string"><span class="mpre">&quot;id&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;C&quot;</span></span><span class="mpre">]
</span></div></body></html>