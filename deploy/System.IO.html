<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE Trustworthy #-}
{-# LANGUAGE CPP, NoImplicitPrelude #-}

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  System.IO</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The University of Glasgow 2001</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The standard IO library.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module System.IO (
    </span><span class="hl_comment"><span class="mpre">-- * The IO monad</span></span><span class="mpre">

    IO,
    fixIO,

    </span><span class="hl_comment"><span class="mpre">-- * Files and handles</span></span><span class="mpre">

    FilePath,

    Handle,             </span><span class="hl_comment"><span class="mpre">-- abstract, instance of: Eq, Show.</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | GHC note: a &#39;Handle&#39; will be automatically closed when the garbage</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- collector detects that it has become unreferenced by the program.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- However, relying on this behaviour is not generally recommended:</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- the garbage collector is unpredictable.  If possible, use</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- an explicit &#39;hClose&#39; to close &#39;Handle&#39;s when they are no longer</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- required.  GHC does not currently attempt to free up file</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- descriptors when they have run out, it is your responsibility to</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ensure that this doesn&#39;t happen.</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- ** Standard handles</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | Three handles are allocated during program initialisation,</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- and are initially open.</span></span><span class="mpre">

    stdin, stdout, stderr,

    </span><span class="hl_comment"><span class="mpre">-- * Opening and closing files</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- ** Opening files</span></span><span class="mpre">

    withFile,
    openFile,
    IOMode(ReadMode,WriteMode,AppendMode,ReadWriteMode),

    </span><span class="hl_comment"><span class="mpre">-- ** Closing files</span></span><span class="mpre">

    hClose,

    </span><span class="hl_comment"><span class="mpre">-- ** Special cases</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | These functions are also exported by the &quot;Prelude&quot;.</span></span><span class="mpre">

    readFile,
    writeFile,
    appendFile,

    </span><span class="hl_comment"><span class="mpre">-- ** File locking</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- $locking</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- * Operations on handles</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- ** Determining and changing the size of a file</span></span><span class="mpre">

    hFileSize,
    hSetFileSize,

    </span><span class="hl_comment"><span class="mpre">-- ** Detecting the end of input</span></span><span class="mpre">

    hIsEOF,
    isEOF,

    </span><span class="hl_comment"><span class="mpre">-- ** Buffering operations</span></span><span class="mpre">

    BufferMode(NoBuffering,LineBuffering,BlockBuffering),
    hSetBuffering,
    hGetBuffering,
    hFlush,

    </span><span class="hl_comment"><span class="mpre">-- ** Repositioning handles</span></span><span class="mpre">

    hGetPosn,
    hSetPosn,
    HandlePosn,                </span><span class="hl_comment"><span class="mpre">-- abstract, instance of: Eq, Show.</span></span><span class="mpre">

    hSeek,
    SeekMode(AbsoluteSeek,RelativeSeek,SeekFromEnd),
    hTell,

    </span><span class="hl_comment"><span class="mpre">-- ** Handle properties</span></span><span class="mpre">

    hIsOpen, hIsClosed,
    hIsReadable, hIsWritable,
    hIsSeekable,

    </span><span class="hl_comment"><span class="mpre">-- ** Terminal operations (not portable: GHC only)</span></span><span class="mpre">

    hIsTerminalDevice,

    hSetEcho,
    hGetEcho,

    </span><span class="hl_comment"><span class="mpre">-- ** Showing handle state (not portable: GHC only)</span></span><span class="mpre">

    hShow,

    </span><span class="hl_comment"><span class="mpre">-- * Text input and output</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- ** Text input</span></span><span class="mpre">

    hWaitForInput,
    hReady,
    hGetChar,
    hGetLine,
    hLookAhead,
    hGetContents,

    </span><span class="hl_comment"><span class="mpre">-- ** Text output</span></span><span class="mpre">

    hPutChar,
    hPutStr,
    hPutStrLn,
    hPrint,

    </span><span class="hl_comment"><span class="mpre">-- ** Special cases for standard input and output</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | These functions are also exported by the &quot;Prelude&quot;.</span></span><span class="mpre">

    interact,
    putChar,
    putStr,
    putStrLn,
    print,
    getChar,
    getLine,
    getContents,
    readIO,
    readLn,

    </span><span class="hl_comment"><span class="mpre">-- * Binary input and output</span></span><span class="mpre">

    withBinaryFile,
    openBinaryFile,
    hSetBinaryMode,
    hPutBuf,
    hGetBuf,
    hGetBufSome,
    hPutBufNonBlocking,
    hGetBufNonBlocking,

    </span><span class="hl_comment"><span class="mpre">-- * Temporary files</span></span><span class="mpre">

    openTempFile,
    openBinaryTempFile,
    openTempFileWithDefaultPermissions,
    openBinaryTempFileWithDefaultPermissions,

    </span><span class="hl_comment"><span class="mpre">-- * Unicode encoding\/decoding</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | A text-mode &#39;Handle&#39; has an associated &#39;TextEncoding&#39;, which</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- is used to decode bytes into Unicode characters when reading,</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- and encode Unicode characters into bytes when writing.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- The default &#39;TextEncoding&#39; is the same as the default encoding</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- on your system, which is also available as &#39;localeEncoding&#39;.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- (GHC note: on Windows, we currently do not support double-byte</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- encodings; if the console\&#39;s code page is unsupported, then</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- &#39;localeEncoding&#39; will be &#39;latin1&#39;.)</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Encoding and decoding errors are always detected and reported,</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- except during lazy I/O (&#39;hGetContents&#39;, &#39;getContents&#39;, and</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- &#39;readFile&#39;), where a decoding error merely results in</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- termination of the character stream, as with other I/O errors.</span></span><span class="mpre">

    hSetEncoding, 
    hGetEncoding,

    </span><span class="hl_comment"><span class="mpre">-- ** Unicode encodings</span></span><span class="mpre">
    TextEncoding, 
    latin1,
    utf8, utf8_bom,
    utf16, utf16le, utf16be,
    utf32, utf32le, utf32be, 
    localeEncoding,
    char8,
    mkTextEncoding,

    </span><span class="hl_comment"><span class="mpre">-- * Newline conversion</span></span><span class="mpre">
    
    </span><span class="hl_comment"><span class="mpre">-- | In Haskell, a newline is always represented by the character</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- &#39;\n&#39;.  However, in files and external character streams, a</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- newline may be represented by another character sequence, such</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- as &#39;\r\n&#39;.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- A text-mode &#39;Handle&#39; has an associated &#39;NewlineMode&#39; that</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- specifies how to transate newline characters.  The</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- &#39;NewlineMode&#39; specifies the input and output translation</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- separately, so that for instance you can translate &#39;\r\n&#39;</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- to &#39;\n&#39; on input, but leave newlines as &#39;\n&#39; on output.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- The default &#39;NewlineMode&#39; for a &#39;Handle&#39; is</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- &#39;nativeNewlineMode&#39;, which does no translation on Unix systems,</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- but translates &#39;\r\n&#39; to &#39;\n&#39; and back on Windows.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Binary-mode &#39;Handle&#39;s do no newline translation at all.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    hSetNewlineMode, 
    Newline(..), nativeNewline, 
    NewlineMode(..), 
    noNewlineTranslation, universalNewlineMode, nativeNewlineMode,
  ) where

import Control.Exception.Base

import Data.Bits
import Data.List
import Data.Maybe
import Foreign.C.Error
#ifdef mingw32_HOST_OS
import Foreign.C.String
#endif
import Foreign.C.Types
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 232, srcSpanStartColumn = 8, srcSpanEndLine = 232, srcSpanEndColumn = 30}, srcInfoPoints = []}) &quot;System.Posix.Internals&quot;"><span class="mpre">System.Posix.Internals</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 233, srcSpanStartColumn = 8, srcSpanEndLine = 233, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;System.Posix.Types&quot;"><span class="mpre">System.Posix.Types</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 235, srcSpanStartColumn = 8, srcSpanEndLine = 235, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre">
import GHC.IO hiding ( </span><a href="GHC.IO.html#loc_448_1_448_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_448_1_448_8&#39;)"><span class="mpre">bracket</span></a><span class="mpre">, </span><a href="GHC.IO.html#loc_360_1_360_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_360_1_360_12&#39;)"><span class="mpre">onException</span></a><span class="mpre"> )
import GHC.IO.IOMode
import GHC.IO.Handle.FD
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 239, srcSpanStartColumn = 18, srcSpanEndLine = 239, srcSpanEndColumn = 27}, srcInfoPoints = []}) &quot;GHC.IO.FD&quot;"><span class="mpre">GHC.IO.FD</span></span><span class="mpre"> as FD
import GHC.IO.Handle
import GHC.IO.Handle.Text ( </span><a href="GHC.IO.Handle.Text.html#loc_870_1_870_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_870_1_870_12&#39;)"><span class="mpre">hGetBufSome</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.Text.html#loc_533_1_533_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_533_1_533_10&#39;)"><span class="mpre">hPutStrLn</span></a><span class="mpre"> )
import GHC.IO.Exception ( </span><a href="GHC.IO.Exception.html#loc_316_1_316_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_316_1_316_10&#39;)"><span class="mpre">userError</span></a><span class="mpre"> )
import GHC.IO.Encoding
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 244, srcSpanStartColumn = 8, srcSpanEndLine = 244, srcSpanEndColumn = 15}, srcInfoPoints = []}) &quot;GHC.Num&quot;"><span class="mpre">GHC.Num</span></span><span class="mpre">
import Text.Read
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 246, srcSpanStartColumn = 8, srcSpanEndLine = 246, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Show&quot;"><span class="mpre">GHC.Show</span></span><span class="mpre">
import GHC.MVar

</span><span class="hl_comment"><span class="mpre">-- -----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Standard IO</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a character to the standard output device</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (same as &#39;hPutChar&#39; &#39;stdout&#39;).</span></span><span class="mpre">

</span><a href="#loc_256_1_256_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_1_256_8&#39;)"><span class="mpre">putChar</span></a><span class="mpre">         :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_256_1_256_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_1_256_8&#39;)"><span class="hl_fundecl"><span class="mpre">putChar</span></span></a><span class="mpre"> </span><a name="loc_256_9_256_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_9_256_10&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">       =  </span><a href="GHC.IO.Handle.Text.html#loc_468_1_468_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_468_1_468_9&#39;)"><span class="hl_varref"><span class="mpre">hPutChar</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre"> </span><a href="#loc_256_9_256_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_9_256_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Write a string to the standard output device</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (same as &#39;hPutStr&#39; &#39;stdout&#39;).</span></span><span class="mpre">

</span><a href="#loc_262_1_262_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_7&#39;)"><span class="mpre">putStr</span></a><span class="mpre">          :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_262_1_262_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_7&#39;)"><span class="hl_fundecl"><span class="mpre">putStr</span></span></a><span class="mpre"> </span><a name="loc_262_8_262_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_8_262_9&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">        =  </span><a href="GHC.IO.Handle.Text.html#loc_529_1_529_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_529_1_529_8&#39;)"><span class="hl_varref"><span class="mpre">hPutStr</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre"> </span><a href="#loc_262_8_262_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_8_262_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The same as &#39;putStr&#39;, but adds a newline character.</span></span><span class="mpre">

</span><a href="#loc_267_1_267_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_9&#39;)"><span class="mpre">putStrLn</span></a><span class="mpre">        :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_267_1_267_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_9&#39;)"><span class="hl_fundecl"><span class="mpre">putStrLn</span></span></a><span class="mpre"> </span><a name="loc_267_10_267_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_10_267_11&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">      =  </span><a href="GHC.IO.Handle.Text.html#loc_533_1_533_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_533_1_533_10&#39;)"><span class="hl_varref"><span class="mpre">hPutStrLn</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre"> </span><a href="#loc_267_10_267_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_10_267_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The &#39;print&#39; function outputs a value of any printable type to the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- standard output device.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Printable types are those that are instances of class &#39;Show&#39;; &#39;print&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- converts values to strings for output using the &#39;show&#39; operation and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- adds a newline.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For example, a program to print the first 20 integers and their</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- powers of 2 could be written as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; main = print ([(n, 2^n) | n &lt;- [0..19]])</span></span><span class="mpre">

</span><a href="#loc_281_1_281_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_1_281_6&#39;)"><span class="mpre">print</span></a><span class="mpre">           :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 280, srcSpanStartColumn = 20, srcSpanEndLine = 280, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 280, srcSpanStartColumn = 27, srcSpanEndLine = 280, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, sr"><span class="mpre">Show a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_281_1_281_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_1_281_6&#39;)"><span class="hl_fundecl"><span class="mpre">print</span></span></a><span class="mpre"> </span><a name="loc_281_7_281_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_7_281_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">         =  </span><a href="#loc_267_1_267_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_9&#39;)"><span class="hl_varref"><span class="mpre">putStrLn</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_281_7_281_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_7_281_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Read a character from the standard input device</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (same as &#39;hGetChar&#39; &#39;stdin&#39;).</span></span><span class="mpre">

</span><a href="#loc_287_1_287_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_1_287_8&#39;)"><span class="mpre">getChar</span></a><span class="mpre">         :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_287_1_287_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_1_287_8&#39;)"><span class="hl_vardecl"><span class="mpre">getChar</span></span></a><span class="mpre">         =  </span><a href="GHC.IO.Handle.Text.html#loc_133_1_133_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_133_1_133_9&#39;)"><span class="hl_varref"><span class="mpre">hGetChar</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_52_1_52_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_52_1_52_6&#39;)"><span class="hl_varref"><span class="mpre">stdin</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Read a line from the standard input device</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (same as &#39;hGetLine&#39; &#39;stdin&#39;).</span></span><span class="mpre">

</span><a href="#loc_293_1_293_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_1_293_8&#39;)"><span class="mpre">getLine</span></a><span class="mpre">         :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_293_1_293_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_1_293_8&#39;)"><span class="hl_vardecl"><span class="mpre">getLine</span></span></a><span class="mpre">         =  </span><a href="GHC.IO.Handle.Text.html#loc_190_1_190_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_190_1_190_9&#39;)"><span class="hl_varref"><span class="mpre">hGetLine</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_52_1_52_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_52_1_52_6&#39;)"><span class="hl_varref"><span class="mpre">stdin</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The &#39;getContents&#39; operation returns all user input as a single string,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which is read lazily as it is needed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (same as &#39;hGetContents&#39; &#39;stdin&#39;).</span></span><span class="mpre">

</span><a href="#loc_300_1_300_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_1_300_12&#39;)"><span class="mpre">getContents</span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_300_1_300_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_1_300_12&#39;)"><span class="hl_vardecl"><span class="mpre">getContents</span></span></a><span class="mpre">     =  </span><a href="GHC.IO.Handle.Text.html#loc_379_1_379_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_379_1_379_13&#39;)"><span class="hl_varref"><span class="mpre">hGetContents</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_52_1_52_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_52_1_52_6&#39;)"><span class="hl_varref"><span class="mpre">stdin</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The &#39;interact&#39; function takes a function of type @String-&gt;String@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as its argument.  The entire input from the standard input device is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- passed to this function as its argument, and the resulting string is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- output on the standard output device.</span></span><span class="mpre">

</span><a href="#loc_308_1_308_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_1_308_9&#39;)"><span class="mpre">interact</span></a><span class="mpre">        ::  (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_308_1_308_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_1_308_9&#39;)"><span class="hl_fundecl"><span class="mpre">interact</span></span></a><span class="mpre"> </span><a name="loc_308_10_308_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_10_308_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">      =   do </span><a name="loc_308_24_308_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_24_308_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_300_1_300_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_1_300_12&#39;)"><span class="hl_varref"><span class="mpre">getContents</span></span></a><span class="mpre">
                       </span><a href="#loc_262_1_262_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_1_262_7&#39;)"><span class="hl_varref"><span class="mpre">putStr</span></span></a><span class="mpre"> (</span><a href="#loc_308_10_308_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_10_308_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_308_24_308_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_24_308_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The &#39;readFile&#39; function reads a file and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- returns the contents of the file as a string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The file is read lazily, on demand, as with &#39;getContents&#39;.</span></span><span class="mpre">

</span><a href="#loc_316_1_316_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_9&#39;)"><span class="mpre">readFile</span></a><span class="mpre">        :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_316_1_316_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_1_316_9&#39;)"><span class="hl_fundecl"><span class="mpre">readFile</span></span></a><span class="mpre"> </span><a name="loc_316_10_316_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_10_316_14&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">   =  </span><a href="GHC.IO.Handle.FD.html#loc_150_1_150_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_150_1_150_9&#39;)"><span class="hl_varref"><span class="mpre">openFile</span></span></a><span class="mpre"> </span><a href="#loc_316_10_316_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_10_316_14&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="GHC.IO.IOMode.html#loc_28_21_28_29" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_21_28_29&#39;)"><span class="hl_conref"><span class="mpre">ReadMode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Text.html#loc_379_1_379_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_379_1_379_13&#39;)"><span class="hl_varref"><span class="mpre">hGetContents</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The computation &#39;writeFile&#39; @file str@ function writes the string @str@,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to the file @file@.</span></span><span class="mpre">
</span><a href="#loc_321_1_321_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_1_321_10&#39;)"><span class="mpre">writeFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_321_1_321_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_1_321_10&#39;)"><span class="hl_fundecl"><span class="mpre">writeFile</span></span></a><span class="mpre"> </span><a name="loc_321_11_321_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_11_321_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_321_13_321_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_13_321_16&#39;)"><span class="hl_vardecl"><span class="mpre">txt</span></span></a><span class="mpre"> = </span><a href="#loc_390_1_390_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_9&#39;)"><span class="hl_varref"><span class="mpre">withFile</span></span></a><span class="mpre"> </span><a href="#loc_321_11_321_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_11_321_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="GHC.IO.IOMode.html#loc_28_32_28_41" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_32_28_41&#39;)"><span class="hl_conref"><span class="mpre">WriteMode</span></span></a><span class="mpre"> (\ </span><a name="loc_321_43_321_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_43_321_46&#39;)"><span class="hl_vardecl"><span class="mpre">hdl</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Handle.Text.html#loc_529_1_529_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_529_1_529_8&#39;)"><span class="hl_varref"><span class="mpre">hPutStr</span></span></a><span class="mpre"> </span><a href="#loc_321_43_321_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_43_321_46&#39;)"><span class="hl_varref"><span class="mpre">hdl</span></span></a><span class="mpre"> </span><a href="#loc_321_13_321_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_13_321_16&#39;)"><span class="hl_varref"><span class="mpre">txt</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The computation &#39;appendFile&#39; @file str@ function appends the string @str@,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to the file @file@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that &#39;writeFile&#39; and &#39;appendFile&#39; write a literal string</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to a file.  To write a value of any printable type, as with &#39;print&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- use the &#39;show&#39; function to convert the value to a string first.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; main = appendFile &quot;squares&quot; (show [(x,x*x) | x &lt;- [0,0.1..2]])</span></span><span class="mpre">

</span><a href="#loc_333_1_333_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_1_333_11&#39;)"><span class="mpre">appendFile</span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_333_1_333_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_1_333_11&#39;)"><span class="hl_fundecl"><span class="mpre">appendFile</span></span></a><span class="mpre"> </span><a name="loc_333_12_333_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_12_333_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_333_14_333_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_14_333_17&#39;)"><span class="hl_vardecl"><span class="mpre">txt</span></span></a><span class="mpre"> = </span><a href="#loc_390_1_390_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_9&#39;)"><span class="hl_varref"><span class="mpre">withFile</span></span></a><span class="mpre"> </span><a href="#loc_333_12_333_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_12_333_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="GHC.IO.IOMode.html#loc_28_44_28_54" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_44_28_54&#39;)"><span class="hl_conref"><span class="mpre">AppendMode</span></span></a><span class="mpre"> (\ </span><a name="loc_333_45_333_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_45_333_48&#39;)"><span class="hl_vardecl"><span class="mpre">hdl</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Handle.Text.html#loc_529_1_529_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_529_1_529_8&#39;)"><span class="hl_varref"><span class="mpre">hPutStr</span></span></a><span class="mpre"> </span><a href="#loc_333_45_333_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_45_333_48&#39;)"><span class="hl_varref"><span class="mpre">hdl</span></span></a><span class="mpre"> </span><a href="#loc_333_14_333_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_14_333_17&#39;)"><span class="hl_varref"><span class="mpre">txt</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The &#39;readLn&#39; function combines &#39;getLine&#39; and &#39;readIO&#39;.</span></span><span class="mpre">

</span><a href="#loc_338_1_338_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_1_338_7&#39;)"><span class="mpre">readLn</span></a><span class="mpre">          :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 337, srcSpanStartColumn = 20, srcSpanEndLine = 337, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 337, srcSpanStartColumn = 27, srcSpanEndLine = 337, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, sr"><span class="mpre">Read a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_338_1_338_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_1_338_7&#39;)"><span class="hl_vardecl"><span class="mpre">readLn</span></span></a><span class="mpre">          =  do </span><a name="loc_338_23_338_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_23_338_24&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_293_1_293_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_1_293_8&#39;)"><span class="hl_varref"><span class="mpre">getLine</span></span></a><span class="mpre">
                      </span><a name="loc_339_23_339_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_23_339_24&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_346_1_346_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_1_346_7&#39;)"><span class="hl_varref"><span class="mpre">readIO</span></span></a><span class="mpre"> </span><a href="#loc_338_23_338_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_23_338_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
                      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_339_23_339_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_23_339_24&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The &#39;readIO&#39; function is similar to &#39;read&#39; except that it signals</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- parse failure to the &#39;IO&#39; monad instead of terminating the program.</span></span><span class="mpre">

</span><a href="#loc_346_1_346_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_1_346_7&#39;)"><span class="mpre">readIO</span></a><span class="mpre">          :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 345, srcSpanStartColumn = 20, srcSpanEndLine = 345, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 345, srcSpanStartColumn = 27, srcSpanEndLine = 345, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, sr"><span class="mpre">Read a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_346_1_346_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_1_346_7&#39;)"><span class="hl_fundecl"><span class="mpre">readIO</span></span></a><span class="mpre"> </span><a name="loc_346_8_346_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_8_346_9&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">        =  case (do { (</span><a name="loc_346_32_346_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_32_346_33&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_346_34_346_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_34_346_35&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) &lt;- </span><a href="Text.Read.html#loc_60_1_60_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Read.html#loc_60_1_60_6&#39;)"><span class="hl_varref"><span class="mpre">reads</span></span></a><span class="mpre"> </span><a href="#loc_346_8_346_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_8_346_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> ;
                              (</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">lex</span></span><span class="mpre"> </span><a href="#loc_346_34_346_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_34_346_35&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> ;
                              </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_346_32_346_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_32_346_33&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> }) of
                        [</span><a name="loc_349_26_349_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_26_349_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">]    -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_349_26_349_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_26_349_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                        []     -&gt; </span><a href="GHC.IO.Exception.html#loc_221_1_221_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_221_1_221_8&#39;)"><span class="hl_varref"><span class="mpre">ioError</span></span></a><span class="mpre"> (</span><a href="GHC.IO.Exception.html#loc_316_1_316_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_316_1_316_10&#39;)"><span class="hl_varref"><span class="mpre">userError</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Prelude.readIO: no parse&quot;</span></span><span class="mpre">)
                        _      -&gt; </span><a href="GHC.IO.Exception.html#loc_221_1_221_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_221_1_221_8&#39;)"><span class="hl_varref"><span class="mpre">ioError</span></span></a><span class="mpre"> (</span><a href="GHC.IO.Exception.html#loc_316_1_316_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_316_1_316_10&#39;)"><span class="hl_varref"><span class="mpre">userError</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Prelude.readIO: ambiguous parse&quot;</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The Unicode encoding of the current locale</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is the initial locale encoding: if it has been subsequently changed by</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;GHC.IO.Encoding.setLocaleEncoding&#39; this value will not reflect that change.</span></span><span class="mpre">
</span><a href="#loc_358_1_358_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_1_358_15&#39;)"><span class="mpre">localeEncoding</span></a><span class="mpre"> :: </span><a href="GHC.IO.Encoding.Types.html#loc_107_6_107_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_107_6_107_18&#39;)"><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span></a><span class="mpre">
</span><a name="loc_358_1_358_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_1_358_15&#39;)"><span class="hl_vardecl"><span class="mpre">localeEncoding</span></span></a><span class="mpre"> = </span><a href="GHC.IO.Encoding.html#loc_156_1_156_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.html#loc_156_1_156_19&#39;)"><span class="hl_varref"><span class="mpre">initLocaleEncoding</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Computation &#39;hReady&#39; @hdl@ indicates whether at least one item is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- available for input from handle @hdl@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This operation may fail with:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * &#39;System.IO.Error.isEOFError&#39; if the end of file has been reached.</span></span><span class="mpre">

</span><a href="#loc_368_1_368_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_1_368_7&#39;)"><span class="mpre">hReady</span></a><span class="mpre">          :: </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_368_1_368_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_1_368_7&#39;)"><span class="hl_fundecl"><span class="mpre">hReady</span></span></a><span class="mpre"> </span><a name="loc_368_8_368_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_8_368_9&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">        =  </span><a href="GHC.IO.Handle.Text.html#loc_93_1_93_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_93_1_93_14&#39;)"><span class="hl_varref"><span class="mpre">hWaitForInput</span></span></a><span class="mpre"> </span><a href="#loc_368_8_368_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_8_368_9&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Computation &#39;hPrint&#39; @hdl t@ writes the string representation of @t@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- given by the &#39;shows&#39; function to the file or channel managed by @hdl@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and appends a newline.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This operation may fail with:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * &#39;System.IO.Error.isFullError&#39; if the device is full; or</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  * &#39;System.IO.Error.isPermissionError&#39; if another system resource limit would be exceeded.</span></span><span class="mpre">

</span><a href="#loc_381_1_381_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_7&#39;)"><span class="mpre">hPrint</span></a><span class="mpre">          :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 380, srcSpanStartColumn = 20, srcSpanEndLine = 380, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 380, srcSpanStartColumn = 27, srcSpanEndLine = 380, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, sr"><span class="mpre">Show a =&gt;</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_381_1_381_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_7&#39;)"><span class="hl_fundecl"><span class="mpre">hPrint</span></span></a><span class="mpre"> </span><a name="loc_381_8_381_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_8_381_11&#39;)"><span class="hl_vardecl"><span class="mpre">hdl</span></span></a><span class="mpre">      =  </span><a href="GHC.IO.Handle.Text.html#loc_533_1_533_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_533_1_533_10&#39;)"><span class="hl_varref"><span class="mpre">hPutStrLn</span></span></a><span class="mpre"> </span><a href="#loc_381_8_381_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_8_381_11&#39;)"><span class="hl_varref"><span class="mpre">hdl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;withFile&#39; name mode act@ opens a file using &#39;openFile&#39; and passes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the resulting handle to the computation @act@.  The handle will be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- closed on exit from &#39;withFile&#39;, whether by normal termination or by</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- raising an exception.  If closing the handle raises an exception, then</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- this exception will be raised by &#39;withFile&#39; rather than any exception</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- raised by &#39;act&#39;.</span></span><span class="mpre">
</span><a href="#loc_390_1_390_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_9&#39;)"><span class="mpre">withFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="GHC.IO.IOMode.html#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_6_28_12&#39;)"><span class="hl_tyconref"><span class="mpre">IOMode</span></span></a><span class="mpre"> -&gt; (</span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_390_1_390_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_9&#39;)"><span class="hl_fundecl"><span class="mpre">withFile</span></span></a><span class="mpre"> </span><a name="loc_390_10_390_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_10_390_14&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_390_15_390_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_15_390_19&#39;)"><span class="hl_vardecl"><span class="mpre">mode</span></span></a><span class="mpre"> = </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">bracket</span></span></a><span class="mpre"> (</span><a href="GHC.IO.Handle.FD.html#loc_150_1_150_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_150_1_150_9&#39;)"><span class="hl_varref"><span class="mpre">openFile</span></span></a><span class="mpre"> </span><a href="#loc_390_10_390_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_10_390_14&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_390_15_390_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_15_390_19&#39;)"><span class="hl_varref"><span class="mpre">mode</span></span></a><span class="mpre">) </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;withBinaryFile&#39; name mode act@ opens a file using &#39;openBinaryFile&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and passes the resulting handle to the computation @act@.  The handle</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will be closed on exit from &#39;withBinaryFile&#39;, whether by normal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- termination or by raising an exception.</span></span><span class="mpre">
</span><a href="#loc_397_1_397_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_1_397_15&#39;)"><span class="mpre">withBinaryFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="GHC.IO.IOMode.html#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_6_28_12&#39;)"><span class="hl_tyconref"><span class="mpre">IOMode</span></span></a><span class="mpre"> -&gt; (</span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_397_1_397_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_1_397_15&#39;)"><span class="hl_fundecl"><span class="mpre">withBinaryFile</span></span></a><span class="mpre"> </span><a name="loc_397_16_397_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_16_397_20&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_397_21_397_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_21_397_25&#39;)"><span class="hl_vardecl"><span class="mpre">mode</span></span></a><span class="mpre"> = </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">bracket</span></span></a><span class="mpre"> (</span><a href="GHC.IO.Handle.FD.html#loc_177_1_177_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_177_1_177_15&#39;)"><span class="hl_varref"><span class="mpre">openBinaryFile</span></span></a><span class="mpre"> </span><a href="#loc_397_16_397_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_16_397_20&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_397_21_397_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_397_21_397_25&#39;)"><span class="hl_varref"><span class="mpre">mode</span></span></a><span class="mpre">) </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- fixIO</span></span><span class="mpre">

</span><a href="#loc_403_1_403_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_1_403_6&#39;)"><span class="mpre">fixIO</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_403_1_403_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_1_403_6&#39;)"><span class="hl_fundecl"><span class="mpre">fixIO</span></span></a><span class="mpre"> </span><a name="loc_403_7_403_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_7_403_8&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = do
    </span><a name="loc_404_5_404_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_5_404_6&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_64_1_64_13&#39;)"><span class="hl_varref"><span class="mpre">newEmptyMVar</span></span></a><span class="mpre">
    </span><a name="loc_405_5_405_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_5_405_8&#39;)"><span class="hl_vardecl"><span class="mpre">ans</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.html#loc_213_1_213_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_213_1_213_19&#39;)"><span class="hl_varref"><span class="mpre">unsafeInterleaveIO</span></span></a><span class="mpre"> (</span><a href="GHC.MVar.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">takeMVar</span></span></a><span class="mpre"> </span><a href="#loc_404_5_404_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_5_404_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)
    </span><a name="loc_406_5_406_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_5_406_11&#39;)"><span class="hl_vardecl"><span class="mpre">result</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_403_7_403_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_7_403_8&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_405_5_405_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_5_405_8&#39;)"><span class="hl_varref"><span class="mpre">ans</span></span></a><span class="mpre">
    </span><a href="GHC.MVar.html#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_133_1_133_8&#39;)"><span class="hl_varref"><span class="mpre">putMVar</span></span></a><span class="mpre"> </span><a href="#loc_404_5_404_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_5_404_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_406_5_406_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_5_406_11&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_406_5_406_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_5_406_11&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- NOTE: we do our own explicit black holing here, because GHC&#39;s lazy</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- blackholing isn&#39;t enough.  In an infinite loop, GHC may run the IO</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- computation a few times before it notices the loop, which is wrong.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- NOTE2: the explicit black-holing with an IORef ran into trouble</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with multiple threads (see #5421), so now we use an MVar.  I&#39;m</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- actually wondering whether we should use readMVar rather than</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- takeMVar, just in case it ends up being executed multiple times,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- but even then it would have to be masked to protect against async</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- exceptions.  Ugh.  What we really need here is an IVar, or an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- atomic readMVar, or even STM.  All these seem like overkill.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- See also System.IO.Unsafe.unsafeFixIO.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The function creates a temporary file in ReadWrite mode.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The created file isn\&#39;t deleted automatically, so you need to delete it manually.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The file is creates with permissions such that only the current</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- user can read\/write it.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- With some exceptions (see below), the file will be created securely</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in the sense that an attacker should not be able to cause</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- openTempFile to overwrite another file on the filesystem using your</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- credentials, by putting symbolic links (on Unix) in the place where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the temporary file is to be created.  On Unix the @O_CREAT@ and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @O_EXCL@ flags are used to prevent this attack, but note that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @O_EXCL@ is sometimes not supported on NFS filesystems, so if you</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- rely on this behaviour it is best to use local filesystems only.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_445_1_445_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_1_445_13&#39;)"><span class="mpre">openTempFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ Directory in which to create the file</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ File name template. If the template is \&quot;foo.ext\&quot; then</span></span><span class="mpre">
                           </span><span class="hl_comment"><span class="mpre">-- the created file will be \&quot;fooXXX.ext\&quot; where XXX is some</span></span><span class="mpre">
                           </span><span class="hl_comment"><span class="mpre">-- random number.</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">)
</span><a name="loc_445_1_445_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_1_445_13&#39;)"><span class="hl_fundecl"><span class="mpre">openTempFile</span></span></a><span class="mpre"> </span><a name="loc_445_14_445_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_14_445_21&#39;)"><span class="hl_vardecl"><span class="mpre">tmp_dir</span></span></a><span class="mpre"> </span><a name="loc_445_22_445_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_22_445_30&#39;)"><span class="hl_vardecl"><span class="mpre">template</span></span></a><span class="mpre">
    = </span><a href="#loc_467_1_467_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_1_467_14&#39;)"><span class="hl_varref"><span class="mpre">openTempFile&#39;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;openTempFile&quot;</span></span><span class="mpre"> </span><a href="#loc_445_14_445_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_14_445_21&#39;)"><span class="hl_varref"><span class="mpre">tmp_dir</span></span></a><span class="mpre"> </span><a href="#loc_445_22_445_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_22_445_30&#39;)"><span class="hl_varref"><span class="mpre">template</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0o600</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like &#39;openTempFile&#39;, but opens the file in binary mode. See &#39;openBinaryFile&#39; for more comments.</span></span><span class="mpre">
</span><a href="#loc_450_1_450_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_1_450_19&#39;)"><span class="mpre">openBinaryTempFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">)
</span><a name="loc_450_1_450_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_1_450_19&#39;)"><span class="hl_fundecl"><span class="mpre">openBinaryTempFile</span></span></a><span class="mpre"> </span><a name="loc_450_20_450_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_20_450_27&#39;)"><span class="hl_vardecl"><span class="mpre">tmp_dir</span></span></a><span class="mpre"> </span><a name="loc_450_28_450_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_28_450_36&#39;)"><span class="hl_vardecl"><span class="mpre">template</span></span></a><span class="mpre">
    = </span><a href="#loc_467_1_467_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_1_467_14&#39;)"><span class="hl_varref"><span class="mpre">openTempFile&#39;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;openBinaryTempFile&quot;</span></span><span class="mpre"> </span><a href="#loc_450_20_450_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_20_450_27&#39;)"><span class="hl_varref"><span class="mpre">tmp_dir</span></span></a><span class="mpre"> </span><a href="#loc_450_28_450_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_28_450_36&#39;)"><span class="hl_varref"><span class="mpre">template</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0o600</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like &#39;openTempFile&#39;, but uses the default file permissions</span></span><span class="mpre">
</span><a href="#loc_456_1_456_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_1_456_35&#39;)"><span class="mpre">openTempFileWithDefaultPermissions</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                                   -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">)
</span><a name="loc_456_1_456_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_1_456_35&#39;)"><span class="hl_fundecl"><span class="mpre">openTempFileWithDefaultPermissions</span></span></a><span class="mpre"> </span><a name="loc_456_36_456_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_36_456_43&#39;)"><span class="hl_vardecl"><span class="mpre">tmp_dir</span></span></a><span class="mpre"> </span><a name="loc_456_44_456_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_44_456_52&#39;)"><span class="hl_vardecl"><span class="mpre">template</span></span></a><span class="mpre">
    = </span><a href="#loc_467_1_467_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_1_467_14&#39;)"><span class="hl_varref"><span class="mpre">openTempFile&#39;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;openBinaryTempFile&quot;</span></span><span class="mpre"> </span><a href="#loc_456_36_456_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_36_456_43&#39;)"><span class="hl_varref"><span class="mpre">tmp_dir</span></span></a><span class="mpre"> </span><a href="#loc_456_44_456_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_44_456_52&#39;)"><span class="hl_varref"><span class="mpre">template</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0o666</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Like &#39;openBinaryTempFile&#39;, but uses the default file permissions</span></span><span class="mpre">
</span><a href="#loc_462_1_462_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_1_462_41&#39;)"><span class="mpre">openBinaryTempFileWithDefaultPermissions</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                                         -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">)
</span><a name="loc_462_1_462_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_1_462_41&#39;)"><span class="hl_fundecl"><span class="mpre">openBinaryTempFileWithDefaultPermissions</span></span></a><span class="mpre"> </span><a name="loc_462_42_462_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_42_462_49&#39;)"><span class="hl_vardecl"><span class="mpre">tmp_dir</span></span></a><span class="mpre"> </span><a name="loc_462_50_462_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_50_462_58&#39;)"><span class="hl_vardecl"><span class="mpre">template</span></span></a><span class="mpre">
    = </span><a href="#loc_467_1_467_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_1_467_14&#39;)"><span class="hl_varref"><span class="mpre">openTempFile&#39;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;openBinaryTempFile&quot;</span></span><span class="mpre"> </span><a href="#loc_462_42_462_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_42_462_49&#39;)"><span class="hl_varref"><span class="mpre">tmp_dir</span></span></a><span class="mpre"> </span><a href="#loc_462_50_462_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_50_462_58&#39;)"><span class="hl_varref"><span class="mpre">template</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0o666</span></span><span class="mpre">

</span><a href="#loc_467_1_467_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_1_467_14&#39;)"><span class="mpre">openTempFile&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CMode</span></span><span class="mpre">
              -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">)
</span><a name="loc_467_1_467_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_1_467_14&#39;)"><span class="hl_fundecl"><span class="mpre">openTempFile&#39;</span></span></a><span class="mpre"> </span><a name="loc_467_15_467_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_15_467_18&#39;)"><span class="hl_vardecl"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a name="loc_467_19_467_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_19_467_26&#39;)"><span class="hl_vardecl"><span class="mpre">tmp_dir</span></span></a><span class="mpre"> </span><a name="loc_467_27_467_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_27_467_35&#39;)"><span class="hl_vardecl"><span class="mpre">template</span></span></a><span class="mpre"> </span><a name="loc_467_36_467_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_36_467_42&#39;)"><span class="hl_vardecl"><span class="mpre">binary</span></span></a><span class="mpre"> </span><a name="loc_467_43_467_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_43_467_47&#39;)"><span class="hl_vardecl"><span class="mpre">mode</span></span></a><span class="mpre"> = do
  </span><a name="loc_468_3_468_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_3_468_6&#39;)"><span class="hl_vardecl"><span class="mpre">pid</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">c_getpid</span></span><span class="mpre">
  </span><a href="#loc_488_5_488_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_5_488_17&#39;)"><span class="hl_varref"><span class="mpre">findTempName</span></span></a><span class="mpre"> </span><a href="#loc_468_3_468_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_468_3_468_6&#39;)"><span class="hl_varref"><span class="mpre">pid</span></span></a><span class="mpre">
  where
    </span><span class="hl_comment"><span class="mpre">-- We split off the last extension, so we can use .foo.ext files</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- for temporary files (hidden on Unix OSes). Unfortunately we&#39;re</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- below filepath in the hierarchy here.</span></span><span class="mpre">
    (</span><a name="loc_474_6_474_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_6_474_12&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre">,</span><a name="loc_474_13_474_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_13_474_19&#39;)"><span class="hl_vardecl"><span class="mpre">suffix</span></span></a><span class="mpre">) =
       case </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_467_27_467_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_27_467_35&#39;)"><span class="hl_varref"><span class="mpre">template</span></span></a><span class="mpre"> of
         </span><span class="hl_comment"><span class="mpre">-- First case: template contains no &#39;.&#39;s. Just re-reverse it.</span></span><span class="mpre">
         (</span><a name="loc_477_11_477_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_11_477_21&#39;)"><span class="hl_vardecl"><span class="mpre">rev_suffix</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)       -&gt; (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_477_11_477_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_11_477_21&#39;)"><span class="hl_varref"><span class="mpre">rev_suffix</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)
         </span><span class="hl_comment"><span class="mpre">-- Second case: template contains at least one &#39;.&#39;. Strip the</span></span><span class="mpre">
         </span><span class="hl_comment"><span class="mpre">-- dot from the prefix and prepend it to the suffix (if we don&#39;t</span></span><span class="mpre">
         </span><span class="hl_comment"><span class="mpre">-- do this, the unique number will get added after the &#39;.&#39; and</span></span><span class="mpre">
         </span><span class="hl_comment"><span class="mpre">-- thus be part of the extension, which is wrong.)</span></span><span class="mpre">
         (</span><a name="loc_482_11_482_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_11_482_21&#39;)"><span class="hl_vardecl"><span class="mpre">rev_suffix</span></span></a><span class="mpre">, </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_482_27_482_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_27_482_31&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_482_27_482_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_27_482_31&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">, </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_482_11_482_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_482_11_482_21&#39;)"><span class="hl_varref"><span class="mpre">rev_suffix</span></span></a><span class="mpre">)
         </span><span class="hl_comment"><span class="mpre">-- Otherwise, something is wrong, because (break (== &#39;.&#39;)) should</span></span><span class="mpre">
         </span><span class="hl_comment"><span class="mpre">-- always return a pair with either the empty string or a string</span></span><span class="mpre">
         </span><span class="hl_comment"><span class="mpre">-- beginning with &#39;.&#39; as the second component.</span></span><span class="mpre">
         _                      -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bug in System.IO.openTempFile&quot;</span></span><span class="mpre">

    </span><a name="loc_488_5_488_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_5_488_17&#39;)"><span class="hl_fundecl"><span class="mpre">findTempName</span></span></a><span class="mpre"> </span><a name="loc_488_18_488_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_18_488_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do
      </span><a name="loc_489_7_489_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_7_489_8&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_520_1_520_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_1_520_12&#39;)"><span class="hl_varref"><span class="mpre">openNewFile</span></span></a><span class="mpre"> </span><a href="#loc_505_9_505_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_9_505_17&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><a href="#loc_467_36_467_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_36_467_42&#39;)"><span class="hl_varref"><span class="mpre">binary</span></span></a><span class="mpre"> </span><a href="#loc_467_43_467_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_43_467_47&#39;)"><span class="hl_varref"><span class="mpre">mode</span></span></a><span class="mpre">
      case </span><a href="#loc_489_7_489_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_7_489_8&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> of
        </span><a href="#loc_516_5_516_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_5_516_15&#39;)"><span class="hl_conref"><span class="mpre">FileExists</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_488_5_488_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_5_488_17&#39;)"><span class="hl_varref"><span class="mpre">findTempName</span></span></a><span class="mpre"> (</span><a href="#loc_488_18_488_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_18_488_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><a href="#loc_517_5_517_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_5_517_17&#39;)"><span class="hl_conref"><span class="mpre">OpenNewError</span></span></a><span class="mpre"> </span><a name="loc_492_22_492_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_492_22_492_27&#39;)"><span class="hl_vardecl"><span class="mpre">errno</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Exception.html#loc_221_1_221_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_221_1_221_8&#39;)"><span class="hl_varref"><span class="mpre">ioError</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">errnoToIOError</span></span><span class="mpre"> </span><a href="#loc_467_15_467_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_15_467_18&#39;)"><span class="hl_varref"><span class="mpre">loc</span></span></a><span class="mpre"> </span><a href="#loc_492_22_492_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_492_22_492_27&#39;)"><span class="hl_varref"><span class="mpre">errno</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_467_19_467_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_19_467_26&#39;)"><span class="hl_varref"><span class="mpre">tmp_dir</span></span></a><span class="mpre">))
        </span><a href="#loc_515_5_515_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_5_515_19&#39;)"><span class="hl_conref"><span class="mpre">NewFileCreated</span></span></a><span class="mpre"> </span><a name="loc_493_24_493_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_24_493_26&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre"> -&gt; do
          (</span><a name="loc_494_12_494_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_12_494_14&#39;)"><span class="hl_vardecl"><span class="mpre">fD</span></span></a><span class="mpre">,</span><a name="loc_494_15_494_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_15_494_22&#39;)"><span class="hl_vardecl"><span class="mpre">fd_type</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">FD.mkFD</span></span><span class="mpre"> </span><a href="#loc_493_24_493_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_24_493_26&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre"> </span><a href="GHC.IO.IOMode.html#loc_28_57_28_70" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_57_28_70&#39;)"><span class="hl_conref"><span class="mpre">ReadWriteMode</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="hl_comment"><span class="mpre">{-no stat-}</span></span><span class="mpre">
                               </span><span class="hl_conref"><span class="mpre">False</span></span><span class="hl_comment"><span class="mpre">{-is_socket-}</span></span><span class="mpre">
                               </span><span class="hl_conref"><span class="mpre">True</span></span><span class="hl_comment"><span class="mpre">{-is_nonblock-}</span></span><span class="mpre">

          </span><a name="loc_498_11_498_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_11_498_14&#39;)"><span class="hl_vardecl"><span class="mpre">enc</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Encoding.html#loc_133_2_133_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.html#loc_133_2_133_19&#39;)"><span class="hl_varref"><span class="mpre">getLocaleEncoding</span></span></a><span class="mpre">
          </span><a name="loc_499_11_499_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_11_499_12&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Handle.FD.html#loc_213_1_213_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_213_1_213_15&#39;)"><span class="hl_varref"><span class="mpre">mkHandleFromFD</span></span></a><span class="mpre"> </span><a href="#loc_494_12_494_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_12_494_14&#39;)"><span class="hl_varref"><span class="mpre">fD</span></span></a><span class="mpre"> </span><a href="#loc_494_15_494_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_15_494_22&#39;)"><span class="hl_varref"><span class="mpre">fd_type</span></span></a><span class="mpre"> </span><a href="#loc_505_9_505_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_9_505_17&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><a href="GHC.IO.IOMode.html#loc_28_57_28_70" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_57_28_70&#39;)"><span class="hl_conref"><span class="mpre">ReadWriteMode</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="hl_comment"><span class="mpre">{-set non-block-}</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_498_11_498_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_11_498_14&#39;)"><span class="hl_varref"><span class="mpre">enc</span></span></a><span class="mpre">)

          </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_505_9_505_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_9_505_17&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre">, </span><a href="#loc_499_11_499_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_11_499_12&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">)

      where
        </span><a name="loc_504_9_504_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_504_9_504_17&#39;)"><span class="hl_vardecl"><span class="mpre">filename</span></span></a><span class="mpre">        = </span><a href="#loc_474_6_474_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_6_474_12&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_488_18_488_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_18_488_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_474_13_474_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_13_474_19&#39;)"><span class="hl_varref"><span class="mpre">suffix</span></span></a><span class="mpre">
        </span><a name="loc_505_9_505_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_9_505_17&#39;)"><span class="hl_vardecl"><span class="mpre">filepath</span></span></a><span class="mpre">        = </span><a href="#loc_467_19_467_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_19_467_26&#39;)"><span class="hl_varref"><span class="mpre">tmp_dir</span></span></a><span class="mpre"> </span><a href="#loc_508_9_508_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_9_508_16&#39;)"><span class="hl_infix"><span class="mpre">`combine`</span></span></a><span class="mpre"> </span><a href="#loc_504_9_504_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_504_9_504_17&#39;)"><span class="hl_varref"><span class="mpre">filename</span></span></a><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- XXX bits copied from System.FilePath, since that&#39;s not available here</span></span><span class="mpre">
        </span><a name="loc_508_9_508_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_9_508_16&#39;)"><span class="hl_fundecl"><span class="mpre">combine</span></span></a><span class="mpre"> </span><a name="loc_508_17_508_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_17_508_18&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_508_19_508_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_19_508_20&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_508_19_508_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_19_508_20&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_508_17_508_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_17_508_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_508_17_508_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_17_508_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_508_19_508_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_19_508_20&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">last</span></span><span class="mpre"> </span><a href="#loc_508_17_508_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_17_508_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_561_1_561_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_1_561_14&#39;)"><span class="hl_varref"><span class="mpre">pathSeparator</span></span></a><span class="mpre"> = </span><a href="#loc_508_17_508_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_17_508_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_508_19_508_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_19_508_20&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_508_17_508_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_17_508_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_561_1_561_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_1_561_14&#39;)"><span class="hl_varref"><span class="mpre">pathSeparator</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_508_19_508_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_508_19_508_20&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

data </span><a name="loc_514_6_514_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_6_514_23&#39;)"><span class="hl_tycondecl"><span class="mpre">OpenNewFileResult</span></span></a><span class="mpre">
  = </span><a name="loc_515_5_515_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_5_515_19&#39;)"><span class="hl_condecl"><span class="mpre">NewFileCreated</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CInt</span></span><span class="mpre">
  | </span><a name="loc_516_5_516_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_5_516_15&#39;)"><span class="hl_condecl"><span class="mpre">FileExists</span></span></a><span class="mpre">
  | </span><a name="loc_517_5_517_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_5_517_17&#39;)"><span class="hl_condecl"><span class="mpre">OpenNewError</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Errno</span></span><span class="mpre">

</span><a href="#loc_520_1_520_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_1_520_12&#39;)"><span class="mpre">openNewFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CMode</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_514_6_514_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_6_514_23&#39;)"><span class="hl_tyconref"><span class="mpre">OpenNewFileResult</span></span></a><span class="mpre">
</span><a name="loc_520_1_520_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_1_520_12&#39;)"><span class="hl_fundecl"><span class="mpre">openNewFile</span></span></a><span class="mpre"> </span><a name="loc_520_13_520_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_13_520_21&#39;)"><span class="hl_vardecl"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><a name="loc_520_22_520_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_22_520_28&#39;)"><span class="hl_vardecl"><span class="mpre">binary</span></span></a><span class="mpre"> </span><a name="loc_520_29_520_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_29_520_33&#39;)"><span class="hl_vardecl"><span class="mpre">mode</span></span></a><span class="mpre"> = do
  let </span><a name="loc_521_7_521_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_7_521_14&#39;)"><span class="hl_vardecl"><span class="mpre">oflags1</span></span></a><span class="mpre"> = </span><a href="#loc_570_1_570_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_1_570_9&#39;)"><span class="hl_varref"><span class="mpre">rw_flags</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">o_EXCL</span></span><span class="mpre">

      </span><a name="loc_523_7_523_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_7_523_19&#39;)"><span class="hl_vardecl"><span class="mpre">binary_flags</span></span></a><span class="mpre">
        | </span><a href="#loc_520_22_520_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_22_520_28&#39;)"><span class="hl_varref"><span class="mpre">binary</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">o_BINARY</span></span><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

      </span><a name="loc_527_7_527_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_527_7_527_13&#39;)"><span class="hl_vardecl"><span class="mpre">oflags</span></span></a><span class="mpre"> = </span><a href="#loc_521_7_521_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_7_521_14&#39;)"><span class="hl_varref"><span class="mpre">oflags1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><a href="#loc_523_7_523_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_7_523_19&#39;)"><span class="hl_varref"><span class="mpre">binary_flags</span></span></a><span class="mpre">
  </span><a name="loc_528_3_528_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_3_528_5&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">withFilePath</span></span><span class="mpre"> </span><a href="#loc_520_13_520_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_13_520_21&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_528_35_528_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_35_528_36&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt;
          </span><span class="hl_varref"><span class="mpre">c_open</span></span><span class="mpre"> </span><a href="#loc_528_35_528_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_35_528_36&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_527_7_527_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_527_7_527_13&#39;)"><span class="hl_varref"><span class="mpre">oflags</span></span></a><span class="mpre"> </span><a href="#loc_520_29_520_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_29_520_33&#39;)"><span class="hl_varref"><span class="mpre">mode</span></span></a><span class="mpre">
  if </span><a href="#loc_528_3_528_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_3_528_5&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    then do
      </span><a name="loc_532_7_532_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_7_532_12&#39;)"><span class="hl_vardecl"><span class="mpre">errno</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">getErrno</span></span><span class="mpre">
      case </span><a href="#loc_532_7_532_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_7_532_12&#39;)"><span class="hl_varref"><span class="mpre">errno</span></span></a><span class="mpre"> of
        _ | </span><a href="#loc_532_7_532_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_7_532_12&#39;)"><span class="hl_varref"><span class="mpre">errno</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">eEXIST</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_516_5_516_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_5_516_15&#39;)"><span class="hl_conref"><span class="mpre">FileExists</span></span></a><span class="mpre">
#ifdef mingw32_HOST_OS
        </span><span class="hl_comment"><span class="mpre">-- If c_open throws EACCES on windows, it could mean that filepath is a</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- directory. In this case, we want to return FileExists so that the</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- enclosing openTempFile can try again instead of failing outright.</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- See bug #4968.</span></span><span class="mpre">
        _ | </span><a href="#loc_532_7_532_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_7_532_12&#39;)"><span class="hl_varref"><span class="mpre">errno</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">eACCES</span></span><span class="mpre"> -&gt; do
          </span><span class="hl_varref"><span class="mpre">withCString</span></span><span class="mpre"> </span><a href="#loc_520_13_520_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_13_520_21&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_541_35_541_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_35_541_39&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> -&gt; do
            </span><span class="hl_comment"><span class="mpre">-- There is a race here: the directory might have been moved or</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- deleted between the c_open call and the next line, but there</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- doesn&#39;t seem to be any direct way to detect that the c_open call</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- failed because of an existing directory.</span></span><span class="mpre">
            </span><a name="loc_546_13_546_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_13_546_19&#39;)"><span class="hl_vardecl"><span class="mpre">exists</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">c_fileExists</span></span><span class="mpre"> </span><a href="#loc_541_35_541_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_35_541_39&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> if </span><a href="#loc_546_13_546_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_13_546_19&#39;)"><span class="hl_varref"><span class="mpre">exists</span></span></a><span class="mpre">
              then </span><a href="#loc_516_5_516_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_5_516_15&#39;)"><span class="hl_conref"><span class="mpre">FileExists</span></span></a><span class="mpre">
              else </span><a href="#loc_517_5_517_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_5_517_17&#39;)"><span class="hl_conref"><span class="mpre">OpenNewError</span></span></a><span class="mpre"> </span><a href="#loc_532_7_532_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_7_532_12&#39;)"><span class="hl_varref"><span class="mpre">errno</span></span></a><span class="mpre">
#endif
        _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_517_5_517_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_5_517_17&#39;)"><span class="hl_conref"><span class="mpre">OpenNewError</span></span></a><span class="mpre"> </span><a href="#loc_532_7_532_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_7_532_12&#39;)"><span class="hl_varref"><span class="mpre">errno</span></span></a><span class="mpre">)
    else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_515_5_515_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_5_515_19&#39;)"><span class="hl_conref"><span class="mpre">NewFileCreated</span></span></a><span class="mpre"> </span><a href="#loc_528_3_528_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_3_528_5&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre">)

#ifdef mingw32_HOST_OS
</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 555, srcSpanStartColumn = 1, srcSpanEndLine = 555, srcSpanEndColumn = 70}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 555, srcSpanStartColumn = 1, srcSpanEndLine = 555, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/System/IO.hs&quot;, srcSpanStartLine = 555, srcSpanStartColumn = 9"><span class="mpre">foreign import ccall &quot;file_exists&quot; c_fileExists :: CString -&gt; IO Bool</span></span><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- XXX Should use filepath library</span></span><span class="mpre">
</span><a href="#loc_561_1_561_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_1_561_14&#39;)"><span class="mpre">pathSeparator</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
#ifdef mingw32_HOST_OS
</span><a name="loc_561_1_561_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_1_561_14&#39;)"><span class="hl_vardecl"><span class="mpre">pathSeparator</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;\\&#39;</span></span><span class="mpre">
#else
</span><span class="hl_vardecl"><span class="mpre">pathSeparator</span></span><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- XXX Copied from GHC.Handle</span></span><span class="mpre">
</span><a href="#loc_568_1_568_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_568_1_568_10&#39;)"><span class="mpre">std_flags</span></a><span class="mpre">, </span><a href="#loc_569_1_569_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_1_569_13&#39;)"><span class="mpre">output_flags</span></a><span class="mpre">, </span><a href="#loc_570_1_570_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_1_570_9&#39;)"><span class="mpre">rw_flags</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CInt</span></span><span class="mpre">
</span><a name="loc_568_1_568_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_568_1_568_10&#39;)"><span class="hl_vardecl"><span class="mpre">std_flags</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">o_NONBLOCK</span></span><span class="mpre">   </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">o_NOCTTY</span></span><span class="mpre">
</span><a name="loc_569_1_569_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_1_569_13&#39;)"><span class="hl_vardecl"><span class="mpre">output_flags</span></span></a><span class="mpre"> = </span><a href="#loc_568_1_568_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_568_1_568_10&#39;)"><span class="hl_varref"><span class="mpre">std_flags</span></span></a><span class="mpre">    </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">o_CREAT</span></span><span class="mpre">
</span><a name="loc_570_1_570_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_1_570_9&#39;)"><span class="hl_vardecl"><span class="mpre">rw_flags</span></span></a><span class="mpre">     = </span><a href="#loc_569_1_569_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_1_569_13&#39;)"><span class="hl_varref"><span class="mpre">output_flags</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">o_RDWR</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- $locking</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Implementations should enforce as far as possible, at least locally to the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Haskell process, multiple-reader single-writer locking on files.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- That is, /there may either be many handles on the same file which manage input, or just one handle on the file which manages output/.  If any</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- open or semi-closed handle is managing a file for output, no new</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- handle can be allocated for that file.  If any open or semi-closed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- handle is managing a file for input, new handles can only be allocated</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- if they do not manage output.  Whether two files are the same is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- implementation-dependent, but they should normally be the same if they</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- have the same absolute path name and neither has been renamed, for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- example.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Warning/: the &#39;readFile&#39; operation holds a semi-closed handle on</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the file until the entire contents of the file have been consumed.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It follows that an attempt to write to a file (using &#39;writeFile&#39;, for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- example) that was earlier opened by &#39;readFile&#39; will usually result in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- failure with &#39;System.IO.Error.isAlreadyInUseError&#39;.</span></span><span class="mpre">

</span></div></body></html>