<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE FlexibleContexts #-}
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE CPP #-}
{-# LANGUAGE BangPatterns #-}
{-# LANGUAGE RankNTypes #-}
module Network.HTTP.Client.Manager
    ( ManagerSettings (..)
    , newManager
    , closeManager
    , withManager
    , getConn
    , failedConnectionException
    , defaultManagerSettings
    ) where

#if !MIN_VERSION_base(4,6,0)
import Prelude hiding (catch)
#endif
import Data.Monoid (</span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="mpre">mappend</span></a><span class="mpre">)
import System.IO (</span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="mpre">hClose</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="mpre">hFlush</span></a><span class="mpre">, </span><a href="GHC.IO.IOMode.html#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_6_28_12&#39;)"><span class="mpre">IOMode</span></a><span class="mpre">(..))
import qualified Data.IORef as I
import qualified Data.Map as Map

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Manager.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 18, srcSpanEndLine = 25, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as S8
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Manager.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 18, srcSpanEndLine = 26, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L

import qualified Blaze.ByteString.Builder as Blaze

import Data.Text (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="mpre">Text</span></a><span class="mpre">)
import qualified Data.Text as T

import Control.Monad.IO.Class (</span><a href="Control.Monad.IO.Class.html#loc_30_20_30_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_30_20_30_27&#39;)"><span class="mpre">MonadIO</span></a><span class="mpre">, </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="mpre">liftIO</span></a><span class="mpre">)
import Control.Monad (</span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="mpre">unless</span></a><span class="mpre">)
import Control.Exception (</span><a href="GHC.IO.html#loc_426_1_426_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_426_1_426_6&#39;)"><span class="mpre">mask_</span></a><span class="mpre">, SomeException, </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="mpre">bracket</span></a><span class="mpre">, </span><a href="Control.Exception.Base.html#loc_150_1_150_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_150_1_150_6&#39;)"><span class="mpre">catch</span></a><span class="mpre">, </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="mpre">throwIO</span></a><span class="mpre">, fromException, </span><a href="GHC.IO.html#loc_428_1_428_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_428_1_428_5&#39;)"><span class="mpre">mask</span></a><span class="mpre">, </span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="mpre">IOException</span></a><span class="mpre">, Exception (..), </span><a href="Control.Exception.Base.html#loc_181_1_181_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_181_1_181_7&#39;)"><span class="mpre">handle</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Manager.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 8, srcSpanEndLine = 36, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;Control.Concurrent&quot;"><span class="mpre">Control.Concurrent</span></span><span class="mpre"> (forkIO, threadDelay)
import Data.Time (</span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="mpre">UTCTime</span></a><span class="mpre"> (..), </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="mpre">Day</span></a><span class="mpre"> (..), </span><a href="Data.Time.Clock.Scale.html#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_41_9_41_17&#39;)"><span class="mpre">DiffTime</span></a><span class="mpre">, getCurrentTime, </span><a href="Data.Time.Clock.UTCDiff.html#loc_9_1_9_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTCDiff.html#loc_9_1_9_11&#39;)"><span class="mpre">addUTCTime</span></a><span class="mpre">)
import Control.DeepSeq (</span><a href="Control.DeepSeq.html#loc_85_1_85_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_85_1_85_8&#39;)"><span class="mpre">deepseq</span></a><span class="mpre">)

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Manager.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 18, srcSpanEndLine = 40, srcSpanEndColumn = 32}, srcInfoPoints = []}) &quot;Network.Socket&quot;"><span class="mpre">Network.Socket</span></span><span class="mpre"> as NS

import Data.Maybe (</span><a href="Data.Maybe.html#loc_123_1_123_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_123_1_123_9&#39;)"><span class="mpre">mapMaybe</span></a><span class="mpre">)
import System.IO (</span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="mpre">Handle</span></a><span class="mpre">)
import System.Mem.Weak (Weak, deRefWeak)
import Network.HTTP.Types (</span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="mpre">status200</span></a><span class="mpre">)
import Network.HTTP.Client.Types
import Network.HTTP.Client.Connection
import Network.HTTP.Client.Headers (</span><a href="Network.HTTP.Client.Headers.html#loc_28_1_28_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Headers.html#loc_28_1_28_19&#39;)"><span class="mpre">parseStatusHeaders</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Default value for @ManagerSettings@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 0.1.0</span></span><span class="mpre">
</span><a href="#loc_54_1_54_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_23&#39;)"><span class="mpre">defaultManagerSettings</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_447_6_447_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_447_6_447_21&#39;)"><span class="hl_tyconref"><span class="mpre">ManagerSettings</span></span></a><span class="mpre">
</span><a name="loc_54_1_54_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_23&#39;)"><span class="hl_vardecl"><span class="mpre">defaultManagerSettings</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Manager.hs&quot;, srcSpanStartLine = 54, srcSpanStartColumn = 26, srcSpanEndLine = 79, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Manager.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 5, srcSpanEndLine = 55, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTT"><span class="mpre">ManagerSettings
    { managerConnCount = 10
    , managerRawConnection = return openSocketConnection
    , managerTlsConnection = return $ \_ _ _ -&gt; throwIO TlsNotSupported
    , managerTlsProxyConnection = return $ \_ _ _ _ _ _ -&gt; throwIO TlsNotSupported
    , managerResponseTimeout = Just 30000000
    , managerRetryableException = \e -&gt;
        case fromException e of
            Just (_ :: IOException) -&gt; True
            _ -&gt;
                case fromException e of
                    </span><span class="hl_comment"><span class="mpre">-- Note: Some servers will timeout connections by accepting</span></span><span class="mpre">
                    </span><span class="hl_comment"><span class="mpre">-- the incoming packets for the new request, but closing</span></span><span class="mpre">
                    </span><span class="hl_comment"><span class="mpre">-- the connection as soon as we try to read. To make sure</span></span><span class="mpre">
                    </span><span class="hl_comment"><span class="mpre">-- we open a new connection under these circumstances, we</span></span><span class="mpre">
                    </span><span class="hl_comment"><span class="mpre">-- check for the NoResponseDataReceived exception.</span></span><span class="mpre">
                    Just NoResponseDataReceived -&gt; True
                    Just IncompleteHeaders -&gt; True
                    _ -&gt; False
    , managerWrapIOException =
        let wrapper se =
                case fromException se of
                    Just e -&gt; toException $ InternalIOException e
                    Nothing -&gt; se
         in handle $ throwIO . wrapper
    }</span></span><span class="mpre">

</span><a href="#loc_82_1_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_11&#39;)"><span class="mpre">takeSocket</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_494_6_494_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_494_6_494_13&#39;)"><span class="hl_tyconref"><span class="mpre">Manager</span></span></a><span class="mpre"> -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_522_6_522_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_522_6_522_13&#39;)"><span class="hl_tyconref"><span class="mpre">ConnKey</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre">)
</span><a name="loc_82_1_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_11&#39;)"><span class="hl_fundecl"><span class="mpre">takeSocket</span></span></a><span class="mpre"> </span><a name="loc_82_12_82_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_15&#39;)"><span class="hl_vardecl"><span class="mpre">man</span></span></a><span class="mpre"> </span><a name="loc_82_16_82_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_16_82_19&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre"> =
    </span><a href="Data.IORef.html#loc_101_1_101_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_101_1_101_18&#39;)"><span class="hl_varref"><span class="mpre">I.atomicModifyIORef</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_495_7_495_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_495_7_495_13&#39;)"><span class="hl_varref"><span class="mpre">mConns</span></span></a><span class="mpre"> </span><a href="#loc_82_12_82_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_15&#39;)"><span class="hl_varref"><span class="mpre">man</span></span></a><span class="mpre">) </span><a href="#loc_85_5_85_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
    </span><a name="loc_85_5_85_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> = (</span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">)
    </span><a href="#loc_85_5_85_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) =
        case </span><span class="hl_varref"><span class="mpre">Map.lookup</span></span><span class="mpre"> </span><a href="#loc_82_16_82_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_16_82_19&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre"> </span><a href="#loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">)
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_510_5_510_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_510_5_510_8&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a name="loc_89_23_89_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_23_89_24&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> _) -&gt; (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Map.delete</span></span><span class="mpre"> </span><a href="#loc_82_16_82_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_16_82_19&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre"> </span><a href="#loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_89_23_89_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_23_89_24&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_511_5_511_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_511_5_511_9&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a name="loc_90_24_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_24_90_25&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> _ _ </span><a name="loc_90_30_90_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_30_90_34&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) -&gt; (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Map.insert</span></span><span class="mpre"> </span><a href="#loc_82_16_82_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_16_82_19&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre"> </span><a href="#loc_90_30_90_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_30_90_34&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a href="#loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_90_24_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_24_90_25&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)

</span><a href="#loc_93_1_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_10&#39;)"><span class="mpre">putSocket</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_494_6_494_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_494_6_494_13&#39;)"><span class="hl_tyconref"><span class="mpre">Manager</span></span></a><span class="mpre"> -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_522_6_522_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_522_6_522_13&#39;)"><span class="hl_tyconref"><span class="mpre">ConnKey</span></span></a><span class="mpre"> -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_93_1_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_10&#39;)"><span class="hl_fundecl"><span class="mpre">putSocket</span></span></a><span class="mpre"> </span><a name="loc_93_11_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_11_93_14&#39;)"><span class="hl_vardecl"><span class="mpre">man</span></span></a><span class="mpre"> </span><a name="loc_93_15_93_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_18&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre"> </span><a name="loc_93_19_93_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_19_93_21&#39;)"><span class="hl_vardecl"><span class="mpre">ci</span></span></a><span class="mpre"> = do
    </span><a name="loc_94_5_94_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_8&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">getCurrentTime</span></span><span class="mpre">
    </span><a name="loc_95_5_95_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_5_95_10&#39;)"><span class="hl_vardecl"><span class="mpre">msock</span></span></a><span class="mpre"> &lt;- </span><a href="Data.IORef.html#loc_101_1_101_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_101_1_101_18&#39;)"><span class="hl_varref"><span class="mpre">I.atomicModifyIORef</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_495_7_495_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_495_7_495_13&#39;)"><span class="hl_varref"><span class="mpre">mConns</span></span></a><span class="mpre"> </span><a href="#loc_93_11_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_11_93_14&#39;)"><span class="hl_varref"><span class="mpre">man</span></span></a><span class="mpre">) (</span><a href="#loc_98_5_98_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_94_5_94_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_8&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre">)
    </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="Network.HTTP.Client.Types.html#loc_70_7_70_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_70_7_70_22&#39;)"><span class="hl_varref"><span class="mpre">connectionClose</span></span></a><span class="mpre"> </span><a href="#loc_95_5_95_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_5_95_10&#39;)"><span class="hl_varref"><span class="mpre">msock</span></span></a><span class="mpre">
  where
    </span><a name="loc_98_5_98_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> _ </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> = (</span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_93_19_93_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_19_93_21&#39;)"><span class="hl_varref"><span class="mpre">ci</span></span></a><span class="mpre">)
    </span><a href="#loc_98_5_98_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_99_8_99_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_8_99_11&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_99_18_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_18_99_19&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) =
        case </span><span class="hl_varref"><span class="mpre">Map.lookup</span></span><span class="mpre"> </span><a href="#loc_93_15_93_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_18&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre"> </span><a href="#loc_99_18_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_18_99_19&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Map.insert</span></span><span class="mpre"> </span><a href="#loc_93_15_93_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_18&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_510_5_510_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_510_5_510_8&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a href="#loc_93_19_93_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_19_93_21&#39;)"><span class="hl_varref"><span class="mpre">ci</span></span></a><span class="mpre"> </span><a href="#loc_99_8_99_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_8_99_11&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre">) </span><a href="#loc_99_18_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_18_99_19&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">)
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_102_18_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_19&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> -&gt;
                let (</span><a name="loc_103_22_103_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_22_103_24&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre">, </span><a name="loc_103_26_103_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_26_103_28&#39;)"><span class="hl_vardecl"><span class="mpre">mx</span></span></a><span class="mpre">) = </span><a href="#loc_109_1_109_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_10&#39;)"><span class="hl_varref"><span class="mpre">addToList</span></span></a><span class="mpre"> </span><a href="#loc_99_8_99_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_8_99_11&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_497_7_497_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_497_7_497_16&#39;)"><span class="hl_varref"><span class="mpre">mMaxConns</span></span></a><span class="mpre"> </span><a href="#loc_93_11_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_11_93_14&#39;)"><span class="hl_varref"><span class="mpre">man</span></span></a><span class="mpre">) </span><a href="#loc_93_19_93_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_19_93_21&#39;)"><span class="hl_varref"><span class="mpre">ci</span></span></a><span class="mpre"> </span><a href="#loc_102_18_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_18_102_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
                 in (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Map.insert</span></span><span class="mpre"> </span><a href="#loc_93_15_93_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_15_93_18&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre"> </span><a href="#loc_103_22_103_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_22_103_24&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre"> </span><a href="#loc_99_18_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_18_99_19&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">, </span><a href="#loc_103_26_103_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_26_103_28&#39;)"><span class="hl_varref"><span class="mpre">mx</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Add a new element to the list, up to the given maximum number. If we&#39;re</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- already at the maximum, return the new value as leftover.</span></span><span class="mpre">
</span><a href="#loc_109_1_109_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_10&#39;)"><span class="mpre">addToList</span></a><span class="mpre"> :: </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_509_6_509_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_509_6_509_18&#39;)"><span class="hl_tyconref"><span class="mpre">NonEmptyList</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><a href="Network.HTTP.Client.Types.html#loc_509_6_509_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_509_6_509_18&#39;)"><span class="hl_tyconref"><span class="mpre">NonEmptyList</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_109_1_109_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_10&#39;)"><span class="hl_fundecl"><span class="mpre">addToList</span></span></a><span class="mpre"> _ </span><a name="loc_109_13_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_13_109_14&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_109_15_109_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_15_109_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_109_17_109_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_17_109_18&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> | </span><a href="#loc_109_13_109_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_13_109_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = (</span><a href="#loc_109_17_109_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_17_109_18&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_109_15_109_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_15_109_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
</span><a href="#loc_109_1_109_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_10&#39;)"><span class="hl_fundecl"><span class="mpre">addToList</span></span></a><span class="mpre"> </span><a name="loc_110_11_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_11_110_14&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> _ </span><a name="loc_110_17_110_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_17_110_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_110_19_110_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_19_110_20&#39;)"><span class="hl_specname"><span class="mpre">l</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Manager.hs&quot;, srcSpanStartLine = 110, srcSpanStartColumn = 21, srcSpanEndLine = 110, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Manager.hs&quot;, srcSpanStartLine = 110, srcSpanStartColumn = 24, srcSpanEndLine = 110, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/H"><span class="mpre">One{}</span></span><span class="mpre"> = (</span><a href="Network.HTTP.Client.Types.html#loc_511_5_511_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_511_5_511_9&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_110_17_110_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_17_110_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><a href="#loc_110_11_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_11_110_14&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><a href="#loc_110_19_110_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_19_110_20&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">)
</span><a href="#loc_109_1_109_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_10&#39;)"><span class="hl_fundecl"><span class="mpre">addToList</span></span></a><span class="mpre"> </span><a name="loc_111_11_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_14&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> </span><a name="loc_111_15_111_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_15_111_23&#39;)"><span class="hl_vardecl"><span class="mpre">maxCount</span></span></a><span class="mpre"> </span><a name="loc_111_24_111_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_24_111_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_111_26_111_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_26_111_27&#39;)"><span class="hl_specname"><span class="mpre">l</span></span></a><span class="mpre">@(</span><a href="Network.HTTP.Client.Types.html#loc_511_5_511_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_511_5_511_9&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> _ </span><a name="loc_111_36_111_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_36_111_45&#39;)"><span class="hl_vardecl"><span class="mpre">currCount</span></span></a><span class="mpre"> _ _)
    | </span><a href="#loc_111_15_111_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_15_111_23&#39;)"><span class="hl_varref"><span class="mpre">maxCount</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_111_36_111_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_36_111_45&#39;)"><span class="hl_varref"><span class="mpre">currCount</span></span></a><span class="mpre"> = (</span><a href="Network.HTTP.Client.Types.html#loc_511_5_511_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_511_5_511_9&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_111_24_111_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_24_111_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><a href="#loc_111_36_111_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_36_111_45&#39;)"><span class="hl_varref"><span class="mpre">currCount</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_111_11_111_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_14&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> </span><a href="#loc_111_26_111_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_26_111_27&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = (</span><a href="#loc_111_26_111_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_26_111_27&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_111_24_111_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_24_111_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Create a &#39;Manager&#39;. You may manually call &#39;closeManager&#39; to shut it down,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- or allow the @Manager@ to be shut down automatically based on garbage</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- collection.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Creating a new &#39;Manager&#39; is a relatively expensive operation, you are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- advised to share a single &#39;Manager&#39; between requests instead.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The first argument to this function is often &#39;defaultManagerSettings&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- though add-on libraries may provide a recommended replacement.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 0.1.0</span></span><span class="mpre">
</span><a href="#loc_127_1_127_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_11&#39;)"><span class="mpre">newManager</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_447_6_447_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_447_6_447_21&#39;)"><span class="hl_tyconref"><span class="mpre">ManagerSettings</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_494_6_494_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_494_6_494_13&#39;)"><span class="hl_tyconref"><span class="mpre">Manager</span></span></a><span class="mpre">
</span><a name="loc_127_1_127_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_11&#39;)"><span class="hl_fundecl"><span class="mpre">newManager</span></span></a><span class="mpre"> </span><a name="loc_127_12_127_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_12_127_14&#39;)"><span class="hl_vardecl"><span class="mpre">ms</span></span></a><span class="mpre"> = do
    </span><span class="hl_vardecl"><span class="mpre">rawConnection</span></span><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Types.html#loc_452_7_452_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_452_7_452_27&#39;)"><span class="hl_varref"><span class="mpre">managerRawConnection</span></span></a><span class="mpre"> </span><a href="#loc_127_12_127_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_12_127_14&#39;)"><span class="hl_varref"><span class="mpre">ms</span></span></a><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">tlsConnection</span></span><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Types.html#loc_457_7_457_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_457_7_457_27&#39;)"><span class="hl_varref"><span class="mpre">managerTlsConnection</span></span></a><span class="mpre"> </span><a href="#loc_127_12_127_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_12_127_14&#39;)"><span class="hl_varref"><span class="mpre">ms</span></span></a><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">tlsProxyConnection</span></span><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Types.html#loc_461_7_461_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_461_7_461_32&#39;)"><span class="hl_varref"><span class="mpre">managerTlsProxyConnection</span></span></a><span class="mpre"> </span><a href="#loc_127_12_127_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_12_127_14&#39;)"><span class="hl_varref"><span class="mpre">ms</span></span></a><span class="mpre">
    </span><a name="loc_131_5_131_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_11&#39;)"><span class="hl_vardecl"><span class="mpre">mapRef</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">I.newIORef</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Map.empty</span></span><span class="mpre">)
    </span><a name="loc_132_5_132_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_5_132_12&#39;)"><span class="hl_vardecl"><span class="mpre">wmapRef</span></span></a><span class="mpre"> &lt;- </span><a href="Data.IORef.html#loc_52_1_52_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_52_1_52_12&#39;)"><span class="hl_varref"><span class="mpre">I.mkWeakIORef</span></span></a><span class="mpre"> </span><a href="#loc_131_5_131_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_11&#39;)"><span class="hl_varref"><span class="mpre">mapRef</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_249_1_249_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_14&#39;)"><span class="hl_varref"><span class="mpre">closeManager&#39;</span></span></a><span class="mpre"> </span><a href="#loc_131_5_131_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_11&#39;)"><span class="hl_varref"><span class="mpre">mapRef</span></span></a><span class="mpre">
    _ &lt;- </span><span class="hl_varref"><span class="mpre">forkIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_149_1_149_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_5&#39;)"><span class="hl_varref"><span class="mpre">reap</span></span></a><span class="mpre"> </span><a href="#loc_132_5_132_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_5_132_12&#39;)"><span class="hl_varref"><span class="mpre">wmapRef</span></span></a><span class="mpre">
    let </span><a name="loc_134_9_134_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_9_134_16&#39;)"><span class="hl_vardecl"><span class="mpre">manager</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Manager.hs&quot;, srcSpanStartLine = 134, srcSpanStartColumn = 19, srcSpanEndLine = 143, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Manager.hs&quot;, srcSpanStartLine = 135, srcSpanStartColumn = 13, srcSpanEndLine = 135, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Netw"><span class="mpre">Manager
            { mConns = mapRef
            , mMaxConns = managerConnCount ms
            , mResponseTimeout = managerResponseTimeout ms
            , mRawConnection = rawConnection
            , mTlsConnection = tlsConnection
            , mTlsProxyConnection = tlsProxyConnection
            , mRetryableException = managerRetryableException ms
            , mWrapIOException = managerWrapIOException ms
            }</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_134_9_134_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_9_134_16&#39;)"><span class="hl_varref"><span class="mpre">manager</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Collect and destroy any stale connections.</span></span><span class="mpre">
</span><a href="#loc_149_1_149_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_5&#39;)"><span class="mpre">reap</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Weak</span></span><span class="mpre"> (</span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">I.IORef</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Map.Map</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_522_6_522_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_522_6_522_13&#39;)"><span class="hl_tyconref"><span class="mpre">ConnKey</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_509_6_509_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_509_6_509_18&#39;)"><span class="hl_tyconref"><span class="mpre">NonEmptyList</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre">))))
     -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_149_1_149_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_5&#39;)"><span class="hl_fundecl"><span class="mpre">reap</span></span></a><span class="mpre"> </span><a name="loc_149_6_149_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_6_149_13&#39;)"><span class="hl_vardecl"><span class="mpre">wmapRef</span></span></a><span class="mpre"> =
    </span><a href="GHC.IO.html#loc_426_1_426_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_426_1_426_6&#39;)"><span class="hl_varref"><span class="mpre">mask_</span></span></a><span class="mpre"> </span><a href="#loc_152_5_152_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_5_152_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
  where
    </span><a name="loc_152_5_152_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_5_152_9&#39;)"><span class="hl_vardecl"><span class="mpre">loop</span></span></a><span class="mpre"> = do
        </span><span class="hl_varref"><span class="mpre">threadDelay</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1000</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1000</span></span><span class="mpre">)
        </span><a name="loc_154_9_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_16&#39;)"><span class="hl_vardecl"><span class="mpre">mmapRef</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">deRefWeak</span></span><span class="mpre"> </span><a href="#loc_149_6_149_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_6_149_13&#39;)"><span class="hl_varref"><span class="mpre">wmapRef</span></span></a><span class="mpre">
        case </span><a href="#loc_154_9_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_16&#39;)"><span class="hl_varref"><span class="mpre">mmapRef</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- manager is closed</span></span><span class="mpre">
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_157_18_157_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_18_157_24&#39;)"><span class="hl_vardecl"><span class="mpre">mapRef</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_159_5_159_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_5_159_13&#39;)"><span class="hl_varref"><span class="mpre">goMapRef</span></span></a><span class="mpre"> </span><a href="#loc_157_18_157_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_18_157_24&#39;)"><span class="hl_varref"><span class="mpre">mapRef</span></span></a><span class="mpre">

    </span><a name="loc_159_5_159_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_5_159_13&#39;)"><span class="hl_fundecl"><span class="mpre">goMapRef</span></span></a><span class="mpre"> </span><a name="loc_159_14_159_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_14_159_20&#39;)"><span class="hl_vardecl"><span class="mpre">mapRef</span></span></a><span class="mpre"> = do
        </span><a name="loc_160_9_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_12&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">getCurrentTime</span></span><span class="mpre">
        let </span><a name="loc_161_13_161_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_13_161_23&#39;)"><span class="hl_fundecl"><span class="mpre">isNotStale</span></span></a><span class="mpre"> </span><a name="loc_161_24_161_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_24_161_28&#39;)"><span class="hl_vardecl"><span class="mpre">time</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre"> </span><a href="Data.Time.Clock.UTCDiff.html#loc_9_1_9_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTCDiff.html#loc_9_1_9_11&#39;)"><span class="hl_infix"><span class="mpre">`addUTCTime`</span></span></a><span class="mpre"> </span><a href="#loc_161_24_161_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_24_161_28&#39;)"><span class="hl_varref"><span class="mpre">time</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_160_9_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_12&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre">
        </span><a name="loc_162_9_162_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_9_162_19&#39;)"><span class="hl_vardecl"><span class="mpre">mtoDestroy</span></span></a><span class="mpre"> &lt;- </span><a href="Data.IORef.html#loc_101_1_101_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_101_1_101_18&#39;)"><span class="hl_varref"><span class="mpre">I.atomicModifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_159_14_159_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_14_159_20&#39;)"><span class="hl_varref"><span class="mpre">mapRef</span></span></a><span class="mpre"> (</span><a href="#loc_168_5_168_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_18&#39;)"><span class="hl_varref"><span class="mpre">findStaleWrap</span></span></a><span class="mpre"> </span><a href="#loc_161_13_161_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_13_161_23&#39;)"><span class="hl_varref"><span class="mpre">isNotStale</span></span></a><span class="mpre">)
        case </span><a href="#loc_162_9_162_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_9_162_19&#39;)"><span class="hl_varref"><span class="mpre">mtoDestroy</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- manager is closed</span></span><span class="mpre">
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_165_18_165_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_18_165_27&#39;)"><span class="hl_vardecl"><span class="mpre">toDestroy</span></span></a><span class="mpre"> -&gt; do
                </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> </span><a href="#loc_260_1_260_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_1_260_14&#39;)"><span class="hl_varref"><span class="mpre">safeConnClose</span></span></a><span class="mpre"> </span><a href="#loc_165_18_165_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_18_165_27&#39;)"><span class="hl_varref"><span class="mpre">toDestroy</span></span></a><span class="mpre">
                </span><a href="#loc_152_5_152_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_5_152_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
    </span><a name="loc_168_5_168_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_18&#39;)"><span class="hl_fundecl"><span class="mpre">findStaleWrap</span></span></a><span class="mpre"> _ </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> = (</span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">)
    </span><a href="#loc_168_5_168_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_5_168_18&#39;)"><span class="hl_fundecl"><span class="mpre">findStaleWrap</span></span></a><span class="mpre"> </span><a name="loc_169_19_169_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_29&#39;)"><span class="hl_vardecl"><span class="mpre">isNotStale</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_169_36_169_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_36_169_37&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) =
        let (</span><a name="loc_170_14_170_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_14_170_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_170_17_170_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_17_170_18&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><a href="#loc_172_5_172_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_14&#39;)"><span class="hl_varref"><span class="mpre">findStale</span></span></a><span class="mpre"> </span><a href="#loc_169_19_169_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_19_169_29&#39;)"><span class="hl_varref"><span class="mpre">isNotStale</span></span></a><span class="mpre"> </span><a href="#loc_169_36_169_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_36_169_37&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
         in (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_170_14_170_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_14_170_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_170_17_170_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_17_170_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
    </span><a name="loc_172_5_172_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_14&#39;)"><span class="hl_fundecl"><span class="mpre">findStale</span></span></a><span class="mpre"> </span><a name="loc_172_15_172_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_15_172_25&#39;)"><span class="hl_vardecl"><span class="mpre">isNotStale</span></span></a><span class="mpre"> =
        </span><a href="#loc_175_9_175_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_9_175_19&#39;)"><span class="hl_varref"><span class="mpre">findStale&#39;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Map.toList</span></span><span class="mpre">
      where
        </span><a name="loc_175_9_175_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_9_175_19&#39;)"><span class="hl_fundecl"><span class="mpre">findStale&#39;</span></span></a><span class="mpre"> </span><a name="loc_175_20_175_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_20_175_27&#39;)"><span class="hl_vardecl"><span class="mpre">destroy</span></span></a><span class="mpre"> </span><a name="loc_175_28_175_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_28_175_32&#39;)"><span class="hl_vardecl"><span class="mpre">keep</span></span></a><span class="mpre"> [] = (</span><span class="hl_varref"><span class="mpre">Map.fromList</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_175_28_175_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_28_175_32&#39;)"><span class="hl_varref"><span class="mpre">keep</span></span></a><span class="mpre"> [], </span><a href="#loc_175_20_175_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_20_175_27&#39;)"><span class="hl_varref"><span class="mpre">destroy</span></span></a><span class="mpre"> [])
        </span><a href="#loc_175_9_175_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_9_175_19&#39;)"><span class="hl_fundecl"><span class="mpre">findStale&#39;</span></span></a><span class="mpre"> </span><a name="loc_176_20_176_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_20_176_27&#39;)"><span class="hl_vardecl"><span class="mpre">destroy</span></span></a><span class="mpre"> </span><a name="loc_176_28_176_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_28_176_32&#39;)"><span class="hl_vardecl"><span class="mpre">keep</span></span></a><span class="mpre"> ((</span><a name="loc_176_35_176_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_35_176_42&#39;)"><span class="hl_vardecl"><span class="mpre">connkey</span></span></a><span class="mpre">, </span><a name="loc_176_44_176_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_44_176_50&#39;)"><span class="hl_vardecl"><span class="mpre">nelist</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_176_52_176_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_52_176_56&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) =
            </span><a href="#loc_175_9_175_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_9_175_19&#39;)"><span class="hl_varref"><span class="mpre">findStale&#39;</span></span></a><span class="mpre"> </span><a href="#loc_182_13_182_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_13_182_21&#39;)"><span class="hl_varref"><span class="mpre">destroy&#39;</span></span></a><span class="mpre"> </span><a href="#loc_183_13_183_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_13_183_18&#39;)"><span class="hl_varref"><span class="mpre">keep&#39;</span></span></a><span class="mpre"> </span><a href="#loc_176_52_176_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_52_176_56&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
          where
            </span><span class="hl_comment"><span class="mpre">-- Note: By definition, the timestamps must be in descending order,</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- so we don&#39;t need to traverse the whole list.</span></span><span class="mpre">
            (</span><a name="loc_181_14_181_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_14_181_22&#39;)"><span class="hl_vardecl"><span class="mpre">notStale</span></span></a><span class="mpre">, </span><a name="loc_181_24_181_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_24_181_29&#39;)"><span class="hl_vardecl"><span class="mpre">stale</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> (</span><a href="#loc_172_15_172_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_15_172_25&#39;)"><span class="hl_varref"><span class="mpre">isNotStale</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Tuple.html#loc_48_1_48_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tuple.html#loc_48_1_48_4&#39;)"><span class="hl_varref"><span class="mpre">fst</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_221_1_221_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_9&#39;)"><span class="hl_varref"><span class="mpre">neToList</span></span></a><span class="mpre"> </span><a href="#loc_176_44_176_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_44_176_50&#39;)"><span class="hl_varref"><span class="mpre">nelist</span></span></a><span class="mpre">
            </span><a name="loc_182_13_182_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_13_182_21&#39;)"><span class="hl_vardecl"><span class="mpre">destroy&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_176_20_176_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_20_176_27&#39;)"><span class="hl_varref"><span class="mpre">destroy</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Data.Tuple.html#loc_52_1_52_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tuple.html#loc_52_1_52_4&#39;)"><span class="hl_varref"><span class="mpre">snd</span></span></a><span class="mpre"> </span><a href="#loc_181_24_181_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_24_181_29&#39;)"><span class="hl_varref"><span class="mpre">stale</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">)
            </span><a name="loc_183_13_183_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_13_183_18&#39;)"><span class="hl_vardecl"><span class="mpre">keep&#39;</span></span></a><span class="mpre"> =
                case </span><a href="#loc_225_1_225_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_1_225_11&#39;)"><span class="hl_varref"><span class="mpre">neFromList</span></span></a><span class="mpre"> </span><a href="#loc_181_14_181_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_14_181_22&#39;)"><span class="hl_varref"><span class="mpre">notStale</span></span></a><span class="mpre"> of
                    </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_176_28_176_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_28_176_32&#39;)"><span class="hl_varref"><span class="mpre">keep</span></span></a><span class="mpre">
                    </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_186_26_186_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_26_186_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_176_28_176_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_28_176_32&#39;)"><span class="hl_varref"><span class="mpre">keep</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> ((</span><a href="#loc_176_35_176_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_35_176_42&#39;)"><span class="hl_varref"><span class="mpre">connkey</span></span></a><span class="mpre">, </span><a href="#loc_186_26_186_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_26_186_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)

    </span><span class="hl_fundecl"><span class="mpre">flushStaleCerts</span></span><span class="mpre"> </span><a name="loc_188_21_188_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_21_188_24&#39;)"><span class="hl_vardecl"><span class="mpre">now</span></span></a><span class="mpre"> =
        </span><span class="hl_varref"><span class="mpre">Map.fromList</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_123_1_123_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_123_1_123_9&#39;)"><span class="hl_varref"><span class="mpre">mapMaybe</span></span></a><span class="mpre"> </span><a href="#loc_191_9_191_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_9_191_25&#39;)"><span class="hl_varref"><span class="mpre">flushStaleCerts&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Map.toList</span></span><span class="mpre">
      where
        </span><a name="loc_191_9_191_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_9_191_25&#39;)"><span class="hl_fundecl"><span class="mpre">flushStaleCerts&#39;</span></span></a><span class="mpre"> (</span><a name="loc_191_27_191_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_27_191_32&#39;)"><span class="hl_vardecl"><span class="mpre">host&#39;</span></span></a><span class="mpre">, </span><a name="loc_191_34_191_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_34_191_39&#39;)"><span class="hl_vardecl"><span class="mpre">inner</span></span></a><span class="mpre">) =
            case </span><a href="Data.Maybe.html#loc_123_1_123_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_123_1_123_9&#39;)"><span class="hl_varref"><span class="mpre">mapMaybe</span></span></a><span class="mpre"> </span><a href="#loc_197_9_197_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_26&#39;)"><span class="hl_varref"><span class="mpre">flushStaleCerts&#39;&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Map.toList</span></span><span class="mpre"> </span><a href="#loc_191_34_191_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_34_191_39&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> of
                [] -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
                </span><a name="loc_194_17_194_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_17_194_22&#39;)"><span class="hl_vardecl"><span class="mpre">pairs</span></span></a><span class="mpre"> -&gt;
                    let </span><a name="loc_195_25_195_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_25_195_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><a href="#loc_194_17_194_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_17_194_22&#39;)"><span class="hl_varref"><span class="mpre">pairs</span></span></a><span class="mpre">
                     in </span><a href="#loc_195_25_195_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_25_195_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_202_9_202_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_9_202_17&#39;)"><span class="hl_infix"><span class="mpre">`seqPairs`</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="#loc_191_27_191_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_27_191_32&#39;)"><span class="hl_varref"><span class="mpre">host&#39;</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">Map.fromList</span></span><span class="mpre"> </span><a href="#loc_195_25_195_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_25_195_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
        </span><a name="loc_197_9_197_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_26&#39;)"><span class="hl_fundecl"><span class="mpre">flushStaleCerts&#39;&#39;</span></span></a><span class="mpre"> (</span><a name="loc_197_28_197_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_28_197_33&#39;)"><span class="hl_vardecl"><span class="mpre">certs</span></span></a><span class="mpre">, </span><a name="loc_197_35_197_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_35_197_42&#39;)"><span class="hl_vardecl"><span class="mpre">expires</span></span></a><span class="mpre">)
            | </span><a href="#loc_197_35_197_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_35_197_42&#39;)"><span class="hl_varref"><span class="mpre">expires</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_188_21_188_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_21_188_24&#39;)"><span class="hl_varref"><span class="mpre">now</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="#loc_197_28_197_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_28_197_33&#39;)"><span class="hl_varref"><span class="mpre">certs</span></span></a><span class="mpre">, </span><a href="#loc_197_35_197_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_35_197_42&#39;)"><span class="hl_varref"><span class="mpre">expires</span></span></a><span class="mpre">)
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

        </span><a href="#loc_202_9_202_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_9_202_17&#39;)"><span class="mpre">seqPairs</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">)] -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
        </span><a name="loc_202_9_202_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_9_202_17&#39;)"><span class="hl_fundecl"><span class="mpre">seqPairs</span></span></a><span class="mpre"> [] </span><a name="loc_202_21_202_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_21_202_22&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_202_21_202_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_21_202_22&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
        </span><a href="#loc_202_9_202_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_9_202_17&#39;)"><span class="hl_fundecl"><span class="mpre">seqPairs</span></span></a><span class="mpre"> (</span><a name="loc_203_19_203_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_19_203_20&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_203_21_203_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_21_203_23&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">) </span><a name="loc_203_25_203_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_25_203_26&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_203_19_203_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_19_203_20&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_206_9_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_16&#39;)"><span class="hl_infix"><span class="mpre">`seqPair`</span></span></a><span class="mpre"> </span><a href="#loc_203_21_203_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_21_203_23&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a href="#loc_202_9_202_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_9_202_17&#39;)"><span class="hl_infix"><span class="mpre">`seqPairs`</span></span></a><span class="mpre"> </span><a href="#loc_203_25_203_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_25_203_26&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

        </span><a href="#loc_206_9_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_16&#39;)"><span class="mpre">seqPair</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
        </span><a name="loc_206_9_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_16&#39;)"><span class="hl_fundecl"><span class="mpre">seqPair</span></span></a><span class="mpre"> (</span><a name="loc_206_18_206_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_21&#39;)"><span class="hl_vardecl"><span class="mpre">lbs</span></span></a><span class="mpre">, </span><a name="loc_206_23_206_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_23_206_26&#39;)"><span class="hl_vardecl"><span class="mpre">utc</span></span></a><span class="mpre">) </span><a name="loc_206_28_206_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_28_206_29&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_206_18_206_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_21&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre"> </span><a href="#loc_209_9_209_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_9_209_15&#39;)"><span class="hl_infix"><span class="mpre">`seqLBS`</span></span></a><span class="mpre"> </span><a href="#loc_206_23_206_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_23_206_26&#39;)"><span class="hl_varref"><span class="mpre">utc</span></span></a><span class="mpre"> </span><a href="#loc_212_9_212_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_9_212_15&#39;)"><span class="hl_infix"><span class="mpre">`seqUTC`</span></span></a><span class="mpre"> </span><a href="#loc_206_28_206_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_28_206_29&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

        </span><a href="#loc_209_9_209_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_9_209_15&#39;)"><span class="mpre">seqLBS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
        </span><a name="loc_209_9_209_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_9_209_15&#39;)"><span class="hl_fundecl"><span class="mpre">seqLBS</span></span></a><span class="mpre"> </span><a name="loc_209_16_209_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_16_209_19&#39;)"><span class="hl_vardecl"><span class="mpre">lbs</span></span></a><span class="mpre"> </span><a name="loc_209_20_209_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_20_209_21&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_209_16_209_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_16_209_19&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_167_1_167_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_167_1_167_4&#39;)"><span class="hl_infix"><span class="mpre">`seq`</span></span></a><span class="mpre"> </span><a href="#loc_209_20_209_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_20_209_21&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

        </span><a href="#loc_212_9_212_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_9_212_15&#39;)"><span class="mpre">seqUTC</span></a><span class="mpre"> :: </span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
        </span><a name="loc_212_9_212_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_9_212_15&#39;)"><span class="hl_fundecl"><span class="mpre">seqUTC</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">UTCTime</span></span><span class="mpre"> </span><a name="loc_212_25_212_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_25_212_28&#39;)"><span class="hl_vardecl"><span class="mpre">day</span></span></a><span class="mpre"> </span><a name="loc_212_29_212_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_29_212_31&#39;)"><span class="hl_vardecl"><span class="mpre">dt</span></span></a><span class="mpre">) </span><a name="loc_212_33_212_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_33_212_34&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_212_25_212_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_25_212_28&#39;)"><span class="hl_varref"><span class="mpre">day</span></span></a><span class="mpre"> </span><a href="#loc_215_9_215_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_9_215_15&#39;)"><span class="hl_infix"><span class="mpre">`seqDay`</span></span></a><span class="mpre"> </span><a href="#loc_212_29_212_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_29_212_31&#39;)"><span class="hl_varref"><span class="mpre">dt</span></span></a><span class="mpre"> </span><a href="#loc_218_9_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_9_218_14&#39;)"><span class="hl_infix"><span class="mpre">`seqDT`</span></span></a><span class="mpre"> </span><a href="#loc_212_33_212_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_33_212_34&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

        </span><a href="#loc_215_9_215_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_9_215_15&#39;)"><span class="mpre">seqDay</span></a><span class="mpre"> :: </span><a href="Data.Time.Calendar.Days.html#loc_18_9_18_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Calendar.Days.html#loc_18_9_18_12&#39;)"><span class="hl_tyconref"><span class="mpre">Day</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
        </span><a name="loc_215_9_215_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_9_215_15&#39;)"><span class="hl_fundecl"><span class="mpre">seqDay</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ModifiedJulianDay</span></span><span class="mpre"> </span><a name="loc_215_35_215_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_35_215_36&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) </span><a name="loc_215_38_215_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_38_215_39&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_215_35_215_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_35_215_36&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="Control.DeepSeq.html#loc_85_1_85_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_85_1_85_8&#39;)"><span class="hl_infix"><span class="mpre">`deepseq`</span></span></a><span class="mpre"> </span><a href="#loc_215_38_215_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_38_215_39&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

        </span><a href="#loc_218_9_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_9_218_14&#39;)"><span class="mpre">seqDT</span></a><span class="mpre"> :: </span><a href="Data.Time.Clock.Scale.html#loc_41_9_41_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.Scale.html#loc_41_9_41_17&#39;)"><span class="hl_tyconref"><span class="mpre">DiffTime</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
        </span><a name="loc_218_9_218_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_9_218_14&#39;)"><span class="hl_vardecl"><span class="mpre">seqDT</span></span></a><span class="mpre"> = </span><a href="Prelude.html#loc_167_1_167_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_167_1_167_4&#39;)"><span class="hl_varref"><span class="mpre">seq</span></span></a><span class="mpre">

</span><a href="#loc_221_1_221_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_9&#39;)"><span class="mpre">neToList</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_509_6_509_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_509_6_509_18&#39;)"><span class="hl_tyconref"><span class="mpre">NonEmptyList</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [(</span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)]
</span><a name="loc_221_1_221_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_9&#39;)"><span class="hl_fundecl"><span class="mpre">neToList</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_510_5_510_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_510_5_510_8&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a name="loc_221_15_221_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_15_221_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_221_17_221_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_17_221_18&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) = [(</span><a href="#loc_221_17_221_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_17_221_18&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">, </span><a href="#loc_221_15_221_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_15_221_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)]
</span><a href="#loc_221_1_221_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_9&#39;)"><span class="hl_fundecl"><span class="mpre">neToList</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_511_5_511_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_511_5_511_9&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a name="loc_222_16_222_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_16_222_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> _ </span><a name="loc_222_20_222_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_20_222_21&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_222_22_222_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_22_222_28&#39;)"><span class="hl_vardecl"><span class="mpre">nelist</span></span></a><span class="mpre">) = (</span><a href="#loc_222_20_222_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_20_222_21&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">, </span><a href="#loc_222_16_222_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_16_222_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_221_1_221_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_9&#39;)"><span class="hl_varref"><span class="mpre">neToList</span></span></a><span class="mpre"> </span><a href="#loc_222_22_222_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_22_222_28&#39;)"><span class="hl_varref"><span class="mpre">nelist</span></span></a><span class="mpre">

</span><a href="#loc_225_1_225_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_1_225_11&#39;)"><span class="mpre">neFromList</span></a><span class="mpre"> :: [(</span><a href="Data.Time.Clock.UTC.html#loc_31_6_31_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Time.Clock.UTC.html#loc_31_6_31_13&#39;)"><span class="hl_tyconref"><span class="mpre">UTCTime</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)] -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_509_6_509_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_509_6_509_18&#39;)"><span class="hl_tyconref"><span class="mpre">NonEmptyList</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_225_1_225_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_1_225_11&#39;)"><span class="hl_fundecl"><span class="mpre">neFromList</span></span></a><span class="mpre"> [] = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
</span><a href="#loc_225_1_225_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_1_225_11&#39;)"><span class="hl_fundecl"><span class="mpre">neFromList</span></span></a><span class="mpre"> [(</span><a name="loc_226_14_226_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_14_226_15&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">, </span><a name="loc_226_17_226_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_17_226_18&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">)] = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_510_5_510_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_510_5_510_8&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a href="#loc_226_17_226_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_17_226_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_226_14_226_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_14_226_15&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
</span><a href="#loc_225_1_225_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_1_225_11&#39;)"><span class="hl_fundecl"><span class="mpre">neFromList</span></span></a><span class="mpre"> </span><a name="loc_227_12_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_12_227_14&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> =
    </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Tuple.html#loc_52_1_52_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tuple.html#loc_52_1_52_4&#39;)"><span class="hl_varref"><span class="mpre">snd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_230_5_230_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_5_230_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_227_12_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_12_227_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
  where
    </span><a name="loc_230_5_230_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_5_230_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;neFromList.go []&quot;</span></span><span class="mpre">
    </span><a href="#loc_230_5_230_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_5_230_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><a name="loc_231_10_231_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_10_231_11&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">, </span><a name="loc_231_13_231_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_13_231_14&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">)] = (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_510_5_510_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_510_5_510_8&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a href="#loc_231_13_231_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_13_231_14&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_231_10_231_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_10_231_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
    </span><a href="#loc_230_5_230_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_5_230_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> ((</span><a name="loc_232_10_232_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_10_232_11&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">, </span><a name="loc_232_13_232_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_13_232_14&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_232_16_232_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_16_232_20&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) =
        let (</span><a name="loc_233_14_233_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_14_233_15&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">, </span><a name="loc_233_17_233_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_17_233_22&#39;)"><span class="hl_vardecl"><span class="mpre">rest&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_230_5_230_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_5_230_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_232_16_232_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_16_232_20&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
            </span><a name="loc_234_13_234_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_13_234_15&#39;)"><span class="hl_vardecl"><span class="mpre">i&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_233_14_233_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_14_233_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
         in </span><a href="#loc_234_13_234_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_13_234_15&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_167_1_167_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_167_1_167_4&#39;)"><span class="hl_infix"><span class="mpre">`seq`</span></span></a><span class="mpre"> (</span><a href="#loc_234_13_234_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_13_234_15&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_511_5_511_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_511_5_511_9&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_232_13_232_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_13_232_14&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_233_14_233_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_14_233_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_232_10_232_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_10_232_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_233_17_233_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_17_233_22&#39;)"><span class="hl_varref"><span class="mpre">rest&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Close all connections in a &#39;Manager&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that this doesn&#39;t affect currently in-flight connections,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- meaning you can safely use it without hurting any queries you may</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- have concurrently running.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 0.1.0</span></span><span class="mpre">
</span><a href="#loc_245_1_245_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_13&#39;)"><span class="mpre">closeManager</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_494_6_494_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_494_6_494_13&#39;)"><span class="hl_tyconref"><span class="mpre">Manager</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_245_1_245_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_13&#39;)"><span class="hl_vardecl"><span class="mpre">closeManager</span></span></a><span class="mpre"> = </span><a href="#loc_249_1_249_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_14&#39;)"><span class="hl_varref"><span class="mpre">closeManager&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_495_7_495_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_495_7_495_13&#39;)"><span class="hl_varref"><span class="mpre">mConns</span></span></a><span class="mpre">

</span><a href="#loc_249_1_249_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_14&#39;)"><span class="mpre">closeManager&#39;</span></a><span class="mpre"> :: </span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">I.IORef</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Map.Map</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_522_6_522_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_522_6_522_13&#39;)"><span class="hl_tyconref"><span class="mpre">ConnKey</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_509_6_509_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_509_6_509_18&#39;)"><span class="hl_tyconref"><span class="mpre">NonEmptyList</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre">)))
              -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_249_1_249_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_1_249_14&#39;)"><span class="hl_fundecl"><span class="mpre">closeManager&#39;</span></span></a><span class="mpre"> </span><a name="loc_249_15_249_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_15_249_23&#39;)"><span class="hl_vardecl"><span class="mpre">connsRef</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_426_1_426_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_426_1_426_6&#39;)"><span class="hl_varref"><span class="mpre">mask_</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_250_5_250_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_5_250_6&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> &lt;- </span><a href="Data.IORef.html#loc_101_1_101_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_101_1_101_18&#39;)"><span class="hl_varref"><span class="mpre">I.atomicModifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_249_15_249_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_15_249_23&#39;)"><span class="hl_varref"><span class="mpre">connsRef</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_250_42_250_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_42_250_43&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; (</span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">, </span><a href="#loc_250_42_250_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_42_250_43&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
    </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (</span><a href="#loc_263_1_263_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_14&#39;)"><span class="hl_varref"><span class="mpre">nonEmptyMapM_</span></span></a><span class="mpre"> </span><a href="#loc_260_1_260_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_1_260_14&#39;)"><span class="hl_varref"><span class="mpre">safeConnClose</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> [] </span><span class="hl_varref"><span class="mpre">Map.elems</span></span><span class="mpre"> </span><a href="#loc_250_5_250_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_5_250_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create, use and close a &#39;Manager&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 0.2.1</span></span><span class="mpre">
</span><a href="#loc_257_1_257_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_12&#39;)"><span class="mpre">withManager</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_447_6_447_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_447_6_447_21&#39;)"><span class="hl_tyconref"><span class="mpre">ManagerSettings</span></span></a><span class="mpre"> -&gt; (</span><a href="Network.HTTP.Client.Types.html#loc_494_6_494_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_494_6_494_13&#39;)"><span class="hl_tyconref"><span class="mpre">Manager</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_257_1_257_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_1_257_12&#39;)"><span class="hl_fundecl"><span class="mpre">withManager</span></span></a><span class="mpre"> </span><a name="loc_257_13_257_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_13_257_21&#39;)"><span class="hl_vardecl"><span class="mpre">settings</span></span></a><span class="mpre"> = </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">bracket</span></span></a><span class="mpre"> (</span><a href="#loc_127_1_127_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_11&#39;)"><span class="hl_varref"><span class="mpre">newManager</span></span></a><span class="mpre"> </span><a href="#loc_257_13_257_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_13_257_21&#39;)"><span class="hl_varref"><span class="mpre">settings</span></span></a><span class="mpre">) </span><a href="#loc_245_1_245_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_13&#39;)"><span class="hl_varref"><span class="mpre">closeManager</span></span></a><span class="mpre">

</span><a href="#loc_260_1_260_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_1_260_14&#39;)"><span class="mpre">safeConnClose</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_260_1_260_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_1_260_14&#39;)"><span class="hl_fundecl"><span class="mpre">safeConnClose</span></span></a><span class="mpre"> </span><a name="loc_260_15_260_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_15_260_17&#39;)"><span class="hl_vardecl"><span class="mpre">ci</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Types.html#loc_70_7_70_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_70_7_70_22&#39;)"><span class="hl_varref"><span class="mpre">connectionClose</span></span></a><span class="mpre"> </span><a href="#loc_260_15_260_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_15_260_17&#39;)"><span class="hl_varref"><span class="mpre">ci</span></span></a><span class="mpre"> </span><a href="Control.Exception.Base.html#loc_150_1_150_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_150_1_150_6&#39;)"><span class="hl_infix"><span class="mpre">`catch`</span></span></a><span class="mpre"> \(_ :: </span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">IOException</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_263_1_263_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_14&#39;)"><span class="mpre">nonEmptyMapM_</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Manager.hs&quot;, srcSpanStartLine = 262, srcSpanStartColumn = 18, srcSpanEndLine = 262, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Manager.hs&quot;, srcSpanStartLine = 262, srcSpanStartColumn = 26, srcSpanEndLine = 262, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagr"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_509_6_509_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_509_6_509_18&#39;)"><span class="hl_tyconref"><span class="mpre">NonEmptyList</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_263_1_263_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_14&#39;)"><span class="hl_fundecl"><span class="mpre">nonEmptyMapM_</span></span></a><span class="mpre"> </span><a name="loc_263_15_263_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_15_263_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_510_5_510_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_510_5_510_8&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> </span><a name="loc_263_22_263_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_22_263_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> _) = </span><a href="#loc_263_15_263_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_15_263_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_263_22_263_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_22_263_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_263_1_263_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_14&#39;)"><span class="hl_fundecl"><span class="mpre">nonEmptyMapM_</span></span></a><span class="mpre"> </span><a name="loc_264_15_264_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_15_264_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_511_5_511_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_511_5_511_9&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a name="loc_264_23_264_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_23_264_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> _ _ </span><a name="loc_264_29_264_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_29_264_30&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = </span><a href="#loc_264_15_264_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_15_264_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_264_23_264_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_23_264_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_263_1_263_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_1_263_14&#39;)"><span class="hl_varref"><span class="mpre">nonEmptyMapM_</span></span></a><span class="mpre"> </span><a href="#loc_264_15_264_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_15_264_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_264_29_264_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_29_264_30&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This function needs to acquire a @ConnInfo@- either from the @Manager@ or</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- via I\/O, and register it with the @ResourceT@ so it is guaranteed to be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- either released or returned to the manager.</span></span><span class="mpre">
</span><a href="#loc_275_1_275_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_1_275_15&#39;)"><span class="mpre">getManagedConn</span></a><span class="mpre">
    :: </span><a href="Network.HTTP.Client.Types.html#loc_494_6_494_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_494_6_494_13&#39;)"><span class="hl_tyconref"><span class="mpre">Manager</span></span></a><span class="mpre">
    -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_522_6_522_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_522_6_522_13&#39;)"><span class="hl_tyconref"><span class="mpre">ConnKey</span></span></a><span class="mpre">
    -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre">
    -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ConnRelease</span></span><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_399_6_399_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_399_6_399_17&#39;)"><span class="hl_tyconref"><span class="mpre">ManagedConn</span></span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">-- We want to avoid any holes caused by async exceptions, so let&#39;s mask.</span></span><span class="mpre">
</span><a name="loc_275_1_275_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_1_275_15&#39;)"><span class="hl_fundecl"><span class="mpre">getManagedConn</span></span></a><span class="mpre"> </span><a name="loc_275_16_275_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_16_275_19&#39;)"><span class="hl_vardecl"><span class="mpre">man</span></span></a><span class="mpre"> </span><a name="loc_275_20_275_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_20_275_23&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre"> </span><a name="loc_275_24_275_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_24_275_28&#39;)"><span class="hl_vardecl"><span class="mpre">open</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_428_1_428_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_428_1_428_5&#39;)"><span class="hl_varref"><span class="mpre">mask</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_275_39_275_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_39_275_46&#39;)"><span class="hl_vardecl"><span class="mpre">restore</span></span></a><span class="mpre"> -&gt; do
    </span><span class="hl_comment"><span class="mpre">-- Try to take the socket out of the manager.</span></span><span class="mpre">
    </span><a name="loc_277_5_277_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_5_277_8&#39;)"><span class="hl_vardecl"><span class="mpre">mci</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_82_1_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_11&#39;)"><span class="hl_varref"><span class="mpre">takeSocket</span></span></a><span class="mpre"> </span><a href="#loc_275_16_275_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_16_275_19&#39;)"><span class="hl_varref"><span class="mpre">man</span></span></a><span class="mpre"> </span><a href="#loc_275_20_275_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_20_275_23&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre">
    (</span><a name="loc_278_6_278_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_8&#39;)"><span class="hl_vardecl"><span class="mpre">ci</span></span></a><span class="mpre">, </span><a name="loc_278_10_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_10_278_19&#39;)"><span class="hl_vardecl"><span class="mpre">isManaged</span></span></a><span class="mpre">) &lt;-
        case </span><a href="#loc_277_5_277_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_5_277_8&#39;)"><span class="hl_varref"><span class="mpre">mci</span></span></a><span class="mpre"> of
            </span><span class="hl_comment"><span class="mpre">-- There wasn&#39;t a matching connection in the manager, so create a</span></span><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- new one.</span></span><span class="mpre">
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; do
                </span><a name="loc_283_17_283_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_17_283_19&#39;)"><span class="hl_vardecl"><span class="mpre">ci</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_275_39_275_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_39_275_46&#39;)"><span class="hl_varref"><span class="mpre">restore</span></span></a><span class="mpre"> </span><a href="#loc_275_24_275_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_24_275_28&#39;)"><span class="hl_varref"><span class="mpre">open</span></span></a><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_283_17_283_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_17_283_19&#39;)"><span class="hl_varref"><span class="mpre">ci</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_399_20_399_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_399_20_399_25&#39;)"><span class="hl_conref"><span class="mpre">Fresh</span></span></a><span class="mpre">)
            </span><span class="hl_comment"><span class="mpre">-- Return the existing one</span></span><span class="mpre">
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_286_18_286_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_18_286_20&#39;)"><span class="hl_vardecl"><span class="mpre">ci</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_286_18_286_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_18_286_20&#39;)"><span class="hl_varref"><span class="mpre">ci</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_399_28_399_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_399_28_399_34&#39;)"><span class="hl_conref"><span class="mpre">Reused</span></span></a><span class="mpre">)

    </span><span class="hl_comment"><span class="mpre">-- When we release this connection, we can either reuse it (put it back in</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- the manager) or not reuse it (close the socket). We set up a mutable</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- reference to track what we want to do. By default, we say not to reuse</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- it, that way if an exception is thrown, the connection won&#39;t be reused.</span></span><span class="mpre">
    </span><a name="loc_292_5_292_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_5_292_15&#39;)"><span class="hl_vardecl"><span class="mpre">toReuseRef</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">I.newIORef</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_394_26_394_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_394_26_394_35&#39;)"><span class="hl_conref"><span class="mpre">DontReuse</span></span></a><span class="mpre">
    </span><a name="loc_293_5_293_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_5_293_19&#39;)"><span class="hl_vardecl"><span class="mpre">wasReleasedRef</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">I.newIORef</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- When the connection is explicitly released, we update our toReuseRef to</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- indicate what action should be taken, and then call release.</span></span><span class="mpre">
    let </span><a name="loc_297_9_297_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_9_297_20&#39;)"><span class="hl_fundecl"><span class="mpre">connRelease</span></span></a><span class="mpre"> </span><a name="loc_297_21_297_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_21_297_22&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = do
            </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">I.writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_292_5_292_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_5_292_15&#39;)"><span class="hl_varref"><span class="mpre">toReuseRef</span></span></a><span class="mpre"> </span><a href="#loc_297_21_297_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_21_297_22&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
            </span><a href="#loc_301_9_301_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_9_301_22&#39;)"><span class="hl_varref"><span class="mpre">releaseHelper</span></span></a><span class="mpre">

        </span><a name="loc_301_9_301_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_9_301_22&#39;)"><span class="hl_vardecl"><span class="mpre">releaseHelper</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_428_1_428_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_428_1_428_5&#39;)"><span class="hl_varref"><span class="mpre">mask</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_301_33_301_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_33_301_40&#39;)"><span class="hl_vardecl"><span class="mpre">restore</span></span></a><span class="mpre"> -&gt; do
            </span><a name="loc_302_13_302_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_13_302_24&#39;)"><span class="hl_vardecl"><span class="mpre">wasReleased</span></span></a><span class="mpre"> &lt;- </span><a href="Data.IORef.html#loc_101_1_101_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_101_1_101_18&#39;)"><span class="hl_varref"><span class="mpre">I.atomicModifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_293_5_293_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_5_293_19&#39;)"><span class="hl_varref"><span class="mpre">wasReleasedRef</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_302_66_302_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_66_302_67&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><a href="#loc_302_66_302_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_66_302_67&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
            </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> </span><a href="#loc_302_13_302_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_13_302_24&#39;)"><span class="hl_varref"><span class="mpre">wasReleased</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
                </span><a name="loc_304_17_304_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_17_304_24&#39;)"><span class="hl_vardecl"><span class="mpre">toReuse</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">I.readIORef</span></span></a><span class="mpre"> </span><a href="#loc_292_5_292_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_5_292_15&#39;)"><span class="hl_varref"><span class="mpre">toReuseRef</span></span></a><span class="mpre">
                </span><a href="#loc_301_33_301_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_33_301_40&#39;)"><span class="hl_varref"><span class="mpre">restore</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> case </span><a href="#loc_304_17_304_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_17_304_24&#39;)"><span class="hl_varref"><span class="mpre">toReuse</span></span></a><span class="mpre"> of
                    </span><a href="Network.HTTP.Client.Types.html#loc_394_18_394_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_394_18_394_23&#39;)"><span class="hl_conref"><span class="mpre">Reuse</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_93_1_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_10&#39;)"><span class="hl_varref"><span class="mpre">putSocket</span></span></a><span class="mpre"> </span><a href="#loc_275_16_275_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_16_275_19&#39;)"><span class="hl_varref"><span class="mpre">man</span></span></a><span class="mpre"> </span><a href="#loc_275_20_275_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_20_275_23&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre"> </span><a href="#loc_278_6_278_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_8&#39;)"><span class="hl_varref"><span class="mpre">ci</span></span></a><span class="mpre">
                    </span><a href="Network.HTTP.Client.Types.html#loc_394_26_394_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_394_26_394_35&#39;)"><span class="hl_conref"><span class="mpre">DontReuse</span></span></a><span class="mpre"> -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_70_7_70_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_70_7_70_22&#39;)"><span class="hl_varref"><span class="mpre">connectionClose</span></span></a><span class="mpre"> </span><a href="#loc_278_6_278_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_8&#39;)"><span class="hl_varref"><span class="mpre">ci</span></span></a><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_297_9_297_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_9_297_20&#39;)"><span class="hl_varref"><span class="mpre">connRelease</span></span></a><span class="mpre">, </span><a href="#loc_278_6_278_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_6_278_8&#39;)"><span class="hl_varref"><span class="mpre">ci</span></span></a><span class="mpre">, </span><a href="#loc_278_10_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_10_278_19&#39;)"><span class="hl_varref"><span class="mpre">isManaged</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Create an exception to be thrown if the connection for the given request</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- fails.</span></span><span class="mpre">
</span><a href="#loc_314_1_314_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_1_314_26&#39;)"><span class="mpre">failedConnectionException</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_77_6_77_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_77_6_77_19&#39;)"><span class="hl_tyconref"><span class="mpre">HttpException</span></span></a><span class="mpre">
</span><a name="loc_314_1_314_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_1_314_26&#39;)"><span class="hl_fundecl"><span class="mpre">failedConnectionException</span></span></a><span class="mpre"> </span><a name="loc_314_27_314_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_27_314_30&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> =
    </span><a href="Network.HTTP.Client.Types.html#loc_86_22_86_47" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_86_22_86_47&#39;)"><span class="hl_conref"><span class="mpre">FailedConnectionException</span></span></a><span class="mpre"> </span><a href="#loc_317_9_317_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_9_317_14&#39;)"><span class="hl_varref"><span class="mpre">host&#39;</span></span></a><span class="mpre"> </span><a href="#loc_317_16_317_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_16_317_21&#39;)"><span class="hl_varref"><span class="mpre">port&#39;</span></span></a><span class="mpre">
  where
    (_, </span><a name="loc_317_9_317_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_9_317_14&#39;)"><span class="hl_vardecl"><span class="mpre">host&#39;</span></span></a><span class="mpre">, </span><a name="loc_317_16_317_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_16_317_21&#39;)"><span class="hl_vardecl"><span class="mpre">port&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_320_1_320_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_12&#39;)"><span class="hl_varref"><span class="mpre">getConnDest</span></span></a><span class="mpre"> </span><a href="#loc_314_27_314_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_27_314_30&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">

</span><a href="#loc_320_1_320_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_12&#39;)"><span class="mpre">getConnDest</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_320_1_320_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_12&#39;)"><span class="hl_fundecl"><span class="mpre">getConnDest</span></span></a><span class="mpre"> </span><a name="loc_320_13_320_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_13_320_16&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> =
    case </span><a href="Network.HTTP.Client.Types.html#loc_335_7_335_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_335_7_335_12&#39;)"><span class="hl_varref"><span class="mpre">proxy</span></span></a><span class="mpre"> </span><a href="#loc_320_13_320_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_13_320_16&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> of
        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_322_14_322_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_14_322_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">S8.unpack</span></span><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_166_7_166_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_166_7_166_16&#39;)"><span class="hl_varref"><span class="mpre">proxyHost</span></span></a><span class="mpre"> </span><a href="#loc_322_14_322_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_14_322_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">), </span><a href="Network.HTTP.Client.Types.html#loc_167_7_167_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_167_7_167_16&#39;)"><span class="hl_varref"><span class="mpre">proxyPort</span></span></a><span class="mpre"> </span><a href="#loc_322_14_322_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_14_322_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">S8.unpack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_289_7_289_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_289_7_289_11&#39;)"><span class="hl_varref"><span class="mpre">host</span></span></a><span class="mpre"> </span><a href="#loc_320_13_320_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_13_320_16&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_294_7_294_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_294_7_294_11&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre"> </span><a href="#loc_320_13_320_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_13_320_16&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">)

</span><a href="#loc_328_1_328_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_8&#39;)"><span class="mpre">getConn</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_280_6_280_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_280_6_280_13&#39;)"><span class="hl_tyconref"><span class="mpre">Request</span></span></a><span class="mpre">
        -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_494_6_494_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_494_6_494_13&#39;)"><span class="hl_tyconref"><span class="mpre">Manager</span></span></a><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ConnRelease</span></span><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_399_6_399_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_399_6_399_17&#39;)"><span class="hl_tyconref"><span class="mpre">ManagedConn</span></span></a><span class="mpre">)
</span><a name="loc_328_1_328_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_8&#39;)"><span class="hl_fundecl"><span class="mpre">getConn</span></span></a><span class="mpre"> </span><a name="loc_328_9_328_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_9_328_12&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> </span><a name="loc_328_13_328_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_13_328_14&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Stop Mac OS X from getting high:</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- https://github.com/snoyberg/http-client/issues/40#issuecomment-39117909</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S8.null</span></span><span class="mpre"> </span><a href="#loc_336_5_336_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_5_336_6&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_105_22_105_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_105_22_105_44&#39;)"><span class="hl_conref"><span class="mpre">InvalidDestinationHost</span></span></a><span class="mpre"> </span><a href="#loc_336_5_336_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_5_336_6&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
        </span><a href="#loc_275_1_275_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_1_275_15&#39;)"><span class="hl_varref"><span class="mpre">getManagedConn</span></span></a><span class="mpre"> </span><a href="#loc_328_13_328_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_13_328_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_522_16_522_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_522_16_522_23&#39;)"><span class="hl_conref"><span class="mpre">ConnKey</span></span></a><span class="mpre"> </span><a href="#loc_338_16_338_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_16_338_27&#39;)"><span class="hl_varref"><span class="mpre">connKeyHost</span></span></a><span class="mpre"> </span><a href="#loc_337_26_337_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_26_337_34&#39;)"><span class="hl_varref"><span class="mpre">connport</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_285_7_285_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_285_7_285_13&#39;)"><span class="hl_varref"><span class="mpre">secure</span></span></a><span class="mpre"> </span><a href="#loc_328_9_328_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_9_328_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
            </span><a href="#loc_343_5_343_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_5_343_19&#39;)"><span class="hl_varref"><span class="mpre">wrapConnectExc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_346_5_346_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_5_346_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_338_6_338_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_6_338_14&#39;)"><span class="hl_varref"><span class="mpre">connaddr</span></span></a><span class="mpre"> </span><a href="#loc_337_16_337_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_16_337_24&#39;)"><span class="hl_varref"><span class="mpre">connhost</span></span></a><span class="mpre"> </span><a href="#loc_337_26_337_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_26_337_34&#39;)"><span class="hl_varref"><span class="mpre">connport</span></span></a><span class="mpre">
  where
    </span><a name="loc_336_5_336_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_5_336_6&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Types.html#loc_289_7_289_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_289_7_289_11&#39;)"><span class="hl_varref"><span class="mpre">host</span></span></a><span class="mpre"> </span><a href="#loc_328_9_328_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_9_328_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
    (</span><a name="loc_337_6_337_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_6_337_14&#39;)"><span class="hl_vardecl"><span class="mpre">useProxy</span></span></a><span class="mpre">, </span><a name="loc_337_16_337_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_16_337_24&#39;)"><span class="hl_vardecl"><span class="mpre">connhost</span></span></a><span class="mpre">, </span><a name="loc_337_26_337_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_26_337_34&#39;)"><span class="hl_vardecl"><span class="mpre">connport</span></span></a><span class="mpre">) = </span><a href="#loc_320_1_320_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_12&#39;)"><span class="hl_varref"><span class="mpre">getConnDest</span></span></a><span class="mpre"> </span><a href="#loc_328_9_328_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_9_328_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
    (</span><a name="loc_338_6_338_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_6_338_14&#39;)"><span class="hl_vardecl"><span class="mpre">connaddr</span></span></a><span class="mpre">, </span><a name="loc_338_16_338_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_16_338_27&#39;)"><span class="hl_vardecl"><span class="mpre">connKeyHost</span></span></a><span class="mpre">) =
        case (</span><a href="Network.HTTP.Client.Types.html#loc_339_7_339_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_339_7_339_18&#39;)"><span class="hl_varref"><span class="mpre">hostAddress</span></span></a><span class="mpre"> </span><a href="#loc_328_9_328_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_9_328_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">, </span><a href="#loc_337_6_337_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_6_337_14&#39;)"><span class="hl_varref"><span class="mpre">useProxy</span></span></a><span class="mpre">) of
            (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_340_19_340_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_19_340_21&#39;)"><span class="hl_vardecl"><span class="mpre">ha</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">) -&gt; (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_340_19_340_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_19_340_21&#39;)"><span class="hl_varref"><span class="mpre">ha</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_517_5_517_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_517_5_517_16&#39;)"><span class="hl_conref"><span class="mpre">HostAddress</span></span></a><span class="mpre"> </span><a href="#loc_340_19_340_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_19_340_21&#39;)"><span class="hl_varref"><span class="mpre">ha</span></span></a><span class="mpre">)
            _ -&gt; (</span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Client.Types.html#loc_516_5_516_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_516_5_516_13&#39;)"><span class="hl_conref"><span class="mpre">HostName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_387_1_387_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_387_1_387_5&#39;)"><span class="hl_varref"><span class="mpre">T.pack</span></span></a><span class="mpre"> </span><a href="#loc_337_16_337_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_16_337_24&#39;)"><span class="hl_varref"><span class="mpre">connhost</span></span></a><span class="mpre">)

    </span><a name="loc_343_5_343_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_5_343_19&#39;)"><span class="hl_vardecl"><span class="mpre">wrapConnectExc</span></span></a><span class="mpre"> = </span><a href="Control.Exception.Base.html#loc_181_1_181_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_181_1_181_7&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_343_32_343_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_32_343_33&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> -&gt;
        </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_87_22_87_48" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_87_22_87_48&#39;)"><span class="hl_conref"><span class="mpre">FailedConnectionException2</span></span></a><span class="mpre"> </span><a href="#loc_337_16_337_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_16_337_24&#39;)"><span class="hl_varref"><span class="mpre">connhost</span></span></a><span class="mpre"> </span><a href="#loc_337_26_337_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_26_337_34&#39;)"><span class="hl_varref"><span class="mpre">connport</span></span></a><span class="mpre"> (</span><a href="Network.HTTP.Client.Types.html#loc_285_7_285_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_285_7_285_13&#39;)"><span class="hl_varref"><span class="mpre">secure</span></span></a><span class="mpre"> </span><a href="#loc_328_9_328_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_9_328_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">)
            (</span><span class="hl_varref"><span class="mpre">toException</span></span><span class="mpre"> (</span><a href="#loc_343_32_343_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_32_343_33&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> :: </span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">IOException</span></span></a><span class="mpre">))
    </span><a name="loc_346_5_346_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_5_346_7&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre"> =
        case (</span><a href="Network.HTTP.Client.Types.html#loc_285_7_285_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_285_7_285_13&#39;)"><span class="hl_varref"><span class="mpre">secure</span></span></a><span class="mpre"> </span><a href="#loc_328_9_328_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_9_328_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">, </span><a href="#loc_337_6_337_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_6_337_14&#39;)"><span class="hl_varref"><span class="mpre">useProxy</span></span></a><span class="mpre">) of
            (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, _) -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_501_7_501_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_501_7_501_21&#39;)"><span class="hl_varref"><span class="mpre">mRawConnection</span></span></a><span class="mpre"> </span><a href="#loc_328_13_328_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_13_328_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
            (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">) -&gt; </span><a href="Network.HTTP.Client.Types.html#loc_502_7_502_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_502_7_502_21&#39;)"><span class="hl_varref"><span class="mpre">mTlsConnection</span></span></a><span class="mpre"> </span><a href="#loc_328_13_328_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_13_328_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
            (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">) -&gt;
                let </span><a name="loc_351_21_351_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_21_351_28&#39;)"><span class="hl_vardecl"><span class="mpre">ultHost</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Types.html#loc_289_7_289_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_289_7_289_11&#39;)"><span class="hl_varref"><span class="mpre">host</span></span></a><span class="mpre"> </span><a href="#loc_328_9_328_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_9_328_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
                    </span><a name="loc_352_21_352_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_21_352_28&#39;)"><span class="hl_vardecl"><span class="mpre">ultPort</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Types.html#loc_294_7_294_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_294_7_294_11&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre"> </span><a href="#loc_328_9_328_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_9_328_12&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
                    </span><a name="loc_353_21_353_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_21_353_28&#39;)"><span class="hl_vardecl"><span class="mpre">connstr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S8.concat</span></span><span class="mpre">
                        [ </span><span class="hl_string"><span class="mpre">&quot;CONNECT &quot;</span></span><span class="mpre">
                        , </span><a href="#loc_351_21_351_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_21_351_28&#39;)"><span class="hl_varref"><span class="mpre">ultHost</span></span></a><span class="mpre">
                        , </span><span class="hl_string"><span class="mpre">&quot;:&quot;</span></span><span class="mpre">
                        , </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_352_21_352_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_21_352_28&#39;)"><span class="hl_varref"><span class="mpre">ultPort</span></span></a><span class="mpre">
                        , </span><span class="hl_string"><span class="mpre">&quot; HTTP/1.1\r\n\r\n&quot;</span></span><span class="mpre">
                        ]
                    </span><a name="loc_360_21_360_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_21_360_26&#39;)"><span class="hl_fundecl"><span class="mpre">parse</span></span></a><span class="mpre"> </span><a name="loc_360_27_360_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_27_360_31&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre"> = do
                        </span><a name="loc_361_25_361_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_25_361_27&#39;)"><span class="hl_specname"><span class="mpre">sh</span></span></a><span class="mpre">@(</span><a href="Network.HTTP.Client.Types.html#loc_74_22_74_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_74_22_74_35&#39;)"><span class="hl_conref"><span class="mpre">StatusHeaders</span></span></a><span class="mpre"> </span><a name="loc_361_43_361_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_43_361_49&#39;)"><span class="hl_vardecl"><span class="mpre">status</span></span></a><span class="mpre"> _ _) &lt;- </span><a href="Network.HTTP.Client.Headers.html#loc_28_1_28_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Headers.html#loc_28_1_28_19&#39;)"><span class="hl_varref"><span class="mpre">parseStatusHeaders</span></span></a><span class="mpre"> </span><a href="#loc_360_27_360_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_27_360_31&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
                        </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><a href="#loc_361_43_361_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_43_361_49&#39;)"><span class="hl_varref"><span class="mpre">status</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                            </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_92_22_92_43" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_92_22_92_43&#39;)"><span class="hl_conref"><span class="mpre">ProxyConnectException</span></span></a><span class="mpre"> </span><a href="#loc_351_21_351_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_21_351_28&#39;)"><span class="hl_varref"><span class="mpre">ultHost</span></span></a><span class="mpre"> </span><a href="#loc_352_21_352_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_21_352_28&#39;)"><span class="hl_varref"><span class="mpre">ultPort</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_361_25_361_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_25_361_27&#39;)"><span class="hl_varref"><span class="mpre">sh</span></span></a><span class="mpre">
                 in </span><a href="Network.HTTP.Client.Types.html#loc_503_7_503_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_503_7_503_26&#39;)"><span class="hl_varref"><span class="mpre">mTlsProxyConnection</span></span></a><span class="mpre"> </span><a href="#loc_328_13_328_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_13_328_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_353_21_353_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_21_353_28&#39;)"><span class="hl_varref"><span class="mpre">connstr</span></span></a><span class="mpre"> </span><a href="#loc_360_21_360_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_21_360_26&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S8.unpack</span></span><span class="mpre"> </span><a href="#loc_351_21_351_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_351_21_351_28&#39;)"><span class="hl_varref"><span class="mpre">ultHost</span></span></a><span class="mpre">)
</span></div></body></html>