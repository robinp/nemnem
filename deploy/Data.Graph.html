<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
#if __GLASGOW_HASKELL__
{-# LANGUAGE Rank2Types #-}
#endif
#if __GLASGOW_HASKELL__ &gt;= 703
{-# LANGUAGE Trustworthy #-}
#endif
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Data.Graph</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The University of Glasgow 2002</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A version of the graph algorithms described in:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   /Structuring Depth-First Search Algorithms in Haskell/,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   by David King and John Launchbury.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Data.Graph(

        </span><span class="hl_comment"><span class="mpre">-- * External interface</span></span><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- At present the only one with a &quot;nice&quot; external interface</span></span><span class="mpre">
        stronglyConnComp, stronglyConnCompR, SCC(..), flattenSCC, flattenSCCs,

        </span><span class="hl_comment"><span class="mpre">-- * Graphs</span></span><span class="mpre">

        Graph, Table, Bounds, Edge, Vertex,

        </span><span class="hl_comment"><span class="mpre">-- ** Building graphs</span></span><span class="mpre">

        graphFromEdges, graphFromEdges&#39;, buildG, transposeG,
        </span><span class="hl_comment"><span class="mpre">-- reverseE,</span></span><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- ** Graph properties</span></span><span class="mpre">

        vertices, edges,
        outdegree, indegree,

        </span><span class="hl_comment"><span class="mpre">-- * Algorithms</span></span><span class="mpre">

        dfs, dff,
        topSort,
        components,
        scc,
        bcc,
        </span><span class="hl_comment"><span class="mpre">-- tree, back, cross, forward,</span></span><span class="mpre">
        reachable, path,

        module Data.Tree

    ) where

#if __GLASGOW_HASKELL__
# define USE_ST_MONAD 1
#endif

</span><span class="hl_comment"><span class="mpre">-- Extensions</span></span><span class="mpre">
#if USE_ST_MONAD
import Control.Monad.ST
import Data.Array.ST (STArray, newArray, readArray, writeArray)
#else
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 69, srcSpanStartColumn = 8, srcSpanEndLine = 69, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;Data.IntSet&quot;"><span class="mpre">Data.IntSet</span></span><span class="mpre"> (IntSet)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 18, srcSpanEndLine = 70, srcSpanEndColumn = 29}, srcInfoPoints = []}) &quot;Data.IntSet&quot;"><span class="mpre">Data.IntSet</span></span><span class="mpre"> as Set
#endif
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 8, srcSpanEndLine = 72, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Tree&quot;"><span class="mpre">Data.Tree</span></span><span class="mpre"> (Tree(Node), Forest)

</span><span class="hl_comment"><span class="mpre">-- std interfaces</span></span><span class="mpre">
import Control.Applicative
import Control.DeepSeq (</span><a href="Control.DeepSeq.html#loc_110_7_110_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_110_7_110_13&#39;)"><span class="mpre">NFData</span></a><span class="mpre">(</span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="mpre">rnf</span></a><span class="mpre">))
import Data.Maybe
import Data.Array
import Data.List

</span><span class="hl_comment"><span class="mpre">-------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                                                      -</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      External interface</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                                                      -</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Strongly connected component.</span></span><span class="mpre">
data </span><a name="loc_88_6_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_9&#39;)"><span class="hl_tycondecl"><span class="mpre">SCC</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">vertex</span></span><span class="mpre"> = </span><a name="loc_88_19_88_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_19_88_29&#39;)"><span class="hl_condecl"><span class="mpre">AcyclicSCC</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">vertex</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ A single vertex that is not</span></span><span class="mpre">
                                        </span><span class="hl_comment"><span class="mpre">-- in any cycle.</span></span><span class="mpre">
                | </span><a name="loc_90_19_90_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_19_90_28&#39;)"><span class="hl_condecl"><span class="mpre">CyclicSCC</span></span></a><span class="mpre">  [</span><span class="hl_tyvar"><span class="mpre">vertex</span></span><span class="mpre">]   </span><span class="hl_comment"><span class="mpre">-- ^ A maximal set of mutually</span></span><span class="mpre">
                                        </span><span class="hl_comment"><span class="mpre">-- reachable vertices.</span></span><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 10, srcSpanEndLine = 93, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 19, srcSpanEndLine = 93, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/D"><span class="mpre">NFData a =&gt;</span></span><span class="mpre"> </span><a href="Control.DeepSeq.html#loc_110_7_110_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_110_7_110_13&#39;)"><span class="hl_classref"><span class="mpre">NFData</span></span></a><span class="mpre"> (</span><a href="#loc_88_6_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_9&#39;)"><span class="hl_tyconref"><span class="mpre">SCC</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
    </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">rnf</span></span></a><span class="mpre"> (</span><a href="#loc_88_19_88_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_19_88_29&#39;)"><span class="hl_conref"><span class="mpre">AcyclicSCC</span></span></a><span class="mpre"> </span><a name="loc_94_21_94_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_21_94_22&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a href="#loc_94_21_94_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_21_94_22&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
    </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">rnf</span></span></a><span class="mpre"> (</span><a href="#loc_90_19_90_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_19_90_28&#39;)"><span class="hl_conref"><span class="mpre">CyclicSCC</span></span></a><span class="mpre"> </span><a name="loc_95_20_95_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_20_95_22&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre">) = </span><a href="Control.DeepSeq.html#loc_120_5_120_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.DeepSeq.html#loc_120_5_120_8&#39;)"><span class="hl_varref"><span class="mpre">rnf</span></span></a><span class="mpre"> </span><a href="#loc_95_20_95_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_20_95_22&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_88_6_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_9&#39;)"><span class="hl_tyconref"><span class="mpre">SCC</span></span></a><span class="mpre"> where
    </span><a name="loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> </span><a name="loc_98_10_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_10_98_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_88_19_88_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_19_88_29&#39;)"><span class="hl_conref"><span class="mpre">AcyclicSCC</span></span></a><span class="mpre"> </span><a name="loc_98_24_98_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_24_98_25&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = </span><a href="#loc_88_19_88_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_19_88_29&#39;)"><span class="hl_conref"><span class="mpre">AcyclicSCC</span></span></a><span class="mpre"> (</span><a href="#loc_98_10_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_10_98_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_98_24_98_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_24_98_25&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)
    </span><a href="#loc_98_5_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmap</span></span></a><span class="mpre"> </span><a name="loc_99_10_99_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_10_99_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_90_19_90_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_19_90_28&#39;)"><span class="hl_conref"><span class="mpre">CyclicSCC</span></span></a><span class="mpre"> </span><a name="loc_99_23_99_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_23_99_25&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre">) = </span><a href="#loc_90_19_90_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_19_90_28&#39;)"><span class="hl_conref"><span class="mpre">CyclicSCC</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_99_10_99_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_10_99_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_99_23_99_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_23_99_25&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The vertices of a list of strongly connected components.</span></span><span class="mpre">
</span><a href="#loc_103_1_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_12&#39;)"><span class="mpre">flattenSCCs</span></a><span class="mpre"> :: [</span><a href="#loc_88_6_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_9&#39;)"><span class="hl_tyconref"><span class="mpre">SCC</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_103_1_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_1_103_12&#39;)"><span class="hl_vardecl"><span class="mpre">flattenSCCs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_107_1_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_11&#39;)"><span class="hl_varref"><span class="mpre">flattenSCC</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The vertices of a strongly connected component.</span></span><span class="mpre">
</span><a href="#loc_107_1_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_11&#39;)"><span class="mpre">flattenSCC</span></a><span class="mpre"> :: </span><a href="#loc_88_6_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_9&#39;)"><span class="hl_tyconref"><span class="mpre">SCC</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">vertex</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">vertex</span></span><span class="mpre">]
</span><a name="loc_107_1_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_11&#39;)"><span class="hl_fundecl"><span class="mpre">flattenSCC</span></span></a><span class="mpre"> (</span><a href="#loc_88_19_88_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_19_88_29&#39;)"><span class="hl_conref"><span class="mpre">AcyclicSCC</span></span></a><span class="mpre"> </span><a name="loc_107_24_107_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_24_107_25&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = [</span><a href="#loc_107_24_107_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_24_107_25&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">]
</span><a href="#loc_107_1_107_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_11&#39;)"><span class="hl_fundecl"><span class="mpre">flattenSCC</span></span></a><span class="mpre"> (</span><a href="#loc_90_19_90_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_19_90_28&#39;)"><span class="hl_conref"><span class="mpre">CyclicSCC</span></span></a><span class="mpre"> </span><a name="loc_108_23_108_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_23_108_25&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre">) = </span><a href="#loc_108_23_108_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_23_108_25&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The strongly connected components of a directed graph, topologically</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- sorted.</span></span><span class="mpre">
</span><a href="#loc_121_1_121_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_17&#39;)"><span class="mpre">stronglyConnComp</span></a><span class="mpre">
        :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 113, srcSpanStartColumn = 12, srcSpanEndLine = 114, srcSpanEndColumn = 11}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 114, srcSpanStartColumn = 9, srcSpanEndLine = 114, srcSpanEndColumn = 11}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5."><span class="mpre">Ord key
        =&gt;</span></span><span class="mpre"> [(</span><span class="hl_tyvar"><span class="mpre">node</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre">, [</span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre">])]
                </span><span class="hl_comment"><span class="mpre">-- ^ The graph: a list of nodes uniquely identified by keys,</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- with a list of keys of nodes this node has edges to.</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- The out-list may contain keys that don&#39;t correspond to</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- nodes of the graph; such edges are ignored.</span></span><span class="mpre">
        -&gt; [</span><a href="#loc_88_6_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_9&#39;)"><span class="hl_tyconref"><span class="mpre">SCC</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">node</span></span><span class="mpre">]

</span><a name="loc_121_1_121_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_17&#39;)"><span class="hl_fundecl"><span class="mpre">stronglyConnComp</span></span></a><span class="mpre"> </span><a name="loc_121_18_121_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_18_121_24&#39;)"><span class="hl_vardecl"><span class="mpre">edges0</span></span></a><span class="mpre">
  = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_124_5_124_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_5_124_13&#39;)"><span class="hl_varref"><span class="mpre">get_node</span></span></a><span class="mpre"> (</span><a href="#loc_142_1_142_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_18&#39;)"><span class="hl_varref"><span class="mpre">stronglyConnCompR</span></span></a><span class="mpre"> </span><a href="#loc_121_18_121_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_18_121_24&#39;)"><span class="hl_varref"><span class="mpre">edges0</span></span></a><span class="mpre">)
  where
    </span><a name="loc_124_5_124_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_5_124_13&#39;)"><span class="hl_fundecl"><span class="mpre">get_node</span></span></a><span class="mpre"> (</span><a href="#loc_88_19_88_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_19_88_29&#39;)"><span class="hl_conref"><span class="mpre">AcyclicSCC</span></span></a><span class="mpre"> (</span><a name="loc_124_27_124_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_27_124_28&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">, _, _)) = </span><a href="#loc_88_19_88_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_19_88_29&#39;)"><span class="hl_conref"><span class="mpre">AcyclicSCC</span></span></a><span class="mpre"> </span><a href="#loc_124_27_124_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_27_124_28&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    </span><a href="#loc_124_5_124_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_5_124_13&#39;)"><span class="hl_fundecl"><span class="mpre">get_node</span></span></a><span class="mpre"> (</span><a href="#loc_90_19_90_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_19_90_28&#39;)"><span class="hl_conref"><span class="mpre">CyclicSCC</span></span></a><span class="mpre"> </span><a name="loc_125_25_125_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_25_125_32&#39;)"><span class="hl_vardecl"><span class="mpre">triples</span></span></a><span class="mpre">)     = </span><a href="#loc_90_19_90_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_19_90_28&#39;)"><span class="hl_conref"><span class="mpre">CyclicSCC</span></span></a><span class="mpre"> [</span><a href="#loc_125_56_125_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_56_125_57&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> | (</span><a name="loc_125_56_125_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_56_125_57&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">,_,_) &lt;- </span><a href="#loc_125_25_125_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_25_125_32&#39;)"><span class="hl_varref"><span class="mpre">triples</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | The strongly connected components of a directed graph, topologically</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- sorted.  The function is the same as &#39;stronglyConnComp&#39;, except that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- all the information about each node retained.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This interface is used when you expect to apply &#39;SCC&#39; to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (some of) the result of &#39;SCC&#39;, so you don&#39;t want to lose the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- dependency information.</span></span><span class="mpre">
</span><a href="#loc_142_1_142_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_18&#39;)"><span class="mpre">stronglyConnCompR</span></a><span class="mpre">
        :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 134, srcSpanStartColumn = 12, srcSpanEndLine = 135, srcSpanEndColumn = 11}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 135, srcSpanStartColumn = 9, srcSpanEndLine = 135, srcSpanEndColumn = 11}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5."><span class="mpre">Ord key
        =&gt;</span></span><span class="mpre"> [(</span><span class="hl_tyvar"><span class="mpre">node</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre">, [</span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre">])]
                </span><span class="hl_comment"><span class="mpre">-- ^ The graph: a list of nodes uniquely identified by keys,</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- with a list of keys of nodes this node has edges to.</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- The out-list may contain keys that don&#39;t correspond to</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- nodes of the graph; such edges are ignored.</span></span><span class="mpre">
        -&gt; [</span><a href="#loc_88_6_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_9&#39;)"><span class="hl_tyconref"><span class="mpre">SCC</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">node</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre">, [</span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre">])]     </span><span class="hl_comment"><span class="mpre">-- ^ Topologically sorted</span></span><span class="mpre">

</span><a name="loc_142_1_142_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_18&#39;)"><span class="hl_fundecl"><span class="mpre">stronglyConnCompR</span></span></a><span class="mpre"> [] = []  </span><span class="hl_comment"><span class="mpre">-- added to avoid creating empty array in graphFromEdges -- SOF</span></span><span class="mpre">
</span><a href="#loc_142_1_142_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_18&#39;)"><span class="hl_fundecl"><span class="mpre">stronglyConnCompR</span></span></a><span class="mpre"> </span><a name="loc_143_19_143_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_19_143_25&#39;)"><span class="hl_vardecl"><span class="mpre">edges0</span></span></a><span class="mpre">
  = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_148_5_148_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_5_148_11&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_147_5_147_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_11&#39;)"><span class="hl_varref"><span class="mpre">forest</span></span></a><span class="mpre">
  where
    (</span><a name="loc_146_6_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_11&#39;)"><span class="hl_vardecl"><span class="mpre">graph</span></span></a><span class="mpre">, </span><a name="loc_146_13_146_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_13_146_22&#39;)"><span class="hl_vardecl"><span class="mpre">vertex_fn</span></span></a><span class="mpre">,_) = </span><a href="#loc_222_1_222_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_15&#39;)"><span class="hl_varref"><span class="mpre">graphFromEdges</span></span></a><span class="mpre"> </span><a href="#loc_143_19_143_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_19_143_25&#39;)"><span class="hl_varref"><span class="mpre">edges0</span></span></a><span class="mpre">
    </span><a name="loc_147_5_147_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_11&#39;)"><span class="hl_vardecl"><span class="mpre">forest</span></span></a><span class="mpre">             = </span><a href="#loc_412_1_412_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_1_412_4&#39;)"><span class="hl_varref"><span class="mpre">scc</span></span></a><span class="mpre"> </span><a href="#loc_146_6_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_11&#39;)"><span class="hl_varref"><span class="mpre">graph</span></span></a><span class="mpre">
    </span><a name="loc_148_5_148_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_5_148_11&#39;)"><span class="hl_fundecl"><span class="mpre">decode</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> </span><a name="loc_148_18_148_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_18_148_19&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> []) | </span><a href="#loc_153_5_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_5_153_20&#39;)"><span class="hl_varref"><span class="mpre">mentions_itself</span></span></a><span class="mpre"> </span><a href="#loc_148_18_148_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_18_148_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_90_19_90_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_19_90_28&#39;)"><span class="hl_conref"><span class="mpre">CyclicSCC</span></span></a><span class="mpre"> [</span><a href="#loc_146_13_146_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_13_146_22&#39;)"><span class="hl_varref"><span class="mpre">vertex_fn</span></span></a><span class="mpre"> </span><a href="#loc_148_18_148_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_18_148_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">]
                       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         = </span><a href="#loc_88_19_88_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_19_88_29&#39;)"><span class="hl_conref"><span class="mpre">AcyclicSCC</span></span></a><span class="mpre"> (</span><a href="#loc_146_13_146_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_13_146_22&#39;)"><span class="hl_varref"><span class="mpre">vertex_fn</span></span></a><span class="mpre"> </span><a href="#loc_148_18_148_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_18_148_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)
    </span><a href="#loc_148_5_148_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_5_148_11&#39;)"><span class="hl_fundecl"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a name="loc_150_12_150_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_12_150_17&#39;)"><span class="hl_vardecl"><span class="mpre">other</span></span></a><span class="mpre"> = </span><a href="#loc_90_19_90_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_19_90_28&#39;)"><span class="hl_conref"><span class="mpre">CyclicSCC</span></span></a><span class="mpre"> (</span><a href="#loc_152_20_152_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_20_152_23&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre"> </span><a href="#loc_150_12_150_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_12_150_17&#39;)"><span class="hl_varref"><span class="mpre">other</span></span></a><span class="mpre"> [])
                 where
                   </span><a name="loc_152_20_152_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_20_152_23&#39;)"><span class="hl_fundecl"><span class="mpre">dec</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> </span><a name="loc_152_30_152_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_30_152_31&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_152_32_152_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_32_152_34&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">) </span><a name="loc_152_36_152_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_36_152_38&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> = </span><a href="#loc_146_13_146_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_13_146_22&#39;)"><span class="hl_varref"><span class="mpre">vertex_fn</span></span></a><span class="mpre"> </span><a href="#loc_152_30_152_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_30_152_31&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="#loc_152_20_152_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_20_152_23&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre"> </span><a href="#loc_152_36_152_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_36_152_38&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre"> </span><a href="#loc_152_32_152_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_32_152_34&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
    </span><a name="loc_153_5_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_5_153_20&#39;)"><span class="hl_fundecl"><span class="mpre">mentions_itself</span></span></a><span class="mpre"> </span><a name="loc_153_21_153_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_21_153_22&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_153_21_153_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_21_153_22&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> (</span><a href="#loc_146_6_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_6_146_11&#39;)"><span class="hl_varref"><span class="mpre">graph</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!</span></span><span class="mpre"> </span><a href="#loc_153_21_153_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_21_153_22&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                                                      -</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      Graphs</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                                                      -</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Abstract representation of vertices.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 1, srcSpanEndLine = 162, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 1, srcSpanEndLine = 162, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 162,"><span class="mpre">type Vertex  = Int</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Table indexed by a contiguous set of vertices.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 164, srcSpanStartColumn = 1, srcSpanEndLine = 164, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 164, srcSpanStartColumn = 1, srcSpanEndLine = 164, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 164,"><span class="mpre">type Table a = Array Vertex a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Adjacency list representation of a graph, mapping each vertex to its</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- list of successors.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 167, srcSpanStartColumn = 1, srcSpanEndLine = 167, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 167, srcSpanStartColumn = 1, srcSpanEndLine = 167, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 167,"><span class="mpre">type Graph   = Table [Vertex]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The bounds of a &#39;Table&#39;.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 169, srcSpanStartColumn = 1, srcSpanEndLine = 169, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 169, srcSpanStartColumn = 1, srcSpanEndLine = 169, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 169,"><span class="mpre">type Bounds  = (Vertex, Vertex)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | An edge from the first vertex to the second.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 171, srcSpanStartColumn = 1, srcSpanEndLine = 171, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 171, srcSpanStartColumn = 1, srcSpanEndLine = 171, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 171,"><span class="mpre">type Edge    = (Vertex, Vertex)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | All vertices of a graph.</span></span><span class="mpre">
</span><a href="#loc_175_1_175_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_9&#39;)"><span class="mpre">vertices</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">]
</span><a name="loc_175_1_175_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_9&#39;)"><span class="hl_vardecl"><span class="mpre">vertices</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">indices</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | All edges of a graph.</span></span><span class="mpre">
</span><a href="#loc_179_1_179_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_6&#39;)"><span class="mpre">edges</span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Edge</span></span><span class="mpre">]
</span><a name="loc_179_1_179_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_6&#39;)"><span class="hl_fundecl"><span class="mpre">edges</span></span></a><span class="mpre"> </span><a name="loc_179_7_179_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_7_179_8&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">   = [ (</span><a href="#loc_179_24_179_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_24_179_25&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">, </span><a href="#loc_179_41_179_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_41_179_42&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) | </span><a name="loc_179_24_179_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_24_179_25&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_175_1_175_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_9&#39;)"><span class="hl_varref"><span class="mpre">vertices</span></span></a><span class="mpre"> </span><a href="#loc_179_7_179_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_7_179_8&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">, </span><a name="loc_179_41_179_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_41_179_42&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_179_7_179_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_7_179_8&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><a href="#loc_179_24_179_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_24_179_25&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> ]

</span><a href="#loc_182_1_182_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_5&#39;)"><span class="mpre">mapT</span></a><span class="mpre">    :: (</span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Table</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Table</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_182_1_182_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_5&#39;)"><span class="hl_fundecl"><span class="mpre">mapT</span></span></a><span class="mpre"> </span><a name="loc_182_6_182_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_6_182_7&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_182_8_182_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_8_182_9&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">array</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">bounds</span></span><span class="mpre"> </span><a href="#loc_182_8_182_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_8_182_9&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) [ </span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> </span><a href="#loc_182_51_182_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_51_182_52&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (</span><a href="#loc_182_6_182_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_6_182_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_182_51_182_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_51_182_52&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (</span><a href="#loc_182_8_182_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_8_182_9&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><a href="#loc_182_51_182_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_51_182_52&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)) | </span><a name="loc_182_51_182_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_51_182_52&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">indices</span></span><span class="mpre"> </span><a href="#loc_182_8_182_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_8_182_9&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> ]

</span><span class="hl_comment"><span class="mpre">-- | Build a graph from a list of edges.</span></span><span class="mpre">
</span><a href="#loc_186_1_186_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_7&#39;)"><span class="mpre">buildG</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bounds</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Edge</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre">
</span><a name="loc_186_1_186_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_7&#39;)"><span class="hl_fundecl"><span class="mpre">buildG</span></span></a><span class="mpre"> </span><a name="loc_186_8_186_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_8_186_15&#39;)"><span class="hl_vardecl"><span class="mpre">bounds0</span></span></a><span class="mpre"> </span><a name="loc_186_16_186_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_16_186_22&#39;)"><span class="hl_vardecl"><span class="mpre">edges0</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">accumArray</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre">) [] </span><a href="#loc_186_8_186_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_8_186_15&#39;)"><span class="hl_varref"><span class="mpre">bounds0</span></span></a><span class="mpre"> </span><a href="#loc_186_16_186_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_16_186_22&#39;)"><span class="hl_varref"><span class="mpre">edges0</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The graph obtained by reversing all edges.</span></span><span class="mpre">
</span><a href="#loc_190_1_190_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_11&#39;)"><span class="mpre">transposeG</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre">
</span><a name="loc_190_1_190_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_11&#39;)"><span class="hl_fundecl"><span class="mpre">transposeG</span></span></a><span class="mpre"> </span><a name="loc_190_12_190_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_12_190_13&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_186_1_186_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_7&#39;)"><span class="hl_varref"><span class="mpre">buildG</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">bounds</span></span><span class="mpre"> </span><a href="#loc_190_12_190_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_12_190_13&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) (</span><a href="#loc_193_1_193_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_9&#39;)"><span class="hl_varref"><span class="mpre">reverseE</span></span></a><span class="mpre"> </span><a href="#loc_190_12_190_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_12_190_13&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)

</span><a href="#loc_193_1_193_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_9&#39;)"><span class="mpre">reverseE</span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Edge</span></span><span class="mpre">]
</span><a name="loc_193_1_193_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_9&#39;)"><span class="hl_fundecl"><span class="mpre">reverseE</span></span></a><span class="mpre"> </span><a name="loc_193_10_193_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_10_193_11&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">   = [ (</span><a href="#loc_193_31_193_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_31_193_32&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">, </span><a href="#loc_193_28_193_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_28_193_29&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) | (</span><a name="loc_193_28_193_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_28_193_29&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">, </span><a name="loc_193_31_193_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_31_193_32&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_179_1_179_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_6&#39;)"><span class="hl_varref"><span class="mpre">edges</span></span></a><span class="mpre"> </span><a href="#loc_193_10_193_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_10_193_11&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> ]

</span><span class="hl_comment"><span class="mpre">-- | A table of the count of edges from each node.</span></span><span class="mpre">
</span><a href="#loc_197_1_197_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_10&#39;)"><span class="mpre">outdegree</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Table</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_197_1_197_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_10&#39;)"><span class="hl_vardecl"><span class="mpre">outdegree</span></span></a><span class="mpre">  = </span><a href="#loc_182_1_182_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_5&#39;)"><span class="hl_varref"><span class="mpre">mapT</span></span></a><span class="mpre"> </span><a href="#loc_198_20_198_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_20_198_28&#39;)"><span class="hl_varref"><span class="mpre">numEdges</span></span></a><span class="mpre">
             where </span><a name="loc_198_20_198_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_20_198_28&#39;)"><span class="hl_fundecl"><span class="mpre">numEdges</span></span></a><span class="mpre"> _ </span><a name="loc_198_31_198_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_31_198_33&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_198_31_198_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_31_198_33&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A table of the count of edges into each node.</span></span><span class="mpre">
</span><a href="#loc_202_1_202_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_9&#39;)"><span class="mpre">indegree</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Table</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_202_1_202_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_9&#39;)"><span class="hl_vardecl"><span class="mpre">indegree</span></span></a><span class="mpre">  = </span><a href="#loc_197_1_197_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_10&#39;)"><span class="hl_varref"><span class="mpre">outdegree</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_190_1_190_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_11&#39;)"><span class="hl_varref"><span class="mpre">transposeG</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Identical to &#39;graphFromEdges&#39;, except that the return value</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- does not include the function which maps keys to vertices.  This</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- version of &#39;graphFromEdges&#39; is for backwards compatibility.</span></span><span class="mpre">
</span><a href="#loc_211_1_211_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_1_211_16&#39;)"><span class="mpre">graphFromEdges&#39;</span></a><span class="mpre">
        :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 208, srcSpanStartColumn = 12, srcSpanEndLine = 209, srcSpanEndColumn = 11}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 209, srcSpanStartColumn = 9, srcSpanEndLine = 209, srcSpanEndColumn = 11}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5."><span class="mpre">Ord key
        =&gt;</span></span><span class="mpre"> [(</span><span class="hl_tyvar"><span class="mpre">node</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre">, [</span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre">])]
        -&gt; (</span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">node</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre">, [</span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre">]))
</span><a name="loc_211_1_211_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_1_211_16&#39;)"><span class="hl_fundecl"><span class="mpre">graphFromEdges&#39;</span></span></a><span class="mpre"> </span><a name="loc_211_17_211_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_17_211_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = (</span><a href="#loc_212_6_212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_6_212_7&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_212_8_212_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_8_212_9&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) where
    (</span><a name="loc_212_6_212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_6_212_7&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_212_8_212_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_8_212_9&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">,_) = </span><a href="#loc_222_1_222_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_15&#39;)"><span class="hl_varref"><span class="mpre">graphFromEdges</span></span></a><span class="mpre"> </span><a href="#loc_211_17_211_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_17_211_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Build a graph from a list of nodes uniquely identified by keys,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with a list of keys of nodes this node should have edges to.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The out-list may contain keys that don&#39;t correspond to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- nodes of the graph; they are ignored.</span></span><span class="mpre">
</span><a href="#loc_222_1_222_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_15&#39;)"><span class="mpre">graphFromEdges</span></a><span class="mpre">
        :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 219, srcSpanStartColumn = 12, srcSpanEndLine = 220, srcSpanEndColumn = 11}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 220, srcSpanStartColumn = 9, srcSpanEndLine = 220, srcSpanEndColumn = 11}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5."><span class="mpre">Ord key
        =&gt;</span></span><span class="mpre"> [(</span><span class="hl_tyvar"><span class="mpre">node</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre">, [</span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre">])]
        -&gt; (</span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">node</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre">, [</span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre">]), </span><span class="hl_tyvar"><span class="mpre">key</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">)
</span><a name="loc_222_1_222_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_15&#39;)"><span class="hl_fundecl"><span class="mpre">graphFromEdges</span></span></a><span class="mpre"> </span><a name="loc_222_16_222_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_16_222_22&#39;)"><span class="hl_vardecl"><span class="mpre">edges0</span></span></a><span class="mpre">
  = (</span><a href="#loc_230_5_230_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_5_230_10&#39;)"><span class="hl_varref"><span class="mpre">graph</span></span></a><span class="mpre">, \</span><a name="loc_223_14_223_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_14_223_15&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_232_5_232_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_5_232_15&#39;)"><span class="hl_varref"><span class="mpre">vertex_map</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!</span></span><span class="mpre"> </span><a href="#loc_223_14_223_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_14_223_15&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">, </span><a href="#loc_238_5_238_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_5_238_15&#39;)"><span class="hl_varref"><span class="mpre">key_vertex</span></span></a><span class="mpre">)
  where
    </span><a name="loc_225_5_225_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_5_225_10&#39;)"><span class="hl_vardecl"><span class="mpre">max_v</span></span></a><span class="mpre">           = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_222_16_222_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_16_222_22&#39;)"><span class="hl_varref"><span class="mpre">edges0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    </span><a name="loc_226_5_226_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_5_226_12&#39;)"><span class="hl_vardecl"><span class="mpre">bounds0</span></span></a><span class="mpre">         = (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><a href="#loc_225_5_225_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_5_225_10&#39;)"><span class="hl_varref"><span class="mpre">max_v</span></span></a><span class="mpre">) :: (</span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">)
    </span><a name="loc_227_5_227_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_5_227_17&#39;)"><span class="hl_vardecl"><span class="mpre">sorted_edges</span></span></a><span class="mpre">    = </span><a href="Data.List.html#loc_810_1_810_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_810_1_810_7&#39;)"><span class="hl_varref"><span class="mpre">sortBy</span></span></a><span class="mpre"> </span><a href="#loc_234_14_234_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_14_234_18&#39;)"><span class="hl_varref"><span class="mpre">lt</span></span></a><span class="mpre"> </span><a href="#loc_222_16_222_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_16_222_22&#39;)"><span class="hl_varref"><span class="mpre">edges0</span></span></a><span class="mpre">
    </span><a name="loc_228_5_228_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_5_228_11&#39;)"><span class="hl_vardecl"><span class="mpre">edges1</span></span></a><span class="mpre">          = </span><span class="hl_varref"><span class="mpre">zipWith</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 228, srcSpanStartColumn = 35, srcSpanEndLine = 228, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 228, srcSpanStartColumn = 35, srcSpanEndLine = 228, srcSpanEndColumn = 36},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 2"><span class="mpre">[0..]</span></span><span class="mpre"> </span><a href="#loc_227_5_227_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_5_227_17&#39;)"><span class="hl_varref"><span class="mpre">sorted_edges</span></span></a><span class="mpre">

    </span><a name="loc_230_5_230_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_5_230_10&#39;)"><span class="hl_vardecl"><span class="mpre">graph</span></span></a><span class="mpre">           = </span><span class="hl_varref"><span class="mpre">array</span></span><span class="mpre"> </span><a href="#loc_226_5_226_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_5_226_12&#39;)"><span class="hl_varref"><span class="mpre">bounds0</span></span></a><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> </span><a href="#loc_230_75_230_76" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_75_230_76&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_123_1_123_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_123_1_123_9&#39;)"><span class="hl_varref"><span class="mpre">mapMaybe</span></span></a><span class="mpre"> </span><a href="#loc_238_5_238_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_5_238_15&#39;)"><span class="hl_varref"><span class="mpre">key_vertex</span></span></a><span class="mpre"> </span><a href="#loc_230_87_230_89" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_87_230_89&#39;)"><span class="hl_varref"><span class="mpre">ks</span></span></a><span class="mpre">) | </span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> </span><a name="loc_230_75_230_76" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_75_230_76&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> (_,    _, </span><a name="loc_230_87_230_89" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_87_230_89&#39;)"><span class="hl_vardecl"><span class="mpre">ks</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_228_5_228_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_5_228_11&#39;)"><span class="hl_varref"><span class="mpre">edges1</span></span></a><span class="mpre">]
    </span><a name="loc_231_5_231_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_5_231_12&#39;)"><span class="hl_vardecl"><span class="mpre">key_map</span></span></a><span class="mpre">         = </span><span class="hl_varref"><span class="mpre">array</span></span><span class="mpre"> </span><a href="#loc_226_5_226_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_5_226_12&#39;)"><span class="hl_varref"><span class="mpre">bounds0</span></span></a><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> </span><a href="#loc_231_74_231_75" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_74_231_75&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_231_83_231_84" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_83_231_84&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">                       | </span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> </span><a name="loc_231_74_231_75" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_74_231_75&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> (_,    </span><a name="loc_231_83_231_84" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_83_231_84&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">, _ ) &lt;- </span><a href="#loc_228_5_228_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_5_228_11&#39;)"><span class="hl_varref"><span class="mpre">edges1</span></span></a><span class="mpre">]
    </span><a name="loc_232_5_232_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_5_232_15&#39;)"><span class="hl_vardecl"><span class="mpre">vertex_map</span></span></a><span class="mpre">      = </span><span class="hl_varref"><span class="mpre">array</span></span><span class="mpre"> </span><a href="#loc_226_5_226_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_5_226_12&#39;)"><span class="hl_varref"><span class="mpre">bounds0</span></span></a><span class="mpre"> </span><a href="#loc_228_5_228_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_5_228_11&#39;)"><span class="hl_varref"><span class="mpre">edges1</span></span></a><span class="mpre">

    (_,</span><a name="loc_234_8_234_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_8_234_10&#39;)"><span class="hl_vardecl"><span class="mpre">k1</span></span></a><span class="mpre">,_) </span><a name="loc_234_14_234_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_14_234_18&#39;)"><span class="hl_fundecl"><span class="mpre">`lt`</span></span></a><span class="mpre"> (_,</span><a name="loc_234_22_234_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_22_234_24&#39;)"><span class="hl_vardecl"><span class="mpre">k2</span></span></a><span class="mpre">,_) = </span><a href="#loc_234_8_234_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_8_234_10&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`compare`</span></span><span class="mpre"> </span><a href="#loc_234_22_234_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_22_234_24&#39;)"><span class="hl_varref"><span class="mpre">k2</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- key_vertex :: key -&gt; Maybe Vertex</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--  returns Nothing for non-interesting vertices</span></span><span class="mpre">
    </span><a name="loc_238_5_238_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_5_238_15&#39;)"><span class="hl_fundecl"><span class="mpre">key_vertex</span></span></a><span class="mpre"> </span><a name="loc_238_16_238_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_16_238_17&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">   = </span><a href="#loc_240_22_240_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_22_240_32&#39;)"><span class="hl_varref"><span class="mpre">findVertex</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_225_5_225_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_5_225_10&#39;)"><span class="hl_varref"><span class="mpre">max_v</span></span></a><span class="mpre">
                   where
                     </span><a name="loc_240_22_240_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_22_240_32&#39;)"><span class="hl_fundecl"><span class="mpre">findVertex</span></span></a><span class="mpre"> </span><a name="loc_240_33_240_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_33_240_34&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_240_35_240_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_35_240_36&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> | </span><a href="#loc_240_33_240_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_33_240_34&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_240_35_240_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_35_240_36&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                              = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
                     </span><a href="#loc_240_22_240_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_22_240_32&#39;)"><span class="hl_fundecl"><span class="mpre">findVertex</span></span></a><span class="mpre"> </span><a name="loc_242_33_242_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_33_242_34&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_242_35_242_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_35_242_36&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_238_16_238_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_16_238_17&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_231_5_231_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_5_231_12&#39;)"><span class="hl_varref"><span class="mpre">key_map</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!</span></span><span class="mpre"> </span><a href="#loc_247_33_247_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_33_247_36&#39;)"><span class="hl_varref"><span class="mpre">mid</span></span></a><span class="mpre">) of
                                   </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; </span><a href="#loc_240_22_240_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_22_240_32&#39;)"><span class="hl_varref"><span class="mpre">findVertex</span></span></a><span class="mpre"> </span><a href="#loc_242_33_242_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_33_242_34&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_247_33_247_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_33_247_36&#39;)"><span class="hl_varref"><span class="mpre">mid</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                                   </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_247_33_247_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_33_247_36&#39;)"><span class="hl_varref"><span class="mpre">mid</span></span></a><span class="mpre">
                                   </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; </span><a href="#loc_240_22_240_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_22_240_32&#39;)"><span class="hl_varref"><span class="mpre">findVertex</span></span></a><span class="mpre"> (</span><a href="#loc_247_33_247_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_33_247_36&#39;)"><span class="hl_varref"><span class="mpre">mid</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_242_35_242_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_35_242_36&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                              where
                                </span><a name="loc_247_33_247_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_33_247_36&#39;)"><span class="hl_vardecl"><span class="mpre">mid</span></span></a><span class="mpre"> = (</span><a href="#loc_242_33_242_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_33_242_34&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_242_35_242_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_35_242_36&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                                                      -</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      Depth first search</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                                                      -</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A spanning forest of the graph, obtained from a depth-first search of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the graph starting from each vertex in an unspecified order.</span></span><span class="mpre">
</span><a href="#loc_258_1_258_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_1_258_4&#39;)"><span class="mpre">dff</span></a><span class="mpre">          :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Forest</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">
</span><a name="loc_258_1_258_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_1_258_4&#39;)"><span class="hl_fundecl"><span class="mpre">dff</span></span></a><span class="mpre"> </span><a name="loc_258_5_258_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_5_258_6&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">         = </span><a href="#loc_264_1_264_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_4&#39;)"><span class="hl_varref"><span class="mpre">dfs</span></span></a><span class="mpre"> </span><a href="#loc_258_5_258_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_5_258_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> (</span><a href="#loc_175_1_175_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_9&#39;)"><span class="hl_varref"><span class="mpre">vertices</span></span></a><span class="mpre"> </span><a href="#loc_258_5_258_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_5_258_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | A spanning forest of the part of the graph reachable from the listed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- vertices, obtained from a depth-first search of the graph starting at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- each of the listed vertices in order.</span></span><span class="mpre">
</span><a href="#loc_264_1_264_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_4&#39;)"><span class="mpre">dfs</span></a><span class="mpre">          :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Forest</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">
</span><a name="loc_264_1_264_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_4&#39;)"><span class="hl_fundecl"><span class="mpre">dfs</span></span></a><span class="mpre"> </span><a name="loc_264_5_264_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_5_264_6&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_264_7_264_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_7_264_9&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre">      = </span><a href="#loc_270_1_270_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_1_270_6&#39;)"><span class="hl_varref"><span class="mpre">prune</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">bounds</span></span><span class="mpre"> </span><a href="#loc_264_5_264_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_5_264_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_267_1_267_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_9&#39;)"><span class="hl_varref"><span class="mpre">generate</span></span></a><span class="mpre"> </span><a href="#loc_264_5_264_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_5_264_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) </span><a href="#loc_264_7_264_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_7_264_9&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">)

</span><a href="#loc_267_1_267_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_9&#39;)"><span class="mpre">generate</span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">
</span><a name="loc_267_1_267_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_9&#39;)"><span class="hl_fundecl"><span class="mpre">generate</span></span></a><span class="mpre"> </span><a name="loc_267_10_267_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_10_267_11&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_267_12_267_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_12_267_13&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> </span><a href="#loc_267_12_267_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_12_267_13&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_267_1_267_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_1_267_9&#39;)"><span class="hl_varref"><span class="mpre">generate</span></span></a><span class="mpre"> </span><a href="#loc_267_10_267_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_10_267_11&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) (</span><a href="#loc_267_10_267_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_10_267_11&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><a href="#loc_267_12_267_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_12_267_13&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">))

</span><a href="#loc_270_1_270_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_1_270_6&#39;)"><span class="mpre">prune</span></a><span class="mpre">        :: </span><span class="hl_tyconref"><span class="mpre">Bounds</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Forest</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Forest</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">
</span><a name="loc_270_1_270_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_1_270_6&#39;)"><span class="hl_fundecl"><span class="mpre">prune</span></span></a><span class="mpre"> </span><a name="loc_270_7_270_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_7_270_11&#39;)"><span class="hl_vardecl"><span class="mpre">bnds</span></span></a><span class="mpre"> </span><a name="loc_270_12_270_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_12_270_14&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre"> = </span><a href="#loc_312_1_312_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> </span><a href="#loc_270_7_270_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_7_270_11&#39;)"><span class="hl_varref"><span class="mpre">bnds</span></span></a><span class="mpre"> (</span><a href="#loc_273_1_273_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_5&#39;)"><span class="hl_varref"><span class="mpre">chop</span></span></a><span class="mpre"> </span><a href="#loc_270_12_270_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_12_270_14&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">)

</span><a href="#loc_273_1_273_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_5&#39;)"><span class="mpre">chop</span></a><span class="mpre">         :: </span><span class="hl_tyconref"><span class="mpre">Forest</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; </span><a href="#loc_290_9_290_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_13&#39;)"><span class="hl_tyconref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Forest</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">)
</span><a name="loc_273_1_273_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_5&#39;)"><span class="hl_fundecl"><span class="mpre">chop</span></span></a><span class="mpre"> []       = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
</span><a href="#loc_273_1_273_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_5&#39;)"><span class="hl_fundecl"><span class="mpre">chop</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> </span><a name="loc_274_12_274_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_12_274_13&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_274_14_274_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_14_274_16&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_274_19_274_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_19_274_21&#39;)"><span class="hl_vardecl"><span class="mpre">us</span></span></a><span class="mpre">)
              = do
                </span><a name="loc_276_17_276_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_17_276_24&#39;)"><span class="hl_vardecl"><span class="mpre">visited</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_315_1_315_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_1_315_9&#39;)"><span class="hl_varref"><span class="mpre">contains</span></span></a><span class="mpre"> </span><a href="#loc_274_12_274_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_12_274_13&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
                if </span><a href="#loc_276_17_276_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_17_276_24&#39;)"><span class="hl_varref"><span class="mpre">visited</span></span></a><span class="mpre"> then
                  </span><a href="#loc_273_1_273_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_5&#39;)"><span class="hl_varref"><span class="mpre">chop</span></span></a><span class="mpre"> </span><a href="#loc_274_19_274_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_19_274_21&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">
                 else do
                  </span><a href="#loc_318_1_318_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_1_318_8&#39;)"><span class="hl_varref"><span class="mpre">include</span></span></a><span class="mpre"> </span><a href="#loc_274_12_274_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_12_274_13&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
                  </span><a name="loc_281_19_281_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_19_281_21&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_273_1_273_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_5&#39;)"><span class="hl_varref"><span class="mpre">chop</span></span></a><span class="mpre"> </span><a href="#loc_274_14_274_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_14_274_16&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
                  </span><a name="loc_282_19_282_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_19_282_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_273_1_273_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_5&#39;)"><span class="hl_varref"><span class="mpre">chop</span></span></a><span class="mpre"> </span><a href="#loc_274_19_274_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_19_274_21&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">
                  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> </span><a href="#loc_274_12_274_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_12_274_13&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_281_19_281_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_19_281_21&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_282_19_282_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_19_282_21&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- A monad holding a set of vertices visited so far.</span></span><span class="mpre">
#if USE_ST_MONAD

</span><span class="hl_comment"><span class="mpre">-- Use the ST monad if available, for constant-time primitives.</span></span><span class="mpre">

newtype </span><a name="loc_290_9_290_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_13&#39;)"><span class="hl_tycondecl"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_condecl"><span class="mpre">SetM</span></span></a><span class="mpre"> { </span><a name="loc_290_27_290_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_27_290_34&#39;)"><span class="hl_fielddecl"><span class="mpre">runSetM</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">STArray</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> }

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> (</span><a href="#loc_290_9_290_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_13&#39;)"><span class="hl_tyconref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
    </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_293_12_293_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_12_293_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">     = </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_293_12_293_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_12_293_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE return #-}</span></span><span class="mpre">
    </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><a name="loc_295_10_295_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_10_295_11&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_295_16_295_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_16_295_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_295_28_295_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_28_295_29&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; do { </span><a name="loc_295_38_295_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_38_295_39&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_295_10_295_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_10_295_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_295_28_295_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_28_295_29&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">; </span><a href="#loc_290_27_290_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_27_290_34&#39;)"><span class="hl_varref"><span class="mpre">runSetM</span></span></a><span class="mpre"> (</span><a href="#loc_295_16_295_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_16_295_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_295_38_295_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_38_295_39&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_295_28_295_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_28_295_29&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> }
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE (&gt;&gt;=) #-}</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> (</span><a href="#loc_290_9_290_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_13&#39;)"><span class="hl_tyconref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
    </span><a name="loc_299_5_299_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_5_299_6&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><a name="loc_299_19_299_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_19_299_20&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_299_31_299_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_31_299_32&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_299_5_299_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_5_299_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="#loc_299_19_299_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_19_299_20&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_299_31_299_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_31_299_32&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE fmap #-}</span></span><span class="mpre">

instance </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> (</span><a href="#loc_290_9_290_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_13&#39;)"><span class="hl_tyconref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
    </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_fundecl"><span class="mpre">pure</span></span></a><span class="mpre"> </span><a name="loc_303_10_303_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_10_303_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_303_10_303_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_10_303_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="mpre">pure</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><a name="loc_305_10_305_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_10_305_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><a name="loc_305_21_305_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_21_305_22&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_305_33_305_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_33_305_34&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_305_10_305_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_10_305_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_305_33_305_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_33_305_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="#loc_305_21_305_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_21_305_22&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_305_33_305_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_33_305_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
    </span><span class="hl_comment"><span class="mpre">-- We could also use the following definition</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   SetM f &lt;*&gt; SetM v = SetM $ \s -&gt; f s &lt;*&gt; v s</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- but Applicative (ST s) instance is present only in GHC 7.2+</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="mpre">(&lt;*&gt;)</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_312_1_312_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_4&#39;)"><span class="mpre">run</span></a><span class="mpre">          :: </span><span class="hl_tyconref"><span class="mpre">Bounds</span></span><span class="mpre"> -&gt; (forall </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">. </span><a href="#loc_290_9_290_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_13&#39;)"><span class="hl_tyconref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_312_1_312_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_4&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> </span><a name="loc_312_5_312_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_5_312_9&#39;)"><span class="hl_vardecl"><span class="mpre">bnds</span></span></a><span class="mpre"> </span><a name="loc_312_10_312_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_10_312_13&#39;)"><span class="hl_vardecl"><span class="mpre">act</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">runST</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">newArray</span></span><span class="mpre"> </span><a href="#loc_312_5_312_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_5_312_9&#39;)"><span class="hl_varref"><span class="mpre">bnds</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_290_27_290_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_27_290_34&#39;)"><span class="hl_varref"><span class="mpre">runSetM</span></span></a><span class="mpre"> </span><a href="#loc_312_10_312_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_10_312_13&#39;)"><span class="hl_varref"><span class="mpre">act</span></span></a><span class="mpre">)

</span><a href="#loc_315_1_315_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_1_315_9&#39;)"><span class="mpre">contains</span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; </span><a href="#loc_290_9_290_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_13&#39;)"><span class="hl_tyconref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_315_1_315_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_1_315_9&#39;)"><span class="hl_fundecl"><span class="mpre">contains</span></span></a><span class="mpre"> </span><a name="loc_315_10_315_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_10_315_11&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">    = </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_315_26_315_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_26_315_27&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">readArray</span></span><span class="mpre"> </span><a href="#loc_315_26_315_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_26_315_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_315_10_315_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_10_315_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><a href="#loc_318_1_318_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_1_318_8&#39;)"><span class="mpre">include</span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; </span><a href="#loc_290_9_290_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_13&#39;)"><span class="hl_tyconref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_318_1_318_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_1_318_8&#39;)"><span class="hl_fundecl"><span class="mpre">include</span></span></a><span class="mpre"> </span><a name="loc_318_9_318_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_9_318_10&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">     = </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_318_26_318_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_26_318_27&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">writeArray</span></span><span class="mpre"> </span><a href="#loc_318_26_318_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_26_318_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_318_9_318_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_9_318_10&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

#else /* !USE_ST_MONAD */

</span><span class="hl_comment"><span class="mpre">-- Portable implementation using IntSet.</span></span><span class="mpre">

newtype </span><span class="hl_tycondecl"><span class="mpre">SetM</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">SetM</span></span><span class="mpre"> { </span><span class="hl_fielddecl"><span class="mpre">runSetM</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IntSet</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">IntSet</span></span><span class="mpre">) }

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> (</span><a href="#loc_290_9_290_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_13&#39;)"><span class="hl_tyconref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
    </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_327_12_327_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_12_327_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">     = </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_327_28_327_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_28_327_29&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_327_12_327_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_12_327_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_327_28_327_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_28_327_29&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
    </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><a name="loc_328_10_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_10_328_11&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_328_16_328_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_16_328_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_328_28_328_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_28_328_29&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_328_10_328_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_10_328_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_328_28_328_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_28_328_29&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of (</span><a name="loc_328_46_328_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_46_328_47&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_328_49_328_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_49_328_51&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_290_27_290_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_27_290_34&#39;)"><span class="hl_varref"><span class="mpre">runSetM</span></span></a><span class="mpre"> (</span><a href="#loc_328_16_328_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_16_328_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_328_46_328_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_46_328_47&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_328_49_328_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_49_328_51&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> (</span><a href="#loc_290_9_290_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_13&#39;)"><span class="hl_tyconref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
    </span><a name="loc_331_5_331_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_6&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><a name="loc_331_19_331_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_19_331_20&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_331_31_331_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_31_331_32&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_331_19_331_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_19_331_20&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_331_31_331_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_31_331_32&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of (</span><a name="loc_331_49_331_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_49_331_50&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_331_52_331_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_52_331_54&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_331_5_331_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_5_331_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_331_49_331_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_49_331_50&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_331_52_331_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_52_331_54&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">)
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE fmap #-}</span></span><span class="mpre">

instance </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> (</span><a href="#loc_290_9_290_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_13&#39;)"><span class="hl_tyconref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) where
    </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_fundecl"><span class="mpre">pure</span></span></a><span class="mpre"> </span><a name="loc_335_10_335_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_10_335_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_335_22_335_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_22_335_23&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_335_10_335_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_10_335_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_335_22_335_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_22_335_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="mpre">pure</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><a name="loc_337_10_337_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_10_337_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><a name="loc_337_21_337_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_21_337_22&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_337_33_337_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_33_337_34&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_337_10_337_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_10_337_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_337_33_337_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_33_337_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of (</span><a name="loc_337_51_337_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_51_337_52&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">, </span><a name="loc_337_54_337_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_54_337_56&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) -&gt; case </span><a href="#loc_337_21_337_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_21_337_22&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_337_54_337_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_54_337_56&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> of (</span><a name="loc_337_75_337_76" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_75_337_76&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_337_78_337_81" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_78_337_81&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;&#39;</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_337_51_337_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_51_337_52&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_337_75_337_76" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_75_337_76&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_337_78_337_81" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_78_337_81&#39;)"><span class="hl_varref"><span class="mpre">s&#39;&#39;</span></span></a><span class="mpre">)
    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="mpre">(&lt;*&gt;)</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_312_1_312_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_4&#39;)"><span class="mpre">run</span></a><span class="mpre">          :: </span><span class="hl_tyconref"><span class="mpre">Bounds</span></span><span class="mpre"> -&gt; </span><a href="#loc_290_9_290_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_13&#39;)"><span class="hl_tyconref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_fundecl"><span class="mpre">run</span></span><span class="mpre"> _ </span><a name="loc_341_7_341_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_7_341_10&#39;)"><span class="hl_vardecl"><span class="mpre">act</span></span></a><span class="mpre">     = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> (</span><a href="#loc_290_27_290_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_27_290_34&#39;)"><span class="hl_varref"><span class="mpre">runSetM</span></span></a><span class="mpre"> </span><a href="#loc_341_7_341_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_7_341_10&#39;)"><span class="hl_varref"><span class="mpre">act</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Set.empty</span></span><span class="mpre">)

</span><a href="#loc_315_1_315_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_1_315_9&#39;)"><span class="mpre">contains</span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; </span><a href="#loc_290_9_290_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_13&#39;)"><span class="hl_tyconref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><span class="hl_fundecl"><span class="mpre">contains</span></span><span class="mpre"> </span><a name="loc_344_10_344_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_10_344_11&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">    = </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_344_26_344_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_26_344_27&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">Set.member</span></span><span class="mpre"> </span><a href="#loc_344_10_344_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_10_344_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_344_26_344_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_26_344_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">, </span><a href="#loc_344_26_344_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_26_344_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)

</span><a href="#loc_318_1_318_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_1_318_8&#39;)"><span class="mpre">include</span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; </span><a href="#loc_290_9_290_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_9_290_13&#39;)"><span class="hl_tyconref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><span class="hl_fundecl"><span class="mpre">include</span></span><span class="mpre"> </span><a name="loc_347_9_347_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_9_347_10&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">     = </span><a href="#loc_290_20_290_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_290_20_290_24&#39;)"><span class="hl_conref"><span class="mpre">SetM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_347_26_347_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_26_347_27&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">Set.insert</span></span><span class="mpre"> </span><a href="#loc_347_9_347_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_9_347_10&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_347_26_347_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_26_347_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)

#endif /* !USE_ST_MONAD */

</span><span class="hl_comment"><span class="mpre">-------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                                                      -</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      Algorithms</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                                                      -</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Algorithm 1: depth first search numbering</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_362_1_362_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_10&#39;)"><span class="mpre">preorder&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_362_1_362_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_10&#39;)"><span class="hl_fundecl"><span class="mpre">preorder&#39;</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> </span><a name="loc_362_17_362_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_17_362_18&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_362_19_362_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_19_362_21&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">) = (</span><a href="#loc_362_17_362_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_17_362_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_365_1_365_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_11&#39;)"><span class="hl_varref"><span class="mpre">preorderF&#39;</span></span></a><span class="mpre"> </span><a href="#loc_362_19_362_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_19_362_21&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">

</span><a href="#loc_365_1_365_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_11&#39;)"><span class="mpre">preorderF&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Forest</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_365_1_365_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_11&#39;)"><span class="hl_fundecl"><span class="mpre">preorderF&#39;</span></span></a><span class="mpre"> </span><a name="loc_365_12_365_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_12_365_14&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_362_1_362_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_1_362_10&#39;)"><span class="hl_varref"><span class="mpre">preorder&#39;</span></span></a><span class="mpre"> </span><a href="#loc_365_12_365_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_12_365_14&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">

</span><a href="#loc_368_1_368_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_1_368_10&#39;)"><span class="mpre">preorderF</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Forest</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_368_1_368_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_1_368_10&#39;)"><span class="hl_fundecl"><span class="mpre">preorderF</span></span></a><span class="mpre"> </span><a name="loc_368_11_368_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_11_368_13&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre"> = </span><a href="#loc_365_1_365_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_11&#39;)"><span class="hl_varref"><span class="mpre">preorderF&#39;</span></span></a><span class="mpre"> </span><a href="#loc_368_11_368_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_11_368_13&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre"> []

</span><a href="#loc_371_1_371_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_9&#39;)"><span class="mpre">tabulate</span></a><span class="mpre">        :: </span><span class="hl_tyconref"><span class="mpre">Bounds</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Table</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_371_1_371_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_9&#39;)"><span class="hl_fundecl"><span class="mpre">tabulate</span></span></a><span class="mpre"> </span><a name="loc_371_10_371_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_10_371_14&#39;)"><span class="hl_vardecl"><span class="mpre">bnds</span></span></a><span class="mpre"> </span><a name="loc_371_15_371_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_15_371_17&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">array</span></span><span class="mpre"> </span><a href="#loc_371_10_371_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_10_371_14&#39;)"><span class="hl_varref"><span class="mpre">bnds</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">zipWith</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> </span><a href="#loc_371_15_371_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_15_371_17&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 371, srcSpanStartColumn = 47, srcSpanEndLine = 371, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 371, srcSpanStartColumn = 47, srcSpanEndLine = 371, srcSpanEndColumn = 48},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/containers-0.5.5.1/Data/Graph.hs&quot;, srcSpanStartLine = 3"><span class="mpre">[1..]</span></span><span class="mpre">)

</span><a href="#loc_374_1_374_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_7&#39;)"><span class="mpre">preArr</span></a><span class="mpre">          :: </span><span class="hl_tyconref"><span class="mpre">Bounds</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Forest</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Table</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_374_1_374_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_7&#39;)"><span class="hl_fundecl"><span class="mpre">preArr</span></span></a><span class="mpre"> </span><a name="loc_374_8_374_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_8_374_12&#39;)"><span class="hl_vardecl"><span class="mpre">bnds</span></span></a><span class="mpre">      = </span><a href="#loc_371_1_371_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_9&#39;)"><span class="hl_varref"><span class="mpre">tabulate</span></span></a><span class="mpre"> </span><a href="#loc_374_8_374_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_8_374_12&#39;)"><span class="hl_varref"><span class="mpre">bnds</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_368_1_368_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_1_368_10&#39;)"><span class="hl_varref"><span class="mpre">preorderF</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Algorithm 2: topological sorting</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_381_1_381_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_10&#39;)"><span class="mpre">postorder</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_381_1_381_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_10&#39;)"><span class="hl_fundecl"><span class="mpre">postorder</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> </span><a name="loc_381_17_381_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_17_381_18&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_381_19_381_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_19_381_21&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">) = </span><a href="#loc_384_1_384_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_1_384_11&#39;)"><span class="hl_varref"><span class="mpre">postorderF</span></span></a><span class="mpre"> </span><a href="#loc_381_19_381_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_19_381_21&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_381_17_381_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_17_381_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)

</span><a href="#loc_384_1_384_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_1_384_11&#39;)"><span class="mpre">postorderF</span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Forest</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_384_1_384_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_1_384_11&#39;)"><span class="hl_fundecl"><span class="mpre">postorderF</span></span></a><span class="mpre"> </span><a name="loc_384_12_384_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_12_384_14&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_381_1_381_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_1_381_10&#39;)"><span class="hl_varref"><span class="mpre">postorder</span></span></a><span class="mpre"> </span><a href="#loc_384_12_384_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_12_384_14&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">

</span><a href="#loc_387_1_387_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_8&#39;)"><span class="mpre">postOrd</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">]
</span><a name="loc_387_1_387_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_8&#39;)"><span class="hl_fundecl"><span class="mpre">postOrd</span></span></a><span class="mpre"> </span><a name="loc_387_9_387_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_9_387_10&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_384_1_384_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_1_384_11&#39;)"><span class="hl_varref"><span class="mpre">postorderF</span></span></a><span class="mpre"> (</span><a href="#loc_258_1_258_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_1_258_4&#39;)"><span class="hl_varref"><span class="mpre">dff</span></span></a><span class="mpre"> </span><a href="#loc_387_9_387_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_9_387_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) []

</span><span class="hl_comment"><span class="mpre">-- | A topological sort of the graph.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The order is partially specified by the condition that a vertex /i/</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- precedes /j/ whenever /j/ is reachable from /i/ but not vice versa.</span></span><span class="mpre">
</span><a href="#loc_393_1_393_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_1_393_8&#39;)"><span class="mpre">topSort</span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">]
</span><a name="loc_393_1_393_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_1_393_8&#39;)"><span class="hl_vardecl"><span class="mpre">topSort</span></span></a><span class="mpre">       = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_387_1_387_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_8&#39;)"><span class="hl_varref"><span class="mpre">postOrd</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Algorithm 3: connected components</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The connected components of a graph.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Two vertices are connected if there is a path between them, traversing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- edges in either direction.</span></span><span class="mpre">
</span><a href="#loc_403_1_403_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_1_403_11&#39;)"><span class="mpre">components</span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Forest</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">
</span><a name="loc_403_1_403_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_1_403_11&#39;)"><span class="hl_vardecl"><span class="mpre">components</span></span></a><span class="mpre">    = </span><a href="#loc_258_1_258_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_1_258_4&#39;)"><span class="hl_varref"><span class="mpre">dff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_406_1_406_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_1_406_11&#39;)"><span class="hl_varref"><span class="mpre">undirected</span></span></a><span class="mpre">

</span><a href="#loc_406_1_406_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_1_406_11&#39;)"><span class="mpre">undirected</span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre">
</span><a name="loc_406_1_406_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_1_406_11&#39;)"><span class="hl_fundecl"><span class="mpre">undirected</span></span></a><span class="mpre"> </span><a name="loc_406_12_406_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_12_406_13&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">  = </span><a href="#loc_186_1_186_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_7&#39;)"><span class="hl_varref"><span class="mpre">buildG</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">bounds</span></span><span class="mpre"> </span><a href="#loc_406_12_406_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_12_406_13&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) (</span><a href="#loc_179_1_179_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_6&#39;)"><span class="hl_varref"><span class="mpre">edges</span></span></a><span class="mpre"> </span><a href="#loc_406_12_406_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_12_406_13&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_193_1_193_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_1_193_9&#39;)"><span class="hl_varref"><span class="mpre">reverseE</span></span></a><span class="mpre"> </span><a href="#loc_406_12_406_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_12_406_13&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Algorithm 4: strongly connected components</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The strongly connected components of a graph.</span></span><span class="mpre">
</span><a href="#loc_412_1_412_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_1_412_4&#39;)"><span class="mpre">scc</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Forest</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">
</span><a name="loc_412_1_412_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_1_412_4&#39;)"><span class="hl_fundecl"><span class="mpre">scc</span></span></a><span class="mpre"> </span><a name="loc_412_5_412_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_5_412_6&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_264_1_264_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_4&#39;)"><span class="hl_varref"><span class="mpre">dfs</span></span></a><span class="mpre"> </span><a href="#loc_412_5_412_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_5_412_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> (</span><a href="#loc_387_1_387_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_8&#39;)"><span class="hl_varref"><span class="mpre">postOrd</span></span></a><span class="mpre"> (</span><a href="#loc_190_1_190_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_1_190_11&#39;)"><span class="hl_varref"><span class="mpre">transposeG</span></span></a><span class="mpre"> </span><a href="#loc_412_5_412_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_5_412_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)))

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Algorithm 5: Classifying edges</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
XXX unused code

tree              :: Bounds -&gt; Forest Vertex -&gt; Graph
tree bnds ts       = buildG bnds (concat (map flat ts))
 where flat (Node v ts&#39;) = [ (v, w) | Node w _us &lt;- ts&#39; ]
                        ++ concat (map flat ts&#39;)

back              :: Graph -&gt; Table Int -&gt; Graph
back g post        = mapT select g
 where select v ws = [ w | w &lt;- ws, post!v &lt; post!w ]

cross             :: Graph -&gt; Table Int -&gt; Table Int -&gt; Graph
cross g pre post   = mapT select g
 where select v ws = [ w | w &lt;- ws, post!v &gt; post!w, pre!v &gt; pre!w ]

forward           :: Graph -&gt; Graph -&gt; Table Int -&gt; Graph
forward g tree&#39; pre = mapT select g
 where select v ws = [ w | w &lt;- ws, pre!v &lt; pre!w ] \\ tree&#39; ! v
-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Algorithm 6: Finding reachable vertices</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A list of vertices reachable from a given vertex.</span></span><span class="mpre">
</span><a href="#loc_445_1_445_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_1_445_10&#39;)"><span class="mpre">reachable</span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">]
</span><a name="loc_445_1_445_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_1_445_10&#39;)"><span class="hl_fundecl"><span class="mpre">reachable</span></span></a><span class="mpre"> </span><a name="loc_445_11_445_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_11_445_12&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_445_13_445_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_13_445_14&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_368_1_368_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_1_368_10&#39;)"><span class="hl_varref"><span class="mpre">preorderF</span></span></a><span class="mpre"> (</span><a href="#loc_264_1_264_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_4&#39;)"><span class="hl_varref"><span class="mpre">dfs</span></span></a><span class="mpre"> </span><a href="#loc_445_11_445_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_11_445_12&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> [</span><a href="#loc_445_13_445_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_13_445_14&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">])

</span><span class="hl_comment"><span class="mpre">-- | Is the second vertex reachable from the first?</span></span><span class="mpre">
</span><a href="#loc_449_1_449_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_1_449_5&#39;)"><span class="mpre">path</span></a><span class="mpre">         :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_449_1_449_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_1_449_5&#39;)"><span class="hl_fundecl"><span class="mpre">path</span></span></a><span class="mpre"> </span><a name="loc_449_6_449_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_6_449_7&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_449_8_449_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_8_449_9&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_449_10_449_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_10_449_11&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">    = </span><a href="#loc_449_10_449_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_10_449_11&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> (</span><a href="#loc_445_1_445_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_1_445_10&#39;)"><span class="hl_varref"><span class="mpre">reachable</span></span></a><span class="mpre"> </span><a href="#loc_449_6_449_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_6_449_7&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_449_8_449_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_8_449_9&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Algorithm 7: Biconnected components</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The biconnected components of a graph.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- An undirected graph is biconnected if the deletion of any vertex</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- leaves it connected.</span></span><span class="mpre">
</span><a href="#loc_459_1_459_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_1_459_4&#39;)"><span class="mpre">bcc</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Forest</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">]
</span><a name="loc_459_1_459_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_1_459_4&#39;)"><span class="hl_fundecl"><span class="mpre">bcc</span></span></a><span class="mpre"> </span><a name="loc_459_5_459_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_5_459_6&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_470_1_470_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_1_470_8&#39;)"><span class="hl_varref"><span class="mpre">bicomps</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_464_1_464_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_1_464_9&#39;)"><span class="hl_varref"><span class="mpre">do_label</span></span></a><span class="mpre"> </span><a href="#loc_459_5_459_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_5_459_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_461_8_461_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_8_461_12&#39;)"><span class="hl_varref"><span class="mpre">dnum</span></span></a><span class="mpre">)) </span><a href="#loc_460_8_460_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_8_460_14&#39;)"><span class="hl_varref"><span class="mpre">forest</span></span></a><span class="mpre">
 where </span><a name="loc_460_8_460_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_8_460_14&#39;)"><span class="hl_vardecl"><span class="mpre">forest</span></span></a><span class="mpre"> = </span><a href="#loc_258_1_258_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_1_258_4&#39;)"><span class="hl_varref"><span class="mpre">dff</span></span></a><span class="mpre"> </span><a href="#loc_459_5_459_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_5_459_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
       </span><a name="loc_461_8_461_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_8_461_12&#39;)"><span class="hl_vardecl"><span class="mpre">dnum</span></span></a><span class="mpre">   = </span><a href="#loc_374_1_374_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_7&#39;)"><span class="hl_varref"><span class="mpre">preArr</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">bounds</span></span><span class="mpre"> </span><a href="#loc_459_5_459_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_459_5_459_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) </span><a href="#loc_460_8_460_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_8_460_14&#39;)"><span class="hl_varref"><span class="mpre">forest</span></span></a><span class="mpre">

</span><a href="#loc_464_1_464_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_1_464_9&#39;)"><span class="mpre">do_label</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Graph</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Table</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_464_1_464_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_1_464_9&#39;)"><span class="hl_fundecl"><span class="mpre">do_label</span></span></a><span class="mpre"> </span><a name="loc_464_10_464_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_10_464_11&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_464_12_464_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_12_464_16&#39;)"><span class="hl_vardecl"><span class="mpre">dnum</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> </span><a name="loc_464_23_464_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_23_464_24&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_464_25_464_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_25_464_27&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a href="#loc_464_23_464_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_23_464_24&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_464_12_464_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_12_464_16&#39;)"><span class="hl_varref"><span class="mpre">dnum</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><a href="#loc_464_23_464_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_23_464_24&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_466_8_466_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_8_466_10&#39;)"><span class="hl_varref"><span class="mpre">lv</span></span></a><span class="mpre">) </span><a href="#loc_465_8_465_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_8_465_10&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">
 where </span><a name="loc_465_8_465_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_8_465_10&#39;)"><span class="hl_vardecl"><span class="mpre">us</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_464_1_464_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_1_464_9&#39;)"><span class="hl_varref"><span class="mpre">do_label</span></span></a><span class="mpre"> </span><a href="#loc_464_10_464_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_10_464_11&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_464_12_464_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_12_464_16&#39;)"><span class="hl_varref"><span class="mpre">dnum</span></span></a><span class="mpre">) </span><a href="#loc_464_25_464_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_25_464_27&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
       </span><a name="loc_466_8_466_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_8_466_10&#39;)"><span class="hl_vardecl"><span class="mpre">lv</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_544_1_544_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_544_1_544_8&#39;)"><span class="hl_varref"><span class="mpre">minimum</span></span></a><span class="mpre"> ([</span><a href="#loc_464_12_464_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_12_464_16&#39;)"><span class="hl_varref"><span class="mpre">dnum</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><a href="#loc_464_23_464_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_23_464_24&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_464_12_464_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_12_464_16&#39;)"><span class="hl_varref"><span class="mpre">dnum</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><a href="#loc_466_44_466_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_44_466_45&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> | </span><a name="loc_466_44_466_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_44_466_45&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_464_10_464_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_10_464_11&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><a href="#loc_464_23_464_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_23_464_24&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">]
                     </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_467_41_467_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_41_467_43&#39;)"><span class="hl_varref"><span class="mpre">lu</span></span></a><span class="mpre"> | </span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (_,_,</span><a name="loc_467_41_467_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_41_467_43&#39;)"><span class="hl_vardecl"><span class="mpre">lu</span></span></a><span class="mpre">) _ &lt;- </span><a href="#loc_465_8_465_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_8_465_10&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">])

</span><a href="#loc_470_1_470_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_1_470_8&#39;)"><span class="mpre">bicomps</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Forest</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">]
</span><a name="loc_470_1_470_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_1_470_8&#39;)"><span class="hl_fundecl"><span class="mpre">bicomps</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a name="loc_470_16_470_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_16_470_17&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,_,_) </span><a name="loc_470_23_470_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_23_470_25&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">)
      = [ </span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a href="#loc_470_16_470_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_16_470_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_471_36_471_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_36_471_38&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">) </span><a href="#loc_471_39_471_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_39_471_41&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre"> | (_,</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> </span><a name="loc_471_36_471_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_36_471_38&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> </span><a name="loc_471_39_471_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_471_39_471_41&#39;)"><span class="hl_vardecl"><span class="mpre">us</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_474_1_474_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_8&#39;)"><span class="hl_varref"><span class="mpre">collect</span></span></a><span class="mpre"> </span><a href="#loc_470_23_470_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_23_470_25&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">]

</span><a href="#loc_474_1_474_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_8&#39;)"><span class="mpre">collect</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Vertex</span></span><span class="mpre">])
</span><a name="loc_474_1_474_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_8&#39;)"><span class="hl_fundecl"><span class="mpre">collect</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a name="loc_474_16_474_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_16_474_17&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_474_18_474_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_18_474_20&#39;)"><span class="hl_vardecl"><span class="mpre">dv</span></span></a><span class="mpre">,</span><a name="loc_474_21_474_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_21_474_23&#39;)"><span class="hl_vardecl"><span class="mpre">lv</span></span></a><span class="mpre">) </span><a name="loc_474_25_474_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_25_474_27&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">) = (</span><a href="#loc_474_21_474_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_21_474_23&#39;)"><span class="hl_varref"><span class="mpre">lv</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a href="#loc_474_16_474_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_16_474_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_476_8_476_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_8_476_10&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">) </span><a href="#loc_477_8_477_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_8_477_10&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
 where </span><a name="loc_475_8_475_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_8_475_17&#39;)"><span class="hl_vardecl"><span class="mpre">collected</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_474_1_474_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_8&#39;)"><span class="hl_varref"><span class="mpre">collect</span></span></a><span class="mpre"> </span><a href="#loc_474_25_474_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_25_474_27&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
       </span><a name="loc_476_8_476_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_8_476_10&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> [ </span><a href="#loc_476_37_476_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_37_476_39&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre"> | (</span><a name="loc_476_28_476_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_28_476_30&#39;)"><span class="hl_vardecl"><span class="mpre">lw</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> </span><a name="loc_476_37_476_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_37_476_39&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre"> _) &lt;- </span><a href="#loc_475_8_475_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_8_475_17&#39;)"><span class="hl_varref"><span class="mpre">collected</span></span></a><span class="mpre">, </span><a href="#loc_476_28_476_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_28_476_30&#39;)"><span class="hl_varref"><span class="mpre">lw</span></span></a><span class="hl_infix"><span class="mpre">&lt;</span></span><a href="#loc_474_18_474_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_18_474_20&#39;)"><span class="hl_varref"><span class="mpre">dv</span></span></a><span class="mpre">]
       </span><a name="loc_477_8_477_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_8_477_10&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> [ if </span><a href="#loc_478_28_478_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_28_478_30&#39;)"><span class="hl_varref"><span class="mpre">lw</span></span></a><span class="hl_infix"><span class="mpre">&lt;</span></span><a href="#loc_474_18_474_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_18_474_20&#39;)"><span class="hl_varref"><span class="mpre">dv</span></span></a><span class="mpre"> then </span><a href="#loc_478_40_478_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_40_478_42&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre"> else [</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> (</span><a href="#loc_474_16_474_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_16_474_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_478_37_478_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_37_478_39&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">) </span><a href="#loc_478_40_478_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_40_478_42&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">]
                        | (</span><a name="loc_478_28_478_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_28_478_30&#39;)"><span class="hl_vardecl"><span class="mpre">lw</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> </span><a name="loc_478_37_478_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_37_478_39&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre"> </span><a name="loc_478_40_478_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_40_478_42&#39;)"><span class="hl_vardecl"><span class="mpre">us</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_475_8_475_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_8_475_17&#39;)"><span class="hl_varref"><span class="mpre">collected</span></span></a><span class="mpre"> ]
</span></div></body></html>