<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS_GHC -fno-warn-orphans #-}
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Text.Regex.Posix.Sequence</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) Chris Kuklewicz 2006</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org, textregexlazy@personal.mightyreason.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (regex-base needs MPTC+FD)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This provides &#39;String&#39; instances for &#39;RegexMaker&#39; and &#39;RegexLike&#39; based</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- on &quot;Text.Regex.Posix.Wrap&quot;, and a (&#39;RegexContext&#39; &#39;Regex&#39; &#39;String&#39; &#39;String&#39;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instance.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- To use these instance, you would normally import</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;Text.Regex.Posix&quot;.  You only need to import this module to use</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the medium level API of the compile, regexec, and execute</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- functions.  All of these report error by returning Left values</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instead of undefined or error or fail.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Text.Regex.Posix.Sequence(
  </span><span class="hl_comment"><span class="mpre">-- ** Types</span></span><span class="mpre">
  Regex,
  MatchOffset,
  MatchLength,
  ReturnCode,
  WrapError,
  </span><span class="hl_comment"><span class="mpre">-- ** Miscellaneous</span></span><span class="mpre">
  unusedOffset,
  </span><span class="hl_comment"><span class="mpre">-- ** Medium level API functions</span></span><span class="mpre">
  compile,
  regexec,
  execute,
  </span><span class="hl_comment"><span class="mpre">-- ** Compilation options</span></span><span class="mpre">
  CompOption(CompOption),
  compBlank,
  compExtended,   </span><span class="hl_comment"><span class="mpre">-- use extended regex syntax</span></span><span class="mpre">
  compIgnoreCase, </span><span class="hl_comment"><span class="mpre">-- ignore case when matching</span></span><span class="mpre">
  compNoSub,      </span><span class="hl_comment"><span class="mpre">-- no substring matching needed</span></span><span class="mpre">
  compNewline,    </span><span class="hl_comment"><span class="mpre">-- &#39;.&#39; doesn&#39;t match newline</span></span><span class="mpre">

  ExecOption(ExecOption),
  execBlank,
  execNotBOL,     </span><span class="hl_comment"><span class="mpre">-- not at begining of line</span></span><span class="mpre">
  execNotEOL     </span><span class="hl_comment"><span class="mpre">-- not at end of line</span></span><span class="mpre">
  ) where

import Data.Array(listArray, Array)
import System.IO.Unsafe(</span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="mpre">unsafePerformIO</span></a><span class="mpre">)
import Text.Regex.Base.RegexLike(</span><a href="Text.Regex.Base.RegexLike.html#loc_190_35_190_47" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_190_35_190_47&#39;)"><span class="mpre">RegexContext</span></a><span class="mpre">(..),</span><a href="Text.Regex.Base.RegexLike.html#loc_98_47_98_57" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_98_47_98_57&#39;)"><span class="mpre">RegexMaker</span></a><span class="mpre">(..),</span><a href="Text.Regex.Base.RegexLike.html#loc_130_26_130_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_130_26_130_35&#39;)"><span class="mpre">RegexLike</span></a><span class="mpre">(..),MatchOffset,MatchLength,</span><a href="Text.Regex.Base.RegexLike.html#loc_196_7_196_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_196_7_196_14&#39;)"><span class="mpre">Extract</span></a><span class="mpre">(..))
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-posix-0.95.2/Text/Regex/Posix/Sequence.hs&quot;, srcSpanStartLine = 54, srcSpanStartColumn = 8, srcSpanEndLine = 54, srcSpanEndColumn = 29}, srcInfoPoints = []}) &quot;Text.Regex.Posix.Wrap&quot;"><span class="mpre">Text.Regex.Posix.Wrap</span></span><span class="mpre">
import Text.Regex.Base.Impl(</span><a href="Text.Regex.Base.Impl.html#loc_52_1_52_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.Impl.html#loc_52_1_52_10&#39;)"><span class="mpre">polymatch</span></a><span class="mpre">,</span><a href="Text.Regex.Base.Impl.html#loc_58_1_58_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.Impl.html#loc_58_1_58_11&#39;)"><span class="mpre">polymatchM</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-posix-0.95.2/Text/Regex/Posix/Sequence.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 8, srcSpanEndLine = 56, srcSpanEndColumn = 21}, srcInfoPoints = []}) &quot;Data.Sequence&quot;"><span class="mpre">Data.Sequence</span></span><span class="mpre"> as S hiding (length)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-posix-0.95.2/Text/Regex/Posix/Sequence.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 18, srcSpanEndLine = 57, srcSpanEndColumn = 31}, srcInfoPoints = []}) &quot;Data.Sequence&quot;"><span class="mpre">Data.Sequence</span></span><span class="mpre"> as S (length)
import Foreign.C.String
import Foreign.Marshal.Array
import Foreign.Marshal.Alloc
import Foreign.Storable

instance </span><a href="Text.Regex.Base.RegexLike.html#loc_190_35_190_47" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_190_35_190_47&#39;)"><span class="hl_classref"><span class="mpre">RegexContext</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Regex</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">) (</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">) where
  </span><a href="Text.Regex.Base.RegexLike.html#loc_191_3_191_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_191_3_191_8&#39;)"><span class="hl_vardecl"><span class="mpre">match</span></span></a><span class="mpre"> = </span><a href="Text.Regex.Base.Impl.html#loc_52_1_52_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.Impl.html#loc_52_1_52_10&#39;)"><span class="hl_varref"><span class="mpre">polymatch</span></span></a><span class="mpre">
  </span><a href="Text.Regex.Base.RegexLike.html#loc_192_3_192_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_192_3_192_9&#39;)"><span class="hl_vardecl"><span class="mpre">matchM</span></span></a><span class="mpre"> = </span><a href="Text.Regex.Base.Impl.html#loc_58_1_58_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.Impl.html#loc_58_1_58_11&#39;)"><span class="hl_varref"><span class="mpre">polymatchM</span></span></a><span class="mpre">

</span><a href="#loc_68_1_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_13&#39;)"><span class="mpre">unusedOffset</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_68_1_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_13&#39;)"><span class="hl_vardecl"><span class="mpre">unusedOffset</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unusedRegOffset</span></span><span class="mpre">

</span><a href="#loc_71_1_71_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_7&#39;)"><span class="mpre">unwrap</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-posix-0.95.2/Text/Regex/Posix/Sequence.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 11, srcSpanEndLine = 70, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-posix-0.95.2/Text/Regex/Posix/Sequence.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 11, srcSpanEndLine = 70, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-posix-0.95.2/Text/Regex/"><span class="mpre">(Show e) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">e</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a name="loc_71_1_71_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_7&#39;)"><span class="hl_fundecl"><span class="mpre">unwrap</span></span></a><span class="mpre"> </span><a name="loc_71_8_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_8_71_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = case </span><a href="#loc_71_8_71_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_8_71_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_71_27_71_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_27_71_30&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Text.Regex.Posix.Sequence died: &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_71_27_71_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_27_71_30&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">)
                     </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_72_28_72_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_28_72_29&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_72_28_72_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_28_72_29&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

instance </span><a href="Text.Regex.Base.RegexLike.html#loc_98_47_98_57" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_98_47_98_57&#39;)"><span class="hl_classref"><span class="mpre">RegexMaker</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Regex</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CompOption</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ExecOption</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">) where
  </span><a href="Text.Regex.Base.RegexLike.html#loc_103_3_103_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_103_3_103_16&#39;)"><span class="hl_fundecl"><span class="mpre">makeRegexOpts</span></span></a><span class="mpre"> </span><a name="loc_75_17_75_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_17_75_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_75_19_75_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_19_75_20&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> </span><a name="loc_75_21_75_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_28&#39;)"><span class="hl_vardecl"><span class="mpre">pattern</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    (</span><a href="#loc_95_1_95_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_8&#39;)"><span class="hl_varref"><span class="mpre">compile</span></span></a><span class="mpre"> </span><a href="#loc_75_17_75_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_17_75_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_75_19_75_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_19_75_20&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="#loc_75_21_75_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_21_75_28&#39;)"><span class="hl_varref"><span class="mpre">pattern</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_71_1_71_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_7&#39;)"><span class="hl_varref"><span class="mpre">unwrap</span></span></a><span class="mpre">)
  </span><a href="Text.Regex.Base.RegexLike.html#loc_107_3_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_107_3_107_17&#39;)"><span class="hl_fundecl"><span class="mpre">makeRegexOptsM</span></span></a><span class="mpre"> </span><a name="loc_77_18_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_77_20_77_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_20_77_21&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> </span><a name="loc_77_22_77_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_22_77_29&#39;)"><span class="hl_vardecl"><span class="mpre">pattern</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fail</span></span><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> 
    (</span><a href="#loc_95_1_95_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_8&#39;)"><span class="hl_varref"><span class="mpre">compile</span></span></a><span class="mpre"> </span><a href="#loc_77_18_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_18_77_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_77_20_77_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_20_77_21&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="#loc_77_22_77_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_22_77_29&#39;)"><span class="hl_varref"><span class="mpre">pattern</span></span></a><span class="mpre">)

instance </span><a href="Text.Regex.Base.RegexLike.html#loc_130_26_130_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_130_26_130_35&#39;)"><span class="hl_classref"><span class="mpre">RegexLike</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Regex</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">) where
  </span><a href="Text.Regex.Base.RegexLike.html#loc_147_3_147_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_147_3_147_12&#39;)"><span class="hl_fundecl"><span class="mpre">matchTest</span></span></a><span class="mpre"> </span><a name="loc_81_13_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_13_81_18&#39;)"><span class="hl_vardecl"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a name="loc_81_19_81_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_19_81_22&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="#loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="hl_varref"><span class="mpre">withSeq</span></span></a><span class="mpre"> </span><a href="#loc_81_19_81_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_19_81_22&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">wrapTest</span></span><span class="mpre"> </span><a href="#loc_81_13_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_13_81_18&#39;)"><span class="hl_varref"><span class="mpre">regex</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_71_1_71_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_7&#39;)"><span class="hl_varref"><span class="mpre">unwrap</span></span></a><span class="mpre">
  </span><a href="Text.Regex.Base.RegexLike.html#loc_137_3_137_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_137_3_137_12&#39;)"><span class="hl_fundecl"><span class="mpre">matchOnce</span></span></a><span class="mpre"> </span><a name="loc_83_13_83_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_18&#39;)"><span class="hl_vardecl"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a name="loc_83_19_83_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_19_83_22&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> 
    </span><a href="#loc_110_1_110_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_8&#39;)"><span class="hl_varref"><span class="mpre">execute</span></span></a><span class="mpre"> </span><a href="#loc_83_13_83_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_18&#39;)"><span class="hl_varref"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a href="#loc_83_19_83_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_19_83_22&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_71_1_71_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_7&#39;)"><span class="hl_varref"><span class="mpre">unwrap</span></span></a><span class="mpre">
  </span><a href="Text.Regex.Base.RegexLike.html#loc_141_3_141_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_141_3_141_11&#39;)"><span class="hl_fundecl"><span class="mpre">matchAll</span></span></a><span class="mpre"> </span><a name="loc_85_12_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_12_85_17&#39;)"><span class="hl_vardecl"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a name="loc_85_18_85_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_18_85_21&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> 
    </span><a href="#loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="hl_varref"><span class="mpre">withSeq</span></span></a><span class="mpre"> </span><a href="#loc_85_18_85_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_18_85_21&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">wrapMatchAll</span></span><span class="mpre"> </span><a href="#loc_85_12_85_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_12_85_17&#39;)"><span class="hl_varref"><span class="mpre">regex</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_71_1_71_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_7&#39;)"><span class="hl_varref"><span class="mpre">unwrap</span></span></a><span class="mpre">
  </span><a href="Text.Regex.Base.RegexLike.html#loc_144_3_144_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_144_3_144_13&#39;)"><span class="hl_fundecl"><span class="mpre">matchCount</span></span></a><span class="mpre"> </span><a name="loc_87_14_87_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_14_87_19&#39;)"><span class="hl_vardecl"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a name="loc_87_20_87_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_20_87_23&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><a href="#loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="hl_varref"><span class="mpre">withSeq</span></span></a><span class="mpre"> </span><a href="#loc_87_20_87_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_20_87_23&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">wrapCount</span></span><span class="mpre"> </span><a href="#loc_87_14_87_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_14_87_19&#39;)"><span class="hl_varref"><span class="mpre">regex</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_71_1_71_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_7&#39;)"><span class="hl_varref"><span class="mpre">unwrap</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- compile</span></span><span class="mpre">
</span><a href="#loc_95_1_95_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_8&#39;)"><span class="mpre">compile</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">CompOption</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Flags (summed together)</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">ExecOption</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Flags (summed together)</span></span><span class="mpre">
         -&gt; (</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">)     </span><span class="hl_comment"><span class="mpre">-- ^ The regular expression to compile (ASCII only, no null bytes)</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">WrapError</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Regex</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ Returns: the compiled regular expression</span></span><span class="mpre">
</span><a name="loc_95_1_95_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_8&#39;)"><span class="hl_fundecl"><span class="mpre">compile</span></span></a><span class="mpre"> </span><a name="loc_95_9_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_14&#39;)"><span class="hl_vardecl"><span class="mpre">flags</span></span></a><span class="mpre"> </span><a name="loc_95_15_95_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_15_95_16&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> </span><a name="loc_95_17_95_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_17_95_24&#39;)"><span class="hl_vardecl"><span class="mpre">pattern</span></span></a><span class="mpre"> =  </span><a href="#loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="hl_varref"><span class="mpre">withSeq</span></span></a><span class="mpre"> </span><a href="#loc_95_17_95_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_17_95_24&#39;)"><span class="hl_varref"><span class="mpre">pattern</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">wrapCompile</span></span><span class="mpre"> </span><a href="#loc_95_9_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_14&#39;)"><span class="hl_varref"><span class="mpre">flags</span></span></a><span class="mpre"> </span><a href="#loc_95_15_95_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_15_95_16&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- -----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- regexec</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Matches a regular expression against a string</span></span><span class="mpre">
</span><a href="#loc_110_1_110_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_8&#39;)"><span class="mpre">execute</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Regex</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ Compiled regular expression</span></span><span class="mpre">
        -&gt; (</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">)     </span><span class="hl_comment"><span class="mpre">-- ^ (Seq Char) to match against</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">WrapError</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Array</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">MatchOffset</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">MatchLength</span></span><span class="mpre">))))
                </span><span class="hl_comment"><span class="mpre">-- ^ Returns: &#39;Nothing&#39; if the regex did not match the</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- string, or:</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">--   &#39;Just&#39; (array of offset length pairs)</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a name="loc_110_1_110_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_1_110_8&#39;)"><span class="hl_fundecl"><span class="mpre">execute</span></span></a><span class="mpre"> </span><a name="loc_110_9_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_14&#39;)"><span class="hl_vardecl"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a name="loc_110_15_110_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_15_110_18&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = do
  </span><a name="loc_111_3_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_3_111_16&#39;)"><span class="hl_vardecl"><span class="mpre">maybeStartEnd</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="hl_varref"><span class="mpre">withSeq</span></span></a><span class="mpre"> </span><a href="#loc_110_15_110_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_15_110_18&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">wrapMatch</span></span><span class="mpre"> </span><a href="#loc_110_9_110_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_14&#39;)"><span class="hl_varref"><span class="mpre">regex</span></span></a><span class="mpre">)
  case </span><a href="#loc_111_3_111_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_3_111_16&#39;)"><span class="hl_varref"><span class="mpre">maybeStartEnd</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">--  Right (Just []) -&gt;  fail &quot;got [] back!&quot; -- return wierd array instead</span></span><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_115_17_115_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_17_115_22&#39;)"><span class="hl_vardecl"><span class="mpre">parts</span></span></a><span class="mpre">) -&gt;
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">listArray</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><span class="hl_varref"><span class="mpre">pred</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_115_17_115_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_17_115_22&#39;)"><span class="hl_varref"><span class="mpre">parts</span></span></a><span class="mpre">)) 
       </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(</span><a name="loc_117_17_117_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_17_117_18&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">,</span><a name="loc_117_19_117_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_19_117_20&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">)-&gt;(</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_117_17_117_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_17_117_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_117_19_117_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_19_117_20&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_117_17_117_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_17_117_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)))
       </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_115_17_115_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_17_115_22&#39;)"><span class="hl_varref"><span class="mpre">parts</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_119_10_119_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_10_119_13&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_119_10_119_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_10_119_13&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- -----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- regexec</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Matches a regular expression against a string</span></span><span class="mpre">
</span><a href="#loc_137_1_137_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_8&#39;)"><span class="mpre">regexec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Regex</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ Compiled regular expression</span></span><span class="mpre">
        -&gt; (</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">)     </span><span class="hl_comment"><span class="mpre">-- ^ (Seq Char) to match against</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">WrapError</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> ((</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">), (</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">), (</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">), [(</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">)])))
                </span><span class="hl_comment"><span class="mpre">-- ^ Returns: &#39;Nothing&#39; if the regex did not match the</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- string, or:</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">--   &#39;Just&#39; (everything before match,</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">--         matched portion,</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">--         everything after match,</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">--         subexpression matches)</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a name="loc_137_1_137_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_8&#39;)"><span class="hl_fundecl"><span class="mpre">regexec</span></span></a><span class="mpre"> </span><a name="loc_137_9_137_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_14&#39;)"><span class="hl_vardecl"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a name="loc_137_15_137_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_15_137_18&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = do
  let </span><a href="#loc_139_7_139_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_7_139_13&#39;)"><span class="mpre">getSub</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">RegOffset</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">RegOffset</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">)
      </span><a name="loc_139_7_139_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_7_139_13&#39;)"><span class="hl_fundecl"><span class="mpre">getSub</span></span></a><span class="mpre"> (</span><a name="loc_139_15_139_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_20&#39;)"><span class="hl_vardecl"><span class="mpre">start</span></span></a><span class="mpre">,</span><a name="loc_139_21_139_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_21_139_25&#39;)"><span class="hl_vardecl"><span class="mpre">stop</span></span></a><span class="mpre">) | </span><a href="#loc_139_15_139_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_20&#39;)"><span class="hl_varref"><span class="mpre">start</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unusedRegOffset</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
                          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = 
        </span><a href="Text.Regex.Base.RegexLike.html#loc_206_3_206_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_206_3_206_10&#39;)"><span class="hl_varref"><span class="mpre">extract</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_139_15_139_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_20&#39;)"><span class="hl_varref"><span class="mpre">start</span></span></a><span class="mpre">,</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_139_21_139_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_21_139_25&#39;)"><span class="hl_varref"><span class="mpre">stop</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_139_15_139_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_20&#39;)"><span class="hl_varref"><span class="mpre">start</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_137_15_137_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_15_137_18&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
      </span><a href="#loc_143_7_143_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_7_143_19&#39;)"><span class="mpre">matchedParts</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">RegOffset</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">RegOffset</span></span><span class="mpre">)] -&gt; ((</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">), (</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">), (</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">), [(</span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">)])
      </span><a name="loc_143_7_143_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_7_143_19&#39;)"><span class="hl_fundecl"><span class="mpre">matchedParts</span></span></a><span class="mpre"> [] = (</span><a href="#loc_137_15_137_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_15_137_18&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">,</span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">,</span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">,[]) </span><span class="hl_comment"><span class="mpre">-- no information</span></span><span class="mpre">
      </span><a href="#loc_143_7_143_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_7_143_19&#39;)"><span class="hl_fundecl"><span class="mpre">matchedParts</span></span></a><span class="mpre"> (</span><a name="loc_144_21_144_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_21_144_37&#39;)"><span class="hl_specname"><span class="mpre">matchedStartStop</span></span></a><span class="mpre">@(</span><a name="loc_144_39_144_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_39_144_44&#39;)"><span class="hl_vardecl"><span class="mpre">start</span></span></a><span class="mpre">,</span><a name="loc_144_45_144_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_45_144_49&#39;)"><span class="hl_vardecl"><span class="mpre">stop</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_144_51_144_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_51_144_63&#39;)"><span class="hl_vardecl"><span class="mpre">subStartStop</span></span></a><span class="mpre">) = 
        (</span><a href="Text.Regex.Base.RegexLike.html#loc_198_3_198_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_198_3_198_9&#39;)"><span class="hl_varref"><span class="mpre">before</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_144_39_144_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_39_144_44&#39;)"><span class="hl_varref"><span class="mpre">start</span></span></a><span class="mpre">) </span><a href="#loc_137_15_137_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_15_137_18&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
        ,</span><a href="#loc_139_7_139_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_7_139_13&#39;)"><span class="hl_varref"><span class="mpre">getSub</span></span></a><span class="mpre"> </span><a href="#loc_144_21_144_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_21_144_37&#39;)"><span class="hl_varref"><span class="mpre">matchedStartStop</span></span></a><span class="mpre">
        ,</span><a href="Text.Regex.Base.RegexLike.html#loc_200_3_200_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.Base.RegexLike.html#loc_200_3_200_8&#39;)"><span class="hl_varref"><span class="mpre">after</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_144_45_144_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_45_144_49&#39;)"><span class="hl_varref"><span class="mpre">stop</span></span></a><span class="mpre">) </span><a href="#loc_137_15_137_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_15_137_18&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
        ,</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_139_7_139_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_7_139_13&#39;)"><span class="hl_varref"><span class="mpre">getSub</span></span></a><span class="mpre"> </span><a href="#loc_144_51_144_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_51_144_63&#39;)"><span class="hl_varref"><span class="mpre">subStartStop</span></span></a><span class="mpre">)
  </span><a name="loc_149_3_149_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_3_149_16&#39;)"><span class="hl_vardecl"><span class="mpre">maybeStartEnd</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="hl_varref"><span class="mpre">withSeq</span></span></a><span class="mpre"> </span><a href="#loc_137_15_137_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_15_137_18&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">wrapMatch</span></span><span class="mpre"> </span><a href="#loc_137_9_137_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_14&#39;)"><span class="hl_varref"><span class="mpre">regex</span></span></a><span class="mpre">)
  case </span><a href="#loc_149_3_149_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_3_149_16&#39;)"><span class="hl_varref"><span class="mpre">maybeStartEnd</span></span></a><span class="mpre"> of
    </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)
    </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_152_17_152_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_17_152_22&#39;)"><span class="hl_vardecl"><span class="mpre">parts</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_143_7_143_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_7_143_19&#39;)"><span class="hl_varref"><span class="mpre">matchedParts</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_152_17_152_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_17_152_22&#39;)"><span class="hl_varref"><span class="mpre">parts</span></span></a><span class="mpre">
    </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_153_10_153_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_10_153_13&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_153_10_153_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_10_153_13&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">)

</span><a href="#loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="mpre">withSeq</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Seq</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">CString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="hl_fundecl"><span class="mpre">withSeq</span></span></a><span class="mpre"> </span><a name="loc_156_9_156_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_156_11_156_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_11_156_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =
  let </span><span class="hl_comment"><span class="mpre">-- Ensure null at end of s</span></span><span class="mpre">
      </span><a name="loc_158_7_158_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_7_158_9&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">viewr</span></span><span class="mpre"> </span><a href="#loc_156_9_156_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of                 </span><span class="hl_comment"><span class="mpre">-- bang !s</span></span><span class="mpre">
             </span><span class="hl_conref"><span class="mpre">EmptyR</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">singleton</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\0&#39;</span></span><span class="mpre">
             _ </span><span class="hl_infix"><span class="mpre">:&gt;</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\0&#39;</span></span><span class="mpre"> -&gt; </span><a href="#loc_156_9_156_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
             _ -&gt; </span><a href="#loc_156_9_156_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">|&gt;</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\0&#39;</span></span><span class="mpre">
      </span><a name="loc_162_7_162_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_7_162_12&#39;)"><span class="hl_fundecl"><span class="mpre">pokes</span></span></a><span class="mpre"> </span><a name="loc_162_13_162_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_13_162_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_162_15_162_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_15_162_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">viewl</span></span><span class="mpre"> </span><a href="#loc_162_15_162_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_15_162_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> of         </span><span class="hl_comment"><span class="mpre">-- bang pokes !p !a</span></span><span class="mpre">
                    </span><span class="hl_conref"><span class="mpre">EmptyL</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
                    </span><a name="loc_164_21_164_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_21_164_22&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:&lt;</span></span><span class="mpre"> </span><a name="loc_164_26_164_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_26_164_28&#39;)"><span class="hl_vardecl"><span class="mpre">a&#39;</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_162_13_162_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_13_162_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a href="Foreign.C.String.html#loc_206_1_206_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.C.String.html#loc_206_1_206_16&#39;)"><span class="hl_varref"><span class="mpre">castCharToCChar</span></span></a><span class="mpre"> </span><a href="#loc_164_21_164_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_21_164_22&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_162_7_162_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_7_162_12&#39;)"><span class="hl_varref"><span class="mpre">pokes</span></span></a><span class="mpre"> (</span><a href="Foreign.Marshal.Array.html#loc_260_1_260_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Array.html#loc_260_1_260_11&#39;)"><span class="hl_varref"><span class="mpre">advancePtr</span></span></a><span class="mpre"> </span><a href="#loc_162_13_162_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_13_162_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_164_26_164_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_26_164_28&#39;)"><span class="hl_varref"><span class="mpre">a&#39;</span></span></a><span class="mpre">
  in </span><a href="Foreign.Marshal.Alloc.html#loc_121_1_121_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Alloc.html#loc_121_1_121_12&#39;)"><span class="hl_varref"><span class="mpre">allocaBytes</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_158_7_158_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_7_158_9&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">) (\</span><a name="loc_165_34_165_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_34_165_37&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_162_7_162_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_7_162_12&#39;)"><span class="hl_varref"><span class="mpre">pokes</span></span></a><span class="mpre"> </span><a href="#loc_165_34_165_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_34_165_37&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_158_7_158_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_7_158_9&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_156_11_156_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_11_156_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_165_34_165_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_34_165_37&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">)
</span></div></body></html>