<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Text.Parsec.Perm</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) Daan Leijen 1999-2001, (c) Paolo Martini 2007</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file libraries/parsec/LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  derek.a.elkins@gmail.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (uses existentially quantified data constructors)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module implements permutation parsers. The algorithm used</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is fairly complex since we push the type system to its limits :-)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The algorithm is described in:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Parsing Permutation Phrases,/</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- by Arthur Baars, Andres Loh and Doaitse Swierstra.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Published as a functional pearl at the Haskell Workshop 2001.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

{-# LANGUAGE ExistentialQuantification #-}

module Text.Parsec.Perm
    ( PermParser
    , StreamPermParser </span><span class="hl_comment"><span class="mpre">-- abstract</span></span><span class="mpre">

    , permute
    , (&lt;||&gt;), (&lt;$$&gt;)
    , (&lt;|?&gt;), (&lt;$?&gt;)
    ) where

import Text.Parsec

import Control.Monad.Identity

</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 1, srcSpanEndLine = 36, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 8, srcSpanEndLine = 36, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 36, src"><span class="mpre">infixl 1 &lt;||&gt;, &lt;|?&gt;</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 1, srcSpanEndLine = 37, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 8, srcSpanEndLine = 37, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 37, src"><span class="mpre">infixl 2 &lt;$$&gt;, &lt;$?&gt;</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">{---------------------------------------------------------------
  test -- parse a permutation of
  * an optional string of &#39;a&#39;s
  * a required &#39;b&#39;
  * an optional &#39;c&#39;
---------------------------------------------------------------}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-
test input
  = parse (do{ x &lt;- ptest; eof; return x }) &quot;&quot; input

ptest :: Parser (String,Char,Char)
ptest
  = permute $
    (,,) &lt;$?&gt; (&quot;&quot;,many1 (char &#39;a&#39;))
         &lt;||&gt; char &#39;b&#39;
         &lt;|?&gt; (&#39;_&#39;,char &#39;c&#39;)
-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{---------------------------------------------------------------
  Building a permutation parser
---------------------------------------------------------------}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The expression @perm \&lt;||&gt; p@ adds parser @p@ to the permutation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- parser @perm@. The parser @p@ is not allowed to accept empty input -</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- use the optional combinator (&#39;&lt;|?&gt;&#39;) instead. Returns a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- new permutation parser that includes @p@. </span></span><span class="mpre">

</span><a href="#loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="mpre">(&lt;||&gt;)</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 67, srcSpanStartColumn = 11, srcSpanEndLine = 67, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 67, srcSpanStartColumn = 11, srcSpanEndLine = 67, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 67, sr"><span class="mpre">(Stream s Identity tok) =&gt;</span></span><span class="mpre"> </span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Parsec</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="hl_fundecl"><span class="mpre">(&lt;||&gt;)</span></span></a><span class="mpre"> </span><a name="loc_68_8_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_8_68_12&#39;)"><span class="hl_vardecl"><span class="mpre">perm</span></span></a><span class="mpre"> </span><a name="loc_68_13_68_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_13_68_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">     = </span><a href="#loc_160_1_160_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_4&#39;)"><span class="hl_varref"><span class="mpre">add</span></span></a><span class="mpre"> </span><a href="#loc_68_8_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_8_68_12&#39;)"><span class="hl_varref"><span class="mpre">perm</span></span></a><span class="mpre"> </span><a href="#loc_68_13_68_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_13_68_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The expression @f \&lt;$$&gt; p@ creates a fresh permutation parser</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- consisting of parser @p@. The the final result of the permutation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- parser is the function @f@ applied to the return value of @p@. The</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- parser @p@ is not allowed to accept empty input - use the optional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- combinator (&#39;&lt;$?&gt;&#39;) instead.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If the function @f@ takes more than one parameter, the type variable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @b@ is instantiated to a functional type which combines nicely with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the adds parser @p@ to the (&#39;&lt;||&gt;&#39;) combinator. This</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- results in stylized code where a permutation parser starts with a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- combining function @f@ followed by the parsers. The function @f@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- gets its parameters in the order in which the parsers are specified,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- but actual input can be in any order.</span></span><span class="mpre">

</span><a href="#loc_85_1_85_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_7&#39;)"><span class="mpre">(&lt;$$&gt;)</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 11, srcSpanEndLine = 84, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 11, srcSpanEndLine = 84, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 84, sr"><span class="mpre">(Stream s Identity tok) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Parsec</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_85_1_85_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_7&#39;)"><span class="hl_fundecl"><span class="mpre">(&lt;$$&gt;)</span></span></a><span class="mpre"> </span><a name="loc_85_8_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_8_85_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_85_10_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_10_85_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">        = </span><a href="#loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="hl_varref"><span class="mpre">newperm</span></span></a><span class="mpre"> </span><a href="#loc_85_8_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_8_85_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_68_1_68_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;||&gt;</span></span></a><span class="mpre"> </span><a href="#loc_85_10_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_10_85_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The expression @perm \&lt;||&gt; (x,p)@ adds parser @p@ to the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- permutation parser @perm@. The parser @p@ is optional - if it can</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- not be applied, the default value @x@ will be used instead. Returns</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a new permutation parser that includes the optional parser @p@. </span></span><span class="mpre">

</span><a href="#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_7&#39;)"><span class="mpre">(&lt;|?&gt;)</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 11, srcSpanEndLine = 92, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 11, srcSpanEndLine = 92, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 92, sr"><span class="mpre">(Stream s Identity tok) =&gt;</span></span><span class="mpre"> </span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Parsec</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_93_1_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_7&#39;)"><span class="hl_fundecl"><span class="mpre">(&lt;|?&gt;)</span></span></a><span class="mpre"> </span><a name="loc_93_8_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_8_93_12&#39;)"><span class="hl_vardecl"><span class="mpre">perm</span></span></a><span class="mpre"> (</span><a name="loc_93_14_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_14_93_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_93_16_93_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_16_93_17&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) = </span><a href="#loc_168_1_168_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_7&#39;)"><span class="hl_varref"><span class="mpre">addopt</span></span></a><span class="mpre"> </span><a href="#loc_93_8_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_8_93_12&#39;)"><span class="hl_varref"><span class="mpre">perm</span></span></a><span class="mpre"> </span><a href="#loc_93_14_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_14_93_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_93_16_93_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_16_93_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The expression @f \&lt;$?&gt; (x,p)@ creates a fresh permutation parser</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- consisting of parser @p@. The the final result of the permutation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- parser is the function @f@ applied to the return value of @p@. The</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- parser @p@ is optional - if it can not be applied, the default value</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @x@ will be used instead. </span></span><span class="mpre">

</span><a href="#loc_102_1_102_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_7&#39;)"><span class="mpre">(&lt;$?&gt;)</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 101, srcSpanStartColumn = 11, srcSpanEndLine = 101, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 101, srcSpanStartColumn = 11, srcSpanEndLine = 101, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 10"><span class="mpre">(Stream s Identity tok) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Parsec</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_102_1_102_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_7&#39;)"><span class="hl_fundecl"><span class="mpre">(&lt;$?&gt;)</span></span></a><span class="mpre"> </span><a name="loc_102_8_102_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_8_102_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a name="loc_102_11_102_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_102_13_102_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_13_102_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">)    = </span><a href="#loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="hl_varref"><span class="mpre">newperm</span></span></a><span class="mpre"> </span><a href="#loc_102_8_102_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_8_102_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|?&gt;</span></span></a><span class="mpre"> (</span><a href="#loc_102_11_102_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_102_13_102_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_13_102_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">{---------------------------------------------------------------
  The permutation tree
---------------------------------------------------------------}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Provided for backwards compatibility.  The tok type is ignored.</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 110, srcSpanStartColumn = 1, srcSpanEndLine = 110, srcSpanEndColumn = 56}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 110, srcSpanStartColumn = 1, srcSpanEndLine = 110, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 110,"><span class="mpre">type PermParser tok st a = StreamPermParser String st a</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The type @StreamPermParser s st a@ denotes a permutation parser that,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- when converted by the &#39;permute&#39; function, parses </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @s@ streams with user state @st@ and returns a value of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- type @a@ on success.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Normally, a permutation parser is first build with special operators</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- like (&#39;&lt;||&gt;&#39;) and than transformed into a normal parser</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- using &#39;permute&#39;.</span></span><span class="mpre">

data </span><a name="loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tycondecl"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_121_32_121_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_32_121_36&#39;)"><span class="hl_condecl"><span class="mpre">Perm</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) [</span><a href="#loc_125_6_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_6_125_18&#39;)"><span class="hl_tyconref"><span class="mpre">StreamBranch</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- type Branch st a = StreamBranch String st a</span></span><span class="mpre">

data </span><a name="loc_125_6_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_6_125_18&#39;)"><span class="hl_tycondecl"><span class="mpre">StreamBranch</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = forall b. </span><a name="loc_125_38_125_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_38_125_44&#39;)"><span class="hl_condecl"><span class="mpre">Branch</span></span></a><span class="mpre"> (</span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)) (</span><span class="hl_tyconref"><span class="mpre">Parsec</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The parser @permute perm@ parses a permutation of parser described</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- by @perm@. For example, suppose we want to parse a permutation of:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- an optional string of @a@&#39;s, the character @b@ and an optional @c@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This can be described by:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;  test  = permute (tuple &lt;$?&gt; (&quot;&quot;,many1 (char &#39;a&#39;))</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;                         &lt;||&gt; char &#39;b&#39; </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;                         &lt;|?&gt; (&#39;_&#39;,char &#39;c&#39;))</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;        where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          tuple a b c  = (a,b,c)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- transform a permutation tree into a normal parser</span></span><span class="mpre">
</span><a href="#loc_140_1_140_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_8&#39;)"><span class="mpre">permute</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 139, srcSpanStartColumn = 12, srcSpanEndLine = 139, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 139, srcSpanStartColumn = 12, srcSpanEndLine = 139, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 13"><span class="mpre">(Stream s Identity tok) =&gt;</span></span><span class="mpre"> </span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Parsec</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_140_1_140_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_8&#39;)"><span class="hl_fundecl"><span class="mpre">permute</span></span></a><span class="mpre"> (</span><a href="#loc_121_32_121_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_32_121_36&#39;)"><span class="hl_conref"><span class="mpre">Perm</span></span></a><span class="mpre"> </span><a name="loc_140_15_140_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_15_140_18&#39;)"><span class="hl_vardecl"><span class="mpre">def</span></span></a><span class="mpre"> </span><a name="loc_140_19_140_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_19_140_21&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)
  = </span><a href="Text.Parsec.Combinator.html#loc_40_1_40_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_40_1_40_7&#39;)"><span class="hl_varref"><span class="mpre">choice</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_148_5_148_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_5_148_11&#39;)"><span class="hl_varref"><span class="mpre">branch</span></span></a><span class="mpre"> </span><a href="#loc_140_19_140_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_19_140_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_143_5_143_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_10&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">)
  where
    </span><a name="loc_143_5_143_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_10&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre">
      = case </span><a href="#loc_140_15_140_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_15_140_18&#39;)"><span class="hl_varref"><span class="mpre">def</span></span></a><span class="mpre"> of
          </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; []
          </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_146_16_146_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_16_146_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">  -&gt; [</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_146_16_146_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_16_146_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]

    </span><a name="loc_148_5_148_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_5_148_11&#39;)"><span class="hl_fundecl"><span class="mpre">branch</span></span></a><span class="mpre"> (</span><a href="#loc_125_38_125_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_38_125_44&#39;)"><span class="hl_conref"><span class="mpre">Branch</span></span></a><span class="mpre"> </span><a name="loc_148_20_148_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_20_148_24&#39;)"><span class="hl_vardecl"><span class="mpre">perm</span></span></a><span class="mpre"> </span><a name="loc_148_25_148_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_25_148_26&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">)
      = do{ </span><a name="loc_149_13_149_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_13_149_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_148_25_148_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_25_148_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
          ; </span><a name="loc_150_13_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_13_150_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_140_1_140_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_8&#39;)"><span class="hl_varref"><span class="mpre">permute</span></span></a><span class="mpre"> </span><a href="#loc_148_20_148_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_20_148_24&#39;)"><span class="hl_varref"><span class="mpre">perm</span></span></a><span class="mpre">
          ; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_150_13_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_13_150_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_149_13_149_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_13_149_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
          }

</span><span class="hl_comment"><span class="mpre">-- build permutation trees</span></span><span class="mpre">
</span><a href="#loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="mpre">newperm</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 155, srcSpanStartColumn = 12, srcSpanEndLine = 155, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 155, srcSpanStartColumn = 12, srcSpanEndLine = 155, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 15"><span class="mpre">(Stream s Identity tok) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_156_1_156_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_1_156_8&#39;)"><span class="hl_fundecl"><span class="mpre">newperm</span></span></a><span class="mpre"> </span><a name="loc_156_9_156_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">
  = </span><a href="#loc_121_32_121_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_32_121_36&#39;)"><span class="hl_conref"><span class="mpre">Perm</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_156_9_156_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) []

</span><a href="#loc_160_1_160_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_4&#39;)"><span class="mpre">add</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 159, srcSpanStartColumn = 8, srcSpanEndLine = 159, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 159, srcSpanStartColumn = 8, srcSpanEndLine = 159, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 159, "><span class="mpre">(Stream s Identity tok) =&gt;</span></span><span class="mpre"> </span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Parsec</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_160_1_160_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_4&#39;)"><span class="hl_fundecl"><span class="mpre">add</span></span></a><span class="mpre"> </span><a name="loc_160_5_160_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_5_160_9&#39;)"><span class="hl_specname"><span class="mpre">perm</span></span></a><span class="mpre">@(</span><a href="#loc_121_32_121_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_32_121_36&#39;)"><span class="hl_conref"><span class="mpre">Perm</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_mf</span></span><span class="mpre"> </span><a name="loc_160_20_160_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_20_160_22&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre">) </span><a name="loc_160_24_160_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_24_160_25&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">
  = </span><a href="#loc_121_32_121_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_32_121_36&#39;)"><span class="hl_conref"><span class="mpre">Perm</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> (</span><a href="#loc_163_5_163_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_5_163_10&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_164_5_164_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_5_164_11&#39;)"><span class="hl_varref"><span class="mpre">insert</span></span></a><span class="mpre"> </span><a href="#loc_160_20_160_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_20_160_22&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre">)
  where
    </span><a name="loc_163_5_163_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_5_163_10&#39;)"><span class="hl_vardecl"><span class="mpre">first</span></span></a><span class="mpre">   = </span><a href="#loc_125_38_125_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_38_125_44&#39;)"><span class="hl_conref"><span class="mpre">Branch</span></span></a><span class="mpre"> </span><a href="#loc_160_5_160_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_5_160_9&#39;)"><span class="hl_varref"><span class="mpre">perm</span></span></a><span class="mpre"> </span><a href="#loc_160_24_160_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_24_160_25&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    </span><a name="loc_164_5_164_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_5_164_11&#39;)"><span class="hl_fundecl"><span class="mpre">insert</span></span></a><span class="mpre"> (</span><a href="#loc_125_38_125_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_38_125_44&#39;)"><span class="hl_conref"><span class="mpre">Branch</span></span></a><span class="mpre"> </span><a name="loc_164_20_164_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_20_164_25&#39;)"><span class="hl_vardecl"><span class="mpre">perm&#39;</span></span></a><span class="mpre"> </span><a name="loc_164_26_164_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_26_164_28&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre">)
            = </span><a href="#loc_125_38_125_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_38_125_44&#39;)"><span class="hl_conref"><span class="mpre">Branch</span></span></a><span class="mpre"> (</span><a href="#loc_160_1_160_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_4&#39;)"><span class="hl_varref"><span class="mpre">add</span></span></a><span class="mpre"> (</span><a href="#loc_177_1_177_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_9&#39;)"><span class="hl_varref"><span class="mpre">mapPerms</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="#loc_164_20_164_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_20_164_25&#39;)"><span class="hl_varref"><span class="mpre">perm&#39;</span></span></a><span class="mpre">) </span><a href="#loc_160_24_160_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_24_160_25&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><a href="#loc_164_26_164_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_26_164_28&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre">

</span><a href="#loc_168_1_168_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_7&#39;)"><span class="mpre">addopt</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 167, srcSpanStartColumn = 11, srcSpanEndLine = 167, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 167, srcSpanStartColumn = 11, srcSpanEndLine = 167, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 16"><span class="mpre">(Stream s Identity tok) =&gt;</span></span><span class="mpre"> </span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Parsec</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_168_1_168_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_7&#39;)"><span class="hl_fundecl"><span class="mpre">addopt</span></span></a><span class="mpre"> </span><a name="loc_168_8_168_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_8_168_12&#39;)"><span class="hl_specname"><span class="mpre">perm</span></span></a><span class="mpre">@(</span><a href="#loc_121_32_121_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_32_121_36&#39;)"><span class="hl_conref"><span class="mpre">Perm</span></span></a><span class="mpre"> </span><a name="loc_168_19_168_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_19_168_21&#39;)"><span class="hl_vardecl"><span class="mpre">mf</span></span></a><span class="mpre"> </span><a name="loc_168_22_168_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_22_168_24&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre">) </span><a name="loc_168_26_168_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_26_168_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_168_28_168_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_28_168_29&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">
  = </span><a href="#loc_121_32_121_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_32_121_36&#39;)"><span class="hl_conref"><span class="mpre">Perm</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_168_26_168_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_26_168_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_168_19_168_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_19_168_21&#39;)"><span class="hl_varref"><span class="mpre">mf</span></span></a><span class="mpre">) (</span><a href="#loc_171_5_171_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_5_171_10&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_172_5_172_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_11&#39;)"><span class="hl_varref"><span class="mpre">insert</span></span></a><span class="mpre"> </span><a href="#loc_168_22_168_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_22_168_24&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre">)
  where
    </span><a name="loc_171_5_171_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_5_171_10&#39;)"><span class="hl_vardecl"><span class="mpre">first</span></span></a><span class="mpre">   = </span><a href="#loc_125_38_125_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_38_125_44&#39;)"><span class="hl_conref"><span class="mpre">Branch</span></span></a><span class="mpre"> </span><a href="#loc_168_8_168_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_8_168_12&#39;)"><span class="hl_varref"><span class="mpre">perm</span></span></a><span class="mpre"> </span><a href="#loc_168_28_168_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_28_168_29&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    </span><a name="loc_172_5_172_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_11&#39;)"><span class="hl_fundecl"><span class="mpre">insert</span></span></a><span class="mpre"> (</span><a href="#loc_125_38_125_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_38_125_44&#39;)"><span class="hl_conref"><span class="mpre">Branch</span></span></a><span class="mpre"> </span><a name="loc_172_20_172_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_20_172_25&#39;)"><span class="hl_vardecl"><span class="mpre">perm&#39;</span></span></a><span class="mpre"> </span><a name="loc_172_26_172_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_26_172_28&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre">)
            = </span><a href="#loc_125_38_125_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_38_125_44&#39;)"><span class="hl_conref"><span class="mpre">Branch</span></span></a><span class="mpre"> (</span><a href="#loc_168_1_168_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_7&#39;)"><span class="hl_varref"><span class="mpre">addopt</span></span></a><span class="mpre"> (</span><a href="#loc_177_1_177_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_9&#39;)"><span class="hl_varref"><span class="mpre">mapPerms</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="#loc_172_20_172_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_20_172_25&#39;)"><span class="hl_varref"><span class="mpre">perm&#39;</span></span></a><span class="mpre">) </span><a href="#loc_168_26_168_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_26_168_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_168_28_168_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_28_168_29&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><a href="#loc_172_26_172_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_26_172_28&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre">


</span><a href="#loc_177_1_177_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_9&#39;)"><span class="mpre">mapPerms</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 176, srcSpanStartColumn = 13, srcSpanEndLine = 176, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 176, srcSpanStartColumn = 13, srcSpanEndLine = 176, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/parsec-3.1.5/Text/Parsec/Perm.hs&quot;, srcSpanStartLine = 17"><span class="mpre">(Stream s Identity tok) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_121_6_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_6_121_22&#39;)"><span class="hl_tyconref"><span class="mpre">StreamPermParser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_177_1_177_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_9&#39;)"><span class="hl_fundecl"><span class="mpre">mapPerms</span></span></a><span class="mpre"> </span><a name="loc_177_10_177_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_10_177_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_121_32_121_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_32_121_36&#39;)"><span class="hl_conref"><span class="mpre">Perm</span></span></a><span class="mpre"> </span><a name="loc_177_18_177_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_18_177_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_177_20_177_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_20_177_22&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)
  = </span><a href="#loc_121_32_121_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_32_121_36&#39;)"><span class="hl_conref"><span class="mpre">Perm</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_177_10_177_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_10_177_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_177_18_177_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_18_177_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_180_5_180_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_5_180_14&#39;)"><span class="hl_varref"><span class="mpre">mapBranch</span></span></a><span class="mpre"> </span><a href="#loc_177_20_177_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_20_177_22&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
  where
    </span><a name="loc_180_5_180_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_5_180_14&#39;)"><span class="hl_fundecl"><span class="mpre">mapBranch</span></span></a><span class="mpre"> (</span><a href="#loc_125_38_125_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_38_125_44&#39;)"><span class="hl_conref"><span class="mpre">Branch</span></span></a><span class="mpre"> </span><a name="loc_180_23_180_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_23_180_27&#39;)"><span class="hl_vardecl"><span class="mpre">perm</span></span></a><span class="mpre"> </span><a name="loc_180_28_180_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_28_180_29&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">)
      = </span><a href="#loc_125_38_125_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_38_125_44&#39;)"><span class="hl_conref"><span class="mpre">Branch</span></span></a><span class="mpre"> (</span><a href="#loc_177_1_177_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_9&#39;)"><span class="hl_varref"><span class="mpre">mapPerms</span></span></a><span class="mpre"> (</span><a href="#loc_177_10_177_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_10_177_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">) </span><a href="#loc_180_23_180_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_23_180_27&#39;)"><span class="hl_varref"><span class="mpre">perm</span></span></a><span class="mpre">) </span><a href="#loc_180_28_180_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_28_180_29&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
</span></div></body></html>