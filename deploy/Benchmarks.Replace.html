<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}
</span><span class="hl_comment"><span class="mpre">-- | Replace a string by another string</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Tested in this benchmark:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Search and replace of a pattern in a text</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Benchmarks.Replace
    ( benchmark
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/benchmarks/haskell/Benchmarks/Replace.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 8, srcSpanEndLine = 12, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Criterion&quot;"><span class="mpre">Criterion</span></span><span class="mpre"> (Benchmark, bgroup, bench, nf)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/benchmarks/haskell/Benchmarks/Replace.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 18, srcSpanEndLine = 13, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as B
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/benchmarks/haskell/Benchmarks/Replace.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 18, srcSpanEndLine = 14, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as BL
import qualified Data.ByteString.Lazy.Search as BL
import qualified Data.ByteString.Search as B
import qualified Data.Text as T
import qualified Data.Text.Encoding as T
import qualified Data.Text.Lazy as TL
import qualified Data.Text.Lazy.Encoding as TL
import qualified Data.Text.Lazy.IO as TL

</span><a href="#loc_24_1_24_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_1_24_10&#39;)"><span class="mpre">benchmark</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Benchmark</span></span><span class="mpre">
</span><a name="loc_24_1_24_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_1_24_10&#39;)"><span class="hl_fundecl"><span class="mpre">benchmark</span></span></a><span class="mpre"> </span><a name="loc_24_11_24_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_11_24_13&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_24_14_24_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_14_24_17&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> </span><a name="loc_24_18_24_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_18_24_21&#39;)"><span class="hl_vardecl"><span class="mpre">sub</span></span></a><span class="mpre"> = do
    </span><a name="loc_25_5_25_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_7&#39;)"><span class="hl_vardecl"><span class="mpre">tl</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Text.Lazy.IO.html#loc_82_1_82_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.IO.html#loc_82_1_82_9&#39;)"><span class="hl_varref"><span class="mpre">TL.readFile</span></span></a><span class="mpre"> </span><a href="#loc_24_11_24_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_11_24_13&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">
    </span><a name="loc_26_5_26_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_5_26_7&#39;)"><span class="hl_vardecl"><span class="mpre">bl</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">BL.readFile</span></span><span class="mpre"> </span><a href="#loc_24_11_24_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_11_24_13&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">
    let !</span><a name="loc_27_10_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_10_27_11&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="Data.Text.Lazy.html#loc_393_1_393_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.html#loc_393_1_393_9&#39;)"><span class="hl_varref"><span class="mpre">TL.toStrict</span></span></a><span class="mpre"> </span><a href="#loc_25_5_25_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_7&#39;)"><span class="hl_varref"><span class="mpre">tl</span></span></a><span class="mpre">
        !</span><a name="loc_28_10_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_10_28_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">T.encodeUtf8</span></span></a><span class="mpre"> </span><a href="#loc_27_10_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_10_27_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">bgroup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Replace&quot;</span></span><span class="mpre"> [
          </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Text&quot;</span></span><span class="mpre">           </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nf</span></span><span class="mpre"> (</span><a href="Data.Text.html#loc_554_1_554_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_554_1_554_7&#39;)"><span class="hl_varref"><span class="mpre">T.length</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_635_1_635_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_635_1_635_8&#39;)"><span class="hl_varref"><span class="mpre">T.replace</span></span></a><span class="mpre"> </span><a href="#loc_36_5_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_5_36_9&#39;)"><span class="hl_varref"><span class="mpre">tpat</span></span></a><span class="mpre"> </span><a href="#loc_37_5_37_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_9&#39;)"><span class="hl_varref"><span class="mpre">tsub</span></span></a><span class="mpre">) </span><a href="#loc_27_10_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_10_27_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ByteString&quot;</span></span><span class="mpre">     </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nf</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BL.length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.ByteString.Search.html#loc_207_1_207_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.html#loc_207_1_207_8&#39;)"><span class="hl_varref"><span class="mpre">B.replace</span></span></a><span class="mpre"> </span><a href="#loc_40_5_40_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_5_40_9&#39;)"><span class="hl_varref"><span class="mpre">bpat</span></span></a><span class="mpre"> </span><a href="#loc_41_5_41_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_9&#39;)"><span class="hl_varref"><span class="mpre">bsub</span></span></a><span class="mpre">) </span><a href="#loc_28_10_28_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_10_28_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;LazyText&quot;</span></span><span class="mpre">       </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nf</span></span><span class="mpre"> (</span><a href="Data.Text.Lazy.html#loc_529_1_529_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.html#loc_529_1_529_7&#39;)"><span class="hl_varref"><span class="mpre">TL.length</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.Lazy.html#loc_652_1_652_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.html#loc_652_1_652_8&#39;)"><span class="hl_varref"><span class="mpre">TL.replace</span></span></a><span class="mpre"> </span><a href="#loc_38_5_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_5_38_10&#39;)"><span class="hl_varref"><span class="mpre">tlpat</span></span></a><span class="mpre"> </span><a href="#loc_39_5_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_10&#39;)"><span class="hl_varref"><span class="mpre">tlsub</span></span></a><span class="mpre">) </span><a href="#loc_25_5_25_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_7&#39;)"><span class="hl_varref"><span class="mpre">tl</span></span></a><span class="mpre">
        , </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;LazyByteString&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nf</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BL.length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.ByteString.Lazy.Search.html#loc_273_1_273_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Search.html#loc_273_1_273_8&#39;)"><span class="hl_varref"><span class="mpre">BL.replace</span></span></a><span class="mpre"> </span><a href="#loc_42_5_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_5_42_10&#39;)"><span class="hl_varref"><span class="mpre">blpat</span></span></a><span class="mpre"> </span><a href="#loc_43_5_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_5_43_10&#39;)"><span class="hl_varref"><span class="mpre">blsub</span></span></a><span class="mpre">) </span><a href="#loc_26_5_26_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_5_26_7&#39;)"><span class="hl_varref"><span class="mpre">bl</span></span></a><span class="mpre">
        ]
  where
    </span><a name="loc_36_5_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_5_36_9&#39;)"><span class="hl_vardecl"><span class="mpre">tpat</span></span></a><span class="mpre">  = </span><a href="Data.Text.html#loc_387_1_387_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_387_1_387_5&#39;)"><span class="hl_varref"><span class="mpre">T.pack</span></span></a><span class="mpre"> </span><a href="#loc_24_14_24_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_14_24_17&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_37_5_37_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_9&#39;)"><span class="hl_vardecl"><span class="mpre">tsub</span></span></a><span class="mpre">  = </span><a href="Data.Text.html#loc_387_1_387_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_387_1_387_5&#39;)"><span class="hl_varref"><span class="mpre">T.pack</span></span></a><span class="mpre"> </span><a href="#loc_24_18_24_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_18_24_21&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="mpre">
    </span><a name="loc_38_5_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_5_38_10&#39;)"><span class="hl_vardecl"><span class="mpre">tlpat</span></span></a><span class="mpre"> = </span><a href="Data.Text.Lazy.html#loc_348_1_348_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.html#loc_348_1_348_5&#39;)"><span class="hl_varref"><span class="mpre">TL.pack</span></span></a><span class="mpre"> </span><a href="#loc_24_14_24_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_14_24_17&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_39_5_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_10&#39;)"><span class="hl_vardecl"><span class="mpre">tlsub</span></span></a><span class="mpre"> = </span><a href="Data.Text.Lazy.html#loc_348_1_348_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.html#loc_348_1_348_5&#39;)"><span class="hl_varref"><span class="mpre">TL.pack</span></span></a><span class="mpre"> </span><a href="#loc_24_18_24_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_18_24_21&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="mpre">
    </span><a name="loc_40_5_40_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_5_40_9&#39;)"><span class="hl_vardecl"><span class="mpre">bpat</span></span></a><span class="mpre"> = </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">T.encodeUtf8</span></span></a><span class="mpre"> </span><a href="#loc_36_5_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_5_36_9&#39;)"><span class="hl_varref"><span class="mpre">tpat</span></span></a><span class="mpre">
    </span><a name="loc_41_5_41_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_9&#39;)"><span class="hl_vardecl"><span class="mpre">bsub</span></span></a><span class="mpre"> = </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">T.encodeUtf8</span></span></a><span class="mpre"> </span><a href="#loc_37_5_37_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_9&#39;)"><span class="hl_varref"><span class="mpre">tsub</span></span></a><span class="mpre">
    </span><a name="loc_42_5_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_5_42_10&#39;)"><span class="hl_vardecl"><span class="mpre">blpat</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BL.toChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Text.Lazy.Encoding.html#loc_153_1_153_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.Encoding.html#loc_153_1_153_11&#39;)"><span class="hl_varref"><span class="mpre">TL.encodeUtf8</span></span></a><span class="mpre"> </span><a href="#loc_38_5_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_5_38_10&#39;)"><span class="hl_varref"><span class="mpre">tlpat</span></span></a><span class="mpre">
    </span><a name="loc_43_5_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_5_43_10&#39;)"><span class="hl_vardecl"><span class="mpre">blsub</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BL.toChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Text.Lazy.Encoding.html#loc_153_1_153_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.Encoding.html#loc_153_1_153_11&#39;)"><span class="hl_varref"><span class="mpre">TL.encodeUtf8</span></span></a><span class="mpre"> </span><a href="#loc_39_5_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_10&#39;)"><span class="hl_varref"><span class="mpre">tlsub</span></span></a><span class="mpre">
</span></div></body></html>