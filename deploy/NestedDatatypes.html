<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS -fglasgow-exts #-}
{-# LANGUAGE UndecidableInstances #-}
{-# LANGUAGE DeriveDataTypeable   #-}

module NestedDatatypes () where

</span><span class="hl_comment"><span class="mpre">{-

We provide an illustrative ScrapYourBoilerplate example for a nested
datatype.  For clarity, we do not derive the Typeable and Data
instances by the deriving mechanism but we show the intended
definitions. The overall conclusion is that nested datatypes do not
pose any challenge for the ScrapYourBoilerplate scheme. Well, this is
maybe not quite true because it seems like we need to allow
undecidable instances.

-}</span></span><span class="mpre">

import Data.Dynamic
import Data.Generics

 
</span><span class="hl_comment"><span class="mpre">-- A nested datatype</span></span><span class="mpre">
data </span><a name="loc_24_6_24_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_6_24_10&#39;)"><span class="hl_tycondecl"><span class="mpre">Nest</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_24_15_24_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_15_24_18&#39;)"><span class="hl_condecl"><span class="mpre">Box</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> | </span><a name="loc_24_23_24_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_23_24_27&#39;)"><span class="hl_condecl"><span class="mpre">Wrap</span></span></a><span class="mpre"> (</span><a href="#loc_24_6_24_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_6_24_10&#39;)"><span class="hl_tyconref"><span class="mpre">Nest</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]) </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/NestedDatatypes.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 39, srcSpanEndLine = 24, srcSpanEndColumn = 56}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/NestedDatatypes.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 39, srcSpanEndLine = 24, srcSpanEndColumn = 47}]}) [IHead (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/N"><span class="mpre">deriving Typeable</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- The Data instance for the nested datatype</span></span><span class="mpre">
instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/NestedDatatypes.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 10, srcSpanEndLine = 28, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/NestedDatatypes.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 10, srcSpanEndLine = 28, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/NestedDatatypes.hs&quot;, srcSpanStartLine = "><span class="mpre">(Data a, Data [a]) =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Data</span></span><span class="mpre"> (</span><a href="#loc_24_6_24_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_6_24_10&#39;)"><span class="hl_tyconref"><span class="mpre">Nest</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
  where
    </span><a name="loc_30_5_30_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_5_30_11&#39;)"><span class="hl_fundecl"><span class="mpre">gfoldl</span></span></a><span class="mpre"> </span><a name="loc_30_12_30_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_12_30_13&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_30_14_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_15&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> (</span><a href="#loc_24_15_24_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_15_24_18&#39;)"><span class="hl_conref"><span class="mpre">Box</span></span></a><span class="mpre"> </span><a name="loc_30_21_30_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_21_30_22&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">)  = </span><a href="#loc_30_14_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_15&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_24_15_24_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_15_24_18&#39;)"><span class="hl_conref"><span class="mpre">Box</span></span></a><span class="mpre"> </span><a href="#loc_30_12_30_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_12_30_13&#39;)"><span class="hl_infix"><span class="mpre">`k`</span></span></a><span class="mpre"> </span><a href="#loc_30_21_30_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_21_30_22&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
    </span><a href="#loc_30_5_30_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_5_30_11&#39;)"><span class="hl_fundecl"><span class="mpre">gfoldl</span></span></a><span class="mpre"> </span><a name="loc_31_12_31_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_12_31_13&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_31_14_31_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_14_31_15&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> (</span><a href="#loc_24_23_24_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_23_24_27&#39;)"><span class="hl_conref"><span class="mpre">Wrap</span></span></a><span class="mpre"> </span><a name="loc_31_22_31_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_22_31_23&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) = </span><a href="#loc_31_14_31_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_14_31_15&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_24_23_24_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_23_24_27&#39;)"><span class="hl_conref"><span class="mpre">Wrap</span></span></a><span class="mpre"> </span><a href="#loc_31_12_31_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_12_31_13&#39;)"><span class="hl_infix"><span class="mpre">`k`</span></span></a><span class="mpre"> </span><a href="#loc_31_22_31_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_22_31_23&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">
    </span><a name="loc_32_5_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_5_32_10&#39;)"><span class="hl_fundecl"><span class="mpre">gmapT</span></span></a><span class="mpre"> </span><a name="loc_32_11_32_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_24_15_24_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_15_24_18&#39;)"><span class="hl_conref"><span class="mpre">Box</span></span></a><span class="mpre"> </span><a name="loc_32_18_32_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_18_32_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">)  = </span><a href="#loc_24_15_24_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_15_24_18&#39;)"><span class="hl_conref"><span class="mpre">Box</span></span></a><span class="mpre"> (</span><a href="#loc_32_11_32_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_32_18_32_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_18_32_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
    </span><a href="#loc_32_5_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_5_32_10&#39;)"><span class="hl_fundecl"><span class="mpre">gmapT</span></span></a><span class="mpre"> </span><a name="loc_33_11_33_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_11_33_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_24_23_24_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_23_24_27&#39;)"><span class="hl_conref"><span class="mpre">Wrap</span></span></a><span class="mpre"> </span><a name="loc_33_19_33_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_19_33_20&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) = </span><a href="#loc_24_23_24_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_23_24_27&#39;)"><span class="hl_conref"><span class="mpre">Wrap</span></span></a><span class="mpre"> (</span><a href="#loc_33_11_33_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_11_33_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_33_19_33_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_19_33_20&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)
    </span><a name="loc_34_5_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_5_34_13&#39;)"><span class="hl_fundecl"><span class="mpre">toConstr</span></span></a><span class="mpre"> (</span><a href="#loc_24_15_24_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_15_24_18&#39;)"><span class="hl_conref"><span class="mpre">Box</span></span></a><span class="mpre"> _)  = </span><a href="#loc_41_1_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_10&#39;)"><span class="hl_varref"><span class="mpre">boxConstr</span></span></a><span class="mpre">
    </span><a href="#loc_34_5_34_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_5_34_13&#39;)"><span class="hl_fundecl"><span class="mpre">toConstr</span></span></a><span class="mpre"> (</span><a href="#loc_24_23_24_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_23_24_27&#39;)"><span class="hl_conref"><span class="mpre">Wrap</span></span></a><span class="mpre"> _) = </span><a href="#loc_42_1_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_11&#39;)"><span class="hl_varref"><span class="mpre">wrapConstr</span></span></a><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">gunfold</span></span><span class="mpre"> </span><a name="loc_36_13_36_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_13_36_14&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_36_15_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_15_36_16&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> </span><a name="loc_36_17_36_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_17_36_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">constrIndex</span></span><span class="mpre"> </span><a href="#loc_36_17_36_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_17_36_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> of
                      </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> -&gt; </span><a href="#loc_36_13_36_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_13_36_14&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_36_15_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_15_36_16&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_24_15_24_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_15_24_18&#39;)"><span class="hl_conref"><span class="mpre">Box</span></span></a><span class="mpre">)
                      </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> -&gt; </span><a href="#loc_36_13_36_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_13_36_14&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_36_15_36_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_15_36_16&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_24_23_24_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_23_24_27&#39;)"><span class="hl_conref"><span class="mpre">Wrap</span></span></a><span class="mpre">)
    </span><span class="hl_fundecl"><span class="mpre">dataTypeOf</span></span><span class="mpre"> _ = </span><a href="#loc_43_1_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_13&#39;)"><span class="hl_varref"><span class="mpre">nestDataType</span></span></a><span class="mpre">

</span><a name="loc_41_1_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_10&#39;)"><span class="hl_vardecl"><span class="mpre">boxConstr</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">mkConstr</span></span><span class="mpre"> </span><a href="#loc_43_1_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_13&#39;)"><span class="hl_varref"><span class="mpre">nestDataType</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Box&quot;</span></span><span class="mpre">  [] </span><span class="hl_conref"><span class="mpre">Prefix</span></span><span class="mpre">
</span><a name="loc_42_1_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_11&#39;)"><span class="hl_vardecl"><span class="mpre">wrapConstr</span></span></a><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">mkConstr</span></span><span class="mpre"> </span><a href="#loc_43_1_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_13&#39;)"><span class="hl_varref"><span class="mpre">nestDataType</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Wrap&quot;</span></span><span class="mpre"> [] </span><span class="hl_conref"><span class="mpre">Prefix</span></span><span class="mpre">
</span><a name="loc_43_1_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_13&#39;)"><span class="hl_vardecl"><span class="mpre">nestDataType</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mkDataType</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Main.Nest&quot;</span></span><span class="mpre"> [</span><a href="#loc_41_1_41_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_10&#39;)"><span class="hl_varref"><span class="mpre">boxConstr</span></span></a><span class="mpre">,</span><a href="#loc_42_1_42_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_11&#39;)"><span class="hl_varref"><span class="mpre">wrapConstr</span></span></a><span class="mpre">]
</span></div></body></html>