<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS -fglasgow-exts #-}

module Perm (tests) where

</span><span class="hl_comment"><span class="mpre">{-

This module illustrates permutation phrases.
Disclaimer: this is a perhaps naive, certainly undebugged example.

-}</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 8, srcSpanEndLine = 12, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">

import Control.Monad
import Data.Generics

</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We want to read terms of type T3 regardless of the order T1 and T2.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------------</span></span><span class="mpre">

data </span><a name="loc_21_6_21_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_6_21_8&#39;)"><span class="hl_tycondecl"><span class="mpre">T1</span></span></a><span class="mpre"> = </span><a name="loc_21_11_21_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_11_21_13&#39;)"><span class="hl_condecl"><span class="mpre">T1</span></span></a><span class="mpre">       </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 20, srcSpanEndLine = 21, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 20, srcSpanEndLine = 21, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 29, src"><span class="mpre">deriving (Show, Eq, Typeable, Data)</span></span><span class="mpre">
data </span><a name="loc_22_6_22_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_6_22_8&#39;)"><span class="hl_tycondecl"><span class="mpre">T2</span></span></a><span class="mpre"> = </span><a name="loc_22_11_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_11_22_13&#39;)"><span class="hl_condecl"><span class="mpre">T2</span></span></a><span class="mpre">       </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 20, srcSpanEndLine = 22, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 20, srcSpanEndLine = 22, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 29, src"><span class="mpre">deriving (Show, Eq, Typeable, Data)</span></span><span class="mpre">
data </span><a name="loc_23_6_23_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_6_23_8&#39;)"><span class="hl_tycondecl"><span class="mpre">T3</span></span></a><span class="mpre"> = </span><a name="loc_23_11_23_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_13&#39;)"><span class="hl_condecl"><span class="mpre">T3</span></span></a><span class="mpre"> </span><a href="#loc_21_6_21_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_6_21_8&#39;)"><span class="hl_tyconref"><span class="mpre">T1</span></span></a><span class="mpre"> </span><a href="#loc_22_6_22_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_6_22_8&#39;)"><span class="hl_tyconref"><span class="mpre">T2</span></span></a><span class="mpre"> </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 20, srcSpanEndLine = 23, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 20, srcSpanEndLine = 23, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 29, src"><span class="mpre">deriving (Show, Eq, Typeable, Data)</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A silly monad that we use to read lists of constructor strings.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Type constructor</span></span><span class="mpre">
newtype </span><a name="loc_31_9_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_14&#39;)"><span class="hl_tycondecl"><span class="mpre">ReadT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_31_19_31_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_19_31_24&#39;)"><span class="hl_condecl"><span class="mpre">ReadT</span></span></a><span class="mpre"> { </span><a name="loc_31_27_31_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_27_31_34&#39;)"><span class="hl_fielddecl"><span class="mpre">unReadT</span></span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> ([</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">],</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) }



</span><span class="hl_comment"><span class="mpre">-- Run a computation</span></span><span class="mpre">
</span><a name="loc_36_1_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_9&#39;)"><span class="hl_fundecl"><span class="mpre">runReadT</span></span></a><span class="mpre"> </span><a name="loc_36_10_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_10_36_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_36_12_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_12_36_13&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = case </span><a href="#loc_31_27_31_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_27_31_34&#39;)"><span class="hl_varref"><span class="mpre">unReadT</span></span></a><span class="mpre"> </span><a href="#loc_36_10_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_10_36_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_36_12_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_12_36_13&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> of
                 </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> ([],</span><a name="loc_37_27_37_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_27_37_28&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_37_27_37_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_27_37_28&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                 _           -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Read one string</span></span><span class="mpre">
</span><a href="#loc_42_1_42_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_6&#39;)"><span class="mpre">readT</span></a><span class="mpre"> :: </span><a href="#loc_31_9_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadT</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_42_1_42_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_6&#39;)"><span class="hl_vardecl"><span class="mpre">readT</span></span></a><span class="mpre"> =  </span><a href="#loc_31_19_31_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_19_31_24&#39;)"><span class="hl_conref"><span class="mpre">ReadT</span></span></a><span class="mpre"> (\</span><a name="loc_42_18_42_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_18_42_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_42_18_42_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_18_42_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                        then </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                        else </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><a href="#loc_42_18_42_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_18_42_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_42_18_42_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_18_42_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
               )

</span><span class="hl_comment"><span class="mpre">-- ReadT is a monad!</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> </span><a href="#loc_31_9_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadT</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_49_10_49_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_10_49_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_31_19_31_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_19_31_24&#39;)"><span class="hl_conref"><span class="mpre">ReadT</span></span></a><span class="mpre"> (\</span><a name="loc_49_22_49_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_22_49_23&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_49_22_49_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_22_49_23&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">,</span><a href="#loc_49_10_49_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_10_49_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">))
  </span><a name="loc_50_3_50_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_3_50_4&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_50_9_50_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">  = </span><a href="#loc_31_19_31_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_19_31_24&#39;)"><span class="hl_conref"><span class="mpre">ReadT</span></span></a><span class="mpre"> (\</span><a name="loc_50_22_50_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_22_50_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_31_27_31_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_27_31_34&#39;)"><span class="hl_varref"><span class="mpre">unReadT</span></span></a><span class="mpre"> </span><a href="#loc_50_3_50_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_3_50_4&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_50_22_50_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_22_50_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
                            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_52_35_52_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_35_52_37&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre">, </span><a name="loc_52_39_52_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_39_52_40&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_31_27_31_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_27_31_34&#39;)"><span class="hl_varref"><span class="mpre">unReadT</span></span></a><span class="mpre"> (</span><a href="#loc_50_9_50_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_52_39_52_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_39_52_40&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_52_35_52_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_35_52_37&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre">
                   )

</span><span class="hl_comment"><span class="mpre">-- ReadT also accommodates mzero and mplus!</span></span><span class="mpre">
instance </span><a href="Control.Monad.html#loc_122_18_122_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_122_18_122_27&#39;)"><span class="hl_classref"><span class="mpre">MonadPlus</span></span></a><span class="mpre"> </span><a href="#loc_31_9_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadT</span></span></a><span class="mpre"> where
  </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_vardecl"><span class="mpre">mzero</span></span></a><span class="mpre"> = </span><a href="#loc_31_19_31_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_19_31_24&#39;)"><span class="hl_conref"><span class="mpre">ReadT</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)
  </span><a name="loc_58_3_58_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_3_58_4&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_fundecl"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a name="loc_58_13_58_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_31_19_31_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_19_31_24&#39;)"><span class="hl_conref"><span class="mpre">ReadT</span></span></a><span class="mpre"> (\</span><a name="loc_58_25_58_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_25_58_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_31_27_31_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_27_31_34&#39;)"><span class="hl_varref"><span class="mpre">unReadT</span></span></a><span class="mpre"> </span><a href="#loc_58_3_58_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_3_58_4&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_58_25_58_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_25_58_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
                               </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_31_27_31_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_27_31_34&#39;)"><span class="hl_varref"><span class="mpre">unReadT</span></span></a><span class="mpre"> </span><a href="#loc_58_13_58_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_58_25_58_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_25_58_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                               </span><a name="loc_60_32_60_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_32_60_33&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_60_32_60_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_32_60_33&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                      )


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A helper type to appeal to predicative type system.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------------</span></span><span class="mpre">

newtype </span><a name="loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_tycondecl"><span class="mpre">GenM</span></span></a><span class="mpre"> = </span><a name="loc_68_16_68_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_16_68_20&#39;)"><span class="hl_condecl"><span class="mpre">GenM</span></span></a><span class="mpre"> { </span><a name="loc_68_23_68_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_23_68_29&#39;)"><span class="hl_fielddecl"><span class="mpre">unGenM</span></span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 43, srcSpanEndLine = 68, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 50, srcSpanEndLine = 68, srcSpanEndColumn = 52}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStart"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_31_9_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> }


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The function that reads and copes with all permutations.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_76_1_76_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_7&#39;)"><span class="mpre">buildT</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 21, srcSpanEndLine = 75, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 28, srcSpanEndLine = 75, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStart"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><a href="#loc_31_9_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_76_1_76_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_7&#39;)"><span class="hl_vardecl"><span class="mpre">buildT</span></span></a><span class="mpre"> = </span><a href="#loc_79_3_79_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_3_79_9&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre">

 where
  </span><a name="loc_79_3_79_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_3_79_9&#39;)"><span class="hl_vardecl"><span class="mpre">result</span></span></a><span class="mpre"> = do </span><a name="loc_79_15_79_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_15_79_18&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_42_1_42_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_6&#39;)"><span class="hl_varref"><span class="mpre">readT</span></span></a><span class="mpre">
              </span><a name="loc_80_15_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_15_80_18&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_92_3_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_16&#39;)"><span class="hl_varref"><span class="mpre">string2constr</span></span></a><span class="mpre"> </span><a href="#loc_79_15_79_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_15_79_18&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
              </span><a name="loc_81_15_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_15_81_18&#39;)"><span class="hl_vardecl"><span class="mpre">ske</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromConstr</span></span><span class="mpre"> </span><a href="#loc_80_15_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_15_80_18&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">
              </span><a name="loc_82_15_82_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_15_82_17&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre">  &lt;- </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> </span><a href="#loc_98_3_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_3_98_10&#39;)"><span class="hl_varref"><span class="mpre">buildT&#39;</span></span></a><span class="mpre"> </span><a href="#loc_81_15_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_15_81_18&#39;)"><span class="hl_varref"><span class="mpre">ske</span></span></a><span class="mpre">
              </span><a href="#loc_102_3_102_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_3_102_7&#39;)"><span class="hl_varref"><span class="mpre">perm</span></span></a><span class="mpre"> [] </span><a href="#loc_82_15_82_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_15_82_17&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre"> </span><a href="#loc_81_15_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_15_81_18&#39;)"><span class="hl_varref"><span class="mpre">ske</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Determine type of data to be constructed</span></span><span class="mpre">
  </span><a name="loc_86_3_86_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_3_86_9&#39;)"><span class="hl_vardecl"><span class="mpre">myType</span></span></a><span class="mpre"> = </span><a href="#loc_89_7_89_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_15&#39;)"><span class="hl_varref"><span class="mpre">myTypeOf</span></span></a><span class="mpre"> </span><a href="#loc_79_3_79_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_3_79_9&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre">
    where
      </span><a href="#loc_89_7_89_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_15&#39;)"><span class="mpre">myTypeOf</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><a href="#loc_31_9_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
      </span><a name="loc_89_7_89_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_15&#39;)"><span class="hl_vardecl"><span class="mpre">myTypeOf</span></span></a><span class="mpre"> =  </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Turn string into constructor</span></span><span class="mpre">
  </span><a name="loc_92_3_92_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_16&#39;)"><span class="hl_fundecl"><span class="mpre">string2constr</span></span></a><span class="mpre"> </span><a name="loc_92_17_92_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_17_92_20&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_varref"><span class="mpre">mzero</span></span></a><span class="mpre">
                            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">
                            (</span><span class="hl_varref"><span class="mpre">readConstr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">dataTypeOf</span></span><span class="mpre"> </span><a href="#loc_86_3_86_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_3_86_9&#39;)"><span class="hl_varref"><span class="mpre">myType</span></span></a><span class="mpre">) </span><a href="#loc_92_17_92_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_17_92_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)

  </span><span class="hl_comment"><span class="mpre">-- Specialise buildT per kid type</span></span><span class="mpre">
  </span><a href="#loc_98_3_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_3_98_10&#39;)"><span class="mpre">buildT&#39;</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 24, srcSpanEndLine = 97, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 31, srcSpanEndLine = 97, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStart"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_tyconref"><span class="mpre">GenM</span></span></a><span class="mpre">
  </span><a name="loc_98_3_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_3_98_10&#39;)"><span class="hl_fundecl"><span class="mpre">buildT&#39;</span></span></a><span class="mpre"> (_::</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) = </span><a href="#loc_68_16_68_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_16_68_20&#39;)"><span class="hl_conref"><span class="mpre">GenM</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_varref"><span class="mpre">mzero</span></span></a><span class="mpre"> </span><a href="Data.Generics.Aliases.html#loc_186_1_186_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_186_1_186_5&#39;)"><span class="hl_infix"><span class="mpre">`extM`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> (</span><a href="#loc_76_1_76_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_7&#39;)"><span class="hl_varref"><span class="mpre">buildT</span></span></a><span class="mpre">::</span><a href="#loc_31_9_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">))

  </span><span class="hl_comment"><span class="mpre">-- The permutation exploration function</span></span><span class="mpre">
  </span><a href="#loc_102_3_102_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_3_102_7&#39;)"><span class="mpre">perm</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 101, srcSpanStartColumn = 21, srcSpanEndLine = 101, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanStartLine = 101, srcSpanStartColumn = 28, srcSpanEndLine = 101, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Perm.hs&quot;, srcSpanS"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> [</span><a href="#loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_tyconref"><span class="mpre">GenM</span></span></a><span class="mpre">] -&gt; [</span><a href="#loc_68_9_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_13&#39;)"><span class="hl_tyconref"><span class="mpre">GenM</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_31_9_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_9_31_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadT</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
  </span><a name="loc_102_3_102_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_3_102_7&#39;)"><span class="hl_fundecl"><span class="mpre">perm</span></span></a><span class="mpre"> [] [] </span><a name="loc_102_14_102_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_14_102_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_102_14_102_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_14_102_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
  </span><a href="#loc_102_3_102_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_3_102_7&#39;)"><span class="hl_fundecl"><span class="mpre">perm</span></span></a><span class="mpre"> </span><a name="loc_103_8_103_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_8_103_10&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre"> [] </span><a name="loc_103_14_103_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_14_103_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_102_3_102_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_3_102_7&#39;)"><span class="hl_varref"><span class="mpre">perm</span></span></a><span class="mpre"> [] </span><a href="#loc_103_8_103_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_8_103_10&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre"> </span><a href="#loc_103_14_103_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_14_103_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
  </span><a href="#loc_102_3_102_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_3_102_7&#39;)"><span class="hl_fundecl"><span class="mpre">perm</span></span></a><span class="mpre"> </span><a name="loc_104_8_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_8_104_10&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre"> (</span><a name="loc_104_12_104_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_12_104_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_104_14_104_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_14_104_17&#39;)"><span class="hl_vardecl"><span class="mpre">fs&#39;</span></span></a><span class="mpre">) </span><a name="loc_104_19_104_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_19_104_20&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = (
                        do </span><a name="loc_105_28_105_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_28_105_30&#39;)"><span class="hl_vardecl"><span class="mpre">a&#39;</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">gmapMo</span></span><span class="mpre"> (</span><a href="#loc_68_23_68_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_23_68_29&#39;)"><span class="hl_varref"><span class="mpre">unGenM</span></span></a><span class="mpre"> </span><a href="#loc_104_12_104_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_12_104_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_104_19_104_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_19_104_20&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
                           </span><a href="#loc_102_3_102_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_3_102_7&#39;)"><span class="hl_varref"><span class="mpre">perm</span></span></a><span class="mpre"> </span><a href="#loc_104_8_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_8_104_10&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre"> </span><a href="#loc_104_14_104_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_14_104_17&#39;)"><span class="hl_varref"><span class="mpre">fs&#39;</span></span></a><span class="mpre"> </span><a href="#loc_105_28_105_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_28_105_30&#39;)"><span class="hl_varref"><span class="mpre">a&#39;</span></span></a><span class="mpre">
                      )
                        </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre">
                      (
                        do </span><a href="Control.Monad.html#loc_148_1_148_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_148_1_148_6&#39;)"><span class="hl_varref"><span class="mpre">guard</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_104_14_104_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_14_104_17&#39;)"><span class="hl_varref"><span class="mpre">fs&#39;</span></span></a><span class="mpre">))
                           </span><a href="#loc_102_3_102_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_3_102_7&#39;)"><span class="hl_varref"><span class="mpre">perm</span></span></a><span class="mpre"> (</span><a href="#loc_104_12_104_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_12_104_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_104_8_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_8_104_10&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre">) </span><a href="#loc_104_14_104_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_14_104_17&#39;)"><span class="hl_varref"><span class="mpre">fs&#39;</span></span></a><span class="mpre"> </span><a href="#loc_104_19_104_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_19_104_20&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
                      )


</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The main function for testing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">---------------------------------------------------------------------------</span></span><span class="mpre">

</span><a name="loc_119_1_119_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> =
     ( </span><a href="#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">runReadT</span></span></a><span class="mpre"> </span><a href="#loc_76_1_76_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_7&#39;)"><span class="hl_varref"><span class="mpre">buildT</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;T1&quot;</span></span><span class="mpre">] :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_21_6_21_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_6_21_8&#39;)"><span class="hl_tyconref"><span class="mpre">T1</span></span></a><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- should parse fine</span></span><span class="mpre">
   , ( </span><a href="#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">runReadT</span></span></a><span class="mpre"> </span><a href="#loc_76_1_76_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_7&#39;)"><span class="hl_varref"><span class="mpre">buildT</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;T2&quot;</span></span><span class="mpre">] :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_22_6_22_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_6_22_8&#39;)"><span class="hl_tyconref"><span class="mpre">T2</span></span></a><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- should parse fine</span></span><span class="mpre">
   , ( </span><a href="#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">runReadT</span></span></a><span class="mpre"> </span><a href="#loc_76_1_76_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_7&#39;)"><span class="hl_varref"><span class="mpre">buildT</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;T3&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;T1&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;T2&quot;</span></span><span class="mpre">] :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_23_6_23_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_6_23_8&#39;)"><span class="hl_tyconref"><span class="mpre">T3</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- should parse fine</span></span><span class="mpre">
   , ( </span><a href="#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">runReadT</span></span></a><span class="mpre"> </span><a href="#loc_76_1_76_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_7&#39;)"><span class="hl_varref"><span class="mpre">buildT</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;T3&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;T2&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;T1&quot;</span></span><span class="mpre">] :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_23_6_23_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_6_23_8&#39;)"><span class="hl_tyconref"><span class="mpre">T3</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- should parse fine</span></span><span class="mpre">
   , ( </span><a href="#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">runReadT</span></span></a><span class="mpre"> </span><a href="#loc_76_1_76_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_7&#39;)"><span class="hl_varref"><span class="mpre">buildT</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;T3&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;T2&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;T2&quot;</span></span><span class="mpre">] :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_23_6_23_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_6_23_8&#39;)"><span class="hl_tyconref"><span class="mpre">T3</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- should fail</span></span><span class="mpre">
   ))))) </span><span class="hl_infix"><span class="mpre">~=?</span></span><span class="mpre"> </span><a href="#loc_127_1_127_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_7&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">

</span><a name="loc_127_1_127_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_7&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_21_11_21_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_11_21_13&#39;)"><span class="hl_conref"><span class="mpre">T1</span></span></a><span class="mpre">,(</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_22_11_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_11_22_13&#39;)"><span class="hl_conref"><span class="mpre">T2</span></span></a><span class="mpre">,(</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_23_11_23_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_13&#39;)"><span class="hl_conref"><span class="mpre">T3</span></span></a><span class="mpre"> </span><a href="#loc_21_11_21_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_11_21_13&#39;)"><span class="hl_conref"><span class="mpre">T1</span></span></a><span class="mpre"> </span><a href="#loc_22_11_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_11_22_13&#39;)"><span class="hl_conref"><span class="mpre">T2</span></span></a><span class="mpre">),(</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_23_11_23_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_13&#39;)"><span class="hl_conref"><span class="mpre">T3</span></span></a><span class="mpre"> </span><a href="#loc_21_11_21_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_11_21_13&#39;)"><span class="hl_conref"><span class="mpre">T1</span></span></a><span class="mpre"> </span><a href="#loc_22_11_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_11_22_13&#39;)"><span class="hl_conref"><span class="mpre">T2</span></span></a><span class="mpre">),</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">))))
</span></div></body></html>