<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.X509.Validation.Signature</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- X.509 Certificate and CRL signature verification</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.X509.Validation.Signature
    ( verifySignedSignature
    , verifySignature
    , SignatureVerification(..)
    , SignatureFailure(..)
    ) where

import qualified Crypto.PubKey.RSA.PKCS15 as RSA
import qualified Crypto.PubKey.DSA as DSA
import qualified Crypto.Hash.SHA1 as SHA1

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Signature.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 8, srcSpanEndLine = 21, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import Data.X509
import Data.X509.Validation.Fingerprint
import Data.ASN1.Types
import Data.ASN1.Encoding
import Data.ASN1.BinaryEncoding

</span><span class="hl_comment"><span class="mpre">-- | A set of possible return from signature verification.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- When SignatureFailed is return, the signature shouldn&#39;t be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- accepted.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Other values are only useful to differentiate the failure</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- reason, but are all equivalent to failure.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
data </span><a name="loc_36_6_36_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_6_36_27&#39;)"><span class="hl_tycondecl"><span class="mpre">SignatureVerification</span></span></a><span class="mpre"> =
      </span><a name="loc_37_7_37_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_20&#39;)"><span class="hl_condecl"><span class="mpre">SignaturePass</span></span></a><span class="mpre">                    </span><span class="hl_comment"><span class="mpre">-- ^ verification succeeded</span></span><span class="mpre">
    | </span><a name="loc_38_7_38_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_22&#39;)"><span class="hl_condecl"><span class="mpre">SignatureFailed</span></span></a><span class="mpre"> </span><a href="#loc_42_6_42_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_6_42_22&#39;)"><span class="hl_tyconref"><span class="mpre">SignatureFailure</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ verification failed</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Signature.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 5, srcSpanEndLine = 39, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Signature.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 5, srcSpanEndLine = 39, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Various failure possible during signature checking</span></span><span class="mpre">
data </span><a name="loc_42_6_42_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_6_42_22&#39;)"><span class="hl_tycondecl"><span class="mpre">SignatureFailure</span></span></a><span class="mpre"> =
      </span><a name="loc_43_7_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_23&#39;)"><span class="hl_condecl"><span class="mpre">SignatureInvalid</span></span></a><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- ^ signature doesn&#39;t verify</span></span><span class="mpre">
    | </span><a name="loc_44_7_44_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_30&#39;)"><span class="hl_condecl"><span class="mpre">SignaturePubkeyMismatch</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ algorithm and public key mismatch, cannot proceed</span></span><span class="mpre">
    | </span><a name="loc_45_7_45_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_7_45_29&#39;)"><span class="hl_condecl"><span class="mpre">SignatureUnimplemented</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ unimplemented signature algorithm</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Signature.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 5, srcSpanEndLine = 46, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Signature.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 5, srcSpanEndLine = 46, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Verify a Signed object against a specified public key</span></span><span class="mpre">
</span><a href="#loc_53_1_53_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_22&#39;)"><span class="mpre">verifySignedSignature</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Signature.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 26, srcSpanEndLine = 50, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validation-1.5.0/Data/X509/Validation/Signature.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 26, srcSpanEndLine = 49, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-validatio"><span class="mpre">(Show a, Eq a, ASN1Object a)
                      =&gt;</span></span><span class="mpre"> </span><a href="Data.X509.Signed.html#loc_65_38_65_49" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_65_38_65_49&#39;)"><span class="hl_tyconref"><span class="mpre">SignedExact</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
                      -&gt; </span><a href="Data.X509.PublicKey.html#loc_31_6_31_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.PublicKey.html#loc_31_6_31_12&#39;)"><span class="hl_tyconref"><span class="mpre">PubKey</span></span></a><span class="mpre">
                      -&gt; </span><a href="#loc_36_6_36_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_6_36_27&#39;)"><span class="hl_tyconref"><span class="mpre">SignatureVerification</span></span></a><span class="mpre">
</span><a name="loc_53_1_53_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_22&#39;)"><span class="hl_fundecl"><span class="mpre">verifySignedSignature</span></span></a><span class="mpre"> </span><a name="loc_53_23_53_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_23_53_32&#39;)"><span class="hl_vardecl"><span class="mpre">signedObj</span></span></a><span class="mpre"> </span><a name="loc_53_33_53_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_33_53_39&#39;)"><span class="hl_vardecl"><span class="mpre">pubKey</span></span></a><span class="mpre"> =
    </span><a href="#loc_66_1_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_16&#39;)"><span class="hl_varref"><span class="mpre">verifySignature</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">signedAlg</span></span><span class="mpre"> </span><a href="#loc_58_9_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_15&#39;)"><span class="hl_varref"><span class="mpre">signed</span></span></a><span class="mpre">)
                    </span><a href="#loc_53_33_53_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_33_53_39&#39;)"><span class="hl_varref"><span class="mpre">pubKey</span></span></a><span class="mpre">
                    (</span><a href="Data.X509.Signed.html#loc_76_1_76_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_76_1_76_14&#39;)"><span class="hl_varref"><span class="mpre">getSignedData</span></span></a><span class="mpre"> </span><a href="#loc_53_23_53_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_23_53_32&#39;)"><span class="hl_varref"><span class="mpre">signedObj</span></span></a><span class="mpre">)
                    (</span><span class="hl_varref"><span class="mpre">signedSignature</span></span><span class="mpre"> </span><a href="#loc_58_9_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_15&#39;)"><span class="hl_varref"><span class="mpre">signed</span></span></a><span class="mpre">)
  where </span><a name="loc_58_9_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_15&#39;)"><span class="hl_vardecl"><span class="mpre">signed</span></span></a><span class="mpre"> = </span><a href="Data.X509.Signed.html#loc_66_7_66_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_66_7_66_16&#39;)"><span class="hl_varref"><span class="mpre">getSigned</span></span></a><span class="mpre"> </span><a href="#loc_53_23_53_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_23_53_32&#39;)"><span class="hl_varref"><span class="mpre">signedObj</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | verify signature using parameter</span></span><span class="mpre">
</span><a href="#loc_66_1_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_16&#39;)"><span class="mpre">verifySignature</span></a><span class="mpre"> :: </span><a href="Data.X509.AlgorithmIdentifier.html#loc_39_6_39_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_39_6_39_18&#39;)"><span class="hl_tyconref"><span class="mpre">SignatureALG</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Signature algorithm used</span></span><span class="mpre">
                -&gt; </span><a href="Data.X509.PublicKey.html#loc_31_6_31_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.PublicKey.html#loc_31_6_31_12&#39;)"><span class="hl_tyconref"><span class="mpre">PubKey</span></span></a><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ Public key to use for verify</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ Certificate data that need to be verified</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ Signature to verify</span></span><span class="mpre">
                -&gt; </span><a href="#loc_36_6_36_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_6_36_27&#39;)"><span class="hl_tyconref"><span class="mpre">SignatureVerification</span></span></a><span class="mpre">
</span><a name="loc_66_1_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_16&#39;)"><span class="hl_fundecl"><span class="mpre">verifySignature</span></span></a><span class="mpre"> (</span><a href="Data.X509.AlgorithmIdentifier.html#loc_41_7_41_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_41_7_41_27&#39;)"><span class="hl_conref"><span class="mpre">SignatureALG_Unknown</span></span></a><span class="mpre"> _) _ _ _ = </span><a href="#loc_38_7_38_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_22&#39;)"><span class="hl_conref"><span class="mpre">SignatureFailed</span></span></a><span class="mpre"> </span><a href="#loc_45_7_45_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_7_45_29&#39;)"><span class="hl_conref"><span class="mpre">SignatureUnimplemented</span></span></a><span class="mpre">
</span><a href="#loc_66_1_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_16&#39;)"><span class="hl_fundecl"><span class="mpre">verifySignature</span></span></a><span class="mpre"> (</span><a href="Data.X509.AlgorithmIdentifier.html#loc_40_7_40_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_40_7_40_19&#39;)"><span class="hl_conref"><span class="mpre">SignatureALG</span></span></a><span class="mpre"> </span><a name="loc_67_31_67_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_31_67_38&#39;)"><span class="hl_vardecl"><span class="mpre">hashALG</span></span></a><span class="mpre"> </span><a name="loc_67_39_67_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_39_67_48&#39;)"><span class="hl_vardecl"><span class="mpre">pubkeyALG</span></span></a><span class="mpre">) </span><a name="loc_67_50_67_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_50_67_56&#39;)"><span class="hl_vardecl"><span class="mpre">pubkey</span></span></a><span class="mpre"> </span><a name="loc_67_57_67_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_57_67_62&#39;)"><span class="hl_vardecl"><span class="mpre">cdata</span></span></a><span class="mpre"> </span><a name="loc_67_63_67_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_63_67_72&#39;)"><span class="hl_vardecl"><span class="mpre">signature</span></span></a><span class="mpre">
    | </span><a href="Data.X509.PublicKey.html#loc_91_1_91_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.PublicKey.html#loc_91_1_91_12&#39;)"><span class="hl_varref"><span class="mpre">pubkeyToAlg</span></span></a><span class="mpre"> </span><a href="#loc_67_50_67_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_50_67_56&#39;)"><span class="hl_varref"><span class="mpre">pubkey</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_67_39_67_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_39_67_48&#39;)"><span class="hl_varref"><span class="mpre">pubkeyALG</span></span></a><span class="mpre"> = case </span><a href="#loc_75_9_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_16&#39;)"><span class="hl_varref"><span class="mpre">verifyF</span></span></a><span class="mpre"> </span><a href="#loc_67_50_67_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_50_67_56&#39;)"><span class="hl_varref"><span class="mpre">pubkey</span></span></a><span class="mpre"> of
                                            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_38_7_38_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_22&#39;)"><span class="hl_conref"><span class="mpre">SignatureFailed</span></span></a><span class="mpre"> </span><a href="#loc_45_7_45_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_7_45_29&#39;)"><span class="hl_conref"><span class="mpre">SignatureUnimplemented</span></span></a><span class="mpre">
                                            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_70_50_70_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_50_70_51&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">  -&gt; if </span><a href="#loc_70_50_70_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_50_70_51&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_67_57_67_62" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_57_67_62&#39;)"><span class="hl_varref"><span class="mpre">cdata</span></span></a><span class="mpre"> </span><a href="#loc_67_63_67_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_63_67_72&#39;)"><span class="hl_varref"><span class="mpre">signature</span></span></a><span class="mpre">
                                                            then </span><a href="#loc_37_7_37_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_7_37_20&#39;)"><span class="hl_conref"><span class="mpre">SignaturePass</span></span></a><span class="mpre">
                                                            else </span><a href="#loc_38_7_38_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_22&#39;)"><span class="hl_conref"><span class="mpre">SignatureFailed</span></span></a><span class="mpre"> </span><a href="#loc_43_7_43_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_23&#39;)"><span class="hl_conref"><span class="mpre">SignatureInvalid</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                       = </span><a href="#loc_38_7_38_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_22&#39;)"><span class="hl_conref"><span class="mpre">SignatureFailed</span></span></a><span class="mpre"> </span><a href="#loc_44_7_44_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_7_44_30&#39;)"><span class="hl_conref"><span class="mpre">SignaturePubkeyMismatch</span></span></a><span class="mpre">
  where
        </span><a name="loc_75_9_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_16&#39;)"><span class="hl_fundecl"><span class="mpre">verifyF</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">PubKeyRSA</span></span><span class="mpre"> </span><a name="loc_75_28_75_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_28_75_31&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.PKCS15.html#loc_136_1_136_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.PKCS15.html#loc_136_1_136_7&#39;)"><span class="hl_varref"><span class="mpre">RSA.verify</span></span></a><span class="mpre"> (</span><a href="Data.X509.Validation.Fingerprint.html#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Validation.Fingerprint.html#loc_39_1_39_8&#39;)"><span class="hl_varref"><span class="mpre">toDescr</span></span></a><span class="mpre"> </span><a href="#loc_67_31_67_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_31_67_38&#39;)"><span class="hl_varref"><span class="mpre">hashALG</span></span></a><span class="mpre">) </span><a href="#loc_75_28_75_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_28_75_31&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre">
        </span><a href="#loc_75_9_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_16&#39;)"><span class="hl_fundecl"><span class="mpre">verifyF</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">PubKeyDSA</span></span><span class="mpre"> </span><a name="loc_76_28_76_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_28_76_31&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre">)
            | </span><a href="#loc_67_31_67_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_31_67_38&#39;)"><span class="hl_varref"><span class="mpre">hashALG</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Data.X509.AlgorithmIdentifier.html#loc_21_7_21_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_21_7_21_15&#39;)"><span class="hl_conref"><span class="mpre">HashSHA1</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_77_45_77_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_45_77_46&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_77_47_77_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_47_77_48&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_84_9_84_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_23&#39;)"><span class="hl_varref"><span class="mpre">dsaToSignature</span></span></a><span class="mpre"> </span><a href="#loc_77_45_77_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_45_77_46&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> of
                                                    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">     -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
                                                    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_79_58_79_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_58_79_64&#39;)"><span class="hl_vardecl"><span class="mpre">dsaSig</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.PubKey.DSA.html#loc_72_1_72_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.DSA.html#loc_72_1_72_7&#39;)"><span class="hl_varref"><span class="mpre">DSA.verify</span></span></a><span class="mpre"> </span><a href="Crypto.Hash.SHA1.html#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.SHA1.html#loc_126_1_126_5&#39;)"><span class="hl_varref"><span class="mpre">SHA1.hash</span></span></a><span class="mpre"> </span><a href="#loc_76_28_76_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_28_76_31&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre"> </span><a href="#loc_79_58_79_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_58_79_64&#39;)"><span class="hl_varref"><span class="mpre">dsaSig</span></span></a><span class="mpre"> </span><a href="#loc_77_47_77_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_47_77_48&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">           = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        </span><a href="#loc_75_9_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_16&#39;)"><span class="hl_fundecl"><span class="mpre">verifyF</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

        </span><a href="#loc_84_9_84_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_23&#39;)"><span class="mpre">dsaToSignature</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Crypto.Types.PubKey.DSA.html#loc_52_6_52_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_52_6_52_15&#39;)"><span class="hl_tyconref"><span class="mpre">DSA.Signature</span></span></a><span class="mpre">
        </span><a name="loc_84_9_84_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_23&#39;)"><span class="hl_fundecl"><span class="mpre">dsaToSignature</span></span></a><span class="mpre"> </span><a name="loc_84_24_84_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_24_84_25&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> =
            case </span><a href="Data.ASN1.Encoding.html#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_43_1_43_12&#39;)"><span class="hl_varref"><span class="mpre">decodeASN1&#39;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.html#loc_27_12_27_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_27_12_27_15&#39;)"><span class="hl_conref"><span class="mpre">BER</span></span></a><span class="mpre"> </span><a href="#loc_84_24_84_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_24_84_25&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> _     -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_87_23_87_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_23_87_27&#39;)"><span class="hl_vardecl"><span class="mpre">asn1</span></span></a><span class="mpre"> -&gt; case </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_varref"><span class="mpre">fromASN1</span></span></a><span class="mpre"> </span><a href="#loc_87_23_87_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_23_87_27&#39;)"><span class="hl_varref"><span class="mpre">asn1</span></span></a><span class="mpre"> of
                                </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> _            -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                                </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_89_40_89_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_40_89_46&#39;)"><span class="hl_vardecl"><span class="mpre">dsaSig</span></span></a><span class="mpre">, _) -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_89_40_89_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_40_89_46&#39;)"><span class="hl_varref"><span class="mpre">dsaSig</span></span></a><span class="mpre">
</span></div></body></html>