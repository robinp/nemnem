<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE RecordWildCards #-}
module Network.HTTP.Client.ResponseSpec where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/ResponseSpec.hs&quot;, srcSpanStartLine = 5, srcSpanStartColumn = 8, srcSpanEndLine = 5, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.Hspec&quot;"><span class="mpre">Test.Hspec</span></span><span class="mpre">
import Network.HTTP.Client
import Network.HTTP.Client.Internal
import Network.HTTP.Types
import Codec.Compression.GZip (</span><a href="Codec.Compression.GZip.html#loc_117_1_117_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Compression.GZip.html#loc_117_1_117_9&#39;)"><span class="mpre">compress</span></a><span class="mpre">)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/ResponseSpec.hs&quot;, srcSpanStartLine = 10, srcSpanStartColumn = 18, srcSpanEndLine = 10, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/ResponseSpec.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 8, srcSpanEndLine = 11, srcSpanEndColumn = 34}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy.Char8&quot;"><span class="mpre">Data.ByteString.Lazy.Char8</span></span><span class="mpre"> ()
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/ResponseSpec.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 18, srcSpanEndLine = 12, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S

</span><a href="#loc_15_1_15_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_5&#39;)"><span class="mpre">main</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_15_1_15_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_5&#39;)"><span class="hl_vardecl"><span class="mpre">main</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">hspec</span></span><span class="mpre"> </span><a href="#loc_18_1_18_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_5&#39;)"><span class="hl_varref"><span class="mpre">spec</span></span></a><span class="mpre">

</span><a href="#loc_18_1_18_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_5&#39;)"><span class="mpre">spec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_18_1_18_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_5&#39;)"><span class="hl_vardecl"><span class="mpre">spec</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ResponseSpec&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    let </span><a name="loc_19_9_19_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_21&#39;)"><span class="hl_fundecl"><span class="mpre">getResponse&#39;</span></span></a><span class="mpre"> </span><a name="loc_19_22_19_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_22_19_26&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre"> = </span><a href="Network.HTTP.Client.Response.html#loc_90_1_90_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Response.html#loc_90_1_90_12&#39;)"><span class="hl_varref"><span class="mpre">getResponse</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><a href="#loc_20_14_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_14_20_17&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><a href="#loc_19_22_19_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_22_19_26&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_20_14_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_14_20_17&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">parseUrl</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;http://localhost&quot;</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;basic&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        (</span><a name="loc_22_10_22_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_14&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">getOutput</span></span><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">getInput</span></span><span class="mpre">) &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_68_1_68_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_68_1_68_16&#39;)"><span class="hl_varref"><span class="mpre">dummyConnection</span></span></a><span class="mpre">
            [ </span><span class="hl_string"><span class="mpre">&quot;HTTP/1.1 200 OK\r\n&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;Key1: Value1\r\n&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;Content-length: 11\r\n\r\n&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;Hello&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot; W&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;orld\r\nHTTP/1.1&quot;</span></span><span class="mpre">
            ]
        </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/ResponseSpec.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 9, srcSpanEndLine = 30, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/ResponseSpec.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 18, srcSpanEndLine = 30, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-"><span class="mpre">Response {..}</span></span><span class="mpre"> &lt;- </span><a href="#loc_19_9_19_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_21&#39;)"><span class="hl_varref"><span class="mpre">getResponse&#39;</span></span></a><span class="mpre"> </span><a href="#loc_22_10_22_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_14&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        </span><a href="Network.HTTP.Client.Types.html#loc_405_7_405_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_405_7_405_21&#39;)"><span class="hl_varref"><span class="mpre">responseStatus</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre">
        </span><a href="Network.HTTP.Client.Types.html#loc_409_7_409_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_409_7_409_22&#39;)"><span class="hl_varref"><span class="mpre">responseVersion</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">HttpVersion</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a href="Network.HTTP.Client.Types.html#loc_413_7_413_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_413_7_413_22&#39;)"><span class="hl_varref"><span class="mpre">responseHeaders</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre">
            [ (</span><span class="hl_string"><span class="mpre">&quot;Key1&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;Value1&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;Content-length&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;11&quot;</span></span><span class="mpre">)
            ]
        </span><a name="loc_37_9_37_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_9_37_15&#39;)"><span class="hl_vardecl"><span class="mpre">pieces</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">brConsume</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_417_7_417_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_417_7_417_19&#39;)"><span class="hl_varref"><span class="mpre">responseBody</span></span></a><span class="mpre">
        </span><a href="#loc_37_9_37_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_9_37_15&#39;)"><span class="hl_varref"><span class="mpre">pieces</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;Hello&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot; W&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;orld&quot;</span></span><span class="mpre">]
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;no length&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        (</span><a name="loc_40_10_40_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_10_40_14&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">getOutput</span></span><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">getInput</span></span><span class="mpre">) &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_68_1_68_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_68_1_68_16&#39;)"><span class="hl_varref"><span class="mpre">dummyConnection</span></span></a><span class="mpre">
            [ </span><span class="hl_string"><span class="mpre">&quot;HTTP/1.1 200 OK\r\n&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;Key1: Value1\r\n\r\n&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;Hello&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot; W&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;orld\r\nHTTP/1.1&quot;</span></span><span class="mpre">
            ]
        </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/ResponseSpec.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 9, srcSpanEndLine = 47, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/ResponseSpec.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 18, srcSpanEndLine = 47, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-"><span class="mpre">Response {..}</span></span><span class="mpre"> &lt;- </span><a href="#loc_19_9_19_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_21&#39;)"><span class="hl_varref"><span class="mpre">getResponse&#39;</span></span></a><span class="mpre"> </span><a href="#loc_40_10_40_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_10_40_14&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        </span><a href="Network.HTTP.Client.Types.html#loc_405_7_405_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_405_7_405_21&#39;)"><span class="hl_varref"><span class="mpre">responseStatus</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre">
        </span><a href="Network.HTTP.Client.Types.html#loc_409_7_409_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_409_7_409_22&#39;)"><span class="hl_varref"><span class="mpre">responseVersion</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">HttpVersion</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a href="Network.HTTP.Client.Types.html#loc_413_7_413_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_413_7_413_22&#39;)"><span class="hl_varref"><span class="mpre">responseHeaders</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre">
            [ (</span><span class="hl_string"><span class="mpre">&quot;Key1&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;Value1&quot;</span></span><span class="mpre">)
            ]
        </span><a name="loc_53_9_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_15&#39;)"><span class="hl_vardecl"><span class="mpre">pieces</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">brConsume</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_417_7_417_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_417_7_417_19&#39;)"><span class="hl_varref"><span class="mpre">responseBody</span></span></a><span class="mpre">
        </span><a href="#loc_53_9_53_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_15&#39;)"><span class="hl_varref"><span class="mpre">pieces</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;Hello&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot; W&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;orld\r\nHTTP/1.1&quot;</span></span><span class="mpre">]
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;chunked&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        (</span><a name="loc_56_10_56_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_10_56_14&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">getOutput</span></span><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">getInput</span></span><span class="mpre">) &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_68_1_68_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_68_1_68_16&#39;)"><span class="hl_varref"><span class="mpre">dummyConnection</span></span></a><span class="mpre">
            [ </span><span class="hl_string"><span class="mpre">&quot;HTTP/1.1 200 OK\r\n&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;Key1: Value1\r\n&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;Transfer-encoding: chunked\r\n\r\n&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;5\r\nHello\r&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;\n2\r\n W&quot;</span></span><span class="mpre">
            , </span><span class="hl_string"><span class="mpre">&quot;\r\n4  ignored\r\norld\r\n0\r\nHTTP/1.1&quot;</span></span><span class="mpre">
            ]
        </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/ResponseSpec.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 9, srcSpanEndLine = 64, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/ResponseSpec.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 18, srcSpanEndLine = 64, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-"><span class="mpre">Response {..}</span></span><span class="mpre"> &lt;- </span><a href="#loc_19_9_19_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_21&#39;)"><span class="hl_varref"><span class="mpre">getResponse&#39;</span></span></a><span class="mpre"> </span><a href="#loc_56_10_56_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_10_56_14&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        </span><a href="Network.HTTP.Client.Types.html#loc_405_7_405_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_405_7_405_21&#39;)"><span class="hl_varref"><span class="mpre">responseStatus</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre">
        </span><a href="Network.HTTP.Client.Types.html#loc_409_7_409_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_409_7_409_22&#39;)"><span class="hl_varref"><span class="mpre">responseVersion</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">HttpVersion</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a href="Network.HTTP.Client.Types.html#loc_413_7_413_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_413_7_413_22&#39;)"><span class="hl_varref"><span class="mpre">responseHeaders</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre">
            [ (</span><span class="hl_string"><span class="mpre">&quot;Key1&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;Value1&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;Transfer-encoding&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;chunked&quot;</span></span><span class="mpre">)
            ]
        </span><a name="loc_71_9_71_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_15&#39;)"><span class="hl_vardecl"><span class="mpre">pieces</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">brConsume</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_417_7_417_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_417_7_417_19&#39;)"><span class="hl_varref"><span class="mpre">responseBody</span></span></a><span class="mpre">
        </span><a href="#loc_71_9_71_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_15&#39;)"><span class="hl_varref"><span class="mpre">pieces</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;Hello&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot; W&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;orld&quot;</span></span><span class="mpre">]
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;gzip&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        (</span><a name="loc_74_10_74_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_10_74_14&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">getOutput</span></span><span class="mpre">, </span><span class="hl_vardecl"><span class="mpre">getInput</span></span><span class="mpre">) &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_68_1_68_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_68_1_68_16&#39;)"><span class="hl_varref"><span class="mpre">dummyConnection</span></span></a><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;HTTP/1.1 200 OK\r\n&quot;</span></span><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Key1: Value1\r\n&quot;</span></span><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Encoding: gzip\r\n\r\n&quot;</span></span><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> (</span><a href="Codec.Compression.GZip.html#loc_117_1_117_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Compression.GZip.html#loc_117_1_117_9&#39;)"><span class="hl_varref"><span class="mpre">compress</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Compressed Hello World&quot;</span></span><span class="mpre">)
        </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/ResponseSpec.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 9, srcSpanEndLine = 79, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/test/Network/HTTP/Client/ResponseSpec.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 18, srcSpanEndLine = 79, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-"><span class="mpre">Response {..}</span></span><span class="mpre"> &lt;- </span><a href="#loc_19_9_19_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_9_19_21&#39;)"><span class="hl_varref"><span class="mpre">getResponse&#39;</span></span></a><span class="mpre"> </span><a href="#loc_74_10_74_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_10_74_14&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        </span><a href="Network.HTTP.Client.Types.html#loc_405_7_405_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_405_7_405_21&#39;)"><span class="hl_varref"><span class="mpre">responseStatus</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre">
        </span><a href="Network.HTTP.Client.Types.html#loc_409_7_409_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_409_7_409_22&#39;)"><span class="hl_varref"><span class="mpre">responseVersion</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">HttpVersion</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a href="Network.HTTP.Client.Types.html#loc_413_7_413_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_413_7_413_22&#39;)"><span class="hl_varref"><span class="mpre">responseHeaders</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre">
            [ (</span><span class="hl_string"><span class="mpre">&quot;Key1&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;Value1&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;Content-Encoding&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;gzip&quot;</span></span><span class="mpre">)
            ]
        </span><a name="loc_86_9_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_15&#39;)"><span class="hl_vardecl"><span class="mpre">pieces</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Body.html#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Body.html#loc_57_1_57_10&#39;)"><span class="hl_varref"><span class="mpre">brConsume</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_417_7_417_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_417_7_417_19&#39;)"><span class="hl_varref"><span class="mpre">responseBody</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_86_9_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_15&#39;)"><span class="hl_varref"><span class="mpre">pieces</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Compressed Hello World&quot;</span></span><span class="mpre">
</span></div></body></html>