<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  SymTab</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  2000-2004 Malcolm Wallace</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Licence     :  LGPL</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Malcolm Wallace &lt;Malcolm.Wallace@cs.york.ac.uk&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  Stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  All</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Symbol Table, based on index trees using a hash on the key.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Keys are always Strings.  Stored values can be any type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Language.Preprocessor.Cpphs.SymTab
  ( SymTab
  , emptyST
  , insertST
  , deleteST
  , lookupST
  , definedST
  , flattenST
  , IndTree
  ) where

</span><span class="hl_comment"><span class="mpre">-- | Symbol Table.  Stored values are polymorphic, but the keys are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   always strings.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/SymTab.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 1, srcSpanEndLine = 28, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/SymTab.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 1, srcSpanEndLine = 28, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Prep"><span class="mpre">type SymTab v = IndTree [(String,v)]</span></span><span class="mpre">

</span><a href="#loc_37_1_37_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_8&#39;)"><span class="mpre">emptyST</span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">SymTab</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a href="#loc_38_1_38_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_9&#39;)"><span class="mpre">insertST</span></a><span class="mpre">  :: (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">SymTab</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">SymTab</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a href="#loc_39_1_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_9&#39;)"><span class="mpre">deleteST</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">SymTab</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">SymTab</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a href="#loc_40_1_40_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_9&#39;)"><span class="mpre">lookupST</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">SymTab</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">
</span><a href="#loc_43_1_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_10&#39;)"><span class="mpre">definedST</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">SymTab</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a href="#loc_45_1_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_10&#39;)"><span class="mpre">flattenST</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">SymTab</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">v</span></span><span class="mpre">]

</span><a name="loc_37_1_37_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_8&#39;)"><span class="hl_vardecl"><span class="mpre">emptyST</span></span></a><span class="mpre">           = </span><a href="#loc_55_1_55_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_6&#39;)"><span class="hl_varref"><span class="mpre">itgen</span></span></a><span class="mpre"> </span><a href="#loc_80_1_80_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_8&#39;)"><span class="hl_varref"><span class="mpre">maxHash</span></span></a><span class="mpre"> []
</span><a name="loc_38_1_38_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_9&#39;)"><span class="hl_fundecl"><span class="mpre">insertST</span></span></a><span class="mpre"> (</span><a name="loc_38_11_38_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_11_38_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">,</span><a name="loc_38_13_38_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_13_38_14&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) </span><a name="loc_38_16_38_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_18&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> = </span><a href="#loc_62_1_62_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_6&#39;)"><span class="hl_varref"><span class="mpre">itiap</span></span></a><span class="mpre"> (</span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_38_11_38_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_11_38_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) ((</span><a href="#loc_38_11_38_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_11_38_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">,</span><a href="#loc_38_13_38_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_13_38_14&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)    </span><a href="#loc_38_16_38_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_18&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><a name="loc_39_1_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_9&#39;)"><span class="hl_fundecl"><span class="mpre">deleteST</span></span></a><span class="mpre">  </span><a name="loc_39_11_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">    </span><a name="loc_39_16_39_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_18&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> = </span><a href="#loc_62_1_62_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_6&#39;)"><span class="hl_varref"><span class="mpre">itiap</span></span></a><span class="mpre"> (</span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_39_11_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">/=</span></span><a href="#loc_39_11_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">)) </span><a href="#loc_39_16_39_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_16_39_18&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><a name="loc_40_1_40_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_9&#39;)"><span class="hl_fundecl"><span class="mpre">lookupST</span></span></a><span class="mpre">  </span><a name="loc_40_11_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_11_40_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">    </span><a name="loc_40_16_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_16_40_18&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> = let </span><a name="loc_40_25_40_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_25_40_27&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">==</span></span><a href="#loc_40_11_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_11_40_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">) ((</span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_varref"><span class="mpre">itind</span></span></a><span class="mpre"> (</span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_40_11_40_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_11_40_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)) </span><a href="#loc_40_16_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_16_40_18&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">)
                    in if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_40_25_40_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_25_40_27&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre"> then </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                       else (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre">) </span><a href="#loc_40_25_40_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_25_40_27&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">
</span><a name="loc_43_1_43_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_10&#39;)"><span class="hl_fundecl"><span class="mpre">definedST</span></span></a><span class="mpre"> </span><a name="loc_43_11_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">    </span><a name="loc_43_16_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_18&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> = let </span><a name="loc_43_25_43_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_25_43_27&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">==</span></span><a href="#loc_43_11_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">) ((</span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_varref"><span class="mpre">itind</span></span></a><span class="mpre"> (</span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_43_11_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)) </span><a href="#loc_43_16_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_16_43_18&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">)
                    in (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre">) </span><a href="#loc_43_25_43_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_25_43_27&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">
</span><a name="loc_45_1_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_10&#39;)"><span class="hl_fundecl"><span class="mpre">flattenST</span></span></a><span class="mpre">      </span><a name="loc_45_16_45_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_16_45_18&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> = </span><a href="#loc_73_1_73_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_7&#39;)"><span class="hl_varref"><span class="mpre">itfold</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">(++)</span></span><span class="mpre"> </span><a href="#loc_45_16_45_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_16_45_18&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">----</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Index Trees (storing indexes at nodes).</span></span><span class="mpre">

data </span><a name="loc_51_6_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_13&#39;)"><span class="hl_tycondecl"><span class="mpre">IndTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> = </span><a name="loc_51_18_51_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_18_51_22&#39;)"><span class="hl_condecl"><span class="mpre">Leaf</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> | </span><a name="loc_51_27_51_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_27_51_31&#39;)"><span class="hl_condecl"><span class="mpre">Fork</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> (</span><a href="#loc_51_6_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_13&#39;)"><span class="hl_tyconref"><span class="mpre">IndTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) (</span><a href="#loc_51_6_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_13&#39;)"><span class="hl_tyconref"><span class="mpre">IndTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">)
     </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/SymTab.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 6, srcSpanEndLine = 52, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/SymTab.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 6, srcSpanEndLine = 52, srcSpanEndColumn = 14}]}) [IHead (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant"><span class="mpre">deriving Show</span></span><span class="mpre">

</span><a href="#loc_55_1_55_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_6&#39;)"><span class="mpre">itgen</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_51_6_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_13&#39;)"><span class="hl_tyconref"><span class="mpre">IndTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_55_1_55_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_6&#39;)"><span class="hl_fundecl"><span class="mpre">itgen</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a name="loc_55_9_55_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_9_55_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_51_18_51_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_18_51_22&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> </span><a href="#loc_55_9_55_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_9_55_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_55_1_55_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_6&#39;)"><span class="hl_fundecl"><span class="mpre">itgen</span></span></a><span class="mpre"> </span><a name="loc_56_7_56_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_8&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_56_9_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> =
  let </span><a name="loc_57_7_57_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_9&#39;)"><span class="hl_vardecl"><span class="mpre">n&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_56_7_56_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_8&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
  in </span><a href="#loc_51_27_51_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_27_51_31&#39;)"><span class="hl_conref"><span class="mpre">Fork</span></span></a><span class="mpre"> </span><a href="#loc_57_7_57_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_9&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_55_1_55_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_6&#39;)"><span class="hl_varref"><span class="mpre">itgen</span></span></a><span class="mpre"> </span><a href="#loc_57_7_57_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_9&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> </span><a href="#loc_56_9_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><a href="#loc_55_1_55_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_6&#39;)"><span class="hl_varref"><span class="mpre">itgen</span></span></a><span class="mpre"> (</span><a href="#loc_56_7_56_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_8&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_57_7_57_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_9&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre">) </span><a href="#loc_56_9_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

</span><a href="#loc_62_1_62_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_6&#39;)"><span class="mpre">itiap</span></a><span class="mpre"> :: </span><span class="hl_comment"><span class="mpre">--Eval a =&gt;</span></span><span class="mpre">
         </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_51_6_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_13&#39;)"><span class="hl_tyconref"><span class="mpre">IndTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><a href="#loc_51_6_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_13&#39;)"><span class="hl_tyconref"><span class="mpre">IndTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_62_1_62_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_6&#39;)"><span class="hl_fundecl"><span class="mpre">itiap</span></span></a><span class="mpre"> _ </span><a name="loc_62_9_62_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_51_18_51_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_18_51_22&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> </span><a name="loc_62_17_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_17_62_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)       </span><a name="loc_62_26_62_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_26_62_27&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = let </span><a name="loc_62_34_62_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_34_62_36&#39;)"><span class="hl_vardecl"><span class="mpre">fx</span></span></a><span class="mpre"> = </span><a href="#loc_62_9_62_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_62_17_62_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_17_62_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> in </span><span class="hl_comment"><span class="mpre">{-seq fx-}</span></span><span class="mpre"> (</span><a href="#loc_62_26_62_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_26_62_27&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_51_18_51_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_18_51_22&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> </span><a href="#loc_62_34_62_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_34_62_36&#39;)"><span class="hl_varref"><span class="mpre">fx</span></span></a><span class="mpre">))
</span><a href="#loc_62_1_62_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_6&#39;)"><span class="hl_fundecl"><span class="mpre">itiap</span></span></a><span class="mpre"> </span><a name="loc_63_7_63_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_7_63_8&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_63_9_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_51_27_51_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_27_51_31&#39;)"><span class="hl_conref"><span class="mpre">Fork</span></span></a><span class="mpre"> </span><a name="loc_63_17_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_17_63_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_63_19_63_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_19_63_21&#39;)"><span class="hl_vardecl"><span class="mpre">lt</span></span></a><span class="mpre"> </span><a name="loc_63_22_63_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_22_63_24&#39;)"><span class="hl_vardecl"><span class="mpre">rt</span></span></a><span class="mpre">) </span><a name="loc_63_26_63_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_26_63_27&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> =
  if </span><a href="#loc_63_7_63_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_7_63_8&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">&lt;</span></span><a href="#loc_63_17_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_17_63_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> then
       </span><a href="#loc_62_1_62_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_6&#39;)"><span class="hl_varref"><span class="mpre">itiap</span></span></a><span class="mpre"> </span><a href="#loc_63_7_63_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_7_63_8&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_63_9_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_63_19_63_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_19_63_21&#39;)"><span class="hl_varref"><span class="mpre">lt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_65_24_65_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_24_65_27&#39;)"><span class="hl_vardecl"><span class="mpre">lt&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_63_26_63_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_26_63_27&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_51_27_51_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_27_51_31&#39;)"><span class="hl_conref"><span class="mpre">Fork</span></span></a><span class="mpre"> </span><a href="#loc_63_17_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_17_63_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_65_24_65_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_24_65_27&#39;)"><span class="hl_varref"><span class="mpre">lt&#39;</span></span></a><span class="mpre"> </span><a href="#loc_63_22_63_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_22_63_24&#39;)"><span class="hl_varref"><span class="mpre">rt</span></span></a><span class="mpre">)
  else </span><a href="#loc_62_1_62_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_6&#39;)"><span class="hl_varref"><span class="mpre">itiap</span></span></a><span class="mpre"> (</span><a href="#loc_63_7_63_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_7_63_8&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_63_17_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_17_63_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><a href="#loc_63_9_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_63_22_63_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_22_63_24&#39;)"><span class="hl_varref"><span class="mpre">rt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_66_28_66_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_28_66_31&#39;)"><span class="hl_vardecl"><span class="mpre">rt&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_63_26_63_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_26_63_27&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_51_27_51_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_27_51_31&#39;)"><span class="hl_conref"><span class="mpre">Fork</span></span></a><span class="mpre"> </span><a href="#loc_63_17_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_17_63_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_63_19_63_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_19_63_21&#39;)"><span class="hl_varref"><span class="mpre">lt</span></span></a><span class="mpre"> </span><a href="#loc_66_28_66_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_28_66_31&#39;)"><span class="hl_varref"><span class="mpre">rt&#39;</span></span></a><span class="mpre">)

</span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="mpre">itind</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_51_6_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_13&#39;)"><span class="hl_tyconref"><span class="mpre">IndTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_fundecl"><span class="mpre">itind</span></span></a><span class="mpre"> _ (</span><a href="#loc_51_18_51_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_18_51_22&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> </span><a name="loc_69_15_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_15_69_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_69_15_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_15_69_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_fundecl"><span class="mpre">itind</span></span></a><span class="mpre"> </span><a name="loc_70_7_70_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_7_70_8&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="#loc_51_27_51_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_27_51_31&#39;)"><span class="hl_conref"><span class="mpre">Fork</span></span></a><span class="mpre"> </span><a name="loc_70_15_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_15_70_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_70_17_70_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_17_70_19&#39;)"><span class="hl_vardecl"><span class="mpre">lt</span></span></a><span class="mpre"> </span><a name="loc_70_20_70_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_20_70_22&#39;)"><span class="hl_vardecl"><span class="mpre">rt</span></span></a><span class="mpre">) = if </span><a href="#loc_70_7_70_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_7_70_8&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">&lt;</span></span><a href="#loc_70_15_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_15_70_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> then </span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_varref"><span class="mpre">itind</span></span></a><span class="mpre"> </span><a href="#loc_70_7_70_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_7_70_8&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_70_17_70_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_17_70_19&#39;)"><span class="hl_varref"><span class="mpre">lt</span></span></a><span class="mpre"> else </span><a href="#loc_69_1_69_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_6&#39;)"><span class="hl_varref"><span class="mpre">itind</span></span></a><span class="mpre"> (</span><a href="#loc_70_7_70_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_7_70_8&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_70_15_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_15_70_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><a href="#loc_70_20_70_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_20_70_22&#39;)"><span class="hl_varref"><span class="mpre">rt</span></span></a><span class="mpre">

</span><a href="#loc_73_1_73_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_7&#39;)"><span class="mpre">itfold</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_51_6_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_13&#39;)"><span class="hl_tyconref"><span class="mpre">IndTree</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_73_1_73_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_7&#39;)"><span class="hl_fundecl"><span class="mpre">itfold</span></span></a><span class="mpre"> </span><a name="loc_73_8_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_8_73_12&#39;)"><span class="hl_vardecl"><span class="mpre">leaf</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_fork</span></span><span class="mpre"> (</span><a href="#loc_51_18_51_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_18_51_22&#39;)"><span class="hl_conref"><span class="mpre">Leaf</span></span></a><span class="mpre"> </span><a name="loc_73_25_73_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_25_73_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_73_8_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_8_73_12&#39;)"><span class="hl_varref"><span class="mpre">leaf</span></span></a><span class="mpre"> </span><a href="#loc_73_25_73_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_25_73_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_73_1_73_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_7&#39;)"><span class="hl_fundecl"><span class="mpre">itfold</span></span></a><span class="mpre"> </span><a name="loc_74_8_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_8_74_12&#39;)"><span class="hl_vardecl"><span class="mpre">leaf</span></span></a><span class="mpre">  </span><a name="loc_74_14_74_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_14_74_18&#39;)"><span class="hl_vardecl"><span class="mpre">fork</span></span></a><span class="mpre"> (</span><a href="#loc_51_27_51_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_27_51_31&#39;)"><span class="hl_conref"><span class="mpre">Fork</span></span></a><span class="mpre"> _ </span><a name="loc_74_27_74_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_27_74_28&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_74_29_74_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_29_74_30&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_74_14_74_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_14_74_18&#39;)"><span class="hl_varref"><span class="mpre">fork</span></span></a><span class="mpre"> (</span><a href="#loc_73_1_73_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_7&#39;)"><span class="hl_varref"><span class="mpre">itfold</span></span></a><span class="mpre"> </span><a href="#loc_74_8_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_8_74_12&#39;)"><span class="hl_varref"><span class="mpre">leaf</span></span></a><span class="mpre"> </span><a href="#loc_74_14_74_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_14_74_18&#39;)"><span class="hl_varref"><span class="mpre">fork</span></span></a><span class="mpre"> </span><a href="#loc_74_27_74_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_27_74_28&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) (</span><a href="#loc_73_1_73_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_7&#39;)"><span class="hl_varref"><span class="mpre">itfold</span></span></a><span class="mpre"> </span><a href="#loc_74_8_74_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_8_74_12&#39;)"><span class="hl_varref"><span class="mpre">leaf</span></span></a><span class="mpre"> </span><a href="#loc_74_14_74_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_14_74_18&#39;)"><span class="hl_varref"><span class="mpre">fork</span></span></a><span class="mpre"> </span><a href="#loc_74_29_74_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_29_74_30&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Hash values</span></span><span class="mpre">

</span><a href="#loc_80_1_80_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_8&#39;)"><span class="mpre">maxHash</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- should be prime</span></span><span class="mpre">
</span><a name="loc_80_1_80_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_8&#39;)"><span class="hl_vardecl"><span class="mpre">maxHash</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">101</span></span><span class="mpre">

class </span><a name="loc_82_7_82_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_7_82_15&#39;)"><span class="hl_classdecl"><span class="mpre">Hashable</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> where
    </span><a name="loc_83_5_83_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_16&#39;)"><span class="mpre">hashWithMax</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    </span><a name="loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="mpre">hash</span></a><span class="mpre">        :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    </span><a href="#loc_84_5_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_9&#39;)"><span class="hl_vardecl"><span class="mpre">hash</span></span></a><span class="mpre"> = </span><a href="#loc_83_5_83_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_16&#39;)"><span class="hl_varref"><span class="mpre">hashWithMax</span></span></a><span class="mpre"> </span><a href="#loc_80_1_80_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_8&#39;)"><span class="hl_varref"><span class="mpre">maxHash</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/SymTab.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 10, srcSpanEndLine = 87, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/SymTab.hs&quot;, srcSpanStartLine = 87, srcSpanStartColumn = 17, srcSpanEndLine = 87, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagr"><span class="mpre">Enum a =&gt;</span></span><span class="mpre"> </span><a href="#loc_82_7_82_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_7_82_15&#39;)"><span class="hl_classref"><span class="mpre">Hashable</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] where
    </span><a href="#loc_83_5_83_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_16&#39;)"><span class="hl_fundecl"><span class="mpre">hashWithMax</span></span></a><span class="mpre"> </span><a name="loc_88_17_88_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_17_88_18&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="#loc_89_15_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_15_89_16&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
        where </span><a name="loc_89_15_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_15_89_16&#39;)"><span class="hl_fundecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_89_17_89_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_17_89_18&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> []     = </span><a href="#loc_89_17_89_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_17_89_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
              </span><a href="#loc_89_15_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_15_89_16&#39;)"><span class="hl_fundecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_90_17_90_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_17_90_18&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a name="loc_90_20_90_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_20_90_21&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_90_22_90_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_24&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) = </span><a href="#loc_89_15_89_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_15_89_16&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> ((</span><span class="hl_num"><span class="mpre">17</span></span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre">(</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_90_20_90_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_20_90_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">19</span></span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_90_17_90_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_17_90_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">`rem`</span></span><a href="#loc_88_17_88_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_17_88_18&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><a href="#loc_90_22_90_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_24&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----</span></span><span class="mpre">
</span></div></body></html>