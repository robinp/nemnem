<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.TLS.Measurement</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.TLS.Measurement
        ( Measurement(..)
        , newMeasurement
        , addBytesReceived
        , addBytesSent
        , resetBytesCounters
        , incrementNbHandshakes
        ) where

import Data.Word

</span><span class="hl_comment"><span class="mpre">-- | record some data about this connection.</span></span><span class="mpre">
data </span><a name="loc_20_6_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_6_20_17&#39;)"><span class="hl_tycondecl"><span class="mpre">Measurement</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">Measurement</span></span><span class="mpre">
        { </span><a name="loc_21_11_21_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_11_21_23&#39;)"><span class="hl_fielddecl"><span class="mpre">nbHandshakes</span></span></a><span class="mpre">  :: !</span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ number of handshakes on this context</span></span><span class="mpre">
        , </span><a name="loc_22_11_22_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_11_22_24&#39;)"><span class="hl_fielddecl"><span class="mpre">bytesReceived</span></span></a><span class="mpre"> :: !</span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ bytes received since last handshake</span></span><span class="mpre">
        , </span><a name="loc_23_11_23_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_20&#39;)"><span class="hl_fielddecl"><span class="mpre">bytesSent</span></span></a><span class="mpre">     :: !</span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ bytes sent since last handshake</span></span><span class="mpre">
        } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 11, srcSpanEndLine = 24, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 11, srcSpanEndLine = 24, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStart"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><a href="#loc_27_1_27_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_15&#39;)"><span class="mpre">newMeasurement</span></a><span class="mpre"> :: </span><a href="#loc_20_6_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_6_20_17&#39;)"><span class="hl_tyconref"><span class="mpre">Measurement</span></span></a><span class="mpre">
</span><a name="loc_27_1_27_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_15&#39;)"><span class="hl_vardecl"><span class="mpre">newMeasurement</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 18, srcSpanEndLine = 31, srcSpanEndColumn = 10}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 9, srcSpanEndLine = 28, srcSpanEndColumn = 10},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStart"><span class="mpre">Measurement
        { nbHandshakes  = 0
        , bytesReceived = 0
        , bytesSent     = 0
        }</span></span><span class="mpre">

</span><a href="#loc_34_1_34_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_17&#39;)"><span class="mpre">addBytesReceived</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_20_6_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_6_20_17&#39;)"><span class="hl_tyconref"><span class="mpre">Measurement</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_20_6_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_6_20_17&#39;)"><span class="hl_tyconref"><span class="mpre">Measurement</span></span></a><span class="mpre">
</span><a name="loc_34_1_34_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_17&#39;)"><span class="hl_fundecl"><span class="mpre">addBytesReceived</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">sz</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">measure</span></span><span class="mpre"> =
        </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 9, srcSpanEndLine = 35, srcSpanEndColumn = 76}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 17, srcSpanEndLine = 35, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStart"><span class="mpre">measure { bytesReceived = bytesReceived measure + fromIntegral sz }</span></span><span class="mpre">

</span><a href="#loc_38_1_38_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_13&#39;)"><span class="mpre">addBytesSent</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_20_6_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_6_20_17&#39;)"><span class="hl_tyconref"><span class="mpre">Measurement</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_20_6_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_6_20_17&#39;)"><span class="hl_tyconref"><span class="mpre">Measurement</span></span></a><span class="mpre">
</span><a name="loc_38_1_38_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_13&#39;)"><span class="hl_fundecl"><span class="mpre">addBytesSent</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">sz</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">measure</span></span><span class="mpre"> =
        </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 9, srcSpanEndLine = 39, srcSpanEndColumn = 68}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 17, srcSpanEndLine = 39, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStart"><span class="mpre">measure { bytesSent = bytesSent measure + fromIntegral sz }</span></span><span class="mpre">

</span><a href="#loc_42_1_42_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_19&#39;)"><span class="mpre">resetBytesCounters</span></a><span class="mpre"> :: </span><a href="#loc_20_6_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_6_20_17&#39;)"><span class="hl_tyconref"><span class="mpre">Measurement</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_20_6_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_6_20_17&#39;)"><span class="hl_tyconref"><span class="mpre">Measurement</span></span></a><span class="mpre">
</span><a name="loc_42_1_42_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_19&#39;)"><span class="hl_fundecl"><span class="mpre">resetBytesCounters</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">measure</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 30, srcSpanEndLine = 42, srcSpanEndColumn = 74}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 38, srcSpanEndLine = 42, srcSpanEndColumn = 39},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStar"><span class="mpre">measure { bytesReceived = 0, bytesSent = 0 }</span></span><span class="mpre">

</span><a href="#loc_45_1_45_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_22&#39;)"><span class="mpre">incrementNbHandshakes</span></a><span class="mpre"> :: </span><a href="#loc_20_6_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_6_20_17&#39;)"><span class="hl_tyconref"><span class="mpre">Measurement</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_20_6_20_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_6_20_17&#39;)"><span class="hl_tyconref"><span class="mpre">Measurement</span></span></a><span class="mpre">
</span><a name="loc_45_1_45_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_22&#39;)"><span class="hl_fundecl"><span class="mpre">incrementNbHandshakes</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">measure</span></span><span class="mpre"> =
        </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 9, srcSpanEndLine = 46, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 17, srcSpanEndLine = 46, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Measurement.hs&quot;, srcSpanStart"><span class="mpre">measure { nbHandshakes = nbHandshakes measure + 1 }</span></span><span class="mpre">
</span></div></body></html>