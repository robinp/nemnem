<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}

</span><span class="hl_comment"><span class="mpre">-- | List conversions and utilities.</span></span><span class="mpre">

module System.IO.Streams.List
 ( </span><span class="hl_comment"><span class="mpre">-- * List conversions</span></span><span class="mpre">
   fromList
 , toList
 , outputToList
 , writeList

   </span><span class="hl_comment"><span class="mpre">-- * Utility</span></span><span class="mpre">
 , chunkList
 , concatLists
 , listOutputStream
 ) where

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           Control.Concurrent.MVar    (</span><a href="Control.Concurrent.MVar.html#loc_228_1_228_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Concurrent.MVar.html#loc_228_1_228_11&#39;)"><span class="mpre">modifyMVar</span></a><span class="mpre">, </span><a href="Control.Concurrent.MVar.html#loc_216_1_216_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Concurrent.MVar.html#loc_216_1_216_12&#39;)"><span class="mpre">modifyMVar_</span></a><span class="mpre">, </span><a href="GHC.MVar.html#loc_70_1_70_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_70_1_70_8&#39;)"><span class="mpre">newMVar</span></a><span class="mpre">)
import           Control.Monad.IO.Class     (</span><a href="Control.Monad.IO.Class.html#loc_30_20_30_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_30_20_30_27&#39;)"><span class="mpre">MonadIO</span></a><span class="mpre"> (..))
import           Data.IORef                 (</span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="mpre">newIORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="mpre">readIORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="mpre">writeIORef</span></a><span class="mpre">)
import           Prelude                    hiding (</span><a href="Text.Read.html#loc_91_1_91_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Read.html#loc_91_1_91_5&#39;)"><span class="mpre">read</span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           System.IO.Streams.Internal (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="mpre">InputStream</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="mpre">OutputStream</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_653_1_653_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_653_1_653_6&#39;)"><span class="mpre">await</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_188_1_188_8&#39;)"><span class="mpre">connect</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_658_1_658_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_658_1_658_13&#39;)"><span class="mpre">fromConsumer</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_599_1_599_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_599_1_599_14&#39;)"><span class="mpre">fromGenerator</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="mpre">makeInputStream</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="mpre">read</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="mpre">write</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_593_1_593_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_593_1_593_6&#39;)"><span class="mpre">yield</span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Transforms a list into an &#39;InputStream&#39; that produces no side effects.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; is &lt;- Streams.&#39;fromList&#39; [1, 2]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; &#39;replicateM&#39; 3 (Streams.&#39;read&#39; is)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [Just 1, Just 2, Nothing]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_9&#39;)"><span class="mpre">fromList</span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">)
</span><a name="loc_36_1_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_9&#39;)"><span class="hl_fundecl"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><a name="loc_36_10_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_10_36_13&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> = </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="#loc_36_10_36_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_10_36_13&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="hl_varref"><span class="mpre">makeInputStream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_38_5_38_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_5_38_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
  where
    </span><a name="loc_38_5_38_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_5_38_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_38_7_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_10&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> = </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_38_7_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_10&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_38_32_38_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_32_38_33&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> -&gt;
            case </span><a href="#loc_38_32_38_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_32_38_33&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> of
              []     -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
              (</span><a name="loc_41_16_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_16_41_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_41_18_41_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_18_41_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) -&gt; </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_38_7_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_7_38_10&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_41_18_41_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_18_41_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_41_16_41_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_16_41_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_9&#39;)"><span class="mpre">fromList</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | &#39;listOutputStream&#39; returns an &#39;OutputStream&#39; which stores values fed into</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- it and an action which flushes all stored values to a list.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The flush action resets the store.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that this function /will/ buffer any input sent to it on the heap.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Please don&#39;t use this unless you&#39;re sure that the amount of input provided</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is bounded and will fit in memory without issues.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; (os, flush) &lt;- Streams.&#39;listOutputStream&#39; :: IO (&#39;OutputStream&#39; Int, IO [Int])</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;writeList&#39; [1, 2] os</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; flush</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [1, 2]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;writeList&#39; [3, 4] os</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; flush</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [3, 4]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_17&#39;)"><span class="mpre">listOutputStream</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">])
</span><a name="loc_65_1_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_17&#39;)"><span class="hl_vardecl"><span class="mpre">listOutputStream</span></span></a><span class="mpre"> = do
    </span><a name="loc_66_5_66_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_6&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_70_1_70_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_70_1_70_8&#39;)"><span class="hl_varref"><span class="mpre">newMVar</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
    </span><a name="loc_67_5_67_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_5_67_6&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_658_1_658_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_658_1_658_13&#39;)"><span class="hl_varref"><span class="mpre">fromConsumer</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_71_5_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_13&#39;)"><span class="hl_varref"><span class="mpre">consumer</span></span></a><span class="mpre"> </span><a href="#loc_66_5_66_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_6&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_67_5_67_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_5_67_6&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><a href="#loc_77_5_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_10&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre"> </span><a href="#loc_66_5_66_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_6&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)

  where
    </span><a name="loc_71_5_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_13&#39;)"><span class="hl_fundecl"><span class="mpre">consumer</span></span></a><span class="mpre"> </span><a name="loc_71_14_71_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_14_71_15&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_73_9_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
      where
        </span><a name="loc_73_9_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_11&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_653_1_653_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_653_1_653_6&#39;)"><span class="hl_varref"><span class="mpre">await</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_73_49_73_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_49_73_50&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; do
                            </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Concurrent.MVar.html#loc_216_1_216_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Concurrent.MVar.html#loc_216_1_216_12&#39;)"><span class="hl_varref"><span class="mpre">modifyMVar_</span></span></a><span class="mpre"> </span><a href="#loc_71_14_71_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_14_71_15&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_74_55_74_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_55_74_57&#39;)"><span class="hl_vardecl"><span class="mpre">dl</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_74_55_74_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_55_74_57&#39;)"><span class="hl_varref"><span class="mpre">dl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_73_49_73_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_49_73_50&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">))
                            </span><a href="#loc_73_9_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">)

    </span><a name="loc_77_5_77_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_10&#39;)"><span class="hl_fundecl"><span class="mpre">flush</span></span></a><span class="mpre"> </span><a name="loc_77_11_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_11_77_12&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="Control.Concurrent.MVar.html#loc_228_1_228_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Concurrent.MVar.html#loc_228_1_228_11&#39;)"><span class="hl_varref"><span class="mpre">modifyMVar</span></span></a><span class="mpre"> </span><a href="#loc_77_11_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_11_77_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_77_31_77_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_31_77_33&#39;)"><span class="hl_vardecl"><span class="mpre">dl</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">, </span><a href="#loc_77_31_77_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_31_77_33&#39;)"><span class="hl_varref"><span class="mpre">dl</span></span></a><span class="mpre"> [])
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_17&#39;)"><span class="mpre">listOutputStream</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Drains an &#39;InputStream&#39;, converting it to a list. N.B. that this function</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- reads the entire &#39;InputStream&#39; strictly into memory and as such is not</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- recommended for streaming applications or where the size of the input is not</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- bounded or known.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; is &lt;- Streams.&#39;fromList&#39; [1, 2]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;toList&#39; is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [1, 2]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_7&#39;)"><span class="mpre">toList</span></a><span class="mpre"> :: </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_93_1_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_7&#39;)"><span class="hl_fundecl"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a name="loc_93_8_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_8_93_10&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> = </span><a href="#loc_109_1_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_13&#39;)"><span class="hl_varref"><span class="mpre">outputToList</span></span></a><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_188_1_188_8&#39;)"><span class="hl_varref"><span class="mpre">connect</span></span></a><span class="mpre"> </span><a href="#loc_93_8_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_8_93_10&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_7&#39;)"><span class="mpre">toList</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Given an IO action that requires an &#39;OutputStream&#39;, creates one and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- captures all the output the action sends to it as a list.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; import &quot;Control.Applicative&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; (&#39;connect&#39; &lt;$&gt; &#39;fromList&#39; [\&quot;a\&quot;, \&quot;b\&quot;, \&quot;c\&quot;]) &gt;&gt;= &#39;outputToList&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [\&quot;a\&quot;,\&quot;b\&quot;,\&quot;c\&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_109_1_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_13&#39;)"><span class="mpre">outputToList</span></a><span class="mpre"> :: (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_109_1_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_13&#39;)"><span class="hl_fundecl"><span class="mpre">outputToList</span></span></a><span class="mpre"> </span><a name="loc_109_14_109_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_14_109_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
    (</span><a name="loc_110_6_110_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_6_110_8&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">, </span><a name="loc_110_10_110_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_10_110_17&#39;)"><span class="hl_vardecl"><span class="mpre">getList</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">listOutputStream</span></span></a><span class="mpre">
    _ &lt;- </span><a href="#loc_109_14_109_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_14_109_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_110_6_110_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_6_110_8&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">
    </span><a href="#loc_110_10_110_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_10_110_17&#39;)"><span class="hl_varref"><span class="mpre">getList</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_109_1_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_13&#39;)"><span class="mpre">outputToList</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Feeds a list to an &#39;OutputStream&#39;. Does /not/ write an end-of-stream to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the stream.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; os \&lt;- Streams.&#39;unlines&#39; Streams.&#39;System.IO.Streams.stdout&#39; &gt;&gt;= Streams.&#39;System.IO.Streams.contramap&#39; (S.pack . show) :: IO (&#39;OutputStream&#39; Int)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;writeList&#39; [1, 2] os</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 1</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;writeList&#39; [3, 4] os</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 4</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_10&#39;)"><span class="mpre">writeList</span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_130_1_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_10&#39;)"><span class="hl_fundecl"><span class="mpre">writeList</span></span></a><span class="mpre"> </span><a name="loc_130_11_130_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_11_130_13&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_130_14_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_14_130_16&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_130_14_130_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_14_130_16&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre">) </span><a href="#loc_130_11_130_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_11_130_13&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_10&#39;)"><span class="mpre">writeList</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Splits an input stream into chunks of at most size @n@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; &#39;fromList&#39; [1..14::Int] &gt;&gt;= &#39;chunkList&#39; 4 &gt;&gt;= &#39;toList&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [[1,2,3,4],[5,6,7,8],[9,10,11,12],[13,14]]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_146_1_146_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_10&#39;)"><span class="mpre">chunkList</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">                   </span><span class="hl_comment"><span class="mpre">-- ^ chunk size</span></span><span class="mpre">
          -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ stream to process</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">])
</span><a name="loc_146_1_146_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunkList</span></span></a><span class="mpre"> </span><a name="loc_146_11_146_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_11_146_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_146_13_146_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_13_146_18&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = if </span><a href="#loc_146_11_146_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_11_146_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                      then </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;chunkList: bad size: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_146_11_146_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_11_146_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
                      else </span><a href="System.IO.Streams.Internal.html#loc_599_1_599_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_599_1_599_14&#39;)"><span class="hl_varref"><span class="mpre">fromGenerator</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_150_5_150_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_5_150_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_146_11_146_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_11_146_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
  where
    </span><a name="loc_150_5_150_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_5_150_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_150_9_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_150_11_150_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_11_150_13&#39;)"><span class="hl_vardecl"><span class="mpre">dl</span></span></a><span class="mpre"> | </span><a href="#loc_150_9_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">    = </span><a href="System.IO.Streams.Internal.html#loc_593_1_593_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_593_1_593_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> (</span><a href="#loc_150_11_150_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_11_150_13&#39;)"><span class="hl_varref"><span class="mpre">dl</span></span></a><span class="mpre"> []) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_150_5_150_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_5_150_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_146_11_146_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_11_146_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
             | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
                   </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_146_13_146_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_13_146_18&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><a href="#loc_154_9_154_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_15&#39;)"><span class="hl_varref"><span class="mpre">finish</span></span></a><span class="mpre"> </span><a href="#loc_156_9_156_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_14&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre">
      where
        </span><a name="loc_154_9_154_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_15&#39;)"><span class="hl_vardecl"><span class="mpre">finish</span></span></a><span class="mpre">  = let </span><a name="loc_154_23_154_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_23_154_24&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_150_11_150_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_11_150_13&#39;)"><span class="hl_varref"><span class="mpre">dl</span></span></a><span class="mpre"> []
                  in if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_154_23_154_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_23_154_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> else </span><a href="System.IO.Streams.Internal.html#loc_593_1_593_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_593_1_593_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> </span><a href="#loc_154_23_154_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_23_154_24&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
        </span><a name="loc_156_9_156_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_14&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_156_15_156_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_15_156_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_150_5_150_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_5_150_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_150_9_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_150_11_150_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_11_150_13&#39;)"><span class="hl_varref"><span class="mpre">dl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_156_15_156_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_15_156_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">))


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Given an input stream containing lists, produces a new input stream that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will yield the concatenation of these lists. See &#39;Prelude.concat&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;fromList&#39; [[1,2,3::Int], [4,5,6]] &gt;&gt;=</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--       Streams.&#39;concatLists&#39; &gt;&gt;=</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--       Streams.&#39;toList&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [1,2,3,4,5,6]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_172_1_172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_1_172_12&#39;)"><span class="mpre">concatLists</span></a><span class="mpre"> :: </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_172_1_172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_1_172_12&#39;)"><span class="hl_fundecl"><span class="mpre">concatLists</span></span></a><span class="mpre"> </span><a name="loc_172_13_172_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_13_172_18&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_599_1_599_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_599_1_599_14&#39;)"><span class="hl_varref"><span class="mpre">fromGenerator</span></span></a><span class="mpre"> </span><a href="#loc_174_5_174_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_5_174_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
    </span><a name="loc_174_5_174_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_5_174_7&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre">      = </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_172_13_172_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_13_172_18&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_175_5_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_5_175_10&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre">
    </span><a name="loc_175_5_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_5_175_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_175_11_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_11_175_12&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_106_1_106_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_106_1_106_10&#39;)"><span class="hl_varref"><span class="mpre">sequence_</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_593_1_593_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_593_1_593_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> </span><a href="#loc_175_11_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_11_175_12&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_174_5_174_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_5_174_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
</span></div></body></html>