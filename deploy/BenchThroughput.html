<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : BenchThroughput</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : Simon Meier</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD3-style (see LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Simon Meier &lt;iridcode@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : GHC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This benchmark is based on &#39;tests/Benchmark.hs&#39; from the &#39;binary-0.5.0.2&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- package.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Benchmark the throughput of &#39;blaze-builder&#39; and &#39;binary&#39; for serializing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- sequences of &#39;Word8&#39; .. &#39;Word64&#39; values in little-endian, big-endian, and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;host-endian&quot; formats.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The results on a Core2 Duo T7500 with Linux 2.6.32-24 i686 and GHC 6.12.3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- are as follows:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Using the Blaze.Builder directly (i.e. not encapsulated in a writer monad</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   as Put is doing it) gives the best scalability. Up to &#39;Word32&#39;, it holds</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   that the bigger the chunk size, the bigger the relative speedup of using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   the Blaze.Builder. For &#39;Word64&#39;, the speedup is not as impressive.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Probably due to the more expensive writes.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module BenchThroughput (main) where

import qualified Throughput.BinaryBuilder as BinaryBuilder
import qualified Throughput.BinaryPut     as BinaryPut
import qualified Throughput.BinaryBuilderDeclarative as BinaryBuilderDecl

import qualified Throughput.BlazeBuilder as BlazeBuilder
import qualified Throughput.BlazePut     as BlazePut
import qualified Throughput.BlazeBuilderDeclarative as BlazeBuilderDecl

import Throughput.Utils
import Throughput.Memory

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BenchThroughput.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 18, srcSpanEndLine = 42, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import Debug.Trace
import Data.Binary
import Data.Binary.Put
import Data.Binary.Get

import Control.Exception
import Control.Monad
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BenchThroughput.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 8, srcSpanEndLine = 50, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;System.CPUTime&quot;"><span class="mpre">System.CPUTime</span></span><span class="mpre">
import Numeric
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BenchThroughput.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 8, srcSpanEndLine = 52, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;Text.Printf&quot;"><span class="mpre">Text.Printf</span></span><span class="mpre">
import System.Environment
import System.IO

import Data.Maybe
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BenchThroughput.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 8, srcSpanEndLine = 57, srcSpanEndColumn = 21}, srcInfoPoints = []}) &quot;Data.Accessor&quot;"><span class="mpre">Data.Accessor</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BenchThroughput.hs&quot;, srcSpanStartLine = 58, srcSpanStartColumn = 8, srcSpanEndLine = 58, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;Data.Colour&quot;"><span class="mpre">Data.Colour</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BenchThroughput.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 8, srcSpanEndLine = 59, srcSpanEndColumn = 25}, srcInfoPoints = []}) &quot;Data.Colour.Names&quot;"><span class="mpre">Data.Colour.Names</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BenchThroughput.hs&quot;, srcSpanStartLine = 60, srcSpanStartColumn = 8, srcSpanEndLine = 60, srcSpanEndColumn = 32}, srcInfoPoints = []}) &quot;Graphics.Rendering.Chart&quot;"><span class="mpre">Graphics.Rendering.Chart</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BenchThroughput.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 8, srcSpanEndLine = 61, srcSpanEndColumn = 36}, srcInfoPoints = []}) &quot;Graphics.Rendering.Chart.Gtk&quot;"><span class="mpre">Graphics.Rendering.Chart.Gtk</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- The different serialization functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------</span></span><span class="mpre">

</span><a name="loc_67_1_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_16&#39;)"><span class="hl_fundecl"><span class="mpre">supportAllSizes</span></span></a><span class="mpre"> </span><a name="loc_67_17_67_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_17_67_18&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_67_19_67_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_19_67_21&#39;)"><span class="hl_vardecl"><span class="mpre">wS</span></span></a><span class="mpre"> </span><a name="loc_67_22_67_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_22_67_24&#39;)"><span class="hl_vardecl"><span class="mpre">cS</span></span></a><span class="mpre"> </span><a name="loc_67_25_67_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_25_67_26&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> </span><a name="loc_67_27_67_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_27_67_28&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_67_17_67_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_17_67_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_67_19_67_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_19_67_21&#39;)"><span class="hl_varref"><span class="mpre">wS</span></span></a><span class="mpre"> </span><a href="#loc_67_22_67_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_22_67_24&#39;)"><span class="hl_varref"><span class="mpre">cS</span></span></a><span class="mpre"> </span><a href="#loc_67_25_67_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_25_67_26&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="#loc_67_27_67_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_27_67_28&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

</span><a name="loc_69_1_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_15&#39;)"><span class="hl_vardecl"><span class="mpre">blazeLineStyle</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">solidLine</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">opaque</span></span><span class="mpre">
</span><a name="loc_70_1_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_16&#39;)"><span class="hl_vardecl"><span class="mpre">binaryLineStyle</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">dashedLine</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> [</span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">opaque</span></span><span class="mpre">

</span><a name="loc_72_1_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_13&#39;)"><span class="hl_vardecl"><span class="mpre">blazeBuilder</span></span></a><span class="mpre">      = 
  ( </span><span class="hl_string"><span class="mpre">&quot;BlazeBuilder&quot;</span></span><span class="mpre">
  , </span><a href="#loc_69_1_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_15&#39;)"><span class="hl_varref"><span class="mpre">blazeLineStyle</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">green</span></span><span class="mpre">
  , </span><a href="#loc_67_1_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_16&#39;)"><span class="hl_varref"><span class="mpre">supportAllSizes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Throughput.BlazeBuilder.html#loc_14_1_14_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.BlazeBuilder.html#loc_14_1_14_10&#39;)"><span class="hl_varref"><span class="mpre">BlazeBuilder.serialize</span></span></a><span class="mpre">)

</span><a name="loc_77_1_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_17&#39;)"><span class="hl_vardecl"><span class="mpre">blazeBuilderDecl</span></span></a><span class="mpre">  = 
  ( </span><span class="hl_string"><span class="mpre">&quot;BlazeBuilderDecl&quot;</span></span><span class="mpre">
  , </span><a href="#loc_69_1_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_15&#39;)"><span class="hl_varref"><span class="mpre">blazeLineStyle</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">blue</span></span><span class="mpre">
  , </span><a href="#loc_67_1_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_16&#39;)"><span class="hl_varref"><span class="mpre">supportAllSizes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Throughput.BlazeBuilderDeclarative.html#loc_15_1_15_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.BlazeBuilderDeclarative.html#loc_15_1_15_10&#39;)"><span class="hl_varref"><span class="mpre">BlazeBuilderDecl.serialize</span></span></a><span class="mpre">)

</span><a name="loc_82_1_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_9&#39;)"><span class="hl_vardecl"><span class="mpre">blazePut</span></span></a><span class="mpre">          = 
  ( </span><span class="hl_string"><span class="mpre">&quot;BlazePut&quot;</span></span><span class="mpre">
  , </span><a href="#loc_69_1_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_15&#39;)"><span class="hl_varref"><span class="mpre">blazeLineStyle</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">red</span></span><span class="mpre">
  , </span><a href="#loc_67_1_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_16&#39;)"><span class="hl_varref"><span class="mpre">supportAllSizes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Throughput.BlazePut.html#loc_15_1_15_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.BlazePut.html#loc_15_1_15_10&#39;)"><span class="hl_varref"><span class="mpre">BlazePut.serialize</span></span></a><span class="mpre">)

</span><a name="loc_87_1_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_14&#39;)"><span class="hl_vardecl"><span class="mpre">binaryBuilder</span></span></a><span class="mpre">     = 
  ( </span><span class="hl_string"><span class="mpre">&quot;BinaryBuilder&quot;</span></span><span class="mpre">
  , </span><a href="#loc_70_1_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_16&#39;)"><span class="hl_varref"><span class="mpre">binaryLineStyle</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">green</span></span><span class="mpre">
  , </span><a href="#loc_67_1_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_16&#39;)"><span class="hl_varref"><span class="mpre">supportAllSizes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Throughput.BinaryBuilder.html#loc_11_1_11_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.BinaryBuilder.html#loc_11_1_11_10&#39;)"><span class="hl_varref"><span class="mpre">BinaryBuilder.serialize</span></span></a><span class="mpre">)

</span><a name="loc_92_1_92_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_18&#39;)"><span class="hl_vardecl"><span class="mpre">binaryBuilderDecl</span></span></a><span class="mpre"> = 
  ( </span><span class="hl_string"><span class="mpre">&quot;BinaryBuilderDecl&quot;</span></span><span class="mpre">
  , </span><a href="#loc_70_1_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_16&#39;)"><span class="hl_varref"><span class="mpre">binaryLineStyle</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">blue</span></span><span class="mpre">
  , </span><a href="Throughput.BinaryBuilderDeclarative.html#loc_16_1_16_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.BinaryBuilderDeclarative.html#loc_16_1_16_10&#39;)"><span class="hl_varref"><span class="mpre">BinaryBuilderDecl.serialize</span></span></a><span class="mpre">)

</span><a name="loc_97_1_97_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_10&#39;)"><span class="hl_vardecl"><span class="mpre">binaryPut</span></span></a><span class="mpre">  = 
  ( </span><span class="hl_string"><span class="mpre">&quot;BinaryPut&quot;</span></span><span class="mpre">
  , </span><a href="#loc_70_1_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_16&#39;)"><span class="hl_varref"><span class="mpre">binaryLineStyle</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">red</span></span><span class="mpre">
  , </span><a href="#loc_67_1_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_16&#39;)"><span class="hl_varref"><span class="mpre">supportAllSizes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Throughput.BinaryPut.html#loc_10_1_10_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.BinaryPut.html#loc_10_1_10_10&#39;)"><span class="hl_varref"><span class="mpre">BinaryPut.serialize</span></span></a><span class="mpre">)


</span><a href="#loc_104_1_104_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_5&#39;)"><span class="mpre">main</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_104_1_104_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_5&#39;)"><span class="hl_vardecl"><span class="mpre">main</span></span></a><span class="mpre"> = do
  </span><a name="loc_105_3_105_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_3_105_5&#39;)"><span class="hl_vardecl"><span class="mpre">mb</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">getArgs</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.html#loc_346_1_346_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_346_1_346_7&#39;)"><span class="hl_varref"><span class="mpre">readIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- memBench (mb*10) </span></span><span class="mpre">
  </span><a href="System.IO.html#loc_267_1_267_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_267_1_267_9&#39;)"><span class="hl_varref"><span class="mpre">putStrLn</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
  </span><a href="System.IO.html#loc_267_1_267_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_267_1_267_9&#39;)"><span class="hl_varref"><span class="mpre">putStrLn</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Binary serialisation benchmarks:&quot;</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- do bytewise </span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- sequence_</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- [ test wordSize chunkSize Host mb</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | wordSize  &lt;- [1]</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- , chunkSize &lt;- [1,2,4,8,16]</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ]</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- now Word16 .. Word64</span></span><span class="mpre">
  let </span><span class="hl_fundecl"><span class="mpre">lift</span></span><span class="mpre"> </span><a name="loc_118_12_118_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_12_118_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_118_14_118_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_14_118_16&#39;)"><span class="hl_vardecl"><span class="mpre">wS</span></span></a><span class="mpre"> </span><a name="loc_118_17_118_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_17_118_19&#39;)"><span class="hl_vardecl"><span class="mpre">cS</span></span></a><span class="mpre"> </span><a name="loc_118_20_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_20_118_21&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> </span><a name="loc_118_22_118_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_22_118_23&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_118_12_118_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_12_118_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_118_14_118_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_14_118_16&#39;)"><span class="hl_varref"><span class="mpre">wS</span></span></a><span class="mpre"> </span><a href="#loc_118_17_118_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_17_118_19&#39;)"><span class="hl_varref"><span class="mpre">cS</span></span></a><span class="mpre"> </span><a href="#loc_118_20_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_20_118_21&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="#loc_118_22_118_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_22_118_23&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
      </span><a name="loc_119_7_119_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_18&#39;)"><span class="hl_vardecl"><span class="mpre">serializers</span></span></a><span class="mpre"> = 
        [ </span><a href="#loc_72_1_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_13&#39;)"><span class="hl_varref"><span class="mpre">blazeBuilder</span></span></a><span class="mpre"> , </span><a href="#loc_77_1_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_17&#39;)"><span class="hl_varref"><span class="mpre">blazeBuilderDecl</span></span></a><span class="mpre"> , </span><a href="#loc_82_1_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_9&#39;)"><span class="hl_varref"><span class="mpre">blazePut</span></span></a><span class="mpre">
        , </span><a href="#loc_87_1_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_14&#39;)"><span class="hl_varref"><span class="mpre">binaryBuilder</span></span></a><span class="mpre">, </span><a href="#loc_92_1_92_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_18&#39;)"><span class="hl_varref"><span class="mpre">binaryBuilderDecl</span></span></a><span class="mpre">, </span><a href="#loc_97_1_97_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_10&#39;)"><span class="hl_varref"><span class="mpre">binaryPut</span></span></a><span class="mpre">
        ]
      </span><a name="loc_123_7_123_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_7_123_16&#39;)"><span class="hl_vardecl"><span class="mpre">wordSizes</span></span></a><span class="mpre">  = [</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">]
      </span><a name="loc_124_7_124_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_17&#39;)"><span class="hl_vardecl"><span class="mpre">chunkSizes</span></span></a><span class="mpre"> = [</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">] 
      </span><a name="loc_125_7_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_7_125_14&#39;)"><span class="hl_vardecl"><span class="mpre">endians</span></span></a><span class="mpre">    = [</span><a href="Throughput.Utils.html#loc_9_7_9_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.Utils.html#loc_9_7_9_11&#39;)"><span class="hl_conref"><span class="mpre">Host</span></span></a><span class="mpre">,</span><a href="Throughput.Utils.html#loc_7_7_7_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.Utils.html#loc_7_7_7_10&#39;)"><span class="hl_conref"><span class="mpre">Big</span></span></a><span class="mpre">,</span><a href="Throughput.Utils.html#loc_8_7_8_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.Utils.html#loc_8_7_8_13&#39;)"><span class="hl_conref"><span class="mpre">Little</span></span></a><span class="mpre">]

  let </span><span class="hl_vardecl"><span class="mpre">compares</span></span><span class="mpre"> = 
        [ </span><a href="#loc_224_1_224_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_15&#39;)"><span class="hl_varref"><span class="mpre">compareResults</span></span></a><span class="mpre"> </span><a href="#loc_132_11_132_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_11_132_20&#39;)"><span class="hl_varref"><span class="mpre">serialize</span></span></a><span class="mpre"> </span><a href="#loc_129_11_129_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_11_129_19&#39;)"><span class="hl_varref"><span class="mpre">wordSize</span></span></a><span class="mpre"> </span><a href="#loc_130_11_130_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_11_130_20&#39;)"><span class="hl_varref"><span class="mpre">chunkSize</span></span></a><span class="mpre"> </span><a href="#loc_131_11_131_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_11_131_14&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre"> </span><a href="#loc_105_3_105_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_3_105_5&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre">
        | </span><a name="loc_129_11_129_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_11_129_19&#39;)"><span class="hl_vardecl"><span class="mpre">wordSize</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_123_7_123_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_7_123_16&#39;)"><span class="hl_varref"><span class="mpre">wordSizes</span></span></a><span class="mpre">
        , </span><a name="loc_130_11_130_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_11_130_20&#39;)"><span class="hl_vardecl"><span class="mpre">chunkSize</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_124_7_124_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_17&#39;)"><span class="hl_varref"><span class="mpre">chunkSizes</span></span></a><span class="mpre">
        , </span><a name="loc_131_11_131_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_11_131_14&#39;)"><span class="hl_vardecl"><span class="mpre">end</span></span></a><span class="mpre">       &lt;- </span><a href="#loc_125_7_125_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_7_125_14&#39;)"><span class="hl_varref"><span class="mpre">endians</span></span></a><span class="mpre">
        , </span><a name="loc_132_11_132_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_11_132_20&#39;)"><span class="hl_vardecl"><span class="mpre">serialize</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_119_7_119_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_18&#39;)"><span class="hl_varref"><span class="mpre">serializers</span></span></a><span class="mpre">
        , </span><a href="#loc_129_11_129_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_11_129_19&#39;)"><span class="hl_varref"><span class="mpre">wordSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_131_11_131_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_11_131_14&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Throughput.Utils.html#loc_9_7_9_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.Utils.html#loc_9_7_9_11&#39;)"><span class="hl_conref"><span class="mpre">Host</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- no endianess for Word8</span></span><span class="mpre">
        ]
  </span><span class="hl_comment"><span class="mpre">-- putStrLn &quot;checking equality of serialization results:&quot;</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- sequence_ compares</span></span><span class="mpre">


  let </span><a name="loc_139_7_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_7_139_17&#39;)"><span class="hl_vardecl"><span class="mpre">serializes</span></span></a><span class="mpre"> = 
        [  [ ( </span><a href="#loc_145_14_145_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_14_145_23&#39;)"><span class="hl_varref"><span class="mpre">serialize</span></span></a><span class="mpre">
             , [ (</span><a href="#loc_142_18_142_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_18_142_27&#39;)"><span class="hl_varref"><span class="mpre">chunkSize</span></span></a><span class="mpre">, </span><a href="#loc_196_1_196_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_5&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre"> </span><a href="#loc_145_14_145_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_14_145_23&#39;)"><span class="hl_varref"><span class="mpre">serialize</span></span></a><span class="mpre"> </span><a href="#loc_147_11_147_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_11_147_19&#39;)"><span class="hl_varref"><span class="mpre">wordSize</span></span></a><span class="mpre"> </span><a href="#loc_142_18_142_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_18_142_27&#39;)"><span class="hl_varref"><span class="mpre">chunkSize</span></span></a><span class="mpre"> </span><a href="#loc_148_11_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_11_148_14&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre"> </span><a href="#loc_105_3_105_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_3_105_5&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre">)
               | </span><a name="loc_142_18_142_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_18_142_27&#39;)"><span class="hl_vardecl"><span class="mpre">chunkSize</span></span></a><span class="mpre"> &lt;- [</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">]
               ]
             )
           | </span><a name="loc_145_14_145_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_14_145_23&#39;)"><span class="hl_vardecl"><span class="mpre">serialize</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_119_7_119_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_7_119_18&#39;)"><span class="hl_varref"><span class="mpre">serializers</span></span></a><span class="mpre">
           ]
        | </span><a name="loc_147_11_147_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_11_147_19&#39;)"><span class="hl_vardecl"><span class="mpre">wordSize</span></span></a><span class="mpre">  &lt;- [</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">]
        , </span><a name="loc_148_11_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_11_148_14&#39;)"><span class="hl_vardecl"><span class="mpre">end</span></span></a><span class="mpre">       &lt;- [</span><a href="Throughput.Utils.html#loc_9_7_9_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.Utils.html#loc_9_7_9_11&#39;)"><span class="hl_conref"><span class="mpre">Host</span></span></a><span class="mpre">,</span><a href="Throughput.Utils.html#loc_7_7_7_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.Utils.html#loc_7_7_7_10&#39;)"><span class="hl_conref"><span class="mpre">Big</span></span></a><span class="mpre">,</span><a href="Throughput.Utils.html#loc_8_7_8_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.Utils.html#loc_8_7_8_13&#39;)"><span class="hl_conref"><span class="mpre">Little</span></span></a><span class="mpre">]
        , </span><a href="#loc_147_11_147_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_11_147_19&#39;)"><span class="hl_varref"><span class="mpre">wordSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_148_11_148_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_11_148_14&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Throughput.Utils.html#loc_9_7_9_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.Utils.html#loc_9_7_9_11&#39;)"><span class="hl_conref"><span class="mpre">Host</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- no endianess for Word8</span></span><span class="mpre">
        ]


  </span><a href="System.IO.html#loc_267_1_267_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_267_1_267_9&#39;)"><span class="hl_varref"><span class="mpre">putStrLn</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n\nbenchmarking serialization speed:&quot;</span></span><span class="mpre">
  </span><a name="loc_154_3_154_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_3_154_10&#39;)"><span class="hl_vardecl"><span class="mpre">results</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_111_1_111_5&#39;)"><span class="hl_varref"><span class="mpre">mapM</span></span></a><span class="mpre"> </span><a href="#loc_158_1_158_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_8&#39;)"><span class="hl_varref"><span class="mpre">mkChart</span></span></a><span class="mpre"> </span><a href="#loc_139_7_139_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_7_139_17&#39;)"><span class="hl_varref"><span class="mpre">serializes</span></span></a><span class="mpre">
  </span><a href="System.IO.html#loc_281_1_281_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_281_1_281_6&#39;)"><span class="hl_varref"><span class="mpre">print</span></span></a><span class="mpre"> </span><a href="#loc_154_3_154_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_3_154_10&#39;)"><span class="hl_varref"><span class="mpre">results</span></span></a><span class="mpre">

</span><a href="#loc_158_1_158_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_8&#39;)"><span class="mpre">mkChart</span></a><span class="mpre"> :: [((</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">CairoLineStyle</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">), [(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">))])] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_158_1_158_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_8&#39;)"><span class="hl_fundecl"><span class="mpre">mkChart</span></span></a><span class="mpre"> </span><a name="loc_158_9_158_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_9_158_13&#39;)"><span class="hl_vardecl"><span class="mpre">task</span></span></a><span class="mpre"> = do
  </span><a name="loc_159_3_159_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_3_159_8&#39;)"><span class="hl_vardecl"><span class="mpre">lines</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Maybe.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_115_1_115_10&#39;)"><span class="hl_varref"><span class="mpre">catMaybes</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_infix"><span class="mpre">`liftM`</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_111_1_111_5&#39;)"><span class="hl_varref"><span class="mpre">mapM</span></span></a><span class="mpre"> </span><a href="#loc_173_1_173_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_18&#39;)"><span class="hl_varref"><span class="mpre">measureSerializer</span></span></a><span class="mpre"> </span><a href="#loc_158_9_158_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_9_158_13&#39;)"><span class="hl_varref"><span class="mpre">task</span></span></a><span class="mpre">
  let </span><span class="hl_vardecl"><span class="mpre">plottedLines</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_159_3_159_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_3_159_8&#39;)"><span class="hl_varref"><span class="mpre">lines</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ ((</span><a name="loc_160_43_160_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_43_160_47&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">,</span><a name="loc_160_48_160_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_48_160_57&#39;)"><span class="hl_vardecl"><span class="mpre">lineStyle</span></span></a><span class="mpre">,_), </span><a name="loc_160_62_160_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_62_160_68&#39;)"><span class="hl_vardecl"><span class="mpre">points</span></span></a><span class="mpre">) -&gt;
          </span><span class="hl_varref"><span class="mpre">plot_lines_title</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^=</span></span><span class="mpre"> </span><a href="#loc_160_43_160_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_43_160_47&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
          </span><span class="hl_varref"><span class="mpre">plot_lines_style</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^=</span></span><span class="mpre"> </span><a href="#loc_160_48_160_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_48_160_57&#39;)"><span class="hl_varref"><span class="mpre">lineStyle</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
          </span><span class="hl_varref"><span class="mpre">plot_lines_values</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^=</span></span><span class="mpre"> [</span><a href="#loc_160_62_160_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_62_160_68&#39;)"><span class="hl_varref"><span class="mpre">points</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> 
          </span><span class="hl_varref"><span class="mpre">defaultPlotLines</span></span><span class="mpre">
  let </span><span class="hl_vardecl"><span class="mpre">layout</span></span><span class="mpre"> = 
        </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BenchThroughput.hs&quot;, srcSpanStartLine = 166, srcSpanStartColumn = 9, srcSpanEndLine = 167, srcSpanEndColumn = 65}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/BenchThroughput.hs&quot;, srcSpanStartLine = 167, srcSpanStartColumn = 11, srcSpanEndLine = 167, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3"><span class="mpre">defaultLayout1
          { layout1_plots_ = map (Right . toPlot) plottedLines }</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- renderableToWindow (toRenderable layout) 640 480  </span></span><span class="mpre">


</span><a href="#loc_173_1_173_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_18&#39;)"><span class="mpre">measureSerializer</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, [(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">))]) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, [(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)]))
</span><a name="loc_173_1_173_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_18&#39;)"><span class="hl_fundecl"><span class="mpre">measureSerializer</span></span></a><span class="mpre"> (</span><a name="loc_173_20_173_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_20_173_24&#39;)"><span class="hl_vardecl"><span class="mpre">info</span></span></a><span class="mpre">, </span><a name="loc_173_26_173_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_26_173_31&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre">) = do
  </span><a name="loc_174_3_174_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_3_174_12&#39;)"><span class="hl_vardecl"><span class="mpre">optPoints</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_163_1_163_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_163_1_163_5&#39;)"><span class="hl_varref"><span class="mpre">forM</span></span></a><span class="mpre"> </span><a href="#loc_173_26_173_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_26_173_31&#39;)"><span class="hl_varref"><span class="mpre">tests</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ (</span><a name="loc_174_32_174_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_32_174_33&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_174_35_174_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_35_174_39&#39;)"><span class="hl_vardecl"><span class="mpre">test</span></span></a><span class="mpre">) -&gt; do
    </span><a name="loc_175_5_175_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_5_175_9&#39;)"><span class="hl_vardecl"><span class="mpre">optY</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_174_35_174_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_35_174_39&#39;)"><span class="hl_varref"><span class="mpre">test</span></span></a><span class="mpre">
    case </span><a href="#loc_175_5_175_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_5_175_9&#39;)"><span class="hl_varref"><span class="mpre">optY</span></span></a><span class="mpre"> of 
      </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">  -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="#loc_174_32_174_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_32_174_33&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
  case </span><a href="Data.Maybe.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_115_1_115_10&#39;)"><span class="hl_varref"><span class="mpre">catMaybes</span></span></a><span class="mpre"> </span><a href="#loc_174_3_174_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_3_174_12&#39;)"><span class="hl_varref"><span class="mpre">optPoints</span></span></a><span class="mpre"> of
    []     -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
    </span><a name="loc_181_5_181_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_5_181_11&#39;)"><span class="hl_vardecl"><span class="mpre">points</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="#loc_173_20_173_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_20_173_24&#39;)"><span class="hl_varref"><span class="mpre">info</span></span></a><span class="mpre">, </span><a href="#loc_181_5_181_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_5_181_11&#39;)"><span class="hl_varref"><span class="mpre">points</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_186_1_186_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_5&#39;)"><span class="mpre">time</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
</span><a name="loc_186_1_186_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_5&#39;)"><span class="hl_fundecl"><span class="mpre">time</span></span></a><span class="mpre"> </span><a name="loc_186_6_186_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_6_186_12&#39;)"><span class="hl_vardecl"><span class="mpre">action</span></span></a><span class="mpre"> = do
    </span><a name="loc_187_5_187_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_10&#39;)"><span class="hl_vardecl"><span class="mpre">start</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">getCPUTime</span></span><span class="mpre">
    </span><a href="#loc_186_6_186_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_6_186_12&#39;)"><span class="hl_varref"><span class="mpre">action</span></span></a><span class="mpre">
    </span><a name="loc_189_5_189_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_5_189_8&#39;)"><span class="hl_vardecl"><span class="mpre">end</span></span></a><span class="mpre">   &lt;- </span><span class="hl_varref"><span class="mpre">getCPUTime</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_189_5_189_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_5_189_8&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_187_5_187_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_5_187_10&#39;)"><span class="hl_varref"><span class="mpre">start</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">10</span></span><span class="hl_infix"><span class="mpre">^</span></span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_196_1_196_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_5&#39;)"><span class="mpre">test</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Throughput.Utils.html#loc_6_6_6_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.Utils.html#loc_6_6_6_12&#39;)"><span class="hl_tyconref"><span class="mpre">Endian</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">) 
     -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Throughput.Utils.html#loc_6_6_6_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.Utils.html#loc_6_6_6_12&#39;)"><span class="hl_tyconref"><span class="mpre">Endian</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)
</span><a name="loc_196_1_196_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_5&#39;)"><span class="hl_fundecl"><span class="mpre">test</span></span></a><span class="mpre"> (</span><a name="loc_196_7_196_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_7_196_20&#39;)"><span class="hl_vardecl"><span class="mpre">serializeName</span></span></a><span class="mpre">, _, </span><a name="loc_196_25_196_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_25_196_34&#39;)"><span class="hl_vardecl"><span class="mpre">serialize</span></span></a><span class="mpre">) </span><a name="loc_196_36_196_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_36_196_44&#39;)"><span class="hl_vardecl"><span class="mpre">wordSize</span></span></a><span class="mpre"> </span><a name="loc_196_45_196_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_45_196_54&#39;)"><span class="hl_vardecl"><span class="mpre">chunkSize</span></span></a><span class="mpre"> </span><a name="loc_196_55_196_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_55_196_58&#39;)"><span class="hl_vardecl"><span class="mpre">end</span></span></a><span class="mpre"> </span><a name="loc_196_59_196_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_59_196_61&#39;)"><span class="hl_vardecl"><span class="mpre">mb</span></span></a><span class="mpre"> = do
    let </span><a href="#loc_198_9_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_14&#39;)"><span class="mpre">bytes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
        </span><a name="loc_198_9_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_14&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre"> = </span><a href="#loc_196_59_196_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_59_196_61&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">^</span></span><span class="hl_num"><span class="mpre">20</span></span><span class="mpre">
        </span><a name="loc_199_9_199_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_9_199_19&#39;)"><span class="hl_vardecl"><span class="mpre">iterations</span></span></a><span class="mpre"> = </span><a href="#loc_198_9_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_9_198_14&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><a href="#loc_196_36_196_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_36_196_44&#39;)"><span class="hl_varref"><span class="mpre">wordSize</span></span></a><span class="mpre">
    case </span><a href="#loc_196_25_196_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_25_196_34&#39;)"><span class="hl_varref"><span class="mpre">serialize</span></span></a><span class="mpre"> </span><a href="#loc_196_36_196_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_36_196_44&#39;)"><span class="hl_varref"><span class="mpre">wordSize</span></span></a><span class="mpre"> </span><a href="#loc_196_45_196_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_45_196_54&#39;)"><span class="hl_varref"><span class="mpre">chunkSize</span></span></a><span class="mpre"> </span><a href="#loc_196_55_196_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_55_196_58&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre"> </span><a href="#loc_199_9_199_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_9_199_19&#39;)"><span class="hl_varref"><span class="mpre">iterations</span></span></a><span class="mpre"> of
      </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_202_12_202_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_12_202_14&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> -&gt; do
        _ &lt;- </span><span class="hl_varref"><span class="mpre">printf</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;%17s: %dMB of Word%-2d in chunks of %2d (%6s endian):&quot;</span></span><span class="mpre">
            </span><a href="#loc_196_7_196_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_7_196_20&#39;)"><span class="hl_varref"><span class="mpre">serializeName</span></span></a><span class="mpre"> (</span><a href="#loc_196_59_196_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_59_196_61&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) (</span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_196_36_196_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_36_196_44&#39;)"><span class="hl_varref"><span class="mpre">wordSize</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) (</span><a href="#loc_196_45_196_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_45_196_54&#39;)"><span class="hl_varref"><span class="mpre">chunkSize</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_196_55_196_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_55_196_58&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre">)

        </span><a name="loc_206_9_206_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_19&#39;)"><span class="hl_vardecl"><span class="mpre">putSeconds</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_186_1_186_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_5&#39;)"><span class="hl_varref"><span class="mpre">time</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_480_1_480_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_480_1_480_9&#39;)"><span class="hl_varref"><span class="mpre">evaluate</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_202_12_202_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_12_202_14&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
        </span><span class="hl_comment"><span class="mpre">-- getSeconds &lt;- time $ evaluate sum</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--    print (L.length bs, sum)</span></span><span class="mpre">
        let </span><a name="loc_209_13_209_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_13_209_26&#39;)"><span class="hl_vardecl"><span class="mpre">putThroughput</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_196_59_196_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_59_196_61&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><a href="#loc_206_9_206_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_19&#39;)"><span class="hl_varref"><span class="mpre">putSeconds</span></span></a><span class="mpre">
            </span><span class="hl_comment"><span class="mpre">-- getThroughput = fromIntegral mb / getSeconds</span></span><span class="mpre">

        _ &lt;- </span><span class="hl_varref"><span class="mpre">printf</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;%6.1f MB/s write\n&quot;</span></span><span class="mpre">
               </span><a href="#loc_209_13_209_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_13_209_26&#39;)"><span class="hl_varref"><span class="mpre">putThroughput</span></span></a><span class="mpre">
               </span><span class="hl_comment"><span class="mpre">-- getThroughput</span></span><span class="mpre">
               </span><span class="hl_comment"><span class="mpre">-- (getThroughput/putThroughput)</span></span><span class="mpre">
     
        </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">hFlush</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_209_13_209_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_13_209_26&#39;)"><span class="hl_varref"><span class="mpre">putThroughput</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_224_1_224_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_15&#39;)"><span class="mpre">compareResults</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Throughput.Utils.html#loc_6_6_6_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.Utils.html#loc_6_6_6_12&#39;)"><span class="hl_tyconref"><span class="mpre">Endian</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">) 
     -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Throughput.Utils.html#loc_6_6_6_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.Utils.html#loc_6_6_6_12&#39;)"><span class="hl_tyconref"><span class="mpre">Endian</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_224_1_224_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_15&#39;)"><span class="hl_fundecl"><span class="mpre">compareResults</span></span></a><span class="mpre"> (</span><a name="loc_224_17_224_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_17_224_30&#39;)"><span class="hl_vardecl"><span class="mpre">serializeName</span></span></a><span class="mpre">, _, </span><a name="loc_224_35_224_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_35_224_44&#39;)"><span class="hl_vardecl"><span class="mpre">serialize</span></span></a><span class="mpre">) </span><a name="loc_224_46_224_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_46_224_54&#39;)"><span class="hl_vardecl"><span class="mpre">wordSize</span></span></a><span class="mpre"> </span><a name="loc_224_55_224_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_55_224_64&#39;)"><span class="hl_vardecl"><span class="mpre">chunkSize</span></span></a><span class="mpre"> </span><a name="loc_224_65_224_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_65_224_68&#39;)"><span class="hl_vardecl"><span class="mpre">end</span></span></a><span class="mpre"> </span><a name="loc_224_69_224_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_69_224_72&#39;)"><span class="hl_vardecl"><span class="mpre">mb0</span></span></a><span class="mpre"> = do
    let </span><a href="#loc_226_9_226_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_9_226_11&#39;)"><span class="mpre">mb</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
        </span><a name="loc_226_9_226_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_9_226_11&#39;)"><span class="hl_vardecl"><span class="mpre">mb</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (</span><a href="#loc_224_69_224_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_69_224_72&#39;)"><span class="hl_varref"><span class="mpre">mb0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre">)
        </span><a href="#loc_228_9_228_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_9_228_14&#39;)"><span class="mpre">bytes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
        </span><a name="loc_228_9_228_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_9_228_14&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre"> = </span><a href="#loc_226_9_226_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_9_226_11&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">^</span></span><span class="hl_num"><span class="mpre">20</span></span><span class="mpre">
        </span><a name="loc_229_9_229_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_9_229_19&#39;)"><span class="hl_vardecl"><span class="mpre">iterations</span></span></a><span class="mpre"> = </span><a href="#loc_228_9_228_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_9_228_14&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><a href="#loc_224_46_224_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_46_224_54&#39;)"><span class="hl_varref"><span class="mpre">wordSize</span></span></a><span class="mpre">
        </span><a name="loc_230_9_230_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_9_230_12&#39;)"><span class="hl_vardecl"><span class="mpre">bs0</span></span></a><span class="mpre"> = </span><a href="Throughput.BinaryBuilder.html#loc_11_1_11_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Throughput.BinaryBuilder.html#loc_11_1_11_10&#39;)"><span class="hl_varref"><span class="mpre">BinaryBuilder.serialize</span></span></a><span class="mpre"> </span><a href="#loc_224_46_224_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_46_224_54&#39;)"><span class="hl_varref"><span class="mpre">wordSize</span></span></a><span class="mpre"> </span><a href="#loc_224_55_224_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_55_224_64&#39;)"><span class="hl_varref"><span class="mpre">chunkSize</span></span></a><span class="mpre"> </span><a href="#loc_224_65_224_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_65_224_68&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre"> </span><a href="#loc_229_9_229_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_9_229_19&#39;)"><span class="hl_varref"><span class="mpre">iterations</span></span></a><span class="mpre">
    case </span><a href="#loc_224_35_224_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_35_224_44&#39;)"><span class="hl_varref"><span class="mpre">serialize</span></span></a><span class="mpre"> </span><a href="#loc_224_46_224_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_46_224_54&#39;)"><span class="hl_varref"><span class="mpre">wordSize</span></span></a><span class="mpre"> </span><a href="#loc_224_55_224_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_55_224_64&#39;)"><span class="hl_varref"><span class="mpre">chunkSize</span></span></a><span class="mpre"> </span><a href="#loc_224_65_224_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_65_224_68&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre"> </span><a href="#loc_229_9_229_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_9_229_19&#39;)"><span class="hl_varref"><span class="mpre">iterations</span></span></a><span class="mpre"> of
      </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_233_12_233_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_12_233_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs1</span></span></a><span class="mpre"> -&gt; do
        _ &lt;- </span><span class="hl_varref"><span class="mpre">printf</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;%17s: %dMB of Word%-2d in chunks of %2d (%6s endian):&quot;</span></span><span class="mpre">
          </span><a href="#loc_224_17_224_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_17_224_30&#39;)"><span class="hl_varref"><span class="mpre">serializeName</span></span></a><span class="mpre"> (</span><a href="#loc_226_9_226_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_9_226_11&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) (</span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_224_46_224_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_46_224_54&#39;)"><span class="hl_varref"><span class="mpre">wordSize</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) (</span><a href="#loc_224_55_224_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_55_224_64&#39;)"><span class="hl_varref"><span class="mpre">chunkSize</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_224_65_224_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_65_224_68&#39;)"><span class="hl_varref"><span class="mpre">end</span></span></a><span class="mpre">)
        if (</span><a href="#loc_230_9_230_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_9_230_12&#39;)"><span class="hl_varref"><span class="mpre">bs0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_233_12_233_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_12_233_15&#39;)"><span class="hl_varref"><span class="mpre">bs1</span></span></a><span class="mpre">) 
          then </span><a href="System.IO.html#loc_267_1_267_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_267_1_267_9&#39;)"><span class="hl_varref"><span class="mpre">putStrLn</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; Ok&quot;</span></span><span class="mpre">
          else </span><a href="System.IO.html#loc_267_1_267_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_267_1_267_9&#39;)"><span class="hl_varref"><span class="mpre">putStrLn</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; Failed&quot;</span></span><span class="mpre">
        </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">hFlush</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre">
      
</span></div></body></html>