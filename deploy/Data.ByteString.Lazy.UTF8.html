<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, BangPatterns #-}
#if __GLASGOW_HASKELL__ &gt;= 701
{-# LANGUAGE Trustworthy #-}
#endif
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Data.ByteString.Lazy.UTF8</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) Iavor S. Diatchki 2009</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD3-style (see LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  emertens@galois.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   This module provides fast, validated encoding and decoding functions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   between &#39;ByteString&#39;s and &#39;String&#39;s. It does not exactly match the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   output of the Codec.Binary.UTF8.String output for invalid encodings</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   as the number of replacement characters is sometimes longer.</span></span><span class="mpre">
module Data.ByteString.Lazy.UTF8
  ( B.ByteString
  , decode
  , replacement_char
  , uncons
  , splitAt
  , take
  , drop
  , span
  , break
  , fromString
  , toString
  , foldl
  , foldr
  , length
  , lines
  , lines&#39;
  ) where

import Data.Bits
import Data.Word
import Data.Int
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/utf8-string-0.3.8/Data/ByteString/Lazy/UTF8.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 18, srcSpanEndLine = 41, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as B
import Prelude hiding (take,drop,splitAt,span,break,foldr,foldl,length,</span><a href="Data.List.html#loc_1044_1_1044_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1044_1_1044_6&#39;)"><span class="mpre">lines</span></a><span class="mpre">)

import Codec.Binary.UTF8.String(</span><a href="Codec.Binary.UTF8.String.html#loc_72_1_72_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Binary.UTF8.String.html#loc_72_1_72_7&#39;)"><span class="mpre">encode</span></a><span class="mpre">)
import Codec.Binary.UTF8.Generic (</span><a href="Codec.Binary.UTF8.Generic.html#loc_51_3_51_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Binary.UTF8.Generic.html#loc_51_3_51_10&#39;)"><span class="mpre">buncons</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Converts a Haskell string into a UTF8 encoded bytestring.</span></span><span class="mpre">
</span><a href="#loc_49_1_49_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_11&#39;)"><span class="mpre">fromString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_49_1_49_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_11&#39;)"><span class="hl_fundecl"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><a name="loc_49_12_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_12_49_14&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> (</span><a href="Codec.Binary.UTF8.String.html#loc_72_1_72_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Binary.UTF8.String.html#loc_72_1_72_7&#39;)"><span class="hl_varref"><span class="mpre">encode</span></span></a><span class="mpre"> </span><a href="#loc_49_12_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_12_49_14&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Convert a UTF8 encoded bytestring into a Haskell string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Invalid characters are replaced with &#39;\xFFFD&#39;.</span></span><span class="mpre">
</span><a href="#loc_54_1_54_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_9&#39;)"><span class="mpre">toString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_54_1_54_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_9&#39;)"><span class="hl_fundecl"><span class="mpre">toString</span></span></a><span class="mpre"> </span><a name="loc_54_10_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_10_54_12&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_181_1_181_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_1_181_6&#39;)"><span class="hl_varref"><span class="mpre">foldr</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> [] </span><a href="#loc_54_10_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_10_54_12&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This character is used to mark errors in a UTF8 encoded string.</span></span><span class="mpre">
</span><a href="#loc_58_1_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_17&#39;)"><span class="mpre">replacement_char</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_58_1_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_17&#39;)"><span class="hl_vardecl"><span class="mpre">replacement_char</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;\xfffd&#39;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Try to extract a character from a byte string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Returns &#39;Nothing&#39; if there are no more bytes in the byte string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Otherwise, it returns a decoded character and the number of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- bytes used in its representation.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Errors are replaced by character &#39;\0xFFFD&#39;.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- XXX: Should we combine sequences of errors into a single replacement</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- character?</span></span><span class="mpre">
</span><a href="#loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="mpre">decode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">,</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">)
</span><a name="loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="hl_fundecl"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a name="loc_69_8_69_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_8_69_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = do (</span><a name="loc_69_17_69_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_17_69_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_69_19_69_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_21&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) &lt;- </span><a href="Codec.Binary.UTF8.Generic.html#loc_51_3_51_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Binary.UTF8.Generic.html#loc_51_3_51_10&#39;)"><span class="hl_varref"><span class="mpre">buncons</span></span></a><span class="mpre"> </span><a href="#loc_69_8_69_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_8_69_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
               </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_73_3_73_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_3_73_9&#39;)"><span class="hl_varref"><span class="mpre">choose</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_69_17_69_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_17_69_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_69_19_69_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_21&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
  where
  </span><a href="#loc_73_3_73_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_3_73_9&#39;)"><span class="mpre">choose</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">, </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">)
  </span><a name="loc_73_3_73_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_3_73_9&#39;)"><span class="hl_fundecl"><span class="mpre">choose</span></span></a><span class="mpre"> </span><a name="loc_73_10_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_73_12_73_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_12_73_14&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">
    | </span><a href="#loc_73_10_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">  = (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_73_10_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
    | </span><a href="#loc_73_10_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre">  = (</span><a href="#loc_58_1_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
    | </span><a href="#loc_73_10_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xe0</span></span><span class="mpre">  = </span><a href="#loc_98_3_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_3_98_9&#39;)"><span class="hl_varref"><span class="mpre">bytes2</span></span></a><span class="mpre"> (</span><a href="#loc_82_3_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_3_82_7&#39;)"><span class="hl_varref"><span class="mpre">mask</span></span></a><span class="mpre"> </span><a href="#loc_73_10_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x1f</span></span><span class="mpre">) </span><a href="#loc_73_12_73_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_12_73_14&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
    | </span><a href="#loc_73_10_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf0</span></span><span class="mpre">  = </span><a href="#loc_104_3_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_9&#39;)"><span class="hl_varref"><span class="mpre">bytes3</span></span></a><span class="mpre"> (</span><a href="#loc_82_3_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_3_82_7&#39;)"><span class="hl_varref"><span class="mpre">mask</span></span></a><span class="mpre"> </span><a href="#loc_73_10_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x0f</span></span><span class="mpre">) </span><a href="#loc_73_12_73_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_12_73_14&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
    | </span><a href="#loc_73_10_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xf8</span></span><span class="mpre">  = </span><a href="#loc_115_3_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_3_115_9&#39;)"><span class="hl_varref"><span class="mpre">bytes4</span></span></a><span class="mpre"> (</span><a href="#loc_82_3_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_3_82_7&#39;)"><span class="hl_varref"><span class="mpre">mask</span></span></a><span class="mpre"> </span><a href="#loc_73_10_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_10_73_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x07</span></span><span class="mpre">) </span><a href="#loc_73_12_73_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_12_73_14&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = (</span><a href="#loc_58_1_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

  </span><a href="#loc_82_3_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_3_82_7&#39;)"><span class="mpre">mask</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
  </span><a name="loc_82_3_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_3_82_7&#39;)"><span class="hl_fundecl"><span class="mpre">mask</span></span></a><span class="mpre"> </span><a name="loc_82_8_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_8_82_9&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_82_10_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_10_82_11&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> (</span><a href="#loc_82_8_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_8_82_9&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><a href="#loc_82_10_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_10_82_11&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)

  </span><a href="#loc_85_3_85_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_3_85_10&#39;)"><span class="mpre">combine</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
  </span><a name="loc_85_3_85_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_3_85_10&#39;)"><span class="hl_fundecl"><span class="mpre">combine</span></span></a><span class="mpre"> </span><a name="loc_85_11_85_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_11_85_14&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_85_15_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_15_85_16&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_varref"><span class="mpre">shiftL</span></span></a><span class="mpre"> </span><a href="#loc_85_11_85_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_11_85_14&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> (</span><a href="#loc_85_15_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_15_85_16&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3f</span></span><span class="mpre">)

  </span><a href="#loc_88_3_88_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_3_88_11&#39;)"><span class="mpre">follower</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
  </span><a name="loc_88_3_88_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_3_88_11&#39;)"><span class="hl_fundecl"><span class="mpre">follower</span></span></a><span class="mpre"> </span><a name="loc_88_12_88_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_12_88_15&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_88_16_88_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_16_88_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> | </span><a href="#loc_88_16_88_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_16_88_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xc0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="#loc_85_3_85_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_3_85_10&#39;)"><span class="hl_varref"><span class="mpre">combine</span></span></a><span class="mpre"> </span><a href="#loc_88_12_88_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_12_88_15&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="#loc_88_16_88_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_16_88_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
  </span><a href="#loc_88_3_88_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_3_88_11&#39;)"><span class="hl_fundecl"><span class="mpre">follower</span></span></a><span class="mpre"> _ _                        = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_93_3_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_3_93_15&#39;)"><span class="mpre">get_follower</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a href="#loc_93_3_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_3_93_15&#39;)"><span class="mpre">get_follower</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
  </span><a name="loc_93_3_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_3_93_15&#39;)"><span class="hl_fundecl"><span class="mpre">get_follower</span></span></a><span class="mpre"> </span><a name="loc_93_16_93_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_16_93_19&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_93_20_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_20_93_22&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = do (</span><a name="loc_93_29_93_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_29_93_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_93_31_93_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_31_93_33&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) &lt;- </span><a href="Codec.Binary.UTF8.Generic.html#loc_51_3_51_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Binary.UTF8.Generic.html#loc_51_3_51_10&#39;)"><span class="hl_varref"><span class="mpre">buncons</span></span></a><span class="mpre"> </span><a href="#loc_93_20_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_20_93_22&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
                           </span><a name="loc_94_28_94_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_28_94_32&#39;)"><span class="hl_vardecl"><span class="mpre">acc1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_88_3_88_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_3_88_11&#39;)"><span class="hl_varref"><span class="mpre">follower</span></span></a><span class="mpre"> </span><a href="#loc_93_16_93_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_16_93_19&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="#loc_93_29_93_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_29_93_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                           </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_94_28_94_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_28_94_32&#39;)"><span class="hl_varref"><span class="mpre">acc1</span></span></a><span class="mpre">,</span><a href="#loc_93_31_93_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_31_93_33&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)

  </span><a href="#loc_98_3_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_3_98_9&#39;)"><span class="mpre">bytes2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">, </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">)
  </span><a name="loc_98_3_98_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_3_98_9&#39;)"><span class="hl_fundecl"><span class="mpre">bytes2</span></span></a><span class="mpre"> </span><a name="loc_98_10_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_10_98_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_98_12_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_14&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = case </span><a href="#loc_93_3_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_3_93_15&#39;)"><span class="hl_varref"><span class="mpre">get_follower</span></span></a><span class="mpre"> </span><a href="#loc_98_10_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_10_98_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_98_12_98_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_14&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
                  </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_99_25_99_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_25_99_26&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">, _) | </span><a href="#loc_99_25_99_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_25_99_26&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">  -&gt; (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_99_25_99_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_25_99_26&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
                              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  -&gt; (</span><a href="#loc_58_1_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                  _ -&gt; (</span><a href="#loc_58_1_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

  </span><a href="#loc_104_3_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_9&#39;)"><span class="mpre">bytes3</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">, </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">)
  </span><a name="loc_104_3_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_9&#39;)"><span class="hl_fundecl"><span class="mpre">bytes3</span></span></a><span class="mpre"> </span><a name="loc_104_10_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_10_104_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_104_12_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_12_104_14&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> =
    case </span><a href="#loc_93_3_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_3_93_15&#39;)"><span class="hl_varref"><span class="mpre">get_follower</span></span></a><span class="mpre"> </span><a href="#loc_104_10_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_10_104_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_104_12_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_12_104_14&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_106_13_106_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_13_106_15&#39;)"><span class="hl_vardecl"><span class="mpre">d1</span></span></a><span class="mpre">, </span><a name="loc_106_17_106_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_17_106_20&#39;)"><span class="hl_vardecl"><span class="mpre">cs1</span></span></a><span class="mpre">) -&gt;
        case </span><a href="#loc_93_3_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_3_93_15&#39;)"><span class="hl_varref"><span class="mpre">get_follower</span></span></a><span class="mpre"> </span><a href="#loc_106_13_106_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_13_106_15&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre"> </span><a href="#loc_106_17_106_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_17_106_20&#39;)"><span class="hl_varref"><span class="mpre">cs1</span></span></a><span class="mpre"> of
          </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_108_17_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_18&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">, _) | (</span><a href="#loc_108_17_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x800</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_108_17_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xd800</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre">
                        (</span><a href="#loc_108_17_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xdfff</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_108_17_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xfffe</span></span><span class="mpre">) -&gt; (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_108_17_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_17_108_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)
                      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; (</span><a href="#loc_58_1_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)
          _ -&gt; (</span><a href="#loc_58_1_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
      _ -&gt; (</span><a href="#loc_58_1_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

  </span><a href="#loc_115_3_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_3_115_9&#39;)"><span class="mpre">bytes4</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">, </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">)
  </span><a name="loc_115_3_115_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_3_115_9&#39;)"><span class="hl_fundecl"><span class="mpre">bytes4</span></span></a><span class="mpre"> </span><a name="loc_115_10_115_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_10_115_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_115_12_115_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_12_115_14&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> =
    case </span><a href="#loc_93_3_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_3_93_15&#39;)"><span class="hl_varref"><span class="mpre">get_follower</span></span></a><span class="mpre"> </span><a href="#loc_115_10_115_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_10_115_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_115_12_115_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_12_115_14&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_117_13_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_13_117_15&#39;)"><span class="hl_vardecl"><span class="mpre">d1</span></span></a><span class="mpre">, </span><a name="loc_117_17_117_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_17_117_20&#39;)"><span class="hl_vardecl"><span class="mpre">cs1</span></span></a><span class="mpre">) -&gt;
        case </span><a href="#loc_93_3_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_3_93_15&#39;)"><span class="hl_varref"><span class="mpre">get_follower</span></span></a><span class="mpre"> </span><a href="#loc_117_13_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_13_117_15&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre"> </span><a href="#loc_117_17_117_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_17_117_20&#39;)"><span class="hl_varref"><span class="mpre">cs1</span></span></a><span class="mpre"> of
          </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_119_17_119_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_17_119_19&#39;)"><span class="hl_vardecl"><span class="mpre">d2</span></span></a><span class="mpre">, </span><a name="loc_119_21_119_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_21_119_24&#39;)"><span class="hl_vardecl"><span class="mpre">cs2</span></span></a><span class="mpre">) -&gt;
            case </span><a href="#loc_93_3_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_3_93_15&#39;)"><span class="hl_varref"><span class="mpre">get_follower</span></span></a><span class="mpre"> </span><a href="#loc_119_17_119_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_17_119_19&#39;)"><span class="hl_varref"><span class="mpre">d2</span></span></a><span class="mpre"> </span><a href="#loc_119_21_119_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_21_119_24&#39;)"><span class="hl_varref"><span class="mpre">cs2</span></span></a><span class="mpre"> of
              </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_121_21_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_21_121_22&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">,_) | </span><a href="#loc_121_21_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_21_121_22&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_121_21_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_21_121_22&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x110000</span></span><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_121_21_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_21_121_22&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
                         | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                    -&gt; (</span><a href="#loc_58_1_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
              _ -&gt; (</span><a href="#loc_58_1_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)
          _ -&gt; (</span><a href="#loc_58_1_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
      _ -&gt; (</span><a href="#loc_58_1_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_17&#39;)"><span class="hl_varref"><span class="mpre">replacement_char</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="mpre">decode</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Split after a given number of characters.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Negative values are treated as if they are 0.</span></span><span class="mpre">
</span><a href="#loc_132_1_132_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_8&#39;)"><span class="mpre">splitAt</span></a><span class="mpre"> :: </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
</span><a name="loc_132_1_132_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_8&#39;)"><span class="hl_fundecl"><span class="mpre">splitAt</span></span></a><span class="mpre"> </span><a name="loc_132_9_132_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_9_132_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_132_11_132_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_11_132_13&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_133_9_133_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_9_133_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_132_9_132_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_9_132_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_132_11_132_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_11_132_13&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
  where </span><a name="loc_133_9_133_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_9_133_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_133_15_133_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_15_133_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_133_17_133_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_17_133_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ | </span><a href="#loc_133_17_133_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_17_133_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_133_15_133_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_15_133_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_132_11_132_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_11_132_13&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        </span><a href="#loc_133_9_133_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_9_133_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_134_15_134_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_15_134_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_134_17_134_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_17_134_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_134_19_134_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_19_134_22&#39;)"><span class="hl_vardecl"><span class="mpre">bs1</span></span></a><span class="mpre"> = case </span><a href="#loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_134_19_134_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_19_134_22&#39;)"><span class="hl_varref"><span class="mpre">bs1</span></span></a><span class="mpre"> of
                         </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (_,</span><a name="loc_135_34_135_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_34_135_35&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_133_9_133_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_9_133_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_134_15_134_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_15_134_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_135_34_135_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_34_135_35&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) (</span><a href="#loc_134_17_134_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_17_134_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><a href="#loc_135_34_135_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_34_135_35&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_134_19_134_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_19_134_22&#39;)"><span class="hl_varref"><span class="mpre">bs1</span></span></a><span class="mpre">)
                         </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">    -&gt; (</span><a href="#loc_132_11_132_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_11_132_13&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @take n s@ returns the first @n@ characters of @s@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If @s@ has less than @n@ characters, then we return the whole of @s@.</span></span><span class="mpre">
</span><a href="#loc_141_1_141_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_5&#39;)"><span class="mpre">take</span></a><span class="mpre"> :: </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_141_1_141_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_5&#39;)"><span class="hl_fundecl"><span class="mpre">take</span></span></a><span class="mpre"> </span><a name="loc_141_6_141_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_6_141_7&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_141_8_141_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_8_141_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_142_9_142_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_141_6_141_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_6_141_7&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_141_8_141_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_8_141_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
  where </span><a name="loc_142_9_142_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_142_15_142_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_15_142_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_142_17_142_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_17_142_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ | </span><a href="#loc_142_17_142_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_17_142_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.take</span></span><span class="mpre"> </span><a href="#loc_142_15_142_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_15_142_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_141_8_141_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_8_141_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        </span><a href="#loc_142_9_142_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_143_15_143_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_15_143_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_143_17_143_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_17_143_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_143_19_143_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_19_143_22&#39;)"><span class="hl_vardecl"><span class="mpre">bs1</span></span></a><span class="mpre"> = case </span><a href="#loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_143_19_143_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_19_143_22&#39;)"><span class="hl_varref"><span class="mpre">bs1</span></span></a><span class="mpre"> of
                         </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (_,</span><a name="loc_144_34_144_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_34_144_35&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_142_9_142_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_143_15_143_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_15_143_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_144_34_144_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_34_144_35&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) (</span><a href="#loc_143_17_143_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_17_143_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><a href="#loc_144_34_144_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_34_144_35&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_143_19_143_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_19_143_22&#39;)"><span class="hl_varref"><span class="mpre">bs1</span></span></a><span class="mpre">)
                         </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">    -&gt; </span><a href="#loc_141_8_141_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_8_141_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @drop n s@ returns the @s@ without its first @n@ characters.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If @s@ has less than @n@ characters, then we return an empty string.</span></span><span class="mpre">
</span><a href="#loc_150_1_150_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_5&#39;)"><span class="mpre">drop</span></a><span class="mpre"> :: </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_150_1_150_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_5&#39;)"><span class="hl_fundecl"><span class="mpre">drop</span></span></a><span class="mpre"> </span><a name="loc_150_6_150_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_6_150_7&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_150_8_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_8_150_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_151_9_151_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_9_151_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_150_6_150_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_6_150_7&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_150_8_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_8_150_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
  where </span><a name="loc_151_9_151_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_9_151_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_151_15_151_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_15_151_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_151_17_151_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_17_151_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> _ | </span><a href="#loc_151_17_151_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_17_151_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><a href="#loc_151_15_151_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_15_151_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_150_8_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_8_150_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        </span><a href="#loc_151_9_151_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_9_151_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_152_15_152_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_15_152_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_152_17_152_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_17_152_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_152_19_152_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_19_152_22&#39;)"><span class="hl_vardecl"><span class="mpre">bs1</span></span></a><span class="mpre"> = case </span><a href="#loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_152_19_152_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_19_152_22&#39;)"><span class="hl_varref"><span class="mpre">bs1</span></span></a><span class="mpre"> of
                         </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (_,</span><a name="loc_153_34_153_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_34_153_35&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_151_9_151_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_9_151_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_152_15_152_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_15_152_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_153_34_153_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_34_153_35&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) (</span><a href="#loc_152_17_152_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_17_152_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><a href="#loc_153_34_153_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_34_153_35&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_152_19_152_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_19_152_22&#39;)"><span class="hl_varref"><span class="mpre">bs1</span></span></a><span class="mpre">)
                         </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">    -&gt; </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Split a string into two parts:  the first is the longest prefix</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that contains only characters that satisfy the predicate; the second</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- part is the rest of the string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Invalid characters are passed as &#39;\0xFFFD&#39; to the predicate.</span></span><span class="mpre">
</span><a href="#loc_161_1_161_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_5&#39;)"><span class="mpre">span</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
</span><a name="loc_161_1_161_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_5&#39;)"><span class="hl_fundecl"><span class="mpre">span</span></span></a><span class="mpre"> </span><a name="loc_161_6_161_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_6_161_7&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_161_8_161_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_8_161_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_162_9_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_9_162_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_161_8_161_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_8_161_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
  where </span><a name="loc_162_9_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_9_162_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_162_14_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_14_162_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_162_16_162_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_16_162_18&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = case </span><a href="#loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_162_16_162_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_16_162_18&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
                      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_163_29_163_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_29_163_30&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_163_31_163_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_31_163_32&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) | </span><a href="#loc_161_6_161_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_6_161_7&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_163_29_163_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_29_163_30&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_162_9_162_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_9_162_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_162_14_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_14_162_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_163_31_163_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_31_163_32&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><a href="#loc_163_31_163_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_31_163_32&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_162_16_162_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_16_162_18&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
                      _ -&gt; </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_162_14_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_14_162_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_161_8_161_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_8_161_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Split a string into two parts:  the first is the longest prefix</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that contains only characters that do not satisfy the predicate; the second</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- part is the rest of the string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Invalid characters are passed as &#39;\0xFFFD&#39; to the predicate.</span></span><span class="mpre">
</span><a href="#loc_171_1_171_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_6&#39;)"><span class="mpre">break</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
</span><a name="loc_171_1_171_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_6&#39;)"><span class="hl_fundecl"><span class="mpre">break</span></span></a><span class="mpre"> </span><a name="loc_171_7_171_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_7_171_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_171_9_171_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_9_171_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_161_1_161_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_5&#39;)"><span class="hl_varref"><span class="mpre">span</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_171_7_171_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_7_171_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><a href="#loc_171_9_171_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_9_171_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get the first character of a byte string, if any.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Malformed characters are replaced by &#39;\0xFFFD&#39;.</span></span><span class="mpre">
</span><a href="#loc_176_1_176_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_7&#39;)"><span class="mpre">uncons</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
</span><a name="loc_176_1_176_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_7&#39;)"><span class="hl_fundecl"><span class="mpre">uncons</span></span></a><span class="mpre"> </span><a name="loc_176_8_176_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_8_176_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = do (</span><a name="loc_176_17_176_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_17_176_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_176_19_176_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_19_176_20&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_176_8_176_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_8_176_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
               </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_176_17_176_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_17_176_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><a href="#loc_176_19_176_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_19_176_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_176_8_176_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_8_176_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Traverse a bytestring (right biased).</span></span><span class="mpre">
</span><a href="#loc_181_1_181_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_1_181_6&#39;)"><span class="mpre">foldr</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_181_1_181_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_1_181_6&#39;)"><span class="hl_fundecl"><span class="mpre">foldr</span></span></a><span class="mpre"> </span><a name="loc_181_7_181_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_7_181_11&#39;)"><span class="hl_vardecl"><span class="mpre">cons</span></span></a><span class="mpre"> </span><a name="loc_181_12_181_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_12_181_15&#39;)"><span class="hl_vardecl"><span class="mpre">nil</span></span></a><span class="mpre"> </span><a name="loc_181_16_181_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_16_181_18&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = case </span><a href="#loc_176_1_176_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_7&#39;)"><span class="hl_varref"><span class="mpre">uncons</span></span></a><span class="mpre"> </span><a href="#loc_181_16_181_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_16_181_18&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
                      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_182_29_182_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_29_182_30&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_182_31_182_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_31_182_33&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_181_7_181_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_7_181_11&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre"> </span><a href="#loc_182_29_182_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_29_182_30&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_181_1_181_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_1_181_6&#39;)"><span class="hl_varref"><span class="mpre">foldr</span></span></a><span class="mpre"> </span><a href="#loc_181_7_181_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_7_181_11&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre"> </span><a href="#loc_181_12_181_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_12_181_15&#39;)"><span class="hl_varref"><span class="mpre">nil</span></span></a><span class="mpre"> </span><a href="#loc_182_31_182_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_31_182_33&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre">)
                      </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">     -&gt; </span><a href="#loc_181_12_181_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_12_181_15&#39;)"><span class="hl_varref"><span class="mpre">nil</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Traverse a bytestring (left biased).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function is strict in the accumulator.</span></span><span class="mpre">
</span><a href="#loc_188_1_188_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_6&#39;)"><span class="mpre">foldl</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_188_1_188_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_6&#39;)"><span class="hl_fundecl"><span class="mpre">foldl</span></span></a><span class="mpre"> </span><a name="loc_188_7_188_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_7_188_10&#39;)"><span class="hl_vardecl"><span class="mpre">add</span></span></a><span class="mpre"> </span><a name="loc_188_11_188_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_11_188_14&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_188_15_188_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_15_188_17&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">  = case </span><a href="#loc_176_1_176_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_7&#39;)"><span class="hl_varref"><span class="mpre">uncons</span></span></a><span class="mpre"> </span><a href="#loc_188_15_188_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_15_188_17&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
                      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_189_29_189_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_29_189_30&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_189_31_189_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_31_189_33&#39;)"><span class="hl_vardecl"><span class="mpre">as</span></span></a><span class="mpre">) -&gt; let </span><a name="loc_189_42_189_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_42_189_43&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_188_7_188_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_7_188_10&#39;)"><span class="hl_varref"><span class="mpre">add</span></span></a><span class="mpre"> </span><a href="#loc_188_11_188_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_11_188_14&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="#loc_189_29_189_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_29_189_30&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
                                     in </span><a href="Prelude.html#loc_167_1_167_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_167_1_167_4&#39;)"><span class="hl_varref"><span class="mpre">seq</span></span></a><span class="mpre"> </span><a href="#loc_189_42_189_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_42_189_43&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (</span><a href="#loc_188_1_188_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_6&#39;)"><span class="hl_varref"><span class="mpre">foldl</span></span></a><span class="mpre"> </span><a href="#loc_188_7_188_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_7_188_10&#39;)"><span class="hl_varref"><span class="mpre">add</span></span></a><span class="mpre"> </span><a href="#loc_189_42_189_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_42_189_43&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_189_31_189_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_31_189_33&#39;)"><span class="hl_varref"><span class="mpre">as</span></span></a><span class="mpre">)
                      </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">     -&gt; </span><a href="#loc_188_11_188_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_11_188_14&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Counts the number of characters encoded in the bytestring.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that this includes replacement characters.</span></span><span class="mpre">
</span><a href="#loc_196_1_196_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_7&#39;)"><span class="mpre">length</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_196_1_196_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_7&#39;)"><span class="hl_fundecl"><span class="mpre">length</span></span></a><span class="mpre"> </span><a name="loc_196_8_196_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_8_196_9&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_197_9_197_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_196_8_196_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_8_196_9&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
  where </span><a name="loc_197_9_197_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_197_14_197_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_14_197_15&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_197_16_197_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_16_197_18&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = case </span><a href="#loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_197_16_197_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_16_197_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (_,</span><a name="loc_198_31_198_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_31_198_32&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_197_9_197_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_197_14_197_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_14_197_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><a href="#loc_198_31_198_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_31_198_32&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_197_16_197_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_16_197_18&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
                      </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_197_14_197_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_14_197_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Split a string into a list of lines.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Lines are terminated by &#39;\n&#39; or the end of the string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Empty lines may not be terminated by the end of the string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- See also &#39;lines\&#39;&#39;.</span></span><span class="mpre">
</span><a href="#loc_206_1_206_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_6&#39;)"><span class="mpre">lines</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">]
</span><a name="loc_206_1_206_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_6&#39;)"><span class="hl_fundecl"><span class="mpre">lines</span></span></a><span class="mpre"> </span><a name="loc_206_7_206_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_7_206_9&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_206_7_206_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_7_206_9&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">  = []
</span><a href="#loc_206_1_206_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_6&#39;)"><span class="hl_fundecl"><span class="mpre">lines</span></span></a><span class="mpre"> </span><a name="loc_207_7_207_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_7_207_9&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">B.elemIndex</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><a href="#loc_207_7_207_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_7_207_9&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
             </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_208_19_208_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_19_208_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; let (</span><a name="loc_208_29_208_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_29_208_31&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a name="loc_208_32_208_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_32_208_34&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><a href="#loc_208_19_208_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_19_208_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_207_7_207_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_7_207_9&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                       in </span><a href="#loc_208_29_208_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_29_208_31&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_206_1_206_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_6&#39;)"><span class="hl_varref"><span class="mpre">lines</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.tail</span></span><span class="mpre"> </span><a href="#loc_208_32_208_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_32_208_34&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">)
             </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_207_7_207_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_7_207_9&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | Split a string into a list of lines.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Lines are terminated by &#39;\n&#39; or the end of the string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Empty lines may not be terminated by the end of the string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This function preserves the terminators.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- See also &#39;lines&#39;.</span></span><span class="mpre">
</span><a href="#loc_218_1_218_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_1_218_7&#39;)"><span class="mpre">lines&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">]
</span><a name="loc_218_1_218_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_1_218_7&#39;)"><span class="hl_fundecl"><span class="mpre">lines&#39;</span></span></a><span class="mpre"> </span><a name="loc_218_8_218_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_8_218_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_218_8_218_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_8_218_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">  = []
</span><a href="#loc_218_1_218_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_1_218_7&#39;)"><span class="hl_fundecl"><span class="mpre">lines&#39;</span></span></a><span class="mpre"> </span><a name="loc_219_8_219_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_8_219_10&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">B.elemIndex</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><a href="#loc_219_8_219_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_8_219_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
              </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_220_20_220_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_20_220_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; let (</span><a name="loc_220_30_220_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_30_220_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a name="loc_220_33_220_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_33_220_35&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> (</span><a href="#loc_220_20_220_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_20_220_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_219_8_219_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_8_219_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                        in </span><a href="#loc_220_30_220_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_30_220_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_218_1_218_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_1_218_7&#39;)"><span class="hl_varref"><span class="mpre">lines&#39;</span></span></a><span class="mpre"> </span><a href="#loc_220_33_220_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_33_220_35&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
              </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_219_8_219_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_8_219_10&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">]

</span></div></body></html>