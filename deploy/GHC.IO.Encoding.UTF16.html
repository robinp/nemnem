<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE Trustworthy #-}
{-# LANGUAGE NoImplicitPrelude
           , BangPatterns
           , NondecreasingIndentation
           , MagicHash
  #-}
{-# OPTIONS_GHC  -funbox-strict-fields #-}

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  GHC.IO.Encoding.UTF16</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The University of Glasgow, 2009</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  see libraries/base/LICENSE</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  internal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- UTF-16 Codecs for the IO library</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portions Copyright   : (c) Tom Harper 2008-2009,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                        (c) Bryan O&#39;Sullivan 2009,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                        (c) Duncan Coutts 2009</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module GHC.IO.Encoding.UTF16 (
  utf16, mkUTF16,
  utf16_decode,
  utf16_encode,

  utf16be, mkUTF16be,
  utf16be_decode,
  utf16be_encode,

  utf16le, mkUTF16le,
  utf16le_decode,
  utf16le_encode,
  ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 8, srcSpanEndLine = 41, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 8, srcSpanEndLine = 42, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Real&quot;"><span class="mpre">GHC.Real</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 8, srcSpanEndLine = 43, srcSpanEndColumn = 15}, srcInfoPoints = []}) &quot;GHC.Num&quot;"><span class="mpre">GHC.Num</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- import GHC.IO</span></span><span class="mpre">
import GHC.IO.Buffer
import GHC.IO.Encoding.Failure
import GHC.IO.Encoding.Types
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 48, srcSpanStartColumn = 8, srcSpanEndLine = 48, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Word&quot;"><span class="mpre">GHC.Word</span></span><span class="mpre">
import Data.Bits
import Data.Maybe
import GHC.IORef

</span><span class="hl_comment"><span class="mpre">-- -----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The UTF-16 codec: either UTF16BE or UTF16LE with a BOM</span></span><span class="mpre">

</span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="mpre">utf16</span></a><span class="mpre">  :: </span><a href="GHC.IO.Encoding.Types.html#loc_107_6_107_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_107_6_107_18&#39;)"><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span></a><span class="mpre">
</span><a name="loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_vardecl"><span class="mpre">utf16</span></span></a><span class="mpre"> = </span><a href="#loc_61_1_61_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_8&#39;)"><span class="hl_varref"><span class="mpre">mkUTF16</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Failure.html#loc_43_5_43_25" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Failure.html#loc_43_5_43_25&#39;)"><span class="hl_conref"><span class="mpre">ErrorOnCodingFailure</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /Since: 4.4.0.0/</span></span><span class="mpre">
</span><a href="#loc_61_1_61_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_8&#39;)"><span class="mpre">mkUTF16</span></a><span class="mpre"> :: </span><a href="GHC.IO.Encoding.Failure.html#loc_42_6_42_23" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Failure.html#loc_42_6_42_23&#39;)"><span class="hl_tyconref"><span class="mpre">CodingFailureMode</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Encoding.Types.html#loc_107_6_107_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_107_6_107_18&#39;)"><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span></a><span class="mpre">
</span><a name="loc_61_1_61_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_8&#39;)"><span class="hl_fundecl"><span class="mpre">mkUTF16</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">cfm</span></span><span class="mpre"> =  </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 16, srcSpanEndLine = 63, srcSpanEndColumn = 61}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 29, srcSpanEndLine = 61, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanS"><span class="mpre">TextEncoding { textEncodingName = &quot;UTF-16&quot;,
                              mkTextDecoder = utf16_DF cfm,
                              mkTextEncoder = utf16_EF cfm }</span></span><span class="mpre">

</span><a href="#loc_66_1_66_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_9&#39;)"><span class="mpre">utf16_DF</span></a><span class="mpre"> :: </span><a href="GHC.IO.Encoding.Failure.html#loc_42_6_42_23" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Failure.html#loc_42_6_42_23&#39;)"><span class="hl_tyconref"><span class="mpre">CodingFailureMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">TextDecoder</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">DecodeBuffer</span></span><span class="mpre">))
</span><a name="loc_66_1_66_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_9&#39;)"><span class="hl_fundecl"><span class="mpre">utf16_DF</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">cfm</span></span><span class="mpre"> = do
  </span><span class="hl_vardecl"><span class="mpre">seen_bom</span></span><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 11, srcSpanEndLine = 74, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 68, srcSpanStartColumn = 23, srcSpanEndLine = 68, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanS"><span class="mpre">BufferCodec {
             encode   = utf16_decode seen_bom,
             recover  = recoverDecode cfm,
             close    = return (),
             getState = readIORef seen_bom,
             setState = writeIORef seen_bom
          }</span></span><span class="mpre">)

</span><a href="#loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="mpre">utf16_EF</span></a><span class="mpre"> :: </span><a href="GHC.IO.Encoding.Failure.html#loc_42_6_42_23" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Failure.html#loc_42_6_42_23&#39;)"><span class="hl_tyconref"><span class="mpre">CodingFailureMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">TextEncoder</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)
</span><a name="loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="hl_fundecl"><span class="mpre">utf16_EF</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">cfm</span></span><span class="mpre"> = do
  </span><span class="hl_vardecl"><span class="mpre">done_bom</span></span><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 11, srcSpanEndLine = 85, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 23, srcSpanEndLine = 79, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanS"><span class="mpre">BufferCodec {
             encode   = utf16_encode done_bom,
             recover  = recoverEncode cfm,
             close    = return (),
             getState = readIORef done_bom,
             setState = writeIORef done_bom
          }</span></span><span class="mpre">)

</span><a href="#loc_88_1_88_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_13&#39;)"><span class="mpre">utf16_encode</span></a><span class="mpre"> :: </span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">EncodeBuffer</span></span><span class="mpre">
</span><a name="loc_88_1_88_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_13&#39;)"><span class="hl_fundecl"><span class="mpre">utf16_encode</span></span></a><span class="mpre"> </span><a name="loc_88_14_88_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_14_88_22&#39;)"><span class="hl_vardecl"><span class="mpre">done_bom</span></span></a><span class="mpre"> </span><a name="loc_88_23_88_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_23_88_28&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre">
  </span><a name="loc_89_3_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_3_89_9&#39;)"><span class="hl_specname"><span class="mpre">output</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 10, srcSpanEndLine = 89, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 16, srcSpanEndLine = 89, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartL"><span class="mpre">Buffer{ bufRaw=oraw, bufL=_, bufR=ow, bufSize=os }</span></span><span class="mpre">
 = do
  </span><a name="loc_91_3_91_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_3_91_4&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_88_14_88_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_14_88_22&#39;)"><span class="hl_varref"><span class="mpre">done_bom</span></span></a><span class="mpre">
  if </span><a href="#loc_91_3_91_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_3_91_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then </span><a href="#loc_134_1_134_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_20&#39;)"><span class="hl_varref"><span class="mpre">utf16_native_encode</span></span></a><span class="mpre"> </span><a href="#loc_88_23_88_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_23_88_28&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> </span><a href="#loc_89_3_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_3_89_9&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">
       else if </span><span class="hl_varref"><span class="mpre">os</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ow</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
               then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="GHC.IO.Encoding.Types.html#loc_127_23_127_38" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_127_23_127_38&#39;)"><span class="hl_conref"><span class="mpre">OutputUnderflow</span></span></a><span class="mpre">,</span><a href="#loc_88_23_88_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_23_88_28&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">,</span><a href="#loc_89_3_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_3_89_9&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">)
               else do
                    </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_88_14_88_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_14_88_22&#39;)"><span class="hl_varref"><span class="mpre">done_bom</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                    </span><a href="GHC.IO.Buffer.html#loc_102_1_102_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_102_1_102_14&#39;)"><span class="hl_varref"><span class="mpre">writeWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ow</span></span><span class="mpre">     </span><a href="#loc_136_1_136_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_5&#39;)"><span class="hl_varref"><span class="mpre">bom1</span></span></a><span class="mpre">
                    </span><a href="GHC.IO.Buffer.html#loc_102_1_102_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_102_1_102_14&#39;)"><span class="hl_varref"><span class="mpre">writeWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">ow</span></span><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">bom2</span></span></a><span class="mpre">
                    </span><a href="#loc_134_1_134_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_20&#39;)"><span class="hl_varref"><span class="mpre">utf16_native_encode</span></span></a><span class="mpre"> </span><a href="#loc_88_23_88_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_23_88_28&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 47, srcSpanEndLine = 99, srcSpanEndColumn = 68}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 53, srcSpanEndLine = 99, srcSpanEndColumn = 54},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanS"><span class="mpre">output{ bufR = ow+2 }</span></span><span class="mpre">

</span><a href="#loc_102_1_102_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_13&#39;)"><span class="mpre">utf16_decode</span></a><span class="mpre"> :: </span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">DecodeBuffer</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">DecodeBuffer</span></span><span class="mpre">
</span><a name="loc_102_1_102_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_13&#39;)"><span class="hl_fundecl"><span class="mpre">utf16_decode</span></span></a><span class="mpre"> </span><a name="loc_102_14_102_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_14_102_22&#39;)"><span class="hl_vardecl"><span class="mpre">seen_bom</span></span></a><span class="mpre">
  </span><a name="loc_103_3_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_3_103_8&#39;)"><span class="hl_specname"><span class="mpre">input</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 103, srcSpanStartColumn = 9, srcSpanEndLine = 103, srcSpanEndColumn = 62}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 103, srcSpanStartColumn = 15, srcSpanEndLine = 103, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanSta"><span class="mpre">Buffer{  bufRaw=iraw, bufL=ir, bufR=iw,  bufSize=_  }</span></span><span class="mpre">
  </span><a name="loc_104_3_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_9&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre">
 = do
   </span><a name="loc_106_4_106_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_4_106_6&#39;)"><span class="hl_vardecl"><span class="mpre">mb</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_102_14_102_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_14_102_22&#39;)"><span class="hl_varref"><span class="mpre">seen_bom</span></span></a><span class="mpre">
   case </span><a href="#loc_106_4_106_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_4_106_6&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre"> of
     </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_108_11_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_11_108_17&#39;)"><span class="hl_vardecl"><span class="mpre">decode</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_108_11_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_11_108_17&#39;)"><span class="hl_varref"><span class="mpre">decode</span></span></a><span class="mpre"> </span><a href="#loc_103_3_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_3_103_8&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> </span><a href="#loc_104_3_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_9&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">
     </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt;
       if </span><span class="hl_varref"><span class="mpre">iw</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ir</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="GHC.IO.Encoding.Types.html#loc_125_23_125_37" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_125_23_125_37&#39;)"><span class="hl_conref"><span class="mpre">InputUnderflow</span></span></a><span class="mpre">,</span><a href="#loc_103_3_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_3_103_8&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">,</span><a href="#loc_104_3_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_9&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">) else do
       </span><a name="loc_111_8_111_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_8_111_10&#39;)"><span class="hl_vardecl"><span class="mpre">c0</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_99_1_99_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_99_1_99_13&#39;)"><span class="hl_varref"><span class="mpre">readWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iraw</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ir</span></span><span class="mpre">
       </span><a name="loc_112_8_112_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_8_112_10&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_99_1_99_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_99_1_99_13&#39;)"><span class="hl_varref"><span class="mpre">readWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iraw</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">ir</span></span><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
       case </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> of
        _ | </span><a href="#loc_111_8_111_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_8_111_10&#39;)"><span class="hl_varref"><span class="mpre">c0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_5&#39;)"><span class="hl_varref"><span class="mpre">bomB</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_112_8_112_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_8_112_10&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_127_1_127_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_5&#39;)"><span class="hl_varref"><span class="mpre">bomL</span></span></a><span class="mpre"> -&gt; do
               </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_102_14_102_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_14_102_22&#39;)"><span class="hl_varref"><span class="mpre">seen_bom</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_202_1_202_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_15&#39;)"><span class="hl_varref"><span class="mpre">utf16be_decode</span></span></a><span class="mpre">)
               </span><a href="#loc_202_1_202_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_15&#39;)"><span class="hl_varref"><span class="mpre">utf16be_decode</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 116, srcSpanStartColumn = 31, srcSpanEndLine = 116, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 116, srcSpanStartColumn = 36, srcSpanEndLine = 116, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">input{ bufL= ir+2 }</span></span><span class="mpre"> </span><a href="#loc_104_3_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_9&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">
          | </span><a href="#loc_111_8_111_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_8_111_10&#39;)"><span class="hl_varref"><span class="mpre">c0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_127_1_127_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_5&#39;)"><span class="hl_varref"><span class="mpre">bomL</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_112_8_112_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_8_112_10&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_5&#39;)"><span class="hl_varref"><span class="mpre">bomB</span></span></a><span class="mpre"> -&gt; do
               </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_102_14_102_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_14_102_22&#39;)"><span class="hl_varref"><span class="mpre">seen_bom</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_236_1_236_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_15&#39;)"><span class="hl_varref"><span class="mpre">utf16le_decode</span></span></a><span class="mpre">)
               </span><a href="#loc_236_1_236_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_15&#39;)"><span class="hl_varref"><span class="mpre">utf16le_decode</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 119, srcSpanStartColumn = 31, srcSpanEndLine = 119, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 119, srcSpanStartColumn = 36, srcSpanEndLine = 119, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">input{ bufL= ir+2 }</span></span><span class="mpre"> </span><a href="#loc_104_3_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_9&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; do
               </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_102_14_102_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_14_102_22&#39;)"><span class="hl_varref"><span class="mpre">seen_bom</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_131_1_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_20&#39;)"><span class="hl_varref"><span class="mpre">utf16_native_decode</span></span></a><span class="mpre">)
               </span><a href="#loc_131_1_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_20&#39;)"><span class="hl_varref"><span class="mpre">utf16_native_decode</span></span></a><span class="mpre"> </span><a href="#loc_103_3_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_3_103_8&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> </span><a href="#loc_104_3_104_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_9&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">


</span><a href="#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_5&#39;)"><span class="mpre">bomB</span></a><span class="mpre">, </span><a href="#loc_127_1_127_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_5&#39;)"><span class="mpre">bomL</span></a><span class="mpre">, </span><a href="#loc_136_1_136_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_5&#39;)"><span class="mpre">bom1</span></a><span class="mpre">, </span><a href="#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_5&#39;)"><span class="mpre">bom2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
</span><a name="loc_126_1_126_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_5&#39;)"><span class="hl_vardecl"><span class="mpre">bomB</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0xfe</span></span><span class="mpre">
</span><a name="loc_127_1_127_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_5&#39;)"><span class="hl_vardecl"><span class="mpre">bomL</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0xff</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- choose UTF-16BE by default for UTF-16 output</span></span><span class="mpre">
</span><a href="#loc_131_1_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_20&#39;)"><span class="mpre">utf16_native_decode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DecodeBuffer</span></span><span class="mpre">
</span><a name="loc_131_1_131_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_1_131_20&#39;)"><span class="hl_vardecl"><span class="mpre">utf16_native_decode</span></span></a><span class="mpre"> = </span><a href="#loc_202_1_202_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_15&#39;)"><span class="hl_varref"><span class="mpre">utf16be_decode</span></span></a><span class="mpre">

</span><a href="#loc_134_1_134_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_20&#39;)"><span class="mpre">utf16_native_encode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">EncodeBuffer</span></span><span class="mpre">
</span><a name="loc_134_1_134_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_20&#39;)"><span class="hl_vardecl"><span class="mpre">utf16_native_encode</span></span></a><span class="mpre"> = </span><a href="#loc_270_1_270_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_1_270_15&#39;)"><span class="hl_varref"><span class="mpre">utf16be_encode</span></span></a><span class="mpre">

</span><a name="loc_136_1_136_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_1_136_5&#39;)"><span class="hl_vardecl"><span class="mpre">bom1</span></span></a><span class="mpre"> = </span><a href="#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_5&#39;)"><span class="hl_varref"><span class="mpre">bomB</span></span></a><span class="mpre">
</span><a name="loc_137_1_137_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_5&#39;)"><span class="hl_vardecl"><span class="mpre">bom2</span></span></a><span class="mpre"> = </span><a href="#loc_127_1_127_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_5&#39;)"><span class="hl_varref"><span class="mpre">bomL</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- -----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- UTF16LE and UTF16BE</span></span><span class="mpre">

</span><a href="#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_8&#39;)"><span class="mpre">utf16be</span></a><span class="mpre"> :: </span><a href="GHC.IO.Encoding.Types.html#loc_107_6_107_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_107_6_107_18&#39;)"><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span></a><span class="mpre">
</span><a name="loc_143_1_143_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_8&#39;)"><span class="hl_vardecl"><span class="mpre">utf16be</span></span></a><span class="mpre"> = </span><a href="#loc_147_1_147_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_10&#39;)"><span class="hl_varref"><span class="mpre">mkUTF16be</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Failure.html#loc_43_5_43_25" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Failure.html#loc_43_5_43_25&#39;)"><span class="hl_conref"><span class="mpre">ErrorOnCodingFailure</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /Since: 4.4.0.0/</span></span><span class="mpre">
</span><a href="#loc_147_1_147_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_10&#39;)"><span class="mpre">mkUTF16be</span></a><span class="mpre"> :: </span><a href="GHC.IO.Encoding.Failure.html#loc_42_6_42_23" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Failure.html#loc_42_6_42_23&#39;)"><span class="hl_tyconref"><span class="mpre">CodingFailureMode</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Encoding.Types.html#loc_107_6_107_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_107_6_107_18&#39;)"><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span></a><span class="mpre">
</span><a name="loc_147_1_147_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_1_147_10&#39;)"><span class="hl_fundecl"><span class="mpre">mkUTF16be</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">cfm</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 147, srcSpanStartColumn = 17, srcSpanEndLine = 149, srcSpanEndColumn = 64}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 147, srcSpanStartColumn = 30, srcSpanEndLine = 147, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">TextEncoding { textEncodingName = &quot;UTF-16BE&quot;,
                               mkTextDecoder = utf16be_DF cfm,
                               mkTextEncoder = utf16be_EF cfm }</span></span><span class="mpre">

</span><a href="#loc_152_1_152_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_11&#39;)"><span class="mpre">utf16be_DF</span></a><span class="mpre"> :: </span><a href="GHC.IO.Encoding.Failure.html#loc_42_6_42_23" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Failure.html#loc_42_6_42_23&#39;)"><span class="hl_tyconref"><span class="mpre">CodingFailureMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">TextDecoder</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)
</span><a name="loc_152_1_152_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_1_152_11&#39;)"><span class="hl_fundecl"><span class="mpre">utf16be_DF</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">cfm</span></span><span class="mpre"> =
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 153, srcSpanStartColumn = 11, srcSpanEndLine = 159, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 153, srcSpanStartColumn = 23, srcSpanEndLine = 153, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">BufferCodec {
             encode   = utf16be_decode,
             recover  = recoverDecode cfm,
             close    = return (),
             getState = return (),
             setState = const $ return ()
          }</span></span><span class="mpre">)

</span><a href="#loc_162_1_162_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_11&#39;)"><span class="mpre">utf16be_EF</span></a><span class="mpre"> :: </span><a href="GHC.IO.Encoding.Failure.html#loc_42_6_42_23" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Failure.html#loc_42_6_42_23&#39;)"><span class="hl_tyconref"><span class="mpre">CodingFailureMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">TextEncoder</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)
</span><a name="loc_162_1_162_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_1_162_11&#39;)"><span class="hl_fundecl"><span class="mpre">utf16be_EF</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">cfm</span></span><span class="mpre"> =
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 163, srcSpanStartColumn = 11, srcSpanEndLine = 169, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 163, srcSpanStartColumn = 23, srcSpanEndLine = 163, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">BufferCodec {
             encode   = utf16be_encode,
             recover  = recoverEncode cfm,
             close    = return (),
             getState = return (),
             setState = const $ return ()
          }</span></span><span class="mpre">)

</span><a href="#loc_172_1_172_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_1_172_8&#39;)"><span class="mpre">utf16le</span></a><span class="mpre"> :: </span><a href="GHC.IO.Encoding.Types.html#loc_107_6_107_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_107_6_107_18&#39;)"><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span></a><span class="mpre">
</span><a name="loc_172_1_172_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_1_172_8&#39;)"><span class="hl_vardecl"><span class="mpre">utf16le</span></span></a><span class="mpre"> = </span><a href="#loc_176_1_176_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_10&#39;)"><span class="hl_varref"><span class="mpre">mkUTF16le</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Failure.html#loc_43_5_43_25" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Failure.html#loc_43_5_43_25&#39;)"><span class="hl_conref"><span class="mpre">ErrorOnCodingFailure</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /Since: 4.4.0.0/</span></span><span class="mpre">
</span><a href="#loc_176_1_176_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_10&#39;)"><span class="mpre">mkUTF16le</span></a><span class="mpre"> :: </span><a href="GHC.IO.Encoding.Failure.html#loc_42_6_42_23" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Failure.html#loc_42_6_42_23&#39;)"><span class="hl_tyconref"><span class="mpre">CodingFailureMode</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Encoding.Types.html#loc_107_6_107_18" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_107_6_107_18&#39;)"><span class="hl_tyconref"><span class="mpre">TextEncoding</span></span></a><span class="mpre">
</span><a name="loc_176_1_176_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_10&#39;)"><span class="hl_fundecl"><span class="mpre">mkUTF16le</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">cfm</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 176, srcSpanStartColumn = 17, srcSpanEndLine = 178, srcSpanEndColumn = 64}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 176, srcSpanStartColumn = 30, srcSpanEndLine = 176, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">TextEncoding { textEncodingName = &quot;UTF16-LE&quot;,
                               mkTextDecoder = utf16le_DF cfm,
                               mkTextEncoder = utf16le_EF cfm }</span></span><span class="mpre">

</span><a href="#loc_181_1_181_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_1_181_11&#39;)"><span class="mpre">utf16le_DF</span></a><span class="mpre"> :: </span><a href="GHC.IO.Encoding.Failure.html#loc_42_6_42_23" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Failure.html#loc_42_6_42_23&#39;)"><span class="hl_tyconref"><span class="mpre">CodingFailureMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">TextDecoder</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)
</span><a name="loc_181_1_181_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_1_181_11&#39;)"><span class="hl_fundecl"><span class="mpre">utf16le_DF</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">cfm</span></span><span class="mpre"> =
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 182, srcSpanStartColumn = 11, srcSpanEndLine = 188, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 182, srcSpanStartColumn = 23, srcSpanEndLine = 182, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">BufferCodec {
             encode   = utf16le_decode,
             recover  = recoverDecode cfm,
             close    = return (),
             getState = return (),
             setState = const $ return ()
          }</span></span><span class="mpre">)

</span><a href="#loc_191_1_191_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_1_191_11&#39;)"><span class="mpre">utf16le_EF</span></a><span class="mpre"> :: </span><a href="GHC.IO.Encoding.Failure.html#loc_42_6_42_23" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Failure.html#loc_42_6_42_23&#39;)"><span class="hl_tyconref"><span class="mpre">CodingFailureMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">TextEncoder</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)
</span><a name="loc_191_1_191_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_1_191_11&#39;)"><span class="hl_fundecl"><span class="mpre">utf16le_EF</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">cfm</span></span><span class="mpre"> =
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 192, srcSpanStartColumn = 11, srcSpanEndLine = 198, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 192, srcSpanStartColumn = 23, srcSpanEndLine = 192, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">BufferCodec {
             encode   = utf16le_encode,
             recover  = recoverEncode cfm,
             close    = return (),
             getState = return (),
             setState = const $ return ()
          }</span></span><span class="mpre">)


</span><a href="#loc_202_1_202_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_15&#39;)"><span class="mpre">utf16be_decode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DecodeBuffer</span></span><span class="mpre">
</span><a name="loc_202_1_202_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_1_202_15&#39;)"><span class="hl_fundecl"><span class="mpre">utf16be_decode</span></span></a><span class="mpre"> 
  </span><span class="hl_specname"><span class="mpre">input</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 203, srcSpanStartColumn = 9, srcSpanEndLine = 203, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 203, srcSpanStartColumn = 15, srcSpanEndLine = 203, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanSta"><span class="mpre">Buffer{  bufRaw=iraw, bufL=ir0, bufR=iw,  bufSize=_  }</span></span><span class="mpre">
  </span><span class="hl_specname"><span class="mpre">output</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 204, srcSpanStartColumn = 10, srcSpanEndLine = 204, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 204, srcSpanStartColumn = 16, srcSpanEndLine = 204, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanSt"><span class="mpre">Buffer{ bufRaw=oraw, bufL=_,   bufR=ow0, bufSize=os }</span></span><span class="mpre">
 = let 
       </span><a name="loc_206_8_206_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_8_206_12&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_vardecl"><span class="mpre">ir</span></span></a><span class="mpre"> !</span><a name="loc_206_18_206_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_20&#39;)"><span class="hl_vardecl"><span class="mpre">ow</span></span></a><span class="mpre">
         | </span><a href="#loc_206_18_206_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">os</span></span><span class="mpre">     = </span><a href="#loc_228_8_228_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_8_228_12&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_127_23_127_38" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_127_23_127_38&#39;)"><span class="hl_conref"><span class="mpre">OutputUnderflow</span></span></a><span class="mpre"> </span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_206_18_206_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">
         | </span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iw</span></span><span class="mpre">     = </span><a href="#loc_228_8_228_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_8_228_12&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_125_23_125_37" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_125_23_125_37&#39;)"><span class="hl_conref"><span class="mpre">InputUnderflow</span></span></a><span class="mpre"> </span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_206_18_206_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">
         | </span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iw</span></span><span class="mpre"> = </span><a href="#loc_228_8_228_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_8_228_12&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_125_23_125_37" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_125_23_125_37&#39;)"><span class="hl_conref"><span class="mpre">InputUnderflow</span></span></a><span class="mpre"> </span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_206_18_206_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">
         | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
              </span><a name="loc_211_15_211_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_15_211_17&#39;)"><span class="hl_vardecl"><span class="mpre">c0</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_99_1_99_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_99_1_99_13&#39;)"><span class="hl_varref"><span class="mpre">readWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iraw</span></span><span class="mpre"> </span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre">
              </span><a name="loc_212_15_212_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_15_212_17&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_99_1_99_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_99_1_99_13&#39;)"><span class="hl_varref"><span class="mpre">readWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iraw</span></span><span class="mpre"> (</span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
              let </span><a name="loc_213_19_213_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_19_213_21&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_211_15_211_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_15_211_17&#39;)"><span class="hl_varref"><span class="mpre">c0</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_212_15_212_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_15_212_17&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre">
              if </span><a href="#loc_353_1_353_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_10&#39;)"><span class="hl_varref"><span class="mpre">validate1</span></span></a><span class="mpre"> </span><a href="#loc_213_19_213_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_19_213_21&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">
                 then do </span><a name="loc_215_26_215_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_26_215_29&#39;)"><span class="hl_vardecl"><span class="mpre">ow&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_123_1_123_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_123_1_123_13&#39;)"><span class="hl_varref"><span class="mpre">writeCharBuf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> </span><a href="#loc_206_18_206_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">unsafeChr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_213_19_213_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_19_213_21&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">))
                         </span><a href="#loc_206_8_206_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_8_206_12&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_215_26_215_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_26_215_29&#39;)"><span class="hl_varref"><span class="mpre">ow&#39;</span></span></a><span class="mpre">
                 else if </span><span class="hl_varref"><span class="mpre">iw</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> then </span><a href="#loc_228_8_228_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_8_228_12&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_125_23_125_37" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_125_23_125_37&#39;)"><span class="hl_conref"><span class="mpre">InputUnderflow</span></span></a><span class="mpre"> </span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_206_18_206_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> else do
                      </span><a name="loc_218_23_218_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_23_218_25&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_99_1_99_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_99_1_99_13&#39;)"><span class="hl_varref"><span class="mpre">readWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iraw</span></span><span class="mpre"> (</span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
                      </span><a name="loc_219_23_219_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_23_219_25&#39;)"><span class="hl_vardecl"><span class="mpre">c3</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_99_1_99_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_99_1_99_13&#39;)"><span class="hl_varref"><span class="mpre">readWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iraw</span></span><span class="mpre"> (</span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)
                      let </span><a name="loc_220_27_220_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_27_220_29&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_218_23_218_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_23_218_25&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_219_23_219_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_23_219_25&#39;)"><span class="hl_varref"><span class="mpre">c3</span></span></a><span class="mpre">
                      if </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_357_1_357_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_10&#39;)"><span class="hl_varref"><span class="mpre">validate2</span></span></a><span class="mpre"> </span><a href="#loc_213_19_213_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_19_213_21&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_220_27_220_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_27_220_29&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">) then </span><a href="#loc_225_12_225_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_12_225_19&#39;)"><span class="hl_varref"><span class="mpre">invalid</span></span></a><span class="mpre"> else do
                      </span><a name="loc_222_23_222_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_23_222_26&#39;)"><span class="hl_vardecl"><span class="mpre">ow&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_123_1_123_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_123_1_123_13&#39;)"><span class="hl_varref"><span class="mpre">writeCharBuf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> </span><a href="#loc_206_18_206_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> (</span><a href="#loc_344_1_344_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_1_344_5&#39;)"><span class="hl_varref"><span class="mpre">chr2</span></span></a><span class="mpre"> </span><a href="#loc_213_19_213_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_19_213_21&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_220_27_220_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_27_220_29&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">)
                      </span><a href="#loc_206_8_206_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_8_206_12&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) </span><a href="#loc_222_23_222_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_23_222_26&#39;)"><span class="hl_varref"><span class="mpre">ow&#39;</span></span></a><span class="mpre">
         where
           </span><a name="loc_225_12_225_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_12_225_19&#39;)"><span class="hl_vardecl"><span class="mpre">invalid</span></span></a><span class="mpre"> = </span><a href="#loc_228_8_228_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_8_228_12&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_128_23_128_38" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_128_23_128_38&#39;)"><span class="hl_conref"><span class="mpre">InvalidSequence</span></span></a><span class="mpre"> </span><a href="#loc_206_14_206_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_14_206_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_206_18_206_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_18_206_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">

       </span><span class="hl_comment"><span class="mpre">-- lambda-lifted, to avoid thunks being built in the inner-loop:</span></span><span class="mpre">
       </span><a name="loc_228_8_228_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_8_228_12&#39;)"><span class="hl_fundecl"><span class="mpre">done</span></span></a><span class="mpre"> </span><a name="loc_228_13_228_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_13_228_16&#39;)"><span class="hl_vardecl"><span class="mpre">why</span></span></a><span class="mpre"> !</span><a name="loc_228_18_228_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_18_228_20&#39;)"><span class="hl_vardecl"><span class="mpre">ir</span></span></a><span class="mpre"> !</span><span class="hl_vardecl"><span class="mpre">ow</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_228_13_228_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_13_228_16&#39;)"><span class="hl_varref"><span class="mpre">why</span></span></a><span class="mpre">,
                                  if </span><a href="#loc_228_18_228_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_18_228_20&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iw</span></span><span class="mpre"> then </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 229, srcSpanStartColumn = 52, srcSpanEndLine = 229, srcSpanEndColumn = 75}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 229, srcSpanStartColumn = 57, srcSpanEndLine = 229, srcSpanEndColumn = 58},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">input{ bufL=0, bufR=0 }</span></span><span class="mpre">
                                              else </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 230, srcSpanStartColumn = 52, srcSpanEndLine = 230, srcSpanEndColumn = 68}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 230, srcSpanStartColumn = 57, srcSpanEndLine = 230, srcSpanEndColumn = 58},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">input{ bufL=ir }</span></span><span class="mpre">,
                                  </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 231, srcSpanStartColumn = 35, srcSpanEndLine = 231, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 231, srcSpanStartColumn = 41, srcSpanEndLine = 231, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">output{ bufR=ow }</span></span><span class="mpre">)
    in
    </span><a href="#loc_206_8_206_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_8_206_12&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ir0</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ow0</span></span><span class="mpre">

</span><a href="#loc_236_1_236_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_15&#39;)"><span class="mpre">utf16le_decode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DecodeBuffer</span></span><span class="mpre">
</span><a name="loc_236_1_236_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_15&#39;)"><span class="hl_fundecl"><span class="mpre">utf16le_decode</span></span></a><span class="mpre"> 
  </span><span class="hl_specname"><span class="mpre">input</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 237, srcSpanStartColumn = 9, srcSpanEndLine = 237, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 237, srcSpanStartColumn = 15, srcSpanEndLine = 237, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanSta"><span class="mpre">Buffer{  bufRaw=iraw, bufL=ir0, bufR=iw,  bufSize=_  }</span></span><span class="mpre">
  </span><span class="hl_specname"><span class="mpre">output</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 238, srcSpanStartColumn = 10, srcSpanEndLine = 238, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 238, srcSpanStartColumn = 16, srcSpanEndLine = 238, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanSt"><span class="mpre">Buffer{ bufRaw=oraw, bufL=_,   bufR=ow0, bufSize=os }</span></span><span class="mpre">
 = let 
       </span><a name="loc_240_8_240_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_8_240_12&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_vardecl"><span class="mpre">ir</span></span></a><span class="mpre"> !</span><a name="loc_240_18_240_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_18_240_20&#39;)"><span class="hl_vardecl"><span class="mpre">ow</span></span></a><span class="mpre">
         | </span><a href="#loc_240_18_240_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_18_240_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">os</span></span><span class="mpre">     = </span><a href="#loc_262_8_262_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_8_262_12&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_127_23_127_38" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_127_23_127_38&#39;)"><span class="hl_conref"><span class="mpre">OutputUnderflow</span></span></a><span class="mpre"> </span><a href="#loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_240_18_240_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_18_240_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">
         | </span><a href="#loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iw</span></span><span class="mpre">     = </span><a href="#loc_262_8_262_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_8_262_12&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_125_23_125_37" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_125_23_125_37&#39;)"><span class="hl_conref"><span class="mpre">InputUnderflow</span></span></a><span class="mpre"> </span><a href="#loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_240_18_240_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_18_240_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">
         | </span><a href="#loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iw</span></span><span class="mpre"> = </span><a href="#loc_262_8_262_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_8_262_12&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_125_23_125_37" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_125_23_125_37&#39;)"><span class="hl_conref"><span class="mpre">InputUnderflow</span></span></a><span class="mpre"> </span><a href="#loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_240_18_240_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_18_240_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">
         | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
              </span><a name="loc_245_15_245_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_15_245_17&#39;)"><span class="hl_vardecl"><span class="mpre">c0</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_99_1_99_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_99_1_99_13&#39;)"><span class="hl_varref"><span class="mpre">readWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iraw</span></span><span class="mpre"> </span><a href="#loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre">
              </span><a name="loc_246_15_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_15_246_17&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_99_1_99_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_99_1_99_13&#39;)"><span class="hl_varref"><span class="mpre">readWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iraw</span></span><span class="mpre"> (</span><a href="#loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
              let </span><a name="loc_247_19_247_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_19_247_21&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_246_15_246_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_246_15_246_17&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_245_15_245_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_15_245_17&#39;)"><span class="hl_varref"><span class="mpre">c0</span></span></a><span class="mpre">
              if </span><a href="#loc_353_1_353_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_10&#39;)"><span class="hl_varref"><span class="mpre">validate1</span></span></a><span class="mpre"> </span><a href="#loc_247_19_247_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_19_247_21&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">
                 then do </span><a name="loc_249_26_249_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_26_249_29&#39;)"><span class="hl_vardecl"><span class="mpre">ow&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_123_1_123_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_123_1_123_13&#39;)"><span class="hl_varref"><span class="mpre">writeCharBuf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> </span><a href="#loc_240_18_240_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_18_240_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">unsafeChr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_247_19_247_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_19_247_21&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">))
                         </span><a href="#loc_240_8_240_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_8_240_12&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_249_26_249_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_26_249_29&#39;)"><span class="hl_varref"><span class="mpre">ow&#39;</span></span></a><span class="mpre">
                 else if </span><span class="hl_varref"><span class="mpre">iw</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> then </span><a href="#loc_262_8_262_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_8_262_12&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_125_23_125_37" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_125_23_125_37&#39;)"><span class="hl_conref"><span class="mpre">InputUnderflow</span></span></a><span class="mpre"> </span><a href="#loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_240_18_240_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_18_240_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> else do
                      </span><a name="loc_252_23_252_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_23_252_25&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_99_1_99_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_99_1_99_13&#39;)"><span class="hl_varref"><span class="mpre">readWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iraw</span></span><span class="mpre"> (</span><a href="#loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
                      </span><a name="loc_253_23_253_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_23_253_25&#39;)"><span class="hl_vardecl"><span class="mpre">c3</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_99_1_99_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_99_1_99_13&#39;)"><span class="hl_varref"><span class="mpre">readWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iraw</span></span><span class="mpre"> (</span><a href="#loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)
                      let </span><a name="loc_254_27_254_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_27_254_29&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_253_23_253_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_23_253_25&#39;)"><span class="hl_varref"><span class="mpre">c3</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_252_23_252_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_23_252_25&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">
                      if </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_357_1_357_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_10&#39;)"><span class="hl_varref"><span class="mpre">validate2</span></span></a><span class="mpre"> </span><a href="#loc_247_19_247_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_19_247_21&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_254_27_254_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_27_254_29&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">) then </span><a href="#loc_259_12_259_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_12_259_19&#39;)"><span class="hl_varref"><span class="mpre">invalid</span></span></a><span class="mpre"> else do
                      </span><a name="loc_256_23_256_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_23_256_26&#39;)"><span class="hl_vardecl"><span class="mpre">ow&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Buffer.html#loc_123_1_123_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_123_1_123_13&#39;)"><span class="hl_varref"><span class="mpre">writeCharBuf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> </span><a href="#loc_240_18_240_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_18_240_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> (</span><a href="#loc_344_1_344_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_1_344_5&#39;)"><span class="hl_varref"><span class="mpre">chr2</span></span></a><span class="mpre"> </span><a href="#loc_247_19_247_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_19_247_21&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_254_27_254_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_27_254_29&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">)
                      </span><a href="#loc_240_8_240_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_8_240_12&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">) </span><a href="#loc_256_23_256_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_23_256_26&#39;)"><span class="hl_varref"><span class="mpre">ow&#39;</span></span></a><span class="mpre">
         where
           </span><a name="loc_259_12_259_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_12_259_19&#39;)"><span class="hl_vardecl"><span class="mpre">invalid</span></span></a><span class="mpre"> = </span><a href="#loc_262_8_262_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_8_262_12&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_128_23_128_38" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_128_23_128_38&#39;)"><span class="hl_conref"><span class="mpre">InvalidSequence</span></span></a><span class="mpre"> </span><a href="#loc_240_14_240_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_14_240_16&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_240_18_240_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_18_240_20&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">

       </span><span class="hl_comment"><span class="mpre">-- lambda-lifted, to avoid thunks being built in the inner-loop:</span></span><span class="mpre">
       </span><a name="loc_262_8_262_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_8_262_12&#39;)"><span class="hl_fundecl"><span class="mpre">done</span></span></a><span class="mpre"> </span><a name="loc_262_13_262_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_13_262_16&#39;)"><span class="hl_vardecl"><span class="mpre">why</span></span></a><span class="mpre"> !</span><a name="loc_262_18_262_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_18_262_20&#39;)"><span class="hl_vardecl"><span class="mpre">ir</span></span></a><span class="mpre"> !</span><span class="hl_vardecl"><span class="mpre">ow</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_262_13_262_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_13_262_16&#39;)"><span class="hl_varref"><span class="mpre">why</span></span></a><span class="mpre">,
                                  if </span><a href="#loc_262_18_262_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_18_262_20&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iw</span></span><span class="mpre"> then </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 263, srcSpanStartColumn = 52, srcSpanEndLine = 263, srcSpanEndColumn = 75}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 263, srcSpanStartColumn = 57, srcSpanEndLine = 263, srcSpanEndColumn = 58},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">input{ bufL=0, bufR=0 }</span></span><span class="mpre">
                                              else </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 264, srcSpanStartColumn = 52, srcSpanEndLine = 264, srcSpanEndColumn = 68}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 264, srcSpanStartColumn = 57, srcSpanEndLine = 264, srcSpanEndColumn = 58},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">input{ bufL=ir }</span></span><span class="mpre">,
                                  </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 265, srcSpanStartColumn = 35, srcSpanEndLine = 265, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 265, srcSpanStartColumn = 41, srcSpanEndLine = 265, srcSpanEndColumn = 42},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">output{ bufR=ow }</span></span><span class="mpre">)
    in
    </span><a href="#loc_240_8_240_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_8_240_12&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ir0</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ow0</span></span><span class="mpre">

</span><a href="#loc_270_1_270_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_1_270_15&#39;)"><span class="mpre">utf16be_encode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">EncodeBuffer</span></span><span class="mpre">
</span><a name="loc_270_1_270_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_1_270_15&#39;)"><span class="hl_fundecl"><span class="mpre">utf16be_encode</span></span></a><span class="mpre">
  </span><span class="hl_specname"><span class="mpre">input</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 271, srcSpanStartColumn = 9, srcSpanEndLine = 271, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 271, srcSpanStartColumn = 15, srcSpanEndLine = 271, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanSta"><span class="mpre">Buffer{  bufRaw=iraw, bufL=ir0, bufR=iw,  bufSize=_  }</span></span><span class="mpre">
  </span><span class="hl_specname"><span class="mpre">output</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 272, srcSpanStartColumn = 10, srcSpanEndLine = 272, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 272, srcSpanStartColumn = 16, srcSpanEndLine = 272, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanSt"><span class="mpre">Buffer{ bufRaw=oraw, bufL=_,   bufR=ow0, bufSize=os }</span></span><span class="mpre">
 = let 
      </span><a name="loc_274_7_274_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_7_274_11&#39;)"><span class="hl_fundecl"><span class="mpre">done</span></span></a><span class="mpre"> </span><a name="loc_274_12_274_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_12_274_15&#39;)"><span class="hl_vardecl"><span class="mpre">why</span></span></a><span class="mpre"> !</span><a name="loc_274_17_274_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_17_274_19&#39;)"><span class="hl_vardecl"><span class="mpre">ir</span></span></a><span class="mpre"> !</span><span class="hl_vardecl"><span class="mpre">ow</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_274_12_274_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_12_274_15&#39;)"><span class="hl_varref"><span class="mpre">why</span></span></a><span class="mpre">,
                                 if </span><a href="#loc_274_17_274_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_17_274_19&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iw</span></span><span class="mpre"> then </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 275, srcSpanStartColumn = 51, srcSpanEndLine = 275, srcSpanEndColumn = 74}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 275, srcSpanStartColumn = 56, srcSpanEndLine = 275, srcSpanEndColumn = 57},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">input{ bufL=0, bufR=0 }</span></span><span class="mpre">
                                             else </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 276, srcSpanStartColumn = 51, srcSpanEndLine = 276, srcSpanEndColumn = 67}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 276, srcSpanStartColumn = 56, srcSpanEndLine = 276, srcSpanEndColumn = 57},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">input{ bufL=ir }</span></span><span class="mpre">,
                                 </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 277, srcSpanStartColumn = 34, srcSpanEndLine = 277, srcSpanEndColumn = 51}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 277, srcSpanStartColumn = 40, srcSpanEndLine = 277, srcSpanEndColumn = 41},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">output{ bufR=ow }</span></span><span class="mpre">)
      </span><a name="loc_278_7_278_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_7_278_11&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_278_13_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_13_278_15&#39;)"><span class="hl_vardecl"><span class="mpre">ir</span></span></a><span class="mpre"> !</span><a name="loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_vardecl"><span class="mpre">ow</span></span></a><span class="mpre">
        | </span><a href="#loc_278_13_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_13_278_15&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iw</span></span><span class="mpre">     =  </span><a href="#loc_274_7_274_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_7_274_11&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_125_23_125_37" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_125_23_125_37&#39;)"><span class="hl_conref"><span class="mpre">InputUnderflow</span></span></a><span class="mpre"> </span><a href="#loc_278_13_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_13_278_15&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">os</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">  =  </span><a href="#loc_274_7_274_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_7_274_11&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_127_23_127_38" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_127_23_127_38&#39;)"><span class="hl_conref"><span class="mpre">OutputUnderflow</span></span></a><span class="mpre"> </span><a href="#loc_278_13_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_13_278_15&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
           (</span><a name="loc_282_13_282_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_13_282_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_282_15_282_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_15_282_18&#39;)"><span class="hl_vardecl"><span class="mpre">ir&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="GHC.IO.Buffer.html#loc_119_1_119_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_119_1_119_12&#39;)"><span class="hl_varref"><span class="mpre">readCharBuf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iraw</span></span><span class="mpre"> </span><a href="#loc_278_13_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_13_278_15&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre">
           case </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_282_13_282_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_13_282_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> of
             </span><a name="loc_284_14_284_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_14_284_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_284_14_284_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_14_284_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre"> -&gt; if </span><a href="GHC.IO.Encoding.Failure.html#loc_126_1_126_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Failure.html#loc_126_1_126_12&#39;)"><span class="hl_varref"><span class="mpre">isSurrogate</span></span></a><span class="mpre"> </span><a href="#loc_282_13_282_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_13_282_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> then </span><a href="#loc_274_7_274_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_7_274_11&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_128_23_128_38" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_128_23_128_38&#39;)"><span class="hl_conref"><span class="mpre">InvalidSequence</span></span></a><span class="mpre"> </span><a href="#loc_278_13_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_13_278_15&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> else do
                    </span><a href="GHC.IO.Buffer.html#loc_102_1_102_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_102_1_102_14&#39;)"><span class="hl_varref"><span class="mpre">writeWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> </span><a href="#loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">     (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_284_14_284_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_14_284_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">))
                    </span><a href="GHC.IO.Buffer.html#loc_102_1_102_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_102_1_102_14&#39;)"><span class="hl_varref"><span class="mpre">writeWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> (</span><a href="#loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_284_14_284_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_14_284_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
                    </span><a href="#loc_278_7_278_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_7_278_11&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_282_15_282_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_15_282_18&#39;)"><span class="hl_varref"><span class="mpre">ir&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; do
                    if </span><span class="hl_varref"><span class="mpre">os</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> then </span><a href="#loc_274_7_274_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_7_274_11&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_127_23_127_38" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_127_23_127_38&#39;)"><span class="hl_conref"><span class="mpre">OutputUnderflow</span></span></a><span class="mpre"> </span><a href="#loc_278_13_278_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_13_278_15&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> else do
                    let 
                         </span><a name="loc_291_26_291_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_26_291_28&#39;)"><span class="hl_vardecl"><span class="mpre">n1</span></span></a><span class="mpre"> = </span><a href="#loc_284_14_284_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_14_284_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre">
                         </span><a name="loc_292_26_292_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_26_292_28&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_291_26_291_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_26_291_28&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xD8</span></span><span class="mpre">)
                         </span><a name="loc_293_26_293_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_26_293_28&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_291_26_291_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_26_291_28&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">)
                         </span><a name="loc_294_26_294_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_26_294_28&#39;)"><span class="hl_vardecl"><span class="mpre">n2</span></span></a><span class="mpre"> = </span><a href="#loc_291_26_291_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_26_291_28&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3FF</span></span><span class="mpre">
                         </span><a name="loc_295_26_295_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_26_295_28&#39;)"><span class="hl_vardecl"><span class="mpre">c3</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_294_26_294_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_26_294_28&#39;)"><span class="hl_varref"><span class="mpre">n2</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDC</span></span><span class="mpre">)
                         </span><a name="loc_296_26_296_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_26_296_28&#39;)"><span class="hl_vardecl"><span class="mpre">c4</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_294_26_294_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_26_294_28&#39;)"><span class="hl_varref"><span class="mpre">n2</span></span></a><span class="mpre">
                    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
                    </span><a href="GHC.IO.Buffer.html#loc_102_1_102_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_102_1_102_14&#39;)"><span class="hl_varref"><span class="mpre">writeWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> </span><a href="#loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">     </span><a href="#loc_292_26_292_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_26_292_28&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre">
                    </span><a href="GHC.IO.Buffer.html#loc_102_1_102_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_102_1_102_14&#39;)"><span class="hl_varref"><span class="mpre">writeWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> (</span><a href="#loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_293_26_293_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_26_293_28&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">
                    </span><a href="GHC.IO.Buffer.html#loc_102_1_102_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_102_1_102_14&#39;)"><span class="hl_varref"><span class="mpre">writeWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> (</span><a href="#loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_295_26_295_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_26_295_28&#39;)"><span class="hl_varref"><span class="mpre">c3</span></span></a><span class="mpre">
                    </span><a href="GHC.IO.Buffer.html#loc_102_1_102_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_102_1_102_14&#39;)"><span class="hl_varref"><span class="mpre">writeWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> (</span><a href="#loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) </span><a href="#loc_296_26_296_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_296_26_296_28&#39;)"><span class="hl_varref"><span class="mpre">c4</span></span></a><span class="mpre">
                    </span><a href="#loc_278_7_278_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_7_278_11&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_282_15_282_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_15_282_18&#39;)"><span class="hl_varref"><span class="mpre">ir&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_278_17_278_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_17_278_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
    in
    </span><a href="#loc_278_7_278_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_7_278_11&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ir0</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ow0</span></span><span class="mpre">

</span><a href="#loc_307_1_307_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_15&#39;)"><span class="mpre">utf16le_encode</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">EncodeBuffer</span></span><span class="mpre">
</span><a name="loc_307_1_307_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_15&#39;)"><span class="hl_fundecl"><span class="mpre">utf16le_encode</span></span></a><span class="mpre">
  </span><span class="hl_specname"><span class="mpre">input</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 308, srcSpanStartColumn = 9, srcSpanEndLine = 308, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 308, srcSpanStartColumn = 15, srcSpanEndLine = 308, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanSta"><span class="mpre">Buffer{  bufRaw=iraw, bufL=ir0, bufR=iw,  bufSize=_  }</span></span><span class="mpre">
  </span><span class="hl_specname"><span class="mpre">output</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 309, srcSpanStartColumn = 10, srcSpanEndLine = 309, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 309, srcSpanStartColumn = 16, srcSpanEndLine = 309, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanSt"><span class="mpre">Buffer{ bufRaw=oraw, bufL=_,   bufR=ow0, bufSize=os }</span></span><span class="mpre">
 = let
      </span><a name="loc_311_7_311_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_7_311_11&#39;)"><span class="hl_fundecl"><span class="mpre">done</span></span></a><span class="mpre"> </span><a name="loc_311_12_311_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_12_311_15&#39;)"><span class="hl_vardecl"><span class="mpre">why</span></span></a><span class="mpre"> !</span><a name="loc_311_17_311_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_17_311_19&#39;)"><span class="hl_vardecl"><span class="mpre">ir</span></span></a><span class="mpre"> !</span><span class="hl_vardecl"><span class="mpre">ow</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_311_12_311_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_12_311_15&#39;)"><span class="hl_varref"><span class="mpre">why</span></span></a><span class="mpre">,
                                 if </span><a href="#loc_311_17_311_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_17_311_19&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iw</span></span><span class="mpre"> then </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 312, srcSpanStartColumn = 51, srcSpanEndLine = 312, srcSpanEndColumn = 74}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 312, srcSpanStartColumn = 56, srcSpanEndLine = 312, srcSpanEndColumn = 57},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">input{ bufL=0, bufR=0 }</span></span><span class="mpre">
                                             else </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 313, srcSpanStartColumn = 51, srcSpanEndLine = 313, srcSpanEndColumn = 67}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 313, srcSpanStartColumn = 56, srcSpanEndLine = 313, srcSpanEndColumn = 57},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">input{ bufL=ir }</span></span><span class="mpre">,
                                 </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 314, srcSpanStartColumn = 34, srcSpanEndLine = 314, srcSpanEndColumn = 51}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcSpanStartLine = 314, srcSpanStartColumn = 40, srcSpanEndLine = 314, srcSpanEndColumn = 41},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/GHC/IO/Encoding/UTF16.hs&quot;, srcS"><span class="mpre">output{ bufR=ow }</span></span><span class="mpre">)
      </span><a name="loc_315_7_315_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_7_315_11&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_vardecl"><span class="mpre">ir</span></span></a><span class="mpre"> !</span><a name="loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_vardecl"><span class="mpre">ow</span></span></a><span class="mpre">
        | </span><a href="#loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iw</span></span><span class="mpre">     =  </span><a href="#loc_311_7_311_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_7_311_11&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_125_23_125_37" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_125_23_125_37&#39;)"><span class="hl_conref"><span class="mpre">InputUnderflow</span></span></a><span class="mpre"> </span><a href="#loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">os</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">  =  </span><a href="#loc_311_7_311_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_7_311_11&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_127_23_127_38" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_127_23_127_38&#39;)"><span class="hl_conref"><span class="mpre">OutputUnderflow</span></span></a><span class="mpre"> </span><a href="#loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
           (</span><a name="loc_319_13_319_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_13_319_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_319_15_319_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_15_319_18&#39;)"><span class="hl_vardecl"><span class="mpre">ir&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="GHC.IO.Buffer.html#loc_119_1_119_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_119_1_119_12&#39;)"><span class="hl_varref"><span class="mpre">readCharBuf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">iraw</span></span><span class="mpre"> </span><a href="#loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre">
           case </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_319_13_319_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_13_319_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> of
             </span><a name="loc_321_14_321_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_14_321_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="#loc_321_14_321_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_14_321_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre"> -&gt; if </span><a href="GHC.IO.Encoding.Failure.html#loc_126_1_126_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Failure.html#loc_126_1_126_12&#39;)"><span class="hl_varref"><span class="mpre">isSurrogate</span></span></a><span class="mpre"> </span><a href="#loc_319_13_319_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_13_319_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> then </span><a href="#loc_311_7_311_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_7_311_11&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_128_23_128_38" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_128_23_128_38&#39;)"><span class="hl_conref"><span class="mpre">InvalidSequence</span></span></a><span class="mpre"> </span><a href="#loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> else do
                    </span><a href="GHC.IO.Buffer.html#loc_102_1_102_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_102_1_102_14&#39;)"><span class="hl_varref"><span class="mpre">writeWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> </span><a href="#loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">     (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_321_14_321_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_14_321_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
                    </span><a href="GHC.IO.Buffer.html#loc_102_1_102_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_102_1_102_14&#39;)"><span class="hl_varref"><span class="mpre">writeWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> (</span><a href="#loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_321_14_321_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_14_321_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">))
                    </span><a href="#loc_315_7_315_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_7_315_11&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_319_15_319_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_15_319_18&#39;)"><span class="hl_varref"><span class="mpre">ir&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt;
                    if </span><span class="hl_varref"><span class="mpre">os</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> then </span><a href="#loc_311_7_311_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_7_311_11&#39;)"><span class="hl_varref"><span class="mpre">done</span></span></a><span class="mpre"> </span><a href="GHC.IO.Encoding.Types.html#loc_127_23_127_38" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Encoding.Types.html#loc_127_23_127_38&#39;)"><span class="hl_conref"><span class="mpre">OutputUnderflow</span></span></a><span class="mpre"> </span><a href="#loc_315_13_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_13_315_15&#39;)"><span class="hl_varref"><span class="mpre">ir</span></span></a><span class="mpre"> </span><a href="#loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre"> else do
                    let 
                         </span><a name="loc_328_26_328_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_26_328_28&#39;)"><span class="hl_vardecl"><span class="mpre">n1</span></span></a><span class="mpre"> = </span><a href="#loc_321_14_321_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_14_321_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre">
                         </span><a name="loc_329_26_329_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_26_329_28&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_328_26_328_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_26_328_28&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xD8</span></span><span class="mpre">)
                         </span><a name="loc_330_26_330_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_26_330_28&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_328_26_328_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_26_328_28&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">)
                         </span><a name="loc_331_26_331_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_26_331_28&#39;)"><span class="hl_vardecl"><span class="mpre">n2</span></span></a><span class="mpre"> = </span><a href="#loc_328_26_328_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_26_328_28&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3FF</span></span><span class="mpre">
                         </span><a name="loc_332_26_332_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_26_332_28&#39;)"><span class="hl_vardecl"><span class="mpre">c3</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_331_26_331_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_26_331_28&#39;)"><span class="hl_varref"><span class="mpre">n2</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDC</span></span><span class="mpre">)
                         </span><a name="loc_333_26_333_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_26_333_28&#39;)"><span class="hl_vardecl"><span class="mpre">c4</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_331_26_331_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_26_331_28&#39;)"><span class="hl_varref"><span class="mpre">n2</span></span></a><span class="mpre">
                    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
                    </span><a href="GHC.IO.Buffer.html#loc_102_1_102_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_102_1_102_14&#39;)"><span class="hl_varref"><span class="mpre">writeWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> </span><a href="#loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="mpre">     </span><a href="#loc_330_26_330_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_26_330_28&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">
                    </span><a href="GHC.IO.Buffer.html#loc_102_1_102_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_102_1_102_14&#39;)"><span class="hl_varref"><span class="mpre">writeWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> (</span><a href="#loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_329_26_329_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_26_329_28&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre">
                    </span><a href="GHC.IO.Buffer.html#loc_102_1_102_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_102_1_102_14&#39;)"><span class="hl_varref"><span class="mpre">writeWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> (</span><a href="#loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_333_26_333_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_26_333_28&#39;)"><span class="hl_varref"><span class="mpre">c4</span></span></a><span class="mpre">
                    </span><a href="GHC.IO.Buffer.html#loc_102_1_102_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Buffer.html#loc_102_1_102_14&#39;)"><span class="hl_varref"><span class="mpre">writeWord8Buf</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oraw</span></span><span class="mpre"> (</span><a href="#loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) </span><a href="#loc_332_26_332_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_26_332_28&#39;)"><span class="hl_varref"><span class="mpre">c3</span></span></a><span class="mpre">
                    </span><a href="#loc_315_7_315_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_7_315_11&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_319_15_319_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_15_319_18&#39;)"><span class="hl_varref"><span class="mpre">ir&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_315_17_315_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_17_315_19&#39;)"><span class="hl_varref"><span class="mpre">ow</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
    in
    </span><a href="#loc_315_7_315_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_7_315_11&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ir0</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ow0</span></span><span class="mpre">

</span><a href="#loc_344_1_344_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_1_344_5&#39;)"><span class="mpre">chr2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_344_1_344_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_1_344_5&#39;)"><span class="hl_fundecl"><span class="mpre">chr2</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">W16#</span></span><span class="mpre"> </span><a name="loc_344_12_344_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_12_344_14&#39;)"><span class="hl_vardecl"><span class="mpre">a#</span></span></a><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">W16#</span></span><span class="mpre"> </span><a name="loc_344_22_344_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_22_344_24&#39;)"><span class="hl_vardecl"><span class="mpre">b#</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">C#</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">chr#</span></span><span class="mpre"> (</span><a href="#loc_348_8_348_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_8_348_14&#39;)"><span class="hl_varref"><span class="mpre">upper#</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+#</span></span><span class="mpre"> </span><a href="#loc_349_8_349_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_8_349_14&#39;)"><span class="hl_varref"><span class="mpre">lower#</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+#</span></span><span class="mpre"> 0x10000#))
    where
      !</span><a name="loc_346_8_346_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_8_346_10&#39;)"><span class="hl_vardecl"><span class="mpre">x#</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">word2Int#</span></span><span class="mpre"> </span><a href="#loc_344_12_344_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_12_344_14&#39;)"><span class="hl_varref"><span class="mpre">a#</span></span></a><span class="mpre">
      !</span><a name="loc_347_8_347_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_8_347_10&#39;)"><span class="hl_vardecl"><span class="mpre">y#</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">word2Int#</span></span><span class="mpre"> </span><a href="#loc_344_22_344_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_22_344_24&#39;)"><span class="hl_varref"><span class="mpre">b#</span></span></a><span class="mpre">
      !</span><a name="loc_348_8_348_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_8_348_14&#39;)"><span class="hl_vardecl"><span class="mpre">upper#</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">uncheckedIShiftL#</span></span><span class="mpre"> (</span><a href="#loc_346_8_346_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_8_346_10&#39;)"><span class="hl_varref"><span class="mpre">x#</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> 0xD800#) 10#
      !</span><a name="loc_349_8_349_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_8_349_14&#39;)"><span class="hl_vardecl"><span class="mpre">lower#</span></span></a><span class="mpre"> = </span><a href="#loc_347_8_347_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_8_347_10&#39;)"><span class="hl_varref"><span class="mpre">y#</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-#</span></span><span class="mpre"> 0xDC00#
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_344_1_344_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_1_344_5&#39;)"><span class="mpre">chr2</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_353_1_353_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_10&#39;)"><span class="mpre">validate1</span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_353_1_353_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_10&#39;)"><span class="hl_fundecl"><span class="mpre">validate1</span></span></a><span class="mpre"> </span><a name="loc_353_11_353_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_11_353_13&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> = (</span><a href="#loc_353_11_353_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_11_353_13&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_353_11_353_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_11_353_13&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xD800</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_353_11_353_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_11_353_13&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDFFF</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_353_1_353_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_10&#39;)"><span class="mpre">validate1</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_357_1_357_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_10&#39;)"><span class="mpre">validate2</span></a><span class="mpre">       ::  </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_357_1_357_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_10&#39;)"><span class="hl_fundecl"><span class="mpre">validate2</span></span></a><span class="mpre"> </span><a name="loc_357_11_357_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_11_357_13&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a name="loc_357_14_357_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_14_357_16&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><a href="#loc_357_11_357_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_11_357_13&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xD800</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_357_11_357_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_11_357_13&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDBFF</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
                  </span><a href="#loc_357_14_357_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_14_357_16&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDC00</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_357_14_357_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_14_357_16&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDFFF</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_357_1_357_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_10&#39;)"><span class="mpre">validate2</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span></div></body></html>