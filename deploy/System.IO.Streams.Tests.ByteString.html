<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}

module System.IO.Streams.Tests.ByteString (tests) where

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/ByteString.hs&quot;, srcSpanStartLine = 6, srcSpanStartColumn = 18, srcSpanEndLine = 6, srcSpanEndColumn = 36}, srcInfoPoints = []}) &quot;Control.Concurrent&quot;"><span class="mpre">Control.Concurrent</span></span><span class="mpre">
import           Control.Monad
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/ByteString.hs&quot;, srcSpanStartLine = 8, srcSpanStartColumn = 18, srcSpanEndLine = 8, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre">                (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/ByteString.hs&quot;, srcSpanStartLine = 9, srcSpanStartColumn = 18, srcSpanEndLine = 9, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre">                as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/ByteString.hs&quot;, srcSpanStartLine = 10, srcSpanStartColumn = 18, srcSpanEndLine = 10, srcSpanEndColumn = 44}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy.Char8&quot;"><span class="mpre">Data.ByteString.Lazy.Char8</span></span><span class="mpre">           as L
import           Data.List                            hiding (</span><a href="Data.List.html#loc_1044_1_1044_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1044_1_1044_6&#39;)"><span class="mpre">lines</span></a><span class="mpre">,
                                                       takeWhile, </span><a href="Data.List.html#loc_1060_1_1060_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1060_1_1060_8&#39;)"><span class="mpre">unlines</span></a><span class="mpre">,
                                                       </span><a href="Data.List.html#loc_1081_1_1081_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1081_1_1081_8&#39;)"><span class="mpre">unwords</span></a><span class="mpre">, </span><a href="Data.List.html#loc_1071_1_1071_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1071_1_1071_6&#39;)"><span class="mpre">words</span></a><span class="mpre">)
import           Data.Maybe                           (</span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="mpre">isJust</span></a><span class="mpre">)
import           Data.Monoid
import           Prelude                              hiding (</span><a href="Data.List.html#loc_1044_1_1044_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1044_1_1044_6&#39;)"><span class="mpre">lines</span></a><span class="mpre">, </span><a href="Text.Read.html#loc_91_1_91_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Read.html#loc_91_1_91_5&#39;)"><span class="mpre">read</span></a><span class="mpre">,
                                                       takeWhile, </span><a href="Data.List.html#loc_1060_1_1060_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1060_1_1060_8&#39;)"><span class="mpre">unlines</span></a><span class="mpre">,
                                                       </span><a href="Data.List.html#loc_1081_1_1081_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1081_1_1081_8&#39;)"><span class="mpre">unwords</span></a><span class="mpre">, </span><a href="Data.List.html#loc_1081_1_1081_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1081_1_1081_8&#39;)"><span class="mpre">unwords</span></a><span class="mpre">,
                                                       </span><a href="Data.List.html#loc_1071_1_1071_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1071_1_1071_6&#39;)"><span class="mpre">words</span></a><span class="mpre">)
import qualified Prelude
import           System.IO.Streams                    hiding (</span><a href="System.IO.Streams.Combinators.html#loc_475_1_475_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Combinators.html#loc_475_1_475_7&#39;)"><span class="mpre">filter</span></a><span class="mpre">,
                                                       </span><a href="System.IO.Streams.Combinators.html#loc_502_1_502_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Combinators.html#loc_502_1_502_12&#39;)"><span class="mpre">intersperse</span></a><span class="mpre">, </span><a href="System.IO.Streams.Combinators.html#loc_365_1_365_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Combinators.html#loc_365_1_365_6&#39;)"><span class="mpre">mapM_</span></a><span class="mpre">)
import           System.IO.Streams.Tests.Common
import           System.Timeout
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/ByteString.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 18, srcSpanEndLine = 25, srcSpanEndColumn = 32}, srcInfoPoints = []}) &quot;Test.Framework&quot;"><span class="mpre">Test.Framework</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/ByteString.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 18, srcSpanEndLine = 26, srcSpanEndColumn = 48}, srcInfoPoints = []}) &quot;Test.Framework.Providers.HUnit&quot;"><span class="mpre">Test.Framework.Providers.HUnit</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/ByteString.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 18, srcSpanEndLine = 27, srcSpanEndColumn = 54}, srcInfoPoints = []}) &quot;Test.Framework.Providers.QuickCheck2&quot;"><span class="mpre">Test.Framework.Providers.QuickCheck2</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/ByteString.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 18, srcSpanEndLine = 28, srcSpanEndColumn = 28}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">                           hiding (Test)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/ByteString.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 18, srcSpanEndLine = 29, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Test.QuickCheck&quot;"><span class="mpre">Test.QuickCheck</span></span><span class="mpre">                      hiding (output)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/ByteString.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 18, srcSpanEndLine = 30, srcSpanEndColumn = 41}, srcInfoPoints = []}) &quot;Test.QuickCheck.Monadic&quot;"><span class="mpre">Test.QuickCheck.Monadic</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_34_1_34_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_6&#39;)"><span class="mpre">tests</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">]
</span><a name="loc_34_1_34_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = [ </span><a href="#loc_417_1_417_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_15&#39;)"><span class="hl_varref"><span class="mpre">testBoyerMoore</span></span></a><span class="mpre">
        , </span><a href="#loc_521_1_521_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_1_521_16&#39;)"><span class="hl_varref"><span class="mpre">testBoyerMoore2</span></span></a><span class="mpre">
        , </span><a href="#loc_65_1_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_15&#39;)"><span class="hl_varref"><span class="mpre">testCountInput</span></span></a><span class="mpre">
        , </span><a href="#loc_88_1_88_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_16&#39;)"><span class="hl_varref"><span class="mpre">testCountInput2</span></span></a><span class="mpre">
        , </span><a href="#loc_109_1_109_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_16&#39;)"><span class="hl_varref"><span class="mpre">testCountOutput</span></span></a><span class="mpre">
        , </span><a href="#loc_382_1_382_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_1_382_19&#39;)"><span class="hl_varref"><span class="mpre">testThrowIfTooSlow</span></span></a><span class="mpre">
        , </span><a href="#loc_579_1_579_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_579_1_579_16&#39;)"><span class="hl_varref"><span class="mpre">testReadExactly</span></span></a><span class="mpre">
        , </span><a href="#loc_606_1_606_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_1_606_14&#39;)"><span class="hl_varref"><span class="mpre">testTakeWhile</span></span></a><span class="mpre">
        , </span><a href="#loc_130_1_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_14&#39;)"><span class="hl_varref"><span class="mpre">testTakeBytes</span></span></a><span class="mpre">
        , </span><a href="#loc_150_1_150_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_15&#39;)"><span class="hl_varref"><span class="mpre">testTakeBytes2</span></span></a><span class="mpre">
        , </span><a href="#loc_177_1_177_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_15&#39;)"><span class="hl_varref"><span class="mpre">testTakeBytes3</span></span></a><span class="mpre">
        , </span><a href="#loc_188_1_188_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_15&#39;)"><span class="hl_varref"><span class="mpre">testTakeBytes4</span></span></a><span class="mpre">
        , </span><a href="#loc_197_1_197_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_16&#39;)"><span class="hl_varref"><span class="mpre">testTakeExactly</span></span></a><span class="mpre">
        , </span><a href="#loc_217_1_217_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_17&#39;)"><span class="hl_varref"><span class="mpre">testTakeExactly2</span></span></a><span class="mpre">
        , </span><a href="#loc_231_1_231_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_1_231_17&#39;)"><span class="hl_varref"><span class="mpre">testTakeExactly3</span></span></a><span class="mpre">
        , </span><a href="#loc_238_1_238_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_1_238_28&#39;)"><span class="hl_varref"><span class="mpre">testThrowIfProducesMoreThan</span></span></a><span class="mpre">
        , </span><a href="#loc_255_1_255_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_29&#39;)"><span class="hl_varref"><span class="mpre">testThrowIfProducesMoreThan2</span></span></a><span class="mpre">
        , </span><a href="#loc_281_1_281_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_1_281_29&#39;)"><span class="hl_varref"><span class="mpre">testThrowIfProducesMoreThan3</span></span></a><span class="mpre">
        , </span><a href="#loc_294_1_294_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_1_294_28&#39;)"><span class="hl_varref"><span class="mpre">testThrowIfConsumesMoreThan</span></span></a><span class="mpre">
        , </span><a href="#loc_313_1_313_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_1_313_29&#39;)"><span class="hl_varref"><span class="mpre">testThrowIfConsumesMoreThan2</span></span></a><span class="mpre">
        , </span><a href="#loc_647_1_647_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_1_647_13&#39;)"><span class="hl_varref"><span class="mpre">testTrivials</span></span></a><span class="mpre">
        , </span><a href="#loc_562_1_562_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_1_562_24&#39;)"><span class="hl_varref"><span class="mpre">testWriteLazyByteString</span></span></a><span class="mpre">
        , </span><a href="#loc_348_1_348_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_14&#39;)"><span class="hl_varref"><span class="mpre">testGiveBytes</span></span></a><span class="mpre">
        , </span><a href="#loc_335_1_335_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_1_335_16&#39;)"><span class="hl_varref"><span class="mpre">testGiveExactly</span></span></a><span class="mpre">
        , </span><a href="#loc_624_1_624_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_1_624_10&#39;)"><span class="hl_varref"><span class="mpre">testLines</span></span></a><span class="mpre">
        , </span><a href="#loc_636_1_636_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_636_1_636_10&#39;)"><span class="hl_varref"><span class="mpre">testWords</span></span></a><span class="mpre">
        ]


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_65_1_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_15&#39;)"><span class="mpre">testCountInput</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_65_1_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_15&#39;)"><span class="hl_vardecl"><span class="mpre">testCountInput</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/countInput&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                 </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                 </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_70_5_70_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_5_70_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_70_5_70_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_5_70_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_70_5_70_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_5_70_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_70_10_70_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_10_70_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_71_9_71_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_11&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">          &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><a href="#loc_70_10_70_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_10_70_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
        (</span><a name="loc_72_10_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_13&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre">, </span><a name="loc_72_15_72_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_15_72_19&#39;)"><span class="hl_vardecl"><span class="mpre">grab</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_138_1_138_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_138_1_138_11&#39;)"><span class="hl_varref"><span class="mpre">countInput</span></span></a><span class="mpre"> </span><a href="#loc_71_9_71_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

        </span><a name="loc_74_9_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_72_10_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_13&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">
        </span><a name="loc_75_9_75_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_72_15_72_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_15_72_19&#39;)"><span class="hl_varref"><span class="mpre">grab</span></span></a><span class="mpre">

        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;countInput1&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_70_10_70_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_10_70_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_75_9_75_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;countInput2&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_74_9_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_75_9_75_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_9_75_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

        </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_72_10_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_13&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;eof&quot;</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
        </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre"> </span><a href="#loc_72_10_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_13&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">
        </span><a href="System.IO.Streams.Internal.html#loc_161_1_161_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_161_1_161_5&#39;)"><span class="hl_varref"><span class="mpre">peek</span></span></a><span class="mpre"> </span><a href="#loc_71_9_71_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;peek&quot;</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">)
        </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_72_10_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_10_72_13&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;read&quot;</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_88_1_88_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_16&#39;)"><span class="mpre">testCountInput2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_88_1_88_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_16&#39;)"><span class="hl_vardecl"><span class="mpre">testCountInput2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/countInput2&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_89_5_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_7&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">              &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><a href="#loc_103_5_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_8&#39;)"><span class="hl_varref"><span class="mpre">txt</span></span></a><span class="mpre">
    (</span><a name="loc_90_6_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_9&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre">, </span><a name="loc_90_11_90_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_19&#39;)"><span class="hl_vardecl"><span class="mpre">getCount</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_138_1_138_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_138_1_138_11&#39;)"><span class="hl_varref"><span class="mpre">countInput</span></span></a><span class="mpre"> </span><a href="#loc_89_5_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
    (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_91_11_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)        &lt;- </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_90_6_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_9&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">

    </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;0, &quot;</span></span><span class="mpre"> </span><a href="#loc_90_6_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_9&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">
    </span><a href="#loc_90_11_90_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_19&#39;)"><span class="hl_varref"><span class="mpre">getCount</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;count1&quot;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">
    </span><a href="System.IO.Streams.Internal.html#loc_161_1_161_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_161_1_161_5&#39;)"><span class="hl_varref"><span class="mpre">peek</span></span></a><span class="mpre"> </span><a href="#loc_89_5_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;pushback propagates&quot;</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;0, &quot;</span></span><span class="mpre">)

    (</span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_91_11_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_90_6_90_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_9&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;output&quot;</span></span><span class="mpre"> </span><a href="#loc_104_5_104_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_19&#39;)"><span class="hl_varref"><span class="mpre">expectedOutput</span></span></a><span class="mpre">

    </span><a href="#loc_90_11_90_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_19&#39;)"><span class="hl_varref"><span class="mpre">getCount</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;count2&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_103_5_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_8&#39;)"><span class="hl_varref"><span class="mpre">txt</span></span></a><span class="mpre">)

  where
    </span><a name="loc_103_5_103_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_8&#39;)"><span class="hl_vardecl"><span class="mpre">txt</span></span></a><span class="mpre">            = [</span><span class="hl_string"><span class="mpre">&quot;testing &quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;1, &quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;2, &quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;3&quot;</span></span><span class="mpre">]
    </span><a name="loc_104_5_104_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_19&#39;)"><span class="hl_vardecl"><span class="mpre">expectedOutput</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;testing 0, 1, 2, 3&quot;</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_109_1_109_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_16&#39;)"><span class="mpre">testCountOutput</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_109_1_109_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_16&#39;)"><span class="hl_vardecl"><span class="mpre">testCountOutput</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/countOutput&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                  </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                  </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_114_5_114_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_114_5_114_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_114_5_114_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_114_10_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_10_114_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_115_9_115_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_11&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">            &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><a href="#loc_114_10_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_10_114_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
        (</span><a name="loc_116_10_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_10_116_13&#39;)"><span class="hl_vardecl"><span class="mpre">os0</span></span></a><span class="mpre">, </span><a name="loc_116_15_116_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_15_116_19&#39;)"><span class="hl_vardecl"><span class="mpre">grab</span></span></a><span class="mpre">)   &lt;- </span><a href="System.IO.Streams.List.html#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">listOutputStream</span></span></a><span class="mpre">
        (</span><a name="loc_117_10_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_10_117_12&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">, </span><a name="loc_117_14_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_14_117_21&#39;)"><span class="hl_vardecl"><span class="mpre">grabLen</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_170_1_170_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_170_1_170_12&#39;)"><span class="hl_varref"><span class="mpre">countOutput</span></span></a><span class="mpre"> </span><a href="#loc_116_10_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_10_116_13&#39;)"><span class="hl_varref"><span class="mpre">os0</span></span></a><span class="mpre">

        </span><a href="System.IO.Streams.Internal.html#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_188_1_188_8&#39;)"><span class="hl_varref"><span class="mpre">connect</span></span></a><span class="mpre"> </span><a href="#loc_115_9_115_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><a href="#loc_117_10_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_10_117_12&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">

        </span><a name="loc_121_9_121_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_11&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_116_15_116_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_15_116_19&#39;)"><span class="hl_varref"><span class="mpre">grab</span></span></a><span class="mpre">
        </span><a name="loc_122_9_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_117_14_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_14_117_21&#39;)"><span class="hl_varref"><span class="mpre">grabLen</span></span></a><span class="mpre">

        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;countOutput1&quot;</span></span><span class="mpre"> </span><a href="#loc_114_10_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_10_114_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_121_9_121_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_9_121_11&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;countOutput2&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_114_10_114_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_10_114_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_122_9_122_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_130_1_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_14&#39;)"><span class="mpre">testTakeBytes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_130_1_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_14&#39;)"><span class="hl_vardecl"><span class="mpre">testTakeBytes</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/takeBytes&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_135_5_135_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_135_5_135_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_135_5_135_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_135_10_135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_10_135_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">pre</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_135_10_135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_10_135_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> (do
        let (</span><a name="loc_136_14_136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_14_136_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_136_16_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_16_136_17&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">L.splitAt</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_135_10_135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_10_135_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

        </span><a name="loc_138_9_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_11&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_135_10_135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_10_135_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
        </span><a name="loc_139_9_139_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_12&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_211_1_211_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_211_1_211_10&#39;)"><span class="hl_varref"><span class="mpre">takeBytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_138_9_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

        </span><a name="loc_141_9_141_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_9_141_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">   &lt;- </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_139_9_139_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_9_139_12&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">
        </span><a name="loc_142_9_142_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">   &lt;- </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_138_9_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;take1&quot;</span></span><span class="mpre"> </span><a href="#loc_136_14_136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_14_136_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_141_9_141_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_9_141_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;take2&quot;</span></span><span class="mpre"> </span><a href="#loc_136_16_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_16_136_17&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_142_9_142_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
        )

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_150_1_150_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_15&#39;)"><span class="mpre">testTakeBytes2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_150_1_150_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_15&#39;)"><span class="hl_vardecl"><span class="mpre">testTakeBytes2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/takeBytes2&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                 </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                 </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_155_5_155_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_5_155_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_155_5_155_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_5_155_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_155_5_155_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_5_155_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_155_10_155_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_10_155_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_156_9_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_11&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_155_10_155_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_10_155_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
        </span><a name="loc_157_9_157_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_12&#39;)"><span class="hl_vardecl"><span class="mpre">is2</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_211_1_211_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_211_1_211_10&#39;)"><span class="hl_varref"><span class="mpre">takeBytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_156_9_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

        </span><a name="loc_159_9_159_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">   &lt;- </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_157_9_157_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_12&#39;)"><span class="hl_varref"><span class="mpre">is2</span></span></a><span class="mpre">
        </span><a name="loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">   &lt;- </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_156_9_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;takeBytes3&quot;</span></span><span class="mpre"> [] </span><a href="#loc_159_9_159_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;takeBytes4&quot;</span></span><span class="mpre"> </span><a href="#loc_155_10_155_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_10_155_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_160_9_160_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- Test that pushback makes it back to the source inputstream</span></span><span class="mpre">
        </span><a name="loc_166_9_166_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_12&#39;)"><span class="hl_vardecl"><span class="mpre">is3</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_211_1_211_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_211_1_211_10&#39;)"><span class="hl_varref"><span class="mpre">takeBytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">20</span></span><span class="mpre"> </span><a href="#loc_156_9_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
        </span><a href="Control.Monad.html#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_195_1_195_5&#39;)"><span class="hl_varref"><span class="mpre">void</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_166_9_166_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_12&#39;)"><span class="hl_varref"><span class="mpre">is3</span></span></a><span class="mpre">
        </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok2&quot;</span></span><span class="mpre"> </span><a href="#loc_166_9_166_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_12&#39;)"><span class="hl_varref"><span class="mpre">is3</span></span></a><span class="mpre">
        </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok1&quot;</span></span><span class="mpre"> </span><a href="#loc_166_9_166_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_12&#39;)"><span class="hl_varref"><span class="mpre">is3</span></span></a><span class="mpre">

        </span><a name="loc_171_9_171_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_9_171_10&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">   &lt;- </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_156_9_156_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_9_156_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;takeBytes5&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;ok1&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;ok2&quot;</span></span><span class="mpre">] </span><a href="#loc_171_9_171_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_9_171_10&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_177_1_177_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_15&#39;)"><span class="mpre">testTakeBytes3</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_177_1_177_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_15&#39;)"><span class="hl_vardecl"><span class="mpre">testTakeBytes3</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/takeBytes3&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_178_5_178_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_5_178_7&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_105_1_105_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_105_1_105_19&#39;)"><span class="hl_varref"><span class="mpre">fromLazyByteString</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;The&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;quick&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;brown&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;fox&quot;</span></span><span class="mpre">]) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
          </span><a href="System.IO.Streams.ByteString.html#loc_211_1_211_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_211_1_211_10&#39;)"><span class="hl_varref"><span class="mpre">takeBytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre">
    _  &lt;- </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_178_5_178_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_5_178_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
    </span><a name="loc_181_5_181_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_5_181_6&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_178_5_178_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_5_178_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;takeBytes3&quot;</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="#loc_181_5_181_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_5_181_6&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_188_1_188_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_15&#39;)"><span class="mpre">testTakeBytes4</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_188_1_188_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_15&#39;)"><span class="hl_vardecl"><span class="mpre">testTakeBytes4</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/takeBytes4&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_189_5_189_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_5_189_7&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="hl_varref"><span class="mpre">makeInputStream</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">threadDelay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">20000000</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">)
          </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.ByteString.html#loc_211_1_211_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_211_1_211_10&#39;)"><span class="hl_varref"><span class="mpre">takeBytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><a name="loc_191_5_191_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_5_191_7&#39;)"><span class="hl_vardecl"><span class="mpre">mb</span></span></a><span class="mpre">  &lt;- </span><a href="System.Timeout.html#loc_79_1_79_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Timeout.html#loc_79_1_79_8&#39;)"><span class="hl_varref"><span class="mpre">timeout</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">100000</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_189_5_189_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_5_189_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">assertBool</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;takeBytes4&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> </span><a href="#loc_191_5_191_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_5_191_7&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_197_1_197_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_16&#39;)"><span class="mpre">testTakeExactly</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_197_1_197_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_16&#39;)"><span class="hl_vardecl"><span class="mpre">testTakeExactly</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/takeExactly&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_202_5_202_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_202_5_202_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_202_5_202_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_202_10_202_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_10_202_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">pre</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_202_10_202_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_10_202_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> (do
        let (</span><a name="loc_203_14_203_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_14_203_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_203_16_203_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_16_203_17&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">L.splitAt</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_202_10_202_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_10_202_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

        </span><a name="loc_205_9_205_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_11&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_202_10_202_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_10_202_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
        </span><a name="loc_206_9_206_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_12&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_221_1_221_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_221_1_221_12&#39;)"><span class="hl_varref"><span class="mpre">takeExactly</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_205_9_205_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

        </span><a name="loc_208_9_208_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_9_208_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">   &lt;- </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_206_9_206_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_9_206_12&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">
        </span><a name="loc_209_9_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_9_209_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">   &lt;- </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_205_9_205_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_9_205_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;take1&quot;</span></span><span class="mpre"> </span><a href="#loc_203_14_203_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_14_203_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_208_9_208_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_9_208_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;take2&quot;</span></span><span class="mpre"> </span><a href="#loc_203_16_203_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_16_203_17&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_209_9_209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_9_209_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
        )

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_217_1_217_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_17&#39;)"><span class="mpre">testTakeExactly2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_217_1_217_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_17&#39;)"><span class="hl_vardecl"><span class="mpre">testTakeExactly2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/takeExactly2&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_222_5_222_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_5_222_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_222_5_222_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_5_222_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_222_5_222_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_5_222_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_222_10_222_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_10_222_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">pre</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_222_10_222_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_10_222_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> (do
        </span><a name="loc_223_9_223_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_9_223_11&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_222_10_222_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_10_222_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
        </span><a name="loc_224_9_224_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_9_224_12&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_221_1_221_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_221_1_221_12&#39;)"><span class="hl_varref"><span class="mpre">takeExactly</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><a href="#loc_223_9_223_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_9_223_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

        </span><a href="System.IO.Streams.Tests.Common.html#loc_99_1_99_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_99_1_99_17&#39;)"><span class="hl_varref"><span class="mpre">expectExceptionH</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_224_9_224_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_9_224_12&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">
        )

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_231_1_231_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_1_231_17&#39;)"><span class="mpre">testTakeExactly3</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_231_1_231_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_1_231_17&#39;)"><span class="hl_vardecl"><span class="mpre">testTakeExactly3</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/takeExactly3&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_232_5_232_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_5_232_7&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;one&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;two&quot;</span></span><span class="mpre">]
    </span><a name="loc_233_5_233_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_5_233_8&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_221_1_221_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_221_1_221_12&#39;)"><span class="hl_varref"><span class="mpre">takeExactly</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> </span><a href="#loc_232_5_232_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_5_232_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
    </span><a href="System.IO.Streams.Tests.Common.html#loc_99_1_99_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_99_1_99_17&#39;)"><span class="hl_varref"><span class="mpre">expectExceptionH</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_233_5_233_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_5_233_8&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_238_1_238_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_1_238_28&#39;)"><span class="mpre">testThrowIfProducesMoreThan</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_238_1_238_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_1_238_28&#39;)"><span class="hl_vardecl"><span class="mpre">testThrowIfProducesMoreThan</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/throwIfProducesMoreThan&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_244_5_244_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_5_244_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">

  where
    </span><a href="#loc_244_5_244_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_5_244_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_244_5_244_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_5_244_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_244_10_244_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_10_244_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = do
        </span><span class="hl_varref"><span class="mpre">pre</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_244_10_244_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_10_244_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">)

        </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><a name="loc_248_13_248_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_13_248_15&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_244_10_244_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_10_244_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
            </span><a name="loc_249_13_249_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_13_249_16&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_475_1_475_24" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_475_1_475_24&#39;)"><span class="hl_varref"><span class="mpre">throwIfProducesMoreThan</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_248_13_248_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_13_248_15&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
            </span><a href="System.IO.Streams.Tests.Common.html#loc_99_1_99_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_99_1_99_17&#39;)"><span class="hl_varref"><span class="mpre">expectExceptionH</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_249_13_249_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_13_249_16&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_255_1_255_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_29&#39;)"><span class="mpre">testThrowIfProducesMoreThan2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_255_1_255_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_1_255_29&#39;)"><span class="hl_vardecl"><span class="mpre">testThrowIfProducesMoreThan2</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/throwIfProducesMoreThan2&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_261_5_261_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_5_261_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">

  where
    </span><a href="#loc_261_5_261_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_5_261_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_261_5_261_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_5_261_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_261_10_261_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_10_261_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = do
        let </span><a name="loc_262_13_262_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_13_262_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_261_10_261_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_10_261_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

        </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><a name="loc_265_13_265_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_13_265_15&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_261_10_261_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_10_261_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
            </span><a name="loc_266_13_266_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_13_266_16&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_475_1_475_24" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_475_1_475_24&#39;)"><span class="hl_varref"><span class="mpre">throwIfProducesMoreThan</span></span></a><span class="mpre"> (</span><a href="#loc_262_13_262_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_13_262_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_265_13_265_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_13_265_15&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
            </span><a name="loc_267_13_267_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_13_267_15&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre">  &lt;- </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_266_13_266_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_13_266_16&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;throwIfProducesMoreThan2&quot;</span></span><span class="mpre"> </span><a href="#loc_261_10_261_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_10_261_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_267_13_267_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_13_267_15&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">

            </span><a name="loc_270_13_270_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_13_270_14&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">   &lt;- </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_266_13_266_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_13_266_16&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;throwIfProducesMoreThan2-2&quot;</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="#loc_270_13_270_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_270_13_270_14&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

            </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok2&quot;</span></span><span class="mpre"> </span><a href="#loc_266_13_266_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_13_266_16&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">
            </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok1&quot;</span></span><span class="mpre"> </span><a href="#loc_266_13_266_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_13_266_16&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">
            </span><a name="loc_275_13_275_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_13_275_14&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">   &lt;- </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_265_13_265_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_13_265_15&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;throwIfProducesMoreThan2-3&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;ok1&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;ok2&quot;</span></span><span class="mpre">] </span><a href="#loc_275_13_275_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_13_275_14&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_281_1_281_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_1_281_29&#39;)"><span class="mpre">testThrowIfProducesMoreThan3</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_281_1_281_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_1_281_29&#39;)"><span class="hl_vardecl"><span class="mpre">testThrowIfProducesMoreThan3</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/throwIfProducesMoreThan3&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_283_9_283_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_9_283_11&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;lo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;ngstring&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.ByteString.html#loc_475_1_475_24" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_475_1_475_24&#39;)"><span class="hl_varref"><span class="mpre">throwIfProducesMoreThan</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">
        </span><a name="loc_284_9_284_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_9_284_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_516_1_516_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_516_1_516_12&#39;)"><span class="hl_varref"><span class="mpre">readExactly</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_283_9_283_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_9_283_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;throwIfProducesMoreThan split&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;long&quot;</span></span><span class="mpre"> </span><a href="#loc_284_9_284_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_284_9_284_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

        </span><a name="loc_287_9_287_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_9_287_10&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.ByteString.html#loc_475_1_475_24" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_475_1_475_24&#39;)"><span class="hl_varref"><span class="mpre">throwIfProducesMoreThan</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
             </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;throwIfProducesMoreThan3&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">] </span><a href="#loc_287_9_287_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_9_287_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_294_1_294_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_1_294_28&#39;)"><span class="mpre">testThrowIfConsumesMoreThan</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_294_1_294_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_1_294_28&#39;)"><span class="hl_vardecl"><span class="mpre">testThrowIfConsumesMoreThan</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/throwIfConsumesMoreThan&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_300_5_300_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_5_300_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_300_5_300_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_5_300_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_300_5_300_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_5_300_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_300_10_300_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_10_300_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = do
        let </span><a name="loc_301_13_301_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_13_301_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_300_10_300_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_10_300_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">pre</span></span><span class="mpre"> (</span><a href="#loc_301_13_301_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_13_301_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
        </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
             </span><a name="loc_304_14_304_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_14_304_16&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">      &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_300_10_300_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_10_300_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
             (</span><a name="loc_305_15_305_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_15_305_17&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">, _) &lt;- </span><a href="System.IO.Streams.List.html#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">listOutputStream</span></span></a><span class="mpre">
             </span><a name="loc_306_14_306_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_14_306_17&#39;)"><span class="hl_vardecl"><span class="mpre">os&#39;</span></span></a><span class="mpre">     &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_660_1_660_24" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_660_1_660_24&#39;)"><span class="hl_varref"><span class="mpre">throwIfConsumesMoreThan</span></span></a><span class="mpre"> (</span><a href="#loc_301_13_301_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_13_301_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_305_15_305_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_15_305_17&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">

             </span><a href="System.IO.Streams.Tests.Common.html#loc_99_1_99_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_99_1_99_17&#39;)"><span class="hl_varref"><span class="mpre">expectExceptionH</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_188_1_188_8&#39;)"><span class="hl_varref"><span class="mpre">connect</span></span></a><span class="mpre"> </span><a href="#loc_304_14_304_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_14_304_16&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><a href="#loc_306_14_306_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_14_306_17&#39;)"><span class="hl_varref"><span class="mpre">os&#39;</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_313_1_313_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_1_313_29&#39;)"><span class="mpre">testThrowIfConsumesMoreThan2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_313_1_313_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_1_313_29&#39;)"><span class="hl_vardecl"><span class="mpre">testThrowIfConsumesMoreThan2</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/throwIfConsumesMoreThan2&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_319_5_319_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_5_319_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_319_5_319_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_5_319_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_319_5_319_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_5_319_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_319_10_319_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_10_319_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = do
        let </span><a name="loc_320_13_320_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_13_320_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_319_10_319_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_10_319_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

        </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
             </span><a name="loc_323_14_323_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_14_323_16&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">         &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_319_10_319_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_10_319_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
             (</span><a name="loc_324_15_324_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_15_324_17&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">, </span><a name="loc_324_19_324_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_19_324_23&#39;)"><span class="hl_vardecl"><span class="mpre">grab</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.List.html#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">listOutputStream</span></span></a><span class="mpre">
             </span><a name="loc_325_14_325_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_14_325_17&#39;)"><span class="hl_vardecl"><span class="mpre">os&#39;</span></span></a><span class="mpre">        &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_660_1_660_24" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_660_1_660_24&#39;)"><span class="hl_varref"><span class="mpre">throwIfConsumesMoreThan</span></span></a><span class="mpre"> </span><a href="#loc_320_13_320_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_13_320_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_324_15_324_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_15_324_17&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">

             </span><a href="System.IO.Streams.Internal.html#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_188_1_188_8&#39;)"><span class="hl_varref"><span class="mpre">connect</span></span></a><span class="mpre"> </span><a href="#loc_323_14_323_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_14_323_16&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><a href="#loc_325_14_325_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_14_325_17&#39;)"><span class="hl_varref"><span class="mpre">os&#39;</span></span></a><span class="mpre">

             </span><a name="loc_329_14_329_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_14_329_16&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_324_19_324_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_19_324_23&#39;)"><span class="hl_varref"><span class="mpre">grab</span></span></a><span class="mpre">
             </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;throwIfConsumesMoreThan&quot;</span></span><span class="mpre"> </span><a href="#loc_319_10_319_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_10_319_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_329_14_329_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_14_329_16&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_335_1_335_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_1_335_16&#39;)"><span class="mpre">testGiveExactly</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_335_1_335_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_1_335_16&#39;)"><span class="hl_vardecl"><span class="mpre">testGiveExactly</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/giveExactly&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="#loc_341_5_341_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_5_341_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">]
    </span><a href="System.IO.Streams.Tests.Common.html#loc_99_1_99_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_99_1_99_17&#39;)"><span class="hl_varref"><span class="mpre">expectExceptionH</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_341_5_341_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_5_341_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    </span><a href="System.IO.Streams.Tests.Common.html#loc_99_1_99_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_99_1_99_17&#39;)"><span class="hl_varref"><span class="mpre">expectExceptionH</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_341_5_341_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_5_341_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">

  where
    </span><a name="loc_341_5_341_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_5_341_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_341_7_341_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_7_341_8&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = do
      </span><a name="loc_342_7_342_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_7_342_9&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_99_1_99_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_99_1_99_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">
      </span><a href="System.IO.Streams.List.html#loc_109_1_109_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_109_1_109_13&#39;)"><span class="hl_varref"><span class="mpre">outputToList</span></span></a><span class="mpre"> (</span><a href="System.IO.Streams.ByteString.html#loc_617_1_617_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_617_1_617_12&#39;)"><span class="hl_varref"><span class="mpre">giveExactly</span></span></a><span class="mpre"> </span><a href="#loc_341_7_341_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_7_341_8&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_180_3_180_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_180_3_180_6&#39;)"><span class="hl_infix"><span class="mpre">&gt;=&gt;</span></span></a><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_188_1_188_8&#39;)"><span class="hl_varref"><span class="mpre">connect</span></span></a><span class="mpre"> </span><a href="#loc_342_7_342_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_7_342_9&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_348_1_348_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_14&#39;)"><span class="mpre">testGiveBytes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_348_1_348_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_1_348_14&#39;)"><span class="hl_vardecl"><span class="mpre">testGiveBytes</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/giveBytes&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_353_5_353_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_5_353_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_353_5_353_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_5_353_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_353_5_353_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_5_353_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_353_10_353_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_10_353_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = do
        </span><span class="hl_varref"><span class="mpre">pre</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_353_10_353_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_10_353_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">)
        let </span><a name="loc_355_13_355_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_13_355_14&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_353_10_353_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_10_353_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

        </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><a name="loc_358_13_358_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_13_358_15&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">         &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_353_10_353_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_10_353_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
            (</span><a name="loc_359_14_359_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_14_359_16&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">, </span><a name="loc_359_18_359_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_18_359_22&#39;)"><span class="hl_vardecl"><span class="mpre">grab</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.List.html#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">listOutputStream</span></span></a><span class="mpre">
            </span><a name="loc_360_13_360_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_13_360_16&#39;)"><span class="hl_vardecl"><span class="mpre">os&#39;</span></span></a><span class="mpre">        &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_578_1_578_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_578_1_578_10&#39;)"><span class="hl_varref"><span class="mpre">giveBytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_359_14_359_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_14_359_16&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">

            </span><a href="System.IO.Streams.Internal.html#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_188_1_188_8&#39;)"><span class="hl_varref"><span class="mpre">connect</span></span></a><span class="mpre"> </span><a href="#loc_358_13_358_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_13_358_15&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><a href="#loc_360_13_360_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_13_360_16&#39;)"><span class="hl_varref"><span class="mpre">os&#39;</span></span></a><span class="mpre">
            </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="#loc_360_13_360_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_360_13_360_16&#39;)"><span class="hl_varref"><span class="mpre">os&#39;</span></span></a><span class="mpre">

            </span><a name="loc_365_13_365_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_13_365_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_359_18_359_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_18_359_22&#39;)"><span class="hl_varref"><span class="mpre">grab</span></span></a><span class="mpre">

            </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;giveBytes1&quot;</span></span><span class="mpre"> </span><a href="#loc_355_13_355_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_13_355_14&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_365_13_365_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_13_365_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

        </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><a name="loc_370_13_370_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_13_370_15&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_355_13_355_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_13_355_14&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
            (</span><a name="loc_371_14_371_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_14_371_16&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">, </span><a name="loc_371_18_371_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_18_371_22&#39;)"><span class="hl_vardecl"><span class="mpre">grab</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.List.html#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">listOutputStream</span></span></a><span class="mpre">
            </span><a name="loc_372_13_372_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_13_372_16&#39;)"><span class="hl_vardecl"><span class="mpre">os&#39;</span></span></a><span class="mpre">        &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_578_1_578_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_578_1_578_10&#39;)"><span class="hl_varref"><span class="mpre">giveBytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><a href="#loc_371_14_371_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_14_371_16&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">

            </span><a href="System.IO.Streams.Internal.html#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_188_1_188_8&#39;)"><span class="hl_varref"><span class="mpre">connect</span></span></a><span class="mpre"> </span><a href="#loc_370_13_370_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_13_370_15&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><a href="#loc_372_13_372_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_13_372_16&#39;)"><span class="hl_varref"><span class="mpre">os&#39;</span></span></a><span class="mpre">
            </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="#loc_372_13_372_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_13_372_16&#39;)"><span class="hl_varref"><span class="mpre">os&#39;</span></span></a><span class="mpre">
            </span><a name="loc_376_13_376_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_13_376_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_371_18_371_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_18_371_22&#39;)"><span class="hl_varref"><span class="mpre">grab</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;giveBytes2&quot;</span></span><span class="mpre"> </span><a href="#loc_355_13_355_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_13_355_14&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_376_13_376_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_13_376_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_382_1_382_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_1_382_19&#39;)"><span class="mpre">testThrowIfTooSlow</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_382_1_382_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_1_382_19&#39;)"><span class="hl_vardecl"><span class="mpre">testThrowIfTooSlow</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/throwIfTooSlow&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_383_5_383_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_5_383_7&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_407_5_407_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_5_407_11&#39;)"><span class="hl_varref"><span class="mpre">mkList</span></span></a><span class="mpre">
    </span><a href="System.IO.Streams.Tests.Common.html#loc_99_1_99_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_99_1_99_17&#39;)"><span class="hl_varref"><span class="mpre">expectExceptionH</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_409_5_409_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_5_409_16&#39;)"><span class="hl_varref"><span class="mpre">trickleFrom</span></span></a><span class="mpre"> </span><a href="#loc_383_5_383_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_5_383_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

    </span><a name="loc_386_5_386_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_5_386_8&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_407_5_407_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_5_407_11&#39;)"><span class="hl_varref"><span class="mpre">mkList</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_195_1_195_5&#39;)"><span class="hl_varref"><span class="mpre">void</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_386_5_386_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_5_386_8&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">
    </span><a name="loc_388_5_388_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_5_388_6&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_386_5_386_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_5_386_8&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;throwIfTooSlow&quot;</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="#loc_388_5_388_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_5_388_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

    </span><a name="loc_392_5_392_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_5_392_8&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_404_5_404_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_5_404_10&#39;)"><span class="hl_varref"><span class="mpre">mkSrc</span></span></a><span class="mpre">
    </span><a name="loc_393_5_393_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_5_393_9&#39;)"><span class="hl_vardecl"><span class="mpre">src&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_705_1_705_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_705_1_705_15&#39;)"><span class="hl_varref"><span class="mpre">throwIfTooSlow</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><a href="#loc_392_5_392_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_5_392_8&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">

    </span><a href="Control.Monad.html#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_195_1_195_5&#39;)"><span class="hl_varref"><span class="mpre">void</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_393_5_393_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_5_393_9&#39;)"><span class="hl_varref"><span class="mpre">src&#39;</span></span></a><span class="mpre">
    </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok2&quot;</span></span><span class="mpre"> </span><a href="#loc_393_5_393_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_5_393_9&#39;)"><span class="hl_varref"><span class="mpre">src&#39;</span></span></a><span class="mpre">
    </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ok1&quot;</span></span><span class="mpre"> </span><a href="#loc_393_5_393_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_5_393_9&#39;)"><span class="hl_varref"><span class="mpre">src&#39;</span></span></a><span class="mpre">
    </span><a name="loc_398_5_398_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_5_398_6&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><a href="#loc_392_5_392_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_5_392_8&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;throwIfTooSlow/pushback&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;ok1&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;ok2&quot;</span></span><span class="mpre">] </span><a href="#loc_398_5_398_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_5_398_6&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">


  where
    </span><a name="loc_404_5_404_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_5_404_10&#39;)"><span class="hl_vardecl"><span class="mpre">mkSrc</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">Prelude.take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">cycle</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
            </span><a href="Data.List.html#loc_427_1_427_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_427_1_427_12&#39;)"><span class="hl_varref"><span class="mpre">intersperse</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;the&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;quick&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;brown&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;fox&quot;</span></span><span class="mpre">]

    </span><a name="loc_407_5_407_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_5_407_11&#39;)"><span class="hl_vardecl"><span class="mpre">mkList</span></span></a><span class="mpre"> = </span><a href="#loc_404_5_404_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_5_404_10&#39;)"><span class="hl_varref"><span class="mpre">mkSrc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.ByteString.html#loc_705_1_705_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_705_1_705_15&#39;)"><span class="hl_varref"><span class="mpre">throwIfTooSlow</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">

    </span><a name="loc_409_5_409_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_5_409_16&#39;)"><span class="hl_fundecl"><span class="mpre">trickleFrom</span></span></a><span class="mpre"> </span><a name="loc_409_17_409_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_17_409_19&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> = </span><a href="#loc_411_9_411_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_9_411_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
      where
        </span><a name="loc_411_9_411_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_9_411_11&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_409_17_409_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_409_17_409_19&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)
                               (\</span><a name="loc_412_34_412_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_34_412_35&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_412_34_412_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_34_412_35&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_167_1_167_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_167_1_167_4&#39;)"><span class="hl_infix"><span class="mpre">`seq`</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">threadDelay</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2000000</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_411_9_411_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_9_411_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">))


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_417_1_417_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_15&#39;)"><span class="mpre">testBoyerMoore</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_417_1_417_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_15&#39;)"><span class="hl_vardecl"><span class="mpre">testBoyerMoore</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/boyerMoore&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                 </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><a href="#loc_423_5_423_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_5_423_8&#39;)"><span class="hl_varref"><span class="mpre">gen</span></span></a><span class="mpre"> </span><a href="#loc_430_5_430_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_5_430_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a name="loc_420_5_420_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_5_420_10&#39;)"><span class="hl_fundecl"><span class="mpre">genBS</span></span></a><span class="mpre"> </span><a name="loc_420_11_420_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_11_420_16&#39;)"><span class="hl_vardecl"><span class="mpre">range</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">listOf</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> </span><a href="#loc_420_11_420_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_11_420_16&#39;)"><span class="hl_varref"><span class="mpre">range</span></span></a><span class="mpre">

    </span><a href="#loc_423_5_423_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_5_423_8&#39;)"><span class="mpre">gen</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Gen</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">])
    </span><a name="loc_423_5_423_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_5_423_8&#39;)"><span class="hl_vardecl"><span class="mpre">gen</span></span></a><span class="mpre"> = do
        </span><a name="loc_424_9_424_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_9_424_15&#39;)"><span class="hl_vardecl"><span class="mpre">needle</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_420_5_420_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_5_420_10&#39;)"><span class="hl_varref"><span class="mpre">genBS</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;a&#39;</span></span><span class="mpre">, </span><span class="hl_char"><span class="mpre">&#39;z&#39;</span></span><span class="mpre">)
        </span><a name="loc_425_9_425_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_9_425_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">      &lt;- </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">)
        </span><a name="loc_426_9_426_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_426_9_426_12&#39;)"><span class="hl_vardecl"><span class="mpre">hay</span></span></a><span class="mpre">    &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><a href="#loc_425_9_425_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_9_425_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_420_5_420_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_5_420_10&#39;)"><span class="hl_varref"><span class="mpre">genBS</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;A&#39;</span></span><span class="mpre">, </span><span class="hl_char"><span class="mpre">&#39;Z&#39;</span></span><span class="mpre">)
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_424_9_424_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_9_424_15&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre">, </span><a href="#loc_426_9_426_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_426_9_426_12&#39;)"><span class="hl_varref"><span class="mpre">hay</span></span></a><span class="mpre">)

    </span><a href="#loc_430_5_430_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_5_430_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">]) -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_430_5_430_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_5_430_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> (</span><a name="loc_430_11_430_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_11_430_17&#39;)"><span class="hl_vardecl"><span class="mpre">needle</span></span></a><span class="mpre">, </span><a name="loc_430_19_430_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_19_430_28&#39;)"><span class="hl_vardecl"><span class="mpre">haystack&#39;</span></span></a><span class="mpre">) = do
        let </span><a name="loc_431_13_431_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_13_431_20&#39;)"><span class="hl_vardecl"><span class="mpre">lneedle</span></span></a><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> [</span><a href="#loc_430_11_430_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_11_430_17&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre">]
        let </span><a name="loc_432_13_432_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_13_432_22&#39;)"><span class="hl_vardecl"><span class="mpre">lhaystack</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_430_19_430_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_19_430_28&#39;)"><span class="hl_varref"><span class="mpre">haystack&#39;</span></span></a><span class="mpre">

        </span><span class="hl_varref"><span class="mpre">pre</span></span><span class="mpre"> ((</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_430_11_430_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_11_430_17&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
             (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.null</span></span><span class="mpre"> </span><a href="#loc_432_13_432_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_13_432_22&#39;)"><span class="hl_varref"><span class="mpre">lhaystack</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
             (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.isInfixOf</span></span><span class="mpre"> </span><a href="#loc_430_11_430_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_11_430_17&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><a href="#loc_430_19_430_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_19_430_28&#39;)"><span class="hl_varref"><span class="mpre">haystack&#39;</span></span></a><span class="mpre">))


        (</span><a name="loc_439_10_439_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_439_10_439_14&#39;)"><span class="hl_vardecl"><span class="mpre">lhay</span></span></a><span class="mpre">, </span><a name="loc_439_16_439_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_439_16_439_24&#39;)"><span class="hl_vardecl"><span class="mpre">toklist0</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_493_5_493_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_5_493_17&#39;)"><span class="hl_varref"><span class="mpre">insertNeedle</span></span></a><span class="mpre"> </span><a href="#loc_431_13_431_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_13_431_20&#39;)"><span class="hl_varref"><span class="mpre">lneedle</span></span></a><span class="mpre"> </span><a href="#loc_432_13_432_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_13_432_22&#39;)"><span class="hl_varref"><span class="mpre">lhaystack</span></span></a><span class="mpre">
        let </span><a name="loc_440_13_440_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_13_440_19&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.concat</span></span><span class="mpre"> [</span><a href="#loc_431_13_431_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_13_431_20&#39;)"><span class="hl_varref"><span class="mpre">lneedle</span></span></a><span class="mpre">, </span><a href="#loc_439_10_439_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_439_10_439_14&#39;)"><span class="hl_varref"><span class="mpre">lhay</span></span></a><span class="mpre">]
        let </span><a name="loc_441_13_441_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_13_441_20&#39;)"><span class="hl_vardecl"><span class="mpre">toklist</span></span></a><span class="mpre"> = (</span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre"> </span><a href="#loc_430_11_430_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_11_430_17&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_439_16_439_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_439_16_439_24&#39;)"><span class="hl_varref"><span class="mpre">toklist0</span></span></a><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- there should be exactly three matches</span></span><span class="mpre">
        </span><a name="loc_444_9_444_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_9_444_12&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> (</span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><a href="#loc_440_13_440_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_13_440_19&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.Search.html#loc_70_1_70_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_70_1_70_7&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><a href="#loc_430_11_430_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_11_430_17&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre">)

        let </span><a name="loc_446_13_446_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_13_446_21&#39;)"><span class="hl_vardecl"><span class="mpre">nMatches</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> </span><a href="#loc_469_5_469_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_5_469_12&#39;)"><span class="hl_varref"><span class="mpre">isMatch</span></span></a><span class="mpre"> </span><a href="#loc_444_9_444_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_9_444_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">

        let </span><a name="loc_448_13_448_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_13_448_17&#39;)"><span class="hl_vardecl"><span class="mpre">out&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_476_5_476_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_5_476_14&#39;)"><span class="hl_varref"><span class="mpre">concatAdj</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_444_9_444_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_9_444_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">

        </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_446_13_446_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_13_446_21&#39;)"><span class="hl_varref"><span class="mpre">nMatches</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_448_13_448_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_13_448_17&#39;)"><span class="hl_varref"><span class="mpre">out&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="#loc_441_13_441_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_13_441_20&#39;)"><span class="hl_varref"><span class="mpre">toklist</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;got wrong output!!&quot;</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;needle:\n&quot;</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_431_13_431_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_13_431_20&#39;)"><span class="hl_varref"><span class="mpre">lneedle</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\nhaystack:\n&quot;</span></span><span class="mpre">
            </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">) </span><a href="#loc_440_13_440_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_440_13_440_19&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\noutput stream:&quot;</span></span><span class="mpre">
            </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">) </span><a href="#loc_444_9_444_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_9_444_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\noutput stream (minified):&quot;</span></span><span class="mpre">
            </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">) </span><a href="#loc_448_13_448_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_13_448_17&#39;)"><span class="hl_varref"><span class="mpre">out&#39;</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\nexpected output:&quot;</span></span><span class="mpre">
            </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">) </span><a href="#loc_441_13_441_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_13_441_20&#39;)"><span class="hl_varref"><span class="mpre">toklist</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">

        </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;boyer-moore matches&quot;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><a href="#loc_446_13_446_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_13_446_21&#39;)"><span class="hl_varref"><span class="mpre">nMatches</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;boyer-moore output&quot;</span></span><span class="mpre"> </span><a href="#loc_441_13_441_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_13_441_20&#39;)"><span class="hl_varref"><span class="mpre">toklist</span></span></a><span class="mpre"> </span><a href="#loc_448_13_448_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_13_448_17&#39;)"><span class="hl_varref"><span class="mpre">out&#39;</span></span></a><span class="mpre">


    </span><a name="loc_469_5_469_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_5_469_12&#39;)"><span class="hl_fundecl"><span class="mpre">isMatch</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre"> _) = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_469_5_469_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_469_5_469_12&#39;)"><span class="hl_fundecl"><span class="mpre">isMatch</span></span></a><span class="mpre"> _         = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

    </span><a href="#loc_476_5_476_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_5_476_14&#39;)"><span class="mpre">concatAdj</span></a><span class="mpre"> :: </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="System.IO.Streams.Internal.Search.html#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">MatchInfo</span></span></a><span class="mpre">
              -&gt; ([</span><a href="System.IO.Streams.Internal.Search.html#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">MatchInfo</span></span></a><span class="mpre">] -&gt; [</span><a href="System.IO.Streams.Internal.Search.html#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">MatchInfo</span></span></a><span class="mpre">])
              -&gt; [</span><a href="System.IO.Streams.Internal.Search.html#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">MatchInfo</span></span></a><span class="mpre">]
              -&gt; [</span><a href="System.IO.Streams.Internal.Search.html#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">MatchInfo</span></span></a><span class="mpre">]
    </span><a name="loc_476_5_476_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_5_476_14&#39;)"><span class="hl_fundecl"><span class="mpre">concatAdj</span></span></a><span class="mpre"> </span><a name="loc_476_15_476_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_15_476_21&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><a name="loc_476_22_476_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_22_476_24&#39;)"><span class="hl_vardecl"><span class="mpre">dl</span></span></a><span class="mpre"> []     = </span><a href="#loc_476_22_476_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_22_476_24&#39;)"><span class="hl_varref"><span class="mpre">dl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> [] (</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[]) </span><a href="#loc_476_15_476_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_15_476_21&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre">
    </span><a href="#loc_476_5_476_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_5_476_14&#39;)"><span class="hl_fundecl"><span class="mpre">concatAdj</span></span></a><span class="mpre"> </span><a name="loc_477_15_477_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_15_477_21&#39;)"><span class="hl_vardecl"><span class="mpre">prefix</span></span></a><span class="mpre"> </span><a name="loc_477_22_477_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_22_477_24&#39;)"><span class="hl_vardecl"><span class="mpre">dl</span></span></a><span class="mpre"> (</span><a name="loc_477_26_477_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_26_477_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_477_28_477_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_28_477_30&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) =
        </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><a href="#loc_476_5_476_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_5_476_14&#39;)"><span class="hl_varref"><span class="mpre">concatAdj</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_477_26_477_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_26_477_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_477_22_477_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_22_477_24&#39;)"><span class="hl_varref"><span class="mpre">dl</span></span></a><span class="mpre"> </span><a href="#loc_477_28_477_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_28_477_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
              (\</span><a name="loc_479_17_479_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_17_479_18&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><a href="#loc_476_5_476_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_5_476_14&#39;)"><span class="hl_varref"><span class="mpre">concatAdj</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_477_26_477_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_26_477_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><a href="#loc_477_22_477_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_22_477_24&#39;)"><span class="hl_varref"><span class="mpre">dl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_479_17_479_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_17_479_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)) </span><a href="#loc_477_28_477_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_28_477_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
                           (\</span><a name="loc_480_30_480_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_30_480_32&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_476_5_476_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_5_476_14&#39;)"><span class="hl_varref"><span class="mpre">concatAdj</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_480_30_480_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_30_480_32&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre">) </span><a href="#loc_477_22_477_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_22_477_24&#39;)"><span class="hl_varref"><span class="mpre">dl</span></span></a><span class="mpre"> </span><a href="#loc_477_28_477_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_28_477_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
                           (</span><a href="#loc_485_9_485_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_9_485_14&#39;)"><span class="hl_varref"><span class="mpre">merge</span></span></a><span class="mpre"> </span><a href="#loc_479_17_479_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_17_479_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_477_26_477_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_26_477_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">))
              </span><a href="#loc_477_15_477_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_15_477_21&#39;)"><span class="hl_varref"><span class="mpre">prefix</span></span></a><span class="mpre">

      where
        </span><a name="loc_485_9_485_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_9_485_14&#39;)"><span class="hl_fundecl"><span class="mpre">merge</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><a name="loc_485_24_485_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_24_485_25&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">) </span><a name="loc_485_27_485_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_27_485_28&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_485_24_485_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_24_485_25&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">  = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_485_27_485_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_27_485_28&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = case </span><a href="#loc_485_27_485_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_27_485_28&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> of
                            </span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><a name="loc_488_37_488_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_37_488_39&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_485_24_485_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_24_485_25&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_488_37_488_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_488_37_488_39&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre">
                            _          -&gt; </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

        </span><a href="#loc_485_9_485_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_9_485_14&#39;)"><span class="hl_fundecl"><span class="mpre">merge</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre"> _) _ = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

    </span><a name="loc_493_5_493_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_5_493_17&#39;)"><span class="hl_fundecl"><span class="mpre">insertNeedle</span></span></a><span class="mpre"> </span><a name="loc_493_18_493_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_18_493_25&#39;)"><span class="hl_vardecl"><span class="mpre">lneedle</span></span></a><span class="mpre"> </span><a name="loc_493_26_493_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_26_493_35&#39;)"><span class="hl_vardecl"><span class="mpre">lhaystack</span></span></a><span class="mpre"> = do
        </span><a name="loc_494_9_494_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_9_494_13&#39;)"><span class="hl_vardecl"><span class="mpre">idxL</span></span></a><span class="mpre">  &lt;- </span><span class="hl_varref"><span class="mpre">pick</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><a href="#loc_516_9_516_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_9_516_13&#39;)"><span class="hl_varref"><span class="mpre">lenL</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><a name="loc_495_9_495_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_495_9_495_13&#39;)"><span class="hl_vardecl"><span class="mpre">idxN</span></span></a><span class="mpre">  &lt;- </span><span class="hl_varref"><span class="mpre">pick</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><a href="#loc_515_9_515_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_9_515_13&#39;)"><span class="hl_varref"><span class="mpre">lenN</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><a name="loc_496_9_496_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_9_496_14&#39;)"><span class="hl_vardecl"><span class="mpre">idxN2</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">pick</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">choose</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><a href="#loc_515_9_515_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_9_515_13&#39;)"><span class="hl_varref"><span class="mpre">lenN</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        let (</span><a name="loc_497_14_497_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_497_14_497_16&#39;)"><span class="hl_vardecl"><span class="mpre">l1</span></span></a><span class="mpre">, </span><a name="loc_497_18_497_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_497_18_497_20&#39;)"><span class="hl_vardecl"><span class="mpre">l2</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">L.splitAt</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_494_9_494_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_494_9_494_13&#39;)"><span class="hl_varref"><span class="mpre">idxL</span></span></a><span class="mpre">) </span><a href="#loc_493_26_493_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_26_493_35&#39;)"><span class="hl_varref"><span class="mpre">lhaystack</span></span></a><span class="mpre">
        let (</span><a name="loc_498_14_498_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_14_498_16&#39;)"><span class="hl_vardecl"><span class="mpre">n1</span></span></a><span class="mpre">, </span><a name="loc_498_18_498_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_18_498_20&#39;)"><span class="hl_vardecl"><span class="mpre">n2</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">L.splitAt</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_495_9_495_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_495_9_495_13&#39;)"><span class="hl_varref"><span class="mpre">idxN</span></span></a><span class="mpre">) </span><a href="#loc_493_18_493_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_18_493_25&#39;)"><span class="hl_varref"><span class="mpre">lneedle</span></span></a><span class="mpre">
        let (</span><a name="loc_499_14_499_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_14_499_16&#39;)"><span class="hl_vardecl"><span class="mpre">n3</span></span></a><span class="mpre">, </span><a name="loc_499_18_499_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_18_499_20&#39;)"><span class="hl_vardecl"><span class="mpre">n4</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">L.splitAt</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><a href="#loc_496_9_496_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_496_9_496_14&#39;)"><span class="hl_varref"><span class="mpre">idxN2</span></span></a><span class="mpre">) </span><a href="#loc_493_18_493_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_18_493_25&#39;)"><span class="hl_varref"><span class="mpre">lneedle</span></span></a><span class="mpre">

        let </span><a name="loc_501_13_501_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_13_501_17&#39;)"><span class="hl_vardecl"><span class="mpre">out1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.concat</span></span><span class="mpre"> [ </span><a href="#loc_497_14_497_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_497_14_497_16&#39;)"><span class="hl_varref"><span class="mpre">l1</span></span></a><span class="mpre">, </span><a href="#loc_498_14_498_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_14_498_16&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre">, </span><a href="#loc_498_18_498_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_18_498_20&#39;)"><span class="hl_varref"><span class="mpre">n2</span></span></a><span class="mpre">, </span><a href="#loc_497_18_497_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_497_18_497_20&#39;)"><span class="hl_varref"><span class="mpre">l2</span></span></a><span class="mpre">, </span><a href="#loc_499_14_499_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_14_499_16&#39;)"><span class="hl_varref"><span class="mpre">n3</span></span></a><span class="mpre">, </span><a href="#loc_499_18_499_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_18_499_20&#39;)"><span class="hl_varref"><span class="mpre">n4</span></span></a><span class="mpre"> ]

        let </span><a name="loc_503_13_503_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_13_503_16&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> = </span><a href="#loc_476_5_476_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_5_476_14&#39;)"><span class="hl_varref"><span class="mpre">concatAdj</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
                      [ </span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_513_9_513_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_9_513_15&#39;)"><span class="hl_varref"><span class="mpre">strict</span></span></a><span class="mpre"> </span><a href="#loc_497_14_497_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_497_14_497_16&#39;)"><span class="hl_varref"><span class="mpre">l1</span></span></a><span class="mpre">
                      , </span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre">   </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_513_9_513_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_9_513_15&#39;)"><span class="hl_varref"><span class="mpre">strict</span></span></a><span class="mpre"> </span><a href="#loc_493_18_493_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_18_493_25&#39;)"><span class="hl_varref"><span class="mpre">lneedle</span></span></a><span class="mpre">
                      , </span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_513_9_513_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_9_513_15&#39;)"><span class="hl_varref"><span class="mpre">strict</span></span></a><span class="mpre"> </span><a href="#loc_497_18_497_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_497_18_497_20&#39;)"><span class="hl_varref"><span class="mpre">l2</span></span></a><span class="mpre">
                      , </span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre">   </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_513_9_513_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_9_513_15&#39;)"><span class="hl_varref"><span class="mpre">strict</span></span></a><span class="mpre"> </span><a href="#loc_493_18_493_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_18_493_25&#39;)"><span class="hl_varref"><span class="mpre">lneedle</span></span></a><span class="mpre">
                      ]

        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_501_13_501_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_13_501_17&#39;)"><span class="hl_varref"><span class="mpre">out1</span></span></a><span class="mpre">, </span><a href="#loc_503_13_503_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_13_503_16&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">)

      where
        </span><a name="loc_513_9_513_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_9_513_15&#39;)"><span class="hl_vardecl"><span class="mpre">strict</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">

        </span><a name="loc_515_9_515_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_9_515_13&#39;)"><span class="hl_vardecl"><span class="mpre">lenN</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_493_18_493_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_18_493_25&#39;)"><span class="hl_varref"><span class="mpre">lneedle</span></span></a><span class="mpre">
        </span><a name="loc_516_9_516_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_9_516_13&#39;)"><span class="hl_vardecl"><span class="mpre">lenL</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_493_26_493_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_26_493_35&#39;)"><span class="hl_varref"><span class="mpre">lhaystack</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_521_1_521_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_1_521_16&#39;)"><span class="mpre">testBoyerMoore2</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_521_1_521_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_1_521_16&#39;)"><span class="hl_vardecl"><span class="mpre">testBoyerMoore2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/boyerMoore2&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;bork&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;no&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bork&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bor&quot;</span></span><span class="mpre">]
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.Search.html#loc_70_1_70_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_70_1_70_7&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bork&quot;</span></span><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bork!&quot;</span></span><span class="mpre"> [ </span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bork&quot;</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;no&quot;</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bork&quot;</span></span><span class="mpre">
                                , </span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bor&quot;</span></span><span class="mpre"> ]

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.Search.html#loc_70_1_70_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_70_1_70_7&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bork&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;nothing&quot;</span></span><span class="mpre"> []

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;borkbo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;r&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.Search.html#loc_70_1_70_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_70_1_70_7&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bork&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;borkbo&quot;</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bork&quot;</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bor&quot;</span></span><span class="mpre">]

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;borkborkborkb&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;o&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;r&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;k&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;b&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;o&quot;</span></span><span class="mpre">]
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.Search.html#loc_70_1_70_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_70_1_70_7&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;borkborkbork&quot;</span></span><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;boooooork&quot;</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;borkborkbork&quot;</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;borkbo&quot;</span></span><span class="mpre">]

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;bbbbb&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;o&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;r&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;k&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bork&quot;</span></span><span class="mpre">]
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.Search.html#loc_70_1_70_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_70_1_70_7&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&quot;</span></span><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bbbbbbbbb&quot;</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bbbbborkbork&quot;</span></span><span class="mpre">]

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;bbbbbbbbb&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;o&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;r&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;k&quot;</span></span><span class="mpre">]
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.Search.html#loc_70_1_70_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_70_1_70_7&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bbbbbbbb&quot;</span></span><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bbb2&quot;</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bbbbbbbb&quot;</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bork&quot;</span></span><span class="mpre">]

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;bababa&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;rk&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bz&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;z&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;z&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;z&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.Search.html#loc_70_1_70_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_70_1_70_7&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;babababork&quot;</span></span><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;zzz&quot;</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;babababork&quot;</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bzzzz&quot;</span></span><span class="mpre">]

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;bab&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;a&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;b&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.Search.html#loc_70_1_70_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_70_1_70_7&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bababa&quot;</span></span><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bab&quot;</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;babab&quot;</span></span><span class="mpre">]

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;xxx&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;xxxzx&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;xx&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.Search.html#loc_70_1_70_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.Search.html#loc_70_1_70_7&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;xxxx&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;xxxx&quot;</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;xxxx&quot;</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;xxzxxx&quot;</span></span><span class="mpre">]


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_562_1_562_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_1_562_24&#39;)"><span class="mpre">testWriteLazyByteString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_562_1_562_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_1_562_24&#39;)"><span class="hl_vardecl"><span class="mpre">testWriteLazyByteString</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/writeLazy&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                          </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                          </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_567_5_567_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_5_567_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a href="#loc_567_5_567_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_5_567_9&#39;)"><span class="mpre">prop</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">PropertyM</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_567_5_567_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_5_567_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_567_10_567_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_10_567_12&#39;)"><span class="hl_vardecl"><span class="mpre">l0</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        let </span><a name="loc_568_13_568_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_568_13_568_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre">) </span><a href="#loc_567_10_567_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_10_567_12&#39;)"><span class="hl_varref"><span class="mpre">l0</span></span></a><span class="mpre">
        let </span><a name="loc_569_13_569_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_13_569_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_568_13_568_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_568_13_568_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
        (</span><a name="loc_570_10_570_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_10_570_12&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">, </span><a name="loc_570_14_570_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_14_570_18&#39;)"><span class="hl_vardecl"><span class="mpre">grab</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.List.html#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">listOutputStream</span></span></a><span class="mpre">
        </span><a href="System.IO.Streams.ByteString.html#loc_92_1_92_20" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_92_1_92_20&#39;)"><span class="hl_varref"><span class="mpre">writeLazyByteString</span></span></a><span class="mpre"> </span><a href="#loc_569_13_569_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_13_569_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_570_10_570_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_10_570_12&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">

        </span><a name="loc_573_9_573_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_9_573_11&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_570_14_570_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_14_570_18&#39;)"><span class="hl_varref"><span class="mpre">grab</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;writeLazy&quot;</span></span><span class="mpre"> </span><a href="#loc_568_13_568_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_568_13_568_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_573_9_573_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_9_573_11&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_579_1_579_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_579_1_579_16&#39;)"><span class="mpre">testReadExactly</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_579_1_579_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_579_1_579_16&#39;)"><span class="hl_vardecl"><span class="mpre">testReadExactly</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testProperty</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/readExactly&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                  </span><span class="hl_varref"><span class="mpre">monadicIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                  </span><span class="hl_varref"><span class="mpre">forAllM</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">arbitrary</span></span><span class="mpre"> </span><a href="#loc_583_5_583_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_5_583_9&#39;)"><span class="hl_varref"><span class="mpre">prop</span></span></a><span class="mpre">
  where
    </span><a name="loc_583_5_583_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_5_583_9&#39;)"><span class="hl_fundecl"><span class="mpre">prop</span></span></a><span class="mpre"> </span><a name="loc_583_10_583_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_10_583_12&#39;)"><span class="hl_vardecl"><span class="mpre">l0</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Tests.Common.html#loc_108_1_108_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_108_1_108_6&#39;)"><span class="hl_varref"><span class="mpre">liftQ</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        let </span><a name="loc_584_13_584_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_13_584_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre">) </span><a href="#loc_583_10_583_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_10_583_12&#39;)"><span class="hl_varref"><span class="mpre">l0</span></span></a><span class="mpre">
        </span><a name="loc_585_9_585_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_9_585_11&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><a href="#loc_584_13_584_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_13_584_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

        let </span><a name="loc_587_13_587_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_587_13_587_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_584_13_584_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_13_584_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
        let </span><a name="loc_588_13_588_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_13_588_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><a href="#loc_587_13_587_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_587_13_587_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

        </span><a name="loc_590_9_590_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_9_590_10&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_516_1_516_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_516_1_516_12&#39;)"><span class="hl_varref"><span class="mpre">readExactly</span></span></a><span class="mpre"> </span><a href="#loc_588_13_588_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_13_588_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_585_9_585_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_9_585_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;eq&quot;</span></span><span class="mpre"> </span><a href="#loc_587_13_587_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_587_13_587_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> [</span><a href="#loc_590_9_590_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_9_590_10&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">]

        </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><a href="#loc_590_9_590_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_590_9_590_10&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_585_9_585_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_9_585_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
        </span><a href="System.IO.Streams.Tests.Common.html#loc_99_1_99_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_99_1_99_17&#39;)"><span class="hl_varref"><span class="mpre">expectExceptionH</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.ByteString.html#loc_516_1_516_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_516_1_516_12&#39;)"><span class="hl_varref"><span class="mpre">readExactly</span></span></a><span class="mpre"> (</span><a href="#loc_588_13_588_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_13_588_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_585_9_585_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_585_9_585_11&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

        </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_588_13_588_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_13_588_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
            </span><a name="loc_597_13_597_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_13_597_16&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><a href="#loc_584_13_584_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_13_584_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
            </span><a name="loc_598_13_598_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_13_598_14&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">   &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_516_1_516_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_516_1_516_12&#39;)"><span class="hl_varref"><span class="mpre">readExactly</span></span></a><span class="mpre"> (</span><a href="#loc_588_13_588_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_13_588_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_597_13_597_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_13_597_16&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;eq2&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.take</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_588_13_588_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_13_588_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_587_13_587_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_587_13_587_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> [</span><a href="#loc_598_13_598_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_13_598_14&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">])
            </span><a name="loc_600_13_600_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_13_600_14&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">   &lt;- </span><a href="System.IO.Streams.ByteString.html#loc_516_1_516_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_516_1_516_12&#39;)"><span class="hl_varref"><span class="mpre">readExactly</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_597_13_597_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_13_597_16&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;eq3&quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.drop</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_588_13_588_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_588_13_588_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_587_13_587_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_587_13_587_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> [</span><a href="#loc_600_13_600_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_13_600_14&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">])


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_606_1_606_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_1_606_14&#39;)"><span class="mpre">testTakeWhile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_606_1_606_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_1_606_14&#39;)"><span class="hl_vardecl"><span class="mpre">testTakeWhile</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/takeBytesWhile&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_607_5_607_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_5_607_7&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;test&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;ing\n&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;1-2-3\n1-2-3&quot;</span></span><span class="mpre">]

    </span><a href="System.IO.Streams.ByteString.html#loc_551_1_551_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_551_1_551_15&#39;)"><span class="hl_varref"><span class="mpre">takeBytesWhile</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">) </span><a href="#loc_607_5_607_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_5_607_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;takeBytesWhile1&quot;</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;testing&quot;</span></span><span class="mpre">)
    </span><a href="System.IO.Streams.ByteString.html#loc_551_1_551_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_551_1_551_15&#39;)"><span class="hl_varref"><span class="mpre">takeBytesWhile</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">) </span><a href="#loc_607_5_607_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_5_607_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;takeBytesWhile2&quot;</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)
    </span><a href="System.IO.Streams.ByteString.html#loc_516_1_516_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_516_1_516_12&#39;)"><span class="hl_varref"><span class="mpre">readExactly</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_607_5_607_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_5_607_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;readExactly&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">
    </span><a href="System.IO.Streams.ByteString.html#loc_551_1_551_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_551_1_551_15&#39;)"><span class="hl_varref"><span class="mpre">takeBytesWhile</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">) </span><a href="#loc_607_5_607_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_5_607_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;takeBytesWhile3&quot;</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;1-2-3&quot;</span></span><span class="mpre">)
    </span><a href="System.IO.Streams.ByteString.html#loc_516_1_516_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_516_1_516_12&#39;)"><span class="hl_varref"><span class="mpre">readExactly</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_607_5_607_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_5_607_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;readExactly&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">
    </span><a href="System.IO.Streams.ByteString.html#loc_551_1_551_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_551_1_551_15&#39;)"><span class="hl_varref"><span class="mpre">takeBytesWhile</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">) </span><a href="#loc_607_5_607_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_5_607_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;takeBytesWhile4&quot;</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;1-2-3&quot;</span></span><span class="mpre">)
    </span><a href="System.IO.Streams.ByteString.html#loc_551_1_551_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_551_1_551_15&#39;)"><span class="hl_varref"><span class="mpre">takeBytesWhile</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">) </span><a href="#loc_607_5_607_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_607_5_607_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;takeBytesWhile4&quot;</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_624_1_624_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_1_624_10&#39;)"><span class="mpre">testLines</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_624_1_624_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_1_624_10&#39;)"><span class="hl_vardecl"><span class="mpre">testLines</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/testLines&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;th&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;e\nquick\nbrown&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;fox&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.ByteString.html#loc_334_1_334_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_334_1_334_6&#39;)"><span class="hl_varref"><span class="mpre">lines</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
             </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;lines&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;the&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;quick&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;brown&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;fox&quot;</span></span><span class="mpre">]
    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.ByteString.html#loc_334_1_334_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_334_1_334_6&#39;)"><span class="hl_varref"><span class="mpre">lines</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;empty lines&quot;</span></span><span class="mpre"> []

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;cool&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
      \</span><a name="loc_630_8_630_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_8_630_10&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> -&gt; </span><a href="System.IO.Streams.List.html#loc_109_1_109_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_109_1_109_13&#39;)"><span class="hl_varref"><span class="mpre">outputToList</span></span></a><span class="mpre"> (\</span><a name="loc_630_29_630_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_29_630_31&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre"> -&gt; </span><a href="System.IO.Streams.ByteString.html#loc_368_1_368_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_368_1_368_8&#39;)"><span class="hl_varref"><span class="mpre">unlines</span></span></a><span class="mpre"> </span><a href="#loc_630_29_630_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_29_630_31&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_188_1_188_8&#39;)"><span class="hl_varref"><span class="mpre">connect</span></span></a><span class="mpre"> </span><a href="#loc_630_8_630_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_8_630_10&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unlines&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;cool&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">]


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_636_1_636_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_636_1_636_10&#39;)"><span class="mpre">testWords</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_636_1_636_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_636_1_636_10&#39;)"><span class="hl_vardecl"><span class="mpre">testWords</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/testWords&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;the quick brown    \n\tfox&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.ByteString.html#loc_352_1_352_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_352_1_352_6&#39;)"><span class="hl_varref"><span class="mpre">words</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
             </span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">toList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;words&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;the&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;quick&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;brown&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;fox&quot;</span></span><span class="mpre">]

    </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;cool&quot;</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
      \</span><a name="loc_641_8_641_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_641_8_641_10&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> -&gt; </span><a href="System.IO.Streams.List.html#loc_109_1_109_13" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_109_1_109_13&#39;)"><span class="hl_varref"><span class="mpre">outputToList</span></span></a><span class="mpre"> (\</span><a name="loc_641_29_641_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_641_29_641_31&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre"> -&gt; </span><a href="System.IO.Streams.ByteString.html#loc_385_1_385_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_385_1_385_8&#39;)"><span class="hl_varref"><span class="mpre">unwords</span></span></a><span class="mpre"> </span><a href="#loc_641_29_641_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_641_29_641_31&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_188_1_188_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_188_1_188_8&#39;)"><span class="hl_varref"><span class="mpre">connect</span></span></a><span class="mpre"> </span><a href="#loc_641_8_641_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_641_8_641_10&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unlines&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;ok&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;cool&quot;</span></span><span class="mpre">]


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_647_1_647_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_1_647_13&#39;)"><span class="mpre">testTrivials</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_647_1_647_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_647_1_647_13&#39;)"><span class="hl_vardecl"><span class="mpre">testTrivials</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bytestring/testTrivials&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="System.IO.Streams.Tests.Common.html#loc_85_1_85_22" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_85_1_85_22&#39;)"><span class="hl_varref"><span class="mpre">coverTypeableInstance</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><a href="System.IO.Streams.ByteString.html#loc_391_6_391_31" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_391_6_391_31&#39;)"><span class="hl_tyconref"><span class="mpre">TooManyBytesReadException</span></span></a><span class="mpre">)
    </span><a href="System.IO.Streams.Tests.Common.html#loc_48_1_48_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_48_1_48_18&#39;)"><span class="hl_varref"><span class="mpre">coverShowInstance</span></span></a><span class="mpre">     (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><a href="System.IO.Streams.ByteString.html#loc_391_6_391_31" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_391_6_391_31&#39;)"><span class="hl_tyconref"><span class="mpre">TooManyBytesReadException</span></span></a><span class="mpre">)
    </span><a href="System.IO.Streams.Tests.Common.html#loc_85_1_85_22" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_85_1_85_22&#39;)"><span class="hl_varref"><span class="mpre">coverTypeableInstance</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><a href="System.IO.Streams.ByteString.html#loc_402_6_402_33" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_402_6_402_33&#39;)"><span class="hl_tyconref"><span class="mpre">TooFewBytesWrittenException</span></span></a><span class="mpre">)
    </span><a href="System.IO.Streams.Tests.Common.html#loc_48_1_48_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_48_1_48_18&#39;)"><span class="hl_varref"><span class="mpre">coverShowInstance</span></span></a><span class="mpre">     (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><a href="System.IO.Streams.ByteString.html#loc_402_6_402_33" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_402_6_402_33&#39;)"><span class="hl_tyconref"><span class="mpre">TooFewBytesWrittenException</span></span></a><span class="mpre">)
    </span><a href="System.IO.Streams.Tests.Common.html#loc_85_1_85_22" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_85_1_85_22&#39;)"><span class="hl_varref"><span class="mpre">coverTypeableInstance</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><a href="System.IO.Streams.ByteString.html#loc_413_6_413_34" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_413_6_413_34&#39;)"><span class="hl_tyconref"><span class="mpre">TooManyBytesWrittenException</span></span></a><span class="mpre">)
    </span><a href="System.IO.Streams.Tests.Common.html#loc_48_1_48_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_48_1_48_18&#39;)"><span class="hl_varref"><span class="mpre">coverShowInstance</span></span></a><span class="mpre">     (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><a href="System.IO.Streams.ByteString.html#loc_413_6_413_34" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_413_6_413_34&#39;)"><span class="hl_tyconref"><span class="mpre">TooManyBytesWrittenException</span></span></a><span class="mpre">)
    </span><a href="System.IO.Streams.Tests.Common.html#loc_85_1_85_22" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_85_1_85_22&#39;)"><span class="hl_varref"><span class="mpre">coverTypeableInstance</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><a href="System.IO.Streams.ByteString.html#loc_685_6_685_26" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_685_6_685_26&#39;)"><span class="hl_tyconref"><span class="mpre">RateTooSlowException</span></span></a><span class="mpre">)
    </span><a href="System.IO.Streams.Tests.Common.html#loc_48_1_48_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_48_1_48_18&#39;)"><span class="hl_varref"><span class="mpre">coverShowInstance</span></span></a><span class="mpre">     (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><a href="System.IO.Streams.ByteString.html#loc_685_6_685_26" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_685_6_685_26&#39;)"><span class="hl_tyconref"><span class="mpre">RateTooSlowException</span></span></a><span class="mpre">)
    </span><a href="System.IO.Streams.Tests.Common.html#loc_85_1_85_22" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_85_1_85_22&#39;)"><span class="hl_varref"><span class="mpre">coverTypeableInstance</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><a href="System.IO.Streams.ByteString.html#loc_425_6_425_27" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.ByteString.html#loc_425_6_425_27&#39;)"><span class="hl_tyconref"><span class="mpre">ReadTooShortException</span></span></a><span class="mpre">)

    </span><a href="System.IO.Streams.Tests.Common.html#loc_64_1_64_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_64_1_64_16&#39;)"><span class="hl_varref"><span class="mpre">coverEqInstance</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">

    </span><a href="System.IO.Streams.Tests.Common.html#loc_48_1_48_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_48_1_48_18&#39;)"><span class="hl_varref"><span class="mpre">coverShowInstance</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Match</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
    </span><a href="System.IO.Streams.Tests.Common.html#loc_48_1_48_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Tests.Common.html#loc_48_1_48_18&#39;)"><span class="hl_varref"><span class="mpre">coverShowInstance</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">NoMatch</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
</span></div></body></html>