<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}

</span><span class="hl_comment"><span class="mpre">-- | Convenience module for debugging streams. Provides stream transformers</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that wrap &#39;InputStream&#39;s and &#39;OutputStream&#39;s, sending a description of all</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- data to an &#39;OutputStream&#39; for debugging.</span></span><span class="mpre">

module System.IO.Streams.Debug
 ( </span><span class="hl_comment"><span class="mpre">-- * Debuggers</span></span><span class="mpre">
   debugInput
 , debugOutput
 , debugInputBS
 , debugOutputBS
 ) where

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Debug.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 18, srcSpanEndLine = 16, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre">      (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Debug.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 18, srcSpanEndLine = 17, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre">      as S
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           System.IO.Streams.Internal (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="mpre">InputStream</span></a><span class="mpre"> (..), </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="mpre">OutputStream</span></a><span class="mpre">)
import qualified System.IO.Streams.Internal as Streams


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_32_1_32_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_11&#39;)"><span class="mpre">debugInput</span></a><span class="mpre"> ::
     (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)         </span><span class="hl_comment"><span class="mpre">-- ^ function to convert stream elements to</span></span><span class="mpre">
                               </span><span class="hl_comment"><span class="mpre">--   &#39;ByteString&#39;</span></span><span class="mpre">
  -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- ^ name of this debug stream, will be</span></span><span class="mpre">
                               </span><span class="hl_comment"><span class="mpre">--   prepended to debug output</span></span><span class="mpre">
  -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ stream the debug info will be sent to</span></span><span class="mpre">
  -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">             </span><span class="hl_comment"><span class="mpre">-- ^ input stream</span></span><span class="mpre">
  -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_32_1_32_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_11&#39;)"><span class="hl_fundecl"><span class="mpre">debugInput</span></span></a><span class="mpre"> </span><a name="loc_32_12_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_12_32_16&#39;)"><span class="hl_vardecl"><span class="mpre">toBS</span></span></a><span class="mpre"> </span><a name="loc_32_17_32_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_17_32_21&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_32_22_32_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_22_32_33&#39;)"><span class="hl_vardecl"><span class="mpre">debugStream</span></span></a><span class="mpre"> </span><a name="loc_32_34_32_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_34_32_45&#39;)"><span class="hl_vardecl"><span class="mpre">inputStream</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">InputStream</span></span><span class="mpre"> </span><a href="#loc_34_5_34_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_5_34_12&#39;)"><span class="hl_varref"><span class="mpre">produce</span></span></a><span class="mpre"> </span><a href="#loc_39_5_39_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_7&#39;)"><span class="hl_varref"><span class="mpre">pb</span></span></a><span class="mpre">
  where
    </span><a name="loc_34_5_34_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_5_34_12&#39;)"><span class="hl_vardecl"><span class="mpre">produce</span></span></a><span class="mpre"> = do
        </span><a name="loc_35_9_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_10&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">Streams.read</span></span></a><span class="mpre"> </span><a href="#loc_32_34_32_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_34_32_45&#39;)"><span class="hl_varref"><span class="mpre">inputStream</span></span></a><span class="mpre">
        </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">Streams.write</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_44_5_44_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_5_44_13&#39;)"><span class="hl_varref"><span class="mpre">describe</span></span></a><span class="mpre"> </span><a href="#loc_35_9_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><a href="#loc_32_22_32_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_22_32_33&#39;)"><span class="hl_varref"><span class="mpre">debugStream</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_35_9_35_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

    </span><a name="loc_39_5_39_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_7&#39;)"><span class="hl_fundecl"><span class="mpre">pb</span></span></a><span class="mpre"> </span><a name="loc_39_8_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_8_39_9&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = do
        let </span><a name="loc_40_13_40_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_13_40_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> [</span><a href="#loc_32_17_32_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_17_32_21&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;: pushback: &quot;</span></span><span class="mpre">, </span><a href="#loc_32_12_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_12_32_16&#39;)"><span class="hl_varref"><span class="mpre">toBS</span></span></a><span class="mpre"> </span><a href="#loc_39_8_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_8_39_9&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">]
        </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">Streams.write</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_40_13_40_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_13_40_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_32_22_32_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_22_32_33&#39;)"><span class="hl_varref"><span class="mpre">debugStream</span></span></a><span class="mpre">
        </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">Streams.unRead</span></span></a><span class="mpre"> </span><a href="#loc_39_8_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_8_39_9&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_32_34_32_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_34_32_45&#39;)"><span class="hl_varref"><span class="mpre">inputStream</span></span></a><span class="mpre">

    </span><a name="loc_44_5_44_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_5_44_13&#39;)"><span class="hl_fundecl"><span class="mpre">describe</span></span></a><span class="mpre"> </span><a name="loc_44_14_44_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_14_44_15&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> [</span><a href="#loc_32_17_32_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_17_32_21&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;: got &quot;</span></span><span class="mpre">, </span><a href="#loc_46_5_46_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_18&#39;)"><span class="hl_varref"><span class="mpre">describeChunk</span></span></a><span class="mpre"> </span><a href="#loc_44_14_44_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_14_44_15&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">]

    </span><a name="loc_46_5_46_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_18&#39;)"><span class="hl_fundecl"><span class="mpre">describeChunk</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;EOF&quot;</span></span><span class="mpre">
    </span><a href="#loc_46_5_46_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_5_46_18&#39;)"><span class="hl_fundecl"><span class="mpre">describeChunk</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_47_25_47_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_25_47_26&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> [ </span><span class="hl_string"><span class="mpre">&quot;chunk: &quot;</span></span><span class="mpre">, </span><a href="#loc_32_12_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_12_32_16&#39;)"><span class="hl_varref"><span class="mpre">toBS</span></span></a><span class="mpre"> </span><a href="#loc_47_25_47_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_25_47_26&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> ]


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_57_1_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_13&#39;)"><span class="mpre">debugInputBS</span></a><span class="mpre"> ::
     </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- ^ name of this debug stream, will be</span></span><span class="mpre">
                               </span><span class="hl_comment"><span class="mpre">--   prepended to debug output</span></span><span class="mpre">
  -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ stream the debug info will be sent to</span></span><span class="mpre">
  -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ input stream</span></span><span class="mpre">
  -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
</span><a name="loc_57_1_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_13&#39;)"><span class="hl_vardecl"><span class="mpre">debugInputBS</span></span></a><span class="mpre"> = </span><a href="#loc_32_1_32_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_11&#39;)"><span class="hl_varref"><span class="mpre">debugInput</span></span></a><span class="mpre"> </span><a href="#loc_93_1_93_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_9&#39;)"><span class="hl_varref"><span class="mpre">condense</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_68_1_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_12&#39;)"><span class="mpre">debugOutput</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)        </span><span class="hl_comment"><span class="mpre">-- ^ function to convert stream</span></span><span class="mpre">
                                        </span><span class="hl_comment"><span class="mpre">--   elements to &#39;ByteString&#39;</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">               </span><span class="hl_comment"><span class="mpre">-- ^ name of this debug stream, will be</span></span><span class="mpre">
                                        </span><span class="hl_comment"><span class="mpre">--   prepended to debug output</span></span><span class="mpre">
            -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ debug stream</span></span><span class="mpre">
            -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ output stream</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_68_1_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_12&#39;)"><span class="hl_fundecl"><span class="mpre">debugOutput</span></span></a><span class="mpre"> </span><a name="loc_68_13_68_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_13_68_17&#39;)"><span class="hl_vardecl"><span class="mpre">toBS</span></span></a><span class="mpre"> </span><a name="loc_68_18_68_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_18_68_22&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_68_23_68_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_23_68_34&#39;)"><span class="hl_vardecl"><span class="mpre">debugStream</span></span></a><span class="mpre"> </span><a name="loc_68_35_68_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_35_68_47&#39;)"><span class="hl_vardecl"><span class="mpre">outputStream</span></span></a><span class="mpre"> =
    </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">Streams.makeOutputStream</span></span></a><span class="mpre"> </span><a href="#loc_71_5_71_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
  where
    </span><a name="loc_71_5_71_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_5_71_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_71_7_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_7_71_8&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = do
        </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">Streams.write</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_75_5_75_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_13&#39;)"><span class="hl_varref"><span class="mpre">describe</span></span></a><span class="mpre"> </span><a href="#loc_71_7_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_7_71_8&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><a href="#loc_68_23_68_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_23_68_34&#39;)"><span class="hl_varref"><span class="mpre">debugStream</span></span></a><span class="mpre">
        </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">Streams.write</span></span></a><span class="mpre"> </span><a href="#loc_71_7_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_7_71_8&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_68_35_68_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_35_68_47&#39;)"><span class="hl_varref"><span class="mpre">outputStream</span></span></a><span class="mpre">

    </span><a name="loc_75_5_75_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_13&#39;)"><span class="hl_fundecl"><span class="mpre">describe</span></span></a><span class="mpre"> </span><a name="loc_75_14_75_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_14_75_15&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> [</span><a href="#loc_68_18_68_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_18_68_22&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;: got &quot;</span></span><span class="mpre">, </span><a href="#loc_77_5_77_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_18&#39;)"><span class="hl_varref"><span class="mpre">describeChunk</span></span></a><span class="mpre"> </span><a href="#loc_75_14_75_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_14_75_15&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">]

    </span><a name="loc_77_5_77_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_18&#39;)"><span class="hl_fundecl"><span class="mpre">describeChunk</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;EOF&quot;</span></span><span class="mpre">
    </span><a href="#loc_77_5_77_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_18&#39;)"><span class="hl_fundecl"><span class="mpre">describeChunk</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_78_25_78_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_25_78_26&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> [ </span><span class="hl_string"><span class="mpre">&quot;chunk: &quot;</span></span><span class="mpre">, </span><a href="#loc_68_13_68_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_13_68_17&#39;)"><span class="hl_varref"><span class="mpre">toBS</span></span></a><span class="mpre"> </span><a href="#loc_78_25_78_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_25_78_26&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">]


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_88_1_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_14&#39;)"><span class="mpre">debugOutputBS</span></a><span class="mpre"> ::
     </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- ^ name of this debug stream, will be</span></span><span class="mpre">
                               </span><span class="hl_comment"><span class="mpre">--   prepended to debug output</span></span><span class="mpre">
  -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ stream the debug info will be sent to</span></span><span class="mpre">
  -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ output stream</span></span><span class="mpre">
  -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
</span><a name="loc_88_1_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_14&#39;)"><span class="hl_vardecl"><span class="mpre">debugOutputBS</span></span></a><span class="mpre"> = </span><a href="#loc_68_1_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_12&#39;)"><span class="hl_varref"><span class="mpre">debugOutput</span></span></a><span class="mpre"> </span><a href="#loc_93_1_93_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_9&#39;)"><span class="hl_varref"><span class="mpre">condense</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_93_1_93_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_9&#39;)"><span class="mpre">condense</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_93_1_93_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_9&#39;)"><span class="hl_fundecl"><span class="mpre">condense</span></span></a><span class="mpre"> </span><a name="loc_93_10_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_10_93_11&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> | </span><a href="#loc_105_5_105_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_6&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> [ </span><span class="hl_string"><span class="mpre">&quot;\&quot;&quot;</span></span><span class="mpre">, </span><a href="#loc_93_10_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_10_93_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;\&quot;&quot;</span></span><span class="mpre"> ]
           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> [
                           </span><span class="hl_string"><span class="mpre">&quot;\&quot;&quot;</span></span><span class="mpre">
                         , </span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_104_5_104_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_6&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_93_10_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_10_93_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
                         , </span><span class="hl_string"><span class="mpre">&quot; ... &quot;</span></span><span class="mpre">
                         , </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> (</span><a href="#loc_105_5_105_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_6&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_104_5_104_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_6&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_93_10_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_10_93_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
                         , </span><span class="hl_string"><span class="mpre">&quot;\&quot; (&quot;</span></span><span class="mpre">
                         , </span><span class="hl_varref"><span class="mpre">S.pack</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_105_5_105_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_6&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
                         , </span><span class="hl_string"><span class="mpre">&quot; bytes)&quot;</span></span><span class="mpre">
                         ]
  where
    </span><a name="loc_104_5_104_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_5_104_6&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">14</span></span><span class="mpre">
    </span><a name="loc_105_5_105_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_6&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_93_10_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_10_93_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span></div></body></html>