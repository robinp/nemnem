<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE RankNTypes #-}
</span><span class="hl_comment"><span class="mpre">{-
Copyright (C) 2010 John MacFarlane &lt;jgm@berkeley.edu&gt;

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- | Functions for parsing LaTeX macro definitions and applying macros
 to LateX expressions.
-}</span></span><span class="mpre">

module Text.TeXMath.Macros ( Macro(..)
                           , pMacroDefinition
                           , pSkipSpaceComments
                           , applyMacros
                           )
where

import Data.Char (</span><a href="GHC.Unicode.html#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_103_1_103_8&#39;)"><span class="mpre">isDigit</span></a><span class="mpre">, </span><a href="Data.Char.html#loc_122_1_122_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Char.html#loc_122_1_122_9&#39;)"><span class="mpre">isLetter</span></a><span class="mpre">)
import Control.Monad
import Text.ParserCombinators.Parsec

data </span><a name="loc_35_6_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_11&#39;)"><span class="hl_tycondecl"><span class="mpre">Macro</span></span></a><span class="mpre"> = </span><a name="loc_35_14_35_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_14_35_19&#39;)"><span class="hl_condecl"><span class="mpre">Macro</span></span></a><span class="mpre"> { </span><a name="loc_35_22_35_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_22_35_37&#39;)"><span class="hl_fielddecl"><span class="mpre">macroDefinition</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                   , </span><a name="loc_36_22_36_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_22_36_33&#39;)"><span class="hl_fielddecl"><span class="mpre">macroParser</span></span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> . </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> }

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_35_6_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_11&#39;)"><span class="hl_tyconref"><span class="mpre">Macro</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> </span><a name="loc_39_8_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_8_39_9&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;Macro &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_35_22_35_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_22_35_37&#39;)"><span class="hl_varref"><span class="mpre">macroDefinition</span></span></a><span class="mpre"> </span><a href="#loc_39_8_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_8_39_9&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Parses a @\\newcommand@ or @\\renewcommand@ macro definition and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- returns a &#39;Macro&#39;.</span></span><span class="mpre">
</span><a href="#loc_44_1_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_17&#39;)"><span class="mpre">pMacroDefinition</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><a href="#loc_35_6_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_11&#39;)"><span class="hl_tyconref"><span class="mpre">Macro</span></span></a><span class="mpre">
</span><a name="loc_44_1_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_17&#39;)"><span class="hl_vardecl"><span class="mpre">pMacroDefinition</span></span></a><span class="mpre"> = </span><a href="#loc_86_1_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_11&#39;)"><span class="hl_varref"><span class="mpre">newcommand</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Skip whitespace and comments.</span></span><span class="mpre">
</span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="mpre">pSkipSpaceComments</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_vardecl"><span class="mpre">pSkipSpaceComments</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">spaces</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Text.Parsec.Prim.html#loc_562_1_562_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_562_1_562_9&#39;)"><span class="hl_varref"><span class="mpre">skipMany</span></span></a><span class="mpre"> (</span><a href="#loc_137_1_137_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_8&#39;)"><span class="hl_varref"><span class="mpre">comment</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">spaces</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Applies a list of macros to a string recursively until a fixed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- point is reached.  If there are several macros in the list with the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- same name, earlier ones will shadow later ones.</span></span><span class="mpre">
</span><a href="#loc_54_1_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_12&#39;)"><span class="mpre">applyMacros</span></a><span class="mpre"> :: [</span><a href="#loc_35_6_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_11&#39;)"><span class="hl_tyconref"><span class="mpre">Macro</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_54_1_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_12&#39;)"><span class="hl_fundecl"><span class="mpre">applyMacros</span></span></a><span class="mpre"> [] = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><a href="#loc_54_1_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_12&#39;)"><span class="hl_fundecl"><span class="mpre">applyMacros</span></span></a><span class="mpre"> </span><a name="loc_55_13_55_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_13_55_15&#39;)"><span class="hl_vardecl"><span class="mpre">ms</span></span></a><span class="mpre"> = </span><a href="#loc_60_1_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_20&#39;)"><span class="hl_varref"><span class="mpre">iterateToFixedPoint</span></span></a><span class="mpre"> ((</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_55_13_55_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_13_55_15&#39;)"><span class="hl_varref"><span class="mpre">ms</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_70_1_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_16&#39;)"><span class="hl_varref"><span class="mpre">applyMacrosOnce</span></span></a><span class="mpre"> </span><a href="#loc_55_13_55_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_13_55_15&#39;)"><span class="hl_varref"><span class="mpre">ms</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_60_1_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_20&#39;)"><span class="mpre">iterateToFixedPoint</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/texmath-0.4/Text/TeXMath/Macros.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 24, srcSpanEndLine = 59, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/texmath-0.4/Text/TeXMath/Macros.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 29, srcSpanEndLine = 59, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/texmath-0.4/Text"><span class="mpre">Eq a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_60_1_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_20&#39;)"><span class="hl_fundecl"><span class="mpre">iterateToFixedPoint</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">     _ _ = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_string"><span class="mpre">&quot;Macro application did not terminate in a reasonable time.\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
  </span><span class="hl_string"><span class="mpre">&quot;Check your macros for loops.&quot;</span></span><span class="mpre">
</span><a href="#loc_60_1_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_20&#39;)"><span class="hl_fundecl"><span class="mpre">iterateToFixedPoint</span></span></a><span class="mpre"> </span><a name="loc_63_21_63_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_21_63_26&#39;)"><span class="hl_vardecl"><span class="mpre">limit</span></span></a><span class="mpre"> </span><a name="loc_63_27_63_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_27_63_28&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_63_29_63_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_29_63_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> =
  if </span><a href="#loc_67_11_67_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_11_67_13&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_63_29_63_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_29_63_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
     then </span><a href="#loc_67_11_67_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_11_67_13&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre">
     else </span><a href="#loc_60_1_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_20&#39;)"><span class="hl_varref"><span class="mpre">iterateToFixedPoint</span></span></a><span class="mpre"> (</span><a href="#loc_63_21_63_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_21_63_26&#39;)"><span class="hl_varref"><span class="mpre">limit</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_63_27_63_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_27_63_28&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_67_11_67_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_11_67_13&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre">
    where </span><a name="loc_67_11_67_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_11_67_13&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_63_27_63_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_27_63_28&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_63_29_63_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_29_63_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_70_1_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_16&#39;)"><span class="mpre">applyMacrosOnce</span></a><span class="mpre"> :: [</span><a href="#loc_35_6_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_11&#39;)"><span class="hl_tyconref"><span class="mpre">Macro</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_70_1_70_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_16&#39;)"><span class="hl_fundecl"><span class="mpre">applyMacrosOnce</span></span></a><span class="mpre"> </span><a name="loc_70_17_70_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_17_70_19&#39;)"><span class="hl_vardecl"><span class="mpre">ms</span></span></a><span class="mpre"> </span><a name="loc_70_20_70_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_20_70_21&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
  case </span><a href="Text.Parsec.Prim.html#loc_642_1_642_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_642_1_642_6&#39;)"><span class="hl_varref"><span class="mpre">parse</span></span></a><span class="mpre"> (</span><a href="Text.Parsec.Prim.html#loc_552_1_552_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_552_1_552_5&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_74_11_74_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_11_74_14&#39;)"><span class="hl_varref"><span class="mpre">tok</span></span></a><span class="mpre">) </span><span class="hl_string"><span class="mpre">&quot;input&quot;</span></span><span class="mpre"> </span><a href="#loc_70_20_70_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_20_70_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
       </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_72_14_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_14_72_15&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_72_14_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_14_72_15&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
       </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> _  -&gt; </span><a href="#loc_70_20_70_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_20_70_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- just return original on error</span></span><span class="mpre">
    where </span><a name="loc_74_11_74_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_11_74_14&#39;)"><span class="hl_vardecl"><span class="mpre">tok</span></span></a><span class="mpre"> = </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
                  </span><a href="#loc_134_1_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_12&#39;)"><span class="hl_varref"><span class="mpre">skipComment</span></span></a><span class="mpre">
                  </span><a href="Text.Parsec.Combinator.html#loc_40_1_40_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_40_1_40_7&#39;)"><span class="hl_varref"><span class="mpre">choice</span></span></a><span class="mpre"> [ </span><a href="#loc_157_1_157_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_8&#39;)"><span class="hl_varref"><span class="mpre">escaped</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\\&quot;</span></span><span class="mpre">
                         , </span><a href="Text.Parsec.Combinator.html#loc_40_1_40_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_40_1_40_7&#39;)"><span class="hl_varref"><span class="mpre">choice</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_36_22_36_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_22_36_33&#39;)"><span class="hl_varref"><span class="mpre">macroParser</span></span></a><span class="mpre"> </span><a href="#loc_70_17_70_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_17_70_19&#39;)"><span class="hl_varref"><span class="mpre">ms</span></span></a><span class="mpre">)
                         , </span><a href="#loc_80_11_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_11_80_18&#39;)"><span class="hl_varref"><span class="mpre">ctrlseq</span></span></a><span class="mpre">
                         , </span><a href="Text.Parsec.Combinator.html#loc_165_1_165_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_165_1_165_6&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">anyChar</span></span><span class="mpre"> ]
          </span><a name="loc_80_11_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_11_80_18&#39;)"><span class="hl_vardecl"><span class="mpre">ctrlseq</span></span></a><span class="mpre"> = do
                    </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\\&#39;</span></span><span class="mpre">
                    </span><a name="loc_82_21_82_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_21_82_24&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_94_1_94_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_94_1_94_6&#39;)"><span class="hl_varref"><span class="mpre">many1</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">letter</span></span><span class="mpre"> </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Text.Parsec.Combinator.html#loc_165_1_165_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_165_1_165_6&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">anyChar</span></span><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\\&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_82_21_82_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_21_82_24&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">

</span><a href="#loc_86_1_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_11&#39;)"><span class="mpre">newcommand</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><a href="#loc_35_6_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_11&#39;)"><span class="hl_tyconref"><span class="mpre">Macro</span></span></a><span class="mpre">
</span><a name="loc_86_1_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_11&#39;)"><span class="hl_vardecl"><span class="mpre">newcommand</span></span></a><span class="mpre"> = </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
  </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\\&#39;</span></span><span class="mpre">
  </span><a href="Text.Parsec.Combinator.html#loc_65_1_65_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_65_1_65_9&#39;)"><span class="hl_varref"><span class="mpre">optional</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">string</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;re&quot;</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">string</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;newcommand&quot;</span></span><span class="mpre">
  </span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_varref"><span class="mpre">pSkipSpaceComments</span></span></a><span class="mpre">
  </span><a name="loc_91_3_91_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_3_91_7&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_168_1_168_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_9&#39;)"><span class="hl_varref"><span class="mpre">inbraces</span></span></a><span class="mpre">
  </span><a href="Control.Monad.html#loc_148_1_148_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_148_1_148_6&#39;)"><span class="hl_varref"><span class="mpre">guard</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_91_3_91_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_3_91_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\\&quot;</span></span><span class="mpre">)
  let </span><a name="loc_93_7_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_7_93_12&#39;)"><span class="hl_vardecl"><span class="mpre">name&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_91_3_91_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_3_91_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">
  </span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_varref"><span class="mpre">pSkipSpaceComments</span></span></a><span class="mpre">
  </span><a name="loc_95_3_95_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_3_95_10&#39;)"><span class="hl_vardecl"><span class="mpre">numargs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_144_1_144_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_8&#39;)"><span class="hl_varref"><span class="mpre">numArgs</span></span></a><span class="mpre">
  </span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_varref"><span class="mpre">pSkipSpaceComments</span></span></a><span class="mpre">
  </span><a name="loc_97_3_97_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_3_97_9&#39;)"><span class="hl_vardecl"><span class="mpre">optarg</span></span></a><span class="mpre"> &lt;- if </span><a href="#loc_95_3_95_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_3_95_10&#39;)"><span class="hl_varref"><span class="mpre">numargs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
               then </span><a href="#loc_154_1_154_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_7&#39;)"><span class="hl_varref"><span class="mpre">optArg</span></span></a><span class="mpre">
               else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
  let </span><a name="loc_100_7_100_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_7_100_15&#39;)"><span class="hl_vardecl"><span class="mpre">numargs&#39;</span></span></a><span class="mpre"> = case </span><a href="#loc_97_3_97_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_3_97_9&#39;)"><span class="hl_varref"><span class="mpre">optarg</span></span></a><span class="mpre"> of
                   </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> _  -&gt; </span><a href="#loc_95_3_95_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_3_95_10&#39;)"><span class="hl_varref"><span class="mpre">numargs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                   </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_95_3_95_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_3_95_10&#39;)"><span class="hl_varref"><span class="mpre">numargs</span></span></a><span class="mpre">
  </span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_varref"><span class="mpre">pSkipSpaceComments</span></span></a><span class="mpre">
  </span><a name="loc_104_3_104_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_7&#39;)"><span class="hl_vardecl"><span class="mpre">body</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_168_1_168_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_9&#39;)"><span class="hl_varref"><span class="mpre">inbraces</span></span></a><span class="mpre">
  let </span><a name="loc_105_7_105_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_7_105_11&#39;)"><span class="hl_vardecl"><span class="mpre">defn</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;\\newcommand{&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_91_3_91_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_3_91_7&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;}&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
             (if </span><a href="#loc_95_3_95_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_3_95_10&#39;)"><span class="hl_varref"><span class="mpre">numargs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then (</span><span class="hl_string"><span class="mpre">&quot;[&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_95_3_95_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_3_95_10&#39;)"><span class="hl_varref"><span class="mpre">numargs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;]&quot;</span></span><span class="mpre">) else </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
             case </span><a href="#loc_97_3_97_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_3_97_9&#39;)"><span class="hl_varref"><span class="mpre">optarg</span></span></a><span class="mpre"> of { </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_107_51_107_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_51_107_52&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><span class="hl_string"><span class="mpre">&quot;[&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_107_51_107_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_51_107_52&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;]&quot;</span></span><span class="mpre">} </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
             </span><span class="hl_string"><span class="mpre">&quot;{&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_104_3_104_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_7&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;}&quot;</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_35_14_35_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_14_35_19&#39;)"><span class="hl_conref"><span class="mpre">Macro</span></span></a><span class="mpre"> </span><a href="#loc_105_7_105_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_7_105_11&#39;)"><span class="hl_varref"><span class="mpre">defn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\\&#39;</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">string</span></span><span class="mpre"> </span><a href="#loc_93_7_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_7_93_12&#39;)"><span class="hl_varref"><span class="mpre">name&#39;</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><a href="Data.Char.html#loc_122_1_122_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Char.html#loc_122_1_122_9&#39;)"><span class="hl_varref"><span class="mpre">isLetter</span></span></a><span class="mpre"> </span><a href="#loc_93_7_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_7_93_12&#39;)"><span class="hl_varref"><span class="mpre">name&#39;</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
      </span><a href="Text.Parsec.Combinator.html#loc_257_1_257_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_257_1_257_14&#39;)"><span class="hl_varref"><span class="mpre">notFollowedBy</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">letter</span></span><span class="mpre">
    </span><a name="loc_114_5_114_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_8&#39;)"><span class="hl_vardecl"><span class="mpre">opt</span></span></a><span class="mpre"> &lt;- case </span><a href="#loc_97_3_97_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_3_97_9&#39;)"><span class="hl_varref"><span class="mpre">optarg</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> _   -&gt; </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> (</span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_infix"><span class="mpre">`mplus`</span></span></a><span class="mpre"> </span><a href="#loc_97_3_97_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_3_97_9&#39;)"><span class="hl_varref"><span class="mpre">optarg</span></span></a><span class="mpre">) </span><a href="#loc_154_1_154_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_7&#39;)"><span class="hl_varref"><span class="mpre">optArg</span></span></a><span class="mpre">
    </span><a name="loc_117_5_117_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_9&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_165_1_165_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_165_1_165_6&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><a href="#loc_100_7_100_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_7_100_15&#39;)"><span class="hl_varref"><span class="mpre">numargs&#39;</span></span></a><span class="mpre"> </span><a href="#loc_168_1_168_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_9&#39;)"><span class="hl_varref"><span class="mpre">inbraces</span></span></a><span class="mpre">
    let </span><a name="loc_118_9_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_14&#39;)"><span class="hl_vardecl"><span class="mpre">args&#39;</span></span></a><span class="mpre"> = case </span><a href="#loc_114_5_114_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_8&#39;)"><span class="hl_varref"><span class="mpre">opt</span></span></a><span class="mpre"> of
                     </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_119_27_119_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_27_119_28&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">  -&gt; </span><a href="#loc_119_27_119_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_27_119_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_117_5_117_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_9&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">
                     </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_117_5_117_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_9&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a href="#loc_118_9_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_14&#39;)"><span class="hl_varref"><span class="mpre">args&#39;</span></span></a><span class="mpre"> </span><a href="#loc_104_3_104_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_7&#39;)"><span class="hl_varref"><span class="mpre">body</span></span></a><span class="mpre">

</span><a href="#loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="mpre">apply</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="hl_fundecl"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a name="loc_124_7_124_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_11&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;#&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_124_17_124_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_17_124_18&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_124_19_124_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_19_124_21&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) | </span><a href="GHC.Unicode.html#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_103_1_103_8&#39;)"><span class="hl_varref"><span class="mpre">isDigit</span></span></a><span class="mpre"> </span><a href="#loc_124_17_124_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_17_124_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> =
  let </span><a name="loc_125_7_125_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_7_125_13&#39;)"><span class="hl_vardecl"><span class="mpre">argnum</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">read</span></span><span class="mpre"> [</span><a href="#loc_124_17_124_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_17_124_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">]
  in  if </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_124_7_124_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_11&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_125_7_125_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_7_125_13&#39;)"><span class="hl_varref"><span class="mpre">argnum</span></span></a><span class="mpre">
         then </span><a href="#loc_124_7_124_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_11&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!!</span></span><span class="mpre"> (</span><a href="#loc_125_7_125_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_7_125_13&#39;)"><span class="hl_varref"><span class="mpre">argnum</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a href="#loc_124_7_124_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_11&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><a href="#loc_124_19_124_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_19_124_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
         else </span><span class="hl_char"><span class="mpre">&#39;#&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_124_17_124_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_17_124_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a href="#loc_124_7_124_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_7_124_11&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><a href="#loc_124_19_124_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_19_124_21&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
</span><a href="#loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="hl_fundecl"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a name="loc_129_7_129_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_7_129_11&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\\&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;#&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_129_22_129_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_22_129_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><span class="hl_char"><span class="mpre">&#39;\\&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;#&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a href="#loc_129_7_129_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_7_129_11&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><a href="#loc_129_22_129_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_22_129_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
</span><a href="#loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="hl_fundecl"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a name="loc_130_7_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_7_130_11&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> (</span><a name="loc_130_13_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_13_130_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_130_15_130_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_15_130_17&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_130_13_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_13_130_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="hl_varref"><span class="mpre">apply</span></span></a><span class="mpre"> </span><a href="#loc_130_7_130_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_7_130_11&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><a href="#loc_130_15_130_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_15_130_17&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
</span><a href="#loc_124_1_124_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_6&#39;)"><span class="hl_fundecl"><span class="mpre">apply</span></span></a><span class="mpre"> _ </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">

</span><a href="#loc_134_1_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_12&#39;)"><span class="mpre">skipComment</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_134_1_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_12&#39;)"><span class="hl_vardecl"><span class="mpre">skipComment</span></span></a><span class="mpre"> = </span><a href="Text.Parsec.Prim.html#loc_562_1_562_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_562_1_562_9&#39;)"><span class="hl_varref"><span class="mpre">skipMany</span></span></a><span class="mpre"> </span><a href="#loc_137_1_137_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_8&#39;)"><span class="hl_varref"><span class="mpre">comment</span></span></a><span class="mpre">

</span><a href="#loc_137_1_137_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_8&#39;)"><span class="mpre">comment</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_137_1_137_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_8&#39;)"><span class="hl_vardecl"><span class="mpre">comment</span></span></a><span class="mpre"> = do
  </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;%&#39;</span></span><span class="mpre">
  </span><a href="Text.Parsec.Prim.html#loc_562_1_562_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_562_1_562_9&#39;)"><span class="hl_varref"><span class="mpre">skipMany</span></span></a><span class="mpre"> (</span><a href="Text.Parsec.Combinator.html#loc_257_1_257_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_257_1_257_14&#39;)"><span class="hl_varref"><span class="mpre">notFollowedBy</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">newline</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">anyChar</span></span><span class="mpre">)
  </span><span class="hl_varref"><span class="mpre">newline</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_144_1_144_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_8&#39;)"><span class="mpre">numArgs</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_144_1_144_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_8&#39;)"><span class="hl_vardecl"><span class="mpre">numArgs</span></span></a><span class="mpre"> = </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="hl_varref"><span class="mpre">option</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
  </span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_varref"><span class="mpre">pSkipSpaceComments</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;[&#39;</span></span><span class="mpre">
  </span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_varref"><span class="mpre">pSkipSpaceComments</span></span></a><span class="mpre">
  </span><a name="loc_148_3_148_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_3_148_4&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">digit</span></span><span class="mpre">
  </span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_varref"><span class="mpre">pSkipSpaceComments</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;]&#39;</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">read</span></span><span class="mpre"> [</span><a href="#loc_148_3_148_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_3_148_4&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">]

</span><a href="#loc_154_1_154_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_7&#39;)"><span class="mpre">optArg</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_154_1_154_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_7&#39;)"><span class="hl_vardecl"><span class="mpre">optArg</span></span></a><span class="mpre"> = </span><a href="Text.Parsec.Combinator.html#loc_51_1_51_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_51_1_51_7&#39;)"><span class="hl_varref"><span class="mpre">option</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_160_1_160_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_11&#39;)"><span class="hl_varref"><span class="mpre">inBrackets</span></span></a><span class="mpre">)

</span><a href="#loc_157_1_157_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_8&#39;)"><span class="mpre">escaped</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_157_1_157_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_8&#39;)"><span class="hl_fundecl"><span class="mpre">escaped</span></span></a><span class="mpre"> </span><a name="loc_157_9_157_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_11&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\\&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">oneOf</span></span><span class="mpre"> </span><a href="#loc_157_9_157_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_11&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_157_47_157_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_47_157_48&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><span class="hl_char"><span class="mpre">&#39;\\&#39;</span></span><span class="mpre">,</span><a href="#loc_157_47_157_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_47_157_48&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]

</span><a href="#loc_160_1_160_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_11&#39;)"><span class="mpre">inBrackets</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_160_1_160_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_11&#39;)"><span class="hl_vardecl"><span class="mpre">inBrackets</span></span></a><span class="mpre"> = </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
  </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;[&#39;</span></span><span class="mpre">
  </span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_varref"><span class="mpre">pSkipSpaceComments</span></span></a><span class="mpre">
  </span><a name="loc_163_3_163_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_3_163_6&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_273_1_273_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_273_1_273_9&#39;)"><span class="hl_varref"><span class="mpre">manyTill</span></span></a><span class="mpre"> (</span><a href="#loc_134_1_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_12&#39;)"><span class="hl_varref"><span class="mpre">skipComment</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> (</span><a href="#loc_157_1_157_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_8&#39;)"><span class="hl_varref"><span class="mpre">escaped</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;[]&quot;</span></span><span class="mpre"> </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Text.Parsec.Combinator.html#loc_165_1_165_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_165_1_165_6&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">anyChar</span></span><span class="mpre">))
          (</span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_48_1_48_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_19&#39;)"><span class="hl_varref"><span class="mpre">pSkipSpaceComments</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;]&#39;</span></span><span class="mpre">)
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_163_3_163_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_3_163_6&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">

</span><a href="#loc_168_1_168_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_9&#39;)"><span class="mpre">inbraces</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_168_1_168_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_9&#39;)"><span class="hl_vardecl"><span class="mpre">inbraces</span></span></a><span class="mpre"> = </span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
  </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="mpre">
  </span><a name="loc_170_3_170_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_3_170_6&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="Text.Parsec.Combinator.html#loc_273_1_273_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_273_1_273_9&#39;)"><span class="hl_varref"><span class="mpre">manyTill</span></span></a><span class="mpre"> (</span><a href="#loc_134_1_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_12&#39;)"><span class="hl_varref"><span class="mpre">skipComment</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> (</span><a href="#loc_175_1_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_10&#39;)"><span class="hl_varref"><span class="mpre">inbraces&#39;</span></span></a><span class="mpre"> </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Text.Parsec.Combinator.html#loc_165_1_165_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Combinator.html#loc_165_1_165_6&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">anyChar</span></span><span class="mpre"> </span><a href="Text.Parsec.Prim.html#loc_330_4_330_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Parsec.Prim.html#loc_330_4_330_7&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="#loc_157_1_157_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_8&#39;)"><span class="hl_varref"><span class="mpre">escaped</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;{}&quot;</span></span><span class="mpre">))
    (</span><a href="Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Parsec.Prim.html#loc_65_1_65_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_134_1_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_12&#39;)"><span class="hl_varref"><span class="mpre">skipComment</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">char</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;}&#39;</span></span><span class="mpre">)
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_170_3_170_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_3_170_6&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">

</span><a href="#loc_175_1_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_10&#39;)"><span class="mpre">inbraces&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenParser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_175_1_175_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_10&#39;)"><span class="hl_vardecl"><span class="mpre">inbraces&#39;</span></span></a><span class="mpre"> = do
  </span><a name="loc_176_3_176_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_3_176_6&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_168_1_168_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_9&#39;)"><span class="hl_varref"><span class="mpre">inbraces</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (</span><a href="#loc_176_3_176_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_3_176_6&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;}&quot;</span></span><span class="mpre">)

</span></div></body></html>