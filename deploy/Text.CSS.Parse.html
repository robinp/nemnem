<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
</span><span class="hl_comment"><span class="mpre">-- | Parse CSS with parseNestedBlocks and render it with renderNestedBlock</span></span><span class="mpre">
module Text.CSS.Parse
    ( NestedBlock(..)
    , parseNestedBlocks
    , parseBlocks
    , parseBlock
    , attrParser
    , attrsParser
    , blockParser
    , blocksParser
    , parseAttr
    , parseAttrs
    ) where

import Prelude hiding (takeWhile, take)
import Data.Attoparsec.Text
import Data.Text (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="mpre">Text</span></a><span class="mpre">, </span><a href="Data.Text.html#loc_1170_1_1170_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1170_1_1170_6&#39;)"><span class="mpre">strip</span></a><span class="mpre">)
import Control.Applicative (</span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="mpre">(&lt;|&gt;)</span></a><span class="mpre">, </span><a href="Control.Applicative.html#loc_152_5_152_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_152_5_152_9&#39;)"><span class="mpre">many</span></a><span class="mpre">, </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">)
import Data.Char (</span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="mpre">isSpace</span></a><span class="mpre">)

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/css-text-0.1.2.1/Text/CSS/Parse.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 1, srcSpanEndLine = 22, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/css-text-0.1.2.1/Text/CSS/Parse.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 1, srcSpanEndLine = 22, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/css-text-0.1.2.1/Text/CSS/Parse.hs&quot;, srcSpanStartLine = 22"><span class="mpre">type CssBlock = (Text, [(Text, Text)])</span></span><span class="mpre">
data </span><a name="loc_23_6_23_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_6_23_17&#39;)"><span class="hl_tycondecl"><span class="mpre">NestedBlock</span></span></a><span class="mpre"> = </span><a name="loc_23_20_23_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_20_23_31&#39;)"><span class="hl_condecl"><span class="mpre">NestedBlock</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> [</span><a href="#loc_23_6_23_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_6_23_17&#39;)"><span class="hl_tyconref"><span class="mpre">NestedBlock</span></span></a><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ for example a media query</span></span><span class="mpre">
                 | </span><a name="loc_24_20_24_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_20_24_29&#39;)"><span class="hl_condecl"><span class="mpre">LeafBlock</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CssBlock</span></span><span class="mpre">
                 </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/css-text-0.1.2.1/Text/CSS/Parse.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 18, srcSpanEndLine = 25, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/css-text-0.1.2.1/Text/CSS/Parse.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 18, srcSpanEndLine = 25, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/css-text-0.1.2.1/Text/CSS/Parse.hs&quot;, srcSpanStartLine ="><span class="mpre">deriving (Eq, Show)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The preferred parser, will capture media queries</span></span><span class="mpre">
</span><a href="#loc_29_1_29_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_18&#39;)"><span class="mpre">parseNestedBlocks</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> [</span><a href="#loc_23_6_23_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_6_23_17&#39;)"><span class="hl_tyconref"><span class="mpre">NestedBlock</span></span></a><span class="mpre">]
</span><a name="loc_29_1_29_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_18&#39;)"><span class="hl_vardecl"><span class="mpre">parseNestedBlocks</span></span></a><span class="mpre"> = </span><a href="Data.Attoparsec.Text.Internal.html#loc_431_1_431_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_431_1_431_10&#39;)"><span class="hl_varref"><span class="mpre">parseOnly</span></span></a><span class="mpre"> </span><a href="#loc_127_1_127_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_19&#39;)"><span class="hl_varref"><span class="mpre">nestedBlocksParser</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The original parser of basic CSS, but throws out media queries</span></span><span class="mpre">
</span><a href="#loc_33_1_33_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_12&#39;)"><span class="mpre">parseBlocks</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">CssBlock</span></span><span class="mpre">]
</span><a name="loc_33_1_33_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_12&#39;)"><span class="hl_vardecl"><span class="mpre">parseBlocks</span></span></a><span class="mpre"> = </span><a href="Data.Attoparsec.Text.Internal.html#loc_431_1_431_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_431_1_431_10&#39;)"><span class="hl_varref"><span class="mpre">parseOnly</span></span></a><span class="mpre"> </span><a href="#loc_124_1_124_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_13&#39;)"><span class="hl_varref"><span class="mpre">blocksParser</span></span></a><span class="mpre">

</span><a href="#loc_36_1_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_11&#39;)"><span class="mpre">parseBlock</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CssBlock</span></span><span class="mpre">
</span><a name="loc_36_1_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_11&#39;)"><span class="hl_vardecl"><span class="mpre">parseBlock</span></span></a><span class="mpre"> = </span><a href="Data.Attoparsec.Text.Internal.html#loc_431_1_431_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_431_1_431_10&#39;)"><span class="hl_varref"><span class="mpre">parseOnly</span></span></a><span class="mpre"> </span><a href="#loc_76_1_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_12&#39;)"><span class="hl_varref"><span class="mpre">blockParser</span></span></a><span class="mpre">

</span><a href="#loc_39_1_39_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_11&#39;)"><span class="mpre">parseAttrs</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> [(</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">, </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">)]
</span><a name="loc_39_1_39_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_11&#39;)"><span class="hl_vardecl"><span class="mpre">parseAttrs</span></span></a><span class="mpre"> = </span><a href="Data.Attoparsec.Text.Internal.html#loc_431_1_431_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_431_1_431_10&#39;)"><span class="hl_varref"><span class="mpre">parseOnly</span></span></a><span class="mpre"> </span><a href="#loc_69_1_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_12&#39;)"><span class="hl_varref"><span class="mpre">attrsParser</span></span></a><span class="mpre">

</span><a href="#loc_42_1_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_10&#39;)"><span class="mpre">parseAttr</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">, </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">)
</span><a name="loc_42_1_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_10&#39;)"><span class="hl_vardecl"><span class="mpre">parseAttr</span></span></a><span class="mpre"> = </span><a href="Data.Attoparsec.Text.Internal.html#loc_431_1_431_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_431_1_431_10&#39;)"><span class="hl_varref"><span class="mpre">parseOnly</span></span></a><span class="mpre"> </span><a href="#loc_58_1_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_11&#39;)"><span class="hl_varref"><span class="mpre">attrParser</span></span></a><span class="mpre">


</span><a href="#loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="mpre">skipWS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="hl_vardecl"><span class="mpre">skipWS</span></span></a><span class="mpre"> = (</span><a href="Data.Attoparsec.Text.Internal.html#loc_162_1_162_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_162_1_162_7&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/*&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_50_5_50_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_15&#39;)"><span class="hl_varref"><span class="mpre">endComment</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="hl_varref"><span class="mpre">skipWS</span></span></a><span class="mpre">)
     </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> (</span><a href="Data.Attoparsec.Text.Internal.html#loc_114_1_114_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_114_1_114_5&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Data.Attoparsec.Text.Internal.html#loc_206_1_206_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_206_1_206_10&#39;)"><span class="hl_varref"><span class="mpre">skipWhile</span></span></a><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="hl_varref"><span class="mpre">skipWS</span></span></a><span class="mpre">)
     </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
  where
    </span><a name="loc_50_5_50_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_15&#39;)"><span class="hl_vardecl"><span class="mpre">endComment</span></span></a><span class="mpre"> = do
        </span><a href="Data.Attoparsec.Text.Internal.html#loc_206_1_206_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_206_1_206_10&#39;)"><span class="hl_varref"><span class="mpre">skipWhile</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;*&#39;</span></span><span class="mpre">)
        (do
            _ &lt;- </span><a href="Data.Attoparsec.Text.Internal.html#loc_362_1_362_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_362_1_362_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;*&#39;</span></span><span class="mpre">
            (</span><a href="Data.Attoparsec.Text.Internal.html#loc_362_1_362_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_362_1_362_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;/&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="#loc_50_5_50_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_15&#39;)"><span class="hl_varref"><span class="mpre">endComment</span></span></a><span class="mpre">
            ) </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Missing end comment&quot;</span></span><span class="mpre">

</span><a href="#loc_58_1_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_11&#39;)"><span class="mpre">attrParser</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">, </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">)
</span><a name="loc_58_1_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_11&#39;)"><span class="hl_vardecl"><span class="mpre">attrParser</span></span></a><span class="mpre"> = do
    </span><a href="#loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="hl_varref"><span class="mpre">skipWS</span></span></a><span class="mpre">
    </span><a name="loc_60_5_60_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_8&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Attoparsec.Text.Internal.html#loc_323_1_323_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_323_1_323_11&#39;)"><span class="hl_varref"><span class="mpre">takeWhile1</span></span></a><span class="mpre"> (\</span><a name="loc_60_25_60_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_25_60_26&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_60_25_60_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_25_60_26&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_60_25_60_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_25_60_26&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_60_25_60_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_25_60_26&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;}&#39;</span></span><span class="mpre">)
    _ &lt;- </span><a href="Data.Attoparsec.Text.Internal.html#loc_362_1_362_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_362_1_362_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre"> </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Missing colon in attribute&quot;</span></span><span class="mpre">
    </span><a name="loc_62_5_62_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_10&#39;)"><span class="hl_vardecl"><span class="mpre">value</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_66_1_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_12&#39;)"><span class="hl_varref"><span class="mpre">valueParser</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Data.Text.html#loc_1170_1_1170_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1170_1_1170_6&#39;)"><span class="hl_varref"><span class="mpre">strip</span></span></a><span class="mpre"> </span><a href="#loc_60_5_60_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_8&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre">, </span><a href="Data.Text.html#loc_1170_1_1170_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1170_1_1170_6&#39;)"><span class="hl_varref"><span class="mpre">strip</span></span></a><span class="mpre"> </span><a href="#loc_62_5_62_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_10&#39;)"><span class="hl_varref"><span class="mpre">value</span></span></a><span class="mpre">)

</span><a href="#loc_66_1_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_12&#39;)"><span class="mpre">valueParser</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_66_1_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_12&#39;)"><span class="hl_vardecl"><span class="mpre">valueParser</span></span></a><span class="mpre"> = </span><a href="Data.Attoparsec.Text.Internal.html#loc_239_1_239_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_239_1_239_10&#39;)"><span class="hl_varref"><span class="mpre">takeWhile</span></span></a><span class="mpre"> (\</span><a name="loc_66_27_66_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_27_66_28&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_66_27_66_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_27_66_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;;&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_66_27_66_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_27_66_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;}&#39;</span></span><span class="mpre">)

</span><a href="#loc_69_1_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_12&#39;)"><span class="mpre">attrsParser</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> [(</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">, </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">)]
</span><a name="loc_69_1_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_12&#39;)"><span class="hl_vardecl"><span class="mpre">attrsParser</span></span></a><span class="mpre"> = (do
    </span><a name="loc_70_5_70_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_5_70_6&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_58_1_58_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_11&#39;)"><span class="hl_varref"><span class="mpre">attrParser</span></span></a><span class="mpre">
    (</span><a href="Data.Attoparsec.Text.Internal.html#loc_362_1_362_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_362_1_362_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;;&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="hl_varref"><span class="mpre">skipWS</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> ((</span><a href="#loc_70_5_70_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_5_70_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_69_1_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_12&#39;)"><span class="hl_varref"><span class="mpre">attrsParser</span></span></a><span class="mpre">))
      </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_70_5_70_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_5_70_6&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">]
  ) </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []

</span><a href="#loc_76_1_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_12&#39;)"><span class="mpre">blockParser</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">, [(</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">, </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">)])
</span><a name="loc_76_1_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_12&#39;)"><span class="hl_vardecl"><span class="mpre">blockParser</span></span></a><span class="mpre"> = do
    </span><a href="#loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="hl_varref"><span class="mpre">skipWS</span></span></a><span class="mpre">
    </span><a name="loc_78_5_78_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_8&#39;)"><span class="hl_vardecl"><span class="mpre">sel</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Attoparsec.Text.Internal.html#loc_239_1_239_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_239_1_239_10&#39;)"><span class="hl_varref"><span class="mpre">takeWhile</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="mpre">)
    _ &lt;- </span><a href="Data.Attoparsec.Text.Internal.html#loc_362_1_362_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_362_1_362_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="mpre">
    </span><a name="loc_80_5_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_10&#39;)"><span class="hl_vardecl"><span class="mpre">attrs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_69_1_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_12&#39;)"><span class="hl_varref"><span class="mpre">attrsParser</span></span></a><span class="mpre">
    </span><a href="#loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="hl_varref"><span class="mpre">skipWS</span></span></a><span class="mpre">
    _ &lt;- </span><a href="Data.Attoparsec.Text.Internal.html#loc_362_1_362_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_362_1_362_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;}&#39;</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Data.Text.html#loc_1170_1_1170_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1170_1_1170_6&#39;)"><span class="hl_varref"><span class="mpre">strip</span></span></a><span class="mpre"> </span><a href="#loc_78_5_78_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_8&#39;)"><span class="hl_varref"><span class="mpre">sel</span></span></a><span class="mpre">, </span><a href="#loc_80_5_80_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_10&#39;)"><span class="hl_varref"><span class="mpre">attrs</span></span></a><span class="mpre">)

</span><a href="#loc_86_1_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_18&#39;)"><span class="mpre">nestedBlockParser</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> </span><a href="#loc_23_6_23_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_6_23_17&#39;)"><span class="hl_tyconref"><span class="mpre">NestedBlock</span></span></a><span class="mpre">
</span><a name="loc_86_1_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_18&#39;)"><span class="hl_vardecl"><span class="mpre">nestedBlockParser</span></span></a><span class="mpre"> = do
    </span><a href="#loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="hl_varref"><span class="mpre">skipWS</span></span></a><span class="mpre">
    </span><a name="loc_88_5_88_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_5_88_8&#39;)"><span class="hl_vardecl"><span class="mpre">sel</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Text.html#loc_1170_1_1170_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1170_1_1170_6&#39;)"><span class="hl_varref"><span class="mpre">strip</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Data.Attoparsec.Text.Internal.html#loc_225_1_225_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_225_1_225_9&#39;)"><span class="hl_varref"><span class="mpre">takeTill</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="mpre">)
    _ &lt;- </span><a href="Data.Attoparsec.Text.Internal.html#loc_362_1_362_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_362_1_362_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="mpre">
    </span><a href="#loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="hl_varref"><span class="mpre">skipWS</span></span></a><span class="mpre">

    </span><a name="loc_92_5_92_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_5_92_12&#39;)"><span class="hl_vardecl"><span class="mpre">unknown</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Text.html#loc_1170_1_1170_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1170_1_1170_6&#39;)"><span class="hl_varref"><span class="mpre">strip</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Data.Attoparsec.Text.Internal.html#loc_225_1_225_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_225_1_225_9&#39;)"><span class="hl_varref"><span class="mpre">takeTill</span></span></a><span class="mpre"> (\</span><a name="loc_92_37_92_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_37_92_38&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_92_37_92_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_37_92_38&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_92_37_92_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_37_92_38&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;}&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_92_37_92_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_37_92_38&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">)
    </span><a name="loc_93_5_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_5_93_7&#39;)"><span class="hl_vardecl"><span class="mpre">mc</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Attoparsec.Text.Internal.html#loc_378_1_378_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_378_1_378_9&#39;)"><span class="hl_varref"><span class="mpre">peekChar</span></span></a><span class="mpre">
    </span><a name="loc_94_5_94_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_8&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- case </span><a href="#loc_93_5_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_5_93_7&#39;)"><span class="hl_varref"><span class="mpre">mc</span></span></a><span class="mpre"> of
      </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unexpected end of input&quot;</span></span><span class="mpre">
      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_96_12_96_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_12_96_13&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_103_5_103_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_16&#39;)"><span class="hl_varref"><span class="mpre">nestedParse</span></span></a><span class="mpre"> </span><a href="#loc_88_5_88_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_5_88_8&#39;)"><span class="hl_varref"><span class="mpre">sel</span></span></a><span class="mpre"> </span><a href="#loc_92_5_92_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_5_92_12&#39;)"><span class="hl_varref"><span class="mpre">unknown</span></span></a><span class="mpre"> </span><a href="#loc_96_12_96_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_12_96_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

    </span><a href="#loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="hl_varref"><span class="mpre">skipWS</span></span></a><span class="mpre">
    _ &lt;- </span><a href="Data.Attoparsec.Text.Internal.html#loc_362_1_362_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_362_1_362_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;}&#39;</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_94_5_94_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_8&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">
  where
    </span><span class="hl_comment"><span class="mpre">-- no colon means no content</span></span><span class="mpre">
    </span><a name="loc_103_5_103_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_16&#39;)"><span class="hl_fundecl"><span class="mpre">nestedParse</span></span></a><span class="mpre"> </span><a name="loc_103_17_103_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_17_103_20&#39;)"><span class="hl_vardecl"><span class="mpre">sel</span></span></a><span class="mpre"> _ </span><span class="hl_char"><span class="mpre">&#39;}&#39;</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_24_20_24_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_20_24_29&#39;)"><span class="hl_conref"><span class="mpre">LeafBlock</span></span></a><span class="mpre"> (</span><a href="#loc_103_17_103_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_17_103_20&#39;)"><span class="hl_varref"><span class="mpre">sel</span></span></a><span class="mpre">, [])

    </span><a href="#loc_103_5_103_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_16&#39;)"><span class="hl_fundecl"><span class="mpre">nestedParse</span></span></a><span class="mpre"> </span><a name="loc_105_17_105_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_20&#39;)"><span class="hl_vardecl"><span class="mpre">sel</span></span></a><span class="mpre"> </span><a name="loc_105_21_105_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_21_105_28&#39;)"><span class="hl_vardecl"><span class="mpre">unknown</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre"> = do
        _ &lt;- </span><a href="Data.Attoparsec.Text.Internal.html#loc_362_1_362_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_362_1_362_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">
        </span><a name="loc_107_9_107_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_9_107_14&#39;)"><span class="hl_vardecl"><span class="mpre">value</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_66_1_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_1_66_12&#39;)"><span class="hl_varref"><span class="mpre">valueParser</span></span></a><span class="mpre">
        (</span><a href="Data.Attoparsec.Text.Internal.html#loc_362_1_362_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_362_1_362_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;;&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        </span><a href="#loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="hl_varref"><span class="mpre">skipWS</span></span></a><span class="mpre">
        </span><a name="loc_110_9_110_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_18&#39;)"><span class="hl_vardecl"><span class="mpre">moreAttrs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_69_1_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_12&#39;)"><span class="hl_varref"><span class="mpre">attrsParser</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_24_20_24_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_20_24_29&#39;)"><span class="hl_conref"><span class="mpre">LeafBlock</span></span></a><span class="mpre"> (</span><a href="#loc_105_17_105_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_20&#39;)"><span class="hl_varref"><span class="mpre">sel</span></span></a><span class="mpre">, (</span><a href="#loc_105_21_105_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_21_105_28&#39;)"><span class="hl_varref"><span class="mpre">unknown</span></span></a><span class="mpre">, </span><a href="Data.Text.html#loc_1170_1_1170_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1170_1_1170_6&#39;)"><span class="hl_varref"><span class="mpre">strip</span></span></a><span class="mpre"> </span><a href="#loc_107_9_107_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_9_107_14&#39;)"><span class="hl_varref"><span class="mpre">value</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_110_9_110_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_9_110_18&#39;)"><span class="hl_varref"><span class="mpre">moreAttrs</span></span></a><span class="mpre">)

    </span><span class="hl_comment"><span class="mpre">-- TODO: handle infinite nesting</span></span><span class="mpre">
    </span><a href="#loc_103_5_103_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_16&#39;)"><span class="hl_fundecl"><span class="mpre">nestedParse</span></span></a><span class="mpre"> </span><a name="loc_114_17_114_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_17_114_20&#39;)"><span class="hl_vardecl"><span class="mpre">sel</span></span></a><span class="mpre"> </span><a name="loc_114_21_114_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_21_114_28&#39;)"><span class="hl_vardecl"><span class="mpre">unknown</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="mpre"> = do
        _ &lt;- </span><a href="Data.Attoparsec.Text.Internal.html#loc_362_1_362_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_362_1_362_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="mpre">
        </span><a name="loc_116_9_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_14&#39;)"><span class="hl_vardecl"><span class="mpre">attrs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_69_1_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_12&#39;)"><span class="hl_varref"><span class="mpre">attrsParser</span></span></a><span class="mpre">
        </span><a href="#loc_46_1_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_7&#39;)"><span class="hl_varref"><span class="mpre">skipWS</span></span></a><span class="mpre">
        _ &lt;- </span><a href="Data.Attoparsec.Text.Internal.html#loc_362_1_362_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Attoparsec.Text.Internal.html#loc_362_1_362_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;}&#39;</span></span><span class="mpre">
        </span><a name="loc_119_9_119_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_9_119_15&#39;)"><span class="hl_vardecl"><span class="mpre">blocks</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_124_1_124_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_13&#39;)"><span class="hl_varref"><span class="mpre">blocksParser</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_23_20_23_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_20_23_31&#39;)"><span class="hl_conref"><span class="mpre">NestedBlock</span></span></a><span class="mpre"> </span><a href="#loc_114_17_114_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_17_114_20&#39;)"><span class="hl_varref"><span class="mpre">sel</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_24_20_24_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_20_24_29&#39;)"><span class="hl_conref"><span class="mpre">LeafBlock</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_114_21_114_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_21_114_28&#39;)"><span class="hl_varref"><span class="mpre">unknown</span></span></a><span class="mpre">, </span><a href="#loc_116_9_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_14&#39;)"><span class="hl_varref"><span class="mpre">attrs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_119_9_119_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_9_119_15&#39;)"><span class="hl_varref"><span class="mpre">blocks</span></span></a><span class="mpre">
    </span><a href="#loc_103_5_103_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_16&#39;)"><span class="hl_fundecl"><span class="mpre">nestedParse</span></span></a><span class="mpre"> _ _ </span><a name="loc_121_21_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_21_121_22&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;expected { or : but got &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_121_21_121_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_21_121_22&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">]

</span><a href="#loc_124_1_124_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_13&#39;)"><span class="mpre">blocksParser</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> [(</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">, [(</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">, </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">)])]
</span><a name="loc_124_1_124_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_13&#39;)"><span class="hl_vardecl"><span class="mpre">blocksParser</span></span></a><span class="mpre"> = </span><a href="Control.Applicative.html#loc_152_5_152_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_152_5_152_9&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_76_1_76_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_12&#39;)"><span class="hl_varref"><span class="mpre">blockParser</span></span></a><span class="mpre">

</span><a href="#loc_127_1_127_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_19&#39;)"><span class="mpre">nestedBlocksParser</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Parser</span></span><span class="mpre"> [</span><a href="#loc_23_6_23_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_6_23_17&#39;)"><span class="hl_tyconref"><span class="mpre">NestedBlock</span></span></a><span class="mpre">]
</span><a name="loc_127_1_127_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_19&#39;)"><span class="hl_vardecl"><span class="mpre">nestedBlocksParser</span></span></a><span class="mpre"> = </span><a href="Control.Applicative.html#loc_152_5_152_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_152_5_152_9&#39;)"><span class="hl_varref"><span class="mpre">many</span></span></a><span class="mpre"> </span><a href="#loc_86_1_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_18&#39;)"><span class="hl_varref"><span class="mpre">nestedBlockParser</span></span></a><span class="mpre">
</span></div></body></html>