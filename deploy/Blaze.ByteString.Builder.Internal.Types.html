<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, BangPatterns, Rank2Types #-}

#ifdef USE_MONO_PAT_BINDS
{-# LANGUAGE MonoPatBinds #-}
#endif

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Blaze.ByteString.Builder.Internal.Types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) 2010 Simon Meier</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD3-style (see LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Simon Meier &lt;iridcode@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : tested on GHC only</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Core types and functions for the &#39;Builder&#39; monoid and the &#39;Put&#39; monad based</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- based on the &#39;blaze-builder&#39; library by Jasper van der Jeugt and Simon</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Meier.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Blaze.ByteString.Builder.Internal.Types where

#ifdef APPLICATIVE_IN_BASE
import Control.Applicative
#endif

import Data.Monoid
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/Blaze/ByteString/Builder/Internal/Types.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 18, srcSpanEndLine = 27, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">      as S

import Foreign

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The core: BuildSteps</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

data </span><a name="loc_35_6_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_14&#39;)"><span class="hl_tycondecl"><span class="mpre">BufRange</span></span></a><span class="mpre"> = </span><a name="loc_35_17_35_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_17_35_25&#39;)"><span class="hl_condecl"><span class="mpre">BufRange</span></span></a><span class="mpre"> {-# UNPACK #-} !(</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">) {-# UNPACK #-} !(</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)

data </span><a name="loc_37_6_37_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_17&#39;)"><span class="hl_tycondecl"><span class="mpre">BuildSignal</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> =
    </span><a name="loc_38_5_38_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_5_38_9&#39;)"><span class="hl_condecl"><span class="mpre">Done</span></span></a><span class="mpre"> {-# UNPACK #-} !(</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
  | </span><a name="loc_39_5_39_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_15&#39;)"><span class="hl_condecl"><span class="mpre">BufferFull</span></span></a><span class="mpre">
      {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
      {-# UNPACK #-} !(</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
                     !(</span><a href="#loc_48_9_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_18&#39;)"><span class="hl_tyconref"><span class="mpre">BuildStep</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
  | </span><a name="loc_43_5_43_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_5_43_21&#39;)"><span class="hl_condecl"><span class="mpre">InsertByteString</span></span></a><span class="mpre">
      {-# UNPACK #-} !(</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
                     !</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
                     !(</span><a href="#loc_48_9_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_18&#39;)"><span class="hl_tyconref"><span class="mpre">BuildStep</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)

newtype </span><a name="loc_48_9_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_18&#39;)"><span class="hl_tycondecl"><span class="mpre">BuildStep</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> =
    </span><a name="loc_49_5_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_14&#39;)"><span class="hl_condecl"><span class="mpre">BuildStep</span></span></a><span class="mpre"> { </span><a name="loc_49_17_49_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_17_49_29&#39;)"><span class="hl_fielddecl"><span class="mpre">runBuildStep</span></span></a><span class="mpre"> :: </span><a href="#loc_35_6_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_14&#39;)"><span class="hl_tyconref"><span class="mpre">BufRange</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_37_6_37_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_17&#39;)"><span class="hl_tyconref"><span class="mpre">BuildSignal</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) }

</span><span class="hl_comment"><span class="mpre">-- Hiding the implementation of &#39;BuildStep&#39;s</span></span><span class="mpre">

</span><a href="#loc_54_1_54_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_5&#39;)"><span class="mpre">done</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_37_6_37_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_17&#39;)"><span class="hl_tyconref"><span class="mpre">BuildSignal</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_54_1_54_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_5&#39;)"><span class="hl_vardecl"><span class="mpre">done</span></span></a><span class="mpre"> = </span><a href="#loc_38_5_38_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_5_38_9&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">

</span><a href="#loc_57_1_57_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_11&#39;)"><span class="mpre">bufferFull</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; (</span><a href="#loc_35_6_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_14&#39;)"><span class="hl_tyconref"><span class="mpre">BufRange</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_37_6_37_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_17&#39;)"><span class="hl_tyconref"><span class="mpre">BuildSignal</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)) -&gt; </span><a href="#loc_37_6_37_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_17&#39;)"><span class="hl_tyconref"><span class="mpre">BuildSignal</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_57_1_57_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_11&#39;)"><span class="hl_fundecl"><span class="mpre">bufferFull</span></span></a><span class="mpre"> </span><a name="loc_57_12_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_12_57_16&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> </span><a name="loc_57_17_57_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_17_57_19&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> </span><a name="loc_57_20_57_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_20_57_24&#39;)"><span class="hl_vardecl"><span class="mpre">step</span></span></a><span class="mpre"> = </span><a href="#loc_39_5_39_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_15&#39;)"><span class="hl_conref"><span class="mpre">BufferFull</span></span></a><span class="mpre"> </span><a href="#loc_57_12_57_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_12_57_16&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><a href="#loc_57_17_57_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_17_57_19&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> (</span><a href="#loc_63_1_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_10&#39;)"><span class="hl_varref"><span class="mpre">buildStep</span></span></a><span class="mpre"> </span><a href="#loc_57_20_57_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_20_57_24&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre">)

</span><a href="#loc_60_1_60_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_17&#39;)"><span class="mpre">insertByteString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; (</span><a href="#loc_35_6_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_14&#39;)"><span class="hl_tyconref"><span class="mpre">BufRange</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_37_6_37_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_17&#39;)"><span class="hl_tyconref"><span class="mpre">BuildSignal</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)) -&gt; </span><a href="#loc_37_6_37_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_17&#39;)"><span class="hl_tyconref"><span class="mpre">BuildSignal</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_60_1_60_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_17&#39;)"><span class="hl_fundecl"><span class="mpre">insertByteString</span></span></a><span class="mpre"> </span><a name="loc_60_18_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_18_60_20&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> </span><a name="loc_60_21_60_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_21_60_23&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a name="loc_60_24_60_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_24_60_28&#39;)"><span class="hl_vardecl"><span class="mpre">step</span></span></a><span class="mpre"> = </span><a href="#loc_43_5_43_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_5_43_21&#39;)"><span class="hl_conref"><span class="mpre">InsertByteString</span></span></a><span class="mpre"> </span><a href="#loc_60_18_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_18_60_20&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><a href="#loc_60_21_60_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_21_60_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> (</span><a href="#loc_63_1_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_10&#39;)"><span class="hl_varref"><span class="mpre">buildStep</span></span></a><span class="mpre"> </span><a href="#loc_60_24_60_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_24_60_28&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre">)

</span><a href="#loc_63_1_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_10&#39;)"><span class="mpre">buildStep</span></a><span class="mpre"> :: (</span><a href="#loc_35_6_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_14&#39;)"><span class="hl_tyconref"><span class="mpre">BufRange</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_37_6_37_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_17&#39;)"><span class="hl_tyconref"><span class="mpre">BuildSignal</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)) -&gt; </span><a href="#loc_48_9_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_18&#39;)"><span class="hl_tyconref"><span class="mpre">BuildStep</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_63_1_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_10&#39;)"><span class="hl_vardecl"><span class="mpre">buildStep</span></span></a><span class="mpre"> = </span><a href="#loc_49_5_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_14&#39;)"><span class="hl_conref"><span class="mpre">BuildStep</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;Builder&#39; Monoid and the &#39;Put&#39; Monad</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

newtype </span><a name="loc_69_9_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_16&#39;)"><span class="hl_tycondecl"><span class="mpre">Builder</span></span></a><span class="mpre"> = </span><a name="loc_69_19_69_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_26&#39;)"><span class="hl_condecl"><span class="mpre">Builder</span></span></a><span class="mpre"> {
    </span><a name="loc_70_5_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_5_70_14&#39;)"><span class="hl_fielddecl"><span class="mpre">unBuilder</span></span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">. </span><a href="#loc_48_9_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_18&#39;)"><span class="hl_tyconref"><span class="mpre">BuildStep</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><a href="#loc_48_9_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_18&#39;)"><span class="hl_tyconref"><span class="mpre">BuildStep</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
  }

instance </span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="hl_classref"><span class="mpre">Monoid</span></span></a><span class="mpre"> </span><a href="#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre"> where
  </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">mempty</span></span></a><span class="mpre"> = </span><a href="#loc_69_19_69_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="mpre">mempty</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  (</span><a href="#loc_69_19_69_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><a name="loc_76_12_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_14&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre">) </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">`mappend`</span></span></a><span class="mpre"> (</span><a href="#loc_69_19_69_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><a name="loc_76_35_76_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_35_76_37&#39;)"><span class="hl_vardecl"><span class="mpre">b2</span></span></a><span class="mpre">) = </span><a href="#loc_69_19_69_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_76_12_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_14&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_76_35_76_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_35_76_37&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="mpre">mappend</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_vardecl"><span class="mpre">mconcat</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_varref"><span class="mpre">mappend</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="mpre">mconcat</span></a><span class="mpre"> #-}</span></span><span class="mpre">

newtype </span><a name="loc_81_9_81_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Put</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_81_17_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_20&#39;)"><span class="hl_condecl"><span class="mpre">Put</span></span></a><span class="mpre"> {
    </span><a name="loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_fielddecl"><span class="mpre">unPut</span></span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">. (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_48_9_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_18&#39;)"><span class="hl_tyconref"><span class="mpre">BuildStep</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><a href="#loc_48_9_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_18&#39;)"><span class="hl_tyconref"><span class="mpre">BuildStep</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
  }

instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> </span><a href="#loc_81_9_81_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_12&#39;)"><span class="hl_tyconref"><span class="mpre">Put</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_86_8_86_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_8_86_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_81_17_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_20&#39;)"><span class="hl_conref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><a name="loc_86_15_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_18&#39;)"><span class="hl_vardecl"><span class="mpre">put</span></span></a><span class="mpre">) = </span><a href="#loc_81_17_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_20&#39;)"><span class="hl_conref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_86_29_86_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_29_86_30&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_86_15_86_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_15_86_18&#39;)"><span class="hl_varref"><span class="mpre">put</span></span></a><span class="mpre"> (\</span><a name="loc_86_40_86_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_40_86_41&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_86_29_86_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_29_86_30&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_86_8_86_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_8_86_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_86_40_86_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_40_86_41&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">))
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE fmap #-}</span></span><span class="mpre">

#ifdef APPLICATIVE_IN_BASE
instance </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> </span><a href="#loc_81_9_81_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_12&#39;)"><span class="hl_tyconref"><span class="mpre">Put</span></span></a><span class="mpre"> where
  </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_fundecl"><span class="mpre">pure</span></span></a><span class="mpre"> </span><a name="loc_91_8_91_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_8_91_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_81_17_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_20&#39;)"><span class="hl_conref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_91_19_91_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_19_91_20&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_91_19_91_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_19_91_20&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_91_8_91_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_8_91_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="mpre">pure</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a name="loc_93_3_93_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_3_93_4&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a name="loc_93_9_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_81_17_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_20&#39;)"><span class="hl_conref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_93_20_93_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_20_93_21&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_varref"><span class="mpre">unPut</span></span></a><span class="mpre"> </span><a href="#loc_93_3_93_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_3_93_4&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (\</span><a name="loc_93_35_93_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_35_93_37&#39;)"><span class="hl_vardecl"><span class="mpre">f&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_varref"><span class="mpre">unPut</span></span></a><span class="mpre"> </span><a href="#loc_93_9_93_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_9_93_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> (\</span><a name="loc_93_51_93_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_51_93_53&#39;)"><span class="hl_vardecl"><span class="mpre">a&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_93_20_93_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_20_93_21&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_93_35_93_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_35_93_37&#39;)"><span class="hl_varref"><span class="mpre">f&#39;</span></span></a><span class="mpre"> </span><a href="#loc_93_51_93_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_51_93_53&#39;)"><span class="hl_varref"><span class="mpre">a&#39;</span></span></a><span class="mpre">)))
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="mpre">(&lt;*&gt;)</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a name="loc_95_3_95_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_3_95_4&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_125_5_125_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_125_5_125_9&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;*</span></span></a><span class="mpre"> </span><a name="loc_95_8_95_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_8_95_9&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_81_17_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_20&#39;)"><span class="hl_conref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_95_19_95_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_19_95_20&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_varref"><span class="mpre">unPut</span></span></a><span class="mpre"> </span><a href="#loc_95_3_95_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_3_95_4&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> (\</span><a name="loc_95_34_95_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_34_95_36&#39;)"><span class="hl_vardecl"><span class="mpre">a&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_varref"><span class="mpre">unPut</span></span></a><span class="mpre"> </span><a href="#loc_95_8_95_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_8_95_9&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (\_ -&gt; </span><a href="#loc_95_19_95_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_19_95_20&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_95_34_95_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_34_95_36&#39;)"><span class="hl_varref"><span class="mpre">a&#39;</span></span></a><span class="mpre">))
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Applicative.html#loc_125_5_125_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_125_5_125_9&#39;)"><span class="mpre">(&lt;*)</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a name="loc_97_3_97_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_3_97_4&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_121_5_121_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_121_5_121_9&#39;)"><span class="hl_fundecl"><span class="mpre">*&gt;</span></span></a><span class="mpre"> </span><a name="loc_97_8_97_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_8_97_9&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_81_17_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_20&#39;)"><span class="hl_conref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_97_19_97_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_19_97_20&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_varref"><span class="mpre">unPut</span></span></a><span class="mpre"> </span><a href="#loc_97_3_97_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_3_97_4&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> (\_ -&gt; </span><a href="#loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_varref"><span class="mpre">unPut</span></span></a><span class="mpre"> </span><a href="#loc_97_8_97_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_8_97_9&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_97_19_97_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_19_97_20&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="Control.Applicative.html#loc_121_5_121_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_121_5_121_9&#39;)"><span class="mpre">(*&gt;)</span></a><span class="mpre"> #-}</span></span><span class="mpre">
#endif

instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> </span><a href="#loc_81_9_81_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_12&#39;)"><span class="hl_tyconref"><span class="mpre">Put</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_102_10_102_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_10_102_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_81_17_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_20&#39;)"><span class="hl_conref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_102_21_102_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_21_102_22&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_102_21_102_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_21_102_22&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_102_10_102_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_10_102_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE return #-}</span></span><span class="mpre">
  </span><a name="loc_104_3_104_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_4&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_104_9_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">  = </span><a href="#loc_81_17_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_20&#39;)"><span class="hl_conref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_104_21_104_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_21_104_22&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_varref"><span class="mpre">unPut</span></span></a><span class="mpre"> </span><a href="#loc_104_3_104_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_3_104_4&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (\</span><a name="loc_104_36_104_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_36_104_38&#39;)"><span class="hl_vardecl"><span class="mpre">m&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_varref"><span class="mpre">unPut</span></span></a><span class="mpre"> (</span><a href="#loc_104_9_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_104_36_104_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_36_104_38&#39;)"><span class="hl_varref"><span class="mpre">m&#39;</span></span></a><span class="mpre">) </span><a href="#loc_104_21_104_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_21_104_22&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE (&gt;&gt;=) #-}</span></span><span class="mpre">
  </span><a name="loc_106_3_106_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_3_106_4&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;</span></span><span class="mpre">  </span><a name="loc_106_9_106_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_9_106_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">  = </span><a href="#loc_81_17_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_20&#39;)"><span class="hl_conref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_106_21_106_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_21_106_22&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_varref"><span class="mpre">unPut</span></span></a><span class="mpre"> </span><a href="#loc_106_3_106_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_3_106_4&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (\_ -&gt; </span><a href="#loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_varref"><span class="mpre">unPut</span></span></a><span class="mpre"> </span><a href="#loc_106_9_106_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_9_106_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_106_21_106_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_21_106_22&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
  </span><span class="hl_pragma"><span class="mpre">{-# INLINE (&gt;&gt;) #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Creation from concrete &#39;BuildStep&#39;s</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_116_1_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_17&#39;)"><span class="mpre">putBuildStepCont</span></a><span class="mpre"> :: (forall </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">. (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_35_6_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_14&#39;)"><span class="hl_tyconref"><span class="mpre">BufRange</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_37_6_37_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_17&#39;)"><span class="hl_tyconref"><span class="mpre">BuildSignal</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)) -&gt;
                               (     </span><a href="#loc_35_6_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_14&#39;)"><span class="hl_tyconref"><span class="mpre">BufRange</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_37_6_37_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_17&#39;)"><span class="hl_tyconref"><span class="mpre">BuildSignal</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">))
                    ) -&gt; </span><a href="#loc_81_9_81_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_12&#39;)"><span class="hl_tyconref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_116_1_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_17&#39;)"><span class="hl_fundecl"><span class="mpre">putBuildStepCont</span></span></a><span class="mpre"> </span><a name="loc_116_18_116_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_18_116_22&#39;)"><span class="hl_vardecl"><span class="mpre">step</span></span></a><span class="mpre"> = </span><a href="#loc_81_17_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_20&#39;)"><span class="hl_conref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><a href="#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_5_118_10&#39;)"><span class="hl_varref"><span class="mpre">step&#39;</span></span></a><span class="mpre">
  where
    </span><a name="loc_118_5_118_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_5_118_10&#39;)"><span class="hl_fundecl"><span class="mpre">step&#39;</span></span></a><span class="mpre"> </span><a name="loc_118_11_118_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_11_118_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_49_5_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_14&#39;)"><span class="hl_conref"><span class="mpre">BuildStep</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_116_18_116_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_18_116_22&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> (\</span><a name="loc_118_34_118_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_34_118_35&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_49_17_49_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_17_49_29&#39;)"><span class="hl_varref"><span class="mpre">runBuildStep</span></span></a><span class="mpre"> (</span><a href="#loc_118_11_118_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_11_118_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_118_34_118_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_34_118_35&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">))


</span><a href="#loc_124_1_124_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_18&#39;)"><span class="mpre">fromBuildStepCont</span></a><span class="mpre"> :: (forall </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">. (</span><a href="#loc_35_6_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_14&#39;)"><span class="hl_tyconref"><span class="mpre">BufRange</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_37_6_37_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_17&#39;)"><span class="hl_tyconref"><span class="mpre">BuildSignal</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)) -&gt;
                                (</span><a href="#loc_35_6_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_6_35_14&#39;)"><span class="hl_tyconref"><span class="mpre">BufRange</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_37_6_37_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_17&#39;)"><span class="hl_tyconref"><span class="mpre">BuildSignal</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">))
                     ) -&gt; </span><a href="#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_124_1_124_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_18&#39;)"><span class="hl_fundecl"><span class="mpre">fromBuildStepCont</span></span></a><span class="mpre"> </span><a name="loc_124_19_124_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_19_124_23&#39;)"><span class="hl_vardecl"><span class="mpre">step</span></span></a><span class="mpre"> = </span><a href="#loc_69_19_69_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><a href="#loc_126_5_126_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_5_126_10&#39;)"><span class="hl_varref"><span class="mpre">step&#39;</span></span></a><span class="mpre">
  where
    </span><a name="loc_126_5_126_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_5_126_10&#39;)"><span class="hl_fundecl"><span class="mpre">step&#39;</span></span></a><span class="mpre"> </span><a name="loc_126_11_126_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_49_5_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_5_49_14&#39;)"><span class="hl_conref"><span class="mpre">BuildStep</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_124_19_124_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_19_124_23&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> (</span><a href="#loc_49_17_49_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_17_49_29&#39;)"><span class="hl_varref"><span class="mpre">runBuildStep</span></span></a><span class="mpre"> </span><a href="#loc_126_11_126_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)



</span><span class="hl_comment"><span class="mpre">-- Conversion between Put and Builder</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Put the given builder.</span></span><span class="mpre">
</span><a href="#loc_135_1_135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_11&#39;)"><span class="mpre">putBuilder</span></a><span class="mpre"> :: </span><a href="#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_81_9_81_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_12&#39;)"><span class="hl_tyconref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_135_1_135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_11&#39;)"><span class="hl_fundecl"><span class="mpre">putBuilder</span></span></a><span class="mpre"> (</span><a href="#loc_69_19_69_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><a name="loc_135_21_135_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_21_135_26&#39;)"><span class="hl_vardecl"><span class="mpre">build</span></span></a><span class="mpre">) = </span><a href="#loc_81_17_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_20&#39;)"><span class="hl_conref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_135_37_135_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_37_135_38&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_135_21_135_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_21_135_26&#39;)"><span class="hl_varref"><span class="mpre">build</span></span></a><span class="mpre"> (</span><a href="#loc_135_37_135_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_37_135_38&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Ignore the value of a put and only exploit its output side effect.</span></span><span class="mpre">
</span><a href="#loc_140_1_140_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_8&#39;)"><span class="mpre">fromPut</span></a><span class="mpre"> :: </span><a href="#loc_81_9_81_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_12&#39;)"><span class="hl_tyconref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_140_1_140_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_1_140_8&#39;)"><span class="hl_fundecl"><span class="mpre">fromPut</span></span></a><span class="mpre"> (</span><a href="#loc_81_17_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_20&#39;)"><span class="hl_conref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><a name="loc_140_14_140_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_14_140_17&#39;)"><span class="hl_vardecl"><span class="mpre">put</span></span></a><span class="mpre">) = </span><a href="#loc_69_19_69_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_26&#39;)"><span class="hl_conref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_140_32_140_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_32_140_33&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_140_14_140_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_14_140_17&#39;)"><span class="hl_varref"><span class="mpre">put</span></span></a><span class="mpre"> (\_ -&gt; </span><a href="#loc_140_32_140_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_32_140_33&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Lifting IO actions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">---------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Lift the given IO action.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_148_1_148_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_10&#39;)"><span class="mpre">putLiftIO</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_148_1_148_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_10&#39;)"><span class="mpre">putLiftIO</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_81_9_81_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_12&#39;)"><span class="hl_tyconref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_148_1_148_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_1_148_10&#39;)"><span class="hl_fundecl"><span class="mpre">putLiftIO</span></span></a><span class="mpre"> </span><a name="loc_148_11_148_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_11_148_13&#39;)"><span class="hl_vardecl"><span class="mpre">io</span></span></a><span class="mpre"> = </span><a href="#loc_116_1_116_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_17&#39;)"><span class="hl_varref"><span class="mpre">putBuildStepCont</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_148_36_148_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_36_148_37&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_148_38_148_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_38_148_40&#39;)"><span class="hl_vardecl"><span class="mpre">br</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_148_11_148_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_11_148_13&#39;)"><span class="hl_varref"><span class="mpre">io</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> (</span><a href="#loc_148_36_148_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_36_148_37&#39;)"><span class="hl_infix"><span class="mpre">`k`</span></span></a><span class="mpre"> </span><a href="#loc_148_38_148_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_38_148_40&#39;)"><span class="hl_varref"><span class="mpre">br</span></span></a><span class="mpre">)
</span></div></body></html>