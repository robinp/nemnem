<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | This module provides a fast logging system which</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   scales on multicore environments (i.e. +RTS -N\&lt;x\&gt;).</span></span><span class="mpre">
{-# LANGUAGE BangPatterns, CPP #-}

module System.Log.FastLogger (
  </span><span class="hl_comment"><span class="mpre">-- * Creating a logger set</span></span><span class="mpre">
    LoggerSet
  , newFileLoggerSet
  , newStdoutLoggerSet
  , newStderrLoggerSet
  , newLoggerSet
  </span><span class="hl_comment"><span class="mpre">-- * Buffer size</span></span><span class="mpre">
  , BufSize
  , defaultBufSize
  </span><span class="hl_comment"><span class="mpre">-- * Renewing and removing a logger set</span></span><span class="mpre">
  , renewLoggerSet
  , rmLoggerSet
  </span><span class="hl_comment"><span class="mpre">-- * Log messages</span></span><span class="mpre">
  , LogStr
  , ToLogStr(..)
  , fromLogStr
  , logStrLength
  </span><span class="hl_comment"><span class="mpre">-- * Writing a log message</span></span><span class="mpre">
  , pushLogStr
  </span><span class="hl_comment"><span class="mpre">-- * Flushing buffered log messages</span></span><span class="mpre">
  , flushLogStr
  </span><span class="hl_comment"><span class="mpre">-- * File rotation</span></span><span class="mpre">
  , module System.Log.FastLogger.File
  ) where

import Control.Applicative (</span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fast-logger-2.1.5/System/Log/FastLogger.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 8, srcSpanEndLine = 32, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;Control.Concurrent&quot;"><span class="mpre">Control.Concurrent</span></span><span class="mpre"> (getNumCapabilities, myThreadId, threadCapability, takeMVar)
import Control.Monad (</span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="mpre">replicateM</span></a><span class="mpre">)
import Data.Array (Array, listArray, (!), bounds)
import Data.Maybe (</span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="mpre">isJust</span></a><span class="mpre">)
import GHC.IO.Device (</span><a href="GHC.IO.Device.html#loc_71_3_71_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Device.html#loc_71_3_71_8&#39;)"><span class="mpre">close</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fast-logger-2.1.5/System/Log/FastLogger.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 8, srcSpanEndLine = 37, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;GHC.IO.FD&quot;"><span class="mpre">GHC.IO.FD</span></span><span class="mpre"> (FD(..), openFile, stderr, stdout)
import GHC.IO.IOMode (</span><a href="GHC.IO.IOMode.html#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_6_28_12&#39;)"><span class="mpre">IOMode</span></a><span class="mpre">(..))
import System.Log.FastLogger.File
import System.Log.FastLogger.IO
import System.Log.FastLogger.IORef
import System.Log.FastLogger.LogStr
import System.Log.FastLogger.Logger

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Opening a log file.</span></span><span class="mpre">
</span><a href="#loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="mpre">logOpen</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FD</span></span><span class="mpre">
</span><a name="loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="hl_fundecl"><span class="mpre">logOpen</span></span></a><span class="mpre"> </span><a name="loc_49_9_49_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_13&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">openFile</span></span><span class="mpre"> </span><a href="#loc_49_9_49_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_13&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre"> </span><a href="GHC.IO.IOMode.html#loc_28_44_28_54" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_44_28_54&#39;)"><span class="hl_conref"><span class="mpre">AppendMode</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A set of loggers.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   The number of loggers is the capabilities of GHC RTS.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   You can specify it with \&quot;+RTS -N\&lt;x\&gt;\&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   A buffer is prepared for each capability.</span></span><span class="mpre">
data </span><a name="loc_57_6_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_6_57_15&#39;)"><span class="hl_tycondecl"><span class="mpre">LoggerSet</span></span></a><span class="mpre"> = </span><a name="loc_57_18_57_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_27&#39;)"><span class="hl_condecl"><span class="mpre">LoggerSet</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">) (</span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FD</span></span><span class="mpre">) (</span><span class="hl_tyconref"><span class="mpre">Array</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><a href="System.Log.FastLogger.Logger.html#loc_20_6_20_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Log.FastLogger.Logger.html#loc_20_6_20_12&#39;)"><span class="hl_tyconref"><span class="mpre">Logger</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Creating a new &#39;LoggerSet&#39; using a file.</span></span><span class="mpre">
</span><a href="#loc_61_1_61_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_17&#39;)"><span class="mpre">newFileLoggerSet</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BufSize</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_57_6_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_6_57_15&#39;)"><span class="hl_tyconref"><span class="mpre">LoggerSet</span></span></a><span class="mpre">
</span><a name="loc_61_1_61_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_17&#39;)"><span class="hl_fundecl"><span class="mpre">newFileLoggerSet</span></span></a><span class="mpre"> </span><a name="loc_61_18_61_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_18_61_22&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> </span><a name="loc_61_23_61_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_23_61_27&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre"> = </span><a href="#loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="hl_varref"><span class="mpre">logOpen</span></span></a><span class="mpre"> </span><a href="#loc_61_23_61_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_23_61_27&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="hl_varref"><span class="mpre">newFDLoggerSet</span></span></a><span class="mpre"> </span><a href="#loc_61_18_61_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_18_61_22&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_61_23_61_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_23_61_27&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Creating a new &#39;LoggerSet&#39; using stdout.</span></span><span class="mpre">
</span><a href="#loc_65_1_65_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_19&#39;)"><span class="mpre">newStdoutLoggerSet</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BufSize</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_57_6_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_6_57_15&#39;)"><span class="hl_tyconref"><span class="mpre">LoggerSet</span></span></a><span class="mpre">
</span><a name="loc_65_1_65_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_19&#39;)"><span class="hl_fundecl"><span class="mpre">newStdoutLoggerSet</span></span></a><span class="mpre"> </span><a name="loc_65_20_65_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_20_65_24&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> = </span><a href="#loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="hl_varref"><span class="mpre">newFDLoggerSet</span></span></a><span class="mpre"> </span><a href="#loc_65_20_65_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_20_65_24&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">stdout</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Creating a new &#39;LoggerSet&#39; using stderr.</span></span><span class="mpre">
</span><a href="#loc_69_1_69_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_19&#39;)"><span class="mpre">newStderrLoggerSet</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BufSize</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_57_6_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_6_57_15&#39;)"><span class="hl_tyconref"><span class="mpre">LoggerSet</span></span></a><span class="mpre">
</span><a name="loc_69_1_69_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_19&#39;)"><span class="hl_fundecl"><span class="mpre">newStderrLoggerSet</span></span></a><span class="mpre"> </span><a name="loc_69_20_69_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_20_69_24&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> = </span><a href="#loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="hl_varref"><span class="mpre">newFDLoggerSet</span></span></a><span class="mpre"> </span><a href="#loc_69_20_69_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_20_69_24&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">stderr</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fast-logger-2.1.5/System/Log/FastLogger.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 1, srcSpanEndLine = 71, srcSpanEndColumn = 67}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fast-logger-2.1.5/System/Log/FastLogger.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 1, srcSpanEndLine = 71, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fast-logger-2.1.5/System/Log/FastLo"><span class="mpre">{-# DEPRECATED newLoggerSet &quot;Use newFileLoggerSet etc instead&quot; #-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Creating a new &#39;LoggerSet&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   If &#39;Nothing&#39; is specified to the second argument,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   stdout is used.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Please note that the minimum &#39;BufSize&#39; is 1.</span></span><span class="mpre">
</span><a href="#loc_77_1_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_13&#39;)"><span class="mpre">newLoggerSet</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BufSize</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_57_6_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_6_57_15&#39;)"><span class="hl_tyconref"><span class="mpre">LoggerSet</span></span></a><span class="mpre">
</span><a name="loc_77_1_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_13&#39;)"><span class="hl_fundecl"><span class="mpre">newLoggerSet</span></span></a><span class="mpre"> </span><a name="loc_77_14_77_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_14_77_18&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><a href="#loc_65_1_65_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_19&#39;)"><span class="hl_varref"><span class="mpre">newStdoutLoggerSet</span></span></a><span class="mpre"> </span><a href="#loc_77_14_77_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_14_77_18&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre">) (</span><a href="#loc_61_1_61_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_17&#39;)"><span class="hl_varref"><span class="mpre">newFileLoggerSet</span></span></a><span class="mpre"> </span><a href="#loc_77_14_77_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_14_77_18&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Creating a new &#39;LoggerSet&#39; using a FD.</span></span><span class="mpre">
</span><a href="#loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="mpre">newFDLoggerSet</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BufSize</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FD</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_57_6_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_6_57_15&#39;)"><span class="hl_tyconref"><span class="mpre">LoggerSet</span></span></a><span class="mpre">
</span><a name="loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="hl_fundecl"><span class="mpre">newFDLoggerSet</span></span></a><span class="mpre"> </span><a name="loc_81_16_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_16_81_20&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> </span><a name="loc_81_21_81_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_21_81_26&#39;)"><span class="hl_vardecl"><span class="mpre">mfile</span></span></a><span class="mpre"> </span><a name="loc_81_27_81_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_27_81_29&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre"> = do
    </span><a name="loc_82_5_82_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_6&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">getNumCapabilities</span></span><span class="mpre">
    </span><a name="loc_83_5_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_12&#39;)"><span class="hl_vardecl"><span class="mpre">loggers</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><a href="#loc_82_5_82_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_6&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.Log.FastLogger.Logger.html#loc_25_1_25_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Log.FastLogger.Logger.html#loc_25_1_25_10&#39;)"><span class="hl_varref"><span class="mpre">newLogger</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_81_16_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_16_81_20&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre">)
    let </span><a name="loc_84_9_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_12&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">listArray</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><a href="#loc_82_5_82_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_6&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_83_5_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_12&#39;)"><span class="hl_varref"><span class="mpre">loggers</span></span></a><span class="mpre">
    </span><a name="loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_vardecl"><span class="mpre">fref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="#loc_81_27_81_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_27_81_29&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_57_18_57_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_27&#39;)"><span class="hl_conref"><span class="mpre">LoggerSet</span></span></a><span class="mpre"> </span><a href="#loc_81_21_81_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_21_81_26&#39;)"><span class="hl_varref"><span class="mpre">mfile</span></span></a><span class="mpre"> </span><a href="#loc_85_5_85_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_9&#39;)"><span class="hl_varref"><span class="mpre">fref</span></span></a><span class="mpre"> </span><a href="#loc_84_9_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_9_84_12&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Writing a log message to the corresponding buffer.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   If the buffer becomes full, the log messages in the buffer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   are written to its corresponding file, stdout, or stderr.</span></span><span class="mpre">
</span><a href="#loc_92_1_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_11&#39;)"><span class="mpre">pushLogStr</span></a><span class="mpre"> :: </span><a href="#loc_57_6_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_6_57_15&#39;)"><span class="hl_tyconref"><span class="mpre">LoggerSet</span></span></a><span class="mpre"> -&gt; </span><a href="System.Log.FastLogger.LogStr.html#loc_59_6_59_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Log.FastLogger.LogStr.html#loc_59_6_59_12&#39;)"><span class="hl_tyconref"><span class="mpre">LogStr</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_92_1_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_11&#39;)"><span class="hl_fundecl"><span class="mpre">pushLogStr</span></span></a><span class="mpre"> (</span><a href="#loc_57_18_57_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_27&#39;)"><span class="hl_conref"><span class="mpre">LoggerSet</span></span></a><span class="mpre"> _ </span><a name="loc_92_25_92_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_25_92_29&#39;)"><span class="hl_vardecl"><span class="mpre">fref</span></span></a><span class="mpre"> </span><a name="loc_92_30_92_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_30_92_33&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre">) </span><a name="loc_92_35_92_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_35_92_41&#39;)"><span class="hl_vardecl"><span class="mpre">logmsg</span></span></a><span class="mpre"> = do
    (</span><a name="loc_93_6_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_6_93_7&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">, _) &lt;- </span><span class="hl_varref"><span class="mpre">myThreadId</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">threadCapability</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- The number of capability could be dynamically changed.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- So, let&#39;s check the upper boundary of the array.</span></span><span class="mpre">
    let </span><a name="loc_96_9_96_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_9_96_10&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">bounds</span></span><span class="mpre"> </span><a href="#loc_92_30_92_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_30_92_33&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre">
        </span><a name="loc_97_9_97_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_12&#39;)"><span class="hl_vardecl"><span class="mpre">lim</span></span></a><span class="mpre"> = </span><a href="#loc_96_9_96_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_9_96_10&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a name="loc_98_9_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_10&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> | </span><a href="#loc_93_6_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_6_93_7&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_97_9_97_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_12&#39;)"><span class="hl_varref"><span class="mpre">lim</span></span></a><span class="mpre">   = </span><a href="#loc_93_6_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_6_93_7&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_93_6_93_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_6_93_7&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_97_9_97_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_12&#39;)"><span class="hl_varref"><span class="mpre">lim</span></span></a><span class="mpre">
    let </span><a name="loc_100_9_100_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_15&#39;)"><span class="hl_vardecl"><span class="mpre">logger</span></span></a><span class="mpre"> = </span><a href="#loc_92_30_92_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_30_92_33&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!</span></span><span class="mpre"> </span><a href="#loc_98_9_98_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_10&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">
    </span><a name="loc_101_5_101_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_7&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_92_25_92_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_25_92_29&#39;)"><span class="hl_varref"><span class="mpre">fref</span></span></a><span class="mpre">
    </span><a href="System.Log.FastLogger.Logger.html#loc_34_1_34_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Log.FastLogger.Logger.html#loc_34_1_34_8&#39;)"><span class="hl_varref"><span class="mpre">pushLog</span></span></a><span class="mpre"> </span><a href="#loc_101_5_101_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_7&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre"> </span><a href="#loc_100_9_100_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_15&#39;)"><span class="hl_varref"><span class="mpre">logger</span></span></a><span class="mpre"> </span><a href="#loc_92_35_92_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_35_92_41&#39;)"><span class="hl_varref"><span class="mpre">logmsg</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Flushing log messages in buffers.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   This function must be called explicitly when the program is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   being terminated.</span></span><span class="mpre">
</span><a href="#loc_108_1_108_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_12&#39;)"><span class="mpre">flushLogStr</span></a><span class="mpre"> :: </span><a href="#loc_57_6_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_6_57_15&#39;)"><span class="hl_tyconref"><span class="mpre">LoggerSet</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_108_1_108_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_12&#39;)"><span class="hl_fundecl"><span class="mpre">flushLogStr</span></span></a><span class="mpre"> (</span><a href="#loc_57_18_57_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_27&#39;)"><span class="hl_conref"><span class="mpre">LoggerSet</span></span></a><span class="mpre"> _ </span><a name="loc_108_26_108_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_26_108_30&#39;)"><span class="hl_vardecl"><span class="mpre">fref</span></span></a><span class="mpre"> </span><a name="loc_108_31_108_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_31_108_34&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre">) = do
    let (</span><span class="hl_vardecl"><span class="mpre">l</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">u</span></span><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">bounds</span></span><span class="mpre"> </span><a href="#loc_108_31_108_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_31_108_34&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre">
    </span><a name="loc_110_5_110_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_5_110_7&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_108_26_108_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_26_108_30&#39;)"><span class="hl_varref"><span class="mpre">fref</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> (</span><a href="#loc_113_5_113_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_12&#39;)"><span class="hl_varref"><span class="mpre">flushIt</span></span></a><span class="mpre"> </span><a href="#loc_110_5_110_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_5_110_7&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre">) </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fast-logger-2.1.5/System/Log/FastLogger.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 24, srcSpanEndLine = 111, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fast-logger-2.1.5/System/Log/FastLogger.hs&quot;, srcSpanStartLine = 111, srcSpanStartColumn = 24, srcSpanEndLine = 111, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fast-logger-2.1.5/System/Log/Fast"><span class="mpre">[l .. u]</span></span><span class="mpre">
  where
    </span><a name="loc_113_5_113_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_12&#39;)"><span class="hl_fundecl"><span class="mpre">flushIt</span></span></a><span class="mpre"> </span><a name="loc_113_13_113_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_13_113_15&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre"> </span><a name="loc_113_16_113_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_16_113_17&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="System.Log.FastLogger.Logger.html#loc_51_1_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Log.FastLogger.Logger.html#loc_51_1_51_9&#39;)"><span class="hl_varref"><span class="mpre">flushLog</span></span></a><span class="mpre"> </span><a href="#loc_113_13_113_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_13_113_15&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre"> (</span><a href="#loc_108_31_108_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_31_108_34&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!</span></span><span class="mpre"> </span><a href="#loc_113_16_113_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_16_113_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Renewing the internal file information in &#39;LoggerSet&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   This does nothing for stdout and stderr.</span></span><span class="mpre">
</span><a href="#loc_118_1_118_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_15&#39;)"><span class="mpre">renewLoggerSet</span></a><span class="mpre"> :: </span><a href="#loc_57_6_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_6_57_15&#39;)"><span class="hl_tyconref"><span class="mpre">LoggerSet</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_118_1_118_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_15&#39;)"><span class="hl_fundecl"><span class="mpre">renewLoggerSet</span></span></a><span class="mpre"> (</span><a href="#loc_57_18_57_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_27&#39;)"><span class="hl_conref"><span class="mpre">LoggerSet</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">     _    _) = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
</span><a href="#loc_118_1_118_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_15&#39;)"><span class="hl_fundecl"><span class="mpre">renewLoggerSet</span></span></a><span class="mpre"> (</span><a href="#loc_57_18_57_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_27&#39;)"><span class="hl_conref"><span class="mpre">LoggerSet</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_119_33_119_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_33_119_37&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre">) </span><a name="loc_119_39_119_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_39_119_43&#39;)"><span class="hl_vardecl"><span class="mpre">fref</span></span></a><span class="mpre"> _) = do
    </span><a name="loc_120_5_120_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_5_120_10&#39;)"><span class="hl_vardecl"><span class="mpre">newfd</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="hl_varref"><span class="mpre">logOpen</span></span></a><span class="mpre"> </span><a href="#loc_119_33_119_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_33_119_37&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">
    </span><a name="loc_121_5_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_10&#39;)"><span class="hl_vardecl"><span class="mpre">oldfd</span></span></a><span class="mpre"> &lt;- </span><a href="System.Log.FastLogger.IORef.html#loc_14_1_14_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Log.FastLogger.IORef.html#loc_14_1_14_19&#39;)"><span class="hl_varref"><span class="mpre">atomicModifyIORef&#39;</span></span></a><span class="mpre"> </span><a href="#loc_119_39_119_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_39_119_43&#39;)"><span class="hl_varref"><span class="mpre">fref</span></span></a><span class="mpre"> (\</span><a name="loc_121_40_121_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_40_121_42&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_120_5_120_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_5_120_10&#39;)"><span class="hl_varref"><span class="mpre">newfd</span></span></a><span class="mpre">, </span><a href="#loc_121_40_121_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_40_121_42&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre">))
    </span><a href="GHC.IO.Device.html#loc_71_3_71_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Device.html#loc_71_3_71_8&#39;)"><span class="hl_varref"><span class="mpre">close</span></span></a><span class="mpre"> </span><a href="#loc_121_5_121_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_10&#39;)"><span class="hl_varref"><span class="mpre">oldfd</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Flushing the buffers, closing the internal file information</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   and freeing the buffers.</span></span><span class="mpre">
</span><a href="#loc_127_1_127_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_12&#39;)"><span class="mpre">rmLoggerSet</span></a><span class="mpre"> :: </span><a href="#loc_57_6_57_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_6_57_15&#39;)"><span class="hl_tyconref"><span class="mpre">LoggerSet</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_127_1_127_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_12&#39;)"><span class="hl_fundecl"><span class="mpre">rmLoggerSet</span></span></a><span class="mpre"> (</span><a href="#loc_57_18_57_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_27&#39;)"><span class="hl_conref"><span class="mpre">LoggerSet</span></span></a><span class="mpre"> </span><a name="loc_127_24_127_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_24_127_29&#39;)"><span class="hl_vardecl"><span class="mpre">mfile</span></span></a><span class="mpre"> </span><a name="loc_127_30_127_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_30_127_34&#39;)"><span class="hl_vardecl"><span class="mpre">fref</span></span></a><span class="mpre"> </span><a name="loc_127_35_127_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_35_127_38&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre">) = do
    let (</span><span class="hl_vardecl"><span class="mpre">l</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">u</span></span><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">bounds</span></span><span class="mpre"> </span><a href="#loc_127_35_127_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_35_127_38&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre">
    </span><a name="loc_129_5_129_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_5_129_7&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_127_30_127_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_30_127_34&#39;)"><span class="hl_varref"><span class="mpre">fref</span></span></a><span class="mpre">
    let </span><a name="loc_130_9_130_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_9_130_13&#39;)"><span class="hl_vardecl"><span class="mpre">nums</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fast-logger-2.1.5/System/Log/FastLogger.hs&quot;, srcSpanStartLine = 130, srcSpanStartColumn = 16, srcSpanEndLine = 130, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fast-logger-2.1.5/System/Log/FastLogger.hs&quot;, srcSpanStartLine = 130, srcSpanStartColumn = 16, srcSpanEndLine = 130, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fast-logger-2.1.5/System/Log/Fast"><span class="mpre">[l .. u]</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> (</span><a href="#loc_135_5_135_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_12&#39;)"><span class="hl_varref"><span class="mpre">flushIt</span></span></a><span class="mpre"> </span><a href="#loc_129_5_129_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_5_129_7&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre">) </span><a href="#loc_130_9_130_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_9_130_13&#39;)"><span class="hl_varref"><span class="mpre">nums</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> </span><a href="#loc_136_5_136_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_5_136_11&#39;)"><span class="hl_varref"><span class="mpre">freeIt</span></span></a><span class="mpre"> </span><a href="#loc_130_9_130_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_9_130_13&#39;)"><span class="hl_varref"><span class="mpre">nums</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> </span><a href="#loc_127_24_127_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_24_127_29&#39;)"><span class="hl_varref"><span class="mpre">mfile</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.Device.html#loc_71_3_71_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Device.html#loc_71_3_71_8&#39;)"><span class="hl_varref"><span class="mpre">close</span></span></a><span class="mpre"> </span><a href="#loc_129_5_129_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_5_129_7&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre">
  where
    </span><a name="loc_135_5_135_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_12&#39;)"><span class="hl_fundecl"><span class="mpre">flushIt</span></span></a><span class="mpre"> </span><a name="loc_135_13_135_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_13_135_15&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre"> </span><a name="loc_135_16_135_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_16_135_17&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="System.Log.FastLogger.Logger.html#loc_51_1_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Log.FastLogger.Logger.html#loc_51_1_51_9&#39;)"><span class="hl_varref"><span class="mpre">flushLog</span></span></a><span class="mpre"> </span><a href="#loc_135_13_135_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_13_135_15&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre"> (</span><a href="#loc_127_35_127_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_35_127_38&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!</span></span><span class="mpre"> </span><a href="#loc_135_16_135_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_16_135_17&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
    </span><a name="loc_136_5_136_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_5_136_11&#39;)"><span class="hl_fundecl"><span class="mpre">freeIt</span></span></a><span class="mpre"> </span><a name="loc_136_12_136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_12_136_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = do
        let (</span><a href="System.Log.FastLogger.Logger.html#loc_20_15_20_21" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Log.FastLogger.Logger.html#loc_20_15_20_21&#39;)"><span class="hl_conref"><span class="mpre">Logger</span></span></a><span class="mpre"> </span><a name="loc_137_21_137_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_21_137_25&#39;)"><span class="hl_vardecl"><span class="mpre">mbuf</span></span></a><span class="mpre"> _ _) = </span><a href="#loc_127_35_127_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_35_127_38&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!</span></span><span class="mpre"> </span><a href="#loc_136_12_136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_12_136_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">takeMVar</span></span><span class="mpre"> </span><a href="#loc_137_21_137_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_21_137_25&#39;)"><span class="hl_varref"><span class="mpre">mbuf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.Log.FastLogger.IO.html#loc_32_1_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Log.FastLogger.IO.html#loc_32_1_32_11&#39;)"><span class="hl_varref"><span class="mpre">freeBuffer</span></span></a><span class="mpre">
</span></div></body></html>