<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
{-# LANGUAGE Rank2Types #-}
{-# LANGUAGE FlexibleContexts #-}
#ifdef TRUSTWORTHY
{-# LANGUAGE Trustworthy #-}
#endif
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Control.Lens.Level</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (C) 2012-14 Edward Kmett</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Edward Kmett &lt;ekmett@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  Rank2Types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module provides combinators for breadth-first searching within</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- arbitrary traversals.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------------</span></span><span class="mpre">
module Control.Lens.Level
  ( Level
  , levels
  , ilevels
  ) where

import Control.Applicative
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Level.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 8, srcSpanEndLine = 26, srcSpanEndColumn = 36}, srcInfoPoints = []}) &quot;Control.Lens.Internal.Bazaar&quot;"><span class="mpre">Control.Lens.Internal.Bazaar</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/lens-4.3/src/Control/Lens/Level.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 8, srcSpanEndLine = 27, srcSpanEndColumn = 37}, srcInfoPoints = []}) &quot;Control.Lens.Internal.Context&quot;"><span class="mpre">Control.Lens.Internal.Context</span></span><span class="mpre">
import Control.Lens.Internal.Indexed
import Control.Lens.Internal.Level
import Control.Lens.Traversal
import Data.Profunctor.Unsafe

</span><span class="hl_comment"><span class="mpre">-- $setup</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; :set -XNoOverloadedStrings</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; import Control.Lens</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; import Data.Char</span></span><span class="mpre">

</span><a href="#loc_39_1_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_9&#39;)"><span class="mpre">levelIns</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bazaar</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">(-&gt;)</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> -&gt; [</span><a href="Control.Lens.Internal.Level.html#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_39_1_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_9&#39;)"><span class="hl_vardecl"><span class="mpre">levelIns</span></span></a><span class="mpre"> = </span><a href="#loc_40_3_40_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_3_40_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="Control.Applicative.html#loc_236_29_236_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_236_29_236_37&#39;)"><span class="hl_varref"><span class="mpre">getConst</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">#.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">bazaar</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Const</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">#.</span></span><span class="mpre"> </span><a href="Control.Lens.Internal.Level.html#loc_122_1_122_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_122_1_122_10&#39;)"><span class="hl_varref"><span class="mpre">deepening</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)) where
  </span><a name="loc_40_3_40_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_3_40_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_40_6_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_7&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_40_8_40_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_8_40_9&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = </span><a href="#loc_40_6_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_7&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><a href="Control.Lens.Internal.Level.html#loc_103_37_103_49" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_103_37_103_49&#39;)"><span class="hl_varref"><span class="mpre">runDeepening</span></span></a><span class="mpre"> </span><a href="#loc_40_8_40_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_8_40_9&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_40_6_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_7&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_40_41_40_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_41_40_43&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_40_44_40_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_44_40_45&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt;
    </span><a href="#loc_40_41_40_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_41_40_43&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> if </span><a href="#loc_40_44_40_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_44_40_45&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then (</span><a href="#loc_40_3_40_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_3_40_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_40_6_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_6_40_7&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_40_8_40_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_8_40_9&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> else []
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_39_1_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_9&#39;)"><span class="mpre">levelIns</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_45_1_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_10&#39;)"><span class="mpre">levelOuts</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bazaar</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">(-&gt;)</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> -&gt; [</span><a href="Control.Lens.Internal.Level.html#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">j</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">
</span><a name="loc_45_1_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_10&#39;)"><span class="hl_fundecl"><span class="mpre">levelOuts</span></span></a><span class="mpre"> </span><a name="loc_45_11_45_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_11_45_13&#39;)"><span class="hl_vardecl"><span class="mpre">bz</span></span></a><span class="mpre"> = </span><a href="Control.Lens.Internal.Level.html#loc_133_31_133_39" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_133_31_133_39&#39;)"><span class="hl_varref"><span class="mpre">runFlows</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">runBazaar</span></span><span class="mpre"> </span><a href="#loc_45_11_45_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_11_45_13&#39;)"><span class="hl_varref"><span class="mpre">bz</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ _ -&gt; </span><span class="hl_conref"><span class="mpre">Flows</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_45_58_45_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_58_45_59&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_45_58_45_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_58_45_59&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> of
  </span><a href="Control.Lens.Internal.Level.html#loc_60_5_60_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_60_5_60_8&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> _ </span><a name="loc_46_9_46_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> _ -&gt; </span><a href="#loc_46_9_46_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
  _           -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;levelOuts: wrong shape&quot;</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_45_1_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_10&#39;)"><span class="mpre">levelOuts</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This provides a breadth-first &#39;Traversal&#39; of the individual &#39;levels&#39; of any other &#39;Traversal&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- via iterative deepening depth-first search. The levels are returned to you in a compressed format.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This can permit us to extract the &#39;levels&#39; directly:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; [&quot;hello&quot;,&quot;world&quot;]^..levels (traverse.traverse)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [Zero,Zero,One () &#39;h&#39;,Two 0 (One () &#39;e&#39;) (One () &#39;w&#39;),Two 0 (One () &#39;l&#39;) (One () &#39;o&#39;),Two 0 (One () &#39;l&#39;) (One () &#39;r&#39;),Two 0 (One () &#39;o&#39;) (One () &#39;l&#39;),One () &#39;d&#39;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- But we can also traverse them in turn:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; [&quot;hello&quot;,&quot;world&quot;]^..levels (traverse.traverse).traverse</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;hewlolrold&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We can use this to traverse to a fixed depth in the tree of (&#39;&lt;*&gt;&#39;) used in the &#39;Traversal&#39;:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; [&quot;hello&quot;,&quot;world&quot;] &amp; taking 4 (levels (traverse.traverse)).traverse %~ toUpper</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [&quot;HEllo&quot;,&quot;World&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Or we can use it to traverse the first @n@ elements in found in that &#39;Traversal&#39; regardless of the depth</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- at which they were found.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; [&quot;hello&quot;,&quot;world&quot;] &amp; taking 4 (levels (traverse.traverse).traverse) %~ toUpper</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [&quot;HELlo&quot;,&quot;World&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The resulting &#39;Traversal&#39; of the &#39;levels&#39; which is indexed by the depth of each &#39;Level&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; [&quot;dog&quot;,&quot;cat&quot;]^@..levels (traverse.traverse) &lt;. traverse</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [(2,&#39;d&#39;),(3,&#39;o&#39;),(3,&#39;c&#39;),(4,&#39;g&#39;),(4,&#39;a&#39;),(5,&#39;t&#39;)]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Note:/ Internally this is implemented by using an illegal &#39;Applicative&#39;, as it extracts information</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in an order that violates the &#39;Applicative&#39; laws.</span></span><span class="mpre">
</span><a href="#loc_82_1_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_7&#39;)"><span class="mpre">levels</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ATraversal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IndexedTraversal</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> (</span><a href="Control.Lens.Internal.Level.html#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) (</span><a href="Control.Lens.Internal.Level.html#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_82_1_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_7&#39;)"><span class="hl_fundecl"><span class="mpre">levels</span></span></a><span class="mpre"> </span><a name="loc_82_8_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_8_82_9&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_82_10_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_10_82_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_82_12_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_45_1_45_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_10&#39;)"><span class="hl_varref"><span class="mpre">levelOuts</span></span></a><span class="mpre"> </span><a href="#loc_83_3_83_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_3_83_5&#39;)"><span class="hl_varref"><span class="mpre">bz</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Control.Lens.Traversal.html#loc_1003_1_1003_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Traversal.html#loc_1003_1_1003_10&#39;)"><span class="hl_varref"><span class="mpre">traversed</span></span></a><span class="mpre"> </span><a href="#loc_82_10_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_10_82_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_39_1_39_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_9&#39;)"><span class="hl_varref"><span class="mpre">levelIns</span></span></a><span class="mpre"> </span><a href="#loc_83_3_83_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_3_83_5&#39;)"><span class="hl_varref"><span class="mpre">bz</span></span></a><span class="mpre">) where
  </span><a name="loc_83_3_83_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_3_83_5&#39;)"><span class="hl_vardecl"><span class="mpre">bz</span></span></a><span class="mpre"> = </span><a href="#loc_82_8_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_8_82_9&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sell</span></span><span class="mpre"> </span><a href="#loc_82_12_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_82_1_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_7&#39;)"><span class="mpre">levels</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_87_1_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_10&#39;)"><span class="mpre">ilevelIns</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bazaar</span></span><span class="mpre"> (</span><a href="Control.Lens.Internal.Indexed.html#loc_112_9_112_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Indexed.html#loc_112_9_112_16&#39;)"><span class="hl_tyconref"><span class="mpre">Indexed</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> -&gt; [</span><a href="Control.Lens.Internal.Level.html#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_87_1_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_10&#39;)"><span class="hl_vardecl"><span class="mpre">ilevelIns</span></span></a><span class="mpre"> = </span><a href="#loc_88_3_88_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_3_88_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="Control.Applicative.html#loc_236_29_236_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_236_29_236_37&#39;)"><span class="hl_varref"><span class="mpre">getConst</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">#.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">bazaar</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Indexed</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_87_53_87_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_53_87_54&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Const</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">#.</span></span><span class="mpre"> </span><a href="Control.Lens.Internal.Level.html#loc_122_1_122_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_122_1_122_10&#39;)"><span class="hl_varref"><span class="mpre">deepening</span></span></a><span class="mpre"> </span><a href="#loc_87_53_87_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_53_87_54&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)) where
  </span><a name="loc_88_3_88_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_3_88_5&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_88_6_88_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_7&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_88_8_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_8_88_9&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> = </span><a href="#loc_88_6_88_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_7&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><a href="Control.Lens.Internal.Level.html#loc_103_37_103_49" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_103_37_103_49&#39;)"><span class="hl_varref"><span class="mpre">runDeepening</span></span></a><span class="mpre"> </span><a href="#loc_88_8_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_8_88_9&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_88_6_88_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_7&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ </span><a name="loc_88_41_88_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_41_88_43&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_88_44_88_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_44_88_45&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt;
    </span><a href="#loc_88_41_88_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_41_88_43&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> if </span><a href="#loc_88_44_88_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_44_88_45&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then (</span><a href="#loc_88_3_88_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_3_88_5&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_88_6_88_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_7&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_88_8_88_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_8_88_9&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> else []
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_87_1_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_10&#39;)"><span class="mpre">ilevelIns</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_93_1_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_11&#39;)"><span class="mpre">ilevelOuts</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bazaar</span></span><span class="mpre"> (</span><a href="Control.Lens.Internal.Indexed.html#loc_112_9_112_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Indexed.html#loc_112_9_112_16&#39;)"><span class="hl_tyconref"><span class="mpre">Indexed</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> -&gt; [</span><a href="Control.Lens.Internal.Level.html#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">j</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">
</span><a name="loc_93_1_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_11&#39;)"><span class="hl_fundecl"><span class="mpre">ilevelOuts</span></span></a><span class="mpre"> </span><a name="loc_93_12_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_12_93_14&#39;)"><span class="hl_vardecl"><span class="mpre">bz</span></span></a><span class="mpre"> = </span><a href="Control.Lens.Internal.Level.html#loc_133_31_133_39" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_133_31_133_39&#39;)"><span class="hl_varref"><span class="mpre">runFlows</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">runBazaar</span></span><span class="mpre"> </span><a href="#loc_93_12_93_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_12_93_14&#39;)"><span class="hl_varref"><span class="mpre">bz</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Indexed</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ _ _ -&gt; </span><span class="hl_conref"><span class="mpre">Flows</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_93_71_93_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_71_93_72&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> -&gt; case </span><a href="#loc_93_71_93_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_71_93_72&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> of
  </span><a href="Control.Lens.Internal.Level.html#loc_60_5_60_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_60_5_60_8&#39;)"><span class="hl_conref"><span class="mpre">One</span></span></a><span class="mpre"> _ </span><a name="loc_94_9_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> _ -&gt; </span><a href="#loc_94_9_94_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
  _           -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ilevelOuts: wrong shape&quot;</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_93_1_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_11&#39;)"><span class="mpre">ilevelOuts</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This provides a breadth-first &#39;Traversal&#39; of the individual levels of any other &#39;Traversal&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- via iterative deepening depth-first search. The levels are returned to you in a compressed format.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is similar to &#39;levels&#39;, but retains the index of the original &#39;IndexedTraversal&#39;, so you can</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- access it when traversing the levels later on.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; [&quot;dog&quot;,&quot;cat&quot;]^@..ilevels (traversed&lt;.&gt;traversed).itraversed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [((0,0),&#39;d&#39;),((0,1),&#39;o&#39;),((1,0),&#39;c&#39;),((0,2),&#39;g&#39;),((1,1),&#39;a&#39;),((1,2),&#39;t&#39;)]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The resulting &#39;Traversal&#39; of the levels which is indexed by the depth of each &#39;Level&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;&gt;&gt; [&quot;dog&quot;,&quot;cat&quot;]^@..ilevels (traversed&lt;.&gt;traversed)&lt;.&gt;itraversed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [((2,(0,0)),&#39;d&#39;),((3,(0,1)),&#39;o&#39;),((3,(1,0)),&#39;c&#39;),((4,(0,2)),&#39;g&#39;),((4,(1,1)),&#39;a&#39;),((5,(1,2)),&#39;t&#39;)]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Note:/ Internally this is implemented by using an illegal &#39;Applicative&#39;, as it extracts information</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in an order that violates the &#39;Applicative&#39; laws.</span></span><span class="mpre">
</span><a href="#loc_115_1_115_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_8&#39;)"><span class="mpre">ilevels</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">AnIndexedTraversal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IndexedTraversal</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> (</span><a href="Control.Lens.Internal.Level.html#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) (</span><a href="Control.Lens.Internal.Level.html#loc_58_6_58_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Internal.Level.html#loc_58_6_58_11&#39;)"><span class="hl_tyconref"><span class="mpre">Level</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">j</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_115_1_115_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_8&#39;)"><span class="hl_fundecl"><span class="mpre">ilevels</span></span></a><span class="mpre"> </span><a name="loc_115_9_115_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_10&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_115_11_115_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_11_115_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_115_13_115_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_13_115_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="#loc_93_1_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_11&#39;)"><span class="hl_varref"><span class="mpre">ilevelOuts</span></span></a><span class="mpre"> </span><a href="#loc_116_3_116_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_3_116_5&#39;)"><span class="hl_varref"><span class="mpre">bz</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Control.Lens.Traversal.html#loc_1003_1_1003_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Lens.Traversal.html#loc_1003_1_1003_10&#39;)"><span class="hl_varref"><span class="mpre">traversed</span></span></a><span class="mpre"> </span><a href="#loc_115_11_115_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_11_115_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_87_1_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_10&#39;)"><span class="hl_varref"><span class="mpre">ilevelIns</span></span></a><span class="mpre"> </span><a href="#loc_116_3_116_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_3_116_5&#39;)"><span class="hl_varref"><span class="mpre">bz</span></span></a><span class="mpre">) where
  </span><a name="loc_116_3_116_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_3_116_5&#39;)"><span class="hl_vardecl"><span class="mpre">bz</span></span></a><span class="mpre"> = </span><a href="#loc_115_9_115_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_9_115_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sell</span></span><span class="mpre"> </span><a href="#loc_115_13_115_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_13_115_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_115_1_115_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_8&#39;)"><span class="mpre">ilevels</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span></div></body></html>