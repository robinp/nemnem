<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- #hide</span></span><span class="mpre">
module Data.Time.Clock.CTimeval where

#ifndef mingw32_HOST_OS
</span><span class="hl_comment"><span class="mpre">-- All Unix-specific, this</span></span><span class="mpre">

import Foreign.Safe
import Foreign.C

data </span><a name="loc_10_6_10_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_6_10_14&#39;)"><span class="hl_tycondecl"><span class="mpre">CTimeval</span></span></a><span class="mpre"> = </span><a name="loc_10_17_10_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_17_10_27&#39;)"><span class="hl_condecl"><span class="mpre">MkCTimeval</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CLong</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">CLong</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Storable</span></span><span class="mpre"> </span><a href="#loc_10_6_10_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_6_10_14&#39;)"><span class="hl_tyconref"><span class="mpre">CTimeval</span></span></a><span class="mpre"> where
        </span><span class="hl_fundecl"><span class="mpre">sizeOf</span></span><span class="mpre"> _ = (</span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CLong</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
        </span><span class="hl_fundecl"><span class="mpre">alignment</span></span><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">alignment</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CLong</span></span><span class="mpre">)
        </span><span class="hl_fundecl"><span class="mpre">peek</span></span><span class="mpre"> </span><a name="loc_15_14_15_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_14_15_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = do
                </span><a name="loc_16_17_16_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_17_16_18&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">   &lt;- </span><span class="hl_varref"><span class="mpre">peekElemOff</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_15_14_15_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_14_15_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                </span><a name="loc_17_17_17_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_17_17_20&#39;)"><span class="hl_vardecl"><span class="mpre">mus</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peekElemOff</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_15_14_15_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_14_15_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_10_17_10_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_17_10_27&#39;)"><span class="hl_conref"><span class="mpre">MkCTimeval</span></span></a><span class="mpre"> </span><a href="#loc_16_17_16_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_17_16_18&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_17_17_17_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_17_17_20&#39;)"><span class="hl_varref"><span class="mpre">mus</span></span></a><span class="mpre">)
        </span><span class="hl_fundecl"><span class="mpre">poke</span></span><span class="mpre"> </span><a name="loc_19_14_19_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_14_19_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a href="#loc_10_17_10_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_17_10_27&#39;)"><span class="hl_conref"><span class="mpre">MkCTimeval</span></span></a><span class="mpre"> </span><a name="loc_19_28_19_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_28_19_29&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_19_30_19_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_30_19_33&#39;)"><span class="hl_vardecl"><span class="mpre">mus</span></span></a><span class="mpre">) = do
                </span><span class="hl_varref"><span class="mpre">pokeElemOff</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_19_14_19_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_14_19_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_19_28_19_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_28_19_29&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">pokeElemOff</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_19_14_19_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_14_19_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_19_30_19_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_30_19_33&#39;)"><span class="hl_varref"><span class="mpre">mus</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/Clock/CTimeval.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 1, srcSpanEndLine = 23, srcSpanEndColumn = 100}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/Clock/CTimeval.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 1, srcSpanEndLine = 23, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/time-1.4.2/Data/Time/Clock/CTimeval.hs&quot;, srcSpanSta"><span class="mpre">foreign import ccall unsafe &quot;time.h gettimeofday&quot; gettimeofday :: Ptr CTimeval -&gt; Ptr () -&gt; IO CInt</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get the current POSIX time from the system clock.</span></span><span class="mpre">
</span><a href="#loc_27_1_27_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_12&#39;)"><span class="mpre">getCTimeval</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_10_6_10_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_6_10_14&#39;)"><span class="hl_tyconref"><span class="mpre">CTimeval</span></span></a><span class="mpre">
</span><a name="loc_27_1_27_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_12&#39;)"><span class="hl_vardecl"><span class="mpre">getCTimeval</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">with</span></span><span class="mpre"> (</span><a href="#loc_10_17_10_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_17_10_27&#39;)"><span class="hl_conref"><span class="mpre">MkCTimeval</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) (\</span><a name="loc_27_39_27_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_39_27_44&#39;)"><span class="hl_vardecl"><span class="mpre">ptval</span></span></a><span class="mpre"> -&gt; do
        </span><span class="hl_varref"><span class="mpre">throwErrnoIfMinus1_</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;gettimeofday&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">gettimeofday</span></span><span class="mpre"> </span><a href="#loc_27_39_27_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_39_27_44&#39;)"><span class="hl_varref"><span class="mpre">ptval</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><a href="#loc_27_39_27_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_39_27_44&#39;)"><span class="hl_varref"><span class="mpre">ptval</span></span></a><span class="mpre">
        )

#endif
</span></div></body></html>