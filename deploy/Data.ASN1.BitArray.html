<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.ASN1.BitArray</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
{-# LANGUAGE DeriveDataTypeable #-}
module Data.ASN1.BitArray
    ( BitArray(..)
    , BitArrayOutOfBound(..)
    , bitArrayLength
    , bitArrayGetBit
    , bitArraySetBitValue
    , bitArraySetBit
    , bitArrayClearBit
    , bitArrayGetData
    , toBitArray
    ) where

import Data.Bits
import Data.Word
import Data.Maybe
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/BitArray.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 8, srcSpanEndLine = 24, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/BitArray.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 18, srcSpanEndLine = 25, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Data.Typeable
import Control.Exception (Exception, throw)

</span><span class="hl_comment"><span class="mpre">-- | throwed in case of out of bounds in the bitarray.</span></span><span class="mpre">
data </span><a name="loc_30_6_30_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_24&#39;)"><span class="hl_tycondecl"><span class="mpre">BitArrayOutOfBound</span></span></a><span class="mpre"> = </span><a name="loc_30_27_30_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_27_30_45&#39;)"><span class="hl_condecl"><span class="mpre">BitArrayOutOfBound</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/BitArray.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 5, srcSpanEndLine = 31, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/BitArray.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 5, srcSpanEndLine = 31, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/BitArray.hs&quot;, srcSpanS"><span class="mpre">deriving (Show,Eq,Typeable)</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Exception</span></span><span class="mpre"> </span><a href="#loc_30_6_30_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_6_30_24&#39;)"><span class="hl_tyconref"><span class="mpre">BitArrayOutOfBound</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | represent a bitarray / bitmap</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the memory representation start at bit 0</span></span><span class="mpre">
data </span><a name="loc_37_6_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_14&#39;)"><span class="hl_tycondecl"><span class="mpre">BitArray</span></span></a><span class="mpre"> = </span><a name="loc_37_17_37_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_17_37_25&#39;)"><span class="hl_condecl"><span class="mpre">BitArray</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/BitArray.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 5, srcSpanEndLine = 38, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/BitArray.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 5, srcSpanEndLine = 38, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-types-0.2.3/Data/ASN1/BitArray.hs&quot;, srcSpanS"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | returns the length of bits in this bitarray</span></span><span class="mpre">
</span><a href="#loc_42_1_42_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_15&#39;)"><span class="mpre">bitArrayLength</span></a><span class="mpre"> :: </span><a href="#loc_37_6_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_14&#39;)"><span class="hl_tyconref"><span class="mpre">BitArray</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">
</span><a name="loc_42_1_42_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_15&#39;)"><span class="hl_fundecl"><span class="mpre">bitArrayLength</span></span></a><span class="mpre"> (</span><a href="#loc_37_17_37_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_17_37_25&#39;)"><span class="hl_conref"><span class="mpre">BitArray</span></span></a><span class="mpre"> </span><a name="loc_42_26_42_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_26_42_27&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> _) = </span><a href="#loc_42_26_42_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_26_42_27&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><a href="#loc_45_1_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_19&#39;)"><span class="mpre">bitArrayOutOfBound</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_45_1_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_19&#39;)"><span class="hl_fundecl"><span class="mpre">bitArrayOutOfBound</span></span></a><span class="mpre"> </span><a name="loc_45_20_45_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_20_45_21&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">throw</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_30_27_30_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_27_30_45&#39;)"><span class="hl_conref"><span class="mpre">BitArrayOutOfBound</span></span></a><span class="mpre"> </span><a href="#loc_45_20_45_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_20_45_21&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | get the nth bits</span></span><span class="mpre">
</span><a href="#loc_49_1_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_15&#39;)"><span class="mpre">bitArrayGetBit</span></a><span class="mpre"> :: </span><a href="#loc_37_6_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_14&#39;)"><span class="hl_tyconref"><span class="mpre">BitArray</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_49_1_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_15&#39;)"><span class="hl_fundecl"><span class="mpre">bitArrayGetBit</span></span></a><span class="mpre"> (</span><a href="#loc_37_17_37_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_17_37_25&#39;)"><span class="hl_conref"><span class="mpre">BitArray</span></span></a><span class="mpre"> </span><a name="loc_49_26_49_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_26_49_27&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_49_28_49_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_28_49_29&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) </span><a name="loc_49_31_49_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_31_49_32&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">
    | </span><a href="#loc_49_31_49_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_31_49_32&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_49_26_49_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_26_49_27&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">    = </span><a href="#loc_45_1_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_19&#39;)"><span class="hl_varref"><span class="mpre">bitArrayOutOfBound</span></span></a><span class="mpre"> </span><a href="#loc_49_31_49_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_31_49_32&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Data.Bits.html#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_167_5_167_12&#39;)"><span class="hl_varref"><span class="mpre">testBit</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">7</span></span><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_52_24_52_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_24_52_28&#39;)"><span class="hl_varref"><span class="mpre">bitn</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.index</span></span><span class="mpre"> </span><a href="#loc_49_28_49_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_28_49_29&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_52_16_52_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_22&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre">)
        where (</span><a name="loc_52_16_52_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_22&#39;)"><span class="hl_vardecl"><span class="mpre">offset</span></span></a><span class="mpre">, </span><a name="loc_52_24_52_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_24_52_28&#39;)"><span class="hl_vardecl"><span class="mpre">bitn</span></span></a><span class="mpre">) = </span><a href="#loc_49_31_49_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_31_49_32&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`divMod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | set the nth bit to the value specified</span></span><span class="mpre">
</span><a href="#loc_56_1_56_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_20&#39;)"><span class="mpre">bitArraySetBitValue</span></a><span class="mpre"> :: </span><a href="#loc_37_6_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_14&#39;)"><span class="hl_tyconref"><span class="mpre">BitArray</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><a href="#loc_37_6_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_14&#39;)"><span class="hl_tyconref"><span class="mpre">BitArray</span></span></a><span class="mpre">
</span><a name="loc_56_1_56_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_20&#39;)"><span class="hl_fundecl"><span class="mpre">bitArraySetBitValue</span></span></a><span class="mpre"> (</span><a href="#loc_37_17_37_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_17_37_25&#39;)"><span class="hl_conref"><span class="mpre">BitArray</span></span></a><span class="mpre"> </span><a name="loc_56_31_56_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_31_56_32&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_56_33_56_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_33_56_34&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) </span><a name="loc_56_36_56_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_36_56_37&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_56_38_56_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_38_56_39&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">
    | </span><a href="#loc_56_36_56_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_36_56_37&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_56_31_56_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_31_56_32&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">    = </span><a href="#loc_45_1_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_1_45_19&#39;)"><span class="hl_varref"><span class="mpre">bitArrayOutOfBound</span></span></a><span class="mpre"> </span><a href="#loc_56_36_56_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_36_56_37&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
        let (</span><a name="loc_59_14_59_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_14_59_20&#39;)"><span class="hl_vardecl"><span class="mpre">before</span></span></a><span class="mpre">,</span><a name="loc_59_21_59_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_26&#39;)"><span class="hl_vardecl"><span class="mpre">after</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_64_10_64_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_10_64_16&#39;)"><span class="hl_varref"><span class="mpre">offset</span></span></a><span class="mpre">) </span><a href="#loc_56_33_56_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_33_56_34&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> in
        </span><span class="hl_comment"><span class="mpre">-- array bound check before prevent fromJust from failing.</span></span><span class="mpre">
        let (</span><a name="loc_61_14_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_14_61_15&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">,</span><a name="loc_61_16_61_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_16_61_25&#39;)"><span class="hl_vardecl"><span class="mpre">remaining</span></span></a><span class="mpre">) = </span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.uncons</span></span><span class="mpre"> </span><a href="#loc_59_21_59_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_26&#39;)"><span class="hl_varref"><span class="mpre">after</span></span></a><span class="mpre"> in
        </span><a href="#loc_37_17_37_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_17_37_25&#39;)"><span class="hl_conref"><span class="mpre">BitArray</span></span></a><span class="mpre"> </span><a href="#loc_56_31_56_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_31_56_32&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_59_14_59_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_14_59_20&#39;)"><span class="hl_varref"><span class="mpre">before</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.append`</span></span><span class="mpre"> (</span><a href="#loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_varref"><span class="mpre">setter</span></span></a><span class="mpre"> </span><a href="#loc_61_14_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_14_61_15&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">7</span></span><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_64_18_64_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_18_64_22&#39;)"><span class="hl_varref"><span class="mpre">bitn</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`B.cons`</span></span><span class="mpre"> </span><a href="#loc_61_16_61_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_16_61_25&#39;)"><span class="hl_varref"><span class="mpre">remaining</span></span></a><span class="mpre">))
  where
        (</span><a name="loc_64_10_64_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_10_64_16&#39;)"><span class="hl_vardecl"><span class="mpre">offset</span></span></a><span class="mpre">, </span><a name="loc_64_18_64_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_18_64_22&#39;)"><span class="hl_vardecl"><span class="mpre">bitn</span></span></a><span class="mpre">) = </span><a href="#loc_56_36_56_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_36_56_37&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`divMod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">
        </span><a name="loc_65_9_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_15&#39;)"><span class="hl_vardecl"><span class="mpre">setter</span></span></a><span class="mpre"> = if </span><a href="#loc_56_38_56_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_38_56_39&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> then </span><a href="Data.Bits.html#loc_158_5_158_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_158_5_158_11&#39;)"><span class="hl_varref"><span class="mpre">setBit</span></span></a><span class="mpre"> else </span><a href="Data.Bits.html#loc_161_5_161_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_161_5_161_13&#39;)"><span class="hl_varref"><span class="mpre">clearBit</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | set the nth bits</span></span><span class="mpre">
</span><a href="#loc_69_1_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_15&#39;)"><span class="mpre">bitArraySetBit</span></a><span class="mpre"> :: </span><a href="#loc_37_6_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_14&#39;)"><span class="hl_tyconref"><span class="mpre">BitArray</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><a href="#loc_37_6_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_14&#39;)"><span class="hl_tyconref"><span class="mpre">BitArray</span></span></a><span class="mpre">
</span><a name="loc_69_1_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_15&#39;)"><span class="hl_fundecl"><span class="mpre">bitArraySetBit</span></span></a><span class="mpre"> </span><a name="loc_69_16_69_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_16_69_24&#39;)"><span class="hl_vardecl"><span class="mpre">bitarray</span></span></a><span class="mpre"> </span><a name="loc_69_25_69_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_25_69_26&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_56_1_56_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_20&#39;)"><span class="hl_varref"><span class="mpre">bitArraySetBitValue</span></span></a><span class="mpre"> </span><a href="#loc_69_16_69_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_16_69_24&#39;)"><span class="hl_varref"><span class="mpre">bitarray</span></span></a><span class="mpre"> </span><a href="#loc_69_25_69_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_25_69_26&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | clear the nth bits</span></span><span class="mpre">
</span><a href="#loc_73_1_73_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_17&#39;)"><span class="mpre">bitArrayClearBit</span></a><span class="mpre"> :: </span><a href="#loc_37_6_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_14&#39;)"><span class="hl_tyconref"><span class="mpre">BitArray</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><a href="#loc_37_6_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_14&#39;)"><span class="hl_tyconref"><span class="mpre">BitArray</span></span></a><span class="mpre">
</span><a name="loc_73_1_73_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_17&#39;)"><span class="hl_fundecl"><span class="mpre">bitArrayClearBit</span></span></a><span class="mpre"> </span><a name="loc_73_18_73_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_18_73_26&#39;)"><span class="hl_vardecl"><span class="mpre">bitarray</span></span></a><span class="mpre"> </span><a name="loc_73_27_73_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_27_73_28&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_56_1_56_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_20&#39;)"><span class="hl_varref"><span class="mpre">bitArraySetBitValue</span></span></a><span class="mpre"> </span><a href="#loc_73_18_73_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_18_73_26&#39;)"><span class="hl_varref"><span class="mpre">bitarray</span></span></a><span class="mpre"> </span><a href="#loc_73_27_73_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_27_73_28&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | get padded bytestring of the bitarray</span></span><span class="mpre">
</span><a href="#loc_77_1_77_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_16&#39;)"><span class="mpre">bitArrayGetData</span></a><span class="mpre"> :: </span><a href="#loc_37_6_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_14&#39;)"><span class="hl_tyconref"><span class="mpre">BitArray</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_77_1_77_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_16&#39;)"><span class="hl_fundecl"><span class="mpre">bitArrayGetData</span></span></a><span class="mpre"> (</span><a href="#loc_37_17_37_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_17_37_25&#39;)"><span class="hl_conref"><span class="mpre">BitArray</span></span></a><span class="mpre"> _ </span><a name="loc_77_29_77_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_29_77_30&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) = </span><a href="#loc_77_29_77_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_29_77_30&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | number of bit to skip at the end (padding)</span></span><span class="mpre">
</span><a href="#loc_81_1_81_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_11&#39;)"><span class="mpre">toBitArray</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_37_6_37_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_6_37_14&#39;)"><span class="hl_tyconref"><span class="mpre">BitArray</span></span></a><span class="mpre">
</span><a name="loc_81_1_81_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_11&#39;)"><span class="hl_fundecl"><span class="mpre">toBitArray</span></span></a><span class="mpre"> </span><a name="loc_81_12_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_12_81_13&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_81_14_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_14_81_20&#39;)"><span class="hl_vardecl"><span class="mpre">toSkip</span></span></a><span class="mpre"> =
    </span><a href="#loc_37_17_37_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_17_37_25&#39;)"><span class="hl_conref"><span class="mpre">BitArray</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_81_12_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_12_81_13&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_81_14_81_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_14_81_20&#39;)"><span class="hl_varref"><span class="mpre">toSkip</span></span></a><span class="mpre">)) </span><a href="#loc_81_12_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_12_81_13&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
</span></div></body></html>