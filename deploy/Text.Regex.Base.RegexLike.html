<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE MultiParamTypeClasses, FunctionalDependencies #-}
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Text.Regex.Base.RegexLike</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) Chris Kuklewicz 2006</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org, textregexlazy@personal.mightyreason.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (MPTC+FD)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Classes and instances for Regex matching.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- All the classes are declared here, and some common type aliases, and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the MatchResult data type.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The only instances here are for Extract String and Extract ByteString.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- There are no data values.  The &#39;RegexContext&#39; instances are in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;Text.Regex.Base.Context&quot;, except for ones which run afoul of a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- repeated variable (RegexContext regex a a), which are defined in each</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- modules&#39; String and ByteString modules.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Text.Regex.Base.RegexLike (
  </span><span class="hl_comment"><span class="mpre">-- ** Type aliases</span></span><span class="mpre">
  MatchOffset,
  MatchLength,
  MatchArray,
  MatchText,
  </span><span class="hl_comment"><span class="mpre">-- ** Data types</span></span><span class="mpre">
  MatchResult(..),
  </span><span class="hl_comment"><span class="mpre">-- ** Classes</span></span><span class="mpre">
  RegexOptions(..),
  RegexMaker(..),
  RegexLike(..),
  RegexContext(..),
  Extract(..),
  AllSubmatches(..),AllTextSubmatches(..),AllMatches(..),AllTextMatches(..)
  ) where

import Data.Array(Array,(!))
import Data.Maybe(</span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="mpre">isJust</span></a><span class="mpre">)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 18, srcSpanEndLine = 44, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B (take,drop,empty,ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 18, srcSpanEndLine = 45, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L (take,drop,empty,ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 18, srcSpanEndLine = 46, srcSpanEndColumn = 31}, srcInfoPoints = []}) &quot;Data.Sequence&quot;"><span class="mpre">Data.Sequence</span></span><span class="mpre"> as S(take,drop,empty,Seq)

</span><span class="hl_comment"><span class="mpre">-- | 0 based index from start of source, or (-1) for unused</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 1, srcSpanEndLine = 49, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 1, srcSpanEndLine = 49, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/"><span class="mpre">type MatchOffset = Int</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | non-negative length of a match</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 1, srcSpanEndLine = 51, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 1, srcSpanEndLine = 51, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/"><span class="mpre">type MatchLength = Int</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | 0 based array, with 0th index indicating the full match.  If the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- full match location is not available, represent as (0,0).</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 54, srcSpanStartColumn = 1, srcSpanEndLine = 54, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 54, srcSpanStartColumn = 1, srcSpanEndLine = 54, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/"><span class="mpre">type MatchArray = Array Int (MatchOffset,MatchLength)</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 1, srcSpanEndLine = 55, srcSpanEndColumn = 69}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 1, srcSpanEndLine = 55, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/"><span class="mpre">type MatchText source = Array Int (source,(MatchOffset,MatchLength))</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This is the same as the type from JRegex.</span></span><span class="mpre">
data </span><a name="loc_58_6_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_6_58_17&#39;)"><span class="hl_tycondecl"><span class="mpre">MatchResult</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">MR</span></span><span class="mpre"> {
    </span><a name="loc_59_5_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_13&#39;)"><span class="hl_fielddecl"><span class="mpre">mrBefore</span></span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,
    </span><a name="loc_60_5_60_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_12&#39;)"><span class="hl_fielddecl"><span class="mpre">mrMatch</span></span></a><span class="mpre">  :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,
    </span><a name="loc_61_5_61_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_12&#39;)"><span class="hl_fielddecl"><span class="mpre">mrAfter</span></span></a><span class="mpre">  :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,
    </span><a name="loc_62_5_62_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_14&#39;)"><span class="hl_fielddecl"><span class="mpre">mrSubList</span></span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">],
    </span><a name="loc_63_5_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_11&#39;)"><span class="hl_fielddecl"><span class="mpre">mrSubs</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Array</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
}

</span><span class="hl_comment"><span class="mpre">----------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Rather than carry them around spearately, the options for how to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- execute a regex are kept as part of the regex.  There are two types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of options.  Those that can only be specified at compilation time</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and never changed are CompOpt.  Those that can be changed later and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- affect how matching is performed are ExecOpt.  The actually types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for these depend on the backend.</span></span><span class="mpre">
class </span><a name="loc_73_7_73_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_7_73_19&#39;)"><span class="hl_classdecl"><span class="mpre">RegexOptions</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">compOpt</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">execOpt</span></span><span class="mpre"> 
  | </span><span class="warning" data-warning="FundepFunDep (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 74, srcSpanStartColumn = 5, srcSpanEndLine = 74, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 74, srcSpanStartColumn = 10, srcSpanEndLine = 74, srcSpanEndColumn = 12}]}) [Ident (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">regex-&gt;compOpt execOpt</span></span><span class="mpre">, </span><span class="warning" data-warning="FundepFunDep (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 74, srcSpanStartColumn = 29, srcSpanEndLine = 74, srcSpanEndColumn = 51}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 74, srcSpanStartColumn = 36, srcSpanEndLine = 74, srcSpanEndColumn = 38}]}) [Ident (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/"><span class="mpre">compOpt-&gt;regex execOpt</span></span><span class="mpre">, </span><span class="warning" data-warning="FundepFunDep (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 74, srcSpanStartColumn = 53, srcSpanEndLine = 74, srcSpanEndColumn = 75}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 74, srcSpanStartColumn = 60, srcSpanEndLine = 74, srcSpanEndColumn = 62}]}) [Ident (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/"><span class="mpre">execOpt-&gt;regex compOpt</span></span><span class="mpre"> where
  </span><a name="loc_75_3_75_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_3_75_15&#39;)"><span class="mpre">blankCompOpt</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">compOpt</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ no options set at all in the backend</span></span><span class="mpre">
  </span><a name="loc_76_3_76_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_3_76_15&#39;)"><span class="mpre">blankExecOpt</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">execOpt</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ no options set at all in the backend</span></span><span class="mpre">
  </span><a name="loc_77_3_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_3_77_17&#39;)"><span class="mpre">defaultCompOpt</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">compOpt</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ reasonable options (extended,caseSensitive,multiline regex)</span></span><span class="mpre">
  </span><a name="loc_78_3_78_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_3_78_17&#39;)"><span class="mpre">defaultExecOpt</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">execOpt</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ reasonable options (extended,caseSensitive,multiline regex)</span></span><span class="mpre">
  </span><a name="loc_79_3_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_3_79_14&#39;)"><span class="mpre">setExecOpts</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">execOpt</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- ^ forget old flags and use new ones</span></span><span class="mpre">
  </span><a name="loc_81_3_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_3_81_14&#39;)"><span class="mpre">getExecOpts</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">execOpt</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- ^ retrieve the current flags</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | RegexMaker captures the creation of the compiled regular</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- expression from a source type and an option type.  &#39;makeRegexM&#39; and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;makeRegexM&#39; report parse error using &#39;MonadError&#39;, usually (Either</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- String regex).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;makeRegex&#39; function has a default implementation that depends</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- on makeRegexOpts and used &#39;defaultCompOpt&#39; and &#39;defaultExecOpt&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Similarly for &#39;makeRegexM&#39; and &#39;makeRegexOptsM&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- There are also default implementaions for &#39;makeRegexOpts&#39; and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;makeRegexOptsM&#39; in terms of each other.  So a minimal instance</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- definition needs to only define one of these, hopefully</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;makeRegexOptsM&#39;.</span></span><span class="mpre">
class </span><span class="warning" data-warning="ClassDecl ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 7, srcSpanEndLine = 98, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 7, srcSpanEndLine = 98, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/R"><span class="mpre">(RegexOptions regex compOpt execOpt) =&gt;</span></span><span class="mpre"> </span><a name="loc_98_47_98_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_47_98_57&#39;)"><span class="hl_classdecl"><span class="mpre">RegexMaker</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">compOpt</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">execOpt</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre"> 
  | </span><span class="warning" data-warning="FundepFunDep (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 5, srcSpanEndLine = 99, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 11, srcSpanEndLine = 99, srcSpanEndColumn = 13}]}) [Ident (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/p"><span class="mpre">regex -&gt; compOpt execOpt</span></span><span class="mpre">, </span><span class="warning" data-warning="FundepFunDep (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 31, srcSpanEndLine = 99, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 39, srcSpanEndLine = 99, srcSpanEndColumn = 41}]}) [Ident (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/"><span class="mpre">compOpt -&gt; regex execOpt</span></span><span class="mpre">, </span><span class="warning" data-warning="FundepFunDep (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 57, srcSpanEndLine = 99, srcSpanEndColumn = 81}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 65, srcSpanEndLine = 99, srcSpanEndColumn = 67}]}) [Ident (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/"><span class="mpre">execOpt -&gt; regex compOpt</span></span><span class="mpre"> where
  </span><span class="hl_comment"><span class="mpre">-- | make using the defaultCompOpt and defaultExecOpt</span></span><span class="mpre">
  </span><a name="loc_101_3_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_3_101_12&#39;)"><span class="mpre">makeRegex</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | Specify your own options</span></span><span class="mpre">
  </span><a name="loc_103_3_103_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_3_103_16&#39;)"><span class="mpre">makeRegexOpts</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">compOpt</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">execOpt</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | make using the defaultCompOpt and defaultExecOpt, reporting errors with fail</span></span><span class="mpre">
  </span><a name="loc_105_3_105_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_3_105_13&#39;)"><span class="mpre">makeRegexM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 17, srcSpanEndLine = 105, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 105, srcSpanStartColumn = 17, srcSpanEndLine = 105, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex"><span class="mpre">(Monad m) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | Specify your own options, reporting errors with fail</span></span><span class="mpre">
  </span><a name="loc_107_3_107_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_3_107_17&#39;)"><span class="mpre">makeRegexOptsM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 21, srcSpanEndLine = 107, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 21, srcSpanEndLine = 107, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex"><span class="mpre">(Monad m) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">compOpt</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">execOpt</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre">

  </span><a href="#loc_101_3_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_3_101_12&#39;)"><span class="hl_vardecl"><span class="mpre">makeRegex</span></span></a><span class="mpre"> = </span><a href="#loc_103_3_103_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_3_103_16&#39;)"><span class="hl_varref"><span class="mpre">makeRegexOpts</span></span></a><span class="mpre"> </span><a href="#loc_77_3_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_3_77_17&#39;)"><span class="hl_varref"><span class="mpre">defaultCompOpt</span></span></a><span class="mpre"> </span><a href="#loc_78_3_78_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_3_78_17&#39;)"><span class="hl_varref"><span class="mpre">defaultExecOpt</span></span></a><span class="mpre">
  </span><a href="#loc_105_3_105_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_3_105_13&#39;)"><span class="hl_vardecl"><span class="mpre">makeRegexM</span></span></a><span class="mpre"> = </span><a href="#loc_107_3_107_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_3_107_17&#39;)"><span class="hl_varref"><span class="mpre">makeRegexOptsM</span></span></a><span class="mpre"> </span><a href="#loc_77_3_77_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_3_77_17&#39;)"><span class="hl_varref"><span class="mpre">defaultCompOpt</span></span></a><span class="mpre"> </span><a href="#loc_78_3_78_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_3_78_17&#39;)"><span class="hl_varref"><span class="mpre">defaultExecOpt</span></span></a><span class="mpre">
  </span><a href="#loc_103_3_103_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_3_103_16&#39;)"><span class="hl_fundecl"><span class="mpre">makeRegexOpts</span></span></a><span class="mpre"> </span><a name="loc_111_17_111_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_17_111_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_111_19_111_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_20&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> </span><a name="loc_111_21_111_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_21_111_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;makeRegexOpts failed&quot;</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> (</span><a href="#loc_107_3_107_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_3_107_17&#39;)"><span class="hl_varref"><span class="mpre">makeRegexOptsM</span></span></a><span class="mpre"> </span><a href="#loc_111_17_111_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_17_111_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_111_19_111_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_19_111_20&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="#loc_111_21_111_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_21_111_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
  </span><a href="#loc_107_3_107_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_3_107_17&#39;)"><span class="hl_fundecl"><span class="mpre">makeRegexOptsM</span></span></a><span class="mpre"> </span><a name="loc_112_18_112_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_18_112_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_112_20_112_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_20_112_21&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> </span><a name="loc_112_22_112_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_22_112_23&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_103_3_103_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_3_103_16&#39;)"><span class="hl_varref"><span class="mpre">makeRegexOpts</span></span></a><span class="mpre"> </span><a href="#loc_112_18_112_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_18_112_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_112_20_112_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_20_112_21&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><a href="#loc_112_22_112_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_22_112_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | RegexLike is parametrized on a regular expression type and a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- source type to run the matching on.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- There are default implementations: matchTest and matchOnceText use</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- matchOnce; matchCount and matchAllText use matchAll. matchOnce uses</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- matchOnceText and matchAll uses matchAllText. So a minimal complete</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- instance need to provide at least (matchOnce or matchOnceText) and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (matchAll or matchAllText).  Additional definitions are often</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- provided where they will increase efficiency.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; [ c | let notVowel = makeRegex &quot;[^aeiou]&quot; :: Regex, c &lt;- [&#39;a&#39;..&#39;z&#39;], matchTest notVowel [c]  ]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; &quot;bcdfghjklmnpqrstvwxyz&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The strictness of these functions is instance dependent.</span></span><span class="mpre">
class </span><span class="warning" data-warning="ClassDecl ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 130, srcSpanStartColumn = 7, srcSpanEndLine = 130, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 130, srcSpanStartColumn = 7, srcSpanEndLine = 130, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Ba"><span class="mpre">(Extract source)=&gt;</span></span><span class="mpre"> </span><a name="loc_130_26_130_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_26_130_35&#39;)"><span class="hl_classdecl"><span class="mpre">RegexLike</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre"> where
  </span><span class="hl_comment"><span class="mpre">-- | This returns the first match in the source (it checks the whole</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- source, not just at the start). This returns an array of</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- (offset,length) index pairs for the match and captured</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- substrings.  The offset is 0-based.  A (-1) for an offset means a</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- failure to match.  The lower bound of the array is 0, and the 0th</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- element is the (offset,length) for the whole match.</span></span><span class="mpre">
  </span><a name="loc_137_3_137_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_3_137_12&#39;)"><span class="mpre">matchOnce</span></a><span class="mpre">  :: </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre">-&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">MatchArray</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | matchAll returns a list of matches.  The matches are in order</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- and do not overlap. If any match succeeds but has 0 length then</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- this will be the last match in the list.</span></span><span class="mpre">
  </span><a name="loc_141_3_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_11&#39;)"><span class="mpre">matchAll</span></a><span class="mpre">   :: </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre">-&gt; [</span><span class="hl_tyconref"><span class="mpre">MatchArray</span></span><span class="mpre">]
  </span><span class="hl_comment"><span class="mpre">-- | matchCount returns the number of non-overlapping matches</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- returned by matchAll.</span></span><span class="mpre">
  </span><a name="loc_144_3_144_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_3_144_13&#39;)"><span class="mpre">matchCount</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre">-&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | matchTest return True if there is a match somewhere in the</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- source (it checks the whole source not just at the start).</span></span><span class="mpre">
  </span><a name="loc_147_3_147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_3_147_12&#39;)"><span class="mpre">matchTest</span></a><span class="mpre">  :: </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre">-&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | This is matchAll with the actual subsections of the source</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- instead of just the (offset,length) information.</span></span><span class="mpre">
  </span><a name="loc_150_3_150_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_3_150_15&#39;)"><span class="mpre">matchAllText</span></a><span class="mpre">  :: </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre">-&gt; [</span><span class="hl_tyconref"><span class="mpre">MatchText</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre">]
  </span><span class="hl_comment"><span class="mpre">-- | This can return a tuple of three items: the source before the</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- match, an array of the match and captured substrings (with their</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- indices), and the source after the match.</span></span><span class="mpre">
  </span><a name="loc_154_3_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_3_154_16&#39;)"><span class="mpre">matchOnceText</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre">-&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">MatchText</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre">)

  </span><a href="#loc_141_3_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_11&#39;)"><span class="hl_fundecl"><span class="mpre">matchAll</span></span></a><span class="mpre"> </span><a name="loc_156_12_156_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_12_156_17&#39;)"><span class="hl_vardecl"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a name="loc_156_18_156_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_18_156_24&#39;)"><span class="hl_vardecl"><span class="mpre">source</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">) (</span><a href="#loc_150_3_150_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_3_150_15&#39;)"><span class="hl_varref"><span class="mpre">matchAllText</span></span></a><span class="mpre"> </span><a href="#loc_156_12_156_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_12_156_17&#39;)"><span class="hl_varref"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a href="#loc_156_18_156_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_18_156_24&#39;)"><span class="hl_varref"><span class="mpre">source</span></span></a><span class="mpre">)
  </span><a href="#loc_137_3_137_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_3_137_12&#39;)"><span class="hl_fundecl"><span class="mpre">matchOnce</span></span></a><span class="mpre"> </span><a name="loc_157_13_157_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_13_157_18&#39;)"><span class="hl_vardecl"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a name="loc_157_19_157_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_19_157_25&#39;)"><span class="hl_vardecl"><span class="mpre">source</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (\(_,</span><a name="loc_157_38_157_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_38_157_40&#39;)"><span class="hl_vardecl"><span class="mpre">mt</span></span></a><span class="mpre">,_) -&gt; </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_157_38_157_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_38_157_40&#39;)"><span class="hl_varref"><span class="mpre">mt</span></span></a><span class="mpre">) (</span><a href="#loc_154_3_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_3_154_16&#39;)"><span class="hl_varref"><span class="mpre">matchOnceText</span></span></a><span class="mpre"> </span><a href="#loc_157_13_157_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_13_157_18&#39;)"><span class="hl_varref"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a href="#loc_157_19_157_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_19_157_25&#39;)"><span class="hl_varref"><span class="mpre">source</span></span></a><span class="mpre">)
  </span><a href="#loc_147_3_147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_3_147_12&#39;)"><span class="hl_fundecl"><span class="mpre">matchTest</span></span></a><span class="mpre"> </span><a name="loc_158_13_158_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_13_158_18&#39;)"><span class="hl_vardecl"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a name="loc_158_19_158_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_19_158_25&#39;)"><span class="hl_vardecl"><span class="mpre">source</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> (</span><a href="#loc_137_3_137_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_3_137_12&#39;)"><span class="hl_varref"><span class="mpre">matchOnce</span></span></a><span class="mpre"> </span><a href="#loc_158_13_158_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_13_158_18&#39;)"><span class="hl_varref"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a href="#loc_158_19_158_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_19_158_25&#39;)"><span class="hl_varref"><span class="mpre">source</span></span></a><span class="mpre">)
  </span><a href="#loc_144_3_144_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_3_144_13&#39;)"><span class="hl_fundecl"><span class="mpre">matchCount</span></span></a><span class="mpre"> </span><a name="loc_159_14_159_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_14_159_19&#39;)"><span class="hl_vardecl"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a name="loc_159_20_159_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_20_159_26&#39;)"><span class="hl_vardecl"><span class="mpre">source</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> (</span><a href="#loc_141_3_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_11&#39;)"><span class="hl_varref"><span class="mpre">matchAll</span></span></a><span class="mpre"> </span><a href="#loc_159_14_159_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_14_159_19&#39;)"><span class="hl_varref"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a href="#loc_159_20_159_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_20_159_26&#39;)"><span class="hl_varref"><span class="mpre">source</span></span></a><span class="mpre">)
  </span><a href="#loc_154_3_154_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_3_154_16&#39;)"><span class="hl_fundecl"><span class="mpre">matchOnceText</span></span></a><span class="mpre"> </span><a name="loc_160_17_160_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_17_160_22&#39;)"><span class="hl_vardecl"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a name="loc_160_23_160_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_23_160_29&#39;)"><span class="hl_vardecl"><span class="mpre">source</span></span></a><span class="mpre"> = 
    </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (\</span><a name="loc_161_12_161_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_12_161_14&#39;)"><span class="hl_vardecl"><span class="mpre">ma</span></span></a><span class="mpre"> -&gt; let (</span><a name="loc_161_23_161_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_23_161_24&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre">,</span><a name="loc_161_25_161_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_25_161_26&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = </span><a href="#loc_161_12_161_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_12_161_14&#39;)"><span class="hl_varref"><span class="mpre">ma</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                 in (</span><a href="#loc_198_3_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_3_198_9&#39;)"><span class="hl_varref"><span class="mpre">before</span></span></a><span class="mpre"> </span><a href="#loc_161_23_161_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_23_161_24&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="#loc_160_23_160_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_23_160_29&#39;)"><span class="hl_varref"><span class="mpre">source</span></span></a><span class="mpre">
                    ,</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (\</span><a name="loc_163_29_163_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_29_163_31&#39;)"><span class="hl_vardecl"><span class="mpre">ol</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_206_3_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_3_206_10&#39;)"><span class="hl_varref"><span class="mpre">extract</span></span></a><span class="mpre"> </span><a href="#loc_163_29_163_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_29_163_31&#39;)"><span class="hl_varref"><span class="mpre">ol</span></span></a><span class="mpre"> </span><a href="#loc_160_23_160_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_23_160_29&#39;)"><span class="hl_varref"><span class="mpre">source</span></span></a><span class="mpre">,</span><a href="#loc_163_29_163_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_29_163_31&#39;)"><span class="hl_varref"><span class="mpre">ol</span></span></a><span class="mpre">)) </span><a href="#loc_161_12_161_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_12_161_14&#39;)"><span class="hl_varref"><span class="mpre">ma</span></span></a><span class="mpre">
                    ,</span><a href="#loc_200_3_200_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_3_200_8&#39;)"><span class="hl_varref"><span class="mpre">after</span></span></a><span class="mpre"> (</span><a href="#loc_161_23_161_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_23_161_24&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_161_25_161_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_25_161_26&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_160_23_160_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_23_160_29&#39;)"><span class="hl_varref"><span class="mpre">source</span></span></a><span class="mpre">))
         (</span><a href="#loc_137_3_137_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_3_137_12&#39;)"><span class="hl_varref"><span class="mpre">matchOnce</span></span></a><span class="mpre"> </span><a href="#loc_160_17_160_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_17_160_22&#39;)"><span class="hl_varref"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a href="#loc_160_23_160_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_23_160_29&#39;)"><span class="hl_varref"><span class="mpre">source</span></span></a><span class="mpre">)
  </span><a href="#loc_150_3_150_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_3_150_15&#39;)"><span class="hl_fundecl"><span class="mpre">matchAllText</span></span></a><span class="mpre"> </span><a name="loc_166_16_166_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_16_166_21&#39;)"><span class="hl_vardecl"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a name="loc_166_22_166_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_22_166_28&#39;)"><span class="hl_vardecl"><span class="mpre">source</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (\</span><a name="loc_167_17_167_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_17_167_19&#39;)"><span class="hl_vardecl"><span class="mpre">ol</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_206_3_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_3_206_10&#39;)"><span class="hl_varref"><span class="mpre">extract</span></span></a><span class="mpre"> </span><a href="#loc_167_17_167_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_17_167_19&#39;)"><span class="hl_varref"><span class="mpre">ol</span></span></a><span class="mpre"> </span><a href="#loc_166_22_166_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_22_166_28&#39;)"><span class="hl_varref"><span class="mpre">source</span></span></a><span class="mpre">,</span><a href="#loc_167_17_167_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_17_167_19&#39;)"><span class="hl_varref"><span class="mpre">ol</span></span></a><span class="mpre">)))
        (</span><a href="#loc_141_3_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_11&#39;)"><span class="hl_varref"><span class="mpre">matchAll</span></span></a><span class="mpre"> </span><a href="#loc_166_16_166_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_16_166_21&#39;)"><span class="hl_varref"><span class="mpre">regex</span></span></a><span class="mpre"> </span><a href="#loc_166_22_166_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_22_166_28&#39;)"><span class="hl_varref"><span class="mpre">source</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | RegexContext is the polymorphic interface to do matching.  Since</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;target&#39; is polymorphic you may need to suply the type explicitly</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in contexts where it cannot be inferred.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The monadic &#39;matchM&#39; version uses &#39;fail&#39; to report when the &#39;regex&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- has no match in &#39;source&#39;.  Two examples:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Here the contest &#39;Bool&#39; is inferred:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; [ c | let notVowel = makeRegex &quot;[^aeiou]&quot; :: Regex, c &lt;- [&#39;a&#39;..&#39;z&#39;], match notVowel [c]  ]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; &quot;bcdfghjklmnpqrstvwxyz&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Here the context &#39;[String]&#39; must be supplied:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; let notVowel = (makeRegex &quot;[^aeiou]&quot; :: Regex )</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; in do { c &lt;- [&#39;a&#39;..&#39;z&#39;] ; matchM notVowel [c] } :: [String]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; [&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,&quot;f&quot;,&quot;g&quot;,&quot;h&quot;,&quot;j&quot;,&quot;k&quot;,&quot;l&quot;,&quot;m&quot;,&quot;n&quot;,&quot;p&quot;,&quot;q&quot;,&quot;r&quot;,&quot;s&quot;,&quot;t&quot;,&quot;v&quot;,&quot;w&quot;,&quot;x&quot;,&quot;y&quot;,&quot;z&quot;]</span></span><span class="mpre">
class </span><span class="warning" data-warning="ClassDecl ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 190, srcSpanStartColumn = 7, srcSpanEndLine = 190, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 190, srcSpanStartColumn = 7, srcSpanEndLine = 190, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Ba"><span class="mpre">(RegexLike regex source) =&gt;</span></span><span class="mpre"> </span><a name="loc_190_35_190_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_35_190_47&#39;)"><span class="hl_classdecl"><span class="mpre">RegexContext</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">target</span></span><span class="mpre"> where
  </span><a name="loc_191_3_191_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_3_191_8&#39;)"><span class="mpre">match</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">target</span></span><span class="mpre">
  </span><a name="loc_192_3_192_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_3_192_9&#39;)"><span class="mpre">matchM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 192, srcSpanStartColumn = 13, srcSpanEndLine = 192, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex/Base/RegexLike.hs&quot;, srcSpanStartLine = 192, srcSpanStartColumn = 13, srcSpanEndLine = 192, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-base-0.93.2/Text/Regex"><span class="mpre">(Monad m) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">regex</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">target</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Extract allows for indexing operations on String or ByteString.</span></span><span class="mpre">
class </span><a name="loc_196_7_196_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_7_196_14&#39;)"><span class="hl_classdecl"><span class="mpre">Extract</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre"> where
  </span><span class="hl_comment"><span class="mpre">-- | before is a renamed &quot;take&quot;</span></span><span class="mpre">
  </span><a name="loc_198_3_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_3_198_9&#39;)"><span class="mpre">before</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | after is a renamed &quot;drop&quot;</span></span><span class="mpre">
  </span><a name="loc_200_3_200_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_3_200_8&#39;)"><span class="mpre">after</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | For when there is no match, this can construct an empty data value</span></span><span class="mpre">
  </span><a name="loc_202_3_202_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_3_202_8&#39;)"><span class="mpre">empty</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- | extract takes an offset and length and has a default</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- implementation of @extract (off,len) source = before len (after</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- off source)@</span></span><span class="mpre">
  </span><a name="loc_206_3_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_3_206_10&#39;)"><span class="mpre">extract</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">source</span></span><span class="mpre">
  </span><a href="#loc_206_3_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_3_206_10&#39;)"><span class="hl_fundecl"><span class="mpre">extract</span></span></a><span class="mpre"> (</span><a name="loc_207_12_207_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_12_207_15&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre">,</span><a name="loc_207_16_207_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_16_207_19&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) </span><a name="loc_207_21_207_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_21_207_27&#39;)"><span class="hl_vardecl"><span class="mpre">source</span></span></a><span class="mpre"> = </span><a href="#loc_198_3_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_3_198_9&#39;)"><span class="hl_varref"><span class="mpre">before</span></span></a><span class="mpre"> </span><a href="#loc_207_16_207_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_16_207_19&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> (</span><a href="#loc_200_3_200_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_3_200_8&#39;)"><span class="hl_varref"><span class="mpre">after</span></span></a><span class="mpre"> </span><a href="#loc_207_12_207_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_12_207_15&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_207_21_207_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_21_207_27&#39;)"><span class="hl_varref"><span class="mpre">source</span></span></a><span class="mpre">)

instance </span><a href="#loc_196_7_196_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_7_196_14&#39;)"><span class="hl_classref"><span class="mpre">Extract</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> where
  </span><a href="#loc_198_3_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_3_198_9&#39;)"><span class="hl_vardecl"><span class="mpre">before</span></span></a><span class="mpre"> =  </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre">; </span><a href="#loc_200_3_200_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_3_200_8&#39;)"><span class="hl_vardecl"><span class="mpre">after</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre">; </span><a href="#loc_202_3_202_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_3_202_8&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre"> = []

instance </span><a href="#loc_196_7_196_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_7_196_14&#39;)"><span class="hl_classref"><span class="mpre">Extract</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> where
  </span><a href="#loc_198_3_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_3_198_9&#39;)"><span class="hl_vardecl"><span class="mpre">before</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.take</span></span><span class="mpre">; </span><a href="#loc_200_3_200_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_3_200_8&#39;)"><span class="hl_vardecl"><span class="mpre">after</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre">; </span><a href="#loc_202_3_202_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_3_202_8&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.empty</span></span><span class="mpre">

instance </span><a href="#loc_196_7_196_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_7_196_14&#39;)"><span class="hl_classref"><span class="mpre">Extract</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre"> where
  </span><a href="#loc_198_3_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_3_198_9&#39;)"><span class="hl_vardecl"><span class="mpre">before</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.take</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre">; </span><a href="#loc_200_3_200_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_3_200_8&#39;)"><span class="hl_vardecl"><span class="mpre">after</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.drop</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre">; </span><a href="#loc_202_3_202_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_3_202_8&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">

instance </span><a href="#loc_196_7_196_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_7_196_14&#39;)"><span class="hl_classref"><span class="mpre">Extract</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">S.Seq</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
  </span><a href="#loc_198_3_198_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_3_198_9&#39;)"><span class="hl_vardecl"><span class="mpre">before</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre">; </span><a href="#loc_200_3_200_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_3_200_8&#39;)"><span class="hl_vardecl"><span class="mpre">after</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre">; </span><a href="#loc_202_3_202_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_3_202_8&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Used in results of RegexContext instances</span></span><span class="mpre">
newtype </span><a name="loc_222_9_222_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_9_222_22&#39;)"><span class="hl_tycondecl"><span class="mpre">AllSubmatches</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">AllSubmatches</span></span><span class="mpre"> {</span><a name="loc_222_44_222_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_44_222_60&#39;)"><span class="hl_fielddecl"><span class="mpre">getAllSubmatches</span></span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)}
</span><span class="hl_comment"><span class="mpre">-- | Used in results of RegexContext instances</span></span><span class="mpre">
newtype </span><a name="loc_224_9_224_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_9_224_26&#39;)"><span class="hl_tycondecl"><span class="mpre">AllTextSubmatches</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">AllTextSubmatches</span></span><span class="mpre"> {</span><a name="loc_224_52_224_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_52_224_72&#39;)"><span class="hl_fielddecl"><span class="mpre">getAllTextSubmatches</span></span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)}
</span><span class="hl_comment"><span class="mpre">-- | Used in results of RegexContext instances</span></span><span class="mpre">
newtype </span><a name="loc_226_9_226_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_9_226_19&#39;)"><span class="hl_tycondecl"><span class="mpre">AllMatches</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">AllMatches</span></span><span class="mpre"> {</span><a name="loc_226_38_226_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_38_226_51&#39;)"><span class="hl_fielddecl"><span class="mpre">getAllMatches</span></span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)}
</span><span class="hl_comment"><span class="mpre">-- | Used in results of RegexContext instances</span></span><span class="mpre">
newtype </span><a name="loc_228_9_228_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_9_228_23&#39;)"><span class="hl_tycondecl"><span class="mpre">AllTextMatches</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">AllTextMatches</span></span><span class="mpre"> {</span><a name="loc_228_46_228_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_46_228_63&#39;)"><span class="hl_fielddecl"><span class="mpre">getAllTextMatches</span></span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">f</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) }
</span></div></body></html>