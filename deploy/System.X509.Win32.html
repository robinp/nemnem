<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE ForeignFunctionInterface #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE CPP #-}
module System.X509.Win32
    ( getSystemCertificateStore
    ) where

import Foreign.Ptr
import Foreign.Storable
import Data.Word

import Control.Monad (</span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">)
import Control.Applicative

import qualified Data.ByteString.Internal as B

import Data.X509
import Data.X509.CertificateStore

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 8, srcSpanEndLine = 20, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;System.Win32.Types&quot;"><span class="mpre">System.Win32.Types</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 1, srcSpanEndLine = 22, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 1, srcSpanEndLine = 22, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanSt"><span class="mpre">type HCertStore = Ptr Word8</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 1, srcSpanEndLine = 23, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 1, srcSpanEndLine = 23, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanSt"><span class="mpre">type PCCERT_Context = Ptr Word8</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 1, srcSpanEndLine = 26, srcSpanEndColumn = 67}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 1, srcSpanEndLine = 25, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanStar"><span class="mpre">foreign import stdcall unsafe &quot;CertOpenSystemStoreW&quot;
    c_CertOpenSystemStore :: Ptr Word8 -&gt; LPCTSTR -&gt; IO HCertStore</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 1, srcSpanEndLine = 28, srcSpanEndColumn = 53}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 1, srcSpanEndLine = 27, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanStar"><span class="mpre">foreign import stdcall unsafe &quot;CertCloseStore&quot;
    c_CertCloseStore :: HCertStore -&gt; DWORD -&gt; IO ()</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 1, srcSpanEndLine = 31, srcSpanEndColumn = 87}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 1, srcSpanEndLine = 30, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/Win32.hs&quot;, srcSpanStar"><span class="mpre">foreign import stdcall unsafe &quot;CertEnumCertificatesInStore&quot;
    c_CertEnumCertificatesInStore :: HCertStore -&gt; PCCERT_Context -&gt; IO PCCERT_Context</span></span><span class="mpre">

</span><a href="#loc_34_1_34_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_20&#39;)"><span class="mpre">certOpenSystemStore</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HCertStore</span></span><span class="mpre">
</span><a name="loc_34_1_34_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_20&#39;)"><span class="hl_vardecl"><span class="mpre">certOpenSystemStore</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">withTString</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ROOT&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_34_45_34_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_45_34_49&#39;)"><span class="hl_vardecl"><span class="mpre">cstr</span></span></a><span class="mpre"> -&gt;
    </span><span class="hl_varref"><span class="mpre">c_CertOpenSystemStore</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre"> </span><a href="#loc_34_45_34_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_45_34_49&#39;)"><span class="hl_varref"><span class="mpre">cstr</span></span></a><span class="mpre">

</span><a href="#loc_38_1_38_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_16&#39;)"><span class="mpre">certFromContext</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">PCCERT_Context</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">SignedCertificate</span></span><span class="mpre">)
</span><a name="loc_38_1_38_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_16&#39;)"><span class="hl_fundecl"><span class="mpre">certFromContext</span></span></a><span class="mpre"> </span><a name="loc_38_17_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_17_38_21&#39;)"><span class="hl_vardecl"><span class="mpre">cctx</span></span></a><span class="mpre"> = do
    </span><a name="loc_39_5_39_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_7&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre">  &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_38_17_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_17_38_21&#39;)"><span class="hl_varref"><span class="mpre">cctx</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">DWORD</span></span><span class="mpre">)
    </span><a name="loc_40_5_40_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_5_40_6&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">   &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> (</span><a href="#loc_38_17_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_17_38_21&#39;)"><span class="hl_varref"><span class="mpre">cctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_48_9_48_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_25&#39;)"><span class="hl_varref"><span class="mpre">pbCertEncodedPos</span></span></a><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BYTE</span></span><span class="mpre">))
    </span><a name="loc_41_5_41_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_8&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> (</span><a href="#loc_38_17_38_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_17_38_21&#39;)"><span class="hl_varref"><span class="mpre">cctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_49_9_49_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_25&#39;)"><span class="hl_varref"><span class="mpre">cbCertEncodedPos</span></span></a><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">DWORD</span></span><span class="mpre">)
    </span><a href="#loc_43_9_43_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_16&#39;)"><span class="hl_varref"><span class="mpre">process</span></span></a><span class="mpre"> </span><a href="#loc_39_5_39_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_5_39_7&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> </span><a href="#loc_40_5_40_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_5_40_6&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_41_5_41_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_5_41_8&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
  where </span><a name="loc_43_9_43_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_16&#39;)"><span class="hl_fundecl"><span class="mpre">process</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a name="loc_43_19_43_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_19_43_20&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_43_21_43_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_21_43_24&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = do
            </span><a name="loc_44_13_44_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_13_44_14&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> &lt;- </span><a href="Data.ByteString.Internal.html#loc_434_1_434_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_434_1_434_7&#39;)"><span class="hl_varref"><span class="mpre">B.create</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_43_21_43_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_21_43_24&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_44_49_44_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_49_44_52&#39;)"><span class="hl_vardecl"><span class="mpre">dst</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_624_1_624_7&#39;)"><span class="hl_varref"><span class="mpre">B.memcpy</span></span></a><span class="mpre"> </span><a href="#loc_44_49_44_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_49_44_52&#39;)"><span class="hl_varref"><span class="mpre">dst</span></span></a><span class="mpre"> </span><a href="#loc_43_19_43_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_19_43_20&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_43_21_43_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_21_43_24&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">)
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.X509.Signed.html#loc_126_1_126_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_126_1_126_19&#39;)"><span class="hl_varref"><span class="mpre">decodeSignedObject</span></span></a><span class="mpre"> </span><a href="#loc_44_13_44_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_13_44_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
        </span><a href="#loc_43_9_43_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_16&#39;)"><span class="hl_fundecl"><span class="mpre">process</span></span></a><span class="mpre"> </span><a name="loc_46_17_46_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_19&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre"> _ _ =
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;windows certificate store: not supported type: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_46_17_46_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_17_46_19&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre">)
        </span><a name="loc_48_9_48_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_25&#39;)"><span class="hl_vardecl"><span class="mpre">pbCertEncodedPos</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">alignment</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BYTE</span></span><span class="mpre">))
        </span><a name="loc_49_9_49_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_25&#39;)"><span class="hl_vardecl"><span class="mpre">cbCertEncodedPos</span></span></a><span class="mpre"> = </span><a href="#loc_48_9_48_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_25&#39;)"><span class="hl_varref"><span class="mpre">pbCertEncodedPos</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BYTE</span></span><span class="mpre">))

</span><a href="#loc_52_1_52_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_26&#39;)"><span class="mpre">getSystemCertificateStore</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Data.X509.CertificateStore.html#loc_16_6_16_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateStore.html#loc_16_6_16_22&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateStore</span></span></a><span class="mpre">
</span><a name="loc_52_1_52_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_26&#39;)"><span class="hl_vardecl"><span class="mpre">getSystemCertificateStore</span></span></a><span class="mpre"> = do
    </span><a name="loc_53_5_53_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_10&#39;)"><span class="hl_vardecl"><span class="mpre">store</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_34_1_34_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_20&#39;)"><span class="hl_varref"><span class="mpre">certOpenSystemStore</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_53_5_53_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_10&#39;)"><span class="hl_varref"><span class="mpre">store</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;no store&quot;</span></span><span class="mpre">
    </span><a name="loc_55_5_55_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_5_55_10&#39;)"><span class="hl_vardecl"><span class="mpre">certs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_58_9_58_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_53_5_53_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_10&#39;)"><span class="hl_varref"><span class="mpre">store</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">c_CertCloseStore</span></span><span class="mpre"> </span><a href="#loc_53_5_53_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_10&#39;)"><span class="hl_varref"><span class="mpre">store</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Data.X509.CertificateStore.html#loc_28_1_28_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateStore.html#loc_28_1_28_21&#39;)"><span class="hl_varref"><span class="mpre">makeCertificateStore</span></span></a><span class="mpre"> </span><a href="#loc_55_5_55_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_5_55_10&#39;)"><span class="hl_varref"><span class="mpre">certs</span></span></a><span class="mpre">)
  where </span><a name="loc_58_9_58_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_58_14_58_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_14_58_16&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_58_17_58_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_17_58_20&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> = do
            </span><a name="loc_59_13_59_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_13_59_14&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">c_CertEnumCertificatesInStore</span></span><span class="mpre"> </span><a href="#loc_58_14_58_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_14_58_16&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_58_17_58_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_17_58_20&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">
            if </span><a href="#loc_59_13_59_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_13_59_14&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre">
                then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
                else do
                    </span><a name="loc_63_21_63_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_21_63_26&#39;)"><span class="hl_vardecl"><span class="mpre">ecert</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_38_1_38_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_1_38_16&#39;)"><span class="hl_varref"><span class="mpre">certFromContext</span></span></a><span class="mpre"> </span><a href="#loc_59_13_59_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_13_59_14&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
                    case </span><a href="#loc_63_21_63_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_21_63_26&#39;)"><span class="hl_varref"><span class="mpre">ecert</span></span></a><span class="mpre"> of
                        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> _     -&gt; </span><a href="#loc_58_9_58_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_58_14_58_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_14_58_16&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_59_13_59_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_13_59_14&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
                        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_66_31_66_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_31_66_35&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_66_31_66_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_31_66_35&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> (</span><a href="#loc_58_9_58_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_58_14_58_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_14_58_16&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_59_13_59_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_13_59_14&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)

</span></div></body></html>