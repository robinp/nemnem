<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module System.Console.Haskeline.Command.Undo where

import System.Console.Haskeline.Command
import System.Console.Haskeline.LineState
import System.Console.Haskeline.Monads

import Control.Monad

data </span><a name="loc_9_6_9_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_6_9_10&#39;)"><span class="hl_tycondecl"><span class="mpre">Undo</span></span></a><span class="mpre"> = </span><a name="loc_9_13_9_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_13_9_17&#39;)"><span class="hl_condecl"><span class="mpre">Undo</span></span></a><span class="mpre"> {</span><a name="loc_9_19_9_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_19_9_27&#39;)"><span class="hl_fielddecl"><span class="mpre">pastUndo</span></span></a><span class="mpre">, </span><a name="loc_9_29_9_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_29_9_39&#39;)"><span class="hl_fielddecl"><span class="mpre">futureRedo</span></span></a><span class="mpre"> :: [</span><a href="System.Console.Haskeline.LineState.html#loc_169_6_169_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Haskeline.LineState.html#loc_169_6_169_16&#39;)"><span class="hl_tyconref"><span class="mpre">InsertMode</span></span></a><span class="mpre">]}

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 1, srcSpanEndLine = 11, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 1, srcSpanEndLine = 11, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-"><span class="mpre">type UndoT = StateT Undo</span></span><span class="mpre">

</span><a href="#loc_14_1_14_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_1_14_9&#39;)"><span class="mpre">runUndoT</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 13, srcSpanEndLine = 13, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 21, srcSpanEndLine = 13, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilena"><span class="mpre">Monad m =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">UndoT</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_14_1_14_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_1_14_9&#39;)"><span class="hl_vardecl"><span class="mpre">runUndoT</span></span></a><span class="mpre"> = </span><a href="System.Console.Haskeline.Monads.html#loc_123_1_123_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Haskeline.Monads.html#loc_123_1_123_12&#39;)"><span class="hl_varref"><span class="mpre">evalStateT&#39;</span></span></a><span class="mpre"> </span><a href="#loc_17_1_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_12&#39;)"><span class="hl_varref"><span class="mpre">initialUndo</span></span></a><span class="mpre">

</span><a href="#loc_17_1_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_12&#39;)"><span class="mpre">initialUndo</span></a><span class="mpre"> :: </span><a href="#loc_9_6_9_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_6_9_10&#39;)"><span class="hl_tyconref"><span class="mpre">Undo</span></span></a><span class="mpre">
</span><a name="loc_17_1_17_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_12&#39;)"><span class="hl_vardecl"><span class="mpre">initialUndo</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 15, srcSpanEndLine = 17, srcSpanEndColumn = 59}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 20, srcSpanEndLine = 17, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskel"><span class="mpre">Undo {pastUndo = [emptyIM], futureRedo = []}</span></span><span class="mpre">


</span><a href="#loc_21_1_21_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_11&#39;)"><span class="mpre">saveToUndo</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 15, srcSpanEndLine = 20, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 22, srcSpanEndLine = 20, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilena"><span class="mpre">Save s =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><a href="#loc_9_6_9_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_6_9_10&#39;)"><span class="hl_tyconref"><span class="mpre">Undo</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_9_6_9_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_6_9_10&#39;)"><span class="hl_tyconref"><span class="mpre">Undo</span></span></a><span class="mpre">
</span><a name="loc_21_1_21_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_11&#39;)"><span class="hl_fundecl"><span class="mpre">saveToUndo</span></span></a><span class="mpre"> </span><a name="loc_21_12_21_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_12_21_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_21_14_21_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_14_21_18&#39;)"><span class="hl_vardecl"><span class="mpre">undo</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><a href="#loc_26_5_26_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_5_26_11&#39;)"><span class="hl_varref"><span class="mpre">isSame</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 20, srcSpanEndLine = 22, srcSpanEndColumn = 72}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 25, srcSpanEndLine = 22, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskel"><span class="mpre">Undo {pastUndo = toSave:pastUndo undo,futureRedo=[]}</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_21_14_21_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_14_21_18&#39;)"><span class="hl_varref"><span class="mpre">undo</span></span></a><span class="mpre">
  where
    </span><a name="loc_25_5_25_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_11&#39;)"><span class="hl_vardecl"><span class="mpre">toSave</span></span></a><span class="mpre"> = </span><a href="System.Console.Haskeline.LineState.html#loc_155_5_155_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Haskeline.LineState.html#loc_155_5_155_9&#39;)"><span class="hl_varref"><span class="mpre">save</span></span></a><span class="mpre"> </span><a href="#loc_21_12_21_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_12_21_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><a name="loc_26_5_26_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_5_26_11&#39;)"><span class="hl_vardecl"><span class="mpre">isSame</span></span></a><span class="mpre"> = case </span><a href="#loc_9_19_9_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_19_9_27&#39;)"><span class="hl_varref"><span class="mpre">pastUndo</span></span></a><span class="mpre"> </span><a href="#loc_21_14_21_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_14_21_18&#39;)"><span class="hl_varref"><span class="mpre">undo</span></span></a><span class="mpre"> of
                </span><a name="loc_27_17_27_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_17_27_18&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_ | </span><a href="#loc_27_17_27_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_17_27_18&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_25_5_25_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_11&#39;)"><span class="hl_varref"><span class="mpre">toSave</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                _ -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><a href="#loc_31_1_31_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_9&#39;)"><span class="mpre">undoPast</span></a><span class="mpre">, </span><a href="#loc_35_1_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_11&#39;)"><span class="mpre">redoFuture</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 25, srcSpanEndLine = 30, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 32, srcSpanEndLine = 30, srcSpanEndColumn = 34}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilena"><span class="mpre">Save s =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><a href="#loc_9_6_9_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_6_9_10&#39;)"><span class="hl_tyconref"><span class="mpre">Undo</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">,</span><a href="#loc_9_6_9_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_6_9_10&#39;)"><span class="hl_tyconref"><span class="mpre">Undo</span></span></a><span class="mpre">)
</span><a name="loc_31_1_31_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_9&#39;)"><span class="hl_fundecl"><span class="mpre">undoPast</span></span></a><span class="mpre"> </span><a name="loc_31_10_31_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_10_31_12&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> </span><a name="loc_31_13_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_13_31_14&#39;)"><span class="hl_specname"><span class="mpre">u</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 15, srcSpanEndLine = 31, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 20, srcSpanEndLine = 31, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0"><span class="mpre">Undo {pastUndo = []}</span></span><span class="mpre"> = (</span><a href="#loc_31_10_31_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_10_31_12&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">,</span><a href="#loc_31_13_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_13_31_14&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">)
</span><a href="#loc_31_1_31_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_9&#39;)"><span class="hl_fundecl"><span class="mpre">undoPast</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ls</span></span><span class="mpre"> </span><span class="hl_specname"><span class="mpre">u</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 15, srcSpanEndLine = 32, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 20, srcSpanEndLine = 32, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0"><span class="mpre">Undo {pastUndo = (pastLS:lss)}</span></span><span class="mpre">
        = (</span><a href="System.Console.Haskeline.LineState.html#loc_156_5_156_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Haskeline.LineState.html#loc_156_5_156_12&#39;)"><span class="hl_varref"><span class="mpre">restore</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">pastLS</span></span><span class="mpre">, </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 28, srcSpanEndLine = 33, srcSpanEndColumn = 83}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 30, srcSpanEndLine = 33, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskel"><span class="mpre">u {pastUndo = lss, futureRedo = save ls : futureRedo u}</span></span><span class="mpre">)

</span><a name="loc_35_1_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_11&#39;)"><span class="hl_fundecl"><span class="mpre">redoFuture</span></span></a><span class="mpre"> </span><a name="loc_35_12_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_12_35_14&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> </span><a name="loc_35_15_35_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_15_35_16&#39;)"><span class="hl_specname"><span class="mpre">u</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 17, srcSpanEndLine = 35, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 22, srcSpanEndLine = 35, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0"><span class="mpre">Undo {futureRedo = []}</span></span><span class="mpre"> = (</span><a href="#loc_35_12_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_12_35_14&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">,</span><a href="#loc_35_15_35_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_15_35_16&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">)
</span><a href="#loc_35_1_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_11&#39;)"><span class="hl_fundecl"><span class="mpre">redoFuture</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ls</span></span><span class="mpre"> </span><span class="hl_specname"><span class="mpre">u</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 17, srcSpanEndLine = 36, srcSpanEndColumn = 51}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 22, srcSpanEndLine = 36, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0"><span class="mpre">Undo {futureRedo = (futureLS:lss)}</span></span><span class="mpre">
            = (</span><a href="System.Console.Haskeline.LineState.html#loc_156_5_156_12" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Haskeline.LineState.html#loc_156_5_156_12&#39;)"><span class="hl_varref"><span class="mpre">restore</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">futureLS</span></span><span class="mpre">, </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 34, srcSpanEndLine = 37, srcSpanEndColumn = 87}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 37, srcSpanStartColumn = 36, srcSpanEndLine = 37, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskel"><span class="mpre">u {futureRedo = lss, pastUndo = save ls : pastUndo u}</span></span><span class="mpre">)



</span><a href="#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="mpre">saveForUndo</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 16, srcSpanEndLine = 42, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 16, srcSpanEndLine = 41, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskelin"><span class="mpre">(Save s, MonadState Undo m)
                =&gt;</span></span><span class="mpre">Â </span><span class="hl_tyconref"><span class="mpre">Command</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_43_1_43_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_12&#39;)"><span class="hl_fundecl"><span class="mpre">saveForUndo</span></span></a><span class="mpre"> </span><a name="loc_43_13_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_13_43_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = do
    </span><a href="System.Console.Haskeline.Monads.html#loc_59_1_59_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Haskeline.Monads.html#loc_59_1_59_7&#39;)"><span class="hl_varref"><span class="mpre">modify</span></span></a><span class="mpre"> (</span><a href="#loc_21_1_21_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_11&#39;)"><span class="hl_varref"><span class="mpre">saveToUndo</span></span></a><span class="mpre"> </span><a href="#loc_43_13_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_13_43_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_43_13_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_13_43_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><a href="#loc_48_1_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_12&#39;)"><span class="mpre">commandUndo</span></a><span class="mpre">, </span><a href="#loc_49_1_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_12&#39;)"><span class="mpre">commandRedo</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 29, srcSpanEndLine = 47, srcSpanEndColumn = 59}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskeline-0.7.1.2/System/Console/Haskeline/Command/Undo.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 29, srcSpanEndLine = 47, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/haskelin"><span class="mpre">(MonadState Undo m, Save s) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Command</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_48_1_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_12&#39;)"><span class="hl_vardecl"><span class="mpre">commandUndo</span></span></a><span class="mpre"> = </span><a href="System.Console.Haskeline.Command.html#loc_146_1_146_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Haskeline.Command.html#loc_146_1_146_14&#39;)"><span class="hl_varref"><span class="mpre">simpleCommand</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="System.Console.Haskeline.Monads.html#loc_62_1_62_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Haskeline.Monads.html#loc_62_1_62_7&#39;)"><span class="hl_varref"><span class="mpre">update</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_31_1_31_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_9&#39;)"><span class="hl_varref"><span class="mpre">undoPast</span></span></a><span class="mpre">
</span><a name="loc_49_1_49_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_12&#39;)"><span class="hl_vardecl"><span class="mpre">commandRedo</span></span></a><span class="mpre"> = </span><a href="System.Console.Haskeline.Command.html#loc_146_1_146_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Haskeline.Command.html#loc_146_1_146_14&#39;)"><span class="hl_varref"><span class="mpre">simpleCommand</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="System.Console.Haskeline.Monads.html#loc_62_1_62_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Console.Haskeline.Monads.html#loc_62_1_62_7&#39;)"><span class="hl_varref"><span class="mpre">update</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_35_1_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_11&#39;)"><span class="hl_varref"><span class="mpre">redoFuture</span></span></a><span class="mpre">

</span></div></body></html>