<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.PubKey.DSA</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Good</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- An implementation of the Digital Signature Algorithm (DSA)</span></span><span class="mpre">

module Crypto.PubKey.DSA
    ( Params(..)
    , Signature(..)
    , PublicKey(..)
    , PrivateKey(..)
    </span><span class="hl_comment"><span class="mpre">-- * generation</span></span><span class="mpre">
    , generatePrivate
    , calculatePublic
    </span><span class="hl_comment"><span class="mpre">-- * signature primitive</span></span><span class="mpre">
    , sign
    , signWith
    </span><span class="hl_comment"><span class="mpre">-- * verification primitive</span></span><span class="mpre">
    , verify
    ) where

import Crypto.Random
import Data.Maybe
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/DSA.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 8, srcSpanEndLine = 27, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import Crypto.Number.ModArithmetic (</span><a href="Crypto.Number.ModArithmetic.html#loc_76_1_76_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_76_1_76_8&#39;)"><span class="mpre">expFast</span></a><span class="mpre">, </span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="mpre">expSafe</span></a><span class="mpre">, </span><a href="Crypto.Number.ModArithmetic.html#loc_126_1_126_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_126_1_126_8&#39;)"><span class="mpre">inverse</span></a><span class="mpre">)
import Crypto.Number.Serialize
import Crypto.Number.Generate
import Crypto.Types.PubKey.DSA
import Crypto.PubKey.HashDescr

</span><span class="hl_comment"><span class="mpre">-- | generate a private number with no specific property</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- this number is usually called X in DSA text.</span></span><span class="mpre">
</span><a href="#loc_37_1_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_16&#39;)"><span class="mpre">generatePrivate</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/DSA.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 20, srcSpanEndLine = 36, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/DSA.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 27, srcSpanEndLine = 36, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cryp"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.DSA.html#loc_34_6_34_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_34_6_34_12&#39;)"><span class="hl_tyconref"><span class="mpre">Params</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">PrivateNumber</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_37_1_37_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_16&#39;)"><span class="hl_fundecl"><span class="mpre">generatePrivate</span></span></a><span class="mpre"> </span><a name="loc_37_17_37_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_17_37_20&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Params</span></span><span class="mpre"> _ _ </span><a name="loc_37_33_37_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_33_37_34&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">) = </span><a href="Crypto.Number.Generate.html#loc_24_1_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Generate.html#loc_24_1_24_12&#39;)"><span class="hl_varref"><span class="mpre">generateMax</span></span></a><span class="mpre"> </span><a href="#loc_37_17_37_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_17_37_20&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a href="#loc_37_33_37_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_33_37_34&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Calculate the public number from the parameters and the private key</span></span><span class="mpre">
</span><a href="#loc_41_1_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_16&#39;)"><span class="mpre">calculatePublic</span></a><span class="mpre"> :: </span><a href="Crypto.Types.PubKey.DSA.html#loc_34_6_34_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_34_6_34_12&#39;)"><span class="hl_tyconref"><span class="mpre">Params</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PrivateNumber</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">PublicNumber</span></span><span class="mpre">
</span><a name="loc_41_1_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_16&#39;)"><span class="hl_fundecl"><span class="mpre">calculatePublic</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Params</span></span><span class="mpre"> </span><a name="loc_41_25_41_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_25_41_26&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_41_27_41_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_27_41_28&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> _) </span><a name="loc_41_32_41_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_32_41_33&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="hl_varref"><span class="mpre">expSafe</span></span></a><span class="mpre"> </span><a href="#loc_41_27_41_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_27_41_28&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_41_32_41_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_32_41_33&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_41_25_41_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_25_41_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | sign message using the private key and an explicit k number.</span></span><span class="mpre">
</span><a href="#loc_49_1_49_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_9&#39;)"><span class="mpre">signWith</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ k random number</span></span><span class="mpre">
         -&gt; </span><a href="Crypto.Types.PubKey.DSA.html#loc_95_6_95_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_95_6_95_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ private key</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">HashFunction</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ hash function</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^ message to sign</span></span><span class="mpre">
         -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><a href="Crypto.Types.PubKey.DSA.html#loc_52_6_52_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_52_6_52_15&#39;)"><span class="hl_tyconref"><span class="mpre">Signature</span></span></a><span class="mpre">
</span><a name="loc_49_1_49_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_9&#39;)"><span class="hl_fundecl"><span class="mpre">signWith</span></span></a><span class="mpre"> </span><a name="loc_49_10_49_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_10_49_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_49_12_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_12_49_14&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_49_15_49_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_19&#39;)"><span class="hl_vardecl"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a name="loc_49_20_49_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_20_49_23&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre">
    | </span><a href="#loc_58_11_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_11_58_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_59_11_59_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_11_59_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Signature</span></span><span class="mpre"> </span><a href="#loc_58_11_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_11_58_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_59_11_59_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_11_59_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    where </span><span class="hl_comment"><span class="mpre">-- parameters</span></span><span class="mpre">
          (</span><span class="hl_conref"><span class="mpre">Params</span></span><span class="mpre"> </span><a name="loc_53_19_53_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_19_53_20&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_53_21_53_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_21_53_22&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_53_23_53_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_23_53_24&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">) = </span><a href="Crypto.Types.PubKey.DSA.html#loc_96_7_96_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_96_7_96_21&#39;)"><span class="hl_varref"><span class="mpre">private_params</span></span></a><span class="mpre"> </span><a href="#loc_49_12_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_12_49_14&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">
          </span><a name="loc_54_11_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_11_54_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">         = </span><a href="Crypto.Types.PubKey.DSA.html#loc_97_7_97_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_97_7_97_16&#39;)"><span class="hl_varref"><span class="mpre">private_x</span></span></a><span class="mpre"> </span><a href="#loc_49_12_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_12_49_14&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- compute r,s</span></span><span class="mpre">
          </span><a name="loc_56_11_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_11_56_15&#39;)"><span class="hl_vardecl"><span class="mpre">kInv</span></span></a><span class="mpre">      = </span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Number.ModArithmetic.html#loc_126_1_126_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_126_1_126_8&#39;)"><span class="hl_varref"><span class="mpre">inverse</span></span></a><span class="mpre"> </span><a href="#loc_49_10_49_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_10_49_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_53_23_53_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_23_53_24&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
          </span><a name="loc_57_11_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_11_57_13&#39;)"><span class="hl_vardecl"><span class="mpre">hm</span></span></a><span class="mpre">        = </span><a href="Crypto.Number.Serialize.html#loc_49_1_49_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_49_1_49_6&#39;)"><span class="hl_varref"><span class="mpre">os2ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_49_15_49_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_15_49_19&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_49_20_49_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_20_49_23&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
          </span><a name="loc_58_11_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_11_58_12&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">         = </span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="hl_varref"><span class="mpre">expSafe</span></span></a><span class="mpre"> </span><a href="#loc_53_21_53_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_21_53_22&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_49_10_49_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_10_49_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_53_19_53_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_19_53_20&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_53_23_53_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_23_53_24&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
          </span><a name="loc_59_11_59_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_11_59_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">         = (</span><a href="#loc_56_11_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_11_56_15&#39;)"><span class="hl_varref"><span class="mpre">kInv</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_57_11_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_11_57_13&#39;)"><span class="hl_varref"><span class="mpre">hm</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_54_11_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_11_54_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_58_11_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_11_58_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_53_23_53_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_23_53_24&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | sign message using the private key.</span></span><span class="mpre">
</span><a href="#loc_63_1_63_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_5&#39;)"><span class="mpre">sign</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/DSA.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 9, srcSpanEndLine = 62, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/DSA.hs&quot;, srcSpanStartLine = 62, srcSpanStartColumn = 16, srcSpanEndLine = 62, srcSpanEndColumn = 18}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypt"><span class="mpre">CPRG g =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.DSA.html#loc_95_6_95_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_95_6_95_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">HashFunction</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; (</span><a href="Crypto.Types.PubKey.DSA.html#loc_52_6_52_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_52_6_52_15&#39;)"><span class="hl_tyconref"><span class="mpre">Signature</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">g</span></span><span class="mpre">)
</span><a name="loc_63_1_63_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_5&#39;)"><span class="hl_fundecl"><span class="mpre">sign</span></span></a><span class="mpre"> </span><a name="loc_63_6_63_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_6_63_9&#39;)"><span class="hl_vardecl"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a name="loc_63_10_63_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_10_63_12&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_63_13_63_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_13_63_17&#39;)"><span class="hl_vardecl"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a name="loc_63_18_63_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_18_63_21&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
    case </span><a href="#loc_49_1_49_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_9&#39;)"><span class="hl_varref"><span class="mpre">signWith</span></span></a><span class="mpre"> </span><a href="#loc_68_12_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_12_68_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_63_10_63_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_10_63_12&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a href="#loc_63_13_63_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_13_63_17&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_63_18_63_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_18_63_21&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> of
        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">  -&gt; </span><a href="#loc_63_1_63_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_5&#39;)"><span class="hl_varref"><span class="mpre">sign</span></span></a><span class="mpre"> </span><a href="#loc_68_15_68_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_15_68_19&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre"> </span><a href="#loc_63_10_63_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_10_63_12&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a href="#loc_63_13_63_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_13_63_17&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_63_18_63_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_18_63_21&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_66_14_66_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_14_66_17&#39;)"><span class="hl_vardecl"><span class="mpre">sig</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_66_14_66_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_14_66_17&#39;)"><span class="hl_varref"><span class="mpre">sig</span></span></a><span class="mpre">, </span><a href="#loc_68_15_68_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_15_68_19&#39;)"><span class="hl_varref"><span class="mpre">rng&#39;</span></span></a><span class="mpre">)
    where (</span><span class="hl_conref"><span class="mpre">Params</span></span><span class="mpre"> _ _ </span><a name="loc_67_23_67_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_23_67_24&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">) = </span><a href="Crypto.Types.PubKey.DSA.html#loc_96_7_96_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_96_7_96_21&#39;)"><span class="hl_varref"><span class="mpre">private_params</span></span></a><span class="mpre"> </span><a href="#loc_63_10_63_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_10_63_12&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">
          (</span><a name="loc_68_12_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_12_68_13&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre">, </span><a name="loc_68_15_68_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_15_68_19&#39;)"><span class="hl_vardecl"><span class="mpre">rng&#39;</span></span></a><span class="mpre">) = </span><a href="Crypto.Number.Generate.html#loc_24_1_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Generate.html#loc_24_1_24_12&#39;)"><span class="hl_varref"><span class="mpre">generateMax</span></span></a><span class="mpre"> </span><a href="#loc_63_6_63_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_6_63_9&#39;)"><span class="hl_varref"><span class="mpre">rng</span></span></a><span class="mpre"> </span><a href="#loc_67_23_67_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_23_67_24&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | verify a bytestring using the public key.</span></span><span class="mpre">
</span><a href="#loc_72_1_72_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_7&#39;)"><span class="mpre">verify</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HashFunction</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.DSA.html#loc_68_6_68_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_68_6_68_15&#39;)"><span class="hl_tyconref"><span class="mpre">PublicKey</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.DSA.html#loc_52_6_52_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_52_6_52_15&#39;)"><span class="hl_tyconref"><span class="mpre">Signature</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_72_1_72_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_7&#39;)"><span class="hl_fundecl"><span class="mpre">verify</span></span></a><span class="mpre"> </span><a name="loc_72_8_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_8_72_12&#39;)"><span class="hl_vardecl"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a name="loc_72_13_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_13_72_15&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Signature</span></span><span class="mpre"> </span><a name="loc_72_27_72_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_27_72_28&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_72_29_72_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_29_72_30&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) </span><a name="loc_72_32_72_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_32_72_33&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- Reject the signature if either 0 &lt; r &lt; q or 0 &lt; s &lt; q is not satisfied.</span></span><span class="mpre">
    | </span><a href="#loc_72_27_72_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_27_72_28&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_72_27_72_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_27_72_28&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_76_23_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_23_76_24&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_72_29_72_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_29_72_30&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_72_29_72_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_29_72_30&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_76_23_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_23_76_24&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                            = </span><a href="#loc_83_11_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_11_83_12&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_72_27_72_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_27_72_28&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
    where (</span><span class="hl_conref"><span class="mpre">Params</span></span><span class="mpre"> </span><a name="loc_76_19_76_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_19_76_20&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_76_21_76_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_21_76_22&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_76_23_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_23_76_24&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">) = </span><a href="Crypto.Types.PubKey.DSA.html#loc_69_7_69_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_69_7_69_20&#39;)"><span class="hl_varref"><span class="mpre">public_params</span></span></a><span class="mpre"> </span><a href="#loc_72_13_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_13_72_15&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">
          </span><a name="loc_77_11_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_11_77_12&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">       = </span><a href="Crypto.Types.PubKey.DSA.html#loc_70_7_70_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.DSA.html#loc_70_7_70_15&#39;)"><span class="hl_varref"><span class="mpre">public_y</span></span></a><span class="mpre"> </span><a href="#loc_72_13_72_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_13_72_15&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">
          </span><a name="loc_78_11_78_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_13&#39;)"><span class="hl_vardecl"><span class="mpre">hm</span></span></a><span class="mpre">      = </span><a href="Crypto.Number.Serialize.html#loc_49_1_49_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_49_1_49_6&#39;)"><span class="hl_varref"><span class="mpre">os2ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_72_8_72_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_8_72_12&#39;)"><span class="hl_varref"><span class="mpre">hash</span></span></a><span class="mpre"> </span><a href="#loc_72_32_72_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_32_72_33&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

          </span><a name="loc_80_11_80_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_11_80_12&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">       = </span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Number.ModArithmetic.html#loc_126_1_126_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_126_1_126_8&#39;)"><span class="hl_varref"><span class="mpre">inverse</span></span></a><span class="mpre"> </span><a href="#loc_72_29_72_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_29_72_30&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_76_23_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_23_76_24&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
          </span><a name="loc_81_11_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_11_81_13&#39;)"><span class="hl_vardecl"><span class="mpre">u1</span></span></a><span class="mpre">      = (</span><a href="#loc_78_11_78_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_13&#39;)"><span class="hl_varref"><span class="mpre">hm</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_80_11_80_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_11_80_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_76_23_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_23_76_24&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
          </span><a name="loc_82_11_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_11_82_13&#39;)"><span class="hl_vardecl"><span class="mpre">u2</span></span></a><span class="mpre">      = (</span><a href="#loc_72_27_72_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_27_72_28&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_80_11_80_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_11_80_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_76_23_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_23_76_24&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
          </span><a name="loc_83_11_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_11_83_12&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">       = ((</span><a href="Crypto.Number.ModArithmetic.html#loc_76_1_76_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_76_1_76_8&#39;)"><span class="hl_varref"><span class="mpre">expFast</span></span></a><span class="mpre"> </span><a href="#loc_76_21_76_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_21_76_22&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_81_11_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_11_81_13&#39;)"><span class="hl_varref"><span class="mpre">u1</span></span></a><span class="mpre"> </span><a href="#loc_76_19_76_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_19_76_20&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="Crypto.Number.ModArithmetic.html#loc_76_1_76_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_76_1_76_8&#39;)"><span class="hl_varref"><span class="mpre">expFast</span></span></a><span class="mpre"> </span><a href="#loc_77_11_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_11_77_12&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_82_11_82_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_11_82_13&#39;)"><span class="hl_varref"><span class="mpre">u2</span></span></a><span class="mpre"> </span><a href="#loc_76_19_76_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_19_76_20&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_76_19_76_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_19_76_20&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_76_23_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_23_76_24&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
</span></div></body></html>