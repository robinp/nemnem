<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns, OverloadedStrings #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : LazyByteString</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) 2010 Simon Meier</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD3-style (see LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Simon Meier &lt;iridcode@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : tested on GHC only</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Benchmarking of alternative implementations of functions in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Data.ByteString.Lazy that construct lazy bytestrings and cannot be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- implemented with slicing only.</span></span><span class="mpre">
module LazyByteString where </span><span class="hl_comment"><span class="mpre">-- (main)  where</span></span><span class="mpre">

import Data.Char
import Data.Word
import Data.Monoid 
import Data.List 

import Control.Monad
import Control.Arrow (</span><a href="Control.Arrow.html#loc_96_5_96_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_96_5_96_11&#39;)"><span class="mpre">second</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 8, srcSpanEndLine = 23, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Criterion.Main&quot;"><span class="mpre">Criterion.Main</span></span><span class="mpre">

import Foreign 
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 18, srcSpanEndLine = 26, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">               as S
import qualified Data.ByteString.Unsafe        as S
import qualified Data.ByteString.Internal      as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 18, srcSpanEndLine = 29, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre">          as L
import qualified Data.ByteString.Lazy.Internal as L

import Data.ByteString.Base64

import Blaze.ByteString.Builder.Internal
import Blaze.ByteString.Builder.Word
import Blaze.ByteString.Builder.ByteString

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Benchmarks</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_43_1_43_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_5&#39;)"><span class="mpre">main</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_43_1_43_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_5&#39;)"><span class="hl_vardecl"><span class="mpre">main</span></span></a><span class="mpre"> = do
    let (</span><a name="loc_44_10_44_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_10_44_20&#39;)"><span class="hl_vardecl"><span class="mpre">chunkInfos</span></span></a><span class="mpre">, </span><a name="loc_44_22_44_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_22_44_32&#39;)"><span class="hl_vardecl"><span class="mpre">benchmarks</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">unzip</span></span><span class="mpre"> 
          </span><span class="hl_comment"><span class="mpre">{-
          [ lazyVsBlaze
              ( &quot;partitionLazy&quot;
              , (uncurry mappend) . L.partition ((0 &lt;) . sin . fromIntegral)
              , (uncurry mappend) . partitionLazy ((0 &lt;) . sin . fromIntegral)
              , (\i -&gt; L.drop 13 $ L.pack $ take i $ cycle [0..])
              , n)
          -}</span></span><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">{-
          [ lazyVsBlaze
              ( &quot;base64mime&quot;
              , L.fromChunks . return . joinWith &quot;\r\n&quot; 76 . encode
              , toLazyByteString . encodeBase64MIME
              , (\i -&gt; S.drop 13 $ S.pack $ take i $ cycle [0..])
              , n)
          -}</span></span><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">{-
          [ lazyVsBlaze
              ( &quot;joinWith&quot;
              , L.fromChunks . return . joinWith &quot;\r\n&quot; 76
              , toLazyByteString . intersperseBlocks 76 &quot;\r\n&quot;
              , (\i -&gt; S.drop 13 $ S.pack $ take i $ cycle [0..])
              , n)
          -}</span></span><span class="mpre">
          [ </span><a href="#loc_117_1_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_12&#39;)"><span class="hl_varref"><span class="mpre">lazyVsBlaze</span></span></a><span class="mpre">
              ( </span><span class="hl_string"><span class="mpre">&quot;base64&quot;</span></span><span class="mpre">
              , </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.ByteString.Base64.html#loc_34_1_34_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Base64.html#loc_34_1_34_7&#39;)"><span class="hl_varref"><span class="mpre">encode</span></span></a><span class="mpre">
              , </span><a href="Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17&#39;)"><span class="hl_varref"><span class="mpre">toLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_500_1_500_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_13&#39;)"><span class="hl_varref"><span class="mpre">encodeBase64</span></span></a><span class="mpre">
              , (\</span><a name="loc_73_19_73_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_19_73_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_73_19_73_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_19_73_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">cycle</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 73, srcSpanStartColumn = 60, srcSpanEndLine = 73, srcSpanEndColumn = 65}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 73, srcSpanStartColumn = 60, srcSpanEndLine = 73, srcSpanEndColumn = 61},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/b"><span class="mpre">[0..]</span></span><span class="mpre">)
              , </span><a href="#loc_113_5_113_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_6&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
          </span><span class="hl_comment"><span class="mpre">{-
          , lazyVsBlaze
              ( &quot;copy&quot;
              , L.copy
              , copyBlaze
              , (\i -&gt; L.drop 13 $ L.take (fromIntegral i) $ L.fromChunks $ repeat $ S.pack [0..])
              , n)
          , lazyVsBlaze
              ( &quot;filter ((==0) . (`mod` 3))&quot;
              , L.filter ((==0) . (`mod` 3))
              , filterBlaze ((==0) . (`mod` 3))
              , (\i -&gt; L.drop 13 $ L.pack $ take i $ cycle [0..])
              , n)
          , lazyVsBlaze
              ( &quot;map (+1)&quot;
              , L.map (+1)
              , mapBlaze (+1)
              , (\i -&gt; L.drop 13 $ L.pack $ take i $ cycle [0..])
              , n)
          , lazyVsBlaze
              ( &quot;concatMap (replicate 10)&quot;
              , L.concatMap (L.replicate 10)
              , toLazyByteString . concatMapBuilder (fromReplicateWord8 10)
              , (\i -&gt; L.pack $ take i $ cycle [0..])
              , n `div` 10 )
          , lazyVsBlaze 
              ( &quot;unfoldr countToZero&quot;
              , L.unfoldr    countToZero
              , unfoldrBlaze countToZero
              , id
              , n )
          -}</span></span><span class="mpre">
          ]
    </span><a href="Control.Monad.html#loc_106_1_106_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_106_1_106_10&#39;)"><span class="hl_varref"><span class="mpre">sequence_</span></span></a><span class="mpre"> (</span><a href="Data.List.html#loc_427_1_427_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_427_1_427_12&#39;)"><span class="hl_varref"><span class="mpre">intersperse</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">) </span><a href="#loc_44_10_44_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_10_44_20&#39;)"><span class="hl_varref"><span class="mpre">chunkInfos</span></span></a><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">defaultMain</span></span><span class="mpre"> </span><a href="#loc_44_22_44_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_22_44_32&#39;)"><span class="hl_varref"><span class="mpre">benchmarks</span></span></a><span class="mpre">
  where
    </span><a href="#loc_113_5_113_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_6&#39;)"><span class="mpre">n</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    </span><a name="loc_113_5_113_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_6&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">100000</span></span><span class="mpre">

</span><a href="#loc_117_1_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_12&#39;)"><span class="mpre">lazyVsBlaze</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
        -&gt; (</span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Benchmark</span></span><span class="mpre">)
</span><a name="loc_117_1_117_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_12&#39;)"><span class="hl_fundecl"><span class="mpre">lazyVsBlaze</span></span></a><span class="mpre"> (</span><a name="loc_117_14_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_14_117_21&#39;)"><span class="hl_vardecl"><span class="mpre">cmpName</span></span></a><span class="mpre">, </span><a name="loc_117_23_117_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_23_117_27&#39;)"><span class="hl_vardecl"><span class="mpre">lazy</span></span></a><span class="mpre">, </span><a name="loc_117_29_117_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_29_117_34&#39;)"><span class="hl_vardecl"><span class="mpre">blaze</span></span></a><span class="mpre">, </span><a name="loc_117_36_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_36_117_40&#39;)"><span class="hl_vardecl"><span class="mpre">prep</span></span></a><span class="mpre">, </span><a name="loc_117_42_117_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_42_117_43&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) =
    ( do </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_117_14_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_14_117_21&#39;)"><span class="hl_varref"><span class="mpre">cmpName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_132_5_132_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_5_132_17&#39;)"><span class="hl_varref"><span class="mpre">checkResults</span></span></a><span class="mpre">
         </span><a href="#loc_139_5_139_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_5_139_18&#39;)"><span class="hl_varref"><span class="mpre">showChunksize</span></span></a><span class="mpre"> </span><a href="#loc_127_5_127_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_5_127_13&#39;)"><span class="hl_varref"><span class="mpre">implLazy</span></span></a><span class="mpre">  </span><a href="#loc_117_23_117_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_23_117_27&#39;)"><span class="hl_varref"><span class="mpre">lazy</span></span></a><span class="mpre">
         </span><a href="#loc_139_5_139_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_5_139_18&#39;)"><span class="hl_varref"><span class="mpre">showChunksize</span></span></a><span class="mpre"> </span><a href="#loc_128_5_128_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_5_128_14&#39;)"><span class="hl_varref"><span class="mpre">implBlaze</span></span></a><span class="mpre"> </span><a href="#loc_117_29_117_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_29_117_34&#39;)"><span class="hl_varref"><span class="mpre">blaze</span></span></a><span class="mpre">
    , </span><span class="hl_varref"><span class="mpre">bgroup</span></span><span class="mpre"> </span><a href="#loc_117_14_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_14_117_21&#39;)"><span class="hl_varref"><span class="mpre">cmpName</span></span></a><span class="mpre"> 
        [ </span><a href="#loc_147_5_147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_12&#39;)"><span class="hl_varref"><span class="mpre">mkBench</span></span></a><span class="mpre"> </span><a href="#loc_128_5_128_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_5_128_14&#39;)"><span class="hl_varref"><span class="mpre">implBlaze</span></span></a><span class="mpre"> </span><a href="#loc_117_29_117_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_29_117_34&#39;)"><span class="hl_varref"><span class="mpre">blaze</span></span></a><span class="mpre">
        , </span><a href="#loc_147_5_147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_12&#39;)"><span class="hl_varref"><span class="mpre">mkBench</span></span></a><span class="mpre"> </span><a href="#loc_127_5_127_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_5_127_13&#39;)"><span class="hl_varref"><span class="mpre">implLazy</span></span></a><span class="mpre">  </span><a href="#loc_117_23_117_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_23_117_27&#39;)"><span class="hl_varref"><span class="mpre">lazy</span></span></a><span class="mpre">
        ]
    )
  where
    </span><a name="loc_127_5_127_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_5_127_13&#39;)"><span class="hl_vardecl"><span class="mpre">implLazy</span></span></a><span class="mpre">  = </span><span class="hl_string"><span class="mpre">&quot;bytestring&quot;</span></span><span class="mpre">
    </span><a name="loc_128_5_128_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_5_128_14&#39;)"><span class="hl_vardecl"><span class="mpre">implBlaze</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;blaze-builder&quot;</span></span><span class="mpre">
    </span><a name="loc_129_5_129_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_5_129_6&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_117_36_117_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_36_117_40&#39;)"><span class="hl_varref"><span class="mpre">prep</span></span></a><span class="mpre"> </span><a href="#loc_117_42_117_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_42_117_43&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

    </span><a name="loc_131_5_131_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_10&#39;)"><span class="hl_vardecl"><span class="mpre">nInfo</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;for n = &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_117_42_117_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_42_117_43&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    </span><a name="loc_132_5_132_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_5_132_17&#39;)"><span class="hl_vardecl"><span class="mpre">checkResults</span></span></a><span class="mpre"> 
      | </span><a href="#loc_117_23_117_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_23_117_27&#39;)"><span class="hl_varref"><span class="mpre">lazy</span></span></a><span class="mpre"> </span><a href="#loc_129_5_129_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_5_129_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_117_29_117_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_29_117_34&#39;)"><span class="hl_varref"><span class="mpre">blaze</span></span></a><span class="mpre"> </span><a href="#loc_129_5_129_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_5_129_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;implementations agree &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_131_5_131_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_10&#39;)"><span class="hl_varref"><span class="mpre">nInfo</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         = </span><a href="Data.List.html#loc_1060_1_1060_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1060_1_1060_8&#39;)"><span class="hl_varref"><span class="mpre">unlines</span></span></a><span class="mpre"> [ </span><span class="hl_string"><span class="mpre">&quot;ERROR: IMPLEMENTATIONS DISAGREE &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_131_5_131_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_5_131_10&#39;)"><span class="hl_varref"><span class="mpre">nInfo</span></span></a><span class="mpre">
                                    , </span><a href="#loc_127_5_127_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_5_127_13&#39;)"><span class="hl_varref"><span class="mpre">implLazy</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_117_23_117_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_23_117_27&#39;)"><span class="hl_varref"><span class="mpre">lazy</span></span></a><span class="mpre"> </span><a href="#loc_129_5_129_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_5_129_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
                                    , </span><a href="#loc_128_5_128_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_5_128_14&#39;)"><span class="hl_varref"><span class="mpre">implBlaze</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_117_29_117_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_29_117_34&#39;)"><span class="hl_varref"><span class="mpre">blaze</span></span></a><span class="mpre"> </span><a href="#loc_129_5_129_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_5_129_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
                                    ]

    </span><a name="loc_139_5_139_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_5_139_18&#39;)"><span class="hl_fundecl"><span class="mpre">showChunksize</span></span></a><span class="mpre"> </span><a name="loc_139_19_139_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_19_139_27&#39;)"><span class="hl_vardecl"><span class="mpre">implName</span></span></a><span class="mpre"> </span><a name="loc_139_28_139_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_28_139_32&#39;)"><span class="hl_vardecl"><span class="mpre">impl</span></span></a><span class="mpre"> = do
      let </span><a name="loc_140_11_140_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_11_140_13&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="#loc_139_28_139_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_28_139_32&#39;)"><span class="hl_varref"><span class="mpre">impl</span></span></a><span class="mpre"> </span><a href="#loc_129_5_129_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_5_129_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
          </span><a name="loc_141_11_141_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_11_141_13&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_140_11_140_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_11_140_13&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;  &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_139_19_139_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_19_139_27&#39;)"><span class="hl_varref"><span class="mpre">implName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: &quot;</span></span><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;    chunks sizes:    &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_141_11_141_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_11_141_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;    avg. chunk size: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> 
        </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> ((</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="Data.List.html#loc_1025_1_1025_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1025_1_1025_4&#39;)"><span class="hl_varref"><span class="mpre">sum</span></span></a><span class="mpre"> </span><a href="#loc_141_11_141_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_11_141_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_141_11_141_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_11_141_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">))

    </span><a name="loc_147_5_147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_12&#39;)"><span class="hl_fundecl"><span class="mpre">mkBench</span></span></a><span class="mpre"> </span><a name="loc_147_13_147_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_13_147_21&#39;)"><span class="hl_vardecl"><span class="mpre">implName</span></span></a><span class="mpre"> </span><a name="loc_147_22_147_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_22_147_26&#39;)"><span class="hl_vardecl"><span class="mpre">impl</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> </span><a href="#loc_147_13_147_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_13_147_21&#39;)"><span class="hl_varref"><span class="mpre">implName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">whnf</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_147_22_147_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_22_147_26&#39;)"><span class="hl_varref"><span class="mpre">impl</span></span></a><span class="mpre">) </span><a href="#loc_129_5_129_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_5_129_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Alternative implementations</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Unfolding</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
-- | /O(n)/ The &#39;unfoldr&#39; function is analogous to the List \&#39;unfoldr\&#39;.
-- &#39;unfoldr&#39; builds a ByteString from a seed value.  The function takes
-- the element and returns &#39;Nothing&#39; if it is done producing the
-- ByteString or returns &#39;Just&#39; @(a,b)@, in which case, @a@ is a
-- prepending to the ByteString and @b@ is used as the next element in a
-- recursive call.
unfoldr :: (a -&gt; Maybe (Word8, a)) -&gt; a -&gt; ByteString
unfoldr f s0 = unfoldChunk 32 s0
  where unfoldChunk n s =
          case S.unfoldrN n f s of
            (c, Nothing)
              | S.null c  -&gt; Empty
              | otherwise -&gt; Chunk c Empty
            (c, Just s&#39;)  -&gt; Chunk c (unfoldChunk (n*2) s&#39;)
-}</span></span><span class="mpre">

</span><a href="#loc_175_1_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_12&#39;)"><span class="mpre">countToZero</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_175_1_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_12&#39;)"><span class="hl_fundecl"><span class="mpre">countToZero</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><a href="#loc_175_1_175_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_12&#39;)"><span class="hl_fundecl"><span class="mpre">countToZero</span></span></a><span class="mpre"> </span><a name="loc_176_13_176_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_13_176_14&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_176_13_176_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_13_176_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">, </span><a href="#loc_176_13_176_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_13_176_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

</span><a href="#loc_179_1_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_13&#39;)"><span class="mpre">unfoldrBlaze</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">
</span><a name="loc_179_1_179_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_13&#39;)"><span class="hl_fundecl"><span class="mpre">unfoldrBlaze</span></span></a><span class="mpre"> </span><a name="loc_179_14_179_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_14_179_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_179_16_179_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_16_179_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17&#39;)"><span class="hl_varref"><span class="mpre">toLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_182_1_182_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_17&#39;)"><span class="hl_varref"><span class="mpre">fromWriteUnfoldr</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Word.html#loc_117_1_117_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Word.html#loc_117_1_117_11&#39;)"><span class="hl_varref"><span class="mpre">writeWord8</span></span></a><span class="mpre"> </span><a href="#loc_179_14_179_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_14_179_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_179_16_179_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_16_179_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_182_1_182_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_17&#39;)"><span class="mpre">fromWriteUnfoldr</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_182_1_182_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_17&#39;)"><span class="hl_fundecl"><span class="mpre">fromWriteUnfoldr</span></span></a><span class="mpre"> </span><a name="loc_182_18_182_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_18_182_23&#39;)"><span class="hl_vardecl"><span class="mpre">write</span></span></a><span class="mpre"> = 
    </span><a href="#loc_185_5_185_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_5_185_16&#39;)"><span class="hl_varref"><span class="mpre">makeBuilder</span></span></a><span class="mpre">
  where
    </span><a name="loc_185_5_185_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_5_185_16&#39;)"><span class="hl_fundecl"><span class="mpre">makeBuilder</span></span></a><span class="mpre"> </span><a name="loc_185_17_185_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_17_185_18&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_185_19_185_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_19_185_21&#39;)"><span class="hl_vardecl"><span class="mpre">x0</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_124_1_124_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_124_1_124_18&#39;)"><span class="hl_varref"><span class="mpre">fromBuildStepCont</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_187_9_187_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_13&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_185_19_185_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_19_185_21&#39;)"><span class="hl_varref"><span class="mpre">x0</span></span></a><span class="mpre">
      where
        </span><a name="loc_187_9_187_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_9_187_13&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> </span><a name="loc_187_14_187_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_14_187_16&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> !</span><a name="loc_187_18_187_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_18_187_19&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_189_13_189_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_13_189_17&#39;)"><span class="hl_varref"><span class="mpre">fill</span></span></a><span class="mpre"> </span><a href="#loc_187_14_187_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_14_187_16&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">
          where
            </span><a name="loc_189_13_189_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_13_189_17&#39;)"><span class="hl_fundecl"><span class="mpre">fill</span></span></a><span class="mpre"> </span><a name="loc_189_18_189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_18_189_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> !(</span><span class="hl_conref"><span class="mpre">BufRange</span></span><span class="mpre"> </span><a name="loc_189_31_189_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_31_189_34&#39;)"><span class="hl_vardecl"><span class="mpre">pf0</span></span></a><span class="mpre"> </span><a name="loc_189_35_189_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_35_189_38&#39;)"><span class="hl_vardecl"><span class="mpre">pe0</span></span></a><span class="mpre">) = </span><a href="#loc_191_17_191_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_17_191_19&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_185_17_185_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_17_185_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_189_18_189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_18_189_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_189_31_189_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_31_189_34&#39;)"><span class="hl_varref"><span class="mpre">pf0</span></span></a><span class="mpre">
              where
                </span><a name="loc_191_17_191_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_17_191_19&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">        !</span><a name="loc_191_37_191_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_37_191_39&#39;)"><span class="hl_vardecl"><span class="mpre">pf</span></span></a><span class="mpre"> = do
                    let !</span><a name="loc_192_26_192_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_26_192_29&#39;)"><span class="hl_vardecl"><span class="mpre">br&#39;</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">BufRange</span></span><span class="mpre"> </span><a href="#loc_191_37_191_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_37_191_39&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><a href="#loc_189_35_189_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_35_189_38&#39;)"><span class="hl_varref"><span class="mpre">pe0</span></span></a><span class="mpre">
                    </span><a href="#loc_187_18_187_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_18_187_19&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_192_26_192_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_26_192_29&#39;)"><span class="hl_varref"><span class="mpre">br&#39;</span></span></a><span class="mpre">
                </span><a href="#loc_191_17_191_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_17_191_19&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !(</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_194_28_194_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_28_194_29&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">, </span><a name="loc_194_31_194_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_31_194_33&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre">)) !</span><a name="loc_194_37_194_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_37_194_39&#39;)"><span class="hl_vardecl"><span class="mpre">pf</span></span></a><span class="mpre">
                  | </span><a href="#loc_194_37_194_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_37_194_39&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_203_21_203_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_21_203_26&#39;)"><span class="hl_varref"><span class="mpre">bound</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_189_35_189_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_35_189_38&#39;)"><span class="hl_varref"><span class="mpre">pe0</span></span></a><span class="mpre"> = do
                      !</span><a name="loc_196_24_196_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_24_196_27&#39;)"><span class="hl_vardecl"><span class="mpre">pf&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_108_1_108_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_108_1_108_9&#39;)"><span class="hl_varref"><span class="mpre">runWrite</span></span></a><span class="mpre"> (</span><a href="#loc_182_18_182_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_18_182_23&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_194_28_194_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_28_194_29&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><a href="#loc_194_37_194_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_37_194_39&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre">
                      </span><a href="#loc_191_17_191_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_17_191_19&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_185_17_185_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_17_185_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_194_31_194_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_31_194_33&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre">) </span><a href="#loc_196_24_196_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_24_196_27&#39;)"><span class="hl_varref"><span class="mpre">pf&#39;</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11&#39;)"><span class="hl_varref"><span class="mpre">bufferFull</span></span></a><span class="mpre"> </span><a href="#loc_203_21_203_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_21_203_26&#39;)"><span class="hl_varref"><span class="mpre">bound</span></span></a><span class="mpre"> </span><a href="#loc_194_37_194_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_37_194_39&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> 
                      \(</span><span class="hl_conref"><span class="mpre">BufRange</span></span><span class="mpre"> </span><a name="loc_199_34_199_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_34_199_39&#39;)"><span class="hl_vardecl"><span class="mpre">pfNew</span></span></a><span class="mpre"> </span><a name="loc_199_40_199_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_40_199_45&#39;)"><span class="hl_vardecl"><span class="mpre">peNew</span></span></a><span class="mpre">) -&gt; do 
                          !</span><a name="loc_200_28_200_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_28_200_34&#39;)"><span class="hl_vardecl"><span class="mpre">pfNew&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_108_1_108_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_108_1_108_9&#39;)"><span class="hl_varref"><span class="mpre">runWrite</span></span></a><span class="mpre"> (</span><a href="#loc_182_18_182_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_18_182_23&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_194_28_194_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_28_194_29&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><a href="#loc_199_34_199_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_34_199_39&#39;)"><span class="hl_varref"><span class="mpre">pfNew</span></span></a><span class="mpre">
                          </span><a href="#loc_189_13_189_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_13_189_17&#39;)"><span class="hl_varref"><span class="mpre">fill</span></span></a><span class="mpre"> </span><a href="#loc_194_31_194_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_31_194_33&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">BufRange</span></span><span class="mpre"> </span><a href="#loc_200_28_200_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_28_200_34&#39;)"><span class="hl_varref"><span class="mpre">pfNew&#39;</span></span></a><span class="mpre"> </span><a href="#loc_199_40_199_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_40_199_45&#39;)"><span class="hl_varref"><span class="mpre">peNew</span></span></a><span class="mpre">)
                  where
                    </span><a name="loc_203_21_203_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_21_203_26&#39;)"><span class="hl_vardecl"><span class="mpre">bound</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_113_1_113_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_113_1_113_9&#39;)"><span class="hl_varref"><span class="mpre">getBound</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_182_18_182_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_18_182_23&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_194_28_194_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_28_194_29&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_182_1_182_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_17&#39;)"><span class="mpre">fromWriteUnfoldr</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Filtering and mapping</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------</span></span><span class="mpre">

</span><a href="#loc_210_1_210_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_5&#39;)"><span class="mpre">test</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">, </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">)
</span><a name="loc_210_1_210_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_5&#39;)"><span class="hl_fundecl"><span class="mpre">test</span></span></a><span class="mpre"> </span><a name="loc_210_6_210_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_6_210_7&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = 
    ((</span><span class="hl_varref"><span class="mpre">L.filter</span></span><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_214_5_214_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_5_214_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) ,
     (</span><a href="#loc_217_1_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_12&#39;)"><span class="hl_varref"><span class="mpre">filterBlaze</span></span></a><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_214_5_214_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_5_214_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">))
  where
    </span><a name="loc_214_5_214_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_5_214_6&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_210_6_210_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_6_210_7&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">cycle</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 214, srcSpanStartColumn = 33, srcSpanEndLine = 214, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 214, srcSpanStartColumn = 33, srcSpanEndLine = 214, srcSpanEndColumn = 34},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3"><span class="mpre">[0..]</span></span><span class="mpre">

</span><a href="#loc_217_1_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_12&#39;)"><span class="mpre">filterBlaze</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">
</span><a name="loc_217_1_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_12&#39;)"><span class="hl_fundecl"><span class="mpre">filterBlaze</span></span></a><span class="mpre"> </span><a name="loc_217_13_217_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_13_217_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17&#39;)"><span class="hl_varref"><span class="mpre">toLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_229_1_229_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_21&#39;)"><span class="hl_varref"><span class="mpre">filterLazyByteString</span></span></a><span class="mpre"> </span><a href="#loc_217_13_217_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_13_217_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_217_1_217_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_12&#39;)"><span class="mpre">filterBlaze</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_221_1_221_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_9&#39;)"><span class="mpre">mapBlaze</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">) -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">
</span><a name="loc_221_1_221_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_9&#39;)"><span class="hl_fundecl"><span class="mpre">mapBlaze</span></span></a><span class="mpre"> </span><a name="loc_221_10_221_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_10_221_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17&#39;)"><span class="hl_varref"><span class="mpre">toLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_237_1_237_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_1_237_18&#39;)"><span class="hl_varref"><span class="mpre">mapLazyByteString</span></span></a><span class="mpre"> </span><a href="#loc_221_10_221_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_10_221_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_221_1_221_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_1_221_9&#39;)"><span class="mpre">mapBlaze</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_225_1_225_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_1_225_17&#39;)"><span class="mpre">filterByteString</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_225_1_225_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_1_225_17&#39;)"><span class="hl_fundecl"><span class="mpre">filterByteString</span></span></a><span class="mpre"> </span><a name="loc_225_18_225_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_18_225_19&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_242_1_242_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_23&#39;)"><span class="hl_varref"><span class="mpre">mapFilterMapByteString</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_225_18_225_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_18_225_19&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_225_1_225_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_1_225_17&#39;)"><span class="mpre">filterByteString</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_229_1_229_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_21&#39;)"><span class="mpre">filterLazyByteString</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_229_1_229_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_21&#39;)"><span class="hl_fundecl"><span class="mpre">filterLazyByteString</span></span></a><span class="mpre"> </span><a name="loc_229_22_229_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_22_229_23&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_272_1_272_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_1_272_27&#39;)"><span class="hl_varref"><span class="mpre">mapFilterMapLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_229_22_229_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_22_229_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_229_1_229_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_21&#39;)"><span class="mpre">filterLazyByteString</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_233_1_233_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_14&#39;)"><span class="mpre">mapByteString</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">) -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_233_1_233_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_14&#39;)"><span class="hl_fundecl"><span class="mpre">mapByteString</span></span></a><span class="mpre"> </span><a name="loc_233_15_233_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_15_233_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_242_1_242_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_23&#39;)"><span class="hl_varref"><span class="mpre">mapFilterMapByteString</span></span></a><span class="mpre"> </span><a href="#loc_233_15_233_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_15_233_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_233_1_233_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_1_233_14&#39;)"><span class="mpre">mapByteString</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_237_1_237_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_1_237_18&#39;)"><span class="mpre">mapLazyByteString</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">) -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_237_1_237_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_1_237_18&#39;)"><span class="hl_fundecl"><span class="mpre">mapLazyByteString</span></span></a><span class="mpre"> </span><a name="loc_237_19_237_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_19_237_20&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_272_1_272_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_1_272_27&#39;)"><span class="hl_varref"><span class="mpre">mapFilterMapLazyByteString</span></span></a><span class="mpre"> </span><a href="#loc_237_19_237_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_19_237_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_237_1_237_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_1_237_18&#39;)"><span class="mpre">mapLazyByteString</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_242_1_242_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_23&#39;)"><span class="mpre">mapFilterMapByteString</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">) 
                       -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_242_1_242_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_23&#39;)"><span class="hl_fundecl"><span class="mpre">mapFilterMapByteString</span></span></a><span class="mpre"> </span><a name="loc_242_24_242_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_24_242_25&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_242_26_242_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_26_242_27&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_242_28_242_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_28_242_29&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = 
    \</span><a name="loc_243_6_243_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_6_243_8&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_124_1_124_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_124_1_124_18&#39;)"><span class="hl_varref"><span class="mpre">fromBuildStepCont</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_245_5_245_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_5_245_9&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_243_6_243_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_6_243_8&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
  where
    </span><a name="loc_245_5_245_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_5_245_9&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">S.PS</span></span></a><span class="mpre"> </span><a name="loc_245_16_245_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_16_245_19&#39;)"><span class="hl_vardecl"><span class="mpre">ifp</span></span></a><span class="mpre"> </span><a name="loc_245_20_245_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_20_245_24&#39;)"><span class="hl_vardecl"><span class="mpre">ioff</span></span></a><span class="mpre"> </span><a name="loc_245_25_245_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_25_245_30&#39;)"><span class="hl_vardecl"><span class="mpre">isize</span></span></a><span class="mpre">) !</span><a name="loc_245_33_245_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_33_245_34&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = 
        </span><a href="#loc_249_9_249_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_9_249_13&#39;)"><span class="hl_varref"><span class="mpre">goBS</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">unsafeForeignPtrToPtr</span></span><span class="mpre"> </span><a href="#loc_245_16_245_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_16_245_19&#39;)"><span class="hl_varref"><span class="mpre">ifp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_245_20_245_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_20_245_24&#39;)"><span class="hl_varref"><span class="mpre">ioff</span></span></a><span class="mpre">)
      where
        !</span><a name="loc_248_10_248_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_10_248_13&#39;)"><span class="hl_vardecl"><span class="mpre">ipe</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeForeignPtrToPtr</span></span><span class="mpre"> </span><a href="#loc_245_16_245_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_16_245_19&#39;)"><span class="hl_varref"><span class="mpre">ifp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_245_20_245_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_20_245_24&#39;)"><span class="hl_varref"><span class="mpre">ioff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_245_25_245_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_25_245_30&#39;)"><span class="hl_varref"><span class="mpre">isize</span></span></a><span class="mpre">)
        </span><a name="loc_249_9_249_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_9_249_13&#39;)"><span class="hl_fundecl"><span class="mpre">goBS</span></span></a><span class="mpre"> !</span><a name="loc_249_15_249_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_15_249_18&#39;)"><span class="hl_vardecl"><span class="mpre">ip0</span></span></a><span class="mpre"> !</span><a name="loc_249_20_249_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_20_249_22&#39;)"><span class="hl_specname"><span class="mpre">br</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">BufRange</span></span><span class="mpre"> </span><a name="loc_249_33_249_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_33_249_36&#39;)"><span class="hl_vardecl"><span class="mpre">op0</span></span></a><span class="mpre"> </span><a name="loc_249_37_249_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_37_249_40&#39;)"><span class="hl_vardecl"><span class="mpre">ope</span></span></a><span class="mpre">)
          | </span><a href="#loc_249_15_249_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_15_249_18&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_248_10_248_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_10_248_13&#39;)"><span class="hl_varref"><span class="mpre">ipe</span></span></a><span class="mpre"> = do </span><span class="hl_varref"><span class="mpre">touchForeignPtr</span></span><span class="mpre"> </span><a href="#loc_245_16_245_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_16_245_19&#39;)"><span class="hl_varref"><span class="mpre">ifp</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- input buffer consumed</span></span><span class="mpre">
                            </span><a href="#loc_245_33_245_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_33_245_34&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_249_20_249_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_20_249_22&#39;)"><span class="hl_varref"><span class="mpre">br</span></span></a><span class="mpre">
          | </span><a href="#loc_249_33_249_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_33_249_36&#39;)"><span class="hl_varref"><span class="mpre">op0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_249_37_249_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_37_249_40&#39;)"><span class="hl_varref"><span class="mpre">ope</span></span></a><span class="mpre">  = </span><a href="#loc_257_13_257_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_13_257_22&#39;)"><span class="hl_varref"><span class="mpre">goPartial</span></span></a><span class="mpre"> (</span><a href="#loc_249_15_249_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_15_249_18&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> </span><a href="#loc_255_13_255_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_13_255_25&#39;)"><span class="hl_varref"><span class="mpre">outRemaining</span></span></a><span class="mpre"> </span><a href="#loc_256_13_256_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_13_256_25&#39;)"><span class="hl_varref"><span class="mpre">inpRemaining</span></span></a><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11&#39;)"><span class="hl_varref"><span class="mpre">bufferFull</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_249_33_249_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_33_249_36&#39;)"><span class="hl_varref"><span class="mpre">op0</span></span></a><span class="mpre"> (</span><a href="#loc_249_9_249_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_9_249_13&#39;)"><span class="hl_varref"><span class="mpre">goBS</span></span></a><span class="mpre"> </span><a href="#loc_249_15_249_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_15_249_18&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre">) 
          where
            </span><a name="loc_255_13_255_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_255_13_255_25&#39;)"><span class="hl_vardecl"><span class="mpre">outRemaining</span></span></a><span class="mpre"> = </span><a href="#loc_249_37_249_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_37_249_40&#39;)"><span class="hl_varref"><span class="mpre">ope</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_249_33_249_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_33_249_36&#39;)"><span class="hl_varref"><span class="mpre">op0</span></span></a><span class="mpre">
            </span><a name="loc_256_13_256_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_13_256_25&#39;)"><span class="hl_vardecl"><span class="mpre">inpRemaining</span></span></a><span class="mpre"> = </span><a href="#loc_248_10_248_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_10_248_13&#39;)"><span class="hl_varref"><span class="mpre">ipe</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_249_15_249_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_15_249_18&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre">
            </span><a name="loc_257_13_257_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_13_257_22&#39;)"><span class="hl_fundecl"><span class="mpre">goPartial</span></span></a><span class="mpre"> !</span><a name="loc_257_24_257_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_24_257_30&#39;)"><span class="hl_vardecl"><span class="mpre">ipeTmp</span></span></a><span class="mpre"> = </span><a href="#loc_259_17_259_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_17_259_19&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_249_15_249_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_15_249_18&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre"> </span><a href="#loc_249_33_249_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_33_249_36&#39;)"><span class="hl_varref"><span class="mpre">op0</span></span></a><span class="mpre">
              where
                </span><a name="loc_259_17_259_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_17_259_19&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_259_21_259_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_21_259_23&#39;)"><span class="hl_vardecl"><span class="mpre">ip</span></span></a><span class="mpre"> !</span><a name="loc_259_25_259_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_25_259_27&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre">
                  | </span><a href="#loc_259_21_259_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_21_259_23&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_257_24_257_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_24_257_30&#39;)"><span class="hl_varref"><span class="mpre">ipeTmp</span></span></a><span class="mpre"> = do
                      </span><a name="loc_261_23_261_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_23_261_24&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><a href="#loc_259_21_259_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_21_259_23&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre">
                      let </span><a name="loc_262_27_262_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_27_262_29&#39;)"><span class="hl_vardecl"><span class="mpre">w&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_242_28_242_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_28_242_29&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_261_23_261_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_23_261_24&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">
                      if </span><a href="#loc_242_26_242_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_26_242_27&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_262_27_262_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_27_262_29&#39;)"><span class="hl_varref"><span class="mpre">w&#39;</span></span></a><span class="mpre">
                        then </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_259_25_259_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_25_259_27&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> (</span><a href="#loc_242_24_242_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_24_242_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_262_27_262_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_27_262_29&#39;)"><span class="hl_varref"><span class="mpre">w&#39;</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_259_17_259_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_17_259_19&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_259_21_259_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_21_259_23&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_259_25_259_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_25_259_27&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                        else                   </span><a href="#loc_259_17_259_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_17_259_19&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_259_21_259_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_21_259_23&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_259_25_259_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_25_259_27&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
                      </span><a href="#loc_249_9_249_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_9_249_13&#39;)"><span class="hl_varref"><span class="mpre">goBS</span></span></a><span class="mpre"> </span><a href="#loc_259_21_259_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_21_259_23&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">BufRange</span></span><span class="mpre"> </span><a href="#loc_259_25_259_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_25_259_27&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><a href="#loc_249_37_249_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_37_249_40&#39;)"><span class="hl_varref"><span class="mpre">ope</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_242_1_242_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_23&#39;)"><span class="mpre">mapFilterMapByteString</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_272_1_272_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_1_272_27&#39;)"><span class="mpre">mapFilterMapLazyByteString</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">) 
                           -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_272_1_272_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_1_272_27&#39;)"><span class="hl_fundecl"><span class="mpre">mapFilterMapLazyByteString</span></span></a><span class="mpre"> </span><a name="loc_272_28_272_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_28_272_29&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_272_30_272_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_30_272_31&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_272_32_272_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_32_272_33&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = 
    </span><a href="Data.ByteString.Lazy.Internal.html#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">L.foldrChunks</span></span></a><span class="mpre"> (\</span><a name="loc_273_21_273_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_21_273_22&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_273_23_273_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_23_273_24&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_242_1_242_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_23&#39;)"><span class="hl_varref"><span class="mpre">mapFilterMapByteString</span></span></a><span class="mpre"> </span><a href="#loc_272_28_272_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_28_272_29&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_272_30_272_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_30_272_31&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_272_32_272_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_32_272_33&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_273_21_273_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_21_273_22&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_273_23_273_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_23_273_24&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_272_1_272_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_1_272_27&#39;)"><span class="mpre">mapFilterMapLazyByteString</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Concatenation and replication</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
-- | Map a function over a &#39;ByteString&#39; and concatenate the results
concatMap :: (Word8 -&gt; ByteString) -&gt; ByteString -&gt; ByteString
concatMap _ Empty        = Empty
concatMap f (Chunk c0 cs0) = to c0 cs0
  where
    go :: ByteString -&gt; P.ByteString -&gt; ByteString -&gt; ByteString
    go Empty        c&#39; cs&#39; = to c&#39; cs&#39;
    go (Chunk c cs) c&#39; cs&#39; = Chunk c (go cs c&#39; cs&#39;)

    to :: P.ByteString -&gt; ByteString -&gt; ByteString
    to c cs | S.null c  = case cs of
        Empty          -&gt; Empty
        (Chunk c&#39; cs&#39;) -&gt; to c&#39; cs&#39;
            | otherwise = go (f (S.unsafeHead c)) (S.unsafeTail c) cs
-}</span></span><span class="mpre">

</span><a href="#loc_298_1_298_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_1_298_20&#39;)"><span class="mpre">fromWriteReplicated</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_298_1_298_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_1_298_20&#39;)"><span class="hl_fundecl"><span class="mpre">fromWriteReplicated</span></span></a><span class="mpre"> </span><a name="loc_298_21_298_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_21_298_26&#39;)"><span class="hl_vardecl"><span class="mpre">write</span></span></a><span class="mpre"> = 
    </span><a href="#loc_301_5_301_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_5_301_16&#39;)"><span class="hl_varref"><span class="mpre">makeBuilder</span></span></a><span class="mpre">
  where
    </span><a name="loc_301_5_301_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_5_301_16&#39;)"><span class="hl_fundecl"><span class="mpre">makeBuilder</span></span></a><span class="mpre"> !</span><a name="loc_301_18_301_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_18_301_20&#39;)"><span class="hl_vardecl"><span class="mpre">n0</span></span></a><span class="mpre"> </span><a name="loc_301_21_301_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_21_301_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_124_1_124_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_124_1_124_18&#39;)"><span class="hl_varref"><span class="mpre">fromBuildStepCont</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_304_9_304_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_9_304_13&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> 
      where
        </span><a name="loc_303_9_303_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_9_303_14&#39;)"><span class="hl_vardecl"><span class="mpre">bound</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_113_1_113_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_113_1_113_9&#39;)"><span class="hl_varref"><span class="mpre">getBound</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_298_21_298_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_21_298_26&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_301_21_301_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_21_301_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a name="loc_304_9_304_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_9_304_13&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> !</span><a name="loc_304_15_304_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_15_304_16&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_306_13_306_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_13_306_17&#39;)"><span class="hl_varref"><span class="mpre">fill</span></span></a><span class="mpre"> </span><a href="#loc_301_18_301_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_18_301_20&#39;)"><span class="hl_varref"><span class="mpre">n0</span></span></a><span class="mpre">
          where
            </span><a name="loc_306_13_306_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_13_306_17&#39;)"><span class="hl_fundecl"><span class="mpre">fill</span></span></a><span class="mpre"> !</span><a name="loc_306_19_306_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_19_306_21&#39;)"><span class="hl_vardecl"><span class="mpre">n1</span></span></a><span class="mpre"> !(</span><span class="hl_conref"><span class="mpre">BufRange</span></span><span class="mpre"> </span><a name="loc_306_33_306_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_33_306_36&#39;)"><span class="hl_vardecl"><span class="mpre">pf0</span></span></a><span class="mpre"> </span><a name="loc_306_37_306_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_37_306_40&#39;)"><span class="hl_vardecl"><span class="mpre">pe0</span></span></a><span class="mpre">) = </span><a href="#loc_308_17_308_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_17_308_19&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_306_19_306_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_19_306_21&#39;)"><span class="hl_varref"><span class="mpre">n1</span></span></a><span class="mpre"> </span><a href="#loc_306_33_306_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_33_306_36&#39;)"><span class="hl_varref"><span class="mpre">pf0</span></span></a><span class="mpre">
              where
                </span><a name="loc_308_17_308_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_17_308_19&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> !</span><a name="loc_308_23_308_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_23_308_25&#39;)"><span class="hl_vardecl"><span class="mpre">pf</span></span></a><span class="mpre"> = do
                    let !</span><a name="loc_309_26_309_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_26_309_29&#39;)"><span class="hl_vardecl"><span class="mpre">br&#39;</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">BufRange</span></span><span class="mpre"> </span><a href="#loc_308_23_308_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_23_308_25&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><a href="#loc_306_37_306_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_37_306_40&#39;)"><span class="hl_varref"><span class="mpre">pe0</span></span></a><span class="mpre">
                    </span><a href="#loc_304_15_304_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_15_304_16&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_309_26_309_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_26_309_29&#39;)"><span class="hl_varref"><span class="mpre">br&#39;</span></span></a><span class="mpre">
                </span><a href="#loc_308_17_308_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_17_308_19&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_311_20_311_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_20_311_21&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> !</span><a name="loc_311_23_311_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_23_311_25&#39;)"><span class="hl_vardecl"><span class="mpre">pf</span></span></a><span class="mpre">
                  | </span><a href="#loc_311_23_311_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_23_311_25&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_303_9_303_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_9_303_14&#39;)"><span class="hl_varref"><span class="mpre">bound</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_306_37_306_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_37_306_40&#39;)"><span class="hl_varref"><span class="mpre">pe0</span></span></a><span class="mpre"> = do
                      </span><a name="loc_313_23_313_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_23_313_26&#39;)"><span class="hl_vardecl"><span class="mpre">pf&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_108_1_108_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_108_1_108_9&#39;)"><span class="hl_varref"><span class="mpre">runWrite</span></span></a><span class="mpre"> (</span><a href="#loc_298_21_298_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_21_298_26&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_301_21_301_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_21_301_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_311_23_311_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_23_311_25&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre">
                      </span><a href="#loc_308_17_308_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_17_308_19&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_311_20_311_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_20_311_21&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_313_23_313_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_23_313_26&#39;)"><span class="hl_varref"><span class="mpre">pf&#39;</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11&#39;)"><span class="hl_varref"><span class="mpre">bufferFull</span></span></a><span class="mpre"> </span><a href="#loc_303_9_303_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_9_303_14&#39;)"><span class="hl_varref"><span class="mpre">bound</span></span></a><span class="mpre"> </span><a href="#loc_311_23_311_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_23_311_25&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> 
                      \(</span><span class="hl_conref"><span class="mpre">BufRange</span></span><span class="mpre"> </span><a name="loc_316_34_316_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_34_316_39&#39;)"><span class="hl_vardecl"><span class="mpre">pfNew</span></span></a><span class="mpre"> </span><a name="loc_316_40_316_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_40_316_45&#39;)"><span class="hl_vardecl"><span class="mpre">peNew</span></span></a><span class="mpre">) -&gt; do 
                          </span><a name="loc_317_27_317_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_27_317_33&#39;)"><span class="hl_vardecl"><span class="mpre">pfNew&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_108_1_108_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_108_1_108_9&#39;)"><span class="hl_varref"><span class="mpre">runWrite</span></span></a><span class="mpre"> (</span><a href="#loc_298_21_298_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_21_298_26&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_301_21_301_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_21_301_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_316_34_316_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_34_316_39&#39;)"><span class="hl_varref"><span class="mpre">pfNew</span></span></a><span class="mpre">
                          </span><a href="#loc_306_13_306_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_306_13_306_17&#39;)"><span class="hl_varref"><span class="mpre">fill</span></span></a><span class="mpre"> (</span><a href="#loc_311_20_311_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_20_311_21&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">BufRange</span></span><span class="mpre"> </span><a href="#loc_317_27_317_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_317_27_317_33&#39;)"><span class="hl_varref"><span class="mpre">pfNew&#39;</span></span></a><span class="mpre"> </span><a href="#loc_316_40_316_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_40_316_45&#39;)"><span class="hl_varref"><span class="mpre">peNew</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_298_1_298_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_1_298_20&#39;)"><span class="mpre">fromWriteReplicated</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- FIXME: Output repeated bytestrings for large replications.</span></span><span class="mpre">
</span><a href="#loc_323_1_323_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_1_323_19&#39;)"><span class="mpre">fromReplicateWord8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_323_1_323_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_1_323_19&#39;)"><span class="hl_fundecl"><span class="mpre">fromReplicateWord8</span></span></a><span class="mpre"> !</span><a name="loc_323_21_323_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_21_323_23&#39;)"><span class="hl_vardecl"><span class="mpre">n0</span></span></a><span class="mpre"> </span><a name="loc_323_24_323_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_24_323_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = 
    </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_124_1_124_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_124_1_124_18&#39;)"><span class="hl_varref"><span class="mpre">fromBuildStepCont</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_326_5_326_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_5_326_9&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre">
  where
    </span><a name="loc_326_5_326_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_5_326_9&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> !</span><a name="loc_326_11_326_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_11_326_12&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_328_9_328_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_9_328_13&#39;)"><span class="hl_varref"><span class="mpre">fill</span></span></a><span class="mpre"> </span><a href="#loc_323_21_323_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_21_323_23&#39;)"><span class="hl_varref"><span class="mpre">n0</span></span></a><span class="mpre">
      where
        </span><a name="loc_328_9_328_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_9_328_13&#39;)"><span class="hl_fundecl"><span class="mpre">fill</span></span></a><span class="mpre"> !</span><a name="loc_328_15_328_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_15_328_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> !</span><a name="loc_328_18_328_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_18_328_20&#39;)"><span class="hl_specname"><span class="mpre">br</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">BufRange</span></span><span class="mpre"> </span><a name="loc_328_31_328_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_31_328_33&#39;)"><span class="hl_vardecl"><span class="mpre">pf</span></span></a><span class="mpre"> </span><a name="loc_328_34_328_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_34_328_36&#39;)"><span class="hl_vardecl"><span class="mpre">pe</span></span></a><span class="mpre">)
          | </span><a href="#loc_328_15_328_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_15_328_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">    = </span><a href="#loc_326_11_326_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_11_326_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_328_18_328_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_18_328_20&#39;)"><span class="hl_varref"><span class="mpre">br</span></span></a><span class="mpre">
          | </span><a href="#loc_339_13_339_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_13_339_16&#39;)"><span class="hl_varref"><span class="mpre">pf&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_328_34_328_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_34_328_36&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre"> = do
              _ &lt;- </span><a href="Data.ByteString.Internal.html#loc_639_1_639_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_639_1_639_7&#39;)"><span class="hl_varref"><span class="mpre">S.memset</span></span></a><span class="mpre"> </span><a href="#loc_328_31_328_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_31_328_33&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><a href="#loc_323_24_323_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_24_323_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_328_15_328_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_15_328_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- FIXME: This conversion looses information for 64 bit systems.</span></span><span class="mpre">
              let !</span><a name="loc_332_20_332_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_20_332_23&#39;)"><span class="hl_vardecl"><span class="mpre">br&#39;</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">BufRange</span></span><span class="mpre"> </span><a href="#loc_339_13_339_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_13_339_16&#39;)"><span class="hl_varref"><span class="mpre">pf&#39;</span></span></a><span class="mpre"> </span><a href="#loc_328_34_328_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_34_328_36&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre">
              </span><a href="#loc_326_11_326_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_11_326_12&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_332_20_332_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_20_332_23&#39;)"><span class="hl_varref"><span class="mpre">br&#39;</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = do
              let !</span><a name="loc_335_20_335_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_20_335_21&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_328_34_328_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_34_328_36&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_328_31_328_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_31_328_33&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre">
              _ &lt;- </span><a href="Data.ByteString.Internal.html#loc_639_1_639_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_639_1_639_7&#39;)"><span class="hl_varref"><span class="mpre">S.memset</span></span></a><span class="mpre"> </span><a href="#loc_328_31_328_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_31_328_33&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><a href="#loc_323_24_323_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_24_323_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_335_20_335_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_20_335_21&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- FIXME: This conversion looses information for 64 bit systems.</span></span><span class="mpre">
              </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11&#39;)"><span class="hl_varref"><span class="mpre">bufferFull</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_328_34_328_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_34_328_36&#39;)"><span class="hl_varref"><span class="mpre">pe</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_328_9_328_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_9_328_13&#39;)"><span class="hl_varref"><span class="mpre">fill</span></span></a><span class="mpre"> (</span><a href="#loc_328_15_328_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_15_328_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_335_20_335_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_20_335_21&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
          where
            </span><a name="loc_339_13_339_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_13_339_16&#39;)"><span class="hl_vardecl"><span class="mpre">pf&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_328_31_328_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_31_328_33&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_328_15_328_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_15_328_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_323_1_323_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_1_323_19&#39;)"><span class="mpre">fromReplicateWord8</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_pragma"><span class="mpre">{-# RULES &quot;fromWriteReplicated/writeWord8&quot;
      fromWriteReplicated writeWord8 = fromReplicateWord8
 #-}</span></span><span class="mpre">


</span><a href="#loc_349_1_349_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_17&#39;)"><span class="mpre">concatMapBuilder</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">) -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_349_1_349_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_17&#39;)"><span class="hl_fundecl"><span class="mpre">concatMapBuilder</span></span></a><span class="mpre"> </span><a name="loc_349_18_349_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_18_349_19&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.foldr</span></span><span class="mpre"> (\</span><a name="loc_349_32_349_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_32_349_33&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_349_34_349_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_34_349_35&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_349_18_349_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_18_349_19&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_349_32_349_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_32_349_33&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_349_34_349_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_34_349_35&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_349_1_349_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_17&#39;)"><span class="mpre">concatMapBuilder</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_353_1_353_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_15&#39;)"><span class="mpre">concatMapBlaze</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">) -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">
</span><a name="loc_353_1_353_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_1_353_15&#39;)"><span class="hl_fundecl"><span class="mpre">concatMapBlaze</span></span></a><span class="mpre"> </span><a name="loc_353_16_353_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_16_353_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17&#39;)"><span class="hl_varref"><span class="mpre">toLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_349_1_349_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_17&#39;)"><span class="hl_varref"><span class="mpre">concatMapBuilder</span></span></a><span class="mpre"> (</span><a href="Blaze.ByteString.Builder.ByteString.html#loc_185_1_185_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_185_1_185_19&#39;)"><span class="hl_varref"><span class="mpre">fromLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_353_16_353_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_16_353_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- Interspersing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- not sure if it Builder version is needed, as chunks get only bigger. We</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- would need it however, if we used a Builder to ensure latency guarantees; i.e.,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- if we use a builder to ensure a bound on the maximal size of chunks.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
-- | The &#39;intersperse&#39; function takes a &#39;Word8&#39; and a &#39;ByteString&#39; and
-- \`intersperses\&#39; that byte between the elements of the &#39;ByteString&#39;.
-- It is analogous to the intersperse function on Lists.
intersperse :: Word8 -&gt; ByteString -&gt; ByteString
intersperse _ Empty        = Empty
intersperse w (Chunk c cs) = Chunk (S.intersperse w c)
                                   (foldrChunks (Chunk . intersperse&#39;) Empty cs)
  where intersperse&#39; :: P.ByteString -&gt; P.ByteString
        intersperse&#39; (S.PS fp o l) =
          S.unsafeCreate (2*l) $ \p&#39; -&gt; withForeignPtr fp $ \p -&gt; do
            poke p&#39; w
            S.c_intersperse (p&#39; `plusPtr` 1) (p `plusPtr` o) (fromIntegral l) w
-}</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-
intersperseBlaze :: Word8         -- ^ Byte to intersperse.
                 -&gt; L.ByteString  -- ^ Lazy &#39;L.ByteString&#39; to be &quot;spread&quot;.
                 -&gt; Builder       -- ^ Resulting &#39;Builder&#39;.
intersperseBlaze w lbs0 = 
    Builder $ step lbs0
  where
    step lbs1 k = goChunk lbs1
      where
        goChunk L.Empty                         pf0 pe0 = k pf0 pe0
        goChunk (L.Chunk (S.PS fpi oi li) lbs&#39;) pf0 pe0 = do
            go
            touch
          where
            go 
              where
                !pf&#39; = pf `plusPtr` 
                
            
        goChunk !L.Empty                !pf = k pf pe0
        goChunk !lbs@(L.Chunk bs&#39; lbs&#39;) !pf
          | pf&#39; &lt;= pe0 = do
              withForeignPtr fpbuf $ \pbuf -&gt; 
                  copyBytes pf (pbuf `plusPtr` offset) size
              go lbs&#39; pf&#39;

          | otherwise  = return $ BufferFull size pf (step lbs k)
          where
            !pf&#39; = pf `plusPtr` 
            !(fpbuf, offset, size) = S.toForeignPtr bs&#39;
{-# INLINE intersperseBlaze #-}

-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Packing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------</span></span><span class="mpre">

</span><a href="#loc_418_1_418_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_1_418_10&#39;)"><span class="mpre">packBlaze</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">
</span><a name="loc_418_1_418_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_1_418_10&#39;)"><span class="hl_vardecl"><span class="mpre">packBlaze</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17&#39;)"><span class="hl_varref"><span class="mpre">toLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_249_1_249_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_249_1_249_14&#39;)"><span class="hl_varref"><span class="mpre">fromWriteList</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Word.html#loc_117_1_117_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Word.html#loc_117_1_117_11&#39;)"><span class="hl_varref"><span class="mpre">writeWord8</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Reverse</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Transpose</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- scanl, scanl1, scanr, scanr1</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- mapAccumL, mapAccumR</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- partition</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- unzip</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- copy</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-------</span></span><span class="mpre">

</span><a href="#loc_448_1_448_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_1_448_10&#39;)"><span class="mpre">copyBlaze</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">
</span><a name="loc_448_1_448_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_1_448_10&#39;)"><span class="hl_vardecl"><span class="mpre">copyBlaze</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17&#39;)"><span class="hl_varref"><span class="mpre">toLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_214_1_214_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_214_1_214_19&#39;)"><span class="hl_varref"><span class="mpre">copyLazyByteString</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- ?? packCString, packCStringLen</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">---------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- joinWith</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_458_1_458_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_1_458_18&#39;)"><span class="mpre">intersperseBlocks</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_458_1_458_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_1_458_18&#39;)"><span class="hl_fundecl"><span class="mpre">intersperseBlocks</span></span></a><span class="mpre"> </span><a name="loc_458_19_458_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_19_458_28&#39;)"><span class="hl_vardecl"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a name="loc_458_29_458_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_29_458_32&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">S.PS</span></span></a><span class="mpre"> </span><a name="loc_458_39_458_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_39_458_42&#39;)"><span class="hl_vardecl"><span class="mpre">ifp</span></span></a><span class="mpre"> </span><a name="loc_458_43_458_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_43_458_47&#39;)"><span class="hl_vardecl"><span class="mpre">ioff</span></span></a><span class="mpre"> </span><a name="loc_458_48_458_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_48_458_53&#39;)"><span class="hl_vardecl"><span class="mpre">isize</span></span></a><span class="mpre">) = 
    </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_140_1_140_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_140_1_140_8&#39;)"><span class="hl_varref"><span class="mpre">fromPut</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_460_9_460_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_9_460_15&#39;)"><span class="hl_vardecl"><span class="mpre">lastBS</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_465_5_465_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_5_465_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_463_5_463_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_463_5_463_8&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_458_43_458_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_43_458_47&#39;)"><span class="hl_varref"><span class="mpre">ioff</span></span></a><span class="mpre">) 
        </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_460_9_460_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_9_460_15&#39;)"><span class="hl_varref"><span class="mpre">lastBS</span></span></a><span class="mpre">) (</span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_135_1_135_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_135_1_135_11&#39;)"><span class="hl_varref"><span class="mpre">putBuilder</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_460_9_460_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_9_460_15&#39;)"><span class="hl_varref"><span class="mpre">lastBS</span></span></a><span class="mpre">)
  where
    </span><a name="loc_463_5_463_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_463_5_463_8&#39;)"><span class="hl_vardecl"><span class="mpre">ip0</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeForeignPtrToPtr</span></span><span class="mpre"> </span><a href="#loc_458_39_458_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_39_458_42&#39;)"><span class="hl_varref"><span class="mpre">ifp</span></span></a><span class="mpre">
    </span><a name="loc_464_5_464_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_5_464_8&#39;)"><span class="hl_vardecl"><span class="mpre">ipe</span></span></a><span class="mpre"> = </span><a href="#loc_463_5_463_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_463_5_463_8&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_458_43_458_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_43_458_47&#39;)"><span class="hl_varref"><span class="mpre">ioff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_458_48_458_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_48_458_53&#39;)"><span class="hl_varref"><span class="mpre">isize</span></span></a><span class="mpre">)
    </span><a name="loc_465_5_465_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_5_465_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_465_9_465_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_9_465_11&#39;)"><span class="hl_vardecl"><span class="mpre">ip</span></span></a><span class="mpre"> 
      | </span><a href="#loc_465_9_465_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_9_465_11&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_458_19_458_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_19_458_28&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_464_5_464_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_5_464_8&#39;)"><span class="hl_varref"><span class="mpre">ipe</span></span></a><span class="mpre"> =
          </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">S.PS</span></span></a><span class="mpre"> </span><a href="#loc_458_39_458_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_39_458_42&#39;)"><span class="hl_varref"><span class="mpre">ifp</span></span></a><span class="mpre"> (</span><a href="#loc_465_9_465_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_9_465_11&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_463_5_463_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_463_5_463_8&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre">) (</span><a href="#loc_464_5_464_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_5_464_8&#39;)"><span class="hl_varref"><span class="mpre">ipe</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_465_9_465_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_9_465_11&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre">)
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = do
          </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_135_1_135_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_135_1_135_11&#39;)"><span class="hl_varref"><span class="mpre">putBuilder</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">S.PS</span></span></a><span class="mpre"> </span><a href="#loc_458_39_458_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_39_458_42&#39;)"><span class="hl_varref"><span class="mpre">ifp</span></span></a><span class="mpre"> (</span><a href="#loc_465_9_465_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_9_465_11&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_463_5_463_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_463_5_463_8&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre">) </span><a href="#loc_458_19_458_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_19_458_28&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre">)
                       </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_458_29_458_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_29_458_32&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre">
          </span><a href="#loc_465_5_465_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_5_465_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_465_9_465_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_465_9_465_11&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_458_19_458_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_19_458_28&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre">)

</span><a href="#loc_474_1_474_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_22&#39;)"><span class="mpre">intersperseLazyBlocks</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_474_1_474_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_22&#39;)"><span class="hl_fundecl"><span class="mpre">intersperseLazyBlocks</span></span></a><span class="mpre"> </span><a name="loc_474_23_474_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_23_474_32&#39;)"><span class="hl_vardecl"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a name="loc_474_33_474_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_33_474_36&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre"> </span><a name="loc_474_37_474_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_37_474_39&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
    </span><a href="#loc_477_5_477_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_5_477_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_730_1_730_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_1_730_12&#39;)"><span class="hl_varref"><span class="mpre">splitLazyAt</span></span></a><span class="mpre"> </span><a href="#loc_474_23_474_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_23_474_32&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_474_37_474_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_37_474_39&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
  where
    </span><a name="loc_477_5_477_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_5_477_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_477_9_477_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_9_477_12&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a name="loc_477_14_477_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_14_477_17&#39;)"><span class="hl_vardecl"><span class="mpre">suf</span></span></a><span class="mpre">)
      | </span><span class="hl_varref"><span class="mpre">L.null</span></span><span class="mpre"> </span><a href="#loc_477_14_477_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_14_477_17&#39;)"><span class="hl_varref"><span class="mpre">suf</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_185_1_185_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_185_1_185_19&#39;)"><span class="hl_varref"><span class="mpre">fromLazyByteString</span></span></a><span class="mpre"> </span><a href="#loc_477_9_477_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_9_477_12&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_185_1_185_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_185_1_185_19&#39;)"><span class="hl_varref"><span class="mpre">fromLazyByteString</span></span></a><span class="mpre"> </span><a href="#loc_477_9_477_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_9_477_12&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_474_33_474_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_33_474_36&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre">
                     </span><a href="#loc_477_5_477_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_5_477_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_730_1_730_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_1_730_12&#39;)"><span class="hl_varref"><span class="mpre">splitLazyAt</span></span></a><span class="mpre"> </span><a href="#loc_474_23_474_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_23_474_32&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_477_14_477_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_14_477_17&#39;)"><span class="hl_varref"><span class="mpre">suf</span></span></a><span class="mpre">)

</span><a href="#loc_483_1_483_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_483_1_483_17&#39;)"><span class="mpre">encodeBase64MIME</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_483_1_483_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_483_1_483_17&#39;)"><span class="hl_vardecl"><span class="mpre">encodeBase64MIME</span></span></a><span class="mpre"> =
  </span><a href="#loc_474_1_474_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_22&#39;)"><span class="hl_varref"><span class="mpre">intersperseLazyBlocks</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">76</span></span><span class="mpre"> (</span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\r\n&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17&#39;)"><span class="hl_varref"><span class="mpre">toLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_500_1_500_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_13&#39;)"><span class="hl_varref"><span class="mpre">encodeBase64</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- test blockwise mapping on base64 encoding</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encode a bytestring using Base64 encoding according to the specification</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in RFC 4648, &lt;http://www.apps.ietf.org/rfc/rfc4648.html&gt;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that you need to insert additional linebreaks every 76 bytes using the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- function @joinWith &quot;\r\n&quot; 76@ in order to achieve the MIME Base64</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Content-Transfer-Encoding &lt;specified in http://tools.ietf.org/html/rfc2045&gt;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- TODO implement encoding of lazy bytestrings, implement joinWith</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- functionality, and convencience function for MIME base-64 encoding.</span></span><span class="mpre">
</span><a href="#loc_500_1_500_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_13&#39;)"><span class="mpre">encodeBase64</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_500_1_500_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_13&#39;)"><span class="hl_vardecl"><span class="mpre">encodeBase64</span></span></a><span class="mpre"> = </span><a href="#loc_503_1_503_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_1_503_17&#39;)"><span class="hl_varref"><span class="mpre">encodeLazyBase64</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">

</span><a href="#loc_503_1_503_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_1_503_17&#39;)"><span class="mpre">encodeLazyBase64</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><a name="loc_503_1_503_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_503_1_503_17&#39;)"><span class="hl_vardecl"><span class="mpre">encodeLazyBase64</span></span></a><span class="mpre"> = 
    </span><a href="#loc_506_5_506_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_5_506_14&#39;)"><span class="hl_varref"><span class="mpre">mkBuilder</span></span></a><span class="mpre">
  where
    </span><a name="loc_506_5_506_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_5_506_14&#39;)"><span class="hl_fundecl"><span class="mpre">mkBuilder</span></span></a><span class="mpre"> </span><a name="loc_506_15_506_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_15_506_17&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_140_1_140_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_140_1_140_8&#39;)"><span class="hl_varref"><span class="mpre">fromPut</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_507_9_507_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_507_9_507_18&#39;)"><span class="hl_vardecl"><span class="mpre">remainder</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_614_1_614_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_614_1_614_19&#39;)"><span class="hl_varref"><span class="mpre">putWriteLazyBlocks</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><a href="#loc_511_5_511_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_5_511_16&#39;)"><span class="hl_varref"><span class="mpre">writeBase64</span></span></a><span class="mpre"> </span><a href="#loc_506_15_506_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_15_506_17&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> 
        </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_135_1_135_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_135_1_135_11&#39;)"><span class="hl_varref"><span class="mpre">putBuilder</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_526_5_526_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_5_526_13&#39;)"><span class="hl_varref"><span class="mpre">complete</span></span></a><span class="mpre"> </span><a href="#loc_507_9_507_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_507_9_507_18&#39;)"><span class="hl_varref"><span class="mpre">remainder</span></span></a><span class="mpre">

    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_511_5_511_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_5_511_16&#39;)"><span class="mpre">writeBase64</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a name="loc_511_5_511_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_5_511_16&#39;)"><span class="hl_fundecl"><span class="mpre">writeBase64</span></span></a><span class="mpre"> </span><a name="loc_511_17_511_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_17_511_19&#39;)"><span class="hl_vardecl"><span class="mpre">ip</span></span></a><span class="mpre"> = 
        </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_163_1_163_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_163_1_163_11&#39;)"><span class="hl_varref"><span class="mpre">exactWrite</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_512_25_512_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_512_25_512_27&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> -&gt; do
            </span><a name="loc_513_13_513_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_13_513_15&#39;)"><span class="hl_vardecl"><span class="mpre">b0</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_521_9_521_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_9_521_17&#39;)"><span class="hl_varref"><span class="mpre">peekByte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
            </span><a name="loc_514_13_514_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_13_514_15&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_521_9_521_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_9_521_17&#39;)"><span class="hl_varref"><span class="mpre">peekByte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
            </span><a name="loc_515_13_515_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_13_515_15&#39;)"><span class="hl_vardecl"><span class="mpre">b2</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_521_9_521_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_9_521_17&#39;)"><span class="hl_varref"><span class="mpre">peekByte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
            let </span><a name="loc_516_17_516_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_17_516_18&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = (</span><a href="#loc_513_13_513_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_513_13_513_15&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> (</span><a href="#loc_514_13_514_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_13_514_15&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><a href="#loc_515_13_515_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_515_13_515_15&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_512_25_512_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_512_25_512_27&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">            ) </span><a href="Control.Monad.html#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span></a><span class="mpre"> </span><a href="#loc_523_9_523_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_9_523_12&#39;)"><span class="hl_varref"><span class="mpre">enc</span></span></a><span class="mpre"> (</span><a href="#loc_516_17_516_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_17_516_18&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">)
            </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_512_25_512_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_512_25_512_27&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="Control.Monad.html#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span></a><span class="mpre"> </span><a href="#loc_523_9_523_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_9_523_12&#39;)"><span class="hl_varref"><span class="mpre">enc</span></span></a><span class="mpre"> (</span><a href="#loc_516_17_516_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_17_516_18&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre">   </span><span class="hl_num"><span class="mpre">0xfff</span></span><span class="mpre">)
      where
        </span><a href="#loc_521_9_521_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_9_521_17&#39;)"><span class="mpre">peekByte</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">
        </span><a name="loc_521_9_521_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_9_521_17&#39;)"><span class="hl_fundecl"><span class="mpre">peekByte</span></span></a><span class="mpre"> </span><a name="loc_521_18_521_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_18_521_21&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">peekByteOff</span></span><span class="mpre"> </span><a href="#loc_511_17_511_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_511_17_511_19&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre"> </span><a href="#loc_521_18_521_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_521_18_521_21&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
        
        </span><a name="loc_523_9_523_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_9_523_12&#39;)"><span class="hl_vardecl"><span class="mpre">enc</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">peekElemOff</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">unsafeForeignPtrToPtr</span></span><span class="mpre"> </span><a href="#loc_552_5_552_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_5_552_16&#39;)"><span class="hl_varref"><span class="mpre">encodeTable</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">

    </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_526_5_526_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_5_526_13&#39;)"><span class="mpre">complete</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a name="loc_526_5_526_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_5_526_13&#39;)"><span class="hl_fundecl"><span class="mpre">complete</span></span></a><span class="mpre"> </span><a name="loc_526_14_526_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_14_526_16&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_526_14_526_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_14_526_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_221_1_221_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_221_1_221_10&#39;)"><span class="hl_varref"><span class="mpre">fromWrite</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
          </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_163_1_163_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_163_1_163_11&#39;)"><span class="hl_varref"><span class="mpre">exactWrite</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_529_27_529_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_27_529_29&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> -&gt; do
              let </span><a name="loc_530_19_530_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_19_530_30&#39;)"><span class="hl_fundecl"><span class="mpre">poke6Base64</span></span></a><span class="mpre"> </span><a name="loc_530_31_530_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_31_530_34&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_530_35_530_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_35_530_37&#39;)"><span class="hl_vardecl"><span class="mpre">sh</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">pokeByteOff</span></span><span class="mpre"> </span><a href="#loc_529_27_529_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_27_529_29&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><a href="#loc_530_31_530_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_31_530_34&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre">
                      (</span><a href="#loc_546_5_546_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_5_546_13&#39;)"><span class="hl_varref"><span class="mpre">alphabet</span></span></a><span class="mpre"> </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_infix"><span class="mpre">`S.unsafeIndex`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_541_9_541_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_9_541_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><a href="#loc_530_35_530_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_35_530_37&#39;)"><span class="hl_varref"><span class="mpre">sh</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">63</span></span><span class="mpre">))
                  </span><a name="loc_532_19_532_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_19_532_22&#39;)"><span class="hl_fundecl"><span class="mpre">pad</span></span></a><span class="mpre"> </span><a name="loc_532_23_532_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_23_532_26&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">pokeByteOff</span></span><span class="mpre"> </span><a href="#loc_529_27_529_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_27_529_29&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><a href="#loc_532_23_532_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_23_532_26&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
              </span><a href="#loc_530_19_530_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_19_530_30&#39;)"><span class="hl_varref"><span class="mpre">poke6Base64</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre">
              </span><a href="#loc_530_19_530_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_19_530_30&#39;)"><span class="hl_varref"><span class="mpre">poke6Base64</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">
              if </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_526_14_526_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_14_526_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> then </span><a href="#loc_532_19_532_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_19_532_22&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> 
                                  else </span><a href="#loc_530_19_530_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_19_530_30&#39;)"><span class="hl_varref"><span class="mpre">poke6Base64</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">
              </span><a href="#loc_532_19_532_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_19_532_22&#39;)"><span class="hl_varref"><span class="mpre">pad</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">
      where
        </span><a href="#loc_540_9_540_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_9_540_16&#39;)"><span class="mpre">getByte</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">
        </span><a name="loc_540_9_540_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_9_540_16&#39;)"><span class="hl_fundecl"><span class="mpre">getByte</span></span></a><span class="mpre"> </span><a name="loc_540_17_540_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_17_540_18&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_540_19_540_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_19_540_21&#39;)"><span class="hl_vardecl"><span class="mpre">sh</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_526_14_526_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_14_526_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_infix"><span class="mpre">`S.unsafeIndex`</span></span></a><span class="mpre"> </span><a href="#loc_540_17_540_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_17_540_18&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><a href="#loc_540_19_540_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_19_540_21&#39;)"><span class="hl_varref"><span class="mpre">sh</span></span></a><span class="mpre">
        </span><a name="loc_541_9_541_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_9_541_10&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_540_9_540_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_9_540_16&#39;)"><span class="hl_varref"><span class="mpre">getByte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> (if </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_526_14_526_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_14_526_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> then </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> else </span><a href="#loc_540_9_540_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_9_540_16&#39;)"><span class="hl_varref"><span class="mpre">getByte</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)
            
    </span><span class="hl_comment"><span class="mpre">-- Lookup table trick from Data.ByteString.Base64 by Bryan O&#39;Sullivan</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_546_5_546_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_5_546_13&#39;)"><span class="mpre">alphabet</span></a><span class="mpre"> #-}</span></span><span class="mpre">
    </span><a href="#loc_546_5_546_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_5_546_13&#39;)"><span class="mpre">alphabet</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre">
    </span><a name="loc_546_5_546_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_5_546_13&#39;)"><span class="hl_vardecl"><span class="mpre">alphabet</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 546, srcSpanStartColumn = 25, srcSpanEndLine = 546, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 546, srcSpanStartColumn = 25, srcSpanEndLine = 546, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3"><span class="mpre">[65..90]</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 546, srcSpanStartColumn = 37, srcSpanEndLine = 546, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 546, srcSpanStartColumn = 37, srcSpanEndLine = 546, srcSpanEndColumn = 38},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3"><span class="mpre">[97..122]</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 546, srcSpanStartColumn = 50, srcSpanEndLine = 546, srcSpanEndColumn = 58}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 546, srcSpanStartColumn = 50, srcSpanEndLine = 546, srcSpanEndColumn = 51},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3"><span class="mpre">[48..57]</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><span class="hl_num"><span class="mpre">43</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">47</span></span><span class="mpre">]

    </span><span class="hl_comment"><span class="mpre">-- FIXME: Check that the implementation of the lookup table aslo works on</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- big-endian systems.</span></span><span class="mpre">
    </span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_552_5_552_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_5_552_16&#39;)"><span class="mpre">encodeTable</span></a><span class="mpre"> #-}</span></span><span class="mpre"> 
    </span><a href="#loc_552_5_552_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_5_552_16&#39;)"><span class="mpre">encodeTable</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre">
    </span><a name="loc_552_5_552_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_5_552_16&#39;)"><span class="hl_vardecl"><span class="mpre">encodeTable</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_553_9_553_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_9_553_11&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">mallocForeignPtrArray</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4096</span></span><span class="mpre">
        let </span><a name="loc_554_13_554_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_13_554_15&#39;)"><span class="hl_vardecl"><span class="mpre">ix</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.index</span></span><span class="mpre"> </span><a href="#loc_546_5_546_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_5_546_13&#39;)"><span class="hl_varref"><span class="mpre">alphabet</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_553_9_553_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_9_553_11&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_555_30_555_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_30_555_31&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt;
          </span><a href="Control.Monad.html#loc_106_1_106_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_106_1_106_10&#39;)"><span class="hl_varref"><span class="mpre">sequence_</span></span></a><span class="mpre"> [ </span><span class="hl_varref"><span class="mpre">pokeElemOff</span></span><span class="mpre"> </span><a href="#loc_555_30_555_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_30_555_31&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a href="#loc_557_23_557_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_23_557_24&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><span class="hl_num"><span class="mpre">64</span></span><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_557_37_557_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_37_557_38&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) ((</span><a href="#loc_554_13_554_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_13_554_15&#39;)"><span class="hl_varref"><span class="mpre">ix</span></span></a><span class="mpre"> </span><a href="#loc_557_37_557_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_37_557_38&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><a href="#loc_554_13_554_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_13_554_15&#39;)"><span class="hl_varref"><span class="mpre">ix</span></span></a><span class="mpre"> </span><a href="#loc_557_23_557_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_23_557_24&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">)
                    | </span><a name="loc_557_23_557_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_23_557_24&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> &lt;- </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 557, srcSpanStartColumn = 28, srcSpanEndLine = 557, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 557, srcSpanStartColumn = 28, srcSpanEndLine = 557, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3"><span class="mpre">[0..63]</span></span><span class="mpre">, </span><a name="loc_557_37_557_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_37_557_38&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> &lt;- </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 557, srcSpanStartColumn = 42, srcSpanEndLine = 557, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 557, srcSpanStartColumn = 42, srcSpanEndLine = 557, srcSpanEndColumn = 43},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3"><span class="mpre">[0..63]</span></span><span class="mpre"> ]
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_553_9_553_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_9_553_11&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Process a bytestring block-wise using a &#39;Write&#39; action to produce the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- output per block.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- TODO: Compare speed with &#39;mapFilterMapByteString&#39;.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_573_1_573_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_1_573_15&#39;)"><span class="mpre">putWriteBlocks</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_573_1_573_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_1_573_15&#39;)"><span class="mpre">putWriteBlocks</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">                  </span><span class="hl_comment"><span class="mpre">-- ^ Block size.</span></span><span class="mpre">
               -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ &#39;Write&#39; given a pointer to the</span></span><span class="mpre">
                                       </span><span class="hl_comment"><span class="mpre">--   beginning of the block.</span></span><span class="mpre">
               -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ &#39;S.ByteString&#39; to consume blockwise.</span></span><span class="mpre">
               -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_81_9_81_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_81_9_81_12&#39;)"><span class="hl_tyconref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ &#39;Put&#39; returning the remaining</span></span><span class="mpre">
                                       </span><span class="hl_comment"><span class="mpre">--   bytes, which are guaranteed to be</span></span><span class="mpre">
                                       </span><span class="hl_comment"><span class="mpre">--   fewer than the block size.</span></span><span class="mpre">
</span><a name="loc_573_1_573_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_1_573_15&#39;)"><span class="hl_fundecl"><span class="mpre">putWriteBlocks</span></span></a><span class="mpre"> </span><a name="loc_573_16_573_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_16_573_25&#39;)"><span class="hl_vardecl"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a name="loc_573_26_573_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_26_573_31&#39;)"><span class="hl_vardecl"><span class="mpre">write</span></span></a><span class="mpre"> =
    \</span><a name="loc_574_6_574_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_6_574_8&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_116_1_116_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_116_1_116_17&#39;)"><span class="hl_varref"><span class="mpre">putBuildStepCont</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_576_5_576_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_5_576_9&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><a href="#loc_574_6_574_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_6_574_8&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
  where
    </span><a name="loc_576_5_576_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_5_576_9&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">S.PS</span></span></a><span class="mpre"> </span><a name="loc_576_16_576_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_16_576_19&#39;)"><span class="hl_vardecl"><span class="mpre">ifp</span></span></a><span class="mpre"> </span><a name="loc_576_20_576_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_20_576_24&#39;)"><span class="hl_vardecl"><span class="mpre">ioff</span></span></a><span class="mpre"> </span><a name="loc_576_25_576_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_25_576_30&#39;)"><span class="hl_vardecl"><span class="mpre">isize</span></span></a><span class="mpre">) !</span><a name="loc_576_33_576_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_33_576_34&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = 
        </span><a href="#loc_580_9_580_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_9_580_13&#39;)"><span class="hl_varref"><span class="mpre">goBS</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">unsafeForeignPtrToPtr</span></span><span class="mpre"> </span><a href="#loc_576_16_576_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_16_576_19&#39;)"><span class="hl_varref"><span class="mpre">ifp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_576_20_576_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_20_576_24&#39;)"><span class="hl_varref"><span class="mpre">ioff</span></span></a><span class="mpre">)
      where
        !</span><a name="loc_579_10_579_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_579_10_579_13&#39;)"><span class="hl_vardecl"><span class="mpre">ipe</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeForeignPtrToPtr</span></span><span class="mpre"> </span><a href="#loc_576_16_576_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_16_576_19&#39;)"><span class="hl_varref"><span class="mpre">ifp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_576_20_576_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_20_576_24&#39;)"><span class="hl_varref"><span class="mpre">ioff</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_576_25_576_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_25_576_30&#39;)"><span class="hl_varref"><span class="mpre">isize</span></span></a><span class="mpre">)
        </span><a name="loc_580_9_580_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_9_580_13&#39;)"><span class="hl_fundecl"><span class="mpre">goBS</span></span></a><span class="mpre"> !</span><a name="loc_580_15_580_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_15_580_18&#39;)"><span class="hl_vardecl"><span class="mpre">ip0</span></span></a><span class="mpre"> !</span><a name="loc_580_20_580_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_20_580_22&#39;)"><span class="hl_specname"><span class="mpre">br</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">BufRange</span></span><span class="mpre"> </span><a name="loc_580_33_580_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_33_580_36&#39;)"><span class="hl_vardecl"><span class="mpre">op0</span></span></a><span class="mpre"> </span><a name="loc_580_37_580_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_37_580_40&#39;)"><span class="hl_vardecl"><span class="mpre">ope</span></span></a><span class="mpre">)
          | </span><a href="#loc_580_15_580_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_15_580_18&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_573_16_573_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_16_573_25&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_579_10_579_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_579_10_579_13&#39;)"><span class="hl_varref"><span class="mpre">ipe</span></span></a><span class="mpre"> = do 
              </span><span class="hl_varref"><span class="mpre">touchForeignPtr</span></span><span class="mpre"> </span><a href="#loc_576_16_576_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_16_576_19&#39;)"><span class="hl_varref"><span class="mpre">ifp</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- input buffer consumed</span></span><span class="mpre">
              let !</span><a name="loc_583_20_583_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_20_583_23&#39;)"><span class="hl_vardecl"><span class="mpre">bs&#39;</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">S.PS</span></span></a><span class="mpre"> </span><a href="#loc_576_16_576_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_16_576_19&#39;)"><span class="hl_varref"><span class="mpre">ifp</span></span></a><span class="mpre"> (</span><a href="#loc_580_15_580_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_15_580_18&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unsafeForeignPtrToPtr</span></span><span class="mpre"> </span><a href="#loc_576_16_576_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_16_576_19&#39;)"><span class="hl_varref"><span class="mpre">ifp</span></span></a><span class="mpre">) 
                                  (</span><a href="#loc_579_10_579_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_579_10_579_13&#39;)"><span class="hl_varref"><span class="mpre">ipe</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_580_15_580_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_15_580_18&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre">)
              </span><a href="#loc_576_33_576_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_576_33_576_34&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_583_20_583_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_20_583_23&#39;)"><span class="hl_varref"><span class="mpre">bs&#39;</span></span></a><span class="mpre"> </span><a href="#loc_580_20_580_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_20_580_22&#39;)"><span class="hl_varref"><span class="mpre">br</span></span></a><span class="mpre">

          | </span><a href="#loc_580_33_580_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_33_580_36&#39;)"><span class="hl_varref"><span class="mpre">op0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_592_13_592_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_13_592_23&#39;)"><span class="hl_varref"><span class="mpre">writeBound</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_580_37_580_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_37_580_40&#39;)"><span class="hl_varref"><span class="mpre">ope</span></span></a><span class="mpre">  = 
              </span><a href="#loc_596_13_596_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_13_596_22&#39;)"><span class="hl_varref"><span class="mpre">goPartial</span></span></a><span class="mpre"> (</span><a href="#loc_580_15_580_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_15_580_18&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_573_16_573_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_16_573_25&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> </span><a href="#loc_593_13_593_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_13_593_25&#39;)"><span class="hl_varref"><span class="mpre">outRemaining</span></span></a><span class="mpre"> </span><a href="#loc_594_13_594_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_13_594_25&#39;)"><span class="hl_varref"><span class="mpre">inpRemaining</span></span></a><span class="mpre">))

          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_57_1_57_11&#39;)"><span class="hl_varref"><span class="mpre">bufferFull</span></span></a><span class="mpre"> </span><a href="#loc_592_13_592_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_13_592_23&#39;)"><span class="hl_varref"><span class="mpre">writeBound</span></span></a><span class="mpre"> </span><a href="#loc_580_33_580_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_33_580_36&#39;)"><span class="hl_varref"><span class="mpre">op0</span></span></a><span class="mpre"> (</span><a href="#loc_580_9_580_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_9_580_13&#39;)"><span class="hl_varref"><span class="mpre">goBS</span></span></a><span class="mpre"> </span><a href="#loc_580_15_580_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_15_580_18&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre">) 
          where
            </span><a name="loc_592_13_592_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_13_592_23&#39;)"><span class="hl_vardecl"><span class="mpre">writeBound</span></span></a><span class="mpre">   = </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_121_1_121_10&#39;)"><span class="hl_varref"><span class="mpre">getBound&#39;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;putWriteBlocks&quot;</span></span><span class="mpre"> </span><a href="#loc_573_26_573_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_26_573_31&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> 
            </span><a name="loc_593_13_593_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_13_593_25&#39;)"><span class="hl_vardecl"><span class="mpre">outRemaining</span></span></a><span class="mpre"> = (</span><a href="#loc_580_37_580_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_37_580_40&#39;)"><span class="hl_varref"><span class="mpre">ope</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_580_33_580_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_33_580_36&#39;)"><span class="hl_varref"><span class="mpre">op0</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><a href="#loc_592_13_592_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_592_13_592_23&#39;)"><span class="hl_varref"><span class="mpre">writeBound</span></span></a><span class="mpre">
            </span><a name="loc_594_13_594_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_594_13_594_25&#39;)"><span class="hl_vardecl"><span class="mpre">inpRemaining</span></span></a><span class="mpre"> = (</span><a href="#loc_579_10_579_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_579_10_579_13&#39;)"><span class="hl_varref"><span class="mpre">ipe</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_580_15_580_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_15_580_18&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><a href="#loc_573_16_573_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_16_573_25&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre">

            </span><a name="loc_596_13_596_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_13_596_22&#39;)"><span class="hl_fundecl"><span class="mpre">goPartial</span></span></a><span class="mpre"> !</span><a name="loc_596_24_596_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_24_596_30&#39;)"><span class="hl_vardecl"><span class="mpre">ipeTmp</span></span></a><span class="mpre"> = </span><a href="#loc_598_17_598_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_17_598_19&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_580_15_580_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_15_580_18&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre"> </span><a href="#loc_580_33_580_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_33_580_36&#39;)"><span class="hl_varref"><span class="mpre">op0</span></span></a><span class="mpre">
              where
                </span><a name="loc_598_17_598_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_17_598_19&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_598_21_598_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_21_598_23&#39;)"><span class="hl_vardecl"><span class="mpre">ip</span></span></a><span class="mpre"> !</span><a name="loc_598_25_598_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_25_598_27&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre">
                  | </span><a href="#loc_598_21_598_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_21_598_23&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_596_24_596_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_24_596_30&#39;)"><span class="hl_varref"><span class="mpre">ipeTmp</span></span></a><span class="mpre"> = do
                      </span><a name="loc_600_23_600_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_23_600_26&#39;)"><span class="hl_vardecl"><span class="mpre">op&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_108_1_108_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_108_1_108_9&#39;)"><span class="hl_varref"><span class="mpre">runWrite</span></span></a><span class="mpre"> (</span><a href="#loc_573_26_573_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_26_573_31&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_598_21_598_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_21_598_23&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre">) </span><a href="#loc_598_25_598_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_25_598_27&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">
                      </span><a href="#loc_598_17_598_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_17_598_19&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_598_21_598_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_21_598_23&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_573_16_573_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_16_573_25&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre">) </span><a href="#loc_600_23_600_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_600_23_600_26&#39;)"><span class="hl_varref"><span class="mpre">op&#39;</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
                      </span><a href="#loc_580_9_580_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_9_580_13&#39;)"><span class="hl_varref"><span class="mpre">goBS</span></span></a><span class="mpre"> </span><a href="#loc_598_21_598_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_21_598_23&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">BufRange</span></span><span class="mpre"> </span><a href="#loc_598_25_598_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_25_598_27&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre"> </span><a href="#loc_580_37_580_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_37_580_40&#39;)"><span class="hl_varref"><span class="mpre">ope</span></span></a><span class="mpre">)


</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_614_1_614_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_614_1_614_19&#39;)"><span class="mpre">putWriteLazyBlocks</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_614_1_614_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_614_1_614_19&#39;)"><span class="mpre">putWriteLazyBlocks</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">                  </span><span class="hl_comment"><span class="mpre">-- ^ Block size.</span></span><span class="mpre">
                   -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_98_6_98_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_98_6_98_11&#39;)"><span class="hl_tyconref"><span class="mpre">Write</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ &#39;Write&#39; given a pointer to the</span></span><span class="mpre">
                                           </span><span class="hl_comment"><span class="mpre">--   beginning of the block.</span></span><span class="mpre">
                   -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ &#39;L.ByteString&#39; to consume blockwise.</span></span><span class="mpre">
                   -&gt; </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_81_9_81_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_81_9_81_12&#39;)"><span class="hl_tyconref"><span class="mpre">Put</span></span></a><span class="mpre"> </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ &#39;Put&#39; returning the remaining</span></span><span class="mpre">
                                           </span><span class="hl_comment"><span class="mpre">--   bytes, which are guaranteed to be</span></span><span class="mpre">
                                           </span><span class="hl_comment"><span class="mpre">--   fewer than the block size.</span></span><span class="mpre">
</span><a name="loc_614_1_614_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_614_1_614_19&#39;)"><span class="hl_fundecl"><span class="mpre">putWriteLazyBlocks</span></span></a><span class="mpre"> </span><a name="loc_614_20_614_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_614_20_614_29&#39;)"><span class="hl_vardecl"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a name="loc_614_30_614_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_614_30_614_35&#39;)"><span class="hl_vardecl"><span class="mpre">write</span></span></a><span class="mpre"> =
    </span><a href="#loc_617_5_617_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_617_5_617_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
    </span><a name="loc_617_5_617_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_617_5_617_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_19_82_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_19_82_24&#39;)"><span class="hl_conref"><span class="mpre">L.Empty</span></span></a><span class="mpre">          = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
    </span><a href="#loc_617_5_617_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_617_5_617_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Lazy.Internal.html#loc_82_27_82_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_27_82_32&#39;)"><span class="hl_conref"><span class="mpre">L.Chunk</span></span></a><span class="mpre"> </span><a name="loc_618_17_618_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_17_618_19&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a name="loc_618_20_618_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_20_618_23&#39;)"><span class="hl_vardecl"><span class="mpre">lbs</span></span></a><span class="mpre">) = do
      </span><a name="loc_619_7_619_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_7_619_12&#39;)"><span class="hl_vardecl"><span class="mpre">bsRem</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_573_1_573_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_1_573_15&#39;)"><span class="hl_varref"><span class="mpre">putWriteBlocks</span></span></a><span class="mpre"> </span><a href="#loc_614_20_614_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_614_20_614_29&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_614_30_614_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_614_30_614_35&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_618_17_618_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_17_618_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
      case </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_619_7_619_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_7_619_12&#39;)"><span class="hl_varref"><span class="mpre">bsRem</span></span></a><span class="mpre"> of
        </span><a name="loc_621_9_621_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_9_621_13&#39;)"><span class="hl_vardecl"><span class="mpre">lRem</span></span></a><span class="mpre"> 
          | </span><a href="#loc_621_9_621_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_9_621_13&#39;)"><span class="hl_varref"><span class="mpre">lRem</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> -&gt; </span><a href="#loc_617_5_617_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_617_5_617_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_618_20_618_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_20_618_23&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; do
              let (</span><a name="loc_624_20_624_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_20_624_26&#39;)"><span class="hl_vardecl"><span class="mpre">lbsPre</span></span></a><span class="mpre">, </span><a name="loc_624_28_624_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_28_624_34&#39;)"><span class="hl_vardecl"><span class="mpre">lbsSuf</span></span></a><span class="mpre">) = 
                      </span><span class="hl_varref"><span class="mpre">L.splitAt</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_614_20_614_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_614_20_614_29&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_621_9_621_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_9_621_13&#39;)"><span class="hl_varref"><span class="mpre">lRem</span></span></a><span class="mpre">) </span><a href="#loc_618_20_618_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_618_20_618_23&#39;)"><span class="hl_varref"><span class="mpre">lbs</span></span></a><span class="mpre">
              case </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_619_7_619_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_7_619_12&#39;)"><span class="hl_varref"><span class="mpre">bsRem</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_624_20_624_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_20_624_26&#39;)"><span class="hl_varref"><span class="mpre">lbsPre</span></span></a><span class="mpre"> of
                </span><a name="loc_627_17_627_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_17_627_22&#39;)"><span class="hl_specname"><span class="mpre">block</span></span></a><span class="mpre">@(</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">S.PS</span></span></a><span class="mpre"> </span><a name="loc_627_29_627_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_29_627_32&#39;)"><span class="hl_vardecl"><span class="mpre">bfp</span></span></a><span class="mpre"> </span><a name="loc_627_33_627_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_33_627_37&#39;)"><span class="hl_vardecl"><span class="mpre">boff</span></span></a><span class="mpre"> </span><a name="loc_627_38_627_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_38_627_43&#39;)"><span class="hl_vardecl"><span class="mpre">bsize</span></span></a><span class="mpre">)
                  | </span><a href="#loc_627_38_627_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_38_627_43&#39;)"><span class="hl_varref"><span class="mpre">bsize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_614_20_614_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_614_20_614_29&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_627_17_627_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_17_627_22&#39;)"><span class="hl_varref"><span class="mpre">block</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">         -&gt; do
                      </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_135_1_135_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_135_1_135_11&#39;)"><span class="hl_varref"><span class="mpre">putBuilder</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Write.html#loc_221_1_221_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Write.html#loc_221_1_221_10&#39;)"><span class="hl_varref"><span class="mpre">fromWrite</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> 
                        </span><a href="#loc_614_30_614_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_614_30_614_35&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">unsafeForeignPtrToPtr</span></span><span class="mpre"> </span><a href="#loc_627_29_627_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_29_627_32&#39;)"><span class="hl_varref"><span class="mpre">bfp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_627_33_627_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_33_627_37&#39;)"><span class="hl_varref"><span class="mpre">boff</span></span></a><span class="mpre">)
                      </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_148_1_148_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_148_1_148_10&#39;)"><span class="hl_varref"><span class="mpre">putLiftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">touchForeignPtr</span></span><span class="mpre"> </span><a href="#loc_627_29_627_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_627_29_627_32&#39;)"><span class="hl_varref"><span class="mpre">bfp</span></span></a><span class="mpre">
                      </span><a href="#loc_617_5_617_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_617_5_617_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_624_28_624_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_28_624_34&#39;)"><span class="hl_varref"><span class="mpre">lbsSuf</span></span></a><span class="mpre"> 
                          

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Testing code</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">


</span><a href="#loc_642_1_642_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_1_642_8&#39;)"><span class="mpre">chunks3</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">]
</span><a name="loc_642_1_642_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_1_642_8&#39;)"><span class="hl_fundecl"><span class="mpre">chunks3</span></span></a><span class="mpre"> (</span><a name="loc_642_10_642_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_10_642_12&#39;)"><span class="hl_vardecl"><span class="mpre">b0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_642_15_642_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_15_642_17&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_642_20_642_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_20_642_22&#39;)"><span class="hl_vardecl"><span class="mpre">b2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_642_25_642_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_25_642_27&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) = 
    ((</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_642_10_642_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_10_642_12&#39;)"><span class="hl_varref"><span class="mpre">b0</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> 
     (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_642_15_642_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_15_642_17&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre">  </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> 
     (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_642_20_642_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_20_642_22&#39;)"><span class="hl_varref"><span class="mpre">b2</span></span></a><span class="mpre">            )
    ) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_642_1_642_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_1_642_8&#39;)"><span class="hl_varref"><span class="mpre">chunks3</span></span></a><span class="mpre"> </span><a href="#loc_642_25_642_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_25_642_27&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
</span><a href="#loc_642_1_642_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_642_1_642_8&#39;)"><span class="hl_fundecl"><span class="mpre">chunks3</span></span></a><span class="mpre"> _                   = []

</span><a href="#loc_650_1_650_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_1_650_14&#39;)"><span class="mpre">cmpWriteToLib</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">] -&gt; (</span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">, </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">)
</span><a name="loc_650_1_650_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_1_650_14&#39;)"><span class="hl_fundecl"><span class="mpre">cmpWriteToLib</span></span></a><span class="mpre"> </span><a name="loc_650_15_650_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_15_650_17&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = 
    </span><span class="hl_comment"><span class="mpre">-- ( toLazyByteString $ fromWriteList write24bitsBase64 $ chunks3 bs</span></span><span class="mpre">
    ( </span><a href="Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17&#39;)"><span class="hl_varref"><span class="mpre">toLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_500_1_500_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_13&#39;)"><span class="hl_varref"><span class="mpre">encodeBase64</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.pack</span></span><span class="mpre"> </span><a href="#loc_650_15_650_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_15_650_17&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
    , (</span><a href="Data.ByteString.Lazy.Internal.html#loc_82_27_82_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_27_82_32&#39;)"><span class="hl_infix"><span class="mpre">`L.Chunk`</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.Base64.html#loc_34_1_34_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Base64.html#loc_34_1_34_7&#39;)"><span class="hl_varref"><span class="mpre">encode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.pack</span></span><span class="mpre"> </span><a href="#loc_650_15_650_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_15_650_17&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> )

</span><a href="#loc_656_1_656_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_656_1_656_6&#39;)"><span class="mpre">test3</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_656_1_656_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_656_1_656_6&#39;)"><span class="hl_vardecl"><span class="mpre">test3</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">uncurry</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(==)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_650_1_650_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_650_1_650_14&#39;)"><span class="hl_varref"><span class="mpre">cmpWriteToLib</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 656, srcSpanStartColumn = 40, srcSpanEndLine = 656, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 656, srcSpanStartColumn = 40, srcSpanEndLine = 656, srcSpanEndColumn = 41},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3"><span class="mpre">[0..]</span></span><span class="mpre">

</span><a href="#loc_659_1_659_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_659_1_659_6&#39;)"><span class="mpre">test2</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> 
</span><a name="loc_659_1_659_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_659_1_659_6&#39;)"><span class="hl_vardecl"><span class="mpre">test2</span></span></a><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_269_1_269_17&#39;)"><span class="hl_varref"><span class="mpre">toLazyByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_500_1_500_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_13&#39;)"><span class="hl_varref"><span class="mpre">encodeBase64</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.pack</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 659, srcSpanStartColumn = 50, srcSpanEndLine = 659, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/LazyByteString.hs&quot;, srcSpanStartLine = 659, srcSpanStartColumn = 50, srcSpanEndLine = 659, srcSpanEndColumn = 51},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3"><span class="mpre">[0..]</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- OLD code
 
{-# INLINE poke8 #-}
poke8 :: Word8 -&gt; Ptr Word8 -&gt; IO ()
poke8 = flip poke

-- | @writeBase64 w@ writes the lower @24@ bits as four times 6 bit in
-- little-endian order encoded using the standard alphabeth of Base 64 encoding
-- as defined in &lt;http://www.apps.ietf.org/rfc/rfc4648.html&gt;.
--
{-# INLINE write6bitsBase64 #-}
write6bitsBase64 :: Word32 -&gt; Write
write6bitsBase64 = exactWrite 1  . poke6bitsBase64

{-# INLINE poke6bitsBase64 #-}
poke6bitsBase64 :: Word32 -&gt; Ptr Word8 -&gt; IO ()
poke6bitsBase64 w = poke8 (alphabet `S.unsafeIndex` fromIntegral (w .&amp;. 63))
    {-
    | i &lt;  26   = withOffsets  0 &#39;A&#39;
    | i &lt;  52   = withOffsets 26 &#39;a&#39;
    | i &lt;  62   = withOffsets 52 &#39;0&#39;
    | i == 62   = poke8 $ fromIntegral $ ord &#39;+&#39;
    | otherwise = poke8 $ fromIntegral $ ord &#39;/&#39;
  where
    i :: Int
    i = fromIntegral (w .&amp;. 63)

    {-# INLINE withOffsets #-}
    withOffsets neg pos = poke8 $ fromIntegral (i + ord pos - neg)
    -}

{-# INLINE writePaddedBitsBase64 #-}
writePaddedBitsBase64 :: Bool             -- ^ Only 8 bits have to be output.
                      -&gt; Word32           -- ^ Input whose lower 8 or 16 bits need to be output.
                      -&gt; Write
writePaddedBitsBase64 only8 w =
    write6bitsBase64 (w `shiftr_w32` 18)                         `mappend`
    write6bitsBase64 (w `shiftr_w32` 12)                         `mappend`
    writeIf (const only8) (const $ C8.writeChar &#39;=&#39;)
                          (write6bitsBase64 . (`shiftr_w32`  6)) 
                          w                                      `mappend`
    C8.writeChar &#39;=&#39;

{-# INLINE write24bitsBase64 #-}
write24bitsBase64 :: Word32 -&gt; Write
write24bitsBase64 w = write6bitsBase64 (w `shiftr_w32` 18) `mappend`
                      write6bitsBase64 (w `shiftr_w32` 12) `mappend`
                      write6bitsBase64 (w `shiftr_w32`  6) `mappend`
                      write6bitsBase64 (w                )

-- ASSUMES bits 25 - 31 are zero.
{-# INLINE write24bitsBase64&#39; #-}
write24bitsBase64&#39; :: Word32 -&gt; Write
write24bitsBase64&#39; w = 
    exactWrite 4 $ \p -&gt; do
      poke (castPtr p              ) =&lt;&lt; enc (w `shiftR` 12)
      poke (castPtr $ p `plusPtr` 2) =&lt;&lt; enc (w .&amp;.   0xfff)
  where
    {-# INLINE enc #-}
    enc = peekElemOff (unsafeForeignPtrToPtr encodeTable) . fromIntegral

-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A faster split for lazy bytestrings</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n\/c)/ &#39;splitAt&#39; @n xs@ is equivalent to @(&#39;take&#39; n xs, &#39;drop&#39; n xs)@.</span></span><span class="mpre">
</span><a href="#loc_730_1_730_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_1_730_12&#39;)"><span class="mpre">splitLazyAt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> -&gt; (</span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">, </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">)
</span><a name="loc_730_1_730_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_1_730_12&#39;)"><span class="hl_fundecl"><span class="mpre">splitLazyAt</span></span></a><span class="mpre"> </span><a name="loc_730_13_730_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_13_730_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_730_15_730_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_15_730_18&#39;)"><span class="hl_vardecl"><span class="mpre">cs0</span></span></a><span class="mpre">
  | </span><a href="#loc_730_13_730_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_13_730_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">    = (</span><a href="Data.ByteString.Lazy.Internal.html#loc_82_19_82_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_19_82_24&#39;)"><span class="hl_conref"><span class="mpre">L.Empty</span></span></a><span class="mpre">, </span><a href="#loc_730_15_730_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_15_730_18&#39;)"><span class="hl_varref"><span class="mpre">cs0</span></span></a><span class="mpre">)
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_734_5_734_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_5_734_10&#39;)"><span class="hl_varref"><span class="mpre">split</span></span></a><span class="mpre"> </span><a href="#loc_730_15_730_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_15_730_18&#39;)"><span class="hl_varref"><span class="mpre">cs0</span></span></a><span class="mpre">
  where
    </span><a name="loc_734_5_734_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_5_734_10&#39;)"><span class="hl_fundecl"><span class="mpre">split</span></span></a><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_19_82_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_19_82_24&#39;)"><span class="hl_conref"><span class="mpre">L.Empty</span></span></a><span class="mpre">        = (</span><a href="Data.ByteString.Lazy.Internal.html#loc_82_19_82_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_19_82_24&#39;)"><span class="hl_conref"><span class="mpre">L.Empty</span></span></a><span class="mpre">, </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_19_82_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_19_82_24&#39;)"><span class="hl_conref"><span class="mpre">L.Empty</span></span></a><span class="mpre">)
    </span><a href="#loc_734_5_734_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_5_734_10&#39;)"><span class="hl_fundecl"><span class="mpre">split</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Lazy.Internal.html#loc_82_27_82_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_27_82_32&#39;)"><span class="hl_conref"><span class="mpre">L.Chunk</span></span></a><span class="mpre"> </span><a name="loc_735_20_735_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_20_735_21&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_735_22_735_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_22_735_24&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)
      | </span><a href="#loc_730_13_730_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_13_730_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_741_9_741_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_9_741_12&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">  = case </span><span class="hl_varref"><span class="mpre">S.splitAt</span></span><span class="mpre">    </span><a href="#loc_730_13_730_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_13_730_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">         </span><a href="#loc_735_20_735_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_20_735_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">  of
          (</span><a name="loc_737_12_737_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_12_737_15&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a name="loc_737_17_737_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_17_737_20&#39;)"><span class="hl_vardecl"><span class="mpre">suf</span></span></a><span class="mpre">) -&gt; (</span><a href="Data.ByteString.Lazy.Internal.html#loc_82_27_82_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_27_82_32&#39;)"><span class="hl_conref"><span class="mpre">L.Chunk</span></span></a><span class="mpre"> </span><a href="#loc_737_12_737_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_12_737_15&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_19_82_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_19_82_24&#39;)"><span class="hl_conref"><span class="mpre">L.Empty</span></span></a><span class="mpre">, </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_27_82_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_27_82_32&#39;)"><span class="hl_conref"><span class="mpre">L.Chunk</span></span></a><span class="mpre"> </span><a href="#loc_737_17_737_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_17_737_20&#39;)"><span class="hl_varref"><span class="mpre">suf</span></span></a><span class="mpre"> </span><a href="#loc_735_22_735_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_22_735_24&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">)
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = case </span><a href="#loc_730_1_730_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_1_730_12&#39;)"><span class="hl_varref"><span class="mpre">splitLazyAt</span></span></a><span class="mpre"> (</span><a href="#loc_730_13_730_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_13_730_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_741_9_741_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_9_741_12&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">) </span><a href="#loc_735_22_735_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_22_735_24&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> of
          (</span><a name="loc_739_12_739_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_12_739_15&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a name="loc_739_17_739_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_17_739_20&#39;)"><span class="hl_vardecl"><span class="mpre">suf</span></span></a><span class="mpre">) -&gt; (</span><a href="Data.ByteString.Lazy.Internal.html#loc_82_27_82_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_27_82_32&#39;)"><span class="hl_conref"><span class="mpre">L.Chunk</span></span></a><span class="mpre"> </span><a href="#loc_735_20_735_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_20_735_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">   </span><a href="#loc_739_12_739_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_12_739_15&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre">    , </span><a href="#loc_739_17_739_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_17_739_20&#39;)"><span class="hl_varref"><span class="mpre">suf</span></span></a><span class="mpre">           )
      where
        </span><a name="loc_741_9_741_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_9_741_12&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_735_20_735_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_20_735_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A faster partition for strict and lazy bytestrings</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_750_1_750_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_1_750_16&#39;)"><span class="mpre">partitionStrict</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_750_1_750_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_1_750_16&#39;)"><span class="mpre">partitionStrict</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre"> -&gt; (</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre">, </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span></a><span class="mpre">)
</span><a name="loc_750_1_750_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_1_750_16&#39;)"><span class="hl_fundecl"><span class="mpre">partitionStrict</span></span></a><span class="mpre"> </span><a name="loc_750_17_750_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_17_750_18&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">S.PS</span></span></a><span class="mpre"> </span><a name="loc_750_25_750_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_25_750_28&#39;)"><span class="hl_vardecl"><span class="mpre">ifp</span></span></a><span class="mpre"> </span><a name="loc_750_29_750_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_29_750_33&#39;)"><span class="hl_vardecl"><span class="mpre">ioff</span></span></a><span class="mpre"> </span><a name="loc_750_34_750_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_34_750_38&#39;)"><span class="hl_vardecl"><span class="mpre">ilen</span></span></a><span class="mpre">) = 
    </span><a href="Control.Arrow.html#loc_96_5_96_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_96_5_96_11&#39;)"><span class="hl_varref"><span class="mpre">second</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.Internal.html#loc_592_1_592_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_592_1_592_16&#39;)"><span class="hl_varref"><span class="mpre">S.inlinePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_752_9_752_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_752_9_752_12&#39;)"><span class="hl_vardecl"><span class="mpre">ofp</span></span></a><span class="mpre"> &lt;- </span><a href="Data.ByteString.Internal.html#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_489_1_489_17&#39;)"><span class="hl_varref"><span class="mpre">S.mallocByteString</span></span></a><span class="mpre"> </span><a href="#loc_750_34_750_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_34_750_38&#39;)"><span class="hl_varref"><span class="mpre">ilen</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">withForeignPtr</span></span><span class="mpre"> </span><a href="#loc_750_25_750_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_25_750_28&#39;)"><span class="hl_varref"><span class="mpre">ifp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_755_5_755_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_755_5_755_12&#39;)"><span class="hl_varref"><span class="mpre">wrapper</span></span></a><span class="mpre"> </span><a href="#loc_752_9_752_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_752_9_752_12&#39;)"><span class="hl_varref"><span class="mpre">ofp</span></span></a><span class="mpre">
  where
    </span><a name="loc_755_5_755_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_755_5_755_12&#39;)"><span class="hl_fundecl"><span class="mpre">wrapper</span></span></a><span class="mpre"> !</span><a name="loc_755_14_755_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_755_14_755_17&#39;)"><span class="hl_vardecl"><span class="mpre">ofp</span></span></a><span class="mpre"> !</span><a name="loc_755_19_755_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_755_19_755_22&#39;)"><span class="hl_vardecl"><span class="mpre">ip0</span></span></a><span class="mpre"> = 
        </span><a href="#loc_760_9_760_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_9_760_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_755_19_755_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_755_19_755_22&#39;)"><span class="hl_varref"><span class="mpre">ip0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_750_29_750_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_29_750_33&#39;)"><span class="hl_varref"><span class="mpre">ioff</span></span></a><span class="mpre">) </span><a href="#loc_758_9_758_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_9_758_12&#39;)"><span class="hl_varref"><span class="mpre">op0</span></span></a><span class="mpre"> (</span><a href="#loc_758_9_758_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_9_758_12&#39;)"><span class="hl_varref"><span class="mpre">op0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><a href="#loc_750_34_750_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_34_750_38&#39;)"><span class="hl_varref"><span class="mpre">ilen</span></span></a><span class="mpre">)
      where
        </span><a name="loc_758_9_758_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_9_758_12&#39;)"><span class="hl_vardecl"><span class="mpre">op0</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeForeignPtrToPtr</span></span><span class="mpre"> </span><a href="#loc_755_14_755_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_755_14_755_17&#39;)"><span class="hl_varref"><span class="mpre">ofp</span></span></a><span class="mpre">

        </span><a name="loc_760_9_760_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_9_760_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_760_13_760_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_13_760_15&#39;)"><span class="hl_vardecl"><span class="mpre">ip</span></span></a><span class="mpre"> !</span><a name="loc_760_17_760_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_17_760_20&#39;)"><span class="hl_vardecl"><span class="mpre">opl</span></span></a><span class="mpre"> !</span><a name="loc_760_22_760_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_22_760_25&#39;)"><span class="hl_vardecl"><span class="mpre">oph</span></span></a><span class="mpre">
          | </span><a href="#loc_760_22_760_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_22_760_25&#39;)"><span class="hl_varref"><span class="mpre">oph</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_760_17_760_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_17_760_20&#39;)"><span class="hl_varref"><span class="mpre">opl</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">S.PS</span></span></a><span class="mpre"> </span><a href="#loc_755_14_755_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_755_14_755_17&#39;)"><span class="hl_varref"><span class="mpre">ofp</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_772_13_772_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_13_772_17&#39;)"><span class="hl_varref"><span class="mpre">olen</span></span></a><span class="mpre">, </span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">S.PS</span></span></a><span class="mpre"> </span><a href="#loc_755_14_755_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_755_14_755_17&#39;)"><span class="hl_varref"><span class="mpre">ofp</span></span></a><span class="mpre"> </span><a href="#loc_772_13_772_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_13_772_17&#39;)"><span class="hl_varref"><span class="mpre">olen</span></span></a><span class="mpre"> (</span><a href="#loc_750_34_750_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_34_750_38&#39;)"><span class="hl_varref"><span class="mpre">ilen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_772_13_772_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_13_772_17&#39;)"><span class="hl_varref"><span class="mpre">olen</span></span></a><span class="mpre">))
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = do
              </span><a name="loc_763_15_763_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_15_763_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> </span><a href="#loc_760_13_760_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_13_760_15&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre">
              if </span><a href="#loc_750_17_750_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_17_750_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_763_15_763_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_15_763_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> 
                then do </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_760_17_760_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_17_760_20&#39;)"><span class="hl_varref"><span class="mpre">opl</span></span></a><span class="mpre"> </span><a href="#loc_763_15_763_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_15_763_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> 
                        </span><a href="#loc_760_9_760_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_9_760_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_760_13_760_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_13_760_15&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_760_17_760_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_17_760_20&#39;)"><span class="hl_varref"><span class="mpre">opl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_760_22_760_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_22_760_25&#39;)"><span class="hl_varref"><span class="mpre">oph</span></span></a><span class="mpre">
                else do let </span><a name="loc_767_29_767_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_29_767_33&#39;)"><span class="hl_vardecl"><span class="mpre">oph&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_760_22_760_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_22_760_25&#39;)"><span class="hl_varref"><span class="mpre">oph</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (-</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                        </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_767_29_767_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_29_767_33&#39;)"><span class="hl_varref"><span class="mpre">oph&#39;</span></span></a><span class="mpre"> </span><a href="#loc_763_15_763_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_15_763_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                        </span><a href="#loc_760_9_760_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_9_760_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_760_13_760_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_13_760_15&#39;)"><span class="hl_varref"><span class="mpre">ip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_760_17_760_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_17_760_20&#39;)"><span class="hl_varref"><span class="mpre">opl</span></span></a><span class="mpre">               </span><a href="#loc_767_29_767_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_29_767_33&#39;)"><span class="hl_varref"><span class="mpre">oph&#39;</span></span></a><span class="mpre">

          where
            </span><a name="loc_772_13_772_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_772_13_772_17&#39;)"><span class="hl_vardecl"><span class="mpre">olen</span></span></a><span class="mpre"> = </span><a href="#loc_760_17_760_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_17_760_20&#39;)"><span class="hl_varref"><span class="mpre">opl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`minusPtr`</span></span><span class="mpre"> </span><a href="#loc_758_9_758_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_9_758_12&#39;)"><span class="hl_varref"><span class="mpre">op0</span></span></a><span class="mpre">

</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_776_1_776_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_776_1_776_14&#39;)"><span class="mpre">partitionLazy</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_776_1_776_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_776_1_776_14&#39;)"><span class="mpre">partitionLazy</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre"> -&gt; (</span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">, </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_6_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_6_82_16&#39;)"><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span></a><span class="mpre">)
</span><a name="loc_776_1_776_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_776_1_776_14&#39;)"><span class="hl_fundecl"><span class="mpre">partitionLazy</span></span></a><span class="mpre"> </span><a name="loc_776_15_776_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_776_15_776_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = 
    </span><a href="Data.ByteString.Lazy.Internal.html#loc_179_1_179_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_179_1_179_12&#39;)"><span class="hl_varref"><span class="mpre">L.foldrChunks</span></span></a><span class="mpre"> </span><a href="#loc_779_5_779_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_779_5_779_17&#39;)"><span class="hl_varref"><span class="mpre">partitionOne</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">)
  where
    </span><a name="loc_779_5_779_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_779_5_779_17&#39;)"><span class="hl_fundecl"><span class="mpre">partitionOne</span></span></a><span class="mpre"> </span><a name="loc_779_18_779_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_779_18_779_20&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> (</span><a name="loc_779_22_779_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_779_22_779_24&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre">, </span><a name="loc_779_26_779_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_779_26_779_28&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">) = 
        (</span><a href="Data.ByteString.Lazy.Internal.html#loc_82_27_82_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_27_82_32&#39;)"><span class="hl_conref"><span class="mpre">L.Chunk</span></span></a><span class="mpre"> </span><a href="#loc_782_10_782_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_782_10_782_11&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_779_22_779_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_779_22_779_24&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">, </span><a href="Data.ByteString.Lazy.Internal.html#loc_82_27_82_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_82_27_82_32&#39;)"><span class="hl_conref"><span class="mpre">L.Chunk</span></span></a><span class="mpre"> </span><a href="#loc_782_13_782_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_782_13_782_14&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_779_26_779_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_779_26_779_28&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">)
      where
        (</span><a name="loc_782_10_782_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_782_10_782_11&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">, </span><a name="loc_782_13_782_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_782_13_782_14&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_750_1_750_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_750_1_750_16&#39;)"><span class="hl_varref"><span class="mpre">partitionStrict</span></span></a><span class="mpre"> </span><a href="#loc_776_15_776_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_776_15_776_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_779_18_779_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_779_18_779_20&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
</span></div></body></html>