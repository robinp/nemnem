<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
module WaiExtraTest (specs) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 4, srcSpanStartColumn = 8, srcSpanEndLine = 4, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.Hspec&quot;"><span class="mpre">Test.Hspec</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 5, srcSpanStartColumn = 8, srcSpanEndLine = 5, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre"> hiding (Test)
import Data.Monoid (</span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="mpre">mappend</span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="mpre">mempty</span></a><span class="mpre">)

import Network.Wai
import Network.Wai.Test
import Network.Wai.Parse
import Network.Wai.UrlMap
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 18, srcSpanEndLine = 12, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 18, srcSpanEndLine = 13, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as S8
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 18, srcSpanEndLine = 14, srcSpanEndColumn = 44}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy.Char8&quot;"><span class="mpre">Data.ByteString.Lazy.Char8</span></span><span class="mpre"> as L8
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 15, srcSpanStartColumn = 18, srcSpanEndLine = 15, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import qualified Data.Text.Lazy as T
import qualified Data.Text as TS
import qualified Data.Text.Encoding as TE
import Control.Arrow
import Control.Applicative
import Control.Monad.Trans.Resource (</span><a href="Control.Monad.Trans.Resource.html#loc_362_1_362_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Resource.html#loc_362_1_362_18&#39;)"><span class="mpre">withInternalState</span></a><span class="mpre">, </span><a href="Control.Monad.Trans.Resource.html#loc_200_1_200_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Resource.html#loc_200_1_200_13&#39;)"><span class="mpre">runResourceT</span></a><span class="mpre">)

import Network.Wai.Middleware.Jsonp
import Network.Wai.Middleware.Gzip
import Network.Wai.Middleware.Vhost
import Network.Wai.Middleware.Autohead
import Network.Wai.Middleware.MethodOverride
import Network.Wai.Middleware.MethodOverridePost
import Network.Wai.Middleware.AcceptOverride
import Network.Wai.Middleware.RequestLogger
import Codec.Compression.GZip (</span><a href="Codec.Compression.GZip.html#loc_95_1_95_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Compression.GZip.html#loc_95_1_95_11&#39;)"><span class="mpre">decompress</span></a><span class="mpre">)

import Control.Monad.IO.Class (</span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="mpre">liftIO</span></a><span class="mpre">)
import Data.Maybe (</span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="mpre">fromMaybe</span></a><span class="mpre">)
import Network.HTTP.Types (</span><a href="Network.HTTP.Types.URI.html#loc_165_1_165_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.URI.html#loc_165_1_165_17&#39;)"><span class="mpre">parseSimpleQuery</span></a><span class="mpre">, </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="mpre">status200</span></a><span class="mpre">)
import System.Log.FastLogger
import System.IO (</span><a href="System.IO.html#loc_390_1_390_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_390_1_390_9&#39;)"><span class="mpre">withFile</span></a><span class="mpre">, </span><a href="GHC.IO.IOMode.html#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_6_28_12&#39;)"><span class="mpre">IOMode</span></a><span class="mpre"> (</span><a href="GHC.IO.IOMode.html#loc_28_21_28_29" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_21_28_29&#39;)"><span class="mpre">ReadMode</span></a><span class="mpre">))

import qualified Data.IORef as I

</span><a href="#loc_42_1_42_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_6&#39;)"><span class="mpre">specs</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_42_1_42_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_6&#39;)"><span class="hl_vardecl"><span class="mpre">specs</span></span></a><span class="mpre"> = do
  </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Network.Wai.UrlMap&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">uncurry</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre">) </span><a href="#loc_602_1_602_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_602_1_602_12&#39;)"><span class="hl_varref"><span class="mpre">casesUrlMap</span></span></a><span class="mpre">

  </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Network.Wai.Parse&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;parseContentType&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        let </span><a name="loc_48_13_48_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_15&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_48_17_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_48_20_48_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_20_48_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">, </span><a name="loc_48_23_48_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_23_48_24&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> (</span><a href="Data.Text.html#loc_392_1_392_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_392_1_392_7&#39;)"><span class="hl_varref"><span class="mpre">TS.unpack</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Text.Encoding.html#loc_307_1_307_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_307_1_307_11&#39;)"><span class="hl_varref"><span class="mpre">TE.decodeUtf8</span></span></a><span class="mpre"> </span><a href="#loc_48_17_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Parse.html#loc_155_1_155_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_155_1_155_17&#39;)"><span class="hl_varref"><span class="mpre">parseContentType</span></span></a><span class="mpre"> </span><a href="#loc_48_17_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> (</span><a href="#loc_48_20_48_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_20_48_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">, </span><a href="#loc_48_23_48_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_23_48_24&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">)
        </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> </span><a href="#loc_48_13_48_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_13_48_15&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
            [ (</span><span class="hl_string"><span class="mpre">&quot;text/plain&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;text/plain&quot;</span></span><span class="mpre">, [])
            , (</span><span class="hl_string"><span class="mpre">&quot;text/plain; charset=UTF-8 &quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;text/plain&quot;</span></span><span class="mpre">, [(</span><span class="hl_string"><span class="mpre">&quot;charset&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;UTF-8&quot;</span></span><span class="mpre">)])
            , (</span><span class="hl_string"><span class="mpre">&quot;text/plain; charset=UTF-8 ; boundary = foo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;text/plain&quot;</span></span><span class="mpre">, [(</span><span class="hl_string"><span class="mpre">&quot;charset&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;UTF-8&quot;</span></span><span class="mpre">), (</span><span class="hl_string"><span class="mpre">&quot;boundary&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">)])
            ]
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;parseQueryString&quot;</span></span><span class="mpre"> </span><a href="#loc_84_1_84_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_21&#39;)"><span class="hl_varref"><span class="mpre">caseParseQueryString</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;parseQueryString with question mark&quot;</span></span><span class="mpre"> </span><a href="#loc_100_1_100_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_23&#39;)"><span class="hl_varref"><span class="mpre">caseParseQueryStringQM</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;parseHttpAccept&quot;</span></span><span class="mpre"> </span><a href="#loc_117_1_117_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_20&#39;)"><span class="hl_varref"><span class="mpre">caseParseHttpAccept</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;parseRequestBody&quot;</span></span><span class="mpre"> </span><a href="#loc_137_1_137_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_21&#39;)"><span class="hl_varref"><span class="mpre">caseParseRequestBody</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;multipart with plus&quot;</span></span><span class="mpre"> </span><a href="#loc_201_1_201_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_18&#39;)"><span class="hl_varref"><span class="mpre">caseMultipartPlus</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;multipart with multiple attributes&quot;</span></span><span class="mpre"> </span><a href="#loc_214_1_214_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_19&#39;)"><span class="hl_varref"><span class="mpre">caseMultipartAttrs</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;urlencoded with plus&quot;</span></span><span class="mpre"> </span><a href="#loc_227_1_227_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_15&#39;)"><span class="hl_varref"><span class="mpre">caseUrlEncPlus</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">{-
    , it &quot;findBound&quot; caseFindBound
    , it &quot;sinkTillBound&quot; caseSinkTillBound
    , it &quot;killCR&quot; caseKillCR
    , it &quot;killCRLF&quot; caseKillCRLF
    , it &quot;takeLine&quot; caseTakeLine
    -}</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;jsonp&quot;</span></span><span class="mpre"> </span><a href="#loc_307_1_307_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_10&#39;)"><span class="hl_varref"><span class="mpre">caseJsonp</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;gzip&quot;</span></span><span class="mpre"> </span><a href="#loc_343_1_343_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_1_343_9&#39;)"><span class="hl_varref"><span class="mpre">caseGzip</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;gzip not for MSIE&quot;</span></span><span class="mpre"> </span><a href="#loc_367_1_367_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_13&#39;)"><span class="hl_varref"><span class="mpre">caseGzipMSIE</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;gzip bypass when precompressed&quot;</span></span><span class="mpre"> </span><a href="#loc_378_1_378_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_1_378_18&#39;)"><span class="hl_varref"><span class="mpre">caseGzipBypassPre</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;defaultCheckMime&quot;</span></span><span class="mpre"> </span><a href="#loc_357_1_357_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_21&#39;)"><span class="hl_varref"><span class="mpre">caseDefaultCheckMime</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;vhost&quot;</span></span><span class="mpre"> </span><a href="#loc_394_1_394_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_10&#39;)"><span class="hl_varref"><span class="mpre">caseVhost</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;autohead&quot;</span></span><span class="mpre"> </span><a href="#loc_410_1_410_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_13&#39;)"><span class="hl_varref"><span class="mpre">caseAutohead</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;method override&quot;</span></span><span class="mpre"> </span><a href="#loc_428_1_428_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_19&#39;)"><span class="hl_varref"><span class="mpre">caseMethodOverride</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;method override post&quot;</span></span><span class="mpre"> </span><a href="#loc_451_1_451_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_1_451_23&#39;)"><span class="hl_varref"><span class="mpre">caseMethodOverridePost</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;accept override&quot;</span></span><span class="mpre"> </span><a href="#loc_478_1_478_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_1_478_19&#39;)"><span class="hl_varref"><span class="mpre">caseAcceptOverride</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;dalvik multipart&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;non-chunked&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_498_1_498_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_1_498_13&#39;)"><span class="hl_varref"><span class="mpre">dalvikHelper</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;chunked&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_498_1_498_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_1_498_13&#39;)"><span class="hl_varref"><span class="mpre">dalvikHelper</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;debug request body&quot;</span></span><span class="mpre"> </span><a href="#loc_533_1_533_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_1_533_21&#39;)"><span class="hl_varref"><span class="mpre">caseDebugRequestBody</span></span></a><span class="mpre">

</span><a href="#loc_84_1_84_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_21&#39;)"><span class="mpre">caseParseQueryString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_84_1_84_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_21&#39;)"><span class="hl_vardecl"><span class="mpre">caseParseQueryString</span></span></a><span class="mpre"> = do
    let </span><a name="loc_85_9_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_85_12_85_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_12_85_13&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_85_14_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_15&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> =
            </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><a href="Control.Arrow.html#loc_107_5_107_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_107_5_107_10&#39;)"><span class="hl_infix"><span class="mpre">***</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre">) </span><a href="#loc_85_12_85_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_12_85_13&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">@=?</span></span><span class="mpre"> </span><a href="Network.HTTP.Types.URI.html#loc_165_1_165_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.URI.html#loc_165_1_165_17&#39;)"><span class="hl_varref"><span class="mpre">parseSimpleQuery</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><a href="#loc_85_14_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_14_85_15&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)

    </span><a href="#loc_85_9_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [] </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
    </span><a href="#loc_85_9_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">
    </span><a href="#loc_85_9_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bar&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;foo=bar&quot;</span></span><span class="mpre">
    </span><a href="#loc_85_9_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bar&quot;</span></span><span class="mpre">), (</span><span class="hl_string"><span class="mpre">&quot;baz&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bin&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;foo=bar&amp;baz=bin&quot;</span></span><span class="mpre">
    </span><a href="#loc_85_9_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;%Q&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;%Q&quot;</span></span><span class="mpre">
    </span><a href="#loc_85_9_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;%1Q&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;%1Q&quot;</span></span><span class="mpre">
    </span><a href="#loc_85_9_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;%1&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;%1&quot;</span></span><span class="mpre">
    </span><a href="#loc_85_9_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;%2F&quot;</span></span><span class="mpre">
    </span><a href="#loc_85_9_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;%2f&quot;</span></span><span class="mpre">
    </span><a href="#loc_85_9_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;foo bar&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;foo+bar&quot;</span></span><span class="mpre">

</span><a href="#loc_100_1_100_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_23&#39;)"><span class="mpre">caseParseQueryStringQM</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_100_1_100_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_23&#39;)"><span class="hl_vardecl"><span class="mpre">caseParseQueryStringQM</span></span></a><span class="mpre"> = do
    let </span><a name="loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_101_12_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_13&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_101_14_101_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_15&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> =
            </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><a href="Control.Arrow.html#loc_107_5_107_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_107_5_107_10&#39;)"><span class="hl_infix"><span class="mpre">***</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre">) </span><a href="#loc_101_12_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_12_101_13&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">@=?</span></span><span class="mpre"> </span><a href="Network.HTTP.Types.URI.html#loc_165_1_165_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.URI.html#loc_165_1_165_17&#39;)"><span class="hl_varref"><span class="mpre">parseSimpleQuery</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;?&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_101_14_101_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_15&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)

    </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [] </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
    </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">
    </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bar&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;foo=bar&quot;</span></span><span class="mpre">
    </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bar&quot;</span></span><span class="mpre">), (</span><span class="hl_string"><span class="mpre">&quot;baz&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bin&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;foo=bar&amp;baz=bin&quot;</span></span><span class="mpre">
    </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;%Q&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;%Q&quot;</span></span><span class="mpre">
    </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;%1Q&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;%1Q&quot;</span></span><span class="mpre">
    </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;%1&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;%1&quot;</span></span><span class="mpre">
    </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;%2F&quot;</span></span><span class="mpre">
    </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;%2f&quot;</span></span><span class="mpre">
    </span><a href="#loc_101_9_101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;foo bar&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;foo+bar&quot;</span></span><span class="mpre">

</span><a href="#loc_117_1_117_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_20&#39;)"><span class="mpre">caseParseHttpAccept</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_117_1_117_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_20&#39;)"><span class="hl_vardecl"><span class="mpre">caseParseHttpAccept</span></span></a><span class="mpre"> = do
    let </span><a name="loc_118_9_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_14&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;text/plain; q=0.5, text/html;charset=utf-8, text/*;q=0.8;ext=blah, text/x-dvi; q=0.8, text/x-c&quot;</span></span><span class="mpre">
        </span><a name="loc_119_9_119_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_9_119_17&#39;)"><span class="hl_vardecl"><span class="mpre">expected</span></span></a><span class="mpre"> = [</span><span class="hl_string"><span class="mpre">&quot;text/html;charset=utf-8&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;text/x-c&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;text/x-dvi&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;text/*&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;text/plain&quot;</span></span><span class="mpre">]
    </span><a href="#loc_119_9_119_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_9_119_17&#39;)"><span class="hl_varref"><span class="mpre">expected</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">@=?</span></span><span class="mpre"> </span><a href="Network.Wai.Parse.html#loc_56_1_56_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_56_1_56_16&#39;)"><span class="hl_varref"><span class="mpre">parseHttpAccept</span></span></a><span class="mpre"> </span><a href="#loc_118_9_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_14&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">

</span><a href="#loc_125_1_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_18&#39;)"><span class="mpre">parseRequestBody&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">BackEnd</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">file</span></span><span class="mpre">
                  -&gt; </span><a href="Network.Wai.Test.html#loc_63_6_63_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_63_6_63_14&#39;)"><span class="hl_tyconref"><span class="mpre">SRequest</span></span></a><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> ([(</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)], [(</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">, </span><a href="Network.Wai.Parse.html#loc_119_6_119_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_119_6_119_14&#39;)"><span class="hl_tyconref"><span class="mpre">FileInfo</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">file</span></span><span class="mpre">)])
</span><a name="loc_125_1_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_18&#39;)"><span class="hl_fundecl"><span class="mpre">parseRequestBody&#39;</span></span></a><span class="mpre"> </span><a name="loc_125_19_125_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_19_125_23&#39;)"><span class="hl_vardecl"><span class="mpre">sink</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">SRequest</span></span><span class="mpre"> </span><a name="loc_125_34_125_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_34_125_37&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> </span><a name="loc_125_38_125_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_38_125_41&#39;)"><span class="hl_vardecl"><span class="mpre">bod</span></span></a><span class="mpre">) =
    case </span><a href="Network.Wai.Parse.html#loc_142_1_142_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_142_1_142_19&#39;)"><span class="hl_varref"><span class="mpre">getRequestBodyType</span></span></a><span class="mpre"> </span><a href="#loc_125_34_125_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_34_125_37&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> ([], [])
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_128_14_128_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_14_128_17&#39;)"><span class="hl_vardecl"><span class="mpre">rbt</span></span></a><span class="mpre"> -&gt; do
            </span><a name="loc_129_13_129_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_13_129_16&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">I.newIORef</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre"> </span><a href="#loc_125_38_125_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_38_125_41&#39;)"><span class="hl_varref"><span class="mpre">bod</span></span></a><span class="mpre">
            let </span><a name="loc_130_17_130_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_19&#39;)"><span class="hl_vardecl"><span class="mpre">rb</span></span></a><span class="mpre"> = </span><a href="Data.IORef.html#loc_101_1_101_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_101_1_101_18&#39;)"><span class="hl_varref"><span class="mpre">I.atomicModifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_129_13_129_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_13_129_16&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_130_49_130_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_49_130_55&#39;)"><span class="hl_vardecl"><span class="mpre">chunks</span></span></a><span class="mpre"> -&gt;
                        case </span><a href="#loc_130_49_130_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_49_130_55&#39;)"><span class="hl_varref"><span class="mpre">chunks</span></span></a><span class="mpre"> of
                            [] -&gt; ([], </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">)
                            </span><a name="loc_133_29_133_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_29_133_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_133_31_133_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_31_133_32&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_133_31_133_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_31_133_32&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">, </span><a href="#loc_133_29_133_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_29_133_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
            </span><a href="Network.Wai.Parse.html#loc_186_1_186_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_186_1_186_16&#39;)"><span class="hl_varref"><span class="mpre">sinkRequestBody</span></span></a><span class="mpre"> </span><a href="#loc_125_19_125_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_19_125_23&#39;)"><span class="hl_varref"><span class="mpre">sink</span></span></a><span class="mpre"> </span><a href="#loc_128_14_128_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_14_128_17&#39;)"><span class="hl_varref"><span class="mpre">rbt</span></span></a><span class="mpre"> </span><a href="#loc_130_17_130_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_17_130_19&#39;)"><span class="hl_varref"><span class="mpre">rb</span></span></a><span class="mpre">

</span><a href="#loc_137_1_137_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_21&#39;)"><span class="mpre">caseParseRequestBody</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_137_1_137_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_1_137_21&#39;)"><span class="hl_vardecl"><span class="mpre">caseParseRequestBody</span></span></a><span class="mpre"> =
    </span><a href="#loc_157_5_157_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_5_157_6&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
  where
    </span><a name="loc_140_5_140_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_5_140_13&#39;)"><span class="hl_vardecl"><span class="mpre">content2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;--AaB03x\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;Content-Disposition: form-data; name=\&quot;document\&quot;; filename=\&quot;b.txt\&quot;\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;Content-Type: text/plain; charset=iso-8859-1\n\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;This is a file.\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;It has two lines.\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;--AaB03x\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;Content-Disposition: form-data; name=\&quot;title\&quot;\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;Content-Type: text/plain; charset=iso-8859-1\n\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;A File\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;--AaB03x\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;Content-Disposition: form-data; name=\&quot;summary\&quot;\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;Content-Type: text/plain; charset=iso-8859-1\n\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;This is my file\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;file test\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;--AaB03x--&quot;</span></span><span class="mpre">
    </span><a name="loc_156_5_156_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_5_156_13&#39;)"><span class="hl_vardecl"><span class="mpre">content3</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;------WebKitFormBoundaryB1pWXPZ6lNr8RiLh\r\nContent-Disposition: form-data; name=\&quot;yaml\&quot;; filename=\&quot;README\&quot;\r\nContent-Type: application/octet-stream\r\n\r\nPhoto blog using Hack.\n\r\n------WebKitFormBoundaryB1pWXPZ6lNr8RiLh--\r\n&quot;</span></span><span class="mpre">
    </span><a name="loc_157_5_157_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_5_157_6&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = do
        let </span><a name="loc_158_13_158_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_13_158_21&#39;)"><span class="hl_vardecl"><span class="mpre">content1</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;foo=bar&amp;baz=bin&quot;</span></span><span class="mpre">
        let </span><a name="loc_159_13_159_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_13_159_19&#39;)"><span class="hl_vardecl"><span class="mpre">ctype1</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;application/x-www-form-urlencoded&quot;</span></span><span class="mpre">
        </span><a name="loc_160_9_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_16&#39;)"><span class="hl_vardecl"><span class="mpre">result1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_125_1_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_18&#39;)"><span class="hl_varref"><span class="mpre">parseRequestBody&#39;</span></span></a><span class="mpre"> </span><a href="Network.Wai.Parse.html#loc_80_1_80_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_80_1_80_11&#39;)"><span class="hl_varref"><span class="mpre">lbsBackEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_236_1_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_10&#39;)"><span class="hl_varref"><span class="mpre">toRequest</span></span></a><span class="mpre"> </span><a href="#loc_159_13_159_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_13_159_19&#39;)"><span class="hl_varref"><span class="mpre">ctype1</span></span></a><span class="mpre"> </span><a href="#loc_158_13_158_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_13_158_21&#39;)"><span class="hl_varref"><span class="mpre">content1</span></span></a><span class="mpre">
        </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;parsing post x-www-form-urlencoded&quot;</span></span><span class="mpre">
                    (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><a href="Control.Arrow.html#loc_107_5_107_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_107_5_107_10&#39;)"><span class="hl_infix"><span class="mpre">***</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre">) [(</span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bar&quot;</span></span><span class="mpre">), (</span><span class="hl_string"><span class="mpre">&quot;baz&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bin&quot;</span></span><span class="mpre">)], [])
                    </span><a href="#loc_160_9_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_9_160_16&#39;)"><span class="hl_varref"><span class="mpre">result1</span></span></a><span class="mpre">

        let </span><a name="loc_165_13_165_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_13_165_19&#39;)"><span class="hl_vardecl"><span class="mpre">ctype2</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;multipart/form-data; boundary=AaB03x&quot;</span></span><span class="mpre">
        </span><a name="loc_166_9_166_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_16&#39;)"><span class="hl_vardecl"><span class="mpre">result2</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_125_1_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_18&#39;)"><span class="hl_varref"><span class="mpre">parseRequestBody&#39;</span></span></a><span class="mpre"> </span><a href="Network.Wai.Parse.html#loc_80_1_80_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_80_1_80_11&#39;)"><span class="hl_varref"><span class="mpre">lbsBackEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_236_1_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_10&#39;)"><span class="hl_varref"><span class="mpre">toRequest</span></span></a><span class="mpre"> </span><a href="#loc_165_13_165_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_13_165_19&#39;)"><span class="hl_varref"><span class="mpre">ctype2</span></span></a><span class="mpre"> </span><a href="#loc_140_5_140_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_5_140_13&#39;)"><span class="hl_varref"><span class="mpre">content2</span></span></a><span class="mpre">
        let </span><a name="loc_167_13_167_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_13_167_26&#39;)"><span class="hl_vardecl"><span class="mpre">expectedsmap2</span></span></a><span class="mpre"> =
              [ (</span><span class="hl_string"><span class="mpre">&quot;title&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;A File&quot;</span></span><span class="mpre">)
              , (</span><span class="hl_string"><span class="mpre">&quot;summary&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;This is my file\nfile test&quot;</span></span><span class="mpre">)
              ]
        let </span><a name="loc_171_13_171_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_13_171_22&#39;)"><span class="hl_vardecl"><span class="mpre">textPlain</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;text/plain; charset=iso-8859-1&quot;</span></span><span class="mpre">
        let </span><a name="loc_172_13_172_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_13_172_26&#39;)"><span class="hl_vardecl"><span class="mpre">expectedfile2</span></span></a><span class="mpre"> =
              [(</span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;document&quot;</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">FileInfo</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;b.txt&quot;</span></span><span class="mpre">) </span><a href="#loc_171_13_171_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_13_171_22&#39;)"><span class="hl_varref"><span class="mpre">textPlain</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L8.pack</span></span><span class="mpre">
                 </span><span class="hl_string"><span class="mpre">&quot;This is a file.\nIt has two lines.&quot;</span></span><span class="mpre">)]
        let </span><a name="loc_175_13_175_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_13_175_22&#39;)"><span class="hl_vardecl"><span class="mpre">expected2</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><a href="Control.Arrow.html#loc_107_5_107_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_107_5_107_10&#39;)"><span class="hl_infix"><span class="mpre">***</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre">) </span><a href="#loc_167_13_167_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_13_167_26&#39;)"><span class="hl_varref"><span class="mpre">expectedsmap2</span></span></a><span class="mpre">, </span><a href="#loc_172_13_172_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_13_172_26&#39;)"><span class="hl_varref"><span class="mpre">expectedfile2</span></span></a><span class="mpre">)
        </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;parsing post multipart/form-data&quot;</span></span><span class="mpre">
                    </span><a href="#loc_175_13_175_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_13_175_22&#39;)"><span class="hl_varref"><span class="mpre">expected2</span></span></a><span class="mpre">
                    </span><a href="#loc_166_9_166_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_9_166_16&#39;)"><span class="hl_varref"><span class="mpre">result2</span></span></a><span class="mpre">

        let </span><a name="loc_180_13_180_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_13_180_19&#39;)"><span class="hl_vardecl"><span class="mpre">ctype3</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;multipart/form-data; boundary=----WebKitFormBoundaryB1pWXPZ6lNr8RiLh&quot;</span></span><span class="mpre">
        </span><a name="loc_181_9_181_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_9_181_16&#39;)"><span class="hl_vardecl"><span class="mpre">result3</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_125_1_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_18&#39;)"><span class="hl_varref"><span class="mpre">parseRequestBody&#39;</span></span></a><span class="mpre"> </span><a href="Network.Wai.Parse.html#loc_80_1_80_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_80_1_80_11&#39;)"><span class="hl_varref"><span class="mpre">lbsBackEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_236_1_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_10&#39;)"><span class="hl_varref"><span class="mpre">toRequest</span></span></a><span class="mpre"> </span><a href="#loc_180_13_180_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_13_180_19&#39;)"><span class="hl_varref"><span class="mpre">ctype3</span></span></a><span class="mpre"> </span><a href="#loc_156_5_156_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_5_156_13&#39;)"><span class="hl_varref"><span class="mpre">content3</span></span></a><span class="mpre">
        let </span><a name="loc_182_13_182_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_13_182_26&#39;)"><span class="hl_vardecl"><span class="mpre">expectedsmap3</span></span></a><span class="mpre"> = []
        let </span><a name="loc_183_13_183_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_13_183_26&#39;)"><span class="hl_vardecl"><span class="mpre">expectedfile3</span></span></a><span class="mpre"> = [(</span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;yaml&quot;</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">FileInfo</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;README&quot;</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;application/octet-stream&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
                                </span><span class="hl_varref"><span class="mpre">L8.pack</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Photo blog using Hack.\n&quot;</span></span><span class="mpre">)]
        let </span><a name="loc_185_13_185_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_13_185_22&#39;)"><span class="hl_vardecl"><span class="mpre">expected3</span></span></a><span class="mpre"> = (</span><a href="#loc_182_13_182_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_13_182_26&#39;)"><span class="hl_varref"><span class="mpre">expectedsmap3</span></span></a><span class="mpre">, </span><a href="#loc_183_13_183_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_13_183_26&#39;)"><span class="hl_varref"><span class="mpre">expectedfile3</span></span></a><span class="mpre">)
        </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;parsing actual post multipart/form-data&quot;</span></span><span class="mpre">
                    </span><a href="#loc_185_13_185_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_13_185_22&#39;)"><span class="hl_varref"><span class="mpre">expected3</span></span></a><span class="mpre">
                    </span><a href="#loc_181_9_181_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_9_181_16&#39;)"><span class="hl_varref"><span class="mpre">result3</span></span></a><span class="mpre">

        </span><a name="loc_190_9_190_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_9_190_17&#39;)"><span class="hl_vardecl"><span class="mpre">result2&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_125_1_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_18&#39;)"><span class="hl_varref"><span class="mpre">parseRequestBody&#39;</span></span></a><span class="mpre"> </span><a href="Network.Wai.Parse.html#loc_80_1_80_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_80_1_80_11&#39;)"><span class="hl_varref"><span class="mpre">lbsBackEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_245_1_245_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_11&#39;)"><span class="hl_varref"><span class="mpre">toRequest&#39;</span></span></a><span class="mpre"> </span><a href="#loc_165_13_165_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_13_165_19&#39;)"><span class="hl_varref"><span class="mpre">ctype2</span></span></a><span class="mpre"> </span><a href="#loc_140_5_140_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_5_140_13&#39;)"><span class="hl_varref"><span class="mpre">content2</span></span></a><span class="mpre">
        </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;parsing post multipart/form-data 2&quot;</span></span><span class="mpre">
                    </span><a href="#loc_175_13_175_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_13_175_22&#39;)"><span class="hl_varref"><span class="mpre">expected2</span></span></a><span class="mpre">
                    </span><a href="#loc_190_9_190_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_9_190_17&#39;)"><span class="hl_varref"><span class="mpre">result2&#39;</span></span></a><span class="mpre">

        </span><a name="loc_195_9_195_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_17&#39;)"><span class="hl_vardecl"><span class="mpre">result3&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_125_1_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_18&#39;)"><span class="hl_varref"><span class="mpre">parseRequestBody&#39;</span></span></a><span class="mpre"> </span><a href="Network.Wai.Parse.html#loc_80_1_80_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_80_1_80_11&#39;)"><span class="hl_varref"><span class="mpre">lbsBackEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_245_1_245_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_11&#39;)"><span class="hl_varref"><span class="mpre">toRequest&#39;</span></span></a><span class="mpre"> </span><a href="#loc_180_13_180_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_13_180_19&#39;)"><span class="hl_varref"><span class="mpre">ctype3</span></span></a><span class="mpre"> </span><a href="#loc_156_5_156_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_5_156_13&#39;)"><span class="hl_varref"><span class="mpre">content3</span></span></a><span class="mpre">
        </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;parsing actual post multipart/form-data 2&quot;</span></span><span class="mpre">
                    </span><a href="#loc_185_13_185_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_13_185_22&#39;)"><span class="hl_varref"><span class="mpre">expected3</span></span></a><span class="mpre">
                    </span><a href="#loc_195_9_195_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_9_195_17&#39;)"><span class="hl_varref"><span class="mpre">result3&#39;</span></span></a><span class="mpre">

</span><a href="#loc_201_1_201_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_18&#39;)"><span class="mpre">caseMultipartPlus</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_201_1_201_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_18&#39;)"><span class="hl_vardecl"><span class="mpre">caseMultipartPlus</span></span></a><span class="mpre"> = do
    </span><a name="loc_202_5_202_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_11&#39;)"><span class="hl_vardecl"><span class="mpre">result</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_125_1_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_18&#39;)"><span class="hl_varref"><span class="mpre">parseRequestBody&#39;</span></span></a><span class="mpre"> </span><a href="Network.Wai.Parse.html#loc_80_1_80_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_80_1_80_11&#39;)"><span class="hl_varref"><span class="mpre">lbsBackEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_236_1_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_10&#39;)"><span class="hl_varref"><span class="mpre">toRequest</span></span></a><span class="mpre"> </span><a href="#loc_211_5_211_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_5_211_10&#39;)"><span class="hl_varref"><span class="mpre">ctype</span></span></a><span class="mpre"> </span><a href="#loc_205_5_205_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_5_205_12&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre">
    </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_202_5_202_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_5_202_11&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">@?=</span></span><span class="mpre"> ([(</span><span class="hl_string"><span class="mpre">&quot;email&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;has+plus&quot;</span></span><span class="mpre">)], [])
  where
    </span><a name="loc_205_5_205_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_5_205_12&#39;)"><span class="hl_vardecl"><span class="mpre">content</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;--AaB03x\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;Content-Disposition: form-data; name=\&quot;email\&quot;\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;Content-Type: text/plain; charset=iso-8859-1\n\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;has+plus\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;--AaB03x--&quot;</span></span><span class="mpre">
    </span><a name="loc_211_5_211_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_5_211_10&#39;)"><span class="hl_vardecl"><span class="mpre">ctype</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;multipart/form-data; boundary=AaB03x&quot;</span></span><span class="mpre">

</span><a href="#loc_214_1_214_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_19&#39;)"><span class="mpre">caseMultipartAttrs</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_214_1_214_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_1_214_19&#39;)"><span class="hl_vardecl"><span class="mpre">caseMultipartAttrs</span></span></a><span class="mpre"> = do
    </span><a name="loc_215_5_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_5_215_11&#39;)"><span class="hl_vardecl"><span class="mpre">result</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_125_1_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_18&#39;)"><span class="hl_varref"><span class="mpre">parseRequestBody&#39;</span></span></a><span class="mpre"> </span><a href="Network.Wai.Parse.html#loc_80_1_80_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_80_1_80_11&#39;)"><span class="hl_varref"><span class="mpre">lbsBackEnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_236_1_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_10&#39;)"><span class="hl_varref"><span class="mpre">toRequest</span></span></a><span class="mpre"> </span><a href="#loc_224_5_224_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_10&#39;)"><span class="hl_varref"><span class="mpre">ctype</span></span></a><span class="mpre"> </span><a href="#loc_218_5_218_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_5_218_12&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre">
    </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_215_5_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_5_215_11&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">@?=</span></span><span class="mpre"> ([(</span><span class="hl_string"><span class="mpre">&quot;email&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;has+plus&quot;</span></span><span class="mpre">)], [])
  where
    </span><a name="loc_218_5_218_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_5_218_12&#39;)"><span class="hl_vardecl"><span class="mpre">content</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;--AaB03x\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;Content-Disposition: form-data; name=\&quot;email\&quot;\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;Content-Type: text/plain; charset=iso-8859-1\n\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;has+plus\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
        </span><span class="hl_string"><span class="mpre">&quot;--AaB03x--&quot;</span></span><span class="mpre">
    </span><a name="loc_224_5_224_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_10&#39;)"><span class="hl_vardecl"><span class="mpre">ctype</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;multipart/form-data; charset=UTF-8; boundary=AaB03x&quot;</span></span><span class="mpre">

</span><a href="#loc_227_1_227_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_15&#39;)"><span class="mpre">caseUrlEncPlus</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_227_1_227_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_15&#39;)"><span class="hl_vardecl"><span class="mpre">caseUrlEncPlus</span></span></a><span class="mpre"> = do
    </span><a name="loc_228_5_228_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_5_228_11&#39;)"><span class="hl_vardecl"><span class="mpre">result</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.Resource.html#loc_200_1_200_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Resource.html#loc_200_1_200_13&#39;)"><span class="hl_varref"><span class="mpre">runResourceT</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.Trans.Resource.html#loc_362_1_362_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Resource.html#loc_362_1_362_18&#39;)"><span class="hl_varref"><span class="mpre">withInternalState</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_228_51_228_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_51_228_56&#39;)"><span class="hl_vardecl"><span class="mpre">state</span></span></a><span class="mpre"> -&gt;
              </span><a href="#loc_125_1_125_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_18&#39;)"><span class="hl_varref"><span class="mpre">parseRequestBody&#39;</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Parse.html#loc_95_1_95_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_95_1_95_16&#39;)"><span class="hl_varref"><span class="mpre">tempFileBackEnd</span></span></a><span class="mpre"> </span><a href="#loc_228_51_228_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_51_228_56&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_236_1_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_10&#39;)"><span class="hl_varref"><span class="mpre">toRequest</span></span></a><span class="mpre"> </span><a href="#loc_233_5_233_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_5_233_10&#39;)"><span class="hl_varref"><span class="mpre">ctype</span></span></a><span class="mpre"> </span><a href="#loc_232_5_232_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_5_232_12&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre">
    </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_228_5_228_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_5_228_11&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">@?=</span></span><span class="mpre"> ([(</span><span class="hl_string"><span class="mpre">&quot;email&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;has+plus&quot;</span></span><span class="mpre">)], [])
  where
    </span><a name="loc_232_5_232_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_5_232_12&#39;)"><span class="hl_vardecl"><span class="mpre">content</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;email=has%2Bplus&quot;</span></span><span class="mpre">
    </span><a name="loc_233_5_233_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_5_233_10&#39;)"><span class="hl_vardecl"><span class="mpre">ctype</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;application/x-www-form-urlencoded&quot;</span></span><span class="mpre">

</span><a href="#loc_236_1_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_10&#39;)"><span class="mpre">toRequest</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S8.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S8.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Network.Wai.Test.html#loc_63_6_63_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_63_6_63_14&#39;)"><span class="hl_tyconref"><span class="mpre">SRequest</span></span></a><span class="mpre">
</span><a name="loc_236_1_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_10&#39;)"><span class="hl_fundecl"><span class="mpre">toRequest</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ctype</span></span><span class="mpre"> </span><a name="loc_236_17_236_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_17_236_24&#39;)"><span class="hl_vardecl"><span class="mpre">content</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">SRequest</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 236, srcSpanStartColumn = 36, srcSpanEndLine = 242, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 237, srcSpanStartColumn = 5, srcSpanEndLine = 237, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcS"><span class="mpre">defaultRequest
    { requestHeaders = [(&quot;Content-Type&quot;, ctype)]
    , requestMethod = &quot;POST&quot;
    , rawPathInfo = &quot;/&quot;
    , rawQueryString = &quot;&quot;
    , queryString = []
    }</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> [</span><a href="#loc_236_17_236_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_17_236_24&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre">])

</span><a href="#loc_245_1_245_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_11&#39;)"><span class="mpre">toRequest&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S8.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S8.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Network.Wai.Test.html#loc_63_6_63_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_63_6_63_14&#39;)"><span class="hl_tyconref"><span class="mpre">SRequest</span></span></a><span class="mpre">
</span><a name="loc_245_1_245_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_11&#39;)"><span class="hl_fundecl"><span class="mpre">toRequest&#39;</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">ctype</span></span><span class="mpre"> </span><a name="loc_245_18_245_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_18_245_25&#39;)"><span class="hl_vardecl"><span class="mpre">content</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">SRequest</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 245, srcSpanStartColumn = 37, srcSpanEndLine = 247, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 246, srcSpanStartColumn = 5, srcSpanEndLine = 246, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcS"><span class="mpre">defaultRequest
    { requestHeaders = [(&quot;Content-Type&quot;, ctype)]
    }</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.singleton</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.unpack</span></span><span class="mpre"> </span><a href="#loc_245_18_245_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_18_245_25&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">{-
caseFindBound :: Assertion
caseFindBound = do
    findBound (S8.pack &quot;def&quot;) (S8.pack &quot;abcdefghi&quot;) @?=
        FoundBound (S8.pack &quot;abc&quot;) (S8.pack &quot;ghi&quot;)
    findBound (S8.pack &quot;def&quot;) (S8.pack &quot;ABC&quot;) @?= NoBound
    findBound (S8.pack &quot;def&quot;) (S8.pack &quot;abcd&quot;) @?= PartialBound
    findBound (S8.pack &quot;def&quot;) (S8.pack &quot;abcdE&quot;) @?= NoBound
    findBound (S8.pack &quot;def&quot;) (S8.pack &quot;abcdEdef&quot;) @?=
        FoundBound (S8.pack &quot;abcdE&quot;) (S8.pack &quot;&quot;)

caseSinkTillBound :: Assertion
caseSinkTillBound = do
    let iter () _ = return ()
    let src = S8.pack &quot;this is some text&quot;
        bound1 = S8.pack &quot;some&quot;
        bound2 = S8.pack &quot;some!&quot;
    let enum = enumList 1 [src]
    let helper _ _ = return ()
    (_, res1) &lt;- run_ $ enum $$ sinkTillBound bound1 helper ()
    res1 @?= True
    (_, res2) &lt;- run_ $ enum $$ sinkTillBound bound2 helper ()
    res2 @?= False

caseKillCR :: Assertion
caseKillCR = do
    &quot;foo&quot; @=? killCR &quot;foo&quot;
    &quot;foo&quot; @=? killCR &quot;foo\r&quot;
    &quot;foo\r\n&quot; @=? killCR &quot;foo\r\n&quot;
    &quot;foo\r&#39;&quot; @=? killCR &quot;foo\r&#39;&quot;

caseKillCRLF :: Assertion
caseKillCRLF = do
    &quot;foo&quot; @=? killCRLF &quot;foo&quot;
    &quot;foo\r&quot; @=? killCRLF &quot;foo\r&quot;
    &quot;foo&quot; @=? killCRLF &quot;foo\r\n&quot;
    &quot;foo\r&#39;&quot; @=? killCRLF &quot;foo\r&#39;&quot;
    &quot;foo&quot; @=? killCRLF &quot;foo\n&quot;

caseTakeLine :: Assertion
caseTakeLine = do
    helper &quot;foo\nbar\nbaz&quot; &quot;foo&quot;
    helper &quot;foo\r\nbar\nbaz&quot; &quot;foo&quot;
    helper &quot;foo\nbar\r\nbaz&quot; &quot;foo&quot;
    helper &quot;foo\rbar\r\nbaz&quot; &quot;foo\rbar&quot;
  where
    helper haystack needle = do
        x &lt;- run_ $ enumList 1 [haystack] $$ takeLine
        Just needle @=? x
-}</span></span><span class="mpre">

</span><a href="#loc_301_1_301_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_1_301_9&#39;)"><span class="mpre">jsonpApp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">
</span><a name="loc_301_1_301_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_1_301_9&#39;)"><span class="hl_vardecl"><span class="mpre">jsonpApp</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Middleware.Jsonp.html#loc_39_1_39_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Middleware.Jsonp.html#loc_39_1_39_6&#39;)"><span class="hl_varref"><span class="mpre">jsonp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ </span><a name="loc_301_23_301_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_23_301_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_301_23_301_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_23_301_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre">
    </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre">
    [(</span><span class="hl_string"><span class="mpre">&quot;Content-Type&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;application/json&quot;</span></span><span class="mpre">)]
    </span><span class="hl_string"><span class="mpre">&quot;{\&quot;foo\&quot;:\&quot;bar\&quot;}&quot;</span></span><span class="mpre">

</span><a href="#loc_307_1_307_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_10&#39;)"><span class="mpre">caseJsonp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_307_1_307_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_307_1_307_10&#39;)"><span class="hl_vardecl"><span class="mpre">caseJsonp</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Network.Wai.Test.html#loc_61_1_61_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_61_1_61_11&#39;)"><span class="hl_varref"><span class="mpre">runSession</span></span></a><span class="mpre"> </span><a href="#loc_301_1_301_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_1_301_9&#39;)"><span class="hl_varref"><span class="mpre">jsonpApp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_308_5_308_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_5_308_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres1</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 308, srcSpanStartColumn = 22, srcSpanEndLine = 311, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 309, srcSpanStartColumn = 17, srcSpanEndLine = 309, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { queryString = [(&quot;callback&quot;, Just &quot;test&quot;)]
                , requestHeaders = [(&quot;Accept&quot;, &quot;text/javascript&quot;)]
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_142_1_142_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_142_1_142_18&#39;)"><span class="hl_varref"><span class="mpre">assertContentType</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;text/javascript&quot;</span></span><span class="mpre"> </span><a href="#loc_308_5_308_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_5_308_10&#39;)"><span class="hl_varref"><span class="mpre">sres1</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">assertBody</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;test({\&quot;foo\&quot;:\&quot;bar\&quot;})&quot;</span></span><span class="mpre"> </span><a href="#loc_308_5_308_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_5_308_10&#39;)"><span class="hl_varref"><span class="mpre">sres1</span></span></a><span class="mpre">

    </span><a name="loc_315_5_315_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_5_315_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres2</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 315, srcSpanStartColumn = 22, srcSpanEndLine = 318, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 316, srcSpanStartColumn = 17, srcSpanEndLine = 316, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { queryString = [(&quot;call_back&quot;, Just &quot;test&quot;)]
                , requestHeaders = [(&quot;Accept&quot;, &quot;text/javascript&quot;)]
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_142_1_142_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_142_1_142_18&#39;)"><span class="hl_varref"><span class="mpre">assertContentType</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;application/json&quot;</span></span><span class="mpre"> </span><a href="#loc_315_5_315_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_5_315_10&#39;)"><span class="hl_varref"><span class="mpre">sres2</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">assertBody</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;{\&quot;foo\&quot;:\&quot;bar\&quot;}&quot;</span></span><span class="mpre"> </span><a href="#loc_315_5_315_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_5_315_10&#39;)"><span class="hl_varref"><span class="mpre">sres2</span></span></a><span class="mpre">

    </span><a name="loc_322_5_322_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_5_322_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres3</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 322, srcSpanStartColumn = 22, srcSpanEndLine = 325, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 323, srcSpanStartColumn = 17, srcSpanEndLine = 323, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { queryString = [(&quot;callback&quot;, Just &quot;test&quot;)]
                , requestHeaders = [(&quot;Accept&quot;, &quot;text/html&quot;)]
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_142_1_142_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_142_1_142_18&#39;)"><span class="hl_varref"><span class="mpre">assertContentType</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;application/json&quot;</span></span><span class="mpre"> </span><a href="#loc_322_5_322_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_5_322_10&#39;)"><span class="hl_varref"><span class="mpre">sres3</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">assertBody</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;{\&quot;foo\&quot;:\&quot;bar\&quot;}&quot;</span></span><span class="mpre"> </span><a href="#loc_322_5_322_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_5_322_10&#39;)"><span class="hl_varref"><span class="mpre">sres3</span></span></a><span class="mpre">

</span><a href="#loc_330_1_330_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_8&#39;)"><span class="mpre">gzipApp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">
</span><a name="loc_330_1_330_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_8&#39;)"><span class="hl_vardecl"><span class="mpre">gzipApp</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Middleware.Gzip.html#loc_80_1_80_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Middleware.Gzip.html#loc_80_1_80_5&#39;)"><span class="hl_varref"><span class="mpre">gzip</span></span></a><span class="mpre"> </span><a href="Data.Default.Class.html#loc_40_5_40_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_40_5_40_8&#39;)"><span class="hl_varref"><span class="mpre">def</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ </span><a name="loc_330_25_330_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_25_330_26&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_330_25_330_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_25_330_26&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre">
    [(</span><span class="hl_string"><span class="mpre">&quot;Content-Type&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;text/plain&quot;</span></span><span class="mpre">)]
    </span><span class="hl_string"><span class="mpre">&quot;test&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Lie a little and don&#39;t compress the body.  This way we test</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that the compression is skipped based on the presence of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the Content-Encoding header.</span></span><span class="mpre">
</span><a href="#loc_338_1_338_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_1_338_21&#39;)"><span class="mpre">gzipPrecompressedApp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">
</span><a name="loc_338_1_338_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_1_338_21&#39;)"><span class="hl_vardecl"><span class="mpre">gzipPrecompressedApp</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Middleware.Gzip.html#loc_80_1_80_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Middleware.Gzip.html#loc_80_1_80_5&#39;)"><span class="hl_varref"><span class="mpre">gzip</span></span></a><span class="mpre"> </span><a href="Data.Default.Class.html#loc_40_5_40_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_40_5_40_8&#39;)"><span class="hl_varref"><span class="mpre">def</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ </span><a name="loc_338_38_338_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_38_338_39&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_338_38_338_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_38_338_39&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre">
    [(</span><span class="hl_string"><span class="mpre">&quot;Content-Type&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;text/plain&quot;</span></span><span class="mpre">), (</span><span class="hl_string"><span class="mpre">&quot;Content-Encoding&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;gzip&quot;</span></span><span class="mpre">)]
    </span><span class="hl_string"><span class="mpre">&quot;test&quot;</span></span><span class="mpre">

</span><a href="#loc_343_1_343_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_1_343_9&#39;)"><span class="mpre">caseGzip</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_343_1_343_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_1_343_9&#39;)"><span class="hl_vardecl"><span class="mpre">caseGzip</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Network.Wai.Test.html#loc_61_1_61_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_61_1_61_11&#39;)"><span class="hl_varref"><span class="mpre">runSession</span></span></a><span class="mpre"> </span><a href="#loc_330_1_330_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_8&#39;)"><span class="hl_varref"><span class="mpre">gzipApp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_344_5_344_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_5_344_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres1</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 344, srcSpanStartColumn = 22, srcSpanEndLine = 346, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 345, srcSpanStartColumn = 17, srcSpanEndLine = 345, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { requestHeaders = [(&quot;Accept-Encoding&quot;, &quot;gzip&quot;)]
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Encoding&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;gzip&quot;</span></span><span class="mpre"> </span><a href="#loc_344_5_344_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_5_344_10&#39;)"><span class="hl_varref"><span class="mpre">sres1</span></span></a><span class="mpre">
    </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Codec.Compression.GZip.html#loc_95_1_95_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Compression.GZip.html#loc_95_1_95_11&#39;)"><span class="hl_varref"><span class="mpre">decompress</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Test.html#loc_70_7_70_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_70_7_70_17&#39;)"><span class="hl_varref"><span class="mpre">simpleBody</span></span></a><span class="mpre"> </span><a href="#loc_344_5_344_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_5_344_10&#39;)"><span class="hl_varref"><span class="mpre">sres1</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">@?=</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;test&quot;</span></span><span class="mpre">

    </span><a name="loc_350_5_350_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_5_350_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres2</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 350, srcSpanStartColumn = 22, srcSpanEndLine = 352, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 351, srcSpanStartColumn = 17, srcSpanEndLine = 351, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { requestHeaders = []
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_206_1_206_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_206_1_206_15&#39;)"><span class="hl_varref"><span class="mpre">assertNoHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Encoding&quot;</span></span><span class="mpre"> </span><a href="#loc_350_5_350_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_5_350_10&#39;)"><span class="hl_varref"><span class="mpre">sres2</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">assertBody</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;test&quot;</span></span><span class="mpre"> </span><a href="#loc_350_5_350_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_5_350_10&#39;)"><span class="hl_varref"><span class="mpre">sres2</span></span></a><span class="mpre">

</span><a href="#loc_357_1_357_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_21&#39;)"><span class="mpre">caseDefaultCheckMime</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_357_1_357_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_1_357_21&#39;)"><span class="hl_vardecl"><span class="mpre">caseDefaultCheckMime</span></span></a><span class="mpre"> = do
    let </span><a name="loc_358_9_358_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_9_358_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_358_12_358_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_12_358_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_358_14_358_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_14_358_15&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = (</span><a href="#loc_358_12_358_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_12_358_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="Network.Wai.Middleware.Gzip.html#loc_61_1_61_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Middleware.Gzip.html#loc_61_1_61_17&#39;)"><span class="hl_varref"><span class="mpre">defaultCheckMime</span></span></a><span class="mpre"> </span><a href="#loc_358_12_358_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_12_358_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> (</span><a href="#loc_358_12_358_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_12_358_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_358_14_358_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_14_358_15&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
    </span><a href="#loc_358_9_358_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_9_358_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;application/json&quot;</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_358_9_358_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_9_358_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;application/javascript&quot;</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_358_9_358_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_9_358_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;application/something&quot;</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    </span><a href="#loc_358_9_358_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_9_358_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;text/something&quot;</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    </span><a href="#loc_358_9_358_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_9_358_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo/bar&quot;</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
    </span><a href="#loc_358_9_358_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_9_358_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;application/json; charset=utf-8&quot;</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">

</span><a href="#loc_367_1_367_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_13&#39;)"><span class="mpre">caseGzipMSIE</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_367_1_367_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_13&#39;)"><span class="hl_vardecl"><span class="mpre">caseGzipMSIE</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Network.Wai.Test.html#loc_61_1_61_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_61_1_61_11&#39;)"><span class="hl_varref"><span class="mpre">runSession</span></span></a><span class="mpre"> </span><a href="#loc_330_1_330_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_8&#39;)"><span class="hl_varref"><span class="mpre">gzipApp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_368_5_368_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_5_368_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres1</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 368, srcSpanStartColumn = 22, srcSpanEndLine = 373, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 369, srcSpanStartColumn = 17, srcSpanEndLine = 369, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { requestHeaders =
                    [ (&quot;Accept-Encoding&quot;, &quot;gzip&quot;)
                    , (&quot;User-Agent&quot;, &quot;Mozilla/4.0 (Windows; MSIE 6.0; Windows NT 6.0)&quot;)
                    ]
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_206_1_206_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_206_1_206_15&#39;)"><span class="hl_varref"><span class="mpre">assertNoHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Encoding&quot;</span></span><span class="mpre"> </span><a href="#loc_368_5_368_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_5_368_10&#39;)"><span class="hl_varref"><span class="mpre">sres1</span></span></a><span class="mpre">
    </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Test.html#loc_70_7_70_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_70_7_70_17&#39;)"><span class="hl_varref"><span class="mpre">simpleBody</span></span></a><span class="mpre"> </span><a href="#loc_368_5_368_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_5_368_10&#39;)"><span class="hl_varref"><span class="mpre">sres1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">@?=</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;test&quot;</span></span><span class="mpre">

</span><a href="#loc_378_1_378_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_1_378_18&#39;)"><span class="mpre">caseGzipBypassPre</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_378_1_378_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_1_378_18&#39;)"><span class="hl_vardecl"><span class="mpre">caseGzipBypassPre</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Network.Wai.Test.html#loc_61_1_61_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_61_1_61_11&#39;)"><span class="hl_varref"><span class="mpre">runSession</span></span></a><span class="mpre"> </span><a href="#loc_338_1_338_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_1_338_21&#39;)"><span class="hl_varref"><span class="mpre">gzipPrecompressedApp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_379_5_379_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_5_379_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres1</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 379, srcSpanStartColumn = 22, srcSpanEndLine = 381, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 380, srcSpanStartColumn = 17, srcSpanEndLine = 380, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { requestHeaders = [(&quot;Accept-Encoding&quot;, &quot;gzip&quot;)]
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Content-Encoding&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;gzip&quot;</span></span><span class="mpre"> </span><a href="#loc_379_5_379_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_5_379_10&#39;)"><span class="hl_varref"><span class="mpre">sres1</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">assertBody</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;test&quot;</span></span><span class="mpre"> </span><a href="#loc_379_5_379_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_5_379_10&#39;)"><span class="hl_varref"><span class="mpre">sres1</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- the body is not actually compressed</span></span><span class="mpre">

</span><a href="#loc_386_1_386_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_1_386_10&#39;)"><span class="mpre">vhostApp1</span></a><span class="mpre">, </span><a href="#loc_387_1_387_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_10&#39;)"><span class="mpre">vhostApp2</span></a><span class="mpre">, </span><a href="#loc_388_1_388_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_1_388_9&#39;)"><span class="mpre">vhostApp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">
</span><a name="loc_386_1_386_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_1_386_10&#39;)"><span class="hl_fundecl"><span class="mpre">vhostApp1</span></span></a><span class="mpre"> _ </span><a name="loc_386_13_386_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_13_386_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_386_13_386_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_13_386_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre"> [] </span><span class="hl_string"><span class="mpre">&quot;app1&quot;</span></span><span class="mpre">
</span><a name="loc_387_1_387_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_10&#39;)"><span class="hl_fundecl"><span class="mpre">vhostApp2</span></span></a><span class="mpre"> _ </span><a name="loc_387_13_387_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_13_387_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_387_13_387_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_13_387_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre"> [] </span><span class="hl_string"><span class="mpre">&quot;app2&quot;</span></span><span class="mpre">
</span><a name="loc_388_1_388_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_1_388_9&#39;)"><span class="hl_vardecl"><span class="mpre">vhostApp</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Middleware.Vhost.html#loc_13_1_13_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Middleware.Vhost.html#loc_13_1_13_6&#39;)"><span class="hl_varref"><span class="mpre">vhost</span></span></a><span class="mpre">
    [ ((</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo.com&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;host&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.Wai.Internal.html#loc_36_6_36_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_36_6_36_20&#39;)"><span class="hl_varref"><span class="mpre">requestHeaders</span></span></a><span class="mpre">, </span><a href="#loc_386_1_386_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_1_386_10&#39;)"><span class="hl_varref"><span class="mpre">vhostApp1</span></span></a><span class="mpre">)
    ]
    </span><a href="#loc_387_1_387_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_10&#39;)"><span class="hl_varref"><span class="mpre">vhostApp2</span></span></a><span class="mpre">

</span><a href="#loc_394_1_394_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_10&#39;)"><span class="mpre">caseVhost</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_394_1_394_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_10&#39;)"><span class="hl_vardecl"><span class="mpre">caseVhost</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Network.Wai.Test.html#loc_61_1_61_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_61_1_61_11&#39;)"><span class="hl_varref"><span class="mpre">runSession</span></span></a><span class="mpre"> </span><a href="#loc_388_1_388_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_1_388_9&#39;)"><span class="hl_varref"><span class="mpre">vhostApp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_395_5_395_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_5_395_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres1</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 395, srcSpanStartColumn = 22, srcSpanEndLine = 397, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 396, srcSpanStartColumn = 17, srcSpanEndLine = 396, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { requestHeaders = [(&quot;Host&quot;, &quot;foo.com&quot;)]
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">assertBody</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;app1&quot;</span></span><span class="mpre"> </span><a href="#loc_395_5_395_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_5_395_10&#39;)"><span class="hl_varref"><span class="mpre">sres1</span></span></a><span class="mpre">

    </span><a name="loc_400_5_400_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_5_400_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres2</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 400, srcSpanStartColumn = 22, srcSpanEndLine = 402, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 401, srcSpanStartColumn = 17, srcSpanEndLine = 401, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { requestHeaders = [(&quot;Host&quot;, &quot;bar.com&quot;)]
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">assertBody</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;app2&quot;</span></span><span class="mpre"> </span><a href="#loc_400_5_400_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_5_400_10&#39;)"><span class="hl_varref"><span class="mpre">sres2</span></span></a><span class="mpre">

</span><a href="#loc_406_1_406_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_1_406_12&#39;)"><span class="mpre">autoheadApp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">
</span><a name="loc_406_1_406_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_1_406_12&#39;)"><span class="hl_vardecl"><span class="mpre">autoheadApp</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Middleware.Autohead.html#loc_10_1_10_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Middleware.Autohead.html#loc_10_1_10_9&#39;)"><span class="hl_varref"><span class="mpre">autohead</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ </span><a name="loc_406_29_406_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_29_406_30&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_406_29_406_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_29_406_30&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre">
    [(</span><span class="hl_string"><span class="mpre">&quot;Foo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;Bar&quot;</span></span><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;body&quot;</span></span><span class="mpre">

</span><a href="#loc_410_1_410_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_13&#39;)"><span class="mpre">caseAutohead</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_410_1_410_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_1_410_13&#39;)"><span class="hl_vardecl"><span class="mpre">caseAutohead</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Network.Wai.Test.html#loc_61_1_61_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_61_1_61_11&#39;)"><span class="hl_varref"><span class="mpre">runSession</span></span></a><span class="mpre"> </span><a href="#loc_406_1_406_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_1_406_12&#39;)"><span class="hl_varref"><span class="mpre">autoheadApp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_411_5_411_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_5_411_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres1</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 411, srcSpanStartColumn = 22, srcSpanEndLine = 413, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 412, srcSpanStartColumn = 17, srcSpanEndLine = 412, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { requestMethod = &quot;GET&quot;
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Foo&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Bar&quot;</span></span><span class="mpre"> </span><a href="#loc_411_5_411_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_5_411_10&#39;)"><span class="hl_varref"><span class="mpre">sres1</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">assertBody</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;body&quot;</span></span><span class="mpre"> </span><a href="#loc_411_5_411_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_5_411_10&#39;)"><span class="hl_varref"><span class="mpre">sres1</span></span></a><span class="mpre">

    </span><a name="loc_417_5_417_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_5_417_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres2</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 417, srcSpanStartColumn = 22, srcSpanEndLine = 419, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 418, srcSpanStartColumn = 17, srcSpanEndLine = 418, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { requestMethod = &quot;HEAD&quot;
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Foo&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Bar&quot;</span></span><span class="mpre"> </span><a href="#loc_417_5_417_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_5_417_10&#39;)"><span class="hl_varref"><span class="mpre">sres2</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_169_1_169_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_169_1_169_11&#39;)"><span class="hl_varref"><span class="mpre">assertBody</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_417_5_417_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_5_417_10&#39;)"><span class="hl_varref"><span class="mpre">sres2</span></span></a><span class="mpre">

</span><a href="#loc_424_1_424_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_1_424_6&#39;)"><span class="mpre">moApp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">
</span><a name="loc_424_1_424_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_1_424_6&#39;)"><span class="hl_vardecl"><span class="mpre">moApp</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Middleware.MethodOverride.html#loc_16_1_16_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Middleware.MethodOverride.html#loc_16_1_16_15&#39;)"><span class="hl_varref"><span class="mpre">methodOverride</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_424_27_424_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_27_424_30&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> </span><a name="loc_424_31_424_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_31_424_32&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_424_31_424_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_31_424_32&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre">
    [(</span><span class="hl_string"><span class="mpre">&quot;Method&quot;</span></span><span class="mpre">, </span><a href="Network.Wai.Internal.html#loc_22_6_22_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_22_6_22_19&#39;)"><span class="hl_varref"><span class="mpre">requestMethod</span></span></a><span class="mpre"> </span><a href="#loc_424_27_424_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_27_424_30&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">

</span><a href="#loc_428_1_428_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_19&#39;)"><span class="mpre">caseMethodOverride</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_428_1_428_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_19&#39;)"><span class="hl_vardecl"><span class="mpre">caseMethodOverride</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Network.Wai.Test.html#loc_61_1_61_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_61_1_61_11&#39;)"><span class="hl_varref"><span class="mpre">runSession</span></span></a><span class="mpre"> </span><a href="#loc_424_1_424_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_1_424_6&#39;)"><span class="hl_varref"><span class="mpre">moApp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_429_5_429_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_5_429_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres1</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 429, srcSpanStartColumn = 22, srcSpanEndLine = 432, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 430, srcSpanStartColumn = 17, srcSpanEndLine = 430, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { requestMethod = &quot;GET&quot;
                , queryString = []
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Method&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;GET&quot;</span></span><span class="mpre"> </span><a href="#loc_429_5_429_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_5_429_10&#39;)"><span class="hl_varref"><span class="mpre">sres1</span></span></a><span class="mpre">

    </span><a name="loc_435_5_435_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_5_435_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres2</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 435, srcSpanStartColumn = 22, srcSpanEndLine = 438, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 436, srcSpanStartColumn = 17, srcSpanEndLine = 436, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { requestMethod = &quot;POST&quot;
                , queryString = []
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Method&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;POST&quot;</span></span><span class="mpre"> </span><a href="#loc_435_5_435_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_5_435_10&#39;)"><span class="hl_varref"><span class="mpre">sres2</span></span></a><span class="mpre">

    </span><a name="loc_441_5_441_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_5_441_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres3</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 441, srcSpanStartColumn = 22, srcSpanEndLine = 444, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 442, srcSpanStartColumn = 17, srcSpanEndLine = 442, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { requestMethod = &quot;POST&quot;
                , queryString = [(&quot;_method&quot;, Just &quot;PUT&quot;)]
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Method&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;PUT&quot;</span></span><span class="mpre"> </span><a href="#loc_441_5_441_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_5_441_10&#39;)"><span class="hl_varref"><span class="mpre">sres3</span></span></a><span class="mpre">

</span><a href="#loc_448_1_448_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_1_448_7&#39;)"><span class="mpre">mopApp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">
</span><a name="loc_448_1_448_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_1_448_7&#39;)"><span class="hl_vardecl"><span class="mpre">mopApp</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Middleware.MethodOverridePost.html#loc_29_1_29_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Middleware.MethodOverridePost.html#loc_29_1_29_19&#39;)"><span class="hl_varref"><span class="mpre">methodOverridePost</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_448_32_448_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_32_448_35&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> </span><a name="loc_448_36_448_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_36_448_37&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_448_36_448_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_36_448_37&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre"> [(</span><span class="hl_string"><span class="mpre">&quot;Method&quot;</span></span><span class="mpre">, </span><a href="Network.Wai.Internal.html#loc_22_6_22_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_22_6_22_19&#39;)"><span class="hl_varref"><span class="mpre">requestMethod</span></span></a><span class="mpre"> </span><a href="#loc_448_32_448_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_32_448_35&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">

</span><a href="#loc_451_1_451_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_1_451_23&#39;)"><span class="mpre">caseMethodOverridePost</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_451_1_451_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_1_451_23&#39;)"><span class="hl_vardecl"><span class="mpre">caseMethodOverridePost</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Network.Wai.Test.html#loc_61_1_61_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_61_1_61_11&#39;)"><span class="hl_varref"><span class="mpre">runSession</span></span></a><span class="mpre"> </span><a href="#loc_448_1_448_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_448_1_448_7&#39;)"><span class="hl_varref"><span class="mpre">mopApp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do

    </span><span class="hl_comment"><span class="mpre">-- Get Request are unmodified</span></span><span class="mpre">
    </span><a name="loc_454_5_454_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_5_454_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres1</span></span></a><span class="mpre"> &lt;- let </span><a name="loc_454_18_454_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_18_454_19&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_236_1_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_10&#39;)"><span class="hl_varref"><span class="mpre">toRequest</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;application/x-www-form-urlencoded&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;_method=PUT&amp;foo=bar&amp;baz=bin&quot;</span></span><span class="mpre">
                 </span><span class="hl_vardecl"><span class="mpre">s</span></span><span class="mpre"> = </span><a href="Network.Wai.Test.html#loc_64_7_64_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_64_7_64_20&#39;)"><span class="hl_varref"><span class="mpre">simpleRequest</span></span></a><span class="mpre"> </span><a href="#loc_454_18_454_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_18_454_19&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
                 </span><span class="hl_vardecl"><span class="mpre">m</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 456, srcSpanStartColumn = 22, srcSpanEndLine = 456, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 456, srcSpanStartColumn = 24, srcSpanEndLine = 456, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">s { requestMethod = &quot;GET&quot; }</span></span><span class="mpre">
                 </span><a name="loc_457_18_457_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_457_18_457_19&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 457, srcSpanStartColumn = 22, srcSpanEndLine = 457, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 457, srcSpanStartColumn = 24, srcSpanEndLine = 457, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">r { simpleRequest = m }</span></span><span class="mpre">
             in </span><a href="Network.Wai.Test.html#loc_97_1_97_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_97_1_97_9&#39;)"><span class="hl_varref"><span class="mpre">srequest</span></span></a><span class="mpre"> </span><a href="#loc_457_18_457_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_457_18_457_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Method&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;GET&quot;</span></span><span class="mpre"> </span><a href="#loc_454_5_454_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_5_454_10&#39;)"><span class="hl_varref"><span class="mpre">sres1</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- Post requests are modified if _method comes first</span></span><span class="mpre">
    </span><a name="loc_462_5_462_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_5_462_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres2</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_97_1_97_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_97_1_97_9&#39;)"><span class="hl_varref"><span class="mpre">srequest</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_236_1_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_10&#39;)"><span class="hl_varref"><span class="mpre">toRequest</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;application/x-www-form-urlencoded&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;_method=PUT&amp;foo=bar&amp;baz=bin&quot;</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Method&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;PUT&quot;</span></span><span class="mpre"> </span><a href="#loc_462_5_462_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_462_5_462_10&#39;)"><span class="hl_varref"><span class="mpre">sres2</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- Post requests are unmodified if _method doesn&#39;t come first</span></span><span class="mpre">
    </span><a name="loc_466_5_466_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_5_466_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres3</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_97_1_97_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_97_1_97_9&#39;)"><span class="hl_varref"><span class="mpre">srequest</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_236_1_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_10&#39;)"><span class="hl_varref"><span class="mpre">toRequest</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;application/x-www-form-urlencoded&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo=bar&amp;_method=PUT&amp;baz=bin&quot;</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Method&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;POST&quot;</span></span><span class="mpre"> </span><a href="#loc_466_5_466_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_5_466_10&#39;)"><span class="hl_varref"><span class="mpre">sres3</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- Post requests are unmodified if Content-Type header isn&#39;t set to &quot;application/x-www-form-urlencoded&quot;</span></span><span class="mpre">
    </span><a name="loc_470_5_470_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_5_470_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres4</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_97_1_97_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_97_1_97_9&#39;)"><span class="hl_varref"><span class="mpre">srequest</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_236_1_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_10&#39;)"><span class="hl_varref"><span class="mpre">toRequest</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;text/html; charset=utf-8&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo=bar&amp;_method=PUT&amp;baz=bin&quot;</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Method&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;POST&quot;</span></span><span class="mpre"> </span><a href="#loc_470_5_470_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_5_470_10&#39;)"><span class="hl_varref"><span class="mpre">sres4</span></span></a><span class="mpre">

</span><a href="#loc_474_1_474_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_6&#39;)"><span class="mpre">aoApp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">
</span><a name="loc_474_1_474_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_6&#39;)"><span class="hl_vardecl"><span class="mpre">aoApp</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Middleware.AcceptOverride.html#loc_12_1_12_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Middleware.AcceptOverride.html#loc_12_1_12_15&#39;)"><span class="hl_varref"><span class="mpre">acceptOverride</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_474_27_474_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_27_474_30&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> </span><a name="loc_474_31_474_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_31_474_32&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_474_31_474_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_31_474_32&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre">
    [(</span><span class="hl_string"><span class="mpre">&quot;Accept&quot;</span></span><span class="mpre">, </span><a href="Data.Maybe.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">fromMaybe</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Accept&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Internal.html#loc_36_6_36_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_36_6_36_20&#39;)"><span class="hl_varref"><span class="mpre">requestHeaders</span></span></a><span class="mpre"> </span><a href="#loc_474_27_474_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_27_474_30&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">)] </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">

</span><a href="#loc_478_1_478_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_1_478_19&#39;)"><span class="mpre">caseAcceptOverride</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_478_1_478_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_1_478_19&#39;)"><span class="hl_vardecl"><span class="mpre">caseAcceptOverride</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Network.Wai.Test.html#loc_61_1_61_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_61_1_61_11&#39;)"><span class="hl_varref"><span class="mpre">runSession</span></span></a><span class="mpre"> </span><a href="#loc_474_1_474_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_1_474_6&#39;)"><span class="hl_varref"><span class="mpre">aoApp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_479_5_479_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_5_479_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres1</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 479, srcSpanStartColumn = 22, srcSpanEndLine = 482, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 480, srcSpanStartColumn = 17, srcSpanEndLine = 480, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { queryString = []
                , requestHeaders = [(&quot;Accept&quot;, &quot;foo&quot;)]
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Accept&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre"> </span><a href="#loc_479_5_479_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_5_479_10&#39;)"><span class="hl_varref"><span class="mpre">sres1</span></span></a><span class="mpre">

    </span><a name="loc_485_5_485_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_5_485_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres2</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 485, srcSpanStartColumn = 22, srcSpanEndLine = 488, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 486, srcSpanStartColumn = 17, srcSpanEndLine = 486, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { queryString = []
                , requestHeaders = [(&quot;Accept&quot;, &quot;bar&quot;)]
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Accept&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bar&quot;</span></span><span class="mpre"> </span><a href="#loc_485_5_485_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_5_485_10&#39;)"><span class="hl_varref"><span class="mpre">sres2</span></span></a><span class="mpre">

    </span><a name="loc_491_5_491_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_491_5_491_10&#39;)"><span class="hl_vardecl"><span class="mpre">sres3</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 491, srcSpanStartColumn = 22, srcSpanEndLine = 494, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 492, srcSpanStartColumn = 17, srcSpanEndLine = 492, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { queryString = [(&quot;_accept&quot;, Just &quot;baz&quot;)]
                , requestHeaders = [(&quot;Accept&quot;, &quot;bar&quot;)]
                }</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Accept&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;baz&quot;</span></span><span class="mpre"> </span><a href="#loc_491_5_491_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_491_5_491_10&#39;)"><span class="hl_varref"><span class="mpre">sres3</span></span></a><span class="mpre">

</span><a href="#loc_498_1_498_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_1_498_13&#39;)"><span class="mpre">dalvikHelper</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_498_1_498_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_1_498_13&#39;)"><span class="hl_fundecl"><span class="mpre">dalvikHelper</span></span></a><span class="mpre"> </span><a name="loc_498_14_498_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_14_498_27&#39;)"><span class="hl_vardecl"><span class="mpre">includeLength</span></span></a><span class="mpre"> = do
    let </span><a name="loc_499_9_499_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_9_499_17&#39;)"><span class="hl_vardecl"><span class="mpre">headers&#39;</span></span></a><span class="mpre"> =
            [ (</span><span class="hl_string"><span class="mpre">&quot;content-type&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;multipart/form-data;boundary=*****&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;GATEWAY_INTERFACE&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;CGI/1.1&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;PATH_INFO&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;QUERY_STRING&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;REMOTE_ADDR&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;192.168.1.115&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;REMOTE_HOST&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;ganjizza&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;REQUEST_URI&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;http://192.168.1.115:3000/&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;REQUEST_METHOD&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;POST&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;HTTP_CONNECTION&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;Keep-Alive&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;HTTP_COOKIE&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;_SESSION=fgUGM5J/k6mGAAW+MMXIJZCJHobw/oEbb6T17KQN0p9yNqiXn/m/ACrsnRjiCEgqtG4fogMUDI+jikoFGcwmPjvuD5d+MDz32iXvDdDJsFdsFMfivuey2H+n6IF6yFGD&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;HTTP_USER_AGENT&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;Dalvik/1.1.0 (Linux; U; Android 2.1-update1; sdk Build/ECLAIR)&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;HTTP_HOST&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;192.168.1.115:3000&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;HTTP_ACCEPT&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;*, */*&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;HTTP_VERSION&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;HTTP/1.1&quot;</span></span><span class="mpre">)
            , (</span><span class="hl_string"><span class="mpre">&quot;REQUEST_PATH&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">)
            ]
        </span><span class="hl_vardecl"><span class="mpre">headers</span></span><span class="mpre">
            | </span><a href="#loc_498_14_498_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_14_498_27&#39;)"><span class="hl_varref"><span class="mpre">includeLength</span></span></a><span class="mpre"> = (</span><span class="hl_string"><span class="mpre">&quot;content-length&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;12098&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_499_9_499_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_9_499_17&#39;)"><span class="hl_varref"><span class="mpre">headers&#39;</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_499_9_499_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_9_499_17&#39;)"><span class="hl_varref"><span class="mpre">headers&#39;</span></span></a><span class="mpre">
    let </span><a name="loc_519_9_519_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_9_519_17&#39;)"><span class="hl_vardecl"><span class="mpre">request&#39;</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 519, srcSpanStartColumn = 20, srcSpanEndLine = 521, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 520, srcSpanStartColumn = 13, srcSpanEndLine = 520, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
            { requestHeaders = headers
            }</span></span><span class="mpre">
    (</span><a name="loc_522_6_522_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_6_522_12&#39;)"><span class="hl_vardecl"><span class="mpre">params</span></span></a><span class="mpre">, </span><a name="loc_522_14_522_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_14_522_19&#39;)"><span class="hl_vardecl"><span class="mpre">files</span></span></a><span class="mpre">) &lt;-
        case </span><a href="Network.Wai.Parse.html#loc_142_1_142_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_142_1_142_19&#39;)"><span class="hl_varref"><span class="mpre">getRequestBodyType</span></span></a><span class="mpre"> </span><a href="#loc_519_9_519_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_9_519_17&#39;)"><span class="hl_varref"><span class="mpre">request&#39;</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> ([], [])
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_525_18_525_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_18_525_21&#39;)"><span class="hl_vardecl"><span class="mpre">rbt</span></span></a><span class="mpre"> -&gt; </span><a href="System.IO.html#loc_390_1_390_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_390_1_390_9&#39;)"><span class="hl_varref"><span class="mpre">withFile</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;test/requests/dalvik-request&quot;</span></span><span class="mpre"> </span><a href="GHC.IO.IOMode.html#loc_28_21_28_29" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_21_28_29&#39;)"><span class="hl_conref"><span class="mpre">ReadMode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_525_77_525_78" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_77_525_78&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> -&gt;
                </span><a href="Network.Wai.Parse.html#loc_186_1_186_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_186_1_186_16&#39;)"><span class="hl_varref"><span class="mpre">sinkRequestBody</span></span></a><span class="mpre"> </span><a href="Network.Wai.Parse.html#loc_80_1_80_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Parse.html#loc_80_1_80_11&#39;)"><span class="hl_varref"><span class="mpre">lbsBackEnd</span></span></a><span class="mpre"> </span><a href="#loc_525_18_525_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_18_525_21&#39;)"><span class="hl_varref"><span class="mpre">rbt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.hGetSome</span></span><span class="mpre"> </span><a href="#loc_525_77_525_78" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_77_525_78&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2048</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;scannedTime&quot;</span></span><span class="mpre"> </span><a href="#loc_522_6_522_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_6_522_12&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">@?=</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;1.298590056748E9&quot;</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;geoLong&quot;</span></span><span class="mpre"> </span><a href="#loc_522_6_522_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_6_522_12&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">@?=</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;0&quot;</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;geoLat&quot;</span></span><span class="mpre"> </span><a href="#loc_522_6_522_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_6_522_12&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">@?=</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;0&quot;</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_522_14_522_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_522_14_522_19&#39;)"><span class="hl_varref"><span class="mpre">files</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">@?=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">

</span><a href="#loc_533_1_533_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_1_533_21&#39;)"><span class="mpre">caseDebugRequestBody</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">
</span><a name="loc_533_1_533_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_1_533_21&#39;)"><span class="hl_vardecl"><span class="mpre">caseDebugRequestBody</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Network.Wai.Test.html#loc_61_1_61_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_61_1_61_11&#39;)"><span class="hl_varref"><span class="mpre">runSession</span></span></a><span class="mpre"> (</span><a href="#loc_554_5_554_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_5_554_13&#39;)"><span class="hl_varref"><span class="mpre">debugApp</span></span></a><span class="mpre"> </span><a href="#loc_551_5_551_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_5_551_15&#39;)"><span class="hl_varref"><span class="mpre">postOutput</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        let </span><a name="loc_535_13_535_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_13_535_16&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> = </span><a href="#loc_236_1_236_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_10&#39;)"><span class="hl_varref"><span class="mpre">toRequest</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;application/x-www-form-urlencoded&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo=bar&amp;baz=bin&quot;</span></span><span class="mpre">
        </span><a name="loc_536_9_536_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_9_536_12&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Test.html#loc_97_1_97_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_97_1_97_9&#39;)"><span class="hl_varref"><span class="mpre">srequest</span></span></a><span class="mpre"> </span><a href="#loc_535_13_535_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_13_535_16&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">
        </span><a href="Network.Wai.Test.html#loc_159_1_159_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_159_1_159_13&#39;)"><span class="hl_varref"><span class="mpre">assertStatus</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">200</span></span><span class="mpre"> </span><a href="#loc_536_9_536_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_9_536_12&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">

    let </span><span class="hl_vardecl"><span class="mpre">qs</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;?foo=bar&amp;baz=bin&quot;</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Network.Wai.Test.html#loc_61_1_61_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_61_1_61_11&#39;)"><span class="hl_varref"><span class="mpre">runSession</span></span></a><span class="mpre"> (</span><a href="#loc_554_5_554_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_5_554_13&#39;)"><span class="hl_varref"><span class="mpre">debugApp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_552_5_552_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_5_552_14&#39;)"><span class="hl_varref"><span class="mpre">getOutput</span></span></a><span class="mpre"> </span><a href="#loc_549_5_549_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_5_549_11&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a href="Network.Wai.Test.html#loc_159_1_159_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_159_1_159_13&#39;)"><span class="hl_varref"><span class="mpre">assertStatus</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">200</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 541, srcSpanStartColumn = 38, srcSpanEndLine = 547, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 542, srcSpanStartColumn = 17, srcSpanEndLine = 542, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">defaultRequest
                { requestMethod = &quot;GET&quot;
                , queryString = map (\(k,v) -&gt; (k, Just v)) params
                , rawQueryString = qs
                , requestHeaders = []
                , rawPathInfo = &quot;/location&quot;
                }</span></span><span class="mpre">
  where
    </span><a name="loc_549_5_549_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_5_549_11&#39;)"><span class="hl_vardecl"><span class="mpre">params</span></span></a><span class="mpre"> = [(</span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bar&quot;</span></span><span class="mpre">), (</span><span class="hl_string"><span class="mpre">&quot;baz&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;bin&quot;</span></span><span class="mpre">)]
    </span><span class="hl_comment"><span class="mpre">-- FIXME change back once we include post parameter output in logging postOutput = T.pack $ &quot;POST \nAccept: \nPOST &quot; ++ (show params)</span></span><span class="mpre">
    </span><a name="loc_551_5_551_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_551_5_551_15&#39;)"><span class="hl_vardecl"><span class="mpre">postOutput</span></span></a><span class="mpre"> = </span><a href="Data.Text.Lazy.html#loc_348_1_348_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.html#loc_348_1_348_5&#39;)"><span class="hl_varref"><span class="mpre">T.pack</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;POST / :: \nStatus: 200 OK. /\n&quot;</span></span><span class="mpre">
    </span><a name="loc_552_5_552_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_5_552_14&#39;)"><span class="hl_fundecl"><span class="mpre">getOutput</span></span></a><span class="mpre"> </span><a name="loc_552_15_552_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_15_552_22&#39;)"><span class="hl_vardecl"><span class="mpre">params&#39;</span></span></a><span class="mpre"> = </span><a href="Data.Text.Lazy.html#loc_348_1_348_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.html#loc_348_1_348_5&#39;)"><span class="hl_varref"><span class="mpre">T.pack</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;GET /location :: \nGET &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_552_15_552_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_552_15_552_22&#39;)"><span class="hl_varref"><span class="mpre">params&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\nStatus: 200 OK. /location\n&quot;</span></span><span class="mpre">

    </span><a name="loc_554_5_554_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_5_554_13&#39;)"><span class="hl_fundecl"><span class="mpre">debugApp</span></span></a><span class="mpre"> </span><a name="loc_554_14_554_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_14_554_21&#39;)"><span class="hl_vardecl"><span class="mpre">output&#39;</span></span></a><span class="mpre"> </span><a name="loc_554_22_554_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_22_554_25&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> </span><a name="loc_554_26_554_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_26_554_30&#39;)"><span class="hl_vardecl"><span class="mpre">send</span></span></a><span class="mpre"> = do
        </span><a name="loc_555_9_555_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_9_555_16&#39;)"><span class="hl_vardecl"><span class="mpre">iactual</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">I.newIORef</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
        </span><a name="loc_556_9_556_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_9_556_19&#39;)"><span class="hl_vardecl"><span class="mpre">middleware</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Middleware.RequestLogger.html#loc_79_1_79_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Middleware.RequestLogger.html#loc_79_1_79_16&#39;)"><span class="hl_varref"><span class="mpre">mkRequestLogger</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 556, srcSpanStartColumn = 39, srcSpanEndLine = 559, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, srcSpanStartLine = 557, srcSpanStartColumn = 13, srcSpanEndLine = 557, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/test/WaiExtraTest.hs&quot;, s"><span class="mpre">def
            { destination = Callback $ \strs -&gt; I.modifyIORef iactual $ (`mappend` strs)
            , outputFormat = Detailed False
            }</span></span><span class="mpre">
        </span><a name="loc_560_9_560_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_9_560_12&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_556_9_556_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_556_9_556_19&#39;)"><span class="hl_varref"><span class="mpre">middleware</span></span></a><span class="mpre"> (\</span><span class="hl_vardecl"><span class="mpre">_req</span></span><span class="mpre"> </span><a name="loc_560_34_560_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_34_560_35&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_560_34_560_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_34_560_35&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre"> [ ] </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">) </span><a href="#loc_554_22_554_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_22_554_25&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre"> </span><a href="#loc_554_26_554_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_26_554_30&#39;)"><span class="hl_varref"><span class="mpre">send</span></span></a><span class="mpre">
        </span><a name="loc_561_9_561_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_9_561_15&#39;)"><span class="hl_vardecl"><span class="mpre">actual</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">I.readIORef</span></span></a><span class="mpre"> </span><a href="#loc_555_9_555_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_555_9_555_16&#39;)"><span class="hl_varref"><span class="mpre">iactual</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;debug&quot;</span></span><span class="mpre"> </span><a href="#loc_565_9_565_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_9_565_15&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_567_9_567_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_9_567_16&#39;)"><span class="hl_varref"><span class="mpre">logToBs</span></span></a><span class="mpre"> </span><a href="#loc_561_9_561_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_9_561_15&#39;)"><span class="hl_varref"><span class="mpre">actual</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_560_9_560_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_560_9_560_12&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">
      where
        </span><a name="loc_565_9_565_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_9_565_15&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">TE.encodeUtf8</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Text.Lazy.html#loc_393_1_393_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.html#loc_393_1_393_9&#39;)"><span class="hl_varref"><span class="mpre">T.toStrict</span></span></a><span class="mpre"> </span><a href="#loc_554_14_554_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_14_554_21&#39;)"><span class="hl_varref"><span class="mpre">output&#39;</span></span></a><span class="mpre">

        </span><a name="loc_567_9_567_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_9_567_16&#39;)"><span class="hl_vardecl"><span class="mpre">logToBs</span></span></a><span class="mpre"> = </span><a href="System.Log.FastLogger.LogStr.html#loc_90_1_90_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Log.FastLogger.LogStr.html#loc_90_1_90_11&#39;)"><span class="hl_varref"><span class="mpre">fromLogStr</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">{-debugApp = debug $ \req -&gt; do-}</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">{-return $ responseLBS status200 [ ] &quot;&quot;-}</span></span><span class="mpre">

</span><a href="#loc_573_1_573_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_1_573_14&#39;)"><span class="mpre">urlMapTestApp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">
</span><a name="loc_573_1_573_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_1_573_14&#39;)"><span class="hl_vardecl"><span class="mpre">urlMapTestApp</span></span></a><span class="mpre"> = </span><a href="Network.Wai.UrlMap.html#loc_104_1_104_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.UrlMap.html#loc_104_1_104_8&#39;)"><span class="hl_varref"><span class="mpre">mapUrls</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><a href="Network.Wai.UrlMap.html#loc_64_1_64_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.UrlMap.html#loc_64_1_64_6&#39;)"><span class="hl_varref"><span class="mpre">mount</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bugs&quot;</span></span><span class="mpre">     </span><a href="#loc_595_3_595_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_595_3_595_10&#39;)"><span class="hl_varref"><span class="mpre">bugsApp</span></span></a><span class="mpre">
    </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Network.Wai.UrlMap.html#loc_64_1_64_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.UrlMap.html#loc_64_1_64_6&#39;)"><span class="hl_varref"><span class="mpre">mount</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;helpdesk&quot;</span></span><span class="mpre"> </span><a href="#loc_596_3_596_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_3_596_14&#39;)"><span class="hl_varref"><span class="mpre">helpdeskApp</span></span></a><span class="mpre">
    </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Network.Wai.UrlMap.html#loc_64_1_64_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.UrlMap.html#loc_64_1_64_6&#39;)"><span class="hl_varref"><span class="mpre">mount</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;api&quot;</span></span><span class="mpre">
            (   </span><a href="Network.Wai.UrlMap.html#loc_64_1_64_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.UrlMap.html#loc_64_1_64_6&#39;)"><span class="hl_varref"><span class="mpre">mount</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;v1&quot;</span></span><span class="mpre"> </span><a href="#loc_597_3_597_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_3_597_8&#39;)"><span class="hl_varref"><span class="mpre">apiV1</span></span></a><span class="mpre">
            </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Network.Wai.UrlMap.html#loc_64_1_64_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.UrlMap.html#loc_64_1_64_6&#39;)"><span class="hl_varref"><span class="mpre">mount</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;v2&quot;</span></span><span class="mpre"> </span><a href="#loc_598_3_598_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_3_598_8&#39;)"><span class="hl_varref"><span class="mpre">apiV2</span></span></a><span class="mpre">
            )
    </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a href="Network.Wai.UrlMap.html#loc_69_1_69_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.UrlMap.html#loc_69_1_69_10&#39;)"><span class="hl_varref"><span class="mpre">mountRoot</span></span></a><span class="mpre"> </span><a href="#loc_599_3_599_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_3_599_10&#39;)"><span class="hl_varref"><span class="mpre">mainApp</span></span></a><span class="mpre">

  where
  </span><a href="#loc_584_3_584_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_3_584_13&#39;)"><span class="mpre">trivialApp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">
  </span><a name="loc_584_3_584_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_3_584_13&#39;)"><span class="hl_fundecl"><span class="mpre">trivialApp</span></span></a><span class="mpre"> </span><a name="loc_584_14_584_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_14_584_18&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_584_19_584_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_19_584_22&#39;)"><span class="hl_vardecl"><span class="mpre">req</span></span></a><span class="mpre"> </span><a name="loc_584_23_584_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_23_584_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =
    </span><a href="#loc_584_23_584_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_23_584_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
      </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre">
        </span><a href="Network.HTTP.Types.Status.html#loc_193_1_193_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_193_1_193_10&#39;)"><span class="hl_varref"><span class="mpre">status200</span></span></a><span class="mpre">
        [ (</span><span class="hl_string"><span class="mpre">&quot;content-type&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;text/plain&quot;</span></span><span class="mpre">)
        , (</span><span class="hl_string"><span class="mpre">&quot;X-pathInfo&quot;</span></span><span class="mpre">,    </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.Wai.Internal.html#loc_50_6_50_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_50_6_50_14&#39;)"><span class="hl_varref"><span class="mpre">pathInfo</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_584_19_584_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_19_584_22&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">)
        , (</span><span class="hl_string"><span class="mpre">&quot;X-rawPathInfo&quot;</span></span><span class="mpre">, </span><a href="Network.Wai.Internal.html#loc_30_6_30_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_30_6_30_17&#39;)"><span class="hl_varref"><span class="mpre">rawPathInfo</span></span></a><span class="mpre"> </span><a href="#loc_584_19_584_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_19_584_22&#39;)"><span class="hl_varref"><span class="mpre">req</span></span></a><span class="mpre">)
        , (</span><span class="hl_string"><span class="mpre">&quot;X-appName&quot;</span></span><span class="mpre">,     </span><a href="#loc_584_14_584_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_14_584_18&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">)
        ]
        </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">

  </span><a name="loc_595_3_595_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_595_3_595_10&#39;)"><span class="hl_vardecl"><span class="mpre">bugsApp</span></span></a><span class="mpre">     = </span><a href="#loc_584_3_584_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_3_584_13&#39;)"><span class="hl_varref"><span class="mpre">trivialApp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bugs&quot;</span></span><span class="mpre">
  </span><a name="loc_596_3_596_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_3_596_14&#39;)"><span class="hl_vardecl"><span class="mpre">helpdeskApp</span></span></a><span class="mpre"> = </span><a href="#loc_584_3_584_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_3_584_13&#39;)"><span class="hl_varref"><span class="mpre">trivialApp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;helpdesk&quot;</span></span><span class="mpre">
  </span><a name="loc_597_3_597_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_3_597_8&#39;)"><span class="hl_vardecl"><span class="mpre">apiV1</span></span></a><span class="mpre">       = </span><a href="#loc_584_3_584_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_3_584_13&#39;)"><span class="hl_varref"><span class="mpre">trivialApp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;apiv1&quot;</span></span><span class="mpre">
  </span><a name="loc_598_3_598_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_598_3_598_8&#39;)"><span class="hl_vardecl"><span class="mpre">apiV2</span></span></a><span class="mpre">       = </span><a href="#loc_584_3_584_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_3_584_13&#39;)"><span class="hl_varref"><span class="mpre">trivialApp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;apiv2&quot;</span></span><span class="mpre">
  </span><a name="loc_599_3_599_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_599_3_599_10&#39;)"><span class="hl_vardecl"><span class="mpre">mainApp</span></span></a><span class="mpre">     = </span><a href="#loc_584_3_584_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_3_584_13&#39;)"><span class="hl_varref"><span class="mpre">trivialApp</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;main&quot;</span></span><span class="mpre">

</span><a href="#loc_602_1_602_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_602_1_602_12&#39;)"><span class="mpre">casesUrlMap</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Assertion</span></span><span class="mpre">)]
</span><a name="loc_602_1_602_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_602_1_602_12&#39;)"><span class="hl_vardecl"><span class="mpre">casesUrlMap</span></span></a><span class="mpre"> = [</span><a href="#loc_608_3_608_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_608_3_608_8&#39;)"><span class="hl_varref"><span class="mpre">pair1</span></span></a><span class="mpre">, </span><a href="#loc_615_3_615_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_615_3_615_8&#39;)"><span class="hl_varref"><span class="mpre">pair2</span></span></a><span class="mpre">, </span><a href="#loc_622_3_622_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_622_3_622_8&#39;)"><span class="hl_varref"><span class="mpre">pair3</span></span></a><span class="mpre">, </span><a href="#loc_628_3_628_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_3_628_8&#39;)"><span class="hl_varref"><span class="mpre">pair4</span></span></a><span class="mpre">]
  where
  </span><a name="loc_604_3_604_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_604_3_604_11&#39;)"><span class="hl_fundecl"><span class="mpre">makePair</span></span></a><span class="mpre"> </span><a name="loc_604_12_604_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_604_12_604_16&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_604_17_604_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_604_17_604_24&#39;)"><span class="hl_vardecl"><span class="mpre">session</span></span></a><span class="mpre"> = (</span><a href="#loc_604_12_604_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_604_12_604_16&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">, </span><a href="Network.Wai.Test.html#loc_61_1_61_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_61_1_61_11&#39;)"><span class="hl_varref"><span class="mpre">runSession</span></span></a><span class="mpre"> </span><a href="#loc_604_17_604_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_604_17_604_24&#39;)"><span class="hl_varref"><span class="mpre">session</span></span></a><span class="mpre"> </span><a href="#loc_573_1_573_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_573_1_573_14&#39;)"><span class="hl_varref"><span class="mpre">urlMapTestApp</span></span></a><span class="mpre">)
  </span><a name="loc_605_3_605_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_3_605_6&#39;)"><span class="hl_fundecl"><span class="mpre">get</span></span></a><span class="mpre"> </span><a name="loc_605_7_605_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_7_605_14&#39;)"><span class="hl_vardecl"><span class="mpre">reqPath</span></span></a><span class="mpre"> = </span><a href="Network.Wai.Test.html#loc_74_1_74_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_74_1_74_8&#39;)"><span class="hl_varref"><span class="mpre">request</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.Test.html#loc_78_1_78_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_78_1_78_8&#39;)"><span class="hl_varref"><span class="mpre">setPath</span></span></a><span class="mpre"> </span><a href="Network.Wai.html#loc_264_1_264_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_264_1_264_15&#39;)"><span class="hl_varref"><span class="mpre">defaultRequest</span></span></a><span class="mpre"> </span><a href="#loc_605_7_605_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_7_605_14&#39;)"><span class="hl_varref"><span class="mpre">reqPath</span></span></a><span class="mpre">
  </span><a name="loc_606_3_606_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_3_606_4&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S8.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> :: [</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">TS.Text</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">

  </span><a name="loc_608_3_608_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_608_3_608_8&#39;)"><span class="hl_vardecl"><span class="mpre">pair1</span></span></a><span class="mpre"> = </span><a href="#loc_604_3_604_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_604_3_604_11&#39;)"><span class="hl_varref"><span class="mpre">makePair</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;should mount root&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_609_5_609_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_609_5_609_9&#39;)"><span class="hl_vardecl"><span class="mpre">res1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_605_3_605_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_3_605_6&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_159_1_159_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_159_1_159_13&#39;)"><span class="hl_varref"><span class="mpre">assertStatus</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">200</span></span><span class="mpre"> </span><a href="#loc_609_5_609_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_609_5_609_9&#39;)"><span class="hl_varref"><span class="mpre">res1</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;X-rawPathInfo&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">    </span><a href="#loc_609_5_609_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_609_5_609_9&#39;)"><span class="hl_varref"><span class="mpre">res1</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;X-pathInfo&quot;</span></span><span class="mpre">    (</span><a href="#loc_606_3_606_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_3_606_4&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> []) </span><a href="#loc_609_5_609_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_609_5_609_9&#39;)"><span class="hl_varref"><span class="mpre">res1</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;X-appName&quot;</span></span><span class="mpre">     </span><span class="hl_string"><span class="mpre">&quot;main&quot;</span></span><span class="mpre"> </span><a href="#loc_609_5_609_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_609_5_609_9&#39;)"><span class="hl_varref"><span class="mpre">res1</span></span></a><span class="mpre">

  </span><a name="loc_615_3_615_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_615_3_615_8&#39;)"><span class="hl_vardecl"><span class="mpre">pair2</span></span></a><span class="mpre"> = </span><a href="#loc_604_3_604_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_604_3_604_11&#39;)"><span class="hl_varref"><span class="mpre">makePair</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;should mount apps&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_616_5_616_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_616_5_616_9&#39;)"><span class="hl_vardecl"><span class="mpre">res2</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_605_3_605_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_3_605_6&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/bugs&quot;</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_159_1_159_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_159_1_159_13&#39;)"><span class="hl_varref"><span class="mpre">assertStatus</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">200</span></span><span class="mpre"> </span><a href="#loc_616_5_616_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_616_5_616_9&#39;)"><span class="hl_varref"><span class="mpre">res2</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;X-rawPathInfo&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/&quot;</span></span><span class="mpre">    </span><a href="#loc_616_5_616_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_616_5_616_9&#39;)"><span class="hl_varref"><span class="mpre">res2</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;X-pathInfo&quot;</span></span><span class="mpre">    (</span><a href="#loc_606_3_606_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_3_606_4&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> []) </span><a href="#loc_616_5_616_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_616_5_616_9&#39;)"><span class="hl_varref"><span class="mpre">res2</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;X-appName&quot;</span></span><span class="mpre">     </span><span class="hl_string"><span class="mpre">&quot;bugs&quot;</span></span><span class="mpre"> </span><a href="#loc_616_5_616_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_616_5_616_9&#39;)"><span class="hl_varref"><span class="mpre">res2</span></span></a><span class="mpre">

  </span><a name="loc_622_3_622_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_622_3_622_8&#39;)"><span class="hl_vardecl"><span class="mpre">pair3</span></span></a><span class="mpre"> = </span><a href="#loc_604_3_604_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_604_3_604_11&#39;)"><span class="hl_varref"><span class="mpre">makePair</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;should preserve extra path info&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_623_5_623_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_5_623_9&#39;)"><span class="hl_vardecl"><span class="mpre">res3</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_605_3_605_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_3_605_6&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/helpdesk/issues/11&quot;</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_159_1_159_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_159_1_159_13&#39;)"><span class="hl_varref"><span class="mpre">assertStatus</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">200</span></span><span class="mpre"> </span><a href="#loc_623_5_623_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_5_623_9&#39;)"><span class="hl_varref"><span class="mpre">res3</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;X-rawPathInfo&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/issues/11&quot;</span></span><span class="mpre">         </span><a href="#loc_623_5_623_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_5_623_9&#39;)"><span class="hl_varref"><span class="mpre">res3</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_187_1_187_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_187_1_187_13&#39;)"><span class="hl_varref"><span class="mpre">assertHeader</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;X-pathInfo&quot;</span></span><span class="mpre">    (</span><a href="#loc_606_3_606_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_606_3_606_4&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;issues&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;11&quot;</span></span><span class="mpre">]) </span><a href="#loc_623_5_623_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_5_623_9&#39;)"><span class="hl_varref"><span class="mpre">res3</span></span></a><span class="mpre">

  </span><a name="loc_628_3_628_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_3_628_8&#39;)"><span class="hl_vardecl"><span class="mpre">pair4</span></span></a><span class="mpre"> = </span><a href="#loc_604_3_604_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_604_3_604_11&#39;)"><span class="hl_varref"><span class="mpre">makePair</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;should 404 if none match&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_629_5_629_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_5_629_9&#39;)"><span class="hl_vardecl"><span class="mpre">res4</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_605_3_605_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_3_605_6&#39;)"><span class="hl_varref"><span class="mpre">get</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/api/v3&quot;</span></span><span class="mpre">
    </span><a href="Network.Wai.Test.html#loc_159_1_159_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Test.html#loc_159_1_159_13&#39;)"><span class="hl_varref"><span class="mpre">assertStatus</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">404</span></span><span class="mpre"> </span><a href="#loc_629_5_629_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_5_629_9&#39;)"><span class="hl_varref"><span class="mpre">res4</span></span></a><span class="mpre">
</span></div></body></html>