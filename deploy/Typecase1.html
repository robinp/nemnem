<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS -fglasgow-exts #-}

module Typecase1 (tests) where

</span><span class="hl_comment"><span class="mpre">{-

This test demonstrates type case as it lives in Data.Typeable.
We define a function f that converts typeables into strings in some way.
Note: we only need Data.Typeable. Say: Dynamics are NOT involved.

-}</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Typecase1.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 8, srcSpanEndLine = 13, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">

import Data.Typeable
import Data.Maybe

</span><span class="hl_comment"><span class="mpre">-- Some datatype.</span></span><span class="mpre">
data </span><a name="loc_19_6_19_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_6_19_16&#39;)"><span class="hl_tycondecl"><span class="mpre">MyTypeable</span></span></a><span class="mpre"> = </span><a name="loc_19_19_19_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_19_19_25&#39;)"><span class="hl_condecl"><span class="mpre">MyCons</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Typecase1.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 33, srcSpanEndLine = 19, srcSpanEndColumn = 58}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Typecase1.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 33, srcSpanEndLine = 19, srcSpanEndColumn = 41},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Typecase1.hs&quot;, srcSpanStartLine = 19, srcSpanStartC"><span class="mpre">deriving (Show, Typeable)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Some function that performs type case.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_25_1_25_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_2&#39;)"><span class="mpre">f</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Typecase1.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 6, srcSpanEndLine = 24, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Typecase1.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 6, srcSpanEndLine = 24, srcSpanEndColumn = 7},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Typecase1.hs&quot;, srcSpanStartLine = 24, srcSpanStartColum"><span class="mpre">(Show a, Typeable a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_25_1_25_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_2&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_25_3_25_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_3_25_4&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = (</span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><a href="#loc_45_3_45_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_3_45_9&#39;)"><span class="hl_varref"><span class="mpre">others</span></span></a><span class="mpre"> 
                      </span><a href="#loc_42_3_42_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_3_42_8&#39;)"><span class="hl_varref"><span class="mpre">mytys</span></span></a><span class="mpre"> (</span><a href="Data.Typeable.html#loc_112_1_112_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Typeable.html#loc_112_1_112_5&#39;)"><span class="hl_varref"><span class="mpre">cast</span></span></a><span class="mpre"> </span><a href="#loc_25_3_25_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_3_25_4&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) )
                      </span><a href="#loc_38_3_38_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_3_38_8&#39;)"><span class="hl_varref"><span class="mpre">float</span></span></a><span class="mpre"> (</span><a href="Data.Typeable.html#loc_112_1_112_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Typeable.html#loc_112_1_112_5&#39;)"><span class="hl_varref"><span class="mpre">cast</span></span></a><span class="mpre"> </span><a href="#loc_25_3_25_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_3_25_4&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) )
                      </span><a href="#loc_34_3_34_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_3_34_6&#39;)"><span class="hl_varref"><span class="mpre">int</span></span></a><span class="mpre">   (</span><a href="Data.Typeable.html#loc_112_1_112_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Typeable.html#loc_112_1_112_5&#39;)"><span class="hl_varref"><span class="mpre">cast</span></span></a><span class="mpre"> </span><a href="#loc_25_3_25_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_3_25_4&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) )

 where

  </span><span class="hl_comment"><span class="mpre">-- do something with ints</span></span><span class="mpre">
  </span><a href="#loc_34_3_34_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_3_34_6&#39;)"><span class="mpre">int</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
  </span><a name="loc_34_3_34_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_3_34_6&#39;)"><span class="hl_fundecl"><span class="mpre">int</span></span></a><span class="mpre"> </span><a name="loc_34_7_34_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_8&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> =  </span><span class="hl_string"><span class="mpre">&quot;got an int, incremented: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_34_7_34_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_7_34_8&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
  
  </span><span class="hl_comment"><span class="mpre">-- do something with floats</span></span><span class="mpre">
  </span><a href="#loc_38_3_38_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_3_38_8&#39;)"><span class="mpre">float</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
  </span><a name="loc_38_3_38_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_3_38_8&#39;)"><span class="hl_fundecl"><span class="mpre">float</span></span></a><span class="mpre"> </span><a name="loc_38_9_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;got a float, multiplied by .42: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_38_9_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0.42</span></span><span class="mpre">)

  </span><span class="hl_comment"><span class="mpre">-- do something with my typeables</span></span><span class="mpre">
  </span><a href="#loc_42_3_42_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_3_42_8&#39;)"><span class="mpre">mytys</span></a><span class="mpre"> :: </span><a href="#loc_19_6_19_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_6_19_16&#39;)"><span class="hl_tyconref"><span class="mpre">MyTypeable</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
  </span><a name="loc_42_3_42_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_3_42_8&#39;)"><span class="hl_fundecl"><span class="mpre">mytys</span></span></a><span class="mpre"> </span><a name="loc_42_9_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;got a term: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_42_9_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_9_42_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- do something with all other typeables</span></span><span class="mpre">
  </span><a name="loc_45_3_45_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_3_45_9&#39;)"><span class="hl_vardecl"><span class="mpre">others</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;got something else: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_25_3_25_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_3_25_4&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Test the type case</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a name="loc_51_1_51_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = ( </span><a href="#loc_25_1_25_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_2&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">41</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
        , </span><a href="#loc_25_1_25_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_2&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">88</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre">)
        , </span><a href="#loc_25_1_25_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_2&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_19_19_19_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_19_19_25&#39;)"><span class="hl_conref"><span class="mpre">MyCons</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;42&quot;</span></span><span class="mpre">)
        , </span><a href="#loc_25_1_25_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_2&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">~=?</span></span><span class="mpre"> </span><a href="#loc_56_1_56_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_7&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">

</span><a name="loc_56_1_56_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_7&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = ( </span><span class="hl_string"><span class="mpre">&quot;got an int, incremented: 42&quot;</span></span><span class="mpre">
         , </span><span class="hl_string"><span class="mpre">&quot;got a float, multiplied by .42: 36.96&quot;</span></span><span class="mpre">
         , </span><span class="hl_string"><span class="mpre">&quot;got a term: MyCons \&quot;42\&quot;&quot;</span></span><span class="mpre">
         , </span><span class="hl_string"><span class="mpre">&quot;got something else: True&quot;</span></span><span class="mpre">)</span></div></body></html>