<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.PubKey.RSA.Prim</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Good</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Crypto.PubKey.RSA.Prim
    (
    </span><span class="hl_comment"><span class="mpre">-- * decrypt primitive</span></span><span class="mpre">
      dp
    </span><span class="hl_comment"><span class="mpre">-- * encrypt primitive</span></span><span class="mpre">
    , ep
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-pubkey-0.2.4/Crypto/PubKey/RSA/Prim.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 8, srcSpanEndLine = 16, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import Crypto.PubKey.RSA.Types (</span><a href="Crypto.PubKey.RSA.Types.html#loc_15_6_15_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_15_6_15_13&#39;)"><span class="mpre">Blinder</span></a><span class="mpre">(..))
import Crypto.Types.PubKey.RSA
import Crypto.Number.ModArithmetic (</span><a href="Crypto.Number.ModArithmetic.html#loc_76_1_76_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_76_1_76_8&#39;)"><span class="mpre">expFast</span></a><span class="mpre">, </span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="mpre">expSafe</span></a><span class="mpre">)
import Crypto.Number.Serialize (</span><a href="Crypto.Number.Serialize.html#loc_49_1_49_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_49_1_49_6&#39;)"><span class="mpre">os2ip</span></a><span class="mpre">, </span><a href="Crypto.Number.Serialize.html#loc_103_1_103_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_103_1_103_9&#39;)"><span class="mpre">i2ospOf_</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">{- dpSlow computes the decrypted message not using any precomputed cache value.
   only n and d need to valid. -}</span></span><span class="mpre">
</span><a href="#loc_25_1_25_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_7&#39;)"><span class="mpre">dpSlow</span></a><span class="mpre"> :: </span><a href="Crypto.Types.PubKey.RSA.html#loc_60_6_60_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_60_6_60_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_25_1_25_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_7&#39;)"><span class="hl_fundecl"><span class="mpre">dpSlow</span></span></a><span class="mpre"> </span><a name="loc_25_8_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_8_25_10&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_25_11_25_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_11_25_12&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.Serialize.html#loc_103_1_103_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_103_1_103_9&#39;)"><span class="hl_varref"><span class="mpre">i2ospOf_</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_71_1_71_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_71_1_71_13&#39;)"><span class="hl_varref"><span class="mpre">private_size</span></span></a><span class="mpre"> </span><a href="#loc_25_8_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_8_25_10&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="hl_varref"><span class="mpre">expSafe</span></span></a><span class="mpre"> (</span><a href="Crypto.Number.Serialize.html#loc_49_1_49_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_49_1_49_6&#39;)"><span class="hl_varref"><span class="mpre">os2ip</span></span></a><span class="mpre"> </span><a href="#loc_25_11_25_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_11_25_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.RSA.html#loc_62_7_62_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_62_7_62_16&#39;)"><span class="hl_varref"><span class="mpre">private_d</span></span></a><span class="mpre"> </span><a href="#loc_25_8_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_8_25_10&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.RSA.html#loc_74_1_74_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_74_1_74_10&#39;)"><span class="hl_varref"><span class="mpre">private_n</span></span></a><span class="mpre"> </span><a href="#loc_25_8_25_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_8_25_10&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">{- dpFast computes the decrypted message more efficiently if the
   precomputed private values are available. mod p and mod q are faster
   to compute than mod pq -}</span></span><span class="mpre">
</span><a href="#loc_31_1_31_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_7&#39;)"><span class="mpre">dpFast</span></a><span class="mpre"> :: </span><a href="Crypto.PubKey.RSA.Types.html#loc_15_6_15_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_15_6_15_13&#39;)"><span class="hl_tyconref"><span class="mpre">Blinder</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.RSA.html#loc_60_6_60_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_60_6_60_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_31_1_31_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_7&#39;)"><span class="hl_fundecl"><span class="mpre">dpFast</span></span></a><span class="mpre"> (</span><a href="Crypto.PubKey.RSA.Types.html#loc_15_16_15_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_15_16_15_23&#39;)"><span class="hl_conref"><span class="mpre">Blinder</span></span></a><span class="mpre"> </span><a name="loc_31_17_31_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_17_31_18&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_31_19_31_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_19_31_22&#39;)"><span class="hl_vardecl"><span class="mpre">rm1</span></span></a><span class="mpre">) </span><a name="loc_31_24_31_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_24_31_26&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_31_27_31_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_27_31_28&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> =
    </span><a href="Crypto.Number.Serialize.html#loc_103_1_103_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_103_1_103_9&#39;)"><span class="hl_varref"><span class="mpre">i2ospOf_</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_71_1_71_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_71_1_71_13&#39;)"><span class="hl_varref"><span class="mpre">private_size</span></span></a><span class="mpre"> </span><a href="#loc_31_24_31_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_24_31_26&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) (</span><a href="#loc_61_1_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_15&#39;)"><span class="hl_varref"><span class="mpre">multiplication</span></span></a><span class="mpre"> </span><a href="#loc_31_19_31_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_19_31_22&#39;)"><span class="hl_varref"><span class="mpre">rm1</span></span></a><span class="mpre"> (</span><a href="#loc_37_9_37_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_9_37_11&#39;)"><span class="hl_varref"><span class="mpre">m2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_38_9_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_10&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_64_7_64_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_64_7_64_16&#39;)"><span class="hl_varref"><span class="mpre">private_q</span></span></a><span class="mpre"> </span><a href="#loc_31_24_31_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_24_31_26&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">)) (</span><a href="Crypto.Types.PubKey.RSA.html#loc_74_1_74_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_74_1_74_10&#39;)"><span class="hl_varref"><span class="mpre">private_n</span></span></a><span class="mpre"> </span><a href="#loc_31_24_31_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_24_31_26&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">))
    where
        </span><a name="loc_34_9_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_11&#39;)"><span class="hl_vardecl"><span class="mpre">re</span></span></a><span class="mpre">  = </span><a href="Crypto.Number.ModArithmetic.html#loc_76_1_76_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_76_1_76_8&#39;)"><span class="hl_varref"><span class="mpre">expFast</span></span></a><span class="mpre"> </span><a href="#loc_31_17_31_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_17_31_18&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_28_7_28_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_28_7_28_15&#39;)"><span class="hl_varref"><span class="mpre">public_e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Types.PubKey.RSA.html#loc_61_7_61_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_61_7_61_18&#39;)"><span class="hl_varref"><span class="mpre">private_pub</span></span></a><span class="mpre"> </span><a href="#loc_31_24_31_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_24_31_26&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.RSA.html#loc_74_1_74_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_74_1_74_10&#39;)"><span class="hl_varref"><span class="mpre">private_n</span></span></a><span class="mpre"> </span><a href="#loc_31_24_31_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_24_31_26&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">)
        </span><a name="loc_35_9_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_11&#39;)"><span class="hl_vardecl"><span class="mpre">iC</span></span></a><span class="mpre">  = </span><a href="#loc_61_1_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_15&#39;)"><span class="hl_varref"><span class="mpre">multiplication</span></span></a><span class="mpre"> </span><a href="#loc_34_9_34_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_11&#39;)"><span class="hl_varref"><span class="mpre">re</span></span></a><span class="mpre"> (</span><a href="Crypto.Number.Serialize.html#loc_49_1_49_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_49_1_49_6&#39;)"><span class="hl_varref"><span class="mpre">os2ip</span></span></a><span class="mpre"> </span><a href="#loc_31_27_31_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_27_31_28&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.RSA.html#loc_74_1_74_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_74_1_74_10&#39;)"><span class="hl_varref"><span class="mpre">private_n</span></span></a><span class="mpre"> </span><a href="#loc_31_24_31_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_24_31_26&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">)
        </span><a name="loc_36_9_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_11&#39;)"><span class="hl_vardecl"><span class="mpre">m1</span></span></a><span class="mpre">  = </span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="hl_varref"><span class="mpre">expSafe</span></span></a><span class="mpre"> </span><a href="#loc_35_9_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_11&#39;)"><span class="hl_varref"><span class="mpre">iC</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_65_7_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_65_7_65_17&#39;)"><span class="hl_varref"><span class="mpre">private_dP</span></span></a><span class="mpre"> </span><a href="#loc_31_24_31_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_24_31_26&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.RSA.html#loc_63_7_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_63_7_63_16&#39;)"><span class="hl_varref"><span class="mpre">private_p</span></span></a><span class="mpre"> </span><a href="#loc_31_24_31_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_24_31_26&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">)
        </span><a name="loc_37_9_37_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_9_37_11&#39;)"><span class="hl_vardecl"><span class="mpre">m2</span></span></a><span class="mpre">  = </span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="hl_varref"><span class="mpre">expSafe</span></span></a><span class="mpre"> </span><a href="#loc_35_9_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_9_35_11&#39;)"><span class="hl_varref"><span class="mpre">iC</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_66_7_66_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_66_7_66_17&#39;)"><span class="hl_varref"><span class="mpre">private_dQ</span></span></a><span class="mpre"> </span><a href="#loc_31_24_31_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_24_31_26&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.RSA.html#loc_64_7_64_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_64_7_64_16&#39;)"><span class="hl_varref"><span class="mpre">private_q</span></span></a><span class="mpre"> </span><a href="#loc_31_24_31_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_24_31_26&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">)
        </span><a name="loc_38_9_38_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_9_38_10&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">   = ((</span><a href="Crypto.Types.PubKey.RSA.html#loc_67_7_67_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_67_7_67_19&#39;)"><span class="hl_varref"><span class="mpre">private_qinv</span></span></a><span class="mpre"> </span><a href="#loc_31_24_31_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_24_31_26&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_36_9_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_11&#39;)"><span class="hl_varref"><span class="mpre">m1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_37_9_37_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_9_37_11&#39;)"><span class="hl_varref"><span class="mpre">m2</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_63_7_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_63_7_63_16&#39;)"><span class="hl_varref"><span class="mpre">private_p</span></span></a><span class="mpre"> </span><a href="#loc_31_24_31_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_24_31_26&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">)

</span><a href="#loc_41_1_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_16&#39;)"><span class="mpre">dpFastNoBlinder</span></a><span class="mpre"> :: </span><a href="Crypto.Types.PubKey.RSA.html#loc_60_6_60_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_60_6_60_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_41_1_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_16&#39;)"><span class="hl_fundecl"><span class="mpre">dpFastNoBlinder</span></span></a><span class="mpre"> </span><a name="loc_41_17_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_19&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_41_20_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_21&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.Serialize.html#loc_103_1_103_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_103_1_103_9&#39;)"><span class="hl_varref"><span class="mpre">i2ospOf_</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_71_1_71_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_71_1_71_13&#39;)"><span class="hl_varref"><span class="mpre">private_size</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_19&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) (</span><a href="#loc_44_12_44_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_12_44_14&#39;)"><span class="hl_varref"><span class="mpre">m2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_45_12_45_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_12_45_13&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_64_7_64_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_64_7_64_16&#39;)"><span class="hl_varref"><span class="mpre">private_q</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_19&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">))
     where </span><a name="loc_42_12_42_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_12_42_14&#39;)"><span class="hl_vardecl"><span class="mpre">iC</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.Serialize.html#loc_49_1_49_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_49_1_49_6&#39;)"><span class="hl_varref"><span class="mpre">os2ip</span></span></a><span class="mpre"> </span><a href="#loc_41_20_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_20_41_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
           </span><a name="loc_43_12_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_14&#39;)"><span class="hl_vardecl"><span class="mpre">m1</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="hl_varref"><span class="mpre">expSafe</span></span></a><span class="mpre"> </span><a href="#loc_42_12_42_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_12_42_14&#39;)"><span class="hl_varref"><span class="mpre">iC</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_65_7_65_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_65_7_65_17&#39;)"><span class="hl_varref"><span class="mpre">private_dP</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_19&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.RSA.html#loc_63_7_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_63_7_63_16&#39;)"><span class="hl_varref"><span class="mpre">private_p</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_19&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">)
           </span><a name="loc_44_12_44_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_12_44_14&#39;)"><span class="hl_vardecl"><span class="mpre">m2</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.ModArithmetic.html#loc_59_1_59_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_59_1_59_8&#39;)"><span class="hl_varref"><span class="mpre">expSafe</span></span></a><span class="mpre"> </span><a href="#loc_42_12_42_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_12_42_14&#39;)"><span class="hl_varref"><span class="mpre">iC</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_66_7_66_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_66_7_66_17&#39;)"><span class="hl_varref"><span class="mpre">private_dQ</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_19&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.RSA.html#loc_64_7_64_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_64_7_64_16&#39;)"><span class="hl_varref"><span class="mpre">private_q</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_19&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">)
           </span><a name="loc_45_12_45_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_12_45_13&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">  = ((</span><a href="Crypto.Types.PubKey.RSA.html#loc_67_7_67_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_67_7_67_19&#39;)"><span class="hl_varref"><span class="mpre">private_qinv</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_19&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_43_12_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_14&#39;)"><span class="hl_varref"><span class="mpre">m1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_44_12_44_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_12_44_14&#39;)"><span class="hl_varref"><span class="mpre">m2</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_63_7_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_63_7_63_16&#39;)"><span class="hl_varref"><span class="mpre">private_p</span></span></a><span class="mpre"> </span><a href="#loc_41_17_41_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_17_41_19&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Compute the RSA decrypt primitive.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- if the p and q numbers are available, then dpFast is used</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- otherwise, we use dpSlow which only need d and n.</span></span><span class="mpre">
</span><a href="#loc_51_1_51_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_3&#39;)"><span class="mpre">dp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Crypto.PubKey.RSA.Types.html#loc_15_6_15_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.PubKey.RSA.Types.html#loc_15_6_15_13&#39;)"><span class="hl_tyconref"><span class="mpre">Blinder</span></span></a><span class="mpre"> -&gt; </span><a href="Crypto.Types.PubKey.RSA.html#loc_60_6_60_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_60_6_60_16&#39;)"><span class="hl_tyconref"><span class="mpre">PrivateKey</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_51_1_51_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_3&#39;)"><span class="hl_fundecl"><span class="mpre">dp</span></span></a><span class="mpre"> </span><a name="loc_51_4_51_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_4_51_11&#39;)"><span class="hl_vardecl"><span class="mpre">blinder</span></span></a><span class="mpre"> </span><a name="loc_51_12_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_12_51_14&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre">
    | </span><a href="Crypto.Types.PubKey.RSA.html#loc_63_7_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_63_7_63_16&#39;)"><span class="hl_varref"><span class="mpre">private_p</span></span></a><span class="mpre"> </span><a href="#loc_51_12_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_12_51_14&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Crypto.Types.PubKey.RSA.html#loc_64_7_64_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_64_7_64_16&#39;)"><span class="hl_varref"><span class="mpre">private_q</span></span></a><span class="mpre"> </span><a href="#loc_51_12_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_12_51_14&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><a href="#loc_41_1_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_16&#39;)"><span class="hl_varref"><span class="mpre">dpFastNoBlinder</span></span></a><span class="mpre"> </span><a href="#loc_31_1_31_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_7&#39;)"><span class="hl_varref"><span class="mpre">dpFast</span></span></a><span class="mpre"> </span><a href="#loc_51_4_51_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_4_51_11&#39;)"><span class="hl_varref"><span class="mpre">blinder</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_51_12_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_12_51_14&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                              = </span><a href="#loc_25_1_25_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_7&#39;)"><span class="hl_varref"><span class="mpre">dpSlow</span></span></a><span class="mpre"> </span><a href="#loc_51_12_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_12_51_14&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Compute the RSA encrypt primitive</span></span><span class="mpre">
</span><a href="#loc_57_1_57_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_3&#39;)"><span class="mpre">ep</span></a><span class="mpre"> :: </span><a href="Crypto.Types.PubKey.RSA.html#loc_25_6_25_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_25_6_25_15&#39;)"><span class="hl_tyconref"><span class="mpre">PublicKey</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_57_1_57_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_3&#39;)"><span class="hl_fundecl"><span class="mpre">ep</span></span></a><span class="mpre"> </span><a name="loc_57_4_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_4_57_6&#39;)"><span class="hl_vardecl"><span class="mpre">pk</span></span></a><span class="mpre"> </span><a name="loc_57_7_57_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_8&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="Crypto.Number.Serialize.html#loc_103_1_103_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_103_1_103_9&#39;)"><span class="hl_varref"><span class="mpre">i2ospOf_</span></span></a><span class="mpre"> (</span><a href="Crypto.Types.PubKey.RSA.html#loc_26_7_26_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_26_7_26_18&#39;)"><span class="hl_varref"><span class="mpre">public_size</span></span></a><span class="mpre"> </span><a href="#loc_57_4_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_4_57_6&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Number.ModArithmetic.html#loc_76_1_76_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.ModArithmetic.html#loc_76_1_76_8&#39;)"><span class="hl_varref"><span class="mpre">expFast</span></span></a><span class="mpre"> (</span><a href="Crypto.Number.Serialize.html#loc_49_1_49_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Number.Serialize.html#loc_49_1_49_6&#39;)"><span class="hl_varref"><span class="mpre">os2ip</span></span></a><span class="mpre"> </span><a href="#loc_57_7_57_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_8&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.RSA.html#loc_28_7_28_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_28_7_28_15&#39;)"><span class="hl_varref"><span class="mpre">public_e</span></span></a><span class="mpre"> </span><a href="#loc_57_4_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_4_57_6&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">) (</span><a href="Crypto.Types.PubKey.RSA.html#loc_27_7_27_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Types.PubKey.RSA.html#loc_27_7_27_15&#39;)"><span class="hl_varref"><span class="mpre">public_n</span></span></a><span class="mpre"> </span><a href="#loc_57_4_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_4_57_6&#39;)"><span class="hl_varref"><span class="mpre">pk</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | multiply 2 integers in Zm only performing the modulo operation if necessary</span></span><span class="mpre">
</span><a href="#loc_61_1_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_15&#39;)"><span class="mpre">multiplication</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_61_1_61_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_15&#39;)"><span class="hl_fundecl"><span class="mpre">multiplication</span></span></a><span class="mpre"> </span><a name="loc_61_16_61_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_16_61_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_61_18_61_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_18_61_19&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_61_20_61_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_20_61_21&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = (</span><a href="#loc_61_16_61_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_16_61_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_61_18_61_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_18_61_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><a href="#loc_61_20_61_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_20_61_21&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
</span></div></body></html>