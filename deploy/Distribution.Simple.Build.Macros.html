<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Distribution.Simple.Build.Macros</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  Simon Marlow 2008</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  cabal-devel@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Generate cabal_macros.h - CPP macros for package version testing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- When using CPP you get</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; VERSION_&lt;package&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; MIN_VERSION_&lt;package&gt;(A,B,C)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for each /package/ in @build-depends@, which is true if the version of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /package/ in use is @&gt;= A.B.C@, using the normal ordering on version</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- numbers.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Distribution.Simple.Build.Macros (
    generate,
    generatePackageVersionMacros,
  ) where

import Distribution.Package
         ( </span><a href="Distribution.Package.html#loc_102_6_102_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_102_6_102_23&#39;)"><span class="mpre">PackageIdentifier</span></a><span class="mpre">(PackageIdentifier) )
import Distribution.Version
         ( </span><a href="Data.Version.html#loc_68_6_68_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Version.html#loc_68_6_68_13&#39;)"><span class="mpre">Version</span></a><span class="mpre">(versionBranch) )
import Distribution.PackageDescription
         ( </span><a href="Distribution.PackageDescription.html#loc_161_6_161_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_161_6_161_24&#39;)"><span class="mpre">PackageDescription</span></a><span class="mpre"> )
import Distribution.Simple.LocalBuildInfo
        ( </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20&#39;)"><span class="mpre">LocalBuildInfo</span></a><span class="mpre">, </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_165_1_165_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_165_1_165_20&#39;)"><span class="mpre">externalPackageDeps</span></a><span class="mpre"> )
import Distribution.Text
         ( </span><a href="Distribution.Text.html#loc_31_1_31_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_31_1_31_8&#39;)"><span class="mpre">display</span></a><span class="mpre"> )

</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Generate cabal_macros.h</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The contents of the @cabal_macros.h@ for the given configured package.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_43_1_43_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_9&#39;)"><span class="mpre">generate</span></a><span class="mpre"> :: </span><a href="Distribution.PackageDescription.html#loc_161_6_161_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.PackageDescription.html#loc_161_6_161_24&#39;)"><span class="hl_tyconref"><span class="mpre">PackageDescription</span></span></a><span class="mpre"> -&gt; </span><a href="Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_116_6_116_20&#39;)"><span class="hl_tyconref"><span class="mpre">LocalBuildInfo</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_43_1_43_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_9&#39;)"><span class="hl_fundecl"><span class="mpre">generate</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_pkg_descr</span></span><span class="mpre"> </span><a name="loc_43_21_43_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_21_43_24&#39;)"><span class="hl_vardecl"><span class="mpre">lbi</span></span></a><span class="mpre"> =
  </span><span class="hl_string"><span class="mpre">&quot;/* DO NOT EDIT: This file is automatically generated by Cabal */\n\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
  </span><a href="#loc_53_1_53_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_29&#39;)"><span class="hl_varref"><span class="mpre">generatePackageVersionMacros</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> (</span><a href="Distribution.Simple.LocalBuildInfo.html#loc_165_1_165_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Simple.LocalBuildInfo.html#loc_165_1_165_20&#39;)"><span class="hl_varref"><span class="mpre">externalPackageDeps</span></span></a><span class="mpre"> </span><a href="#loc_43_21_43_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_21_43_24&#39;)"><span class="hl_varref"><span class="mpre">lbi</span></span></a><span class="mpre">))


</span><span class="hl_comment"><span class="mpre">-- | Helper function that generates just the @VERSION_pkg@ and @MIN_VERSION_pkg@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- macros for a list of package ids (usually used with the specific deps of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a configured package).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_53_1_53_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_29&#39;)"><span class="mpre">generatePackageVersionMacros</span></a><span class="mpre"> :: [</span><a href="Distribution.Package.html#loc_102_6_102_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_102_6_102_23&#39;)"><span class="hl_tyconref"><span class="mpre">PackageIdentifier</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_53_1_53_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_29&#39;)"><span class="hl_fundecl"><span class="mpre">generatePackageVersionMacros</span></span></a><span class="mpre"> </span><a name="loc_53_30_53_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_30_53_36&#39;)"><span class="hl_vardecl"><span class="mpre">pkgids</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre">
  [ </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre">
    [</span><span class="hl_string"><span class="mpre">&quot;/* package &quot;</span></span><span class="mpre">,</span><a href="Distribution.Text.html#loc_31_1_31_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_31_1_31_8&#39;)"><span class="hl_varref"><span class="mpre">display</span></span></a><span class="mpre"> </span><a href="#loc_63_5_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_10&#39;)"><span class="hl_varref"><span class="mpre">pkgid</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot; */\n&quot;</span></span><span class="mpre">
    ,</span><span class="hl_string"><span class="mpre">&quot;#define VERSION_&quot;</span></span><span class="mpre">,</span><a href="#loc_65_9_65_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_16&#39;)"><span class="hl_varref"><span class="mpre">pkgname</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre">,</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="Distribution.Text.html#loc_31_1_31_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_31_1_31_8&#39;)"><span class="hl_varref"><span class="mpre">display</span></span></a><span class="mpre"> </span><a href="#loc_63_35_63_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_35_63_42&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre">),</span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">
    ,</span><span class="hl_string"><span class="mpre">&quot;#define MIN_VERSION_&quot;</span></span><span class="mpre">,</span><a href="#loc_65_9_65_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_16&#39;)"><span class="hl_varref"><span class="mpre">pkgname</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;(major1,major2,minor) (\\\n&quot;</span></span><span class="mpre">
    ,</span><span class="hl_string"><span class="mpre">&quot;  (major1) &lt;  &quot;</span></span><span class="mpre">,</span><a href="#loc_64_10_64_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_10_64_16&#39;)"><span class="hl_varref"><span class="mpre">major1</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot; || \\\n&quot;</span></span><span class="mpre">
    ,</span><span class="hl_string"><span class="mpre">&quot;  (major1) == &quot;</span></span><span class="mpre">,</span><a href="#loc_64_10_64_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_10_64_16&#39;)"><span class="hl_varref"><span class="mpre">major1</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot; &amp;&amp; (major2) &lt;  &quot;</span></span><span class="mpre">,</span><a href="#loc_64_17_64_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_17_64_23&#39;)"><span class="hl_varref"><span class="mpre">major2</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot; || \\\n&quot;</span></span><span class="mpre">
    ,</span><span class="hl_string"><span class="mpre">&quot;  (major1) == &quot;</span></span><span class="mpre">,</span><a href="#loc_64_10_64_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_10_64_16&#39;)"><span class="hl_varref"><span class="mpre">major1</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot; &amp;&amp; (major2) == &quot;</span></span><span class="mpre">,</span><a href="#loc_64_17_64_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_17_64_23&#39;)"><span class="hl_varref"><span class="mpre">major2</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot; &amp;&amp; (minor) &lt;= &quot;</span></span><span class="mpre">,</span><a href="#loc_64_24_64_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_24_64_29&#39;)"><span class="hl_varref"><span class="mpre">minor</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="mpre">
    ,</span><span class="hl_string"><span class="mpre">&quot;\n\n&quot;</span></span><span class="mpre">
    ]
  | </span><a name="loc_63_5_63_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_10&#39;)"><span class="hl_specname"><span class="mpre">pkgid</span></span></a><span class="mpre">@(</span><span class="hl_conref"><span class="mpre">PackageIdentifier</span></span><span class="mpre"> </span><a name="loc_63_30_63_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_30_63_34&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_63_35_63_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_35_63_42&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_53_30_53_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_30_53_36&#39;)"><span class="hl_varref"><span class="mpre">pkgids</span></span></a><span class="mpre">
  , let (</span><a name="loc_64_10_64_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_10_64_16&#39;)"><span class="hl_vardecl"><span class="mpre">major1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_64_17_64_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_17_64_23&#39;)"><span class="hl_vardecl"><span class="mpre">major2</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_64_24_64_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_24_64_29&#39;)"><span class="hl_vardecl"><span class="mpre">minor</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">versionBranch</span></span><span class="mpre"> </span><a href="#loc_63_35_63_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_35_63_42&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
        </span><a name="loc_65_9_65_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_16&#39;)"><span class="hl_vardecl"><span class="mpre">pkgname</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_67_9_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_16&#39;)"><span class="hl_varref"><span class="mpre">fixchar</span></span></a><span class="mpre"> (</span><a href="Distribution.Text.html#loc_31_1_31_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_31_1_31_8&#39;)"><span class="hl_varref"><span class="mpre">display</span></span></a><span class="mpre"> </span><a href="#loc_63_30_63_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_30_63_34&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">)
  ]
  where </span><a name="loc_67_9_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_16&#39;)"><span class="hl_fundecl"><span class="mpre">fixchar</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;_&#39;</span></span><span class="mpre">
        </span><a href="#loc_67_9_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_16&#39;)"><span class="hl_fundecl"><span class="mpre">fixchar</span></span></a><span class="mpre"> </span><a name="loc_68_17_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_17_68_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">   = </span><a href="#loc_68_17_68_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_17_68_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span></div></body></html>