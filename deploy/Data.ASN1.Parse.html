<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.ASN1.Parse</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A parser combinator for ASN1 Stream.</span></span><span class="mpre">
{-# LANGUAGE GeneralizedNewtypeDeriving #-}
module Data.ASN1.Parse
    ( ParseASN1
    </span><span class="hl_comment"><span class="mpre">-- * run</span></span><span class="mpre">
    , runParseASN1State
    , runParseASN1
    </span><span class="hl_comment"><span class="mpre">-- * combinators</span></span><span class="mpre">
    , onNextContainer
    , onNextContainerMaybe
    , getNextContainer
    , getNextContainerMaybe
    , getNext
    , getNextMaybe
    , hasNext
    , getObject
    , getMany
    ) where

import Data.ASN1.Types
import Data.ASN1.Stream
import Control.Monad.State
import Control.Monad.Error
import Control.Applicative (</span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="mpre">Applicative</span></a><span class="mpre">, </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Parse ASN1 Monad</span></span><span class="mpre">
newtype </span><a name="loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tycondecl"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">P</span></span><span class="mpre"> { </span><a name="loc_34_27_34_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_27_34_31&#39;)"><span class="hl_fielddecl"><span class="mpre">runP</span></span></a><span class="mpre"> :: </span><a href="Control.Monad.Trans.Error.html#loc_155_9_155_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Error.html#loc_155_9_155_15&#39;)"><span class="hl_tyconref"><span class="mpre">ErrorT</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">State</span></span><span class="mpre"> [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">]) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> }
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-parse-0.8.1/Data/ASN1/Parse.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 5, srcSpanEndLine = 35, srcSpanEndColumn = 81}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-parse-0.8.1/Data/ASN1/Parse.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 5, srcSpanEndLine = 35, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-parse-0.8.1/Data/ASN1/Parse.hs&quot;, srcSpanStartLine "><span class="mpre">deriving (Functor, Applicative, Monad, MonadError String, MonadState [ASN1])</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | run the parse monad over a stream and returns the result and the remaining ASN1 Stream.</span></span><span class="mpre">
</span><a href="#loc_39_1_39_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_18&#39;)"><span class="mpre">runParseASN1State</span></a><span class="mpre"> :: </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,[</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">])
</span><a name="loc_39_1_39_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_18&#39;)"><span class="hl_fundecl"><span class="mpre">runParseASN1State</span></span></a><span class="mpre"> </span><a name="loc_39_19_39_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_19_39_20&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_39_21_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_21_39_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
    case </span><a href="Control.Monad.Trans.State.Lazy.html#loc_98_1_98_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Lazy.html#loc_98_1_98_9&#39;)"><span class="hl_varref"><span class="mpre">runState</span></span></a><span class="mpre"> (</span><a href="Control.Monad.Trans.Error.html#loc_155_33_155_42" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Error.html#loc_155_33_155_42&#39;)"><span class="hl_varref"><span class="mpre">runErrorT</span></span></a><span class="mpre"> (</span><a href="#loc_34_27_34_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_27_34_31&#39;)"><span class="hl_varref"><span class="mpre">runP</span></span></a><span class="mpre"> </span><a href="#loc_39_19_39_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_19_39_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)) </span><a href="#loc_39_21_39_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_21_39_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
        (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_41_15_41_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_18&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">, _) -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_41_15_41_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_18&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
        (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_42_16_42_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_16_42_17&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">, </span><a name="loc_42_19_42_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_19_42_20&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">)  -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_42_16_42_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_16_42_17&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">,</span><a href="#loc_42_19_42_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_19_42_20&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | run the parse monad over a stream and returns the result.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If there&#39;s still some asn1 object in the state after calling f,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- an error will be raised.</span></span><span class="mpre">
</span><a href="#loc_49_1_49_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_13&#39;)"><span class="mpre">runParseASN1</span></a><span class="mpre"> :: </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_49_1_49_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_13&#39;)"><span class="hl_fundecl"><span class="mpre">runParseASN1</span></span></a><span class="mpre"> </span><a name="loc_49_14_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_14_49_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_49_16_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_16_49_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
    case </span><a href="#loc_39_1_39_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_18&#39;)"><span class="hl_varref"><span class="mpre">runParseASN1State</span></span></a><span class="mpre"> </span><a href="#loc_49_14_49_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_14_49_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_49_16_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_16_49_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_51_14_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_14_51_17&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">      -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="#loc_51_14_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_14_51_17&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre">, []) -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_52_16_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_16_52_17&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (_, </span><a name="loc_53_19_53_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_19_53_21&#39;)"><span class="hl_vardecl"><span class="mpre">er</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;runParseASN1: remaining state &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_53_19_53_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_19_53_21&#39;)"><span class="hl_varref"><span class="mpre">er</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | get next object</span></span><span class="mpre">
</span><a href="#loc_57_1_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_10&#39;)"><span class="mpre">getObject</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-parse-0.8.1/Data/ASN1/Parse.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 14, srcSpanEndLine = 56, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-parse-0.8.1/Data/ASN1/Parse.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 27, srcSpanEndLine = 56, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/asn1-parse-0.8"><span class="mpre">ASN1Object a =&gt;</span></span><span class="mpre"> </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_57_1_57_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_10&#39;)"><span class="hl_vardecl"><span class="mpre">getObject</span></span></a><span class="mpre"> = do
    </span><a name="loc_58_5_58_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_6&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">get</span></span><span class="mpre">
    case </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_varref"><span class="mpre">fromASN1</span></span></a><span class="mpre"> </span><a href="#loc_58_5_58_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_6&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_60_14_60_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_14_60_17&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">     -&gt; </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> </span><a href="#loc_60_14_60_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_14_60_17&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_61_16_61_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_16_61_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_61_18_61_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_18_61_20&#39;)"><span class="hl_vardecl"><span class="mpre">l2</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">put</span></span><span class="mpre"> </span><a href="#loc_61_18_61_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_18_61_20&#39;)"><span class="hl_varref"><span class="mpre">l2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_61_16_61_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_16_61_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | get next element from the stream</span></span><span class="mpre">
</span><a href="#loc_65_1_65_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_8&#39;)"><span class="mpre">getNext</span></a><span class="mpre"> :: </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">
</span><a name="loc_65_1_65_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_8&#39;)"><span class="hl_vardecl"><span class="mpre">getNext</span></span></a><span class="mpre"> = do
    </span><a name="loc_66_5_66_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_9&#39;)"><span class="hl_vardecl"><span class="mpre">list</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">get</span></span><span class="mpre">
    case </span><a href="#loc_66_5_66_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_9&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre"> of
        []    -&gt; </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;empty&quot;</span></span><span class="mpre">
        (</span><a name="loc_69_10_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_10_69_11&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_69_12_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_12_69_13&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">put</span></span><span class="mpre"> </span><a href="#loc_69_12_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_12_69_13&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_69_10_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_10_69_11&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | get many elements until there&#39;s nothing left</span></span><span class="mpre">
</span><a href="#loc_73_1_73_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_8&#39;)"><span class="mpre">getMany</span></a><span class="mpre"> :: </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_73_1_73_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_8&#39;)"><span class="hl_fundecl"><span class="mpre">getMany</span></span></a><span class="mpre"> </span><a name="loc_73_9_73_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_15&#39;)"><span class="hl_vardecl"><span class="mpre">getOne</span></span></a><span class="mpre"> = do
    </span><a name="loc_74_5_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_9&#39;)"><span class="hl_vardecl"><span class="mpre">next</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_126_1_126_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_8&#39;)"><span class="hl_varref"><span class="mpre">hasNext</span></span></a><span class="mpre">
    if </span><a href="#loc_74_5_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_9&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre">
        then </span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="hl_varref"><span class="mpre">liftM2</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> </span><a href="#loc_73_9_73_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_15&#39;)"><span class="hl_varref"><span class="mpre">getOne</span></span></a><span class="mpre"> (</span><a href="#loc_73_1_73_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_8&#39;)"><span class="hl_varref"><span class="mpre">getMany</span></span></a><span class="mpre"> </span><a href="#loc_73_9_73_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_15&#39;)"><span class="hl_varref"><span class="mpre">getOne</span></span></a><span class="mpre">)
        else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []

</span><span class="hl_comment"><span class="mpre">-- | get next element from the stream maybe</span></span><span class="mpre">
</span><a href="#loc_81_1_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_13&#39;)"><span class="mpre">getNextMaybe</span></a><span class="mpre"> :: (</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_81_1_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_13&#39;)"><span class="hl_fundecl"><span class="mpre">getNextMaybe</span></span></a><span class="mpre"> </span><a name="loc_81_14_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_14_81_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
    </span><a name="loc_82_5_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_9&#39;)"><span class="hl_vardecl"><span class="mpre">list</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">get</span></span><span class="mpre">
    case </span><a href="#loc_82_5_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_9&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre"> of
        []    -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        (</span><a name="loc_85_10_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_10_85_11&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_85_12_85_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_12_85_13&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) -&gt; let </span><a name="loc_85_22_85_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_22_85_23&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><a href="#loc_81_14_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_14_81_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_85_10_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_10_85_11&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">
                  in do case </span><a href="#loc_85_22_85_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_22_85_23&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> of
                            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">put</span></span><span class="mpre"> </span><a href="#loc_82_5_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_9&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre">
                            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> _  -&gt; </span><span class="hl_varref"><span class="mpre">put</span></span><span class="mpre"> </span><a href="#loc_85_12_85_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_12_85_13&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
                        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_85_22_85_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_22_85_23&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | get next container of specified type and return all its elements</span></span><span class="mpre">
</span><a href="#loc_93_1_93_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_17&#39;)"><span class="mpre">getNextContainer</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Types.html#loc_32_6_32_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_6_32_26&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1ConstructionType</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">]
</span><a name="loc_93_1_93_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_17&#39;)"><span class="hl_fundecl"><span class="mpre">getNextContainer</span></span></a><span class="mpre"> </span><a name="loc_93_18_93_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_18_93_20&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre"> = do
    </span><a name="loc_94_5_94_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_9&#39;)"><span class="hl_vardecl"><span class="mpre">list</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">get</span></span><span class="mpre">
    case </span><a href="#loc_94_5_94_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_9&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre"> of
        []                    -&gt; </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;empty&quot;</span></span><span class="mpre">
        (</span><a name="loc_97_10_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_10_97_11&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_97_12_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_12_97_13&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) | </span><a href="#loc_97_10_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_10_97_11&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="#loc_93_18_93_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_18_93_20&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> -&gt; do let (</span><a name="loc_97_42_97_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_42_97_44&#39;)"><span class="hl_vardecl"><span class="mpre">l1</span></span></a><span class="mpre">, </span><a name="loc_97_46_97_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_46_97_48&#39;)"><span class="hl_vardecl"><span class="mpre">l2</span></span></a><span class="mpre">) = </span><a href="Data.ASN1.Stream.html#loc_23_1_23_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Stream.html#loc_23_1_23_18&#39;)"><span class="hl_varref"><span class="mpre">getConstructedEnd</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_97_12_97_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_12_97_13&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
                                    </span><span class="hl_varref"><span class="mpre">put</span></span><span class="mpre"> </span><a href="#loc_97_46_97_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_46_97_48&#39;)"><span class="hl_varref"><span class="mpre">l2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_97_42_97_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_42_97_44&#39;)"><span class="hl_varref"><span class="mpre">l1</span></span></a><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     -&gt; </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;not an expected container&quot;</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | run a function of the next elements of a container of specified type</span></span><span class="mpre">
</span><a href="#loc_104_1_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_16&#39;)"><span class="mpre">onNextContainer</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Types.html#loc_32_6_32_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_6_32_26&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1ConstructionType</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_104_1_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_16&#39;)"><span class="hl_fundecl"><span class="mpre">onNextContainer</span></span></a><span class="mpre"> </span><a name="loc_104_17_104_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_17_104_19&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre"> </span><a name="loc_104_20_104_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_21&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_93_1_93_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_17&#39;)"><span class="hl_varref"><span class="mpre">getNextContainer</span></span></a><span class="mpre"> </span><a href="#loc_104_17_104_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_17_104_19&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_49_1_49_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_13&#39;)"><span class="hl_varref"><span class="mpre">runParseASN1</span></span></a><span class="mpre"> </span><a href="#loc_104_20_104_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_21&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | just like getNextContainer, except it doesn&#39;t throw an error if the container doesn&#39;t exists.</span></span><span class="mpre">
</span><a href="#loc_108_1_108_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_22&#39;)"><span class="mpre">getNextContainerMaybe</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Types.html#loc_32_6_32_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_6_32_26&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1ConstructionType</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> [</span><a href="Data.ASN1.Types.html#loc_43_6_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_43_6_43_10&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1</span></span></a><span class="mpre">])
</span><a name="loc_108_1_108_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_22&#39;)"><span class="hl_fundecl"><span class="mpre">getNextContainerMaybe</span></span></a><span class="mpre"> </span><a name="loc_108_23_108_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_23_108_25&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre"> = do
    </span><a name="loc_109_5_109_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_5_109_9&#39;)"><span class="hl_vardecl"><span class="mpre">list</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">get</span></span><span class="mpre">
    case </span><a href="#loc_109_5_109_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_5_109_9&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre"> of
        []                    -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        (</span><a name="loc_112_10_112_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_10_112_11&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_112_12_112_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_12_112_13&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) | </span><a href="#loc_112_10_112_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_10_112_11&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="#loc_108_23_108_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_23_108_25&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> -&gt; do let (</span><a name="loc_112_42_112_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_42_112_44&#39;)"><span class="hl_vardecl"><span class="mpre">l1</span></span></a><span class="mpre">, </span><a name="loc_112_46_112_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_46_112_48&#39;)"><span class="hl_vardecl"><span class="mpre">l2</span></span></a><span class="mpre">) = </span><a href="Data.ASN1.Stream.html#loc_23_1_23_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Stream.html#loc_23_1_23_18&#39;)"><span class="hl_varref"><span class="mpre">getConstructedEnd</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_112_12_112_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_12_112_13&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
                                    </span><span class="hl_varref"><span class="mpre">put</span></span><span class="mpre"> </span><a href="#loc_112_46_112_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_46_112_48&#39;)"><span class="hl_varref"><span class="mpre">l2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_112_42_112_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_42_112_44&#39;)"><span class="hl_varref"><span class="mpre">l1</span></span></a><span class="mpre">)
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | just like onNextContainer, except it doesn&#39;t throw an error if the container doesn&#39;t exists.</span></span><span class="mpre">
</span><a href="#loc_118_1_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_21&#39;)"><span class="mpre">onNextContainerMaybe</span></a><span class="mpre"> :: </span><a href="Data.ASN1.Types.html#loc_32_6_32_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_6_32_26&#39;)"><span class="hl_tyconref"><span class="mpre">ASN1ConstructionType</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_118_1_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_21&#39;)"><span class="hl_fundecl"><span class="mpre">onNextContainerMaybe</span></span></a><span class="mpre"> </span><a name="loc_118_22_118_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_22_118_24&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre"> </span><a name="loc_118_25_118_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_25_118_26&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
    </span><a name="loc_119_5_119_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_6&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_108_1_108_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_22&#39;)"><span class="hl_varref"><span class="mpre">getNextContainerMaybe</span></span></a><span class="mpre"> </span><a href="#loc_118_22_118_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_22_118_24&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre">
    case </span><a href="#loc_119_5_119_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_6&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_121_14_121_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_14_121_15&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">  -&gt; </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">throwError</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_49_1_49_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_13&#39;)"><span class="hl_varref"><span class="mpre">runParseASN1</span></span></a><span class="mpre"> </span><a href="#loc_118_25_118_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_25_118_26&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_121_14_121_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_14_121_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | returns if there&#39;s more elements in the stream.</span></span><span class="mpre">
</span><a href="#loc_126_1_126_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_8&#39;)"><span class="mpre">hasNext</span></a><span class="mpre"> :: </span><a href="#loc_34_9_34_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_18&#39;)"><span class="hl_tyconref"><span class="mpre">ParseASN1</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_126_1_126_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_8&#39;)"><span class="hl_vardecl"><span class="mpre">hasNext</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">get</span></span><span class="mpre">
</span></div></body></html>