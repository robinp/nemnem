<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE Trustworthy #-}
{-# LANGUAGE NoImplicitPrelude, MagicHash #-}

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Foreign.Marshal.Array</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The FFI task force 2001</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  ffi@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Marshalling support: routines allocating, storing, and retrieving Haskell</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- lists that are represented as arrays in the foreign language</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Foreign.Marshal.Array (
  </span><span class="hl_comment"><span class="mpre">-- * Marshalling arrays</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- ** Allocation</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
  mallocArray,
  mallocArray0,

  allocaArray,
  allocaArray0,

  reallocArray,
  reallocArray0,

  </span><span class="hl_comment"><span class="mpre">-- ** Marshalling</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
  peekArray,
  peekArray0,

  pokeArray,
  pokeArray0,

  </span><span class="hl_comment"><span class="mpre">-- ** Combined allocation and marshalling</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
  newArray,
  newArray0,

  withArray,
  withArray0,

  withArrayLen,
  withArrayLen0,

  </span><span class="hl_comment"><span class="mpre">-- ** Copying</span></span><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- | (argument order: destination, source)</span></span><span class="mpre">
  copyArray,
  moveArray,

  </span><span class="hl_comment"><span class="mpre">-- ** Finding the length</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
  lengthArray0,

  </span><span class="hl_comment"><span class="mpre">-- ** Indexing</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
  advancePtr,
) where

import Foreign.Ptr      (Ptr, plusPtr)
import Foreign.Storable (Storable(alignment,sizeOf,peekElemOff,pokeElemOff))
import Foreign.Marshal.Alloc (mallocBytes, allocaBytesAligned, reallocBytes)
import Foreign.Marshal.Utils (</span><a href="Foreign.Marshal.Utils.html#loc_154_1_154_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Utils.html#loc_154_1_154_10&#39;)"><span class="mpre">copyBytes</span></a><span class="mpre">, </span><a href="Foreign.Marshal.Utils.html#loc_161_1_161_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Utils.html#loc_161_1_161_10&#39;)"><span class="mpre">moveBytes</span></a><span class="mpre">)

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 8, srcSpanEndLine = 72, srcSpanEndColumn = 15}, srcInfoPoints = []}) &quot;GHC.Num&quot;"><span class="mpre">GHC.Num</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 73, srcSpanStartColumn = 8, srcSpanEndLine = 73, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.List&quot;"><span class="mpre">GHC.List</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 74, srcSpanStartColumn = 8, srcSpanEndLine = 74, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- allocation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ----------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Allocate storage for the given number of elements of a storable type</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (like &#39;Foreign.Marshal.Alloc.malloc&#39;, but for multiple elements).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_12&#39;)"><span class="mpre">mallocArray</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 16, srcSpanEndLine = 82, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 27, srcSpanEndLine = 82, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_83_1_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_12&#39;)"><span class="hl_vardecl"><span class="mpre">mallocArray</span></span></a><span class="mpre">  = </span><a href="#loc_86_5_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_13&#39;)"><span class="hl_varref"><span class="mpre">doMalloc</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
  where
    </span><a href="#loc_86_5_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_13&#39;)"><span class="mpre">doMalloc</span></a><span class="mpre">            :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 85, srcSpanStartColumn = 28, srcSpanEndLine = 85, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 85, srcSpanStartColumn = 40, srcSpanEndLine = 85, srcSpanEndColumn = 42}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0"><span class="mpre">Storable a&#39; =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre">)
    </span><a name="loc_86_5_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_13&#39;)"><span class="hl_fundecl"><span class="mpre">doMalloc</span></span></a><span class="mpre"> </span><a name="loc_86_14_86_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_19&#39;)"><span class="hl_vardecl"><span class="mpre">dummy</span></span></a><span class="mpre"> </span><a name="loc_86_20_86_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_20_86_24&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">mallocBytes</span></span><span class="mpre"> (</span><a href="#loc_86_20_86_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_20_86_24&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> </span><a href="#loc_86_14_86_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_19&#39;)"><span class="hl_varref"><span class="mpre">dummy</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |Like &#39;mallocArray&#39;, but add an extra position to hold a special</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- termination element.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_92_1_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_13&#39;)"><span class="mpre">mallocArray0</span></a><span class="mpre">      :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 22, srcSpanEndLine = 91, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 33, srcSpanEndLine = 91, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_92_1_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_13&#39;)"><span class="hl_fundecl"><span class="mpre">mallocArray0</span></span></a><span class="mpre"> </span><a name="loc_92_14_92_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_14_92_18&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre">  = </span><a href="#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_12&#39;)"><span class="hl_varref"><span class="mpre">mallocArray</span></span></a><span class="mpre"> (</span><a href="#loc_92_14_92_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_14_92_18&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |Temporarily allocate space for the given number of elements</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (like &#39;Foreign.Marshal.Alloc.alloca&#39;, but for multiple elements).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_98_1_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_12&#39;)"><span class="mpre">allocaArray</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 16, srcSpanEndLine = 97, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 27, srcSpanEndLine = 97, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_98_1_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_12&#39;)"><span class="hl_vardecl"><span class="mpre">allocaArray</span></span></a><span class="mpre">  = </span><a href="#loc_101_5_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_13&#39;)"><span class="hl_varref"><span class="mpre">doAlloca</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
  where
    </span><a href="#loc_101_5_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_13&#39;)"><span class="mpre">doAlloca</span></a><span class="mpre">            :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 100, srcSpanStartColumn = 28, srcSpanEndLine = 100, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 100, srcSpanStartColumn = 40, srcSpanEndLine = 100, srcSpanEndColumn = 42}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a&#39; =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b&#39;</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b&#39;</span></span><span class="mpre">
    </span><a name="loc_101_5_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_13&#39;)"><span class="hl_fundecl"><span class="mpre">doAlloca</span></span></a><span class="mpre"> </span><a name="loc_101_14_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_19&#39;)"><span class="hl_vardecl"><span class="mpre">dummy</span></span></a><span class="mpre"> </span><a name="loc_101_20_101_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_20_101_24&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">allocaBytesAligned</span></span><span class="mpre"> (</span><a href="#loc_101_20_101_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_20_101_24&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> </span><a href="#loc_101_14_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_19&#39;)"><span class="hl_varref"><span class="mpre">dummy</span></span></a><span class="mpre">)
                                              (</span><span class="hl_varref"><span class="mpre">alignment</span></span><span class="mpre"> </span><a href="#loc_101_14_101_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_19&#39;)"><span class="hl_varref"><span class="mpre">dummy</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |Like &#39;allocaArray&#39;, but add an extra position to hold a special</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- termination element.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_108_1_108_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_13&#39;)"><span class="mpre">allocaArray0</span></a><span class="mpre">      :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 22, srcSpanEndLine = 107, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 33, srcSpanEndLine = 107, srcSpanEndColumn = 35}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_108_1_108_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_13&#39;)"><span class="hl_fundecl"><span class="mpre">allocaArray0</span></span></a><span class="mpre"> </span><a name="loc_108_14_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_14_108_18&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre">  = </span><a href="#loc_98_1_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_12&#39;)"><span class="hl_varref"><span class="mpre">allocaArray</span></span></a><span class="mpre"> (</span><a href="#loc_108_14_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_14_108_18&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_108_1_108_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_13&#39;)"><span class="mpre">allocaArray0</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- needed to get allocaArray to inline into withCString, for unknown</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- reasons --SDM 23/4/2010, see #4004 for benchmark</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Adjust the size of an array</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_116_1_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_13&#39;)"><span class="mpre">reallocArray</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 115, srcSpanStartColumn = 17, srcSpanEndLine = 115, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 115, srcSpanStartColumn = 28, srcSpanEndLine = 115, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_116_1_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_13&#39;)"><span class="hl_vardecl"><span class="mpre">reallocArray</span></span></a><span class="mpre">  = </span><a href="#loc_119_5_119_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_14&#39;)"><span class="hl_varref"><span class="mpre">doRealloc</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
  where
    </span><a href="#loc_119_5_119_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_14&#39;)"><span class="mpre">doRealloc</span></a><span class="mpre">                :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 118, srcSpanStartColumn = 33, srcSpanEndLine = 118, srcSpanEndColumn = 47}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 118, srcSpanStartColumn = 45, srcSpanEndLine = 118, srcSpanEndColumn = 47}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a&#39; =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre">)
    </span><a name="loc_119_5_119_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_14&#39;)"><span class="hl_fundecl"><span class="mpre">doRealloc</span></span></a><span class="mpre"> </span><a name="loc_119_15_119_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_15_119_20&#39;)"><span class="hl_vardecl"><span class="mpre">dummy</span></span></a><span class="mpre"> </span><a name="loc_119_21_119_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_21_119_24&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a name="loc_119_25_119_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_25_119_29&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">reallocBytes</span></span><span class="mpre"> </span><a href="#loc_119_21_119_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_21_119_24&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><a href="#loc_119_25_119_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_25_119_29&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> </span><a href="#loc_119_15_119_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_15_119_20&#39;)"><span class="hl_varref"><span class="mpre">dummy</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |Adjust the size of an array including an extra position for the end marker.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_124_1_124_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_14&#39;)"><span class="mpre">reallocArray0</span></a><span class="mpre">          :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 123, srcSpanStartColumn = 27, srcSpanEndLine = 123, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 123, srcSpanStartColumn = 38, srcSpanEndLine = 123, srcSpanEndColumn = 40}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_124_1_124_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_14&#39;)"><span class="hl_fundecl"><span class="mpre">reallocArray0</span></span></a><span class="mpre"> </span><a name="loc_124_15_124_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_15_124_18&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a name="loc_124_19_124_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_19_124_23&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre">  = </span><a href="#loc_116_1_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_13&#39;)"><span class="hl_varref"><span class="mpre">reallocArray</span></span></a><span class="mpre"> </span><a href="#loc_124_15_124_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_15_124_18&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><a href="#loc_124_19_124_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_19_124_23&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- marshalling</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- -----------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Convert an array of given length into a Haskell list.  The implementation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is tail-recursive and so uses constant stack space.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_134_1_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_10&#39;)"><span class="mpre">peekArray</span></a><span class="mpre">          :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 133, srcSpanStartColumn = 23, srcSpanEndLine = 133, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 133, srcSpanStartColumn = 34, srcSpanEndLine = 133, srcSpanEndColumn = 36}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_134_1_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_10&#39;)"><span class="hl_fundecl"><span class="mpre">peekArray</span></span></a><span class="mpre"> </span><a name="loc_134_11_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_11_134_15&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> </span><a name="loc_134_16_134_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_16_134_19&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> | </span><a href="#loc_134_11_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_11_134_15&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
                 | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_137_5_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_5_137_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_134_11_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_11_134_15&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) []
  where
    </span><a name="loc_137_5_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_5_137_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_137_9_137_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_12&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> = do </span><a name="loc_137_18_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_18_137_19&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peekElemOff</span></span><span class="mpre"> </span><a href="#loc_134_16_134_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_16_134_19&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_137_18_137_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_18_137_19&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_137_9_137_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_12&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)
    </span><a href="#loc_137_5_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_5_137_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_138_7_138_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_7_138_8&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_138_9_138_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_12&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> = do </span><a name="loc_138_18_138_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_18_138_19&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peekElemOff</span></span><span class="mpre"> </span><a href="#loc_134_16_134_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_16_134_19&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_138_7_138_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_7_138_8&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">; </span><a href="#loc_137_5_137_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_5_137_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_138_7_138_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_7_138_8&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_138_18_138_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_18_138_19&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_12&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)
  
</span><span class="hl_comment"><span class="mpre">-- |Convert an array terminated by the given end marker into a Haskell list</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_143_1_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_11&#39;)"><span class="mpre">peekArray0</span></a><span class="mpre">            :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 142, srcSpanStartColumn = 26, srcSpanEndLine = 142, srcSpanEndColumn = 47}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 142, srcSpanStartColumn = 26, srcSpanEndLine = 142, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpa"><span class="mpre">(Storable a, Eq a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_143_1_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_1_143_11&#39;)"><span class="hl_fundecl"><span class="mpre">peekArray0</span></span></a><span class="mpre"> </span><a name="loc_143_12_143_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_12_143_18&#39;)"><span class="hl_vardecl"><span class="mpre">marker</span></span></a><span class="mpre"> </span><a name="loc_143_19_143_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_19_143_22&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre">  = do
  </span><a name="loc_144_3_144_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_3_144_7&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_247_1_247_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_13&#39;)"><span class="hl_varref"><span class="mpre">lengthArray0</span></span></a><span class="mpre"> </span><a href="#loc_143_12_143_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_12_143_18&#39;)"><span class="hl_varref"><span class="mpre">marker</span></span></a><span class="mpre"> </span><a href="#loc_143_19_143_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_19_143_22&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">
  </span><a href="#loc_134_1_134_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_10&#39;)"><span class="hl_varref"><span class="mpre">peekArray</span></span></a><span class="mpre"> </span><a href="#loc_144_3_144_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_3_144_7&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><a href="#loc_143_19_143_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_19_143_22&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Write the list elements consecutive into memory</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_150_1_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_10&#39;)"><span class="mpre">pokeArray</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 149, srcSpanStartColumn = 14, srcSpanEndLine = 149, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 149, srcSpanStartColumn = 25, srcSpanEndLine = 149, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_150_1_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_10&#39;)"><span class="hl_fundecl"><span class="mpre">pokeArray</span></span></a><span class="mpre"> </span><a name="loc_150_11_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_11_150_14&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a name="loc_150_15_150_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_15_150_20&#39;)"><span class="hl_vardecl"><span class="mpre">vals0</span></span></a><span class="mpre"> = </span><a href="#loc_151_9_151_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_9_151_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_150_15_150_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_15_150_20&#39;)"><span class="hl_varref"><span class="mpre">vals0</span></span></a><span class="mpre"> 0#
  where </span><a name="loc_151_9_151_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_9_151_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] _          = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        </span><a href="#loc_151_9_151_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_9_151_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_152_13_152_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_13_152_16&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_152_17_152_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_17_152_21&#39;)"><span class="hl_vardecl"><span class="mpre">vals</span></span></a><span class="mpre">) </span><a name="loc_152_23_152_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_23_152_25&#39;)"><span class="hl_vardecl"><span class="mpre">n#</span></span></a><span class="mpre"> = do </span><span class="hl_varref"><span class="mpre">pokeElemOff</span></span><span class="mpre"> </span><a href="#loc_150_11_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_11_150_14&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">I#</span></span><span class="mpre"> </span><a href="#loc_152_23_152_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_23_152_25&#39;)"><span class="hl_varref"><span class="mpre">n#</span></span></a><span class="mpre">) </span><a href="#loc_152_13_152_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_13_152_16&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre">; </span><a href="#loc_151_9_151_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_9_151_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_152_17_152_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_17_152_21&#39;)"><span class="hl_varref"><span class="mpre">vals</span></span></a><span class="mpre"> (</span><a href="#loc_152_23_152_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_23_152_25&#39;)"><span class="hl_varref"><span class="mpre">n#</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+#</span></span><span class="mpre"> 1#)

</span><span class="hl_comment"><span class="mpre">-- |Write the list elements consecutive into memory and terminate them with the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- given marker element</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_158_1_158_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_11&#39;)"><span class="mpre">pokeArray0</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 157, srcSpanStartColumn = 15, srcSpanEndLine = 157, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 157, srcSpanStartColumn = 26, srcSpanEndLine = 157, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_158_1_158_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_11&#39;)"><span class="hl_fundecl"><span class="mpre">pokeArray0</span></span></a><span class="mpre"> </span><a name="loc_158_12_158_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_12_158_18&#39;)"><span class="hl_vardecl"><span class="mpre">marker</span></span></a><span class="mpre"> </span><a name="loc_158_19_158_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_19_158_22&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a name="loc_158_23_158_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_23_158_28&#39;)"><span class="hl_vardecl"><span class="mpre">vals0</span></span></a><span class="mpre"> = </span><a href="#loc_159_9_159_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_158_23_158_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_23_158_28&#39;)"><span class="hl_varref"><span class="mpre">vals0</span></span></a><span class="mpre"> 0#
  where </span><a name="loc_159_9_159_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> [] </span><a name="loc_159_15_159_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_15_159_17&#39;)"><span class="hl_vardecl"><span class="mpre">n#</span></span></a><span class="mpre">         = </span><span class="hl_varref"><span class="mpre">pokeElemOff</span></span><span class="mpre"> </span><a href="#loc_158_19_158_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_19_158_22&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">I#</span></span><span class="mpre"> </span><a href="#loc_159_15_159_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_15_159_17&#39;)"><span class="hl_varref"><span class="mpre">n#</span></span></a><span class="mpre">) </span><a href="#loc_158_12_158_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_12_158_18&#39;)"><span class="hl_varref"><span class="mpre">marker</span></span></a><span class="mpre">
        </span><a href="#loc_159_9_159_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_11&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a name="loc_160_13_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_13_160_16&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_160_17_160_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_17_160_21&#39;)"><span class="hl_vardecl"><span class="mpre">vals</span></span></a><span class="mpre">) </span><a name="loc_160_23_160_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_23_160_25&#39;)"><span class="hl_vardecl"><span class="mpre">n#</span></span></a><span class="mpre"> = do </span><span class="hl_varref"><span class="mpre">pokeElemOff</span></span><span class="mpre"> </span><a href="#loc_158_19_158_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_19_158_22&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">I#</span></span><span class="mpre"> </span><a href="#loc_160_23_160_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_23_160_25&#39;)"><span class="hl_varref"><span class="mpre">n#</span></span></a><span class="mpre">) </span><a href="#loc_160_13_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_13_160_16&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre">; </span><a href="#loc_159_9_159_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_160_17_160_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_17_160_21&#39;)"><span class="hl_varref"><span class="mpre">vals</span></span></a><span class="mpre"> (</span><a href="#loc_160_23_160_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_23_160_25&#39;)"><span class="hl_varref"><span class="mpre">n#</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+#</span></span><span class="mpre"> 1#)

</span><span class="hl_comment"><span class="mpre">-- combined allocation and marshalling</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- -----------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Write a list of storable elements into a newly allocated, consecutive</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- sequence of storable values</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (like &#39;Foreign.Marshal.Utils.new&#39;, but for multiple elements).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_170_1_170_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_9&#39;)"><span class="mpre">newArray</span></a><span class="mpre">      :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 169, srcSpanStartColumn = 18, srcSpanEndLine = 169, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 169, srcSpanStartColumn = 29, srcSpanEndLine = 169, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_170_1_170_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_9&#39;)"><span class="hl_fundecl"><span class="mpre">newArray</span></span></a><span class="mpre"> </span><a name="loc_170_10_170_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_10_170_14&#39;)"><span class="hl_vardecl"><span class="mpre">vals</span></span></a><span class="mpre">  = do
  </span><a name="loc_171_3_171_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_3_171_6&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_83_1_83_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_12&#39;)"><span class="hl_varref"><span class="mpre">mallocArray</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_170_10_170_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_10_170_14&#39;)"><span class="hl_varref"><span class="mpre">vals</span></span></a><span class="mpre">)
  </span><a href="#loc_150_1_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_10&#39;)"><span class="hl_varref"><span class="mpre">pokeArray</span></span></a><span class="mpre"> </span><a href="#loc_171_3_171_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_3_171_6&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_170_10_170_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_10_170_14&#39;)"><span class="hl_varref"><span class="mpre">vals</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_171_3_171_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_3_171_6&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Write a list of storable elements into a newly allocated, consecutive</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- sequence of storable values, where the end is fixed by the given end marker</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_179_1_179_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_10&#39;)"><span class="mpre">newArray0</span></a><span class="mpre">             :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 178, srcSpanStartColumn = 26, srcSpanEndLine = 178, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 178, srcSpanStartColumn = 37, srcSpanEndLine = 178, srcSpanEndColumn = 39}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_179_1_179_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_1_179_10&#39;)"><span class="hl_fundecl"><span class="mpre">newArray0</span></span></a><span class="mpre"> </span><a name="loc_179_11_179_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_11_179_17&#39;)"><span class="hl_vardecl"><span class="mpre">marker</span></span></a><span class="mpre"> </span><a name="loc_179_18_179_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_18_179_22&#39;)"><span class="hl_vardecl"><span class="mpre">vals</span></span></a><span class="mpre">  = do
  </span><a name="loc_180_3_180_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_3_180_6&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_92_1_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_13&#39;)"><span class="hl_varref"><span class="mpre">mallocArray0</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_179_18_179_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_18_179_22&#39;)"><span class="hl_varref"><span class="mpre">vals</span></span></a><span class="mpre">)
  </span><a href="#loc_158_1_158_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_11&#39;)"><span class="hl_varref"><span class="mpre">pokeArray0</span></span></a><span class="mpre"> </span><a href="#loc_179_11_179_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_11_179_17&#39;)"><span class="hl_varref"><span class="mpre">marker</span></span></a><span class="mpre"> </span><a href="#loc_180_3_180_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_3_180_6&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_179_18_179_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_18_179_22&#39;)"><span class="hl_varref"><span class="mpre">vals</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_180_3_180_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_3_180_6&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Temporarily store a list of storable values in memory</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (like &#39;Foreign.Marshal.Utils.with&#39;, but for multiple elements).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_188_1_188_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_10&#39;)"><span class="mpre">withArray</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 187, srcSpanStartColumn = 14, srcSpanEndLine = 187, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 187, srcSpanStartColumn = 25, srcSpanEndLine = 187, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_188_1_188_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_1_188_10&#39;)"><span class="hl_fundecl"><span class="mpre">withArray</span></span></a><span class="mpre"> </span><a name="loc_188_11_188_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_11_188_15&#39;)"><span class="hl_vardecl"><span class="mpre">vals</span></span></a><span class="mpre"> = </span><a href="#loc_194_1_194_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_13&#39;)"><span class="hl_varref"><span class="mpre">withArrayLen</span></span></a><span class="mpre"> </span><a href="#loc_188_11_188_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_11_188_15&#39;)"><span class="hl_varref"><span class="mpre">vals</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Like &#39;withArray&#39;, but the action gets the number of values</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as an additional parameter</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_194_1_194_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_13&#39;)"><span class="mpre">withArrayLen</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 193, srcSpanStartColumn = 17, srcSpanEndLine = 193, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 193, srcSpanStartColumn = 28, srcSpanEndLine = 193, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_194_1_194_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_13&#39;)"><span class="hl_fundecl"><span class="mpre">withArrayLen</span></span></a><span class="mpre"> </span><a name="loc_194_14_194_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_14_194_18&#39;)"><span class="hl_vardecl"><span class="mpre">vals</span></span></a><span class="mpre"> </span><a name="loc_194_19_194_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_19_194_20&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">  =
  </span><a href="#loc_98_1_98_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_12&#39;)"><span class="hl_varref"><span class="mpre">allocaArray</span></span></a><span class="mpre"> </span><a href="#loc_200_5_200_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_5_200_8&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_195_22_195_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_22_195_25&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; do
      </span><a href="#loc_150_1_150_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_10&#39;)"><span class="hl_varref"><span class="mpre">pokeArray</span></span></a><span class="mpre"> </span><a href="#loc_195_22_195_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_22_195_25&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_194_14_194_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_14_194_18&#39;)"><span class="hl_varref"><span class="mpre">vals</span></span></a><span class="mpre">
      </span><a name="loc_197_7_197_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_7_197_10&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_194_19_194_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_19_194_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_200_5_200_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_5_200_8&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_195_22_195_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_22_195_25&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_197_7_197_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_7_197_10&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">
  where
    </span><a name="loc_200_5_200_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_5_200_8&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_194_14_194_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_14_194_18&#39;)"><span class="hl_varref"><span class="mpre">vals</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Like &#39;withArray&#39;, but a terminator indicates where the array ends</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_205_1_205_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_11&#39;)"><span class="mpre">withArray0</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 204, srcSpanStartColumn = 15, srcSpanEndLine = 204, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 204, srcSpanStartColumn = 26, srcSpanEndLine = 204, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; (</span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_205_1_205_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_1_205_11&#39;)"><span class="hl_fundecl"><span class="mpre">withArray0</span></span></a><span class="mpre"> </span><a name="loc_205_12_205_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_12_205_18&#39;)"><span class="hl_vardecl"><span class="mpre">marker</span></span></a><span class="mpre"> </span><a name="loc_205_19_205_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_19_205_23&#39;)"><span class="hl_vardecl"><span class="mpre">vals</span></span></a><span class="mpre"> = </span><a href="#loc_210_1_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_14&#39;)"><span class="hl_varref"><span class="mpre">withArrayLen0</span></span></a><span class="mpre"> </span><a href="#loc_205_12_205_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_12_205_18&#39;)"><span class="hl_varref"><span class="mpre">marker</span></span></a><span class="mpre"> </span><a href="#loc_205_19_205_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_19_205_23&#39;)"><span class="hl_varref"><span class="mpre">vals</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Like &#39;withArrayLen&#39;, but a terminator indicates where the array ends</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_210_1_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_14&#39;)"><span class="mpre">withArrayLen0</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 209, srcSpanStartColumn = 18, srcSpanEndLine = 209, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 209, srcSpanStartColumn = 29, srcSpanEndLine = 209, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_210_1_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_14&#39;)"><span class="hl_fundecl"><span class="mpre">withArrayLen0</span></span></a><span class="mpre"> </span><a name="loc_210_15_210_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_15_210_21&#39;)"><span class="hl_vardecl"><span class="mpre">marker</span></span></a><span class="mpre"> </span><a name="loc_210_22_210_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_22_210_26&#39;)"><span class="hl_vardecl"><span class="mpre">vals</span></span></a><span class="mpre"> </span><a name="loc_210_27_210_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_27_210_28&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">  =
  </span><a href="#loc_108_1_108_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_13&#39;)"><span class="hl_varref"><span class="mpre">allocaArray0</span></span></a><span class="mpre"> </span><a href="#loc_216_5_216_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_5_216_8&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_211_23_211_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_23_211_26&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; do
      </span><a href="#loc_158_1_158_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_11&#39;)"><span class="hl_varref"><span class="mpre">pokeArray0</span></span></a><span class="mpre"> </span><a href="#loc_210_15_210_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_15_210_21&#39;)"><span class="hl_varref"><span class="mpre">marker</span></span></a><span class="mpre"> </span><a href="#loc_211_23_211_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_23_211_26&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_210_22_210_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_22_210_26&#39;)"><span class="hl_varref"><span class="mpre">vals</span></span></a><span class="mpre">
      </span><a name="loc_213_7_213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_7_213_10&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_210_27_210_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_27_210_28&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_216_5_216_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_5_216_8&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_211_23_211_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_23_211_26&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_213_7_213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_7_213_10&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">
  where
    </span><a name="loc_216_5_216_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_5_216_8&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_210_22_210_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_22_210_26&#39;)"><span class="hl_varref"><span class="mpre">vals</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- copying (argument order: destination, source)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- -------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Copy the given number of elements from the second array (source) into the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- first array (destination); the copied areas may /not/ overlap</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_226_1_226_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_10&#39;)"><span class="mpre">copyArray</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 225, srcSpanStartColumn = 14, srcSpanEndLine = 225, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 225, srcSpanStartColumn = 25, srcSpanEndLine = 225, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_226_1_226_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_10&#39;)"><span class="hl_vardecl"><span class="mpre">copyArray</span></span></a><span class="mpre">  = </span><a href="#loc_229_5_229_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_5_229_11&#39;)"><span class="hl_varref"><span class="mpre">doCopy</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
  where
    </span><a href="#loc_229_5_229_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_5_229_11&#39;)"><span class="mpre">doCopy</span></a><span class="mpre">                     :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 228, srcSpanStartColumn = 35, srcSpanEndLine = 228, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 228, srcSpanStartColumn = 47, srcSpanEndLine = 228, srcSpanEndColumn = 49}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a&#39; =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_229_5_229_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_5_229_11&#39;)"><span class="hl_fundecl"><span class="mpre">doCopy</span></span></a><span class="mpre"> </span><a name="loc_229_12_229_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_12_229_17&#39;)"><span class="hl_vardecl"><span class="mpre">dummy</span></span></a><span class="mpre"> </span><a name="loc_229_18_229_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_18_229_22&#39;)"><span class="hl_vardecl"><span class="mpre">dest</span></span></a><span class="mpre"> </span><a name="loc_229_23_229_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_23_229_26&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> </span><a name="loc_229_27_229_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_27_229_31&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre">  = </span><a href="Foreign.Marshal.Utils.html#loc_154_1_154_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Utils.html#loc_154_1_154_10&#39;)"><span class="hl_varref"><span class="mpre">copyBytes</span></span></a><span class="mpre"> </span><a href="#loc_229_18_229_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_18_229_22&#39;)"><span class="hl_varref"><span class="mpre">dest</span></span></a><span class="mpre"> </span><a href="#loc_229_23_229_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_23_229_26&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> (</span><a href="#loc_229_27_229_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_27_229_31&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> </span><a href="#loc_229_12_229_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_12_229_17&#39;)"><span class="hl_varref"><span class="mpre">dummy</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- |Copy the given number of elements from the second array (source) into the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- first array (destination); the copied areas /may/ overlap</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_235_1_235_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_1_235_10&#39;)"><span class="mpre">moveArray</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 234, srcSpanStartColumn = 14, srcSpanEndLine = 234, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 234, srcSpanStartColumn = 25, srcSpanEndLine = 234, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_235_1_235_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_1_235_10&#39;)"><span class="hl_vardecl"><span class="mpre">moveArray</span></span></a><span class="mpre">  = </span><a href="#loc_238_5_238_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_5_238_11&#39;)"><span class="hl_varref"><span class="mpre">doMove</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
  where
    </span><a href="#loc_238_5_238_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_5_238_11&#39;)"><span class="mpre">doMove</span></a><span class="mpre">                     :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 237, srcSpanStartColumn = 35, srcSpanEndLine = 237, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 237, srcSpanStartColumn = 47, srcSpanEndLine = 237, srcSpanEndColumn = 49}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a&#39; =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_238_5_238_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_5_238_11&#39;)"><span class="hl_fundecl"><span class="mpre">doMove</span></span></a><span class="mpre"> </span><a name="loc_238_12_238_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_12_238_17&#39;)"><span class="hl_vardecl"><span class="mpre">dummy</span></span></a><span class="mpre"> </span><a name="loc_238_18_238_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_18_238_22&#39;)"><span class="hl_vardecl"><span class="mpre">dest</span></span></a><span class="mpre"> </span><a name="loc_238_23_238_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_23_238_26&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> </span><a name="loc_238_27_238_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_27_238_31&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre">  = </span><a href="Foreign.Marshal.Utils.html#loc_161_1_161_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Utils.html#loc_161_1_161_10&#39;)"><span class="hl_varref"><span class="mpre">moveBytes</span></span></a><span class="mpre"> </span><a href="#loc_238_18_238_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_18_238_22&#39;)"><span class="hl_varref"><span class="mpre">dest</span></span></a><span class="mpre"> </span><a href="#loc_238_23_238_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_23_238_26&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> (</span><a href="#loc_238_27_238_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_27_238_31&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> </span><a href="#loc_238_12_238_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_12_238_17&#39;)"><span class="hl_varref"><span class="mpre">dummy</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- finding the length</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Return the number of elements in an array, excluding the terminator</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_247_1_247_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_13&#39;)"><span class="mpre">lengthArray0</span></a><span class="mpre">            :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 246, srcSpanStartColumn = 28, srcSpanEndLine = 246, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 246, srcSpanStartColumn = 28, srcSpanEndLine = 246, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpa"><span class="mpre">(Storable a, Eq a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_247_1_247_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_13&#39;)"><span class="hl_fundecl"><span class="mpre">lengthArray0</span></span></a><span class="mpre"> </span><a name="loc_247_14_247_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_14_247_20&#39;)"><span class="hl_vardecl"><span class="mpre">marker</span></span></a><span class="mpre"> </span><a name="loc_247_21_247_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_21_247_24&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre">  = </span><a href="#loc_249_5_249_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_5_249_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  where
    </span><a name="loc_249_5_249_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_5_249_9&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_249_10_249_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_10_249_11&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = do
        </span><a name="loc_250_9_250_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_9_250_12&#39;)"><span class="hl_vardecl"><span class="mpre">val</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">peekElemOff</span></span><span class="mpre"> </span><a href="#loc_247_21_247_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_21_247_24&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_249_10_249_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_10_249_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
        if </span><a href="#loc_250_9_250_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_9_250_12&#39;)"><span class="hl_varref"><span class="mpre">val</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_247_14_247_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_14_247_20&#39;)"><span class="hl_varref"><span class="mpre">marker</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_249_10_249_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_10_249_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> else </span><a href="#loc_249_5_249_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_5_249_9&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_249_10_249_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_10_249_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- indexing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- --------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Advance a pointer into an array by the given number of elements</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_260_1_260_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_1_260_11&#39;)"><span class="mpre">advancePtr</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 259, srcSpanStartColumn = 15, srcSpanEndLine = 259, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 259, srcSpanStartColumn = 26, srcSpanEndLine = 259, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_260_1_260_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_1_260_11&#39;)"><span class="hl_vardecl"><span class="mpre">advancePtr</span></span></a><span class="mpre">  = </span><a href="#loc_263_5_263_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_5_263_14&#39;)"><span class="hl_varref"><span class="mpre">doAdvance</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
  where
    </span><a href="#loc_263_5_263_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_5_263_14&#39;)"><span class="mpre">doAdvance</span></a><span class="mpre">             :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 262, srcSpanStartColumn = 30, srcSpanEndLine = 262, srcSpanEndColumn = 44}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4.7.0.0/Foreign/Marshal/Array.hs&quot;, srcSpanStartLine = 262, srcSpanStartColumn = 42, srcSpanEndLine = 262, srcSpanEndColumn = 44}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/base-4"><span class="mpre">Storable a&#39; =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre">
    </span><a name="loc_263_5_263_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_5_263_14&#39;)"><span class="hl_fundecl"><span class="mpre">doAdvance</span></span></a><span class="mpre"> </span><a name="loc_263_15_263_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_15_263_20&#39;)"><span class="hl_vardecl"><span class="mpre">dummy</span></span></a><span class="mpre"> </span><a name="loc_263_21_263_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_21_263_24&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a name="loc_263_25_263_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_25_263_26&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">  = </span><a href="#loc_263_21_263_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_21_263_24&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> (</span><a href="#loc_263_25_263_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_25_263_26&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> </span><a href="#loc_263_15_263_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_15_263_20&#39;)"><span class="hl_varref"><span class="mpre">dummy</span></span></a><span class="mpre">)

</span></div></body></html>