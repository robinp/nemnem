<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.X509</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Read/Write X509 Certificate, CRL and their signed equivalents.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Follows RFC5280 / RFC6818</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.X509
    (
    </span><span class="hl_comment"><span class="mpre">-- * Types</span></span><span class="mpre">
      SignedCertificate
    , SignedCRL
    , Certificate(..)
    , PubKey(..)
    , PrivKey(..)
    , pubkeyToAlg
    , privkeyToAlg
    , module Data.X509.AlgorithmIdentifier
    , module Data.X509.Ext
    , module Data.X509.ExtensionRaw

    </span><span class="hl_comment"><span class="mpre">-- * Certificate Revocation List (CRL)</span></span><span class="mpre">
    , module Data.X509.CRL

    </span><span class="hl_comment"><span class="mpre">-- * Naming</span></span><span class="mpre">
    , DistinguishedName(..)
    , DnElement(..)
    , ASN1CharacterString(..)
    , getDnElement

    </span><span class="hl_comment"><span class="mpre">-- * Certificate Chain</span></span><span class="mpre">
    , module Data.X509.CertificateChain

    </span><span class="hl_comment"><span class="mpre">-- * Signed types and marshalling</span></span><span class="mpre">
    , Signed(..)
    , SignedExact
    , getSigned
    , getSignedData
    , objectToSignedExact
    , encodeSignedObject
    , decodeSignedObject

    </span><span class="hl_comment"><span class="mpre">-- * Parametrized Signed accessor</span></span><span class="mpre">
    , getCertificate
    , getCRL
    , decodeSignedCertificate
    , decodeSignedCRL

    </span><span class="hl_comment"><span class="mpre">-- * Hash distinguished names related function</span></span><span class="mpre">
    , hashDN
    , hashDN_old
    ) where

import Control.Arrow (</span><a href="Control.Arrow.html#loc_96_5_96_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_96_5_96_11&#39;)"><span class="mpre">second</span></a><span class="mpre">)

import Data.ASN1.Types
import Data.ASN1.Encoding
import Data.ASN1.BinaryEncoding
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 18, srcSpanEndLine = 63, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B

import Data.X509.Cert
import Data.X509.Ext
import Data.X509.ExtensionRaw
import Data.X509.CRL
import Data.X509.CertificateChain
import Data.X509.DistinguishedName
import Data.X509.Signed
import Data.X509.PublicKey
import Data.X509.PrivateKey
import Data.X509.AlgorithmIdentifier

import qualified Crypto.Hash.MD5 as MD5
import qualified Crypto.Hash.SHA1 as SHA1

</span><span class="hl_comment"><span class="mpre">-- | A Signed Certificate</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509.hs&quot;, srcSpanStartLine = 80, srcSpanStartColumn = 1, srcSpanEndLine = 80, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509.hs&quot;, srcSpanStartLine = 80, srcSpanStartColumn = 1, srcSpanEndLine = 80, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509.hs&quot;, srcSpanStartLine = 80, srcSpanStartColumn = 24, src"><span class="mpre">type SignedCertificate = SignedExact Certificate</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A Signed CRL</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 1, srcSpanEndLine = 83, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 1, srcSpanEndLine = 83, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509.hs&quot;, srcSpanStartLine = 83, srcSpanStartColumn = 24, src"><span class="mpre">type SignedCRL         = SignedExact CRL</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get the Certificate associated to a SignedCertificate</span></span><span class="mpre">
</span><a href="#loc_87_1_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_15&#39;)"><span class="mpre">getCertificate</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">SignedCertificate</span></span><span class="mpre"> -&gt; </span><a href="Data.X509.Cert.html#loc_38_6_38_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Cert.html#loc_38_6_38_17&#39;)"><span class="hl_tyconref"><span class="mpre">Certificate</span></span></a><span class="mpre">
</span><a name="loc_87_1_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_15&#39;)"><span class="hl_vardecl"><span class="mpre">getCertificate</span></span></a><span class="mpre"> = </span><a href="Data.X509.Signed.html#loc_58_7_58_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_58_7_58_19&#39;)"><span class="hl_varref"><span class="mpre">signedObject</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.X509.Signed.html#loc_66_7_66_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_66_7_66_16&#39;)"><span class="hl_varref"><span class="mpre">getSigned</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get the CRL associated to a SignedCRL</span></span><span class="mpre">
</span><a href="#loc_91_1_91_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_7&#39;)"><span class="mpre">getCRL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">SignedCRL</span></span><span class="mpre"> -&gt; </span><a href="Data.X509.CRL.html#loc_29_6_29_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CRL.html#loc_29_6_29_9&#39;)"><span class="hl_tyconref"><span class="mpre">CRL</span></span></a><span class="mpre">
</span><a name="loc_91_1_91_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_7&#39;)"><span class="hl_vardecl"><span class="mpre">getCRL</span></span></a><span class="mpre"> = </span><a href="Data.X509.Signed.html#loc_58_7_58_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_58_7_58_19&#39;)"><span class="hl_varref"><span class="mpre">signedObject</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.X509.Signed.html#loc_66_7_66_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_66_7_66_16&#39;)"><span class="hl_varref"><span class="mpre">getSigned</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Try to decode a bytestring to a SignedCertificate</span></span><span class="mpre">
</span><a href="#loc_95_1_95_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_24&#39;)"><span class="mpre">decodeSignedCertificate</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">SignedCertificate</span></span><span class="mpre">
</span><a name="loc_95_1_95_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_24&#39;)"><span class="hl_vardecl"><span class="mpre">decodeSignedCertificate</span></span></a><span class="mpre"> = </span><a href="Data.X509.Signed.html#loc_126_1_126_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_126_1_126_19&#39;)"><span class="hl_varref"><span class="mpre">decodeSignedObject</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Try to decode a bytestring to a SignedCRL</span></span><span class="mpre">
</span><a href="#loc_99_1_99_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_16&#39;)"><span class="mpre">decodeSignedCRL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">SignedCRL</span></span><span class="mpre">
</span><a name="loc_99_1_99_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_16&#39;)"><span class="hl_vardecl"><span class="mpre">decodeSignedCRL</span></span></a><span class="mpre"> = </span><a href="Data.X509.Signed.html#loc_126_1_126_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.Signed.html#loc_126_1_126_19&#39;)"><span class="hl_varref"><span class="mpre">decodeSignedObject</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Make an OpenSSL style hash of distinguished name</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- OpenSSL algorithm is odd, and has been replicated here somewhat.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- only lower the case of ascii character.</span></span><span class="mpre">
</span><a href="#loc_106_1_106_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_7&#39;)"><span class="mpre">hashDN</span></a><span class="mpre"> :: </span><a href="Data.X509.DistinguishedName.html#loc_25_9_25_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.DistinguishedName.html#loc_25_9_25_26&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_106_1_106_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_7&#39;)"><span class="hl_vardecl"><span class="mpre">hashDN</span></span></a><span class="mpre"> = </span><a href="#loc_120_1_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_8&#39;)"><span class="hl_varref"><span class="mpre">shorten</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Hash.SHA1.html#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.SHA1.html#loc_126_1_126_5&#39;)"><span class="hl_varref"><span class="mpre">SHA1.hash</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.ASN1.Encoding.html#loc_51_1_51_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_51_1_51_12&#39;)"><span class="hl_varref"><span class="mpre">encodeASN1&#39;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.html#loc_30_12_30_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_30_12_30_15&#39;)"><span class="hl_conref"><span class="mpre">DER</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> [] </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.X509.DistinguishedName.html#loc_48_34_48_56" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.DistinguishedName.html#loc_48_34_48_56&#39;)"><span class="hl_conref"><span class="mpre">DistinguishedNameInner</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_107_11_107_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_11_107_22&#39;)"><span class="hl_varref"><span class="mpre">dnLowerUTF8</span></span></a><span class="mpre">
    where </span><a name="loc_107_11_107_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_11_107_22&#39;)"><span class="hl_fundecl"><span class="mpre">dnLowerUTF8</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">DistinguishedName</span></span><span class="mpre"> </span><a name="loc_107_42_107_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_42_107_43&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">DistinguishedName</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Control.Arrow.html#loc_96_5_96_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_96_5_96_11&#39;)"><span class="hl_varref"><span class="mpre">second</span></span></a><span class="mpre"> </span><a href="#loc_108_11_108_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_11_108_22&#39;)"><span class="hl_varref"><span class="mpre">toLowerUTF8</span></span></a><span class="mpre">) </span><a href="#loc_107_42_107_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_42_107_43&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
          </span><a name="loc_108_11_108_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_11_108_22&#39;)"><span class="hl_fundecl"><span class="mpre">toLowerUTF8</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ASN1CharacterString</span></span><span class="mpre"> _ </span><a name="loc_108_46_108_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_46_108_47&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">ASN1CharacterString</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">UTF8</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.map</span></span><span class="mpre"> </span><a href="#loc_109_11_109_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_23&#39;)"><span class="hl_varref"><span class="mpre">asciiToLower</span></span></a><span class="mpre"> </span><a href="#loc_108_46_108_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_46_108_47&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
          </span><a name="loc_109_11_109_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_23&#39;)"><span class="hl_fundecl"><span class="mpre">asciiToLower</span></span></a><span class="mpre"> </span><a name="loc_109_24_109_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_24_109_25&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">
            | </span><a href="#loc_109_24_109_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_24_109_25&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_112_11_112_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_11_112_14&#39;)"><span class="hl_varref"><span class="mpre">w8A</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_109_24_109_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_24_109_25&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_113_11_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_11_113_14&#39;)"><span class="hl_varref"><span class="mpre">w8Z</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_109_24_109_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_24_109_25&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;A&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;a&#39;</span></span><span class="mpre">)
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">            = </span><a href="#loc_109_24_109_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_24_109_25&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
          </span><a name="loc_112_11_112_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_11_112_14&#39;)"><span class="hl_vardecl"><span class="mpre">w8A</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;A&#39;</span></span><span class="mpre">
          </span><a name="loc_113_11_113_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_11_113_14&#39;)"><span class="hl_vardecl"><span class="mpre">w8Z</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;Z&#39;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create an openssl style old hash of distinguished name</span></span><span class="mpre">
</span><a href="#loc_117_1_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_11&#39;)"><span class="mpre">hashDN_old</span></a><span class="mpre"> :: </span><a href="Data.X509.DistinguishedName.html#loc_25_9_25_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.DistinguishedName.html#loc_25_9_25_26&#39;)"><span class="hl_tyconref"><span class="mpre">DistinguishedName</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_117_1_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_11&#39;)"><span class="hl_vardecl"><span class="mpre">hashDN_old</span></span></a><span class="mpre"> = </span><a href="#loc_120_1_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_8&#39;)"><span class="hl_varref"><span class="mpre">shorten</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Crypto.Hash.MD5.html#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.MD5.html#loc_126_1_126_5&#39;)"><span class="hl_varref"><span class="mpre">MD5.hash</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.ASN1.Encoding.html#loc_51_1_51_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_51_1_51_12&#39;)"><span class="hl_varref"><span class="mpre">encodeASN1&#39;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.html#loc_30_12_30_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_30_12_30_15&#39;)"><span class="hl_conref"><span class="mpre">DER</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> []

</span><a href="#loc_120_1_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_8&#39;)"><span class="mpre">shorten</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_120_1_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_8&#39;)"><span class="hl_fundecl"><span class="mpre">shorten</span></span></a><span class="mpre"> </span><a name="loc_120_9_120_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_10&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_121_11_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> [</span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">]
    where </span><a name="loc_121_11_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_11_121_12&#39;)"><span class="hl_fundecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_121_13_121_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_13_121_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.index</span></span><span class="mpre"> </span><a href="#loc_120_9_120_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_121_13_121_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_13_121_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
</span></div></body></html>