<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, GeneralizedNewtypeDeriving #-}
module Text.ParserCombinators.Poly.StateLazy
  ( </span><span class="hl_comment"><span class="mpre">-- * The Parser datatype</span></span><span class="mpre">
    Parser(P)        </span><span class="hl_comment"><span class="mpre">-- datatype, instance of: Functor, Monad, PolyParse</span></span><span class="mpre">
  , Result(..)        </span><span class="hl_comment"><span class="mpre">-- internal to the parser monad</span></span><span class="mpre">
  , runParser        </span><span class="hl_comment"><span class="mpre">-- :: Parser s t a -&gt; s -&gt; [t] -&gt; (Either String a, s, [t])</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ** Basic parsers</span></span><span class="mpre">
  , next        </span><span class="hl_comment"><span class="mpre">-- :: Parser s t t</span></span><span class="mpre">
  , eof                </span><span class="hl_comment"><span class="mpre">-- :: Parser s t ()</span></span><span class="mpre">
  , satisfy        </span><span class="hl_comment"><span class="mpre">-- :: (t-&gt;Bool) -&gt; Parser s t t</span></span><span class="mpre">
  , onFail      </span><span class="hl_comment"><span class="mpre">-- :: Parser s t a -&gt; Parser s t a -&gt; Parser s t a</span></span><span class="mpre">
  , manyFinally        </span><span class="hl_comment"><span class="mpre">-- :: Parser s t a -&gt; Parser s t z -&gt; Parser s t [a]</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ** State-handling</span></span><span class="mpre">
  , stUpdate    </span><span class="hl_comment"><span class="mpre">-- :: (s-&gt;s) -&gt; Parser s t ()</span></span><span class="mpre">
  , stQuery     </span><span class="hl_comment"><span class="mpre">-- :: (s-&gt;a) -&gt; Parser s t a</span></span><span class="mpre">
  , stGet       </span><span class="hl_comment"><span class="mpre">-- :: Parser s t s</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ** Re-parsing</span></span><span class="mpre">
  , reparse        </span><span class="hl_comment"><span class="mpre">-- :: [t] -&gt; Parser s t ()</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- * Re-export all more general combinators</span></span><span class="mpre">
  , module Text.ParserCombinators.Poly.Base
  , module Control.Applicative
  ) where


import Text.ParserCombinators.Poly.Base hiding (</span><a href="Text.ParserCombinators.Poly.Base.html#loc_197_1_197_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_197_1_197_12&#39;)"><span class="mpre">manyFinally</span></a><span class="mpre">)
import Text.ParserCombinators.Poly.Result
import qualified Text.ParserCombinators.Poly.StateParser as P
import Control.Applicative

#if __GLASGOW_HASKELL__
import Control.Exception hiding (</span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="mpre">bracket</span></a><span class="mpre">)
</span><a href="#loc_33_1_33_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_7&#39;)"><span class="mpre">throwE</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_33_1_33_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_7&#39;)"><span class="hl_fundecl"><span class="mpre">throwE</span></span></a><span class="mpre"> </span><a name="loc_33_8_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_8_33_11&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">throw</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ErrorCall</span></span><span class="mpre"> </span><a href="#loc_33_8_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_8_33_11&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">)
#else
</span><a href="#loc_33_1_33_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_7&#39;)"><span class="mpre">throwE</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><span class="hl_fundecl"><span class="mpre">throwE</span></span><span class="mpre"> </span><a name="loc_36_8_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_8_36_11&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><a href="#loc_36_8_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_8_36_11&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- | The only differences between a State and a StateLazy parser are the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   instance of Applicative, and the type (and implementation) of runParser.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   We therefore need to /newtype/ the original Parser type, to allow it</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   to have a different instance.</span></span><span class="mpre">
newtype </span><a name="loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tycondecl"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_condecl"><span class="mpre">P</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.StateParser.html#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.StateParser.html#loc_30_9_30_15&#39;)"><span class="hl_tyconref"><span class="mpre">P.Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
#ifdef __GLASGOW_HASKELL__
        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/Poly/StateLazy.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 9, srcSpanEndLine = 45, srcSpanEndColumn = 44}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse-1.9/src/Text/ParserCombinators/Poly/StateLazy.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 9, srcSpanEndLine = 45, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/polyparse"><span class="mpre">deriving (Functor,Monad,Commitment)</span></span><span class="mpre">
#else
instance </span><span class="hl_classref"><span class="mpre">Functor</span></span><span class="mpre"> (</span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) where
    </span><span class="hl_fundecl"><span class="mpre">fmap</span></span><span class="mpre"> </span><a name="loc_48_10_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_10_48_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_48_15_48_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_15_48_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_48_10_48_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_10_48_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_48_15_48_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_15_48_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
instance </span><span class="hl_classref"><span class="mpre">Monad</span></span><span class="mpre"> (</span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) where
    </span><span class="hl_fundecl"><span class="mpre">return</span></span><span class="mpre"> </span><a name="loc_50_12_50_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_12_50_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">  = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_50_12_50_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_12_50_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
    </span><span class="hl_fundecl"><span class="mpre">fail</span></span><span class="mpre"> </span><a name="loc_51_10_51_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_10_51_11&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">    = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><a href="#loc_51_10_51_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_10_51_11&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
    (</span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_52_8_52_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_8_52_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) </span><span class="hl_fundecl"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a name="loc_52_15_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_15_52_16&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (</span><a href="#loc_52_8_52_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_8_52_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> (\(</span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_52_33_52_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_33_52_35&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">)-&gt;</span><a href="#loc_52_33_52_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_33_52_35&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_52_15_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_15_52_16&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
instance </span><a href="Text.ParserCombinators.Poly.Base.html#loc_44_7_44_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_44_7_44_17&#39;)"><span class="hl_classref"><span class="mpre">Commitment</span></span></a><span class="mpre"> (</span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) where
    </span><a href="Text.ParserCombinators.Poly.Base.html#loc_49_5_49_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_49_5_49_11&#39;)"><span class="hl_fundecl"><span class="mpre">commit</span></span></a><span class="mpre"> (</span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_54_15_54_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">)   = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.Base.html#loc_49_5_49_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_49_5_49_11&#39;)"><span class="hl_varref"><span class="mpre">commit</span></span></a><span class="mpre"> </span><a href="#loc_54_15_54_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
    (</span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_55_8_55_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_8_55_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><a href="Text.ParserCombinators.Poly.Base.html#loc_52_5_52_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_52_5_52_14&#39;)"><span class="hl_fundecl"><span class="mpre">`adjustErr`</span></span></a><span class="mpre"> </span><a name="loc_55_23_55_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_23_55_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">  = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (</span><a href="#loc_55_8_55_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_8_55_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.Poly.Base.html#loc_52_5_52_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_52_5_52_14&#39;)"><span class="hl_infix"><span class="mpre">`adjustErr`</span></span></a><span class="mpre"> </span><a href="#loc_55_23_55_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_23_55_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
#endif

</span><span class="hl_comment"><span class="mpre">-- | Apply a parser to an input token sequence.</span></span><span class="mpre">
</span><a href="#loc_60_1_60_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_10&#39;)"><span class="mpre">runParser</span></a><span class="mpre"> :: </span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">] -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">, [</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">])
</span><a name="loc_60_1_60_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_10&#39;)"><span class="hl_fundecl"><span class="mpre">runParser</span></span></a><span class="mpre"> (</span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.StateParser.html#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.StateParser.html#loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P.P</span></span></a><span class="mpre"> </span><a name="loc_60_19_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_19_60_20&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">)) = \</span><a name="loc_60_26_60_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_26_60_27&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_63_5_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_15&#39;)"><span class="hl_varref"><span class="mpre">fromResult</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_60_19_60_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_19_60_20&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_60_26_60_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_26_60_27&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
  where
    </span><a href="#loc_63_5_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_15&#39;)"><span class="mpre">fromResult</span></a><span class="mpre"> :: </span><a href="Text.ParserCombinators.Poly.Result.html#loc_13_6_13_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_13_6_13_12&#39;)"><span class="hl_tyconref"><span class="mpre">Result</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">z</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">z</span></span><span class="mpre">)
    </span><a name="loc_63_5_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_15&#39;)"><span class="hl_fundecl"><span class="mpre">fromResult</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26&#39;)"><span class="hl_conref"><span class="mpre">Success</span></span></a><span class="mpre"> (</span><a name="loc_63_26_63_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_26_63_27&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">,</span><a name="loc_63_28_63_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_28_63_29&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) </span><a name="loc_63_31_63_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_31_63_32&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">)  =  (</span><a href="#loc_63_31_63_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_31_63_32&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_63_28_63_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_28_63_29&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_63_26_63_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_26_63_27&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">)
    </span><a href="#loc_63_5_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_15&#39;)"><span class="hl_fundecl"><span class="mpre">fromResult</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26&#39;)"><span class="hl_conref"><span class="mpre">Failure</span></span></a><span class="mpre">   _   </span><a name="loc_64_31_64_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_31_64_32&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">)  =  </span><a href="#loc_33_1_33_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_7&#39;)"><span class="hl_varref"><span class="mpre">throwE</span></span></a><span class="mpre"> </span><a href="#loc_64_31_64_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_31_64_32&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
    </span><a href="#loc_63_5_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_15&#39;)"><span class="hl_fundecl"><span class="mpre">fromResult</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28&#39;)"><span class="hl_conref"><span class="mpre">Committed</span></span></a><span class="mpre"> </span><a name="loc_65_27_65_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_27_65_28&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">)      =  </span><a href="#loc_63_5_63_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_15&#39;)"><span class="hl_varref"><span class="mpre">fromResult</span></span></a><span class="mpre"> </span><a href="#loc_65_27_65_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_27_65_28&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">


instance </span><a href="Control.Applicative.html#loc_113_20_113_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_113_20_113_31&#39;)"><span class="hl_classref"><span class="mpre">Applicative</span></span></a><span class="mpre"> (</span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) where
    </span><a href="Control.Applicative.html#loc_115_5_115_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_115_5_115_9&#39;)"><span class="hl_fundecl"><span class="mpre">pure</span></span></a><span class="mpre"> </span><a name="loc_69_10_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_10_69_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_69_10_69_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_10_69_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   Apply a parsed function to a parsed value.  This version</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   is strict in the result of the function parser, but</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   lazy in the result of the argument parser.  (Argument laziness is</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--   the distinctive feature over other implementations.)</span></span><span class="mpre">
    (</span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.StateParser.html#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.StateParser.html#loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P.P</span></span></a><span class="mpre"> </span><a name="loc_74_13_74_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_13_74_15&#39;)"><span class="hl_vardecl"><span class="mpre">pf</span></span></a><span class="mpre">)) </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a name="loc_74_22_74_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_22_74_24&#39;)"><span class="hl_vardecl"><span class="mpre">px</span></span></a><span class="mpre"> = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.StateParser.html#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.StateParser.html#loc_30_24_30_25&#39;)"><span class="hl_conref"><span class="mpre">P.P</span></span></a><span class="mpre"> (\</span><a name="loc_74_36_74_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_36_74_37&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">-&gt; </span><a href="#loc_76_9_76_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_9_76_17&#39;)"><span class="hl_varref"><span class="mpre">continue</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_74_13_74_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_13_74_15&#39;)"><span class="hl_varref"><span class="mpre">pf</span></span></a><span class="mpre"> </span><a href="#loc_74_36_74_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_36_74_37&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))
      where
        </span><a name="loc_76_9_76_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_9_76_17&#39;)"><span class="hl_fundecl"><span class="mpre">continue</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26&#39;)"><span class="hl_conref"><span class="mpre">Success</span></span></a><span class="mpre"> (</span><a name="loc_76_28_76_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_28_76_29&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">,</span><a name="loc_76_30_76_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_30_76_31&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) </span><a name="loc_76_33_76_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_33_76_34&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) = let (</span><a name="loc_76_43_76_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_43_76_44&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_76_45_76_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_45_76_47&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">,</span><a name="loc_76_48_76_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_48_76_50&#39;)"><span class="hl_vardecl"><span class="mpre">z&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_60_1_60_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_1_60_10&#39;)"><span class="hl_varref"><span class="mpre">runParser</span></span></a><span class="mpre"> </span><a href="#loc_74_22_74_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_22_74_24&#39;)"><span class="hl_varref"><span class="mpre">px</span></span></a><span class="mpre"> </span><a href="#loc_76_30_76_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_30_76_31&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_76_28_76_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_28_76_29&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
                                     in </span><a href="Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_13_19_13_26&#39;)"><span class="hl_conref"><span class="mpre">Success</span></span></a><span class="mpre"> (</span><a href="#loc_76_48_76_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_48_76_50&#39;)"><span class="hl_varref"><span class="mpre">z&#39;</span></span></a><span class="mpre">,</span><a href="#loc_76_45_76_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_45_76_47&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">) (</span><a href="#loc_76_33_76_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_33_76_34&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_76_43_76_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_43_76_44&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
        </span><a href="#loc_76_9_76_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_9_76_17&#39;)"><span class="hl_fundecl"><span class="mpre">continue</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26&#39;)"><span class="hl_conref"><span class="mpre">Failure</span></span></a><span class="mpre"> </span><a name="loc_78_27_78_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_27_78_29&#39;)"><span class="hl_vardecl"><span class="mpre">zs</span></span></a><span class="mpre"> </span><a name="loc_78_30_78_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_30_78_31&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">)    = </span><a href="Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_14_19_14_26&#39;)"><span class="hl_conref"><span class="mpre">Failure</span></span></a><span class="mpre"> </span><a href="#loc_78_27_78_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_27_78_29&#39;)"><span class="hl_varref"><span class="mpre">zs</span></span></a><span class="mpre"> </span><a href="#loc_78_30_78_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_30_78_31&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
        </span><a href="#loc_76_9_76_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_9_76_17&#39;)"><span class="hl_fundecl"><span class="mpre">continue</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28&#39;)"><span class="hl_conref"><span class="mpre">Committed</span></span></a><span class="mpre"> </span><a name="loc_79_29_79_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_29_79_30&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">)     = </span><a href="Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Result.html#loc_15_19_15_28&#39;)"><span class="hl_conref"><span class="mpre">Committed</span></span></a><span class="mpre"> (</span><a href="#loc_76_9_76_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_9_76_17&#39;)"><span class="hl_varref"><span class="mpre">continue</span></span></a><span class="mpre"> </span><a href="#loc_79_29_79_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_29_79_30&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
#if defined(GLASGOW_HASKELL) &amp;&amp; GLASGOW_HASKELL &gt; 610
    </span><a name="loc_81_5_81_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_5_81_6&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">  </span><a href="Control.Applicative.html#loc_125_5_125_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_125_5_125_9&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;*</span></span></a><span class="mpre">  </span><a name="loc_81_12_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_12_81_13&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">  = </span><a href="#loc_81_5_81_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_5_81_6&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.Poly.Base.html#loc_79_4_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_79_4_79_13&#39;)"><span class="hl_infix"><span class="mpre">`discard`</span></span></a><span class="mpre"> </span><a href="#loc_81_12_81_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_12_81_13&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">
#endif

instance </span><a href="Control.Applicative.html#loc_138_24_138_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_138_24_138_35&#39;)"><span class="hl_classref"><span class="mpre">Alternative</span></span></a><span class="mpre"> (</span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">) where
    </span><a href="Control.Applicative.html#loc_140_5_140_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_140_5_140_10&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre">     = </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;no parse&quot;</span></span><span class="mpre">
    </span><a name="loc_86_5_86_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_6&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_142_5_142_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_142_5_142_10&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;|&gt;</span></span></a><span class="mpre"> </span><a name="loc_86_11_86_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_11_86_12&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre">   = </span><a href="#loc_86_5_86_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_6&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="hl_infix"><span class="mpre">`onFail`</span></span></a><span class="mpre"> </span><a href="#loc_86_11_86_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_11_86_12&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

instance </span><a href="Text.ParserCombinators.Poly.Base.html#loc_66_7_66_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_66_7_66_16&#39;)"><span class="hl_classref"><span class="mpre">PolyParse</span></span></a><span class="mpre"> (</span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Simply return the next token in the input tokenstream.</span></span><span class="mpre">
</span><a href="#loc_94_1_94_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_5&#39;)"><span class="mpre">next</span></a><span class="mpre">    ::  </span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">
</span><a name="loc_94_1_94_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_5&#39;)"><span class="hl_vardecl"><span class="mpre">next</span></span></a><span class="mpre">    = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.Poly.StateParser.html#loc_87_1_87_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.StateParser.html#loc_87_1_87_5&#39;)"><span class="hl_varref"><span class="mpre">P.next</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Succeed if the end of file/input has been reached, fail otherwise.</span></span><span class="mpre">
</span><a href="#loc_98_1_98_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_4&#39;)"><span class="mpre">eof</span></a><span class="mpre">     :: </span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_98_1_98_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_4&#39;)"><span class="hl_vardecl"><span class="mpre">eof</span></span></a><span class="mpre">     = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.Poly.StateParser.html#loc_93_1_93_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.StateParser.html#loc_93_1_93_4&#39;)"><span class="hl_varref"><span class="mpre">P.eof</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Return the next token if it satisfies the given predicate.</span></span><span class="mpre">
</span><a href="#loc_102_1_102_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_8&#39;)"><span class="mpre">satisfy</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">-&gt;</span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">
</span><a name="loc_102_1_102_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_8&#39;)"><span class="hl_vardecl"><span class="mpre">satisfy</span></span></a><span class="mpre"> = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Text.ParserCombinators.Poly.StateParser.html#loc_100_1_100_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.StateParser.html#loc_100_1_100_8&#39;)"><span class="hl_varref"><span class="mpre">P.satisfy</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @p `onFail` q@ means parse p, unless p fails, in which case</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   parse q instead.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Can be chained together to give multiple attempts to parse something.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   (Note that q could itself be a failing parser, e.g. to change the error</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   message from that defined in p to something different.)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   However, a severe failure in p cannot be ignored.</span></span><span class="mpre">
</span><a href="#loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="mpre">onFail</span></a><span class="mpre">  :: </span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="hl_fundecl"><span class="mpre">onFail</span></span></a><span class="mpre"> (</span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_111_11_111_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_12&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">) (</span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><a name="loc_111_17_111_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_17_111_18&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (</span><a href="#loc_111_11_111_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_12&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="Text.ParserCombinators.Poly.StateParser.html#loc_77_7_77_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.StateParser.html#loc_77_7_77_15&#39;)"><span class="hl_infix"><span class="mpre">`P.onFail`</span></span></a><span class="mpre"> </span><a href="#loc_111_17_111_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_17_111_18&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Push some tokens back onto the front of the input stream and reparse.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   This is useful e.g. for recursively expanding macros.  When the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   user-parser recognises a macro use, it can lookup the macro</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   expansion from the parse state, lex it, and then stuff the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   lexed expansion back down into the parser.</span></span><span class="mpre">
</span><a href="#loc_119_1_119_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_8&#39;)"><span class="mpre">reparse</span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">] -&gt; </span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_119_1_119_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_8&#39;)"><span class="hl_vardecl"><span class="mpre">reparse</span></span></a><span class="mpre"> = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Text.ParserCombinators.Poly.StateParser.html#loc_126_1_126_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.StateParser.html#loc_126_1_126_8&#39;)"><span class="hl_varref"><span class="mpre">P.reparse</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- State handling</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Update the internal state.</span></span><span class="mpre">
</span><a href="#loc_126_1_126_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_9&#39;)"><span class="mpre">stUpdate</span></a><span class="mpre">   :: (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">) -&gt; </span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_126_1_126_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_9&#39;)"><span class="hl_fundecl"><span class="mpre">stUpdate</span></span></a><span class="mpre"> </span><a name="loc_126_10_126_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_10_126_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">  = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.StateParser.html#loc_108_1_108_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.StateParser.html#loc_108_1_108_9&#39;)"><span class="hl_varref"><span class="mpre">P.stUpdate</span></span></a><span class="mpre"> </span><a href="#loc_126_10_126_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_10_126_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Query the internal state.</span></span><span class="mpre">
</span><a href="#loc_130_1_130_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_8&#39;)"><span class="mpre">stQuery</span></a><span class="mpre">    :: (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_130_1_130_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_8&#39;)"><span class="hl_fundecl"><span class="mpre">stQuery</span></span></a><span class="mpre"> </span><a name="loc_130_9_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_9_130_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">   = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.StateParser.html#loc_112_1_112_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.StateParser.html#loc_112_1_112_8&#39;)"><span class="hl_varref"><span class="mpre">P.stQuery</span></span></a><span class="mpre"> </span><a href="#loc_130_9_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_9_130_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Deliver the entire internal state.</span></span><span class="mpre">
</span><a href="#loc_134_1_134_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_6&#39;)"><span class="mpre">stGet</span></a><span class="mpre">      :: </span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_134_1_134_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_6&#39;)"><span class="hl_vardecl"><span class="mpre">stGet</span></span></a><span class="mpre">       = </span><a href="#loc_43_24_43_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_24_43_25&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> (</span><a href="Text.ParserCombinators.Poly.StateParser.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.StateParser.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">P.stGet</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">


</span><a href="#loc_160_1_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_12&#39;)"><span class="mpre">manyFinally</span></a><span class="mpre"> :: </span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">z</span></span><span class="mpre"> -&gt; </span><a href="#loc_43_9_43_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_9_43_15&#39;)"><span class="hl_tyconref"><span class="mpre">Parser</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><span class="hl_comment"><span class="mpre">{-
manyFinally pp@(P p) pt@(P t) = P (\s ts -&gt; item s ts (p s ts))
    where
      item _ _  (Success ts s x) = success ts s x
      item s ts (Failure _ _ e)  = terminate (t s ts)
      item s ts (Committed r)    = Committed (within r)

      success ts s x =
            let (tail,s&#39;,ts&#39;) = runParser (manyFinally pp pt) s ts
            in Success ts&#39; s&#39; (x:tail)

      terminate (Success ts s _) = Success ts s []
      terminate (Failure ts s e) = Failure ts s e
      terminate (Committed r)    = Committed (terminate r)

      within (Success ts s x)    = success ts s x
      within (Failure ts s e)    = Failure ts s e
      within (Committed r)       = within r
-}</span></span><span class="mpre">

</span><a name="loc_160_1_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_12&#39;)"><span class="hl_fundecl"><span class="mpre">manyFinally</span></span></a><span class="mpre"> </span><a name="loc_160_13_160_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_13_160_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre"> =
    (do </span><a name="loc_161_9_161_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_10&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_160_13_160_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_13_160_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_161_9_161_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_10&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><a href="Text.ParserCombinators.Poly.Base.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_74_1_74_6&#39;)"><span class="hl_infix"><span class="mpre">`apply`</span></span></a><span class="mpre"> </span><a href="#loc_160_1_160_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_1_160_12&#39;)"><span class="hl_varref"><span class="mpre">manyFinally</span></span></a><span class="mpre"> </span><a href="#loc_160_13_160_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_13_160_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">)
      </span><a href="#loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="hl_infix"><span class="mpre">`onFail`</span></span></a><span class="mpre">
    (do </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [])
      </span><a href="#loc_111_1_111_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_7&#39;)"><span class="hl_infix"><span class="mpre">`onFail`</span></span></a><span class="mpre">
    </span><a href="Text.ParserCombinators.Poly.Base.html#loc_56_5_56_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.Poly.Base.html#loc_56_5_56_11&#39;)"><span class="hl_varref"><span class="mpre">oneOf&#39;</span></span></a><span class="mpre"> [ (</span><span class="hl_string"><span class="mpre">&quot;item in sequence&quot;</span></span><span class="mpre">,    (do </span><a href="#loc_160_13_160_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_13_160_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []))
           , (</span><span class="hl_string"><span class="mpre">&quot;sequence terminator&quot;</span></span><span class="mpre">, (do </span><a href="#loc_160_15_160_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_15_160_16&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [])) ]

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------</span></span><span class="mpre">
</span></div></body></html>