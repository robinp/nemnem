<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP                 #-}
{-# LANGUAGE OverloadedStrings   #-}
{-# LANGUAGE ScopedTypeVariables #-}

module System.IO.Streams.Tests.Process (tests) where

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Process.hs&quot;, srcSpanStartLine = 8, srcSpanStartColumn = 18, srcSpanEndLine = 8, srcSpanEndColumn = 36}, srcInfoPoints = []}) &quot;Control.Concurrent&quot;"><span class="mpre">Control.Concurrent</span></span><span class="mpre">
import           Control.Exception
import           Control.Monad                  (</span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="mpre">liftM</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_195_1_195_5&#39;)"><span class="mpre">void</span></a><span class="mpre">)
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Process.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 18, srcSpanEndLine = 11, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre">          (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Process.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 18, srcSpanEndLine = 12, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre">          as S
import qualified System.IO.Streams              as Streams
import           System.Timeout
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Process.hs&quot;, srcSpanStartLine = 15, srcSpanStartColumn = 18, srcSpanEndLine = 15, srcSpanEndColumn = 32}, srcInfoPoints = []}) &quot;Test.Framework&quot;"><span class="mpre">Test.Framework</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Process.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 18, srcSpanEndLine = 16, srcSpanEndColumn = 48}, srcInfoPoints = []}) &quot;Test.Framework.Providers.HUnit&quot;"><span class="mpre">Test.Framework.Providers.HUnit</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/test/System/IO/Streams/Tests/Process.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 18, srcSpanEndLine = 17, srcSpanEndColumn = 28}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">                     hiding (Test)
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_22_1_22_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_6&#39;)"><span class="mpre">tests</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">]
#ifndef ENABLE_PROCESS_TESTS
</span><a name="loc_22_1_22_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = []
#else
</span><span class="hl_vardecl"><span class="mpre">tests</span></span><span class="mpre"> = [ </span><a href="#loc_31_1_31_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_23&#39;)"><span class="hl_varref"><span class="mpre">testInteractiveCommand</span></span></a><span class="mpre">
        , </span><a href="#loc_42_1_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_23&#39;)"><span class="hl_varref"><span class="mpre">testInteractiveProcess</span></span></a><span class="mpre">
        ]


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_31_1_31_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_23&#39;)"><span class="mpre">testInteractiveCommand</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_31_1_31_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_23&#39;)"><span class="hl_vardecl"><span class="mpre">testInteractiveCommand</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;process/interactiveCommand&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    (</span><a name="loc_32_6_32_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_9&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre">, </span><a name="loc_32_11_32_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_14&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.Process.html#loc_36_1_36_22" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Process.html#loc_36_1_36_22&#39;)"><span class="hl_varref"><span class="mpre">Streams.runInteractiveCommand</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;cat&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_61_1_61_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> [</span><a href="#loc_37_5_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_13&#39;)"><span class="hl_varref"><span class="mpre">expected</span></span></a><span class="mpre">]
    </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;interactiveCommand&quot;</span></span><span class="mpre"> </span><a href="#loc_37_5_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_13&#39;)"><span class="hl_varref"><span class="mpre">expected</span></span></a><span class="mpre"> </span><a href="#loc_32_6_32_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_9&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;interactiveCommand&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_32_11_32_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_14&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">

  where
    </span><a name="loc_37_5_37_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_13&#39;)"><span class="hl_vardecl"><span class="mpre">expected</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;testing 1-2-3&quot;</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_42_1_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_23&#39;)"><span class="mpre">testInteractiveProcess</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Test</span></span><span class="mpre">
</span><a name="loc_42_1_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_23&#39;)"><span class="hl_vardecl"><span class="mpre">testInteractiveProcess</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">testCase</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;process/interactiveProcess&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    (</span><a name="loc_43_6_43_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_6_43_9&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre">, </span><a name="loc_43_11_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_14&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">) &lt;- </span><a href="System.IO.Streams.Process.html#loc_73_1_73_22" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Process.html#loc_73_1_73_22&#39;)"><span class="hl_varref"><span class="mpre">Streams.runInteractiveProcess</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/usr/bin/tr&quot;</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;a-z&quot;</span></span><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;A-Z&quot;</span></span><span class="mpre">]
                                                </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                      </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_61_1_61_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> [</span><a href="#loc_50_5_50_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_14&#39;)"><span class="hl_varref"><span class="mpre">inputdata</span></span></a><span class="mpre">]
    </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;interactiveProcess&quot;</span></span><span class="mpre"> </span><a href="#loc_51_5_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_13&#39;)"><span class="hl_varref"><span class="mpre">expected</span></span></a><span class="mpre"> </span><a href="#loc_43_6_43_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_6_43_9&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">assertEqual</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;interactiveProcess&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_43_11_43_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_14&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">

  where
    </span><a name="loc_50_5_50_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_14&#39;)"><span class="hl_vardecl"><span class="mpre">inputdata</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;testing 1-2-3&quot;</span></span><span class="mpre">
    </span><a name="loc_51_5_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_13&#39;)"><span class="hl_vardecl"><span class="mpre">expected</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;TESTING 1-2-3&quot;</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_61_1_61_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_4&#39;)"><span class="mpre">run</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">]
    -&gt; (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">Streams.OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">,
        </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">Streams.InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">,
        </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">Streams.InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">,
        </span><span class="hl_tyconref"><span class="mpre">Streams.ProcessHandle</span></span><span class="mpre">)
     -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)
</span><a name="loc_61_1_61_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_4&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> </span><a name="loc_61_5_61_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_10&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> (</span><a name="loc_61_12_61_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_12_61_17&#39;)"><span class="hl_vardecl"><span class="mpre">stdin</span></span></a><span class="mpre">, </span><a name="loc_61_19_61_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_19_61_25&#39;)"><span class="hl_vardecl"><span class="mpre">stdout</span></span></a><span class="mpre">, </span><a name="loc_61_27_61_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_27_61_33&#39;)"><span class="hl_vardecl"><span class="mpre">stderr</span></span></a><span class="mpre">, </span><a name="loc_61_35_61_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_35_61_48&#39;)"><span class="hl_vardecl"><span class="mpre">processHandle</span></span></a><span class="mpre">) = </span><a href="#loc_68_5_68_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_5_68_9&#39;)"><span class="hl_varref"><span class="mpre">tout</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5000000</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_62_5_62_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_7&#39;)"><span class="hl_vardecl"><span class="mpre">me</span></span></a><span class="mpre">   &lt;- </span><span class="hl_varref"><span class="mpre">myThreadId</span></span><span class="mpre">
    </span><a name="loc_63_5_63_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_9&#39;)"><span class="hl_vardecl"><span class="mpre">outM</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newEmptyMVar</span></span><span class="mpre">
    </span><a name="loc_64_5_64_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_9&#39;)"><span class="hl_vardecl"><span class="mpre">errM</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newEmptyMVar</span></span><span class="mpre">
    </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">bracket</span></span></a><span class="mpre"> (</span><a href="#loc_75_5_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_14&#39;)"><span class="hl_varref"><span class="mpre">mkThreads</span></span></a><span class="mpre"> </span><a href="#loc_62_5_62_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_7&#39;)"><span class="hl_varref"><span class="mpre">me</span></span></a><span class="mpre"> </span><a href="#loc_63_5_63_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_9&#39;)"><span class="hl_varref"><span class="mpre">outM</span></span></a><span class="mpre"> </span><a href="#loc_64_5_64_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_9&#39;)"><span class="hl_varref"><span class="mpre">errM</span></span></a><span class="mpre">) </span><a href="#loc_80_5_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_16&#39;)"><span class="hl_varref"><span class="mpre">killThreads</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_84_5_84_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_63_5_63_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_5_63_9&#39;)"><span class="hl_varref"><span class="mpre">outM</span></span></a><span class="mpre"> </span><a href="#loc_64_5_64_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_9&#39;)"><span class="hl_varref"><span class="mpre">errM</span></span></a><span class="mpre">

  where
    </span><a name="loc_68_5_68_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_5_68_9&#39;)"><span class="hl_fundecl"><span class="mpre">tout</span></span></a><span class="mpre"> </span><a name="loc_68_10_68_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_10_68_11&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_68_12_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_12_68_13&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="System.Timeout.html#loc_79_1_79_8" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Timeout.html#loc_79_1_79_8&#39;)"><span class="hl_varref"><span class="mpre">timeout</span></span></a><span class="mpre"> </span><a href="#loc_68_10_68_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_10_68_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_68_12_68_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_12_68_13&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;timeout&quot;</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">

    </span><a name="loc_70_5_70_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_5_70_11&#39;)"><span class="hl_fundecl"><span class="mpre">barfTo</span></span></a><span class="mpre"> </span><a name="loc_70_12_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_12_70_14&#39;)"><span class="hl_vardecl"><span class="mpre">me</span></span></a><span class="mpre"> (</span><a name="loc_70_16_70_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_16_70_17&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">SomeException</span></span><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">throwTo</span></span><span class="mpre"> </span><a href="#loc_70_12_70_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_12_70_14&#39;)"><span class="hl_varref"><span class="mpre">me</span></span></a><span class="mpre"> </span><a href="#loc_70_16_70_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_16_70_17&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">

    </span><a name="loc_72_5_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_11&#39;)"><span class="hl_fundecl"><span class="mpre">killMe</span></span></a><span class="mpre"> </span><a name="loc_72_12_72_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_12_72_19&#39;)"><span class="hl_vardecl"><span class="mpre">restore</span></span></a><span class="mpre"> </span><a name="loc_72_20_72_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_20_72_22&#39;)"><span class="hl_vardecl"><span class="mpre">me</span></span></a><span class="mpre"> </span><a name="loc_72_23_72_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_23_72_24&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> =
        </span><a href="Control.Monad.html#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_195_1_195_5&#39;)"><span class="hl_varref"><span class="mpre">void</span></span></a><span class="mpre"> (</span><a href="Control.Exception.Base.html#loc_212_1_212_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_212_1_212_4&#39;)"><span class="hl_varref"><span class="mpre">try</span></span></a><span class="mpre"> (</span><a href="#loc_72_12_72_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_12_72_19&#39;)"><span class="hl_varref"><span class="mpre">restore</span></span></a><span class="mpre"> </span><a href="#loc_72_23_72_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_23_72_24&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> (</span><a href="#loc_70_5_70_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_5_70_11&#39;)"><span class="hl_varref"><span class="mpre">barfTo</span></span></a><span class="mpre"> </span><a href="#loc_72_20_72_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_20_72_22&#39;)"><span class="hl_varref"><span class="mpre">me</span></span></a><span class="mpre">) </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">)

    </span><a name="loc_75_5_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_14&#39;)"><span class="hl_fundecl"><span class="mpre">mkThreads</span></span></a><span class="mpre"> </span><a name="loc_75_15_75_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_17&#39;)"><span class="hl_vardecl"><span class="mpre">me</span></span></a><span class="mpre"> </span><a name="loc_75_18_75_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_18_75_22&#39;)"><span class="hl_vardecl"><span class="mpre">outM</span></span></a><span class="mpre"> </span><a name="loc_75_23_75_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_23_75_27&#39;)"><span class="hl_vardecl"><span class="mpre">errM</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_428_1_428_5" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_428_1_428_5&#39;)"><span class="hl_varref"><span class="mpre">mask</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_75_38_75_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_38_75_45&#39;)"><span class="hl_vardecl"><span class="mpre">restore</span></span></a><span class="mpre"> -&gt; do
        </span><a name="loc_76_9_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_9_76_13&#39;)"><span class="hl_vardecl"><span class="mpre">tid1</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">forkIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_72_5_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_11&#39;)"><span class="hl_varref"><span class="mpre">killMe</span></span></a><span class="mpre"> </span><a href="#loc_75_38_75_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_38_75_45&#39;)"><span class="hl_varref"><span class="mpre">restore</span></span></a><span class="mpre"> </span><a href="#loc_75_15_75_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_17&#39;)"><span class="hl_varref"><span class="mpre">me</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_5_90_10&#39;)"><span class="hl_varref"><span class="mpre">snarf</span></span></a><span class="mpre"> </span><a href="#loc_61_19_61_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_19_61_25&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre"> </span><a href="#loc_75_18_75_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_18_75_22&#39;)"><span class="hl_varref"><span class="mpre">outM</span></span></a><span class="mpre">
        </span><a name="loc_77_9_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_13&#39;)"><span class="hl_vardecl"><span class="mpre">tid2</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">forkIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_72_5_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_5_72_11&#39;)"><span class="hl_varref"><span class="mpre">killMe</span></span></a><span class="mpre"> </span><a href="#loc_75_38_75_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_38_75_45&#39;)"><span class="hl_varref"><span class="mpre">restore</span></span></a><span class="mpre"> </span><a href="#loc_75_15_75_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_15_75_17&#39;)"><span class="hl_varref"><span class="mpre">me</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_5_90_10&#39;)"><span class="hl_varref"><span class="mpre">snarf</span></span></a><span class="mpre"> </span><a href="#loc_61_27_61_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_27_61_33&#39;)"><span class="hl_varref"><span class="mpre">stderr</span></span></a><span class="mpre"> </span><a href="#loc_75_23_75_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_23_75_27&#39;)"><span class="hl_varref"><span class="mpre">errM</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_76_9_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_9_76_13&#39;)"><span class="hl_varref"><span class="mpre">tid1</span></span></a><span class="mpre">, </span><a href="#loc_77_9_77_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_9_77_13&#39;)"><span class="hl_varref"><span class="mpre">tid2</span></span></a><span class="mpre">)

    </span><a name="loc_80_5_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_16&#39;)"><span class="hl_fundecl"><span class="mpre">killThreads</span></span></a><span class="mpre"> (</span><a name="loc_80_18_80_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_20&#39;)"><span class="hl_vardecl"><span class="mpre">t1</span></span></a><span class="mpre">, </span><a name="loc_80_22_80_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_22_80_24&#39;)"><span class="hl_vardecl"><span class="mpre">t2</span></span></a><span class="mpre">) = do
        </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">killThread</span></span><span class="mpre"> [</span><a href="#loc_80_18_80_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_20&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre">, </span><a href="#loc_80_22_80_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_22_80_24&#39;)"><span class="hl_varref"><span class="mpre">t2</span></span></a><span class="mpre">]
        </span><a href="System.Process.html#loc_575_1_575_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_575_1_575_15&#39;)"><span class="hl_varref"><span class="mpre">Streams.waitForProcess</span></span></a><span class="mpre"> </span><a href="#loc_61_35_61_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_35_61_48&#39;)"><span class="hl_varref"><span class="mpre">processHandle</span></span></a><span class="mpre">

    </span><a name="loc_84_5_84_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_5_84_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_84_8_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_8_84_12&#39;)"><span class="hl_vardecl"><span class="mpre">outM</span></span></a><span class="mpre"> </span><a name="loc_84_13_84_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_17&#39;)"><span class="hl_vardecl"><span class="mpre">errM</span></span></a><span class="mpre"> _ = do
        </span><a href="System.IO.Streams.List.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">Streams.fromList</span></span></a><span class="mpre"> </span><a href="#loc_61_5_61_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_5_61_10&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_204_1_204_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_204_1_204_10&#39;)"><span class="hl_varref"><span class="mpre">Streams.connectTo</span></span></a><span class="mpre"> </span><a href="#loc_61_12_61_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_12_61_17&#39;)"><span class="hl_varref"><span class="mpre">stdin</span></span></a><span class="mpre">
        </span><a name="loc_86_9_86_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_12&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">takeMVar</span></span><span class="mpre"> </span><a href="#loc_84_8_84_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_8_84_12&#39;)"><span class="hl_varref"><span class="mpre">outM</span></span></a><span class="mpre">
        </span><a name="loc_87_9_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_9_87_12&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">takeMVar</span></span><span class="mpre"> </span><a href="#loc_84_13_84_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_17&#39;)"><span class="hl_varref"><span class="mpre">errM</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_86_9_86_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_12&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">, </span><a href="#loc_87_9_87_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_9_87_12&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">)

    </span><a name="loc_90_5_90_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_5_90_10&#39;)"><span class="hl_fundecl"><span class="mpre">snarf</span></span></a><span class="mpre"> </span><a name="loc_90_11_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_13&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> </span><a name="loc_90_14_90_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_14_90_16&#39;)"><span class="hl_vardecl"><span class="mpre">mv</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.concat</span></span><span class="mpre"> (</span><a href="System.IO.Streams.List.html#loc_93_1_93_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.List.html#loc_93_1_93_7&#39;)"><span class="hl_varref"><span class="mpre">Streams.toList</span></span></a><span class="mpre"> </span><a href="#loc_90_11_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_13&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">putMVar</span></span><span class="mpre"> </span><a href="#loc_90_14_90_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_14_90_16&#39;)"><span class="hl_varref"><span class="mpre">mv</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ENABLE_PROCESS_TESTS</span></span><span class="mpre">
#endif
</span></div></body></html>