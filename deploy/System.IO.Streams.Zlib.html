<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | Interface to @zlib@ and @gzip@ compression for &#39;Bytestring&#39;s and &#39;Builder&#39;s</span></span><span class="mpre">

{-# LANGUAGE GeneralizedNewtypeDeriving #-}

module System.IO.Streams.Zlib
 ( </span><span class="hl_comment"><span class="mpre">-- * ByteString decompression</span></span><span class="mpre">
   gunzip
 , decompress
   </span><span class="hl_comment"><span class="mpre">-- * ByteString compression</span></span><span class="mpre">
 , gzip
 , compress
   </span><span class="hl_comment"><span class="mpre">-- * Builder compression</span></span><span class="mpre">
 , gzipBuilder
 , compressBuilder
   </span><span class="hl_comment"><span class="mpre">-- * Compression level</span></span><span class="mpre">
 , CompressionLevel(..)
 , defaultCompressionLevel
 ) where

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Zlib.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 18, srcSpanEndLine = 21, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">                          (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Zlib.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 18, srcSpanEndLine = 22, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">                          as S
import           Data.IORef                               (</span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="mpre">newIORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="mpre">readIORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="mpre">writeIORef</span></a><span class="mpre">)
import           Prelude                                  hiding (</span><a href="Text.Read.html#loc_91_1_91_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Read.html#loc_91_1_91_5&#39;)"><span class="mpre">read</span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           Blaze.ByteString.Builder                 (</span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="mpre">fromByteString</span></a><span class="mpre">)
import           Blaze.ByteString.Builder.Internal        (</span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="mpre">Builder</span></a><span class="mpre">, </span><a href="Blaze.ByteString.Builder.Internal.html#loc_84_1_84_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_84_1_84_18&#39;)"><span class="mpre">defaultBufferSize</span></a><span class="mpre">, </span><a href="Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6&#39;)"><span class="mpre">flush</span></a><span class="mpre">)
import           Blaze.ByteString.Builder.Internal.Buffer (</span><a href="Blaze.ByteString.Builder.Internal.Buffer.html#loc_92_1_92_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Buffer.html#loc_92_1_92_12&#39;)"><span class="mpre">allocBuffer</span></a><span class="mpre">)
import           Codec.Zlib                               (</span><a href="Codec.Zlib.html#loc_63_9_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_63_9_63_16&#39;)"><span class="mpre">Deflate</span></a><span class="mpre">, </span><a href="Codec.Zlib.html#loc_59_9_59_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_59_9_59_16&#39;)"><span class="mpre">Inflate</span></a><span class="mpre">, Popper, WindowBits (..), </span><a href="Codec.Zlib.html#loc_254_1_254_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_254_1_254_12&#39;)"><span class="mpre">feedDeflate</span></a><span class="mpre">, </span><a href="Codec.Zlib.html#loc_173_1_173_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_173_1_173_12&#39;)"><span class="mpre">feedInflate</span></a><span class="mpre">, </span><a href="Codec.Zlib.html#loc_264_1_264_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_264_1_264_14&#39;)"><span class="mpre">finishDeflate</span></a><span class="mpre">, </span><a href="Codec.Zlib.html#loc_225_1_225_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_225_1_225_14&#39;)"><span class="mpre">finishInflate</span></a><span class="mpre">, </span><a href="Codec.Zlib.html#loc_275_1_275_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_275_1_275_13&#39;)"><span class="mpre">flushDeflate</span></a><span class="mpre">, </span><a href="Codec.Zlib.html#loc_241_1_241_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_241_1_241_13&#39;)"><span class="mpre">flushInflate</span></a><span class="mpre">, </span><a href="Codec.Zlib.html#loc_131_1_131_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_131_1_131_12&#39;)"><span class="mpre">initDeflate</span></a><span class="mpre">, </span><a href="Codec.Zlib.html#loc_102_1_102_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_102_1_102_12&#39;)"><span class="mpre">initInflate</span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           System.IO.Streams.Builder                (</span><a href="System.IO.Streams.Builder.html#loc_118_1_118_20" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Builder.html#loc_118_1_118_20&#39;)"><span class="mpre">unsafeBuilderStream</span></a><span class="mpre">)
import           System.IO.Streams.Internal               (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="mpre">InputStream</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="mpre">OutputStream</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="mpre">makeInputStream</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="mpre">makeOutputStream</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="mpre">read</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="mpre">write</span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_37_1_37_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_9&#39;)"><span class="mpre">gzipBits</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">WindowBits</span></span><span class="mpre">
</span><a name="loc_37_1_37_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_9&#39;)"><span class="hl_vardecl"><span class="mpre">gzipBits</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">WindowBits</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">31</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_42_1_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_13&#39;)"><span class="mpre">compressBits</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">WindowBits</span></span><span class="mpre">
</span><a name="loc_42_1_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_13&#39;)"><span class="hl_vardecl"><span class="mpre">compressBits</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">WindowBits</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">15</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Decompress an &#39;InputStream&#39; of strict &#39;ByteString&#39;s from the @gzip@ format</span></span><span class="mpre">
</span><a href="#loc_48_1_48_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_7&#39;)"><span class="mpre">gunzip</span></a><span class="mpre"> :: </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
</span><a name="loc_48_1_48_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_7&#39;)"><span class="hl_fundecl"><span class="mpre">gunzip</span></span></a><span class="mpre"> </span><a name="loc_48_8_48_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_8_48_13&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = </span><a href="Codec.Zlib.html#loc_102_1_102_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_102_1_102_12&#39;)"><span class="hl_varref"><span class="mpre">initInflate</span></span></a><span class="mpre"> </span><a href="#loc_37_1_37_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_9&#39;)"><span class="hl_varref"><span class="mpre">gzipBits</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_65_1_65_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_8&#39;)"><span class="hl_varref"><span class="mpre">inflate</span></span></a><span class="mpre"> </span><a href="#loc_48_8_48_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_8_48_13&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Decompress an &#39;InputStream&#39; of strict &#39;ByteString&#39;s from the @zlib@ format</span></span><span class="mpre">
</span><a href="#loc_54_1_54_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_11&#39;)"><span class="mpre">decompress</span></a><span class="mpre"> :: </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
</span><a name="loc_54_1_54_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_11&#39;)"><span class="hl_fundecl"><span class="mpre">decompress</span></span></a><span class="mpre"> </span><a name="loc_54_12_54_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_12_54_17&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = </span><a href="Codec.Zlib.html#loc_102_1_102_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_102_1_102_12&#39;)"><span class="hl_varref"><span class="mpre">initInflate</span></span></a><span class="mpre"> </span><a href="#loc_42_1_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_13&#39;)"><span class="hl_varref"><span class="mpre">compressBits</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_65_1_65_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_8&#39;)"><span class="hl_varref"><span class="mpre">inflate</span></span></a><span class="mpre"> </span><a href="#loc_54_12_54_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_12_54_17&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note: bytes pushed back to this input stream are not propagated back to the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- source InputStream.</span></span><span class="mpre">
data </span><span class="hl_tycondecl"><span class="mpre">IS</span></span><span class="mpre"> = </span><a name="loc_60_11_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_11_60_16&#39;)"><span class="hl_condecl"><span class="mpre">Input</span></span></a><span class="mpre">
        | </span><a name="loc_61_11_61_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_11_61_17&#39;)"><span class="hl_condecl"><span class="mpre">Popper</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Popper</span></span><span class="mpre">
        | </span><a name="loc_62_11_62_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_11_62_15&#39;)"><span class="hl_condecl"><span class="mpre">Done</span></span></a><span class="mpre">

</span><a href="#loc_65_1_65_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_8&#39;)"><span class="mpre">inflate</span></a><span class="mpre"> :: </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="Codec.Zlib.html#loc_59_9_59_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_59_9_59_16&#39;)"><span class="hl_tyconref"><span class="mpre">Inflate</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
</span><a name="loc_65_1_65_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_8&#39;)"><span class="hl_fundecl"><span class="mpre">inflate</span></span></a><span class="mpre"> </span><a name="loc_65_9_65_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_14&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> </span><a name="loc_65_15_65_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_15_65_20&#39;)"><span class="hl_vardecl"><span class="mpre">state</span></span></a><span class="mpre"> = do
    </span><a name="loc_66_5_66_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_8&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="#loc_60_11_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_11_60_16&#39;)"><span class="hl_conref"><span class="mpre">Input</span></span></a><span class="mpre">
    </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="hl_varref"><span class="mpre">makeInputStream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_70_5_70_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_5_70_11&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre"> </span><a href="#loc_66_5_66_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_5_66_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">

  where
    </span><a name="loc_70_5_70_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_5_70_11&#39;)"><span class="hl_fundecl"><span class="mpre">stream</span></span></a><span class="mpre"> </span><a name="loc_70_12_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_12_70_15&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> = </span><a href="#loc_72_9_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
      where
        </span><a name="loc_72_9_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_11&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre"> = </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_70_12_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_12_70_15&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_72_33_72_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_33_72_35&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> -&gt;
             case </span><a href="#loc_72_33_72_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_33_72_35&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> of
               </span><a href="#loc_60_11_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_11_60_16&#39;)"><span class="hl_conref"><span class="mpre">Input</span></span></a><span class="mpre">    -&gt; </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_65_9_65_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_14&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><a href="#loc_78_9_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_9_78_12&#39;)"><span class="hl_varref"><span class="mpre">eof</span></span></a><span class="mpre"> </span><a href="#loc_85_9_85_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_14&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre">
               </span><a href="#loc_61_11_61_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_11_61_17&#39;)"><span class="hl_conref"><span class="mpre">Popper</span></span></a><span class="mpre"> </span><a name="loc_75_23_75_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_23_75_24&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_94_9_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_12&#39;)"><span class="hl_varref"><span class="mpre">pop</span></span></a><span class="mpre"> </span><a href="#loc_75_23_75_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_23_75_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
               </span><a href="#loc_62_11_62_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_11_62_15&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">     -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

        </span><a name="loc_78_9_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_9_78_12&#39;)"><span class="hl_vardecl"><span class="mpre">eof</span></span></a><span class="mpre"> = do
            </span><a name="loc_79_13_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="Codec.Zlib.html#loc_225_1_225_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_225_1_225_14&#39;)"><span class="hl_varref"><span class="mpre">finishInflate</span></span></a><span class="mpre"> </span><a href="#loc_65_15_65_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_15_65_20&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre">
            </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_70_12_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_12_70_15&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_62_11_62_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_11_62_15&#39;)"><span class="hl_conref"><span class="mpre">Done</span></span></a><span class="mpre">
            if (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_79_13_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
              then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_79_13_79_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
              else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

        </span><a name="loc_85_9_85_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_14&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_85_15_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_15_85_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> =
            if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_85_15_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_15_85_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
              then do
                  </span><a name="loc_88_19_88_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_19_88_22&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> &lt;- </span><a href="Codec.Zlib.html#loc_241_1_241_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_241_1_241_13&#39;)"><span class="hl_varref"><span class="mpre">flushInflate</span></span></a><span class="mpre"> </span><a href="#loc_65_15_65_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_15_65_20&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre">
                  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_88_19_88_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_19_88_22&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">
              else </span><a href="Codec.Zlib.html#loc_173_1_173_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_173_1_173_12&#39;)"><span class="hl_varref"><span class="mpre">feedInflate</span></span></a><span class="mpre"> </span><a href="#loc_65_15_65_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_15_65_20&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><a href="#loc_85_15_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_15_85_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_90_45_90_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_45_90_51&#39;)"><span class="hl_vardecl"><span class="mpre">popper</span></span></a><span class="mpre"> -&gt; do
                  </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_70_12_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_12_70_15&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_61_11_61_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_11_61_17&#39;)"><span class="hl_conref"><span class="mpre">Popper</span></span></a><span class="mpre"> </span><a href="#loc_90_45_90_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_45_90_51&#39;)"><span class="hl_varref"><span class="mpre">popper</span></span></a><span class="mpre">
                  </span><a href="#loc_94_9_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_12&#39;)"><span class="hl_varref"><span class="mpre">pop</span></span></a><span class="mpre"> </span><a href="#loc_90_45_90_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_45_90_51&#39;)"><span class="hl_varref"><span class="mpre">popper</span></span></a><span class="mpre">

        </span><a name="loc_94_9_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_9_94_12&#39;)"><span class="hl_fundecl"><span class="mpre">pop</span></span></a><span class="mpre"> </span><a name="loc_94_13_94_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_19&#39;)"><span class="hl_vardecl"><span class="mpre">popper</span></span></a><span class="mpre"> = </span><a href="#loc_94_13_94_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_13_94_19&#39;)"><span class="hl_varref"><span class="mpre">popper</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><a href="#loc_95_9_95_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_20&#39;)"><span class="hl_varref"><span class="mpre">backToInput</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre">)
        </span><a name="loc_95_9_95_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_9_95_20&#39;)"><span class="hl_vardecl"><span class="mpre">backToInput</span></span></a><span class="mpre"> = </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_70_12_70_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_12_70_15&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_60_11_60_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_11_60_16&#39;)"><span class="hl_conref"><span class="mpre">Input</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_65_9_65_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_9_65_14&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><a href="#loc_78_9_78_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_9_78_12&#39;)"><span class="hl_varref"><span class="mpre">eof</span></span></a><span class="mpre"> </span><a href="#loc_85_9_85_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_9_85_14&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_102_1_102_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_15&#39;)"><span class="mpre">deflateBuilder</span></a><span class="mpre"> :: </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
               -&gt; </span><a href="Codec.Zlib.html#loc_63_9_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_63_9_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Deflate</span></span></a><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">)
</span><a name="loc_102_1_102_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_15&#39;)"><span class="hl_fundecl"><span class="mpre">deflateBuilder</span></span></a><span class="mpre"> </span><a name="loc_102_16_102_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_16_102_22&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre"> </span><a name="loc_102_23_102_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_23_102_28&#39;)"><span class="hl_vardecl"><span class="mpre">state</span></span></a><span class="mpre"> = do
    </span><a name="loc_103_5_103_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_14&#39;)"><span class="hl_vardecl"><span class="mpre">zippedStr</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">makeOutputStream</span></span></a><span class="mpre"> </span><a href="#loc_111_5_111_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_5_111_21&#39;)"><span class="hl_varref"><span class="mpre">bytestringStream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
                 \</span><a name="loc_104_19_104_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_19_104_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_141_1_141_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_8&#39;)"><span class="hl_varref"><span class="mpre">deflate</span></span></a><span class="mpre"> </span><a href="#loc_104_19_104_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_19_104_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_102_23_102_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_23_102_28&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- we can use unsafeBuilderStream here because zlib is going to consume the</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- stream</span></span><span class="mpre">
    </span><a href="System.IO.Streams.Builder.html#loc_118_1_118_20" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Builder.html#loc_118_1_118_20&#39;)"><span class="hl_varref"><span class="mpre">unsafeBuilderStream</span></span></a><span class="mpre"> (</span><a href="Blaze.ByteString.Builder.Internal.Buffer.html#loc_92_1_92_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Buffer.html#loc_92_1_92_12&#39;)"><span class="hl_varref"><span class="mpre">allocBuffer</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.html#loc_84_1_84_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_84_1_84_18&#39;)"><span class="hl_varref"><span class="mpre">defaultBufferSize</span></span></a><span class="mpre">) </span><a href="#loc_103_5_103_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_14&#39;)"><span class="hl_varref"><span class="mpre">zippedStr</span></span></a><span class="mpre">

  where
    </span><a name="loc_111_5_111_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_5_111_21&#39;)"><span class="hl_fundecl"><span class="mpre">bytestringStream</span></span></a><span class="mpre"> </span><a name="loc_111_22_111_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_22_111_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_113_5_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_8&#39;)"><span class="hl_varref"><span class="mpre">cvt</span></span></a><span class="mpre"> </span><a href="#loc_111_22_111_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_22_111_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_102_16_102_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_16_102_22&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">

    </span><a name="loc_113_5_113_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_5_113_8&#39;)"><span class="hl_fundecl"><span class="mpre">cvt</span></span></a><span class="mpre"> </span><a name="loc_113_9_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_113_9_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">  = </span><a href="Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.ByteString.html#loc_94_1_94_15&#39;)"><span class="hl_varref"><span class="mpre">fromByteString</span></span></a><span class="mpre"> </span><a href="#loc_113_9_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_9_113_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Convert an &#39;OutputStream&#39; that consumes compressed &#39;Builder&#39;s into an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;OutputStream&#39; that consumes uncompressed &#39;Builder&#39;s in the @gzip@ format</span></span><span class="mpre">
</span><a href="#loc_123_1_123_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_12&#39;)"><span class="mpre">gzipBuilder</span></a><span class="mpre"> :: </span><a href="#loc_162_9_162_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_9_162_25&#39;)"><span class="hl_tyconref"><span class="mpre">CompressionLevel</span></span></a><span class="mpre">
            -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">)
</span><a name="loc_123_1_123_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_12&#39;)"><span class="hl_fundecl"><span class="mpre">gzipBuilder</span></span></a><span class="mpre"> </span><a name="loc_123_13_123_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_18&#39;)"><span class="hl_vardecl"><span class="mpre">level</span></span></a><span class="mpre"> </span><a name="loc_123_19_123_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_19_123_25&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> =
    </span><a href="Codec.Zlib.html#loc_131_1_131_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_131_1_131_12&#39;)"><span class="hl_varref"><span class="mpre">initDeflate</span></span></a><span class="mpre"> (</span><a href="#loc_174_1_174_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_6&#39;)"><span class="hl_varref"><span class="mpre">clamp</span></span></a><span class="mpre"> </span><a href="#loc_123_13_123_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_18&#39;)"><span class="hl_varref"><span class="mpre">level</span></span></a><span class="mpre">) </span><a href="#loc_37_1_37_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_9&#39;)"><span class="hl_varref"><span class="mpre">gzipBits</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_102_1_102_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_15&#39;)"><span class="hl_varref"><span class="mpre">deflateBuilder</span></span></a><span class="mpre"> </span><a href="#loc_123_19_123_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_19_123_25&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Convert an &#39;OutputStream&#39; that consumes compressed &#39;Builder&#39;s into an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;OutputStream&#39; that consumes uncompressed &#39;Builder&#39;s in the @zlib@ format</span></span><span class="mpre">
</span><a href="#loc_133_1_133_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_16&#39;)"><span class="mpre">compressBuilder</span></a><span class="mpre"> :: </span><a href="#loc_162_9_162_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_9_162_25&#39;)"><span class="hl_tyconref"><span class="mpre">CompressionLevel</span></span></a><span class="mpre">
                -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">)
</span><a name="loc_133_1_133_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_16&#39;)"><span class="hl_fundecl"><span class="mpre">compressBuilder</span></span></a><span class="mpre"> </span><a name="loc_133_17_133_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_17_133_22&#39;)"><span class="hl_vardecl"><span class="mpre">level</span></span></a><span class="mpre"> </span><a name="loc_133_23_133_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_23_133_29&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> =
    </span><a href="Codec.Zlib.html#loc_131_1_131_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_131_1_131_12&#39;)"><span class="hl_varref"><span class="mpre">initDeflate</span></span></a><span class="mpre"> (</span><a href="#loc_174_1_174_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_6&#39;)"><span class="hl_varref"><span class="mpre">clamp</span></span></a><span class="mpre"> </span><a href="#loc_133_17_133_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_17_133_22&#39;)"><span class="hl_varref"><span class="mpre">level</span></span></a><span class="mpre">) </span><a href="#loc_42_1_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_13&#39;)"><span class="hl_varref"><span class="mpre">compressBits</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_102_1_102_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_1_102_15&#39;)"><span class="hl_varref"><span class="mpre">deflateBuilder</span></span></a><span class="mpre"> </span><a href="#loc_133_23_133_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_23_133_29&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_141_1_141_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_8&#39;)"><span class="mpre">deflate</span></a><span class="mpre"> :: </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
        -&gt; </span><a href="Codec.Zlib.html#loc_63_9_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_63_9_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Deflate</span></span></a><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
</span><a name="loc_141_1_141_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_8&#39;)"><span class="hl_fundecl"><span class="mpre">deflate</span></span></a><span class="mpre"> </span><a name="loc_141_9_141_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_9_141_15&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> </span><a name="loc_141_16_141_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_16_141_21&#39;)"><span class="hl_vardecl"><span class="mpre">state</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">makeOutputStream</span></span></a><span class="mpre"> </span><a href="#loc_143_5_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_11&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
  where
    </span><a name="loc_143_5_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_11&#39;)"><span class="hl_fundecl"><span class="mpre">stream</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> = </span><a href="#loc_155_5_155_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_5_155_11&#39;)"><span class="hl_varref"><span class="mpre">popAll</span></span></a><span class="mpre"> (</span><a href="Codec.Zlib.html#loc_264_1_264_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_264_1_264_14&#39;)"><span class="hl_varref"><span class="mpre">finishDeflate</span></span></a><span class="mpre"> </span><a href="#loc_141_16_141_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_16_141_21&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="#loc_141_9_141_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_9_141_15&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">

    </span><a href="#loc_143_5_143_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_11&#39;)"><span class="hl_fundecl"><span class="mpre">stream</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_145_18_145_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_18_145_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = do
        </span><span class="hl_comment"><span class="mpre">-- Empty string means flush</span></span><span class="mpre">
        if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_145_18_145_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_18_145_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
          then do
              </span><a href="#loc_155_5_155_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_5_155_11&#39;)"><span class="hl_varref"><span class="mpre">popAll</span></span></a><span class="mpre"> (</span><a href="Codec.Zlib.html#loc_275_1_275_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_275_1_275_13&#39;)"><span class="hl_varref"><span class="mpre">flushDeflate</span></span></a><span class="mpre"> </span><a href="#loc_141_16_141_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_16_141_21&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre">)
              </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">) </span><a href="#loc_141_9_141_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_9_141_15&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">

          else </span><a href="Codec.Zlib.html#loc_254_1_254_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_254_1_254_12&#39;)"><span class="hl_varref"><span class="mpre">feedDeflate</span></span></a><span class="mpre"> </span><a href="#loc_141_16_141_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_16_141_21&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><a href="#loc_145_18_145_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_18_145_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_155_5_155_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_5_155_11&#39;)"><span class="hl_varref"><span class="mpre">popAll</span></span></a><span class="mpre">


    </span><a name="loc_155_5_155_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_5_155_11&#39;)"><span class="hl_fundecl"><span class="mpre">popAll</span></span></a><span class="mpre"> </span><a name="loc_155_12_155_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_12_155_18&#39;)"><span class="hl_vardecl"><span class="mpre">popper</span></span></a><span class="mpre"> = </span><a href="#loc_157_9_157_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
      where
        </span><a name="loc_157_9_157_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_11&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre"> = </span><a href="#loc_155_12_155_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_12_155_18&#39;)"><span class="hl_varref"><span class="mpre">popper</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) (\</span><a name="loc_157_48_157_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_48_157_49&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt; </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_157_48_157_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_48_157_49&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_141_9_141_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_9_141_15&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_157_9_157_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_9_157_11&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Parameter that defines the tradeoff between speed and compression ratio</span></span><span class="mpre">
newtype </span><a name="loc_162_9_162_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_9_162_25&#39;)"><span class="hl_tycondecl"><span class="mpre">CompressionLevel</span></span></a><span class="mpre"> = </span><a name="loc_162_28_162_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_28_162_44&#39;)"><span class="hl_condecl"><span class="mpre">CompressionLevel</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
  </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Zlib.hs&quot;, srcSpanStartLine = 163, srcSpanStartColumn = 3, srcSpanEndLine = 163, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Zlib.hs&quot;, srcSpanStartLine = 163, srcSpanStartColumn = 3, srcSpanEndLine = 163, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/Sy"><span class="mpre">deriving (Read, Eq, Show, Num)</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | A compression level that balances speed with compression ratio</span></span><span class="mpre">
</span><a href="#loc_169_1_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_24&#39;)"><span class="mpre">defaultCompressionLevel</span></a><span class="mpre"> :: </span><a href="#loc_162_9_162_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_9_162_25&#39;)"><span class="hl_tyconref"><span class="mpre">CompressionLevel</span></span></a><span class="mpre">
</span><a name="loc_169_1_169_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_24&#39;)"><span class="hl_vardecl"><span class="mpre">defaultCompressionLevel</span></span></a><span class="mpre"> = </span><a href="#loc_162_28_162_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_28_162_44&#39;)"><span class="hl_conref"><span class="mpre">CompressionLevel</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_174_1_174_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_6&#39;)"><span class="mpre">clamp</span></a><span class="mpre"> :: </span><a href="#loc_162_9_162_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_9_162_25&#39;)"><span class="hl_tyconref"><span class="mpre">CompressionLevel</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_174_1_174_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_6&#39;)"><span class="hl_fundecl"><span class="mpre">clamp</span></span></a><span class="mpre"> (</span><a href="#loc_162_28_162_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_28_162_44&#39;)"><span class="hl_conref"><span class="mpre">CompressionLevel</span></span></a><span class="mpre"> </span><a name="loc_174_25_174_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_25_174_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">9</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><a href="#loc_174_25_174_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_25_174_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Convert an &#39;OutputStream&#39; that consumes compressed &#39;ByteString&#39;s into an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;OutputStream&#39; that consumes uncompressed &#39;ByteString&#39;s in the @gzip@ format</span></span><span class="mpre">
</span><a href="#loc_183_1_183_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_5&#39;)"><span class="mpre">gzip</span></a><span class="mpre"> :: </span><a href="#loc_162_9_162_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_9_162_25&#39;)"><span class="hl_tyconref"><span class="mpre">CompressionLevel</span></span></a><span class="mpre">
     -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
     -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
</span><a name="loc_183_1_183_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_1_183_5&#39;)"><span class="hl_fundecl"><span class="mpre">gzip</span></span></a><span class="mpre"> </span><a name="loc_183_6_183_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_6_183_11&#39;)"><span class="hl_vardecl"><span class="mpre">level</span></span></a><span class="mpre"> </span><a name="loc_183_12_183_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_12_183_18&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = </span><a href="Codec.Zlib.html#loc_131_1_131_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_131_1_131_12&#39;)"><span class="hl_varref"><span class="mpre">initDeflate</span></span></a><span class="mpre"> (</span><a href="#loc_174_1_174_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_6&#39;)"><span class="hl_varref"><span class="mpre">clamp</span></span></a><span class="mpre"> </span><a href="#loc_183_6_183_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_6_183_11&#39;)"><span class="hl_varref"><span class="mpre">level</span></span></a><span class="mpre">) </span><a href="#loc_37_1_37_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_9&#39;)"><span class="hl_varref"><span class="mpre">gzipBits</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_141_1_141_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_8&#39;)"><span class="hl_varref"><span class="mpre">deflate</span></span></a><span class="mpre"> </span><a href="#loc_183_12_183_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_12_183_18&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Convert an &#39;OutputStream&#39; that consumes compressed &#39;ByteString&#39;s into an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;OutputStream&#39; that consumes uncompressed &#39;ByteString&#39;s in the @zlib@ format</span></span><span class="mpre">
</span><a href="#loc_192_1_192_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_9&#39;)"><span class="mpre">compress</span></a><span class="mpre"> :: </span><a href="#loc_162_9_162_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_9_162_25&#39;)"><span class="hl_tyconref"><span class="mpre">CompressionLevel</span></span></a><span class="mpre">
         -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)
</span><a name="loc_192_1_192_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_1_192_9&#39;)"><span class="hl_fundecl"><span class="mpre">compress</span></span></a><span class="mpre"> </span><a name="loc_192_10_192_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_10_192_15&#39;)"><span class="hl_vardecl"><span class="mpre">level</span></span></a><span class="mpre"> </span><a name="loc_192_16_192_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_16_192_22&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = </span><a href="Codec.Zlib.html#loc_131_1_131_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Codec.Zlib.html#loc_131_1_131_12&#39;)"><span class="hl_varref"><span class="mpre">initDeflate</span></span></a><span class="mpre"> (</span><a href="#loc_174_1_174_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_174_1_174_6&#39;)"><span class="hl_varref"><span class="mpre">clamp</span></span></a><span class="mpre"> </span><a href="#loc_192_10_192_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_10_192_15&#39;)"><span class="hl_varref"><span class="mpre">level</span></span></a><span class="mpre">) </span><a href="#loc_42_1_42_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_13&#39;)"><span class="hl_varref"><span class="mpre">compressBits</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
                        </span><a href="#loc_141_1_141_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_8&#39;)"><span class="hl_varref"><span class="mpre">deflate</span></span></a><span class="mpre"> </span><a href="#loc_192_16_192_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_16_192_22&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">
</span></div></body></html>