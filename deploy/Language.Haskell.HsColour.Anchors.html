<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module Language.Haskell.HsColour.Anchors
  ( insertAnchors
  ) where

import Language.Haskell.HsColour.Classify
import Language.Haskell.HsColour.General
import Data.List
import Data.Char (</span><a href="GHC.Unicode.html#loc_140_1_140_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_140_1_140_8&#39;)"><span class="mpre">isUpper</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_141_1_141_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_141_1_141_8&#39;)"><span class="mpre">isLower</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_103_1_103_8&#39;)"><span class="mpre">isDigit</span></a><span class="mpre">, ord, intToDigit)

</span><span class="hl_comment"><span class="mpre">-- This is an attempt to find the first defining occurrence of an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- identifier (function, datatype, class) in a Haskell source file.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Rather than parse the module properly, we try to get by with just</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a finite state automaton.  Keeping a record of identifiers we</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- have already seen, we look at the beginning of every line to see</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- if it starts with the right tokens to introduce a defn.  If so,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- we look a little bit further until we can be certain.  Then plonk</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (or not) an anchor at the beginning of the line.</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hscolour-1.20.3/Language/Haskell/HsColour/Anchors.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 1, srcSpanEndLine = 19, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hscolour-1.20.3/Language/Haskell/HsColour/Anchors.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 1, srcSpanEndLine = 19, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hscolour-1.20.3/Langua"><span class="mpre">type Anchor = String</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | &#39;insertAnchors&#39; places an anchor marker in the token stream before the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   first defining occurrence of any identifier.  Here, /before/ means</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   immediately preceding its type signature, or preceding a (haddock)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   comment that comes immediately before the type signature, or failing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   either of those, before the first equation.</span></span><span class="mpre">
</span><a href="#loc_27_1_27_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_14&#39;)"><span class="mpre">insertAnchors</span></a><span class="mpre"> :: [(</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Anchor</span></span><span class="mpre"> (</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
</span><a name="loc_27_1_27_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_14&#39;)"><span class="hl_vardecl"><span class="mpre">insertAnchors</span></span></a><span class="mpre"> = </span><a href="#loc_32_1_32_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_7&#39;)"><span class="hl_varref"><span class="mpre">anchor</span></span></a><span class="mpre"> </span><a href="#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_8&#39;)"><span class="hl_varref"><span class="mpre">emptyST</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- looks at first token in the left-most position of each line</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- precondition: have just seen a newline token.</span></span><span class="mpre">
</span><a href="#loc_32_1_32_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_7&#39;)"><span class="mpre">anchor</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> -&gt; [(</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> (</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
</span><a name="loc_32_1_32_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_7&#39;)"><span class="hl_fundecl"><span class="mpre">anchor</span></span></a><span class="mpre"> </span><a name="loc_32_8_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_8_32_10&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><a name="loc_32_11_32_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = case </span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_varref"><span class="mpre">identifier</span></span></a><span class="mpre"> </span><a href="#loc_32_8_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_8_32_10&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_32_11_32_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_55_1_55_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a href="#loc_32_8_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_8_32_10&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_32_11_32_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
                </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_34_22_34_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_22_34_23&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">  -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><a href="#loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="hl_varref"><span class="mpre">escape</span></span></a><span class="mpre"> </span><a href="#loc_34_22_34_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_22_34_23&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_55_1_55_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> (</span><a href="#loc_167_1_167_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_9&#39;)"><span class="hl_varref"><span class="mpre">insertST</span></span></a><span class="mpre"> </span><a href="#loc_34_22_34_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_22_34_23&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_32_8_32_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_8_32_10&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">) </span><a href="#loc_32_11_32_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_11_32_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- some chars are not valid in anchor URIs: http://www.ietf.org/rfc/rfc3986</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- NOTE: This code assumes characters are 8-bit.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--       Ideally, it should transcode to utf8 octets first.</span></span><span class="mpre">
</span><a href="#loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="mpre">escape</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_40_1_40_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_7&#39;)"><span class="hl_vardecl"><span class="mpre">escape</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_41_11_41_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_11_41_14&#39;)"><span class="hl_varref"><span class="mpre">enc</span></span></a><span class="mpre">
    where </span><a name="loc_41_11_41_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_11_41_14&#39;)"><span class="hl_fundecl"><span class="mpre">enc</span></span></a><span class="mpre"> </span><a name="loc_41_15_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a href="GHC.Unicode.html#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_103_1_103_8&#39;)"><span class="hl_varref"><span class="mpre">isDigit</span></span></a><span class="mpre"> </span><a href="#loc_41_15_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_49_11_49_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_11_49_29&#39;)"><span class="hl_varref"><span class="mpre">isURIFragmentValid</span></span></a><span class="mpre"> </span><a href="#loc_41_15_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_141_1_141_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_141_1_141_8&#39;)"><span class="hl_varref"><span class="mpre">isLower</span></span></a><span class="mpre"> </span><a href="#loc_41_15_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_140_1_140_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_140_1_140_8&#39;)"><span class="hl_varref"><span class="mpre">isUpper</span></span></a><span class="mpre"> </span><a href="#loc_41_15_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = [</span><a href="#loc_41_15_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]
                | </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_41_15_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">256</span></span><span class="mpre"> = [</span><a href="#loc_41_15_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- not correct, but better than nothing</span></span><span class="mpre">
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = [</span><span class="hl_char"><span class="mpre">&#39;%&#39;</span></span><span class="mpre">,</span><a href="#loc_47_11_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_11_47_16&#39;)"><span class="hl_varref"><span class="mpre">hexHi</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_41_15_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">), </span><a href="#loc_48_11_48_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_16&#39;)"><span class="hl_varref"><span class="mpre">hexLo</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_41_15_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)]
          </span><a name="loc_47_11_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_11_47_16&#39;)"><span class="hl_fundecl"><span class="mpre">hexHi</span></span></a><span class="mpre"> </span><a name="loc_47_17_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_18&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">intToDigit</span></span><span class="mpre"> (</span><a href="#loc_47_17_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">`div`</span></span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">)
          </span><a name="loc_48_11_48_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_16&#39;)"><span class="hl_fundecl"><span class="mpre">hexLo</span></span></a><span class="mpre"> </span><a name="loc_48_17_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_18&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">intToDigit</span></span><span class="mpre"> (</span><a href="#loc_48_17_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_17_48_18&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">)
          </span><a name="loc_49_11_49_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_11_49_29&#39;)"><span class="hl_fundecl"><span class="mpre">isURIFragmentValid</span></span></a><span class="mpre"> </span><a name="loc_49_30_49_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_30_49_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_49_30_49_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_30_49_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;!$&amp;&#39;()*+,;=/?-._~:@&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- emit passes stuff through until the next newline has been encountered,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- then jumps back into the anchor function</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- pre-condition: newlines are explicitly single tokens</span></span><span class="mpre">
</span><a href="#loc_55_1_55_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_5&#39;)"><span class="mpre">emit</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> -&gt; [(</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; [</span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> (</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
</span><a name="loc_55_1_55_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_5&#39;)"><span class="hl_fundecl"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a name="loc_55_6_55_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_6_55_8&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> (</span><a name="loc_55_10_55_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_10_55_11&#39;)"><span class="hl_specname"><span class="mpre">t</span></span></a><span class="mpre">@(</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_3_90_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_3_90_8&#39;)"><span class="hl_conref"><span class="mpre">Space</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_55_25_55_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_25_55_31&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_55_10_55_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_10_55_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_32_1_32_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_7&#39;)"><span class="hl_varref"><span class="mpre">anchor</span></span></a><span class="mpre"> </span><a href="#loc_55_6_55_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_6_55_8&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_55_25_55_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_25_55_31&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_55_1_55_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_5&#39;)"><span class="hl_fundecl"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a name="loc_56_6_56_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_6_56_8&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> (</span><a name="loc_56_10_56_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_10_56_11&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_56_12_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_12_56_18&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">)              = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_56_10_56_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_10_56_11&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_55_1_55_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_5&#39;)"><span class="hl_varref"><span class="mpre">emit</span></span></a><span class="mpre"> </span><a href="#loc_56_6_56_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_6_56_8&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_56_12_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_12_56_18&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_55_1_55_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_1_55_5&#39;)"><span class="hl_fundecl"><span class="mpre">emit</span></span></a><span class="mpre"> _  []                      = []

</span><span class="hl_comment"><span class="mpre">-- Given that we are at the beginning of a line, determine whether there</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is an identifier defined here, and if so, return it.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- precondition: have just seen a newline token.</span></span><span class="mpre">
</span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="mpre">identifier</span></a><span class="mpre"> ::  </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> -&gt; [(</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_fundecl"><span class="mpre">identifier</span></span></a><span class="mpre"> </span><a name="loc_63_12_63_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_12_63_14&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><span class="hl_specname"><span class="mpre">t</span></span><span class="mpre">@((</span><a name="loc_63_19_63_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_19_63_23&#39;)"><span class="hl_vardecl"><span class="mpre">kind</span></span></a><span class="mpre">,</span><a name="loc_63_24_63_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_24_63_25&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_63_27_63_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_27_63_33&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">) | </span><a href="#loc_63_19_63_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_19_63_23&#39;)"><span class="hl_varref"><span class="mpre">kind</span></span></a><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre">[</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_59_90_64" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_59_90_64&#39;)"><span class="hl_conref"><span class="mpre">Varid</span></span></a><span class="mpre">,</span><a href="Language.Haskell.HsColour.Classify.html#loc_92_3_92_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_92_3_92_13&#39;)"><span class="hl_conref"><span class="mpre">Definition</span></span></a><span class="mpre">] =
    case </span><a href="#loc_113_1_113_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_5&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_63_27_63_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_27_63_33&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre"> of
        ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_91_11_91_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_91_11_91_16&#39;)"><span class="hl_conref"><span class="mpre">Varop</span></span></a><span class="mpre">,</span><a name="loc_65_17_65_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_17_65_18&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_65_17_65_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_17_65_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><a href="#loc_170_1_170_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_5&#39;)"><span class="hl_infix"><span class="mpre">`inST`</span></span></a><a href="#loc_63_12_63_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_12_63_14&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_108_1_108_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_4&#39;)"><span class="hl_varref"><span class="mpre">fix</span></span></a><span class="mpre"> </span><a href="#loc_65_17_65_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_17_65_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)
        </span><span class="hl_vardecl"><span class="mpre">notVarop</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">--  | typesig stream  -&gt; Nothing    -- not a defn</span></span><span class="mpre">
                      | </span><a href="#loc_63_24_63_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_24_63_25&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_170_1_170_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_5&#39;)"><span class="hl_infix"><span class="mpre">`inST`</span></span></a><span class="mpre"> </span><a href="#loc_63_12_63_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_12_63_14&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">     -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- already defined</span></span><span class="mpre">
                      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_63_24_63_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_24_63_25&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
</span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_fundecl"><span class="mpre">identifier</span></span></a><span class="mpre"> </span><a name="loc_69_12_69_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_12_69_14&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><span class="hl_specname"><span class="mpre">t</span></span><span class="mpre">@((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_32_90_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_32_90_38&#39;)"><span class="hl_conref"><span class="mpre">Layout</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_69_31_69_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_31_69_37&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">) =
    case </span><a href="#loc_69_31_69_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_31_69_37&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre"> of
      ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_91_11_91_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_91_11_91_16&#39;)"><span class="hl_conref"><span class="mpre">Varop</span></span></a><span class="mpre">,</span><a name="loc_71_15_71_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_15_71_16&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_32_90_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_32_90_38&#39;)"><span class="hl_conref"><span class="mpre">Layout</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)
                  </span><span class="hl_comment"><span class="mpre">--  | typesig stream  -&gt; Nothing</span></span><span class="mpre">
                      | </span><a href="#loc_71_15_71_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_15_71_16&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_170_1_170_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_5&#39;)"><span class="hl_infix"><span class="mpre">`inST`</span></span></a><span class="mpre"> </span><a href="#loc_69_12_69_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_12_69_14&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">     -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">        -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_108_1_108_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_4&#39;)"><span class="hl_varref"><span class="mpre">fix</span></span></a><span class="mpre"> </span><a href="#loc_71_15_71_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_15_71_16&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)
      </span><span class="hl_vardecl"><span class="mpre">notVarop</span></span><span class="mpre"> -&gt; case </span><a href="#loc_113_1_113_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_5&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> (</span><a href="#loc_99_1_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_12&#39;)"><span class="hl_varref"><span class="mpre">munchParens</span></span></a><span class="mpre"> </span><a href="#loc_69_31_69_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_31_69_37&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">) of
          ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_91_11_91_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_91_11_91_16&#39;)"><span class="hl_conref"><span class="mpre">Varop</span></span></a><span class="mpre">,</span><a name="loc_76_19_76_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_19_76_20&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="#loc_76_19_76_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_19_76_20&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><a href="#loc_170_1_170_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_5&#39;)"><span class="hl_infix"><span class="mpre">`inST`</span></span></a><a href="#loc_69_12_69_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_12_69_14&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_108_1_108_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_4&#39;)"><span class="hl_varref"><span class="mpre">fix</span></span></a><span class="mpre"> </span><a href="#loc_76_19_76_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_19_76_20&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)
          _             -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
</span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_fundecl"><span class="mpre">identifier</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_specname"><span class="mpre">t</span></span><span class="mpre">@((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_11_90_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_11_90_18&#39;)"><span class="hl_conref"><span class="mpre">Keyword</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;foreign&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_vardecl"><span class="mpre">stream</span></span><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- not yet implemented</span></span><span class="mpre">
</span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_fundecl"><span class="mpre">identifier</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_specname"><span class="mpre">t</span></span><span class="mpre">@((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_11_90_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_11_90_18&#39;)"><span class="hl_conref"><span class="mpre">Keyword</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;data&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_79_35_79_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_35_79_41&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">)    = </span><a href="#loc_120_1_120_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_9&#39;)"><span class="hl_varref"><span class="mpre">getConid</span></span></a><span class="mpre"> </span><a href="#loc_79_35_79_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_35_79_41&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_fundecl"><span class="mpre">identifier</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_specname"><span class="mpre">t</span></span><span class="mpre">@((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_11_90_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_11_90_18&#39;)"><span class="hl_conref"><span class="mpre">Keyword</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;newtype&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_80_38_80_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_38_80_44&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">) = </span><a href="#loc_120_1_120_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_9&#39;)"><span class="hl_varref"><span class="mpre">getConid</span></span></a><span class="mpre"> </span><a href="#loc_80_38_80_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_38_80_44&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_fundecl"><span class="mpre">identifier</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_specname"><span class="mpre">t</span></span><span class="mpre">@((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_11_90_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_11_90_18&#39;)"><span class="hl_conref"><span class="mpre">Keyword</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;type&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_81_35_81_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_35_81_41&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">)    = </span><a href="#loc_120_1_120_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_9&#39;)"><span class="hl_varref"><span class="mpre">getConid</span></span></a><span class="mpre"> </span><a href="#loc_81_35_81_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_35_81_41&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_fundecl"><span class="mpre">identifier</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_specname"><span class="mpre">t</span></span><span class="mpre">@((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_11_90_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_11_90_18&#39;)"><span class="hl_conref"><span class="mpre">Keyword</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;class&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_82_36_82_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_36_82_42&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">)   = </span><a href="#loc_120_1_120_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_9&#39;)"><span class="hl_varref"><span class="mpre">getConid</span></span></a><span class="mpre"> </span><a href="#loc_82_36_82_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_36_82_42&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_fundecl"><span class="mpre">identifier</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_specname"><span class="mpre">t</span></span><span class="mpre">@((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_11_90_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_11_90_18&#39;)"><span class="hl_conref"><span class="mpre">Keyword</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;instance&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_83_39_83_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_39_83_45&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">)= </span><a href="#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">getInstance</span></span></a><span class="mpre"> </span><a href="#loc_83_39_83_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_39_83_45&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_fundecl"><span class="mpre">identifier</span></span></a><span class="mpre"> </span><a name="loc_84_12_84_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_12_84_14&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> </span><span class="hl_specname"><span class="mpre">t</span></span><span class="mpre">@((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_41_90_48" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_41_90_48&#39;)"><span class="hl_conref"><span class="mpre">Comment</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_3_90_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_3_90_8&#39;)"><span class="hl_conref"><span class="mpre">Space</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_84_43_84_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_43_84_49&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">) = </span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_varref"><span class="mpre">identifier</span></span></a><span class="mpre"> </span><a href="#loc_84_12_84_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_12_84_14&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><a href="#loc_84_43_84_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_43_84_49&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_63_1_63_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_11&#39;)"><span class="hl_fundecl"><span class="mpre">identifier</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">st</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">stream</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Is this really a type signature?  (no longer used)</span></span><span class="mpre">
</span><a href="#loc_89_1_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_8&#39;)"><span class="mpre">typesig</span></a><span class="mpre"> :: [(</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_89_1_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_8&#39;)"><span class="hl_fundecl"><span class="mpre">typesig</span></span></a><span class="mpre"> ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_21_90_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_21_90_29&#39;)"><span class="hl_conref"><span class="mpre">Keyglyph</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)   = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_89_1_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_8&#39;)"><span class="hl_fundecl"><span class="mpre">typesig</span></span></a><span class="mpre"> ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_59_90_64" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_59_90_64&#39;)"><span class="hl_conref"><span class="mpre">Varid</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_90_20_90_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_20_90_26&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">)    = </span><a href="#loc_89_1_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_8&#39;)"><span class="hl_varref"><span class="mpre">typesig</span></span></a><span class="mpre"> </span><a href="#loc_90_20_90_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_20_90_26&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_89_1_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_8&#39;)"><span class="hl_fundecl"><span class="mpre">typesig</span></span></a><span class="mpre"> ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_32_90_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_32_90_38&#39;)"><span class="hl_conref"><span class="mpre">Layout</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><a href="Language.Haskell.HsColour.Classify.html#loc_91_11_91_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_91_11_91_16&#39;)"><span class="hl_conref"><span class="mpre">Varop</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">(</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_32_90_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_32_90_38&#39;)"><span class="hl_conref"><span class="mpre">Layout</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_91_46_91_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_46_91_52&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">)    = </span><a href="#loc_89_1_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_8&#39;)"><span class="hl_varref"><span class="mpre">typesig</span></span></a><span class="mpre"> </span><a href="#loc_91_46_91_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_46_91_52&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_89_1_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_8&#39;)"><span class="hl_fundecl"><span class="mpre">typesig</span></span></a><span class="mpre"> ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_32_90_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_32_90_38&#39;)"><span class="hl_conref"><span class="mpre">Layout</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;,&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_92_23_92_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_23_92_29&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">) = </span><a href="#loc_89_1_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_8&#39;)"><span class="hl_varref"><span class="mpre">typesig</span></span></a><span class="mpre"> </span><a href="#loc_92_23_92_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_23_92_29&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_89_1_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_8&#39;)"><span class="hl_fundecl"><span class="mpre">typesig</span></span></a><span class="mpre"> ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_3_90_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_3_90_8&#39;)"><span class="hl_conref"><span class="mpre">Space</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_93_20_93_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_20_93_26&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">)    = </span><a href="#loc_89_1_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_8&#39;)"><span class="hl_varref"><span class="mpre">typesig</span></span></a><span class="mpre"> </span><a href="#loc_93_20_93_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_20_93_26&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_89_1_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_8&#39;)"><span class="hl_fundecl"><span class="mpre">typesig</span></span></a><span class="mpre"> ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_41_90_48" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_41_90_48&#39;)"><span class="hl_conref"><span class="mpre">Comment</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_94_22_94_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_22_94_28&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">)  = </span><a href="#loc_89_1_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_8&#39;)"><span class="hl_varref"><span class="mpre">typesig</span></span></a><span class="mpre"> </span><a href="#loc_94_22_94_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_22_94_28&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_89_1_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_8&#39;)"><span class="hl_fundecl"><span class="mpre">typesig</span></span></a><span class="mpre"> _                     = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- throw away everything from opening paren to matching close</span></span><span class="mpre">
</span><a href="#loc_99_1_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_12&#39;)"><span class="mpre">munchParens</span></a><span class="mpre"> ::  [(</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; [(</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
</span><a name="loc_99_1_99_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_12&#39;)"><span class="hl_vardecl"><span class="mpre">munchParens</span></span></a><span class="mpre"> =  </span><a href="#loc_100_9_100_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_14&#39;)"><span class="hl_varref"><span class="mpre">munch</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)        </span><span class="hl_comment"><span class="mpre">-- already seen open paren</span></span><span class="mpre">
  where </span><a name="loc_100_9_100_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_14&#39;)"><span class="hl_fundecl"><span class="mpre">munch</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_32_90_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_32_90_38&#39;)"><span class="hl_conref"><span class="mpre">Layout</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_100_31_100_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_31_100_35&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><a href="#loc_100_31_100_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_31_100_35&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
        </span><a href="#loc_100_9_100_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_14&#39;)"><span class="hl_fundecl"><span class="mpre">munch</span></span></a><span class="mpre"> </span><a name="loc_101_15_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_15_101_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_32_90_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_32_90_38&#39;)"><span class="hl_conref"><span class="mpre">Layout</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_101_31_101_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_31_101_35&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><a href="#loc_100_9_100_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_14&#39;)"><span class="hl_varref"><span class="mpre">munch</span></span></a><span class="mpre"> (</span><a href="#loc_101_15_101_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_15_101_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_101_31_101_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_31_101_35&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
        </span><a href="#loc_100_9_100_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_14&#39;)"><span class="hl_fundecl"><span class="mpre">munch</span></span></a><span class="mpre"> </span><a name="loc_102_15_102_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_15_102_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_32_90_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_32_90_38&#39;)"><span class="hl_conref"><span class="mpre">Layout</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_102_31_102_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_31_102_35&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><a href="#loc_100_9_100_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_14&#39;)"><span class="hl_varref"><span class="mpre">munch</span></span></a><span class="mpre"> (</span><a href="#loc_102_15_102_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_15_102_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_102_31_102_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_31_102_35&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
        </span><a href="#loc_100_9_100_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_14&#39;)"><span class="hl_fundecl"><span class="mpre">munch</span></span></a><span class="mpre"> </span><a name="loc_103_15_103_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_15_103_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_103_20_103_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_20_103_24&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">)            = </span><a href="#loc_100_9_100_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_14&#39;)"><span class="hl_varref"><span class="mpre">munch</span></span></a><span class="mpre"> </span><a href="#loc_103_15_103_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_15_103_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_103_20_103_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_20_103_24&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
        </span><a href="#loc_100_9_100_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_9_100_14&#39;)"><span class="hl_fundecl"><span class="mpre">munch</span></span></a><span class="mpre"> _ []                  = []        </span><span class="hl_comment"><span class="mpre">-- source is ill-formed</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ensure anchor name is correct for a Varop</span></span><span class="mpre">
</span><a href="#loc_108_1_108_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_4&#39;)"><span class="mpre">fix</span></a><span class="mpre"> ::  </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_108_1_108_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_4&#39;)"><span class="hl_fundecl"><span class="mpre">fix</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;`&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_108_10_108_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_10_108_11&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = </span><a href="Language.Haskell.HsColour.General.html#loc_8_1_8_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.General.html#loc_8_1_8_9&#39;)"><span class="hl_varref"><span class="mpre">dropLast</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;`&#39;</span></span><span class="mpre"> </span><a href="#loc_108_10_108_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_10_108_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
</span><a href="#loc_108_1_108_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_4&#39;)"><span class="hl_fundecl"><span class="mpre">fix</span></span></a><span class="mpre"> </span><a name="loc_109_5_109_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_5_109_6&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">       = </span><a href="#loc_109_5_109_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_5_109_6&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- look past whitespace and comments to next &quot;real&quot; token</span></span><span class="mpre">
</span><a href="#loc_113_1_113_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_5&#39;)"><span class="mpre">skip</span></a><span class="mpre"> ::  [(</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">)] -&gt; [(</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre">)]
</span><a name="loc_113_1_113_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_5&#39;)"><span class="hl_fundecl"><span class="mpre">skip</span></span></a><span class="mpre"> ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_3_90_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_3_90_8&#39;)"><span class="hl_conref"><span class="mpre">Space</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_113_17_113_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_23&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">)   = </span><a href="#loc_113_1_113_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_5&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_113_17_113_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_23&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_113_1_113_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_5&#39;)"><span class="hl_fundecl"><span class="mpre">skip</span></span></a><span class="mpre"> ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_41_90_48" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_41_90_48&#39;)"><span class="hl_conref"><span class="mpre">Comment</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_114_19_114_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_19_114_25&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">) = </span><a href="#loc_113_1_113_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_5&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_114_19_114_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_19_114_25&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_113_1_113_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_5&#39;)"><span class="hl_fundecl"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a name="loc_115_6_115_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_12&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">               = </span><a href="#loc_115_6_115_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_12&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- skip possible context up to and including &quot;=&gt;&quot;, returning next Conid token</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (this function is highly partial - relies on source being parse-correct)</span></span><span class="mpre">
</span><a href="#loc_120_1_120_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_9&#39;)"><span class="mpre">getConid</span></a><span class="mpre"> ::  [(</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_120_1_120_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_9&#39;)"><span class="hl_fundecl"><span class="mpre">getConid</span></span></a><span class="mpre"> </span><a name="loc_120_10_120_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_10_120_16&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre"> =
    case </span><a href="#loc_113_1_113_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_5&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_120_10_120_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_10_120_16&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre"> of
        ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_51_90_56" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_51_90_56&#39;)"><span class="hl_conref"><span class="mpre">Conid</span></span></a><span class="mpre">,</span><a name="loc_122_17_122_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_17_122_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_122_20_122_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_20_122_24&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) -&gt; case </span><a href="#loc_142_1_142_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_8&#39;)"><span class="hl_varref"><span class="mpre">context</span></span></a><span class="mpre"> </span><a href="#loc_122_20_122_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_20_122_24&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> of
                              ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_21_90_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_21_90_29&#39;)"><span class="hl_conref"><span class="mpre">Keyglyph</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;=&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)     -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_122_17_122_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_17_122_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                              ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_21_90_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_21_90_29&#39;)"><span class="hl_conref"><span class="mpre">Keyglyph</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;=&gt;&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_124_48_124_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_48_124_52&#39;)"><span class="hl_vardecl"><span class="mpre">more</span></span></a><span class="mpre">) -&gt;
                                  case </span><a href="#loc_113_1_113_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_5&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_124_48_124_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_48_124_52&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre"> of
                                      ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_51_90_56" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_51_90_56&#39;)"><span class="hl_conref"><span class="mpre">Conid</span></span></a><span class="mpre">,</span><a name="loc_126_47_126_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_47_126_49&#39;)"><span class="hl_vardecl"><span class="mpre">c&#39;</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_126_47_126_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_47_126_49&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre">
                                      </span><a name="loc_127_39_127_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_39_127_40&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_136_11_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_11_136_16&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_127_39_127_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_39_127_40&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Conid &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_122_17_122_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_17_122_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot; =&gt;&quot;</span></span><span class="mpre">)
                              </span><a name="loc_128_31_128_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_31_128_32&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_136_11_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_11_136_16&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_128_31_128_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_31_128_32&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Conid &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_122_17_122_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_17_122_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot; no = or =&gt;&quot;</span></span><span class="mpre">)
        ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_32_90_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_32_90_38&#39;)"><span class="hl_conref"><span class="mpre">Layout</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_129_23_129_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_23_129_27&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) -&gt; case </span><a href="#loc_142_1_142_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_8&#39;)"><span class="hl_varref"><span class="mpre">context</span></span></a><span class="mpre"> </span><a href="#loc_129_23_129_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_23_129_27&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> of
                                   ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_21_90_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_21_90_29&#39;)"><span class="hl_conref"><span class="mpre">Keyglyph</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;=&gt;&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_130_53_130_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_53_130_57&#39;)"><span class="hl_vardecl"><span class="mpre">more</span></span></a><span class="mpre">) -&gt;
                                       case </span><a href="#loc_113_1_113_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_5&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_130_53_130_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_53_130_57&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre"> of
                                           ((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_51_90_56" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_51_90_56&#39;)"><span class="hl_conref"><span class="mpre">Conid</span></span></a><span class="mpre">,</span><a name="loc_132_52_132_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_52_132_54&#39;)"><span class="hl_vardecl"><span class="mpre">c&#39;</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_132_52_132_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_52_132_54&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre">
                                           </span><a name="loc_133_44_133_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_44_133_45&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_136_11_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_11_136_16&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_133_44_133_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_44_133_45&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;(...) =&gt;&quot;</span></span><span class="mpre">)
                                   </span><a name="loc_134_36_134_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_36_134_37&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_136_11_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_11_136_16&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_134_36_134_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_36_134_37&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;(...) no =&gt;&quot;</span></span><span class="mpre">)
        </span><a name="loc_135_9_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_10&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_136_11_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_11_136_16&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_135_9_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_10&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;no Conid or (...)&quot;</span></span><span class="mpre">)
    where </span><a name="loc_136_11_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_11_136_16&#39;)"><span class="hl_fundecl"><span class="mpre">debug</span></span></a><span class="mpre">   _   _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">-- debug (s:t) c = error (&quot;HsColour: getConid failed: &quot;++show s</span></span><span class="mpre">
       </span><span class="hl_comment"><span class="mpre">--                       ++&quot;\n  in the context of: &quot;++c)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- jump past possible class context</span></span><span class="mpre">
</span><a href="#loc_142_1_142_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_8&#39;)"><span class="mpre">context</span></a><span class="mpre"> ::  [(</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; [(</span><a href="Language.Haskell.HsColour.Classify.html#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
</span><a name="loc_142_1_142_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_8&#39;)"><span class="hl_fundecl"><span class="mpre">context</span></span></a><span class="mpre"> </span><a name="loc_142_9_142_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_15&#39;)"><span class="hl_specname"><span class="mpre">stream</span></span></a><span class="mpre">@((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_21_90_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_21_90_29&#39;)"><span class="hl_conref"><span class="mpre">Keyglyph</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;=&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><a href="#loc_142_9_142_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_9_142_15&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_142_1_142_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_8&#39;)"><span class="hl_fundecl"><span class="mpre">context</span></span></a><span class="mpre"> </span><a name="loc_143_9_143_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_9_143_15&#39;)"><span class="hl_specname"><span class="mpre">stream</span></span></a><span class="mpre">@((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_21_90_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_21_90_29&#39;)"><span class="hl_conref"><span class="mpre">Keyglyph</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;=&gt;&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><a href="#loc_143_9_143_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_9_143_15&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_142_1_142_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_8&#39;)"><span class="hl_fundecl"><span class="mpre">context</span></span></a><span class="mpre"> </span><a name="loc_144_9_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_15&#39;)"><span class="hl_specname"><span class="mpre">stream</span></span></a><span class="mpre">@((</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_21_90_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_21_90_29&#39;)"><span class="hl_conref"><span class="mpre">Keyglyph</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;⇒&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><a href="#loc_144_9_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_15&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_142_1_142_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_8&#39;)"><span class="hl_fundecl"><span class="mpre">context</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_145_12_145_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_12_145_18&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre">) = </span><a href="#loc_142_1_142_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_8&#39;)"><span class="hl_varref"><span class="mpre">context</span></span></a><span class="mpre"> </span><a href="#loc_145_12_145_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_12_145_18&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
</span><a href="#loc_142_1_142_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_8&#39;)"><span class="hl_fundecl"><span class="mpre">context</span></span></a><span class="mpre"> [] = []

</span><span class="hl_comment"><span class="mpre">-- the anchor name for an instance is just the entire instance head, minus</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- any extra context clause</span></span><span class="mpre">
</span><a name="loc_150_1_150_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_12&#39;)"><span class="hl_vardecl"><span class="mpre">getInstance</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.List.html#loc_1081_1_1081_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1081_1_1081_8&#39;)"><span class="hl_varref"><span class="mpre">unwords</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;instance&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.List.html#loc_1071_1_1071_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1071_1_1071_6&#39;)"><span class="hl_varref"><span class="mpre">words</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">
              </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_153_5_153_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_5_153_16&#39;)"><span class="hl_varref"><span class="mpre">trimContext</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">takeWhile</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre">(</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_11_90_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_11_90_18&#39;)"><span class="hl_conref"><span class="mpre">Keyword</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;where&quot;</span></span><span class="mpre">))
  where
    </span><a name="loc_153_5_153_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_5_153_16&#39;)"><span class="hl_fundecl"><span class="mpre">trimContext</span></span></a><span class="mpre"> </span><a name="loc_153_17_153_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_19&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre"> = if (</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_21_90_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_21_90_29&#39;)"><span class="hl_conref"><span class="mpre">Keyglyph</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;=&gt;&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_153_17_153_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_19&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
                     </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre">  (</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_21_90_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_21_90_29&#39;)"><span class="hl_conref"><span class="mpre">Keyglyph</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;⇒&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_153_17_153_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_19&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
                     then </span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">`notElem`</span></span><span class="mpre">[(</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_21_90_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_21_90_29&#39;)"><span class="hl_conref"><span class="mpre">Keyglyph</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;=&gt;&quot;</span></span><span class="mpre">)
                                                     ,(</span><a href="Language.Haskell.HsColour.Classify.html#loc_90_21_90_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Language.Haskell.HsColour.Classify.html#loc_90_21_90_29&#39;)"><span class="hl_conref"><span class="mpre">Keyglyph</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;⇒&quot;</span></span><span class="mpre">)]) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_153_17_153_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_19&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
                     else </span><a href="#loc_153_17_153_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_17_153_19&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- simple implementation of a string lookup table.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- replace this with something more sophisticated if needed.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hscolour-1.20.3/Language/Haskell/HsColour/Anchors.hs&quot;, srcSpanStartLine = 161, srcSpanStartColumn = 1, srcSpanEndLine = 161, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hscolour-1.20.3/Language/Haskell/HsColour/Anchors.hs&quot;, srcSpanStartLine = 161, srcSpanStartColumn = 1, srcSpanEndLine = 161, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hscolour-1.20.3/La"><span class="mpre">type ST = [String]</span></span><span class="mpre">

</span><a href="#loc_164_1_164_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_8&#39;)"><span class="mpre">emptyST</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre">
</span><a name="loc_164_1_164_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_8&#39;)"><span class="hl_vardecl"><span class="mpre">emptyST</span></span></a><span class="mpre"> = []

</span><a href="#loc_167_1_167_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_9&#39;)"><span class="mpre">insertST</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre">
</span><a name="loc_167_1_167_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_1_167_9&#39;)"><span class="hl_fundecl"><span class="mpre">insertST</span></span></a><span class="mpre"> </span><a name="loc_167_10_167_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_10_167_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_167_12_167_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_12_167_14&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_507_1_507_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_507_1_507_7&#39;)"><span class="hl_varref"><span class="mpre">insert</span></span></a><span class="mpre"> </span><a href="#loc_167_10_167_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_10_167_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_167_12_167_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_12_167_14&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">

</span><a href="#loc_170_1_170_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_5&#39;)"><span class="mpre">inST</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_170_1_170_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_1_170_5&#39;)"><span class="hl_fundecl"><span class="mpre">inST</span></span></a><span class="mpre"> </span><a name="loc_170_6_170_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_6_170_7&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_170_8_170_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_8_170_10&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> = </span><a href="#loc_170_6_170_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_6_170_7&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_170_8_170_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_8_170_10&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre">
</span></div></body></html>