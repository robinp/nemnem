<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module Network.Wai.Handler.Warp.Conduit where

import Control.Applicative
import Control.Exception
import Control.Monad (</span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="mpre">unless</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Conduit.hs&quot;, srcSpanStartLine = 6, srcSpanStartColumn = 8, srcSpanEndLine = 6, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Conduit.hs&quot;, srcSpanStartLine = 7, srcSpanStartColumn = 8, srcSpanEndLine = 7, srcSpanEndColumn = 34}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy.Char8&quot;"><span class="mpre">Data.ByteString.Lazy.Char8</span></span><span class="mpre"> (pack)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Conduit.hs&quot;, srcSpanStartLine = 8, srcSpanStartColumn = 18, srcSpanEndLine = 8, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Conduit.hs&quot;, srcSpanStartLine = 9, srcSpanStartColumn = 18, srcSpanEndLine = 9, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as S8
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Conduit.hs&quot;, srcSpanStartLine = 10, srcSpanStartColumn = 18, srcSpanEndLine = 10, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import qualified Data.IORef as I
import Data.Word (Word, Word8)
import Network.Wai.Handler.Warp.Types

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Contains a @Source@ and a byte count that is still to be read in.</span></span><span class="mpre">
data </span><a name="loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tycondecl"><span class="mpre">ISource</span></span></a><span class="mpre"> = </span><a name="loc_18_16_18_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_16_18_23&#39;)"><span class="hl_condecl"><span class="mpre">ISource</span></span></a><span class="mpre"> !</span><a href="Network.Wai.Handler.Warp.Types.html#loc_96_6_96_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_96_6_96_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre"> !(</span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">I.IORef</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)

</span><a href="#loc_21_1_21_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_10&#39;)"><span class="mpre">mkISource</span></a><span class="mpre"> :: </span><a href="Network.Wai.Handler.Warp.Types.html#loc_96_6_96_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_96_6_96_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">ISource</span></span></a><span class="mpre">
</span><a name="loc_21_1_21_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_10&#39;)"><span class="hl_fundecl"><span class="mpre">mkISource</span></span></a><span class="mpre"> </span><a name="loc_21_11_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_11_21_14&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> </span><a name="loc_21_15_21_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_15_21_18&#39;)"><span class="hl_vardecl"><span class="mpre">cnt</span></span></a><span class="mpre"> = do
    </span><a name="loc_22_5_22_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_8&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">I.newIORef</span></span></a><span class="mpre"> </span><a href="#loc_21_15_21_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_15_21_18&#39;)"><span class="hl_varref"><span class="mpre">cnt</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_18_16_18_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_16_18_23&#39;)"><span class="hl_conref"><span class="mpre">ISource</span></span></a><span class="mpre"> </span><a href="#loc_21_11_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_11_21_14&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_22_5_22_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Given an @IsolatedBSSource@ provide a @Source@ that only allows up to the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- specified number of bytes to be passed downstream. All leftovers should be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- retained within the @Source@. If there are not enough bytes available,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- throws a @ConnectionClosedByPeer@ exception.</span></span><span class="mpre">
</span><a href="#loc_30_1_30_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_12&#39;)"><span class="mpre">readISource</span></a><span class="mpre"> :: </span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">ISource</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_30_1_30_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_12&#39;)"><span class="hl_fundecl"><span class="mpre">readISource</span></span></a><span class="mpre"> (</span><a href="#loc_18_16_18_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_16_18_23&#39;)"><span class="hl_conref"><span class="mpre">ISource</span></span></a><span class="mpre"> </span><a name="loc_30_22_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_22_30_25&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> </span><a name="loc_30_26_30_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_26_30_29&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre">) = do
    </span><a name="loc_31_5_31_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_5_31_10&#39;)"><span class="hl_vardecl"><span class="mpre">count</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">I.readIORef</span></span></a><span class="mpre"> </span><a href="#loc_30_26_30_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_26_30_29&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
    if </span><a href="#loc_31_5_31_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_5_31_10&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
        then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
        else do

        </span><a name="loc_36_9_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">readSource</span></span></a><span class="mpre"> </span><a href="#loc_30_22_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_22_30_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- If no chunk available, then there aren&#39;t enough bytes in the</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- stream. Throw a ConnectionClosedByPeer</span></span><span class="mpre">
        </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_36_9_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.Types.html#loc_48_23_48_45" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_48_23_48_45&#39;)"><span class="hl_conref"><span class="mpre">ConnectionClosedByPeer</span></span></a><span class="mpre">

        let </span><span class="hl_comment"><span class="mpre">-- How many of the bytes in this chunk to send downstream</span></span><span class="mpre">
            </span><a name="loc_43_13_43_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_13_43_19&#39;)"><span class="hl_vardecl"><span class="mpre">toSend</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> </span><a href="#loc_31_5_31_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_5_31_10&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_36_9_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
            </span><span class="hl_comment"><span class="mpre">-- How many bytes will still remain to be sent downstream</span></span><span class="mpre">
            </span><a name="loc_45_13_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_19&#39;)"><span class="hl_vardecl"><span class="mpre">count&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_31_5_31_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_5_31_10&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_43_13_43_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_13_43_19&#39;)"><span class="hl_varref"><span class="mpre">toSend</span></span></a><span class="mpre">
        case </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- The expected count is greater than the size of the</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- chunk we just read. Send the entire chunk</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- downstream, and then loop on this function for the</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- next chunk.</span></span><span class="mpre">
                | </span><a href="#loc_45_13_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_19&#39;)"><span class="hl_varref"><span class="mpre">count&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> -&gt; do
                    </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">I.writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_30_26_30_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_26_30_29&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_45_13_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_19&#39;)"><span class="hl_varref"><span class="mpre">count&#39;</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_36_9_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

                </span><span class="hl_comment"><span class="mpre">-- Some of the bytes in this chunk should not be sent</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- downstream. Split up the chunk into the sent and</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- not-sent parts, add the not-sent parts onto the new</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- source, and send the rest of the chunk downstream.</span></span><span class="mpre">
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; do
                    let (</span><a name="loc_61_26_61_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_26_61_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_61_29_61_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_29_61_30&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.splitAt</span></span><span class="mpre"> </span><a href="#loc_43_13_43_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_13_43_19&#39;)"><span class="hl_varref"><span class="mpre">toSend</span></span></a><span class="mpre"> </span><a href="#loc_36_9_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                    </span><a href="Network.Wai.Handler.Warp.Types.html#loc_117_1_117_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_117_1_117_15&#39;)"><span class="hl_varref"><span class="mpre">leftoverSource</span></span></a><span class="mpre"> </span><a href="#loc_30_22_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_22_30_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_61_29_61_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_29_61_30&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><a href="#loc_45_13_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_19&#39;)"><span class="hl_varref"><span class="mpre">count&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">I.writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_30_26_30_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_26_30_29&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_45_13_45_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_13_45_19&#39;)"><span class="hl_varref"><span class="mpre">count&#39;</span></span></a><span class="mpre">
                    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_61_26_61_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_26_61_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Extract the underlying @Source@ from an @IsolatedBSSource@, which will not</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- perform any more isolation.</span></span><span class="mpre">
</span><a href="#loc_69_1_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_12&#39;)"><span class="mpre">isourceDone</span></a><span class="mpre"> :: </span><a href="#loc_18_6_18_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_13&#39;)"><span class="hl_tyconref"><span class="mpre">ISource</span></span></a><span class="mpre"> -&gt; </span><a href="Network.Wai.Handler.Warp.Types.html#loc_96_6_96_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_96_6_96_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre">
</span><a name="loc_69_1_69_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_12&#39;)"><span class="hl_fundecl"><span class="mpre">isourceDone</span></span></a><span class="mpre"> (</span><a href="#loc_18_16_18_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_16_18_23&#39;)"><span class="hl_conref"><span class="mpre">ISource</span></span></a><span class="mpre"> </span><a name="loc_69_22_69_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_22_69_25&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> _) = </span><a href="#loc_69_22_69_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_22_69_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

data </span><a name="loc_73_6_73_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_6_73_13&#39;)"><span class="hl_tycondecl"><span class="mpre">CSource</span></span></a><span class="mpre"> = </span><a name="loc_73_16_73_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_16_73_23&#39;)"><span class="hl_condecl"><span class="mpre">CSource</span></span></a><span class="mpre"> !</span><a href="Network.Wai.Handler.Warp.Types.html#loc_96_6_96_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_96_6_96_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre"> !(</span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">I.IORef</span></span></a><span class="mpre"> </span><a href="#loc_75_6_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_16&#39;)"><span class="hl_tyconref"><span class="mpre">ChunkState</span></span></a><span class="mpre">)

data </span><a name="loc_75_6_75_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_16&#39;)"><span class="hl_tycondecl"><span class="mpre">ChunkState</span></span></a><span class="mpre"> = </span><a name="loc_75_19_75_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_19_75_26&#39;)"><span class="hl_condecl"><span class="mpre">NeedLen</span></span></a><span class="mpre">
                | </span><a name="loc_76_19_76_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_19_76_33&#39;)"><span class="hl_condecl"><span class="mpre">NeedLenNewline</span></span></a><span class="mpre">
                | </span><a name="loc_77_19_77_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_19_77_26&#39;)"><span class="hl_condecl"><span class="mpre">HaveLen</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word</span></span><span class="mpre">
                | </span><a name="loc_78_19_78_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_19_78_31&#39;)"><span class="hl_condecl"><span class="mpre">DoneChunking</span></span></a><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Conduit.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 5, srcSpanEndLine = 79, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Conduit.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 5, srcSpanEndLine = 79, srcSpanEndColumn = 13}]}) [IHead (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nem"><span class="mpre">deriving Show</span></span><span class="mpre">

</span><a href="#loc_82_1_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_7&#39;)"><span class="mpre">bsCRLF</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">
</span><a name="loc_82_1_82_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_7&#39;)"><span class="hl_vardecl"><span class="mpre">bsCRLF</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">pack</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\r\n&quot;</span></span><span class="mpre">

</span><a href="#loc_85_1_85_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_10&#39;)"><span class="mpre">mkCSource</span></a><span class="mpre"> :: </span><a href="Network.Wai.Handler.Warp.Types.html#loc_96_6_96_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_96_6_96_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_73_6_73_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_6_73_13&#39;)"><span class="hl_tyconref"><span class="mpre">CSource</span></span></a><span class="mpre">
</span><a name="loc_85_1_85_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_10&#39;)"><span class="hl_fundecl"><span class="mpre">mkCSource</span></span></a><span class="mpre"> </span><a name="loc_85_11_85_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_11_85_14&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = do
    </span><a name="loc_86_5_86_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_8&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">I.newIORef</span></span></a><span class="mpre"> </span><a href="#loc_75_19_75_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_19_75_26&#39;)"><span class="hl_conref"><span class="mpre">NeedLen</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_73_16_73_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_16_73_23&#39;)"><span class="hl_conref"><span class="mpre">CSource</span></span></a><span class="mpre"> </span><a href="#loc_85_11_85_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_11_85_14&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_86_5_86_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">

</span><a href="#loc_90_1_90_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_12&#39;)"><span class="mpre">readCSource</span></a><span class="mpre"> :: </span><a href="#loc_73_6_73_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_6_73_13&#39;)"><span class="hl_tyconref"><span class="mpre">CSource</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_90_1_90_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_1_90_12&#39;)"><span class="hl_fundecl"><span class="mpre">readCSource</span></span></a><span class="mpre"> (</span><a href="#loc_73_16_73_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_16_73_23&#39;)"><span class="hl_conref"><span class="mpre">CSource</span></span></a><span class="mpre"> </span><a name="loc_90_22_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_25&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> </span><a name="loc_90_26_90_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_26_90_29&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre">) = do
    </span><a name="loc_91_5_91_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_5_91_9&#39;)"><span class="hl_vardecl"><span class="mpre">mlen</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">I.readIORef</span></span></a><span class="mpre"> </span><a href="#loc_90_26_90_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_26_90_29&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
    </span><a href="#loc_132_5_132_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_5_132_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_91_5_91_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_5_91_9&#39;)"><span class="hl_varref"><span class="mpre">mlen</span></span></a><span class="mpre">
  where
    </span><a name="loc_94_5_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_12&#39;)"><span class="hl_fundecl"><span class="mpre">withLen</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_94_15_94_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_17&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = do
        </span><a href="Network.Wai.Handler.Warp.Types.html#loc_117_1_117_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_117_1_117_15&#39;)"><span class="hl_varref"><span class="mpre">leftoverSource</span></span></a><span class="mpre"> </span><a href="#loc_90_22_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_94_15_94_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_17&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        </span><a href="#loc_116_5_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_5_116_13&#39;)"><span class="hl_varref"><span class="mpre">dropCRLF</span></span></a><span class="mpre">
        </span><a href="#loc_112_5_112_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_5_112_11&#39;)"><span class="hl_varref"><span class="mpre">yield&#39;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre"> </span><a href="#loc_78_19_78_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_19_78_31&#39;)"><span class="hl_conref"><span class="mpre">DoneChunking</span></span></a><span class="mpre">
    </span><a href="#loc_94_5_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_12&#39;)"><span class="hl_fundecl"><span class="mpre">withLen</span></span></a><span class="mpre"> </span><a name="loc_98_13_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_13_98_16&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> </span><a name="loc_98_17_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_17_98_19&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_98_17_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_17_98_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> = do
            </span><span class="hl_comment"><span class="mpre">-- FIXME should this throw an exception if len &gt; 0?</span></span><span class="mpre">
            </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">I.writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_90_26_90_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_26_90_29&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_78_19_78_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_19_78_31&#39;)"><span class="hl_conref"><span class="mpre">DoneChunking</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
            case </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_98_17_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_17_98_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`compare`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_98_13_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_13_98_16&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; </span><a href="#loc_112_5_112_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_5_112_11&#39;)"><span class="hl_varref"><span class="mpre">yield&#39;</span></span></a><span class="mpre"> </span><a href="#loc_98_17_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_17_98_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_76_19_76_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_19_76_33&#39;)"><span class="hl_conref"><span class="mpre">NeedLenNewline</span></span></a><span class="mpre">
                </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; </span><a href="#loc_112_5_112_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_5_112_11&#39;)"><span class="hl_varref"><span class="mpre">yield&#39;</span></span></a><span class="mpre"> </span><a href="#loc_98_17_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_17_98_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_77_19_77_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_19_77_26&#39;)"><span class="hl_conref"><span class="mpre">HaveLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_98_13_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_13_98_16&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_98_17_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_17_98_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
                </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; do
                    let (</span><a name="loc_108_26_108_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_26_108_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_108_29_108_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_29_108_30&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.splitAt</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_98_13_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_13_98_16&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">) </span><a href="#loc_98_17_98_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_17_98_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
                    </span><a href="Network.Wai.Handler.Warp.Types.html#loc_117_1_117_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_117_1_117_15&#39;)"><span class="hl_varref"><span class="mpre">leftoverSource</span></span></a><span class="mpre"> </span><a href="#loc_90_22_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_108_29_108_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_29_108_30&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                    </span><a href="#loc_112_5_112_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_5_112_11&#39;)"><span class="hl_varref"><span class="mpre">yield&#39;</span></span></a><span class="mpre"> </span><a href="#loc_108_26_108_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_26_108_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_76_19_76_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_19_76_33&#39;)"><span class="hl_conref"><span class="mpre">NeedLenNewline</span></span></a><span class="mpre">

    </span><a name="loc_112_5_112_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_5_112_11&#39;)"><span class="hl_fundecl"><span class="mpre">yield&#39;</span></span></a><span class="mpre"> </span><a name="loc_112_12_112_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_12_112_14&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a name="loc_112_15_112_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_15_112_19&#39;)"><span class="hl_vardecl"><span class="mpre">mlen</span></span></a><span class="mpre"> = do
        </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">I.writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_90_26_90_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_26_90_29&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_112_15_112_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_15_112_19&#39;)"><span class="hl_varref"><span class="mpre">mlen</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_112_12_112_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_12_112_14&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

    </span><a name="loc_116_5_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_5_116_13&#39;)"><span class="hl_vardecl"><span class="mpre">dropCRLF</span></span></a><span class="mpre"> = do
        </span><a name="loc_117_9_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">readSource</span></span></a><span class="mpre"> </span><a href="#loc_90_22_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
        case </span><span class="hl_varref"><span class="mpre">S.uncons</span></span><span class="mpre"> </span><a href="#loc_117_9_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">, </span><a name="loc_120_23_120_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_23_120_26&#39;)"><span class="hl_vardecl"><span class="mpre">bs&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_124_5_124_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_5_124_11&#39;)"><span class="hl_varref"><span class="mpre">dropLF</span></span></a><span class="mpre"> </span><a href="#loc_120_23_120_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_23_120_26&#39;)"><span class="hl_varref"><span class="mpre">bs&#39;</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><a name="loc_121_23_121_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_23_121_26&#39;)"><span class="hl_vardecl"><span class="mpre">bs&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="Network.Wai.Handler.Warp.Types.html#loc_117_1_117_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_117_1_117_15&#39;)"><span class="hl_varref"><span class="mpre">leftoverSource</span></span></a><span class="mpre"> </span><a href="#loc_90_22_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_121_23_121_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_23_121_26&#39;)"><span class="hl_varref"><span class="mpre">bs&#39;</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> _ -&gt; </span><a href="Network.Wai.Handler.Warp.Types.html#loc_117_1_117_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_117_1_117_15&#39;)"><span class="hl_varref"><span class="mpre">leftoverSource</span></span></a><span class="mpre"> </span><a href="#loc_90_22_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_117_9_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

    </span><a name="loc_124_5_124_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_5_124_11&#39;)"><span class="hl_fundecl"><span class="mpre">dropLF</span></span></a><span class="mpre"> </span><a name="loc_124_12_124_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_12_124_14&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
        case </span><span class="hl_varref"><span class="mpre">S.uncons</span></span><span class="mpre"> </span><a href="#loc_124_12_124_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_12_124_14&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; do
                </span><a name="loc_127_17_127_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_17_127_20&#39;)"><span class="hl_vardecl"><span class="mpre">bs2</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Types.html#loc_114_1_114_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_114_1_114_12&#39;)"><span class="hl_varref"><span class="mpre">readSource&#39;</span></span></a><span class="mpre"> </span><a href="#loc_90_22_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
                </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_127_17_127_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_17_127_20&#39;)"><span class="hl_varref"><span class="mpre">bs2</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_124_5_124_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_5_124_11&#39;)"><span class="hl_varref"><span class="mpre">dropLF</span></span></a><span class="mpre"> </span><a href="#loc_127_17_127_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_17_127_20&#39;)"><span class="hl_varref"><span class="mpre">bs2</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">, </span><a name="loc_129_23_129_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_23_129_26&#39;)"><span class="hl_vardecl"><span class="mpre">bs&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="Network.Wai.Handler.Warp.Types.html#loc_117_1_117_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_117_1_117_15&#39;)"><span class="hl_varref"><span class="mpre">leftoverSource</span></span></a><span class="mpre"> </span><a href="#loc_90_22_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_129_23_129_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_23_129_26&#39;)"><span class="hl_varref"><span class="mpre">bs&#39;</span></span></a><span class="mpre">
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> _ -&gt; </span><a href="Network.Wai.Handler.Warp.Types.html#loc_117_1_117_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_117_1_117_15&#39;)"><span class="hl_varref"><span class="mpre">leftoverSource</span></span></a><span class="mpre"> </span><a href="#loc_90_22_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_124_12_124_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_12_124_14&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

    </span><a name="loc_132_5_132_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_5_132_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_75_19_75_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_19_75_26&#39;)"><span class="hl_conref"><span class="mpre">NeedLen</span></span></a><span class="mpre"> = </span><a href="#loc_145_5_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_5_145_11&#39;)"><span class="hl_varref"><span class="mpre">getLen</span></span></a><span class="mpre">
    </span><a href="#loc_132_5_132_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_5_132_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_76_19_76_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_19_76_33&#39;)"><span class="hl_conref"><span class="mpre">NeedLenNewline</span></span></a><span class="mpre"> = </span><a href="#loc_116_5_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_5_116_13&#39;)"><span class="hl_varref"><span class="mpre">dropCRLF</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_145_5_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_5_145_11&#39;)"><span class="hl_varref"><span class="mpre">getLen</span></span></a><span class="mpre">
    </span><a href="#loc_132_5_132_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_5_132_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_77_19_77_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_19_77_26&#39;)"><span class="hl_conref"><span class="mpre">HaveLen</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) = do
        </span><span class="hl_comment"><span class="mpre">-- Drop the final CRLF</span></span><span class="mpre">
        </span><a href="#loc_116_5_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_5_116_13&#39;)"><span class="hl_varref"><span class="mpre">dropCRLF</span></span></a><span class="mpre">
        </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">I.writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_90_26_90_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_26_90_29&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_78_19_78_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_19_78_31&#39;)"><span class="hl_conref"><span class="mpre">DoneChunking</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
    </span><a href="#loc_132_5_132_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_5_132_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_77_19_77_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_19_77_26&#39;)"><span class="hl_conref"><span class="mpre">HaveLen</span></span></a><span class="mpre"> </span><a name="loc_139_17_139_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_17_139_20&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) = do
        </span><a name="loc_140_9_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">readSource</span></span></a><span class="mpre"> </span><a href="#loc_90_22_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
        </span><a href="#loc_94_5_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_12&#39;)"><span class="hl_varref"><span class="mpre">withLen</span></span></a><span class="mpre"> </span><a href="#loc_139_17_139_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_17_139_20&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_140_9_140_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_9_140_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
    </span><a href="#loc_132_5_132_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_5_132_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_78_19_78_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_19_78_31&#39;)"><span class="hl_conref"><span class="mpre">DoneChunking</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- Get the length from the source, and then pass off control to withLen</span></span><span class="mpre">
    </span><a name="loc_145_5_145_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_5_145_11&#39;)"><span class="hl_vardecl"><span class="mpre">getLen</span></span></a><span class="mpre"> = do
        </span><a name="loc_146_9_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_9_146_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">readSource</span></span></a><span class="mpre"> </span><a href="#loc_90_22_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
        if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_146_9_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_9_146_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
            then do
                </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">I.writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_90_26_90_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_26_90_29&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_77_19_77_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_19_77_26&#39;)"><span class="hl_conref"><span class="mpre">HaveLen</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
            else do
                (</span><a name="loc_152_18_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_18_152_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_152_21_152_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_21_152_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) &lt;-
                    case </span><span class="hl_varref"><span class="mpre">S.breakByte</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><a href="#loc_146_9_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_9_146_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
                        (</span><a name="loc_154_26_154_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_26_154_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">, </span><a name="loc_154_29_154_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_29_154_30&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">)
                            | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_154_29_154_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_29_154_30&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> -&gt; do
                                </span><a name="loc_156_33_156_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_33_156_36&#39;)"><span class="hl_vardecl"><span class="mpre">bs2</span></span></a><span class="mpre"> &lt;- </span><a href="Network.Wai.Handler.Warp.Types.html#loc_114_1_114_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_114_1_114_12&#39;)"><span class="hl_varref"><span class="mpre">readSource&#39;</span></span></a><span class="mpre"> </span><a href="#loc_90_22_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
                                if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_156_33_156_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_33_156_36&#39;)"><span class="hl_varref"><span class="mpre">bs2</span></span></a><span class="mpre">
                                    then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_154_26_154_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_26_154_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_154_29_154_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_29_154_30&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
                                    else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.breakByte</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_146_9_146_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_9_146_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`S.append`</span></span><span class="mpre"> </span><a href="#loc_156_33_156_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_33_156_36&#39;)"><span class="hl_varref"><span class="mpre">bs2</span></span></a><span class="mpre">
                            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_154_26_154_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_26_154_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_154_29_154_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_29_154_30&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
                let </span><a name="loc_161_21_161_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_21_161_22&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> =
                        </span><span class="hl_varref"><span class="mpre">S.foldl&#39;</span></span><span class="mpre"> (\</span><a name="loc_162_36_162_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_36_162_37&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_162_38_162_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_38_162_39&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_162_36_162_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_36_162_37&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_172_5_172_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_14&#39;)"><span class="hl_varref"><span class="mpre">hexToWord</span></span></a><span class="mpre"> </span><a href="#loc_162_38_162_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_38_162_39&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                        </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.takeWhile</span></span><span class="mpre"> </span><a href="#loc_178_1_178_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_11&#39;)"><span class="hl_varref"><span class="mpre">isHexDigit</span></span></a><span class="mpre"> </span><a href="#loc_152_18_152_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_18_152_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

                let </span><a name="loc_165_21_165_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_21_165_23&#39;)"><span class="hl_vardecl"><span class="mpre">y&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_152_21_152_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_21_152_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                </span><a name="loc_166_17_166_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_17_166_20&#39;)"><span class="hl_vardecl"><span class="mpre">y&#39;&#39;</span></span></a><span class="mpre"> &lt;-
                    if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_165_21_165_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_21_165_23&#39;)"><span class="hl_varref"><span class="mpre">y&#39;</span></span></a><span class="mpre">
                        then </span><a href="Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Types.html#loc_104_1_104_11&#39;)"><span class="hl_varref"><span class="mpre">readSource</span></span></a><span class="mpre"> </span><a href="#loc_90_22_90_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_22_90_25&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
                        else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_165_21_165_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_21_165_23&#39;)"><span class="hl_varref"><span class="mpre">y&#39;</span></span></a><span class="mpre">
                </span><a href="#loc_94_5_94_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_12&#39;)"><span class="hl_varref"><span class="mpre">withLen</span></span></a><span class="mpre"> </span><a href="#loc_161_21_161_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_21_161_22&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="#loc_166_17_166_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_17_166_20&#39;)"><span class="hl_varref"><span class="mpre">y&#39;&#39;</span></span></a><span class="mpre">

    </span><a name="loc_172_5_172_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_5_172_14&#39;)"><span class="hl_fundecl"><span class="mpre">hexToWord</span></span></a><span class="mpre"> </span><a name="loc_172_15_172_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_15_172_16&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">
        | </span><a href="#loc_172_15_172_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_15_172_16&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">58</span></span><span class="mpre"> = </span><a href="#loc_172_15_172_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_15_172_16&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre">
        | </span><a href="#loc_172_15_172_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_15_172_16&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">71</span></span><span class="mpre"> = </span><a href="#loc_172_15_172_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_15_172_16&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">55</span></span><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_172_15_172_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_172_15_172_16&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">87</span></span><span class="mpre">

</span><a href="#loc_178_1_178_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_11&#39;)"><span class="mpre">isHexDigit</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_178_1_178_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_11&#39;)"><span class="hl_fundecl"><span class="mpre">isHexDigit</span></span></a><span class="mpre"> </span><a name="loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">57</span></span><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">65</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">70</span></span><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">97</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_178_12_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_12_178_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">102</span></span><span class="mpre">
</span></div></body></html>