<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}

module Network.Wai.Handler.Warp.IORef (
    module Data.IORef
#if !MIN_VERSION_base(4,6,0)
  , atomicModifyIORef&#39;
#endif
  ) where

import Data.IORef

#if !MIN_VERSION_base(4,6,0)
</span><span class="hl_comment"><span class="mpre">-- | Strict version of &#39;atomicModifyIORef&#39;.  This forces both the value stored</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in the &#39;IORef&#39; as well as the value returned.</span></span><span class="mpre">
</span><a href="#loc_16_1_16_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_1_16_19&#39;)"><span class="mpre">atomicModifyIORef&#39;</span></a><span class="mpre"> :: </span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_16_1_16_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_1_16_19&#39;)"><span class="hl_fundecl"><span class="mpre">atomicModifyIORef&#39;</span></span></a><span class="mpre"> </span><a name="loc_16_20_16_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_20_16_23&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a name="loc_16_24_16_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_24_16_25&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
    </span><a name="loc_17_5_17_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_5_17_6&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> &lt;- </span><a href="Data.IORef.html#loc_101_1_101_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_101_1_101_18&#39;)"><span class="hl_varref"><span class="mpre">atomicModifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_16_20_16_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_20_16_23&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
            (\</span><a name="loc_18_15_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_15_18_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; let (</span><a name="loc_18_25_18_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_25_18_26&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_18_28_18_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_28_18_29&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_16_24_16_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_24_16_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_18_15_18_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_15_18_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- Lazy application of &quot;f&quot;</span></span><span class="mpre">
                    in (</span><a href="#loc_18_25_18_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_25_18_26&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_18_25_18_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_25_18_26&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><a href="#loc_18_28_18_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_28_18_29&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)) </span><span class="hl_comment"><span class="mpre">-- Lazy application of &quot;seq&quot;</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- The following forces &quot;a `seq` b&quot;, so it also forces &quot;f x&quot;.</span></span><span class="mpre">
    </span><a href="#loc_17_5_17_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_5_17_6&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_17_5_17_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_5_17_6&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
#endif
</span></div></body></html>