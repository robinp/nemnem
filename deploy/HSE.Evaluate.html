<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE ViewPatterns #-}

</span><span class="hl_comment"><span class="mpre">-- Evaluate a HSE Exp as much as possible</span></span><span class="mpre">
module HSE.Evaluate(evaluate) where

import HSE.Match
import HSE.Util
import HSE.Type
import HSE.Bracket


</span><a href="#loc_13_1_13_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_1_13_9&#39;)"><span class="mpre">evaluate</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Exp_</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Exp_</span></span><span class="mpre">
</span><a name="loc_13_1_13_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_1_13_9&#39;)"><span class="hl_vardecl"><span class="mpre">evaluate</span></span></a><span class="mpre"> = </span><a href="HSE.Util.html#loc_60_1_60_10" onmouseover="nemnem.highlightLocalToRemote(&#39;HSE.Util.html#loc_60_1_60_10&#39;)"><span class="hl_varref"><span class="mpre">fromParen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">transform</span></span><span class="mpre"> </span><a href="#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="hl_varref"><span class="mpre">evaluate1</span></span></a><span class="mpre">


</span><a href="#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="mpre">evaluate1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Exp_</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Exp_</span></span><span class="mpre">
</span><a name="loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="hl_fundecl"><span class="mpre">evaluate1</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">App</span></span><span class="mpre"> </span><a name="loc_17_16_17_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_16_17_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_17_18_17_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_18_17_21&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Lit</span></span><span class="mpre"> _ (</span><span class="hl_conref"><span class="mpre">String</span></span><span class="mpre"> _ </span><a name="loc_17_39_17_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_39_17_41&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> _))) | </span><a href="#loc_17_18_17_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_18_17_21&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="HSE.Match.html#loc_43_1_43_5" onmouseover="nemnem.highlightLocalToRemote(&#39;HSE.Match.html#loc_43_1_43_5&#39;)"><span class="hl_infix"><span class="mpre">~=</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;length&quot;</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Lit</span></span><span class="mpre"> </span><a href="#loc_17_16_17_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_16_17_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Int</span></span><span class="mpre"> </span><a href="#loc_17_16_17_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_16_17_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_18_11_18_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_11_18_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_18_11_18_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_11_18_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
    where </span><a name="loc_18_11_18_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_11_18_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_17_39_17_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_39_17_41&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
</span><a href="#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="hl_fundecl"><span class="mpre">evaluate1</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">App</span></span><span class="mpre"> </span><a name="loc_19_16_19_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_16_19_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_19_18_19_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_18_19_21&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">List</span></span><span class="mpre"> _ </span><a name="loc_19_30_19_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_30_19_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)) | </span><a href="#loc_19_18_19_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_18_19_21&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="HSE.Match.html#loc_43_1_43_5" onmouseover="nemnem.highlightLocalToRemote(&#39;HSE.Match.html#loc_43_1_43_5&#39;)"><span class="hl_infix"><span class="mpre">~=</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;length&quot;</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Lit</span></span><span class="mpre"> </span><a href="#loc_19_16_19_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_16_19_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Int</span></span><span class="mpre"> </span><a href="#loc_19_16_19_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_16_19_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_20_11_20_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_11_20_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_20_11_20_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_11_20_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)
    where </span><a name="loc_20_11_20_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_11_20_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_19_30_19_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_30_19_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
</span><a href="#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="hl_fundecl"><span class="mpre">evaluate1</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPViewPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/HSE/Evaluate.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 12, srcSpanEndLine = 21, srcSpanEndColumn = 47}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/HSE/Evaluate.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 17, srcSpanEndLine = 21, srcSpanEndColumn = 19}]}) (Var (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/HSE/Evaluate.hs"><span class="mpre">view -&gt; App2 op (Lit _ x) (Lit _ y)</span></span><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">op</span></span><span class="mpre"> </span><a href="HSE.Match.html#loc_43_1_43_5" onmouseover="nemnem.highlightLocalToRemote(&#39;HSE.Match.html#loc_43_1_43_5&#39;)"><span class="hl_infix"><span class="mpre">~=</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;==&quot;</span></span><span class="mpre"> = </span><a href="HSE.Match.html#loc_49_5_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;HSE.Match.html#loc_49_5_49_12&#39;)"><span class="hl_varref"><span class="mpre">toNamed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">x</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">=~=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">y</span></span><span class="mpre">
</span><a href="#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="hl_fundecl"><span class="mpre">evaluate1</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPViewPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/HSE/Evaluate.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 12, srcSpanEndLine = 22, srcSpanEndColumn = 67}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/HSE/Evaluate.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 17, srcSpanEndLine = 22, srcSpanEndColumn = 19}]}) (Var (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/HSE/Evaluate.hs"><span class="mpre">view -&gt; App2 op (Lit _ (Int _ x _)) (Lit _ (Int _ y _))</span></span><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">op</span></span><span class="mpre"> </span><a href="HSE.Match.html#loc_43_1_43_5" onmouseover="nemnem.highlightLocalToRemote(&#39;HSE.Match.html#loc_43_1_43_5&#39;)"><span class="hl_infix"><span class="mpre">~=</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&gt;=&quot;</span></span><span class="mpre"> = </span><a href="HSE.Match.html#loc_49_5_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;HSE.Match.html#loc_49_5_49_12&#39;)"><span class="hl_varref"><span class="mpre">toNamed</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">x</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">y</span></span><span class="mpre">
</span><a href="#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="hl_fundecl"><span class="mpre">evaluate1</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPViewPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/HSE/Evaluate.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 12, srcSpanEndLine = 24, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/HSE/Evaluate.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 17, srcSpanEndLine = 24, srcSpanEndColumn = 19}]}) (Var (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hlint-1.9/src/HSE/Evaluate.hs"><span class="mpre">view -&gt; App2 op x y</span></span><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">op</span></span><span class="mpre"> </span><a href="HSE.Match.html#loc_43_1_43_5" onmouseover="nemnem.highlightLocalToRemote(&#39;HSE.Match.html#loc_43_1_43_5&#39;)"><span class="hl_infix"><span class="mpre">~=</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&amp;&amp;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">x</span></span><span class="mpre"> </span><a href="HSE.Match.html#loc_43_1_43_5" onmouseover="nemnem.highlightLocalToRemote(&#39;HSE.Match.html#loc_43_1_43_5&#39;)"><span class="hl_infix"><span class="mpre">~=</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;True&quot;</span></span><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">y</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">op</span></span><span class="mpre"> </span><a href="HSE.Match.html#loc_43_1_43_5" onmouseover="nemnem.highlightLocalToRemote(&#39;HSE.Match.html#loc_43_1_43_5&#39;)"><span class="hl_infix"><span class="mpre">~=</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&amp;&amp;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">x</span></span><span class="mpre"> </span><a href="HSE.Match.html#loc_43_1_43_5" onmouseover="nemnem.highlightLocalToRemote(&#39;HSE.Match.html#loc_43_1_43_5&#39;)"><span class="hl_infix"><span class="mpre">~=</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;False&quot;</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">x</span></span><span class="mpre">
</span><a href="#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="hl_fundecl"><span class="mpre">evaluate1</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Paren</span></span><span class="mpre"> _ </span><a name="loc_27_20_27_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_20_27_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) | </span><a href="HSE.Bracket.html#loc_16_5_16_11" onmouseover="nemnem.highlightLocalToRemote(&#39;HSE.Bracket.html#loc_16_5_16_11&#39;)"><span class="hl_varref"><span class="mpre">isAtom</span></span></a><span class="mpre"> </span><a href="#loc_27_20_27_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_20_27_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_27_20_27_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_20_27_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_10&#39;)"><span class="hl_fundecl"><span class="mpre">evaluate1</span></span></a><span class="mpre"> </span><a name="loc_28_11_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_11_28_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_28_11_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_11_28_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span></div></body></html>