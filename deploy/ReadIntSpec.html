<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module ReadIntSpec (main, spec) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ReadIntSpec.hs&quot;, srcSpanStartLine = 3, srcSpanStartColumn = 8, srcSpanEndLine = 3, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ReadIntSpec.hs&quot;, srcSpanStartLine = 4, srcSpanStartColumn = 8, srcSpanEndLine = 4, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.Hspec&quot;"><span class="mpre">Test.Hspec</span></span><span class="mpre">
import Network.Wai.Handler.Warp.ReadInt
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ReadIntSpec.hs&quot;, srcSpanStartLine = 6, srcSpanStartColumn = 18, srcSpanEndLine = 6, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as B
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ReadIntSpec.hs&quot;, srcSpanStartLine = 7, srcSpanStartColumn = 18, srcSpanEndLine = 7, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Test.QuickCheck&quot;"><span class="mpre">Test.QuickCheck</span></span><span class="mpre"> as QC

</span><a href="#loc_10_1_10_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_5&#39;)"><span class="mpre">main</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_10_1_10_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_10_1_10_5&#39;)"><span class="hl_vardecl"><span class="mpre">main</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">hspec</span></span><span class="mpre"> </span><a href="#loc_13_1_13_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_1_13_5&#39;)"><span class="hl_varref"><span class="mpre">spec</span></span></a><span class="mpre">

</span><a href="#loc_13_1_13_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_1_13_5&#39;)"><span class="mpre">spec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_13_1_13_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_1_13_5&#39;)"><span class="hl_vardecl"><span class="mpre">spec</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;readInt64&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;converts ByteString to Int&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">QC.property</span></span><span class="mpre"> (</span><a href="#loc_23_1_23_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_26&#39;)"><span class="hl_varref"><span class="mpre">prop_read_show_idempotent</span></span></a><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.ReadInt.html#loc_37_1_37_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.ReadInt.html#loc_37_1_37_10&#39;)"><span class="hl_varref"><span class="mpre">readInt64</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- A QuickCheck property. Test that for a number &gt;= 0, converting it to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a string using show and then reading the value back with the function</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- under test returns the original value.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The functions under test only work on Natural numbers (the Conent-Length</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- field in a HTTP header is always &gt;= 0) so we check the absolute value of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the value that QuickCheck generates for us.</span></span><span class="mpre">
</span><a href="#loc_23_1_23_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_26&#39;)"><span class="mpre">prop_read_show_idempotent</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ReadIntSpec.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 30, srcSpanEndLine = 22, srcSpanEndColumn = 53}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ReadIntSpec.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 30, srcSpanEndLine = 22, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ReadIntSpec.hs&quot;, srcSpanStartLine = 22, sr"><span class="mpre">(Integral a, Show a) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_23_1_23_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_26&#39;)"><span class="hl_fundecl"><span class="mpre">prop_read_show_idempotent</span></span></a><span class="mpre"> </span><a name="loc_23_27_23_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_27_23_34&#39;)"><span class="hl_vardecl"><span class="mpre">freader</span></span></a><span class="mpre"> </span><a name="loc_23_35_23_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_35_23_36&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_25_5_25_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_7&#39;)"><span class="hl_varref"><span class="mpre">px</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_23_27_23_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_27_23_34&#39;)"><span class="hl_varref"><span class="mpre">freader</span></span></a><span class="mpre"> (</span><a href="#loc_26_5_26_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_5_26_17&#39;)"><span class="hl_varref"><span class="mpre">toByteString</span></span></a><span class="mpre"> </span><a href="#loc_25_5_25_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_7&#39;)"><span class="hl_varref"><span class="mpre">px</span></span></a><span class="mpre">)
  where
    </span><a name="loc_25_5_25_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_7&#39;)"><span class="hl_vardecl"><span class="mpre">px</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">abs</span></span><span class="mpre"> </span><a href="#loc_23_35_23_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_35_23_36&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
    </span><a name="loc_26_5_26_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_5_26_17&#39;)"><span class="hl_vardecl"><span class="mpre">toByteString</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">
</span></div></body></html>