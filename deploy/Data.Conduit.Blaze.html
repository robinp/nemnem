<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE FlexibleContexts #-}
{-# LANGUAGE BangPatterns #-}
{-# LANGUAGE RankNTypes #-}
</span><span class="hl_comment"><span class="mpre">-- | Convert a stream of blaze-builder @Builder@s into a stream of @ByteString@s.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Adapted from blaze-builder-enumerator, written by myself and Simon Meier.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that the functions here can work in any monad built on top of @IO@ or</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @ST@.</span></span><span class="mpre">
module Data.Conduit.Blaze
    (

  </span><span class="hl_comment"><span class="mpre">-- * Conduits from builders to bytestrings</span></span><span class="mpre">
    builderToByteString
  , unsafeBuilderToByteString
  , builderToByteStringWith

  </span><span class="hl_comment"><span class="mpre">-- ** Flush</span></span><span class="mpre">
  , builderToByteStringFlush
  , builderToByteStringWithFlush

  </span><span class="hl_comment"><span class="mpre">-- * Buffers</span></span><span class="mpre">
  , Buffer

  </span><span class="hl_comment"><span class="mpre">-- ** Status information</span></span><span class="mpre">
  , freeSize
  , sliceSize
  , bufferSize

  </span><span class="hl_comment"><span class="mpre">-- ** Creation and modification</span></span><span class="mpre">
  , allocBuffer
  , reuseBuffer
  , nextSlice

  </span><span class="hl_comment"><span class="mpre">-- ** Conversion to bytestings</span></span><span class="mpre">
  , unsafeFreezeBuffer
  , unsafeFreezeNonEmptyBuffer

  </span><span class="hl_comment"><span class="mpre">-- * Buffer allocation strategies</span></span><span class="mpre">
  , BufferAllocStrategy
  , allNewBuffersStrategy
  , reuseBufferStrategy
    ) where

import Data.Conduit
import Control.Monad (</span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="mpre">unless</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="mpre">liftM</span></a><span class="mpre">)
import Control.Monad.Trans.Class (</span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="mpre">lift</span></a><span class="mpre">, </span><a href="Control.Monad.Trans.Class.html#loc_49_7_49_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_49_7_49_17&#39;)"><span class="mpre">MonadTrans</span></a><span class="mpre">)

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 18, srcSpanEndLine = 49, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">                   as S

import Blaze.ByteString.Builder.Internal
import Blaze.ByteString.Builder.Internal.Types
import Blaze.ByteString.Builder.Internal.Buffer
import Control.Monad.Primitive (</span><a href="Control.Monad.Primitive.html#loc_32_18_32_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Primitive.html#loc_32_18_32_27&#39;)"><span class="mpre">PrimMonad</span></a><span class="mpre">, </span><a href="Control.Monad.Primitive.html#loc_83_1_83_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Primitive.html#loc_83_1_83_17&#39;)"><span class="mpre">unsafePrimToPrim</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 8, srcSpanEndLine = 55, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;Control.Monad.Base&quot;"><span class="mpre">Control.Monad.Base</span></span><span class="mpre"> (MonadBase, liftBase)
import Data.Streaming.Blaze

</span><a href="#loc_59_1_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_13&#39;)"><span class="mpre">unsafeLiftIO</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 58, srcSpanStartColumn = 17, srcSpanEndLine = 58, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 58, srcSpanStartColumn = 17, srcSpanEndLine = 58, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;"><span class="mpre">(MonadBase base m, PrimMonad base) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_59_1_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_13&#39;)"><span class="hl_vardecl"><span class="mpre">unsafeLiftIO</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">liftBase</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Monad.Primitive.html#loc_83_1_83_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Primitive.html#loc_83_1_83_17&#39;)"><span class="hl_varref"><span class="mpre">unsafePrimToPrim</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Incrementally execute builders and pass on the filled chunks as</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- bytestrings.</span></span><span class="mpre">
</span><a href="#loc_64_1_64_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_20&#39;)"><span class="mpre">builderToByteString</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 24, srcSpanEndLine = 63, srcSpanEndColumn = 61}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 24, srcSpanEndLine = 63, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;"><span class="mpre">(MonadBase base m, PrimMonad base) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Conduit</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
</span><a name="loc_64_1_64_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_20&#39;)"><span class="hl_vardecl"><span class="mpre">builderToByteString</span></span></a><span class="mpre"> =
  </span><a href="#loc_94_1_94_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_24&#39;)"><span class="hl_varref"><span class="mpre">builderToByteStringWith</span></span></a><span class="mpre"> </span><a href="Data.Streaming.Blaze.html#loc_61_1_61_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Streaming.Blaze.html#loc_61_1_61_16&#39;)"><span class="hl_varref"><span class="mpre">defaultStrategy</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 0.0.2</span></span><span class="mpre">
</span><a href="#loc_71_1_71_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_25&#39;)"><span class="mpre">builderToByteStringFlush</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 29, srcSpanEndLine = 70, srcSpanEndColumn = 66}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 29, srcSpanEndLine = 70, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;"><span class="mpre">(MonadBase base m, PrimMonad base) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Conduit</span></span><span class="mpre"> (</span><a href="Data.Conduit.html#loc_358_6_358_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_6_358_11&#39;)"><span class="hl_tyconref"><span class="mpre">Flush</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><a href="Data.Conduit.html#loc_358_6_358_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_6_358_11&#39;)"><span class="hl_tyconref"><span class="mpre">Flush</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)
</span><a name="loc_71_1_71_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_25&#39;)"><span class="hl_vardecl"><span class="mpre">builderToByteStringFlush</span></span></a><span class="mpre"> =
  </span><a href="#loc_107_1_107_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_29&#39;)"><span class="hl_varref"><span class="mpre">builderToByteStringWithFlush</span></span></a><span class="mpre"> </span><a href="Data.Streaming.Blaze.html#loc_61_1_61_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Streaming.Blaze.html#loc_61_1_61_16&#39;)"><span class="hl_varref"><span class="mpre">defaultStrategy</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Incrementally execute builders on the given buffer and pass on the filled</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- chunks as bytestrings. Note that, if the given buffer is too small for the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- execution of a build step, a larger one will be allocated.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- WARNING: This conduit yields bytestrings that are NOT</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- referentially transparent. Their content will be overwritten as soon</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as control is returned from the inner sink!</span></span><span class="mpre">
</span><a href="#loc_84_1_84_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_26&#39;)"><span class="mpre">unsafeBuilderToByteString</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 30, srcSpanEndLine = 82, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 30, srcSpanEndLine = 81, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;"><span class="mpre">(MonadBase base m, PrimMonad base)
                          =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Buffer.html#loc_71_6_71_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Buffer.html#loc_71_6_71_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- action yielding the inital buffer.</span></span><span class="mpre">
                          -&gt; </span><span class="hl_tyconref"><span class="mpre">Conduit</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
</span><a name="loc_84_1_84_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_26&#39;)"><span class="hl_vardecl"><span class="mpre">unsafeBuilderToByteString</span></span></a><span class="mpre"> = </span><a href="#loc_94_1_94_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_24&#39;)"><span class="hl_varref"><span class="mpre">builderToByteStringWith</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Buffer.html#loc_175_1_175_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Buffer.html#loc_175_1_175_20&#39;)"><span class="hl_varref"><span class="mpre">reuseBufferStrategy</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | A conduit that incrementally executes builders and passes on the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- filled chunks as bytestrings to an inner sink.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- INV: All bytestrings passed to the inner sink are non-empty.</span></span><span class="mpre">
</span><a href="#loc_94_1_94_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_24&#39;)"><span class="mpre">builderToByteStringWith</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 28, srcSpanEndLine = 92, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 28, srcSpanEndLine = 91, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;"><span class="mpre">(MonadBase base m, PrimMonad base)
                        =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BufferAllocStrategy</span></span><span class="mpre">
                        -&gt; </span><span class="hl_tyconref"><span class="mpre">Conduit</span></span><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
</span><a name="loc_94_1_94_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_24&#39;)"><span class="hl_vardecl"><span class="mpre">builderToByteStringWith</span></span></a><span class="mpre"> =
    </span><a href="#loc_114_1_114_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_7&#39;)"><span class="hl_varref"><span class="mpre">helper</span></span></a><span class="mpre"> (</span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="Data.Conduit.html#loc_358_16_358_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_16_358_21&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre">) </span><a href="Data.Conduit.html#loc_168_1_168_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_168_1_168_6&#39;)"><span class="hl_varref"><span class="mpre">await</span></span></a><span class="mpre">) </span><a href="#loc_97_5_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_11&#39;)"><span class="hl_varref"><span class="mpre">yield&#39;</span></span></a><span class="mpre">
  where
    </span><a name="loc_97_5_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_11&#39;)"><span class="hl_fundecl"><span class="mpre">yield&#39;</span></span></a><span class="mpre"> </span><a href="Data.Conduit.html#loc_358_26_358_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_26_358_31&#39;)"><span class="hl_conref"><span class="mpre">Flush</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
    </span><a href="#loc_97_5_97_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_11&#39;)"><span class="hl_fundecl"><span class="mpre">yield&#39;</span></span></a><span class="mpre"> (</span><a href="Data.Conduit.html#loc_358_16_358_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_16_358_21&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a name="loc_98_19_98_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_19_98_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) = </span><a href="Data.Conduit.html#loc_180_1_180_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_180_1_180_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> </span><a href="#loc_98_19_98_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_19_98_21&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Since 0.0.2</span></span><span class="mpre">
</span><a href="#loc_107_1_107_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_29&#39;)"><span class="mpre">builderToByteStringWithFlush</span></a><span class="mpre">
    :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 104, srcSpanStartColumn = 8, srcSpanEndLine = 105, srcSpanEndColumn = 7}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 104, srcSpanStartColumn = 8, srcSpanEndLine = 104, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;"><span class="mpre">(MonadBase base m, PrimMonad base)
    =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">BufferAllocStrategy</span></span><span class="mpre">
    -&gt; </span><span class="hl_tyconref"><span class="mpre">Conduit</span></span><span class="mpre"> (</span><a href="Data.Conduit.html#loc_358_6_358_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_6_358_11&#39;)"><span class="hl_tyconref"><span class="mpre">Flush</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">) </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><a href="Data.Conduit.html#loc_358_6_358_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_6_358_11&#39;)"><span class="hl_tyconref"><span class="mpre">Flush</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)
</span><a name="loc_107_1_107_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_29&#39;)"><span class="hl_vardecl"><span class="mpre">builderToByteStringWithFlush</span></span></a><span class="mpre"> = </span><a href="#loc_114_1_114_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_7&#39;)"><span class="hl_varref"><span class="mpre">helper</span></span></a><span class="mpre"> </span><a href="Data.Conduit.html#loc_168_1_168_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_168_1_168_6&#39;)"><span class="hl_varref"><span class="mpre">await</span></span></a><span class="mpre"> </span><a href="Data.Conduit.html#loc_180_1_180_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_180_1_180_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre">

</span><a href="#loc_114_1_114_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_7&#39;)"><span class="mpre">helper</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 109, srcSpanStartColumn = 11, srcSpanEndLine = 110, srcSpanEndColumn = 10}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze.hs&quot;, srcSpanStartLine = 109, srcSpanStartColumn = 11, srcSpanEndLine = 109, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/conduit-extra-1.1.1/Data/Conduit/Blaze"><span class="mpre">(MonadBase base m, PrimMonad base, Monad (t m), MonadTrans t)
       =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><a href="Data.Conduit.html#loc_358_6_358_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_6_358_11&#39;)"><span class="hl_tyconref"><span class="mpre">Flush</span></span></a><span class="mpre"> </span><a href="Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.Types.html#loc_69_9_69_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">))
       -&gt; (</span><a href="Data.Conduit.html#loc_358_6_358_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_6_358_11&#39;)"><span class="hl_tyconref"><span class="mpre">Flush</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)
       -&gt; </span><span class="hl_tyconref"><span class="mpre">BufferAllocStrategy</span></span><span class="mpre">
       -&gt; </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_114_1_114_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_7&#39;)"><span class="hl_fundecl"><span class="mpre">helper</span></span></a><span class="mpre"> </span><a name="loc_114_8_114_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_8_114_14&#39;)"><span class="hl_vardecl"><span class="mpre">await&#39;</span></span></a><span class="mpre"> </span><a name="loc_114_15_114_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_15_114_21&#39;)"><span class="hl_vardecl"><span class="mpre">yield&#39;</span></span></a><span class="mpre"> </span><a name="loc_114_22_114_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_22_114_27&#39;)"><span class="hl_vardecl"><span class="mpre">strat</span></span></a><span class="mpre"> = do
    (</span><a name="loc_115_6_115_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_10&#39;)"><span class="hl_vardecl"><span class="mpre">recv</span></span></a><span class="mpre">, </span><a name="loc_115_12_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_12_115_18&#39;)"><span class="hl_vardecl"><span class="mpre">finish</span></span></a><span class="mpre">) &lt;- </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_59_1_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_13&#39;)"><span class="hl_varref"><span class="mpre">unsafeLiftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Streaming.Blaze.html#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Streaming.Blaze.html#loc_64_1_64_13&#39;)"><span class="hl_varref"><span class="mpre">newBlazeRecv</span></span></a><span class="mpre"> </span><a href="#loc_114_22_114_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_22_114_27&#39;)"><span class="hl_varref"><span class="mpre">strat</span></span></a><span class="mpre">
    let </span><a name="loc_116_9_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_13&#39;)"><span class="hl_vardecl"><span class="mpre">loop</span></span></a><span class="mpre"> = </span><a href="#loc_114_8_114_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_8_114_14&#39;)"><span class="hl_varref"><span class="mpre">await&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><a href="#loc_117_9_117_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_16&#39;)"><span class="hl_varref"><span class="mpre">finish&#39;</span></span></a><span class="mpre"> </span><a href="#loc_120_9_120_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_13&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre">
        </span><a name="loc_117_9_117_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_9_117_16&#39;)"><span class="hl_vardecl"><span class="mpre">finish&#39;</span></span></a><span class="mpre"> = do
            </span><a name="loc_118_13_118_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_13_118_16&#39;)"><span class="hl_vardecl"><span class="mpre">mbs</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_59_1_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_13&#39;)"><span class="hl_varref"><span class="mpre">unsafeLiftIO</span></span></a><span class="mpre"> </span><a href="#loc_115_12_115_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_12_115_18&#39;)"><span class="hl_varref"><span class="mpre">finish</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) (</span><a href="#loc_114_15_114_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_15_114_21&#39;)"><span class="hl_varref"><span class="mpre">yield&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Conduit.html#loc_358_16_358_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_16_358_21&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre">) </span><a href="#loc_118_13_118_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_13_118_16&#39;)"><span class="hl_varref"><span class="mpre">mbs</span></span></a><span class="mpre">
        </span><a name="loc_120_9_120_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_13&#39;)"><span class="hl_fundecl"><span class="mpre">cont</span></span></a><span class="mpre"> </span><a name="loc_120_14_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_14_120_22&#39;)"><span class="hl_vardecl"><span class="mpre">fbuilder</span></span></a><span class="mpre"> = do
            let </span><a name="loc_121_17_121_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_17_121_24&#39;)"><span class="hl_vardecl"><span class="mpre">builder</span></span></a><span class="mpre"> =
                    case </span><a href="#loc_120_14_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_14_120_22&#39;)"><span class="hl_varref"><span class="mpre">fbuilder</span></span></a><span class="mpre"> of
                        </span><a href="Data.Conduit.html#loc_358_26_358_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_26_358_31&#39;)"><span class="hl_conref"><span class="mpre">Flush</span></span></a><span class="mpre"> -&gt; </span><a href="Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Blaze.ByteString.Builder.Internal.html#loc_139_1_139_6&#39;)"><span class="hl_varref"><span class="mpre">flush</span></span></a><span class="mpre">
                        </span><a href="Data.Conduit.html#loc_358_16_358_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_16_358_21&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a name="loc_124_31_124_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_31_124_32&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_124_31_124_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_31_124_32&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
            </span><a name="loc_125_13_125_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_13_125_19&#39;)"><span class="hl_vardecl"><span class="mpre">popper</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_59_1_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_13&#39;)"><span class="hl_varref"><span class="mpre">unsafeLiftIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_115_6_115_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_6_115_10&#39;)"><span class="hl_varref"><span class="mpre">recv</span></span></a><span class="mpre"> </span><a href="#loc_121_17_121_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_17_121_24&#39;)"><span class="hl_varref"><span class="mpre">builder</span></span></a><span class="mpre">
            let </span><a name="loc_126_17_126_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_17_126_22&#39;)"><span class="hl_vardecl"><span class="mpre">cont&#39;</span></span></a><span class="mpre"> = do
                    </span><a name="loc_127_21_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_21_127_23&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_59_1_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_13&#39;)"><span class="hl_varref"><span class="mpre">unsafeLiftIO</span></span></a><span class="mpre"> </span><a href="#loc_125_13_125_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_13_125_19&#39;)"><span class="hl_varref"><span class="mpre">popper</span></span></a><span class="mpre">
                    </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_127_21_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_21_127_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
                        </span><a href="#loc_114_15_114_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_15_114_21&#39;)"><span class="hl_varref"><span class="mpre">yield&#39;</span></span></a><span class="mpre"> (</span><a href="Data.Conduit.html#loc_358_16_358_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_16_358_21&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> </span><a href="#loc_127_21_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_21_127_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">)
                        </span><a href="#loc_126_17_126_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_17_126_22&#39;)"><span class="hl_varref"><span class="mpre">cont&#39;</span></span></a><span class="mpre">
            </span><a href="#loc_126_17_126_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_17_126_22&#39;)"><span class="hl_varref"><span class="mpre">cont&#39;</span></span></a><span class="mpre">
            case </span><a href="#loc_120_14_120_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_14_120_22&#39;)"><span class="hl_varref"><span class="mpre">fbuilder</span></span></a><span class="mpre"> of
                </span><a href="Data.Conduit.html#loc_358_26_358_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_26_358_31&#39;)"><span class="hl_conref"><span class="mpre">Flush</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_114_15_114_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_15_114_21&#39;)"><span class="hl_varref"><span class="mpre">yield&#39;</span></span></a><span class="mpre"> </span><a href="Data.Conduit.html#loc_358_26_358_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_26_358_31&#39;)"><span class="hl_conref"><span class="mpre">Flush</span></span></a><span class="mpre">
                </span><a href="Data.Conduit.html#loc_358_16_358_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Conduit.html#loc_358_16_358_21&#39;)"><span class="hl_conref"><span class="mpre">Chunk</span></span></a><span class="mpre"> _ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
            </span><a href="#loc_116_9_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
    </span><a href="#loc_116_9_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_9_116_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
</span></div></body></html>