<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Number.Polynomial</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Good</span></span><span class="mpre">

module Crypto.Number.Polynomial
    ( Monomial(..)
    </span><span class="hl_comment"><span class="mpre">-- * polynomial operations</span></span><span class="mpre">
    , Polynomial
    , toList
    , fromList
    , addPoly
    , subPoly
    , mulPoly
    , squarePoly
    , expPoly
    , divPoly
    , negPoly
    ) where

import Data.List (</span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="mpre">intercalate</span></a><span class="mpre">, </span><a href="Data.List.html#loc_809_1_809_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_809_1_809_5&#39;)"><span class="mpre">sort</span></a><span class="mpre">)
import Data.Vector (</span><a href="Data.Vector.html#loc_366_1_366_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_366_1_366_4&#39;)"><span class="mpre">(!)</span></a><span class="mpre">, </span><a href="Data.Vector.html#loc_200_6_200_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_200_6_200_12&#39;)"><span class="mpre">Vector</span></a><span class="mpre">)
import qualified Data.Vector as V
import Control.Arrow (</span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="mpre">first</span></a><span class="mpre">)

data </span><a name="loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tycondecl"><span class="mpre">Monomial</span></span></a><span class="mpre"> = </span><a name="loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_condecl"><span class="mpre">Monomial</span></span></a><span class="mpre"> {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Polynomial.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 5, srcSpanEndLine = 30, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Polynomial.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 5, srcSpanEndLine = 30, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/N"><span class="mpre">deriving (Eq)</span></span><span class="mpre">

data </span><a name="loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tycondecl"><span class="mpre">Polynomial</span></span></a><span class="mpre"> = </span><a name="loc_32_19_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_29&#39;)"><span class="hl_condecl"><span class="mpre">Polynomial</span></span></a><span class="mpre"> (</span><a href="Data.Vector.html#loc_200_6_200_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_200_6_200_12&#39;)"><span class="hl_tyconref"><span class="mpre">Vector</span></span></a><span class="mpre"> </span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">Monomial</span></span></a><span class="mpre">)
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Polynomial.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 5, srcSpanEndLine = 33, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Polynomial.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 5, srcSpanEndLine = 33, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/N"><span class="mpre">deriving (Eq)</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Ord</span></span><span class="mpre"> </span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">Monomial</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">compare</span></span><span class="mpre"> (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><a name="loc_36_23_36_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_23_36_25&#39;)"><span class="hl_vardecl"><span class="mpre">w1</span></span></a><span class="mpre"> </span><a name="loc_36_26_36_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_26_36_28&#39;)"><span class="hl_vardecl"><span class="mpre">v1</span></span></a><span class="mpre">) (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><a name="loc_36_40_36_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_40_36_42&#39;)"><span class="hl_vardecl"><span class="mpre">w2</span></span></a><span class="mpre"> </span><a name="loc_36_43_36_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_43_36_45&#39;)"><span class="hl_vardecl"><span class="mpre">v2</span></span></a><span class="mpre">) =
        case </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_36_23_36_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_23_36_25&#39;)"><span class="hl_varref"><span class="mpre">w1</span></span></a><span class="mpre"> </span><a href="#loc_36_40_36_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_40_36_42&#39;)"><span class="hl_varref"><span class="mpre">w2</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_36_26_36_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_26_36_28&#39;)"><span class="hl_varref"><span class="mpre">v1</span></span></a><span class="mpre"> </span><a href="#loc_36_43_36_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_43_36_45&#39;)"><span class="hl_varref"><span class="mpre">v2</span></span></a><span class="mpre">
            </span><a name="loc_39_13_39_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_13_39_14&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">  -&gt; </span><a href="#loc_39_13_39_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_13_39_14&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">Monomial</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><a name="loc_42_20_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_20_42_21&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_42_22_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_22_42_23&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_42_22_42_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_22_42_23&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;x^&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_42_20_42_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_20_42_21&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_32_19_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_29&#39;)"><span class="hl_conref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> </span><a name="loc_45_22_45_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_22_45_23&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) = </span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="hl_varref"><span class="mpre">intercalate</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;+&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Vector.html#loc_1471_1_1471_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_1471_1_1471_7&#39;)"><span class="hl_varref"><span class="mpre">V.toList</span></span></a><span class="mpre"> </span><a href="#loc_45_22_45_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_22_45_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><a href="#loc_48_1_48_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_7&#39;)"><span class="mpre">toList</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">Monomial</span></span></a><span class="mpre">]
</span><a name="loc_48_1_48_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_7&#39;)"><span class="hl_fundecl"><span class="mpre">toList</span></span></a><span class="mpre"> (</span><a href="#loc_32_19_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_29&#39;)"><span class="hl_conref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> </span><a name="loc_48_20_48_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_20_48_21&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) = </span><a href="Data.Vector.html#loc_1471_1_1471_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_1471_1_1471_7&#39;)"><span class="hl_varref"><span class="mpre">V.toList</span></span></a><span class="mpre"> </span><a href="#loc_48_20_48_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_20_48_21&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><a href="#loc_51_1_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_9&#39;)"><span class="mpre">fromList</span></a><span class="mpre"> :: [</span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">Monomial</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre">
</span><a name="loc_51_1_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_9&#39;)"><span class="hl_vardecl"><span class="mpre">fromList</span></span></a><span class="mpre"> = </span><a href="#loc_32_19_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_29&#39;)"><span class="hl_conref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Vector.html#loc_1476_1_1476_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_1476_1_1476_9&#39;)"><span class="hl_varref"><span class="mpre">V.fromList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.List.html#loc_809_1_809_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_809_1_809_5&#39;)"><span class="hl_varref"><span class="mpre">sort</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_53_9_53_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_19&#39;)"><span class="hl_varref"><span class="mpre">filterZero</span></span></a><span class="mpre">
    where
        </span><a name="loc_53_9_53_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_19&#39;)"><span class="hl_vardecl"><span class="mpre">filterZero</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (\(</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> _ </span><a name="loc_53_43_53_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_43_53_44&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_53_43_53_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_43_53_44&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)

</span><a href="#loc_56_1_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_10&#39;)"><span class="mpre">getWeight</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_56_1_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_10&#39;)"><span class="hl_fundecl"><span class="mpre">getWeight</span></span></a><span class="mpre"> (</span><a href="#loc_32_19_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_29&#39;)"><span class="hl_conref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> </span><a name="loc_56_23_56_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_23_56_24&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) </span><a name="loc_56_26_56_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_26_56_27&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_59_9_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_13&#39;)"><span class="hl_varref"><span class="mpre">look</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    where
        </span><a name="loc_58_9_58_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_13&#39;)"><span class="hl_vardecl"><span class="mpre">plen</span></span></a><span class="mpre"> = </span><a href="Data.Vector.html#loc_353_1_353_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_353_1_353_7&#39;)"><span class="hl_varref"><span class="mpre">V.length</span></span></a><span class="mpre"> </span><a href="#loc_56_23_56_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_23_56_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
        </span><a name="loc_59_9_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_13&#39;)"><span class="hl_fundecl"><span class="mpre">look</span></span></a><span class="mpre"> !</span><a name="loc_59_15_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_15_59_16&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
            | </span><a href="#loc_59_15_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_15_59_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_58_9_58_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_13&#39;)"><span class="hl_varref"><span class="mpre">plen</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
                let (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><a name="loc_62_31_62_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_31_62_32&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_62_33_62_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_33_62_34&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = </span><a href="#loc_56_23_56_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_23_56_24&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="Data.Vector.html#loc_366_1_366_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_366_1_366_4&#39;)"><span class="hl_infix"><span class="mpre">!</span></span></a><span class="mpre"> </span><a href="#loc_59_15_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_15_59_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> in
                case </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_62_31_62_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_31_62_32&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="#loc_56_26_56_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_26_56_27&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> of
                    </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                    </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_62_33_62_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_33_62_34&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
                    </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; </span><a href="#loc_59_9_59_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_13&#39;)"><span class="hl_varref"><span class="mpre">look</span></span></a><span class="mpre"> (</span><a href="#loc_59_15_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_15_59_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        

</span><a href="#loc_70_1_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_10&#39;)"><span class="mpre">mergePoly</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">) -&gt; </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre">
</span><a name="loc_70_1_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_10&#39;)"><span class="hl_fundecl"><span class="mpre">mergePoly</span></span></a><span class="mpre"> </span><a name="loc_70_11_70_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_11_70_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_32_19_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_29&#39;)"><span class="hl_conref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> </span><a name="loc_70_25_70_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_25_70_27&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="mpre">) (</span><a href="#loc_32_19_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_29&#39;)"><span class="hl_conref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> </span><a name="loc_70_41_70_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_41_70_43&#39;)"><span class="hl_vardecl"><span class="mpre">p2</span></span></a><span class="mpre">) = </span><a href="#loc_51_1_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    where
        </span><a name="loc_72_9_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_11&#39;)"><span class="hl_vardecl"><span class="mpre">l1</span></span></a><span class="mpre"> = </span><a href="Data.Vector.html#loc_353_1_353_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_353_1_353_7&#39;)"><span class="hl_varref"><span class="mpre">V.length</span></span></a><span class="mpre"> </span><a href="#loc_70_25_70_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_25_70_27&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre">
        </span><a name="loc_73_9_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_11&#39;)"><span class="hl_vardecl"><span class="mpre">l2</span></span></a><span class="mpre"> = </span><a href="Data.Vector.html#loc_353_1_353_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_353_1_353_7&#39;)"><span class="hl_varref"><span class="mpre">V.length</span></span></a><span class="mpre"> </span><a href="#loc_70_41_70_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_41_70_43&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre">
        </span><a name="loc_74_9_74_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_74_15_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_17&#39;)"><span class="hl_vardecl"><span class="mpre">i1</span></span></a><span class="mpre"> !</span><a name="loc_74_19_74_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_19_74_21&#39;)"><span class="hl_vardecl"><span class="mpre">i2</span></span></a><span class="mpre">
            | </span><a href="#loc_74_15_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_17&#39;)"><span class="hl_varref"><span class="mpre">i1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_72_9_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_11&#39;)"><span class="hl_varref"><span class="mpre">l1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_74_19_74_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_19_74_21&#39;)"><span class="hl_varref"><span class="mpre">i2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_73_9_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_11&#39;)"><span class="hl_varref"><span class="mpre">l2</span></span></a><span class="mpre"> = []
            | </span><a href="#loc_74_15_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_17&#39;)"><span class="hl_varref"><span class="mpre">i1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_72_9_72_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_11&#39;)"><span class="hl_varref"><span class="mpre">l1</span></span></a><span class="mpre">             = (</span><a href="#loc_70_41_70_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_41_70_43&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre"> </span><a href="Data.Vector.html#loc_366_1_366_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_366_1_366_4&#39;)"><span class="hl_infix"><span class="mpre">!</span></span></a><span class="mpre"> </span><a href="#loc_74_19_74_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_19_74_21&#39;)"><span class="hl_varref"><span class="mpre">i2</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_74_15_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_17&#39;)"><span class="hl_varref"><span class="mpre">i1</span></span></a><span class="mpre"> (</span><a href="#loc_74_19_74_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_19_74_21&#39;)"><span class="hl_varref"><span class="mpre">i2</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
            | </span><a href="#loc_74_19_74_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_19_74_21&#39;)"><span class="hl_varref"><span class="mpre">i2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_73_9_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_9_73_11&#39;)"><span class="hl_varref"><span class="mpre">l2</span></span></a><span class="mpre">             = (</span><a href="#loc_70_25_70_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_25_70_27&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre"> </span><a href="Data.Vector.html#loc_366_1_366_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_366_1_366_4&#39;)"><span class="hl_infix"><span class="mpre">!</span></span></a><span class="mpre"> </span><a href="#loc_74_15_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_17&#39;)"><span class="hl_varref"><span class="mpre">i1</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_74_15_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_17&#39;)"><span class="hl_varref"><span class="mpre">i1</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_74_19_74_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_19_74_21&#39;)"><span class="hl_varref"><span class="mpre">i2</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">            =
                let (</span><a name="loc_79_22_79_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_22_79_26&#39;)"><span class="hl_vardecl"><span class="mpre">coef</span></span></a><span class="mpre">, </span><a name="loc_79_28_79_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_28_79_33&#39;)"><span class="hl_vardecl"><span class="mpre">i1inc</span></span></a><span class="mpre">, </span><a name="loc_79_35_79_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_35_79_40&#39;)"><span class="hl_vardecl"><span class="mpre">i2inc</span></span></a><span class="mpre">) = </span><a href="#loc_81_9_81_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_16&#39;)"><span class="hl_varref"><span class="mpre">addCoef</span></span></a><span class="mpre"> (</span><a href="#loc_70_25_70_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_25_70_27&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre"> </span><a href="Data.Vector.html#loc_366_1_366_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_366_1_366_4&#39;)"><span class="hl_infix"><span class="mpre">!</span></span></a><span class="mpre"> </span><a href="#loc_74_15_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_17&#39;)"><span class="hl_varref"><span class="mpre">i1</span></span></a><span class="mpre">) (</span><a href="#loc_70_41_70_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_41_70_43&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre"> </span><a href="Data.Vector.html#loc_366_1_366_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_366_1_366_4&#39;)"><span class="hl_infix"><span class="mpre">!</span></span></a><span class="mpre"> </span><a href="#loc_74_19_74_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_19_74_21&#39;)"><span class="hl_varref"><span class="mpre">i2</span></span></a><span class="mpre">) in
                </span><a href="#loc_79_22_79_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_22_79_26&#39;)"><span class="hl_varref"><span class="mpre">coef</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_74_15_74_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_17&#39;)"><span class="hl_varref"><span class="mpre">i1</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_79_28_79_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_28_79_33&#39;)"><span class="hl_varref"><span class="mpre">i1inc</span></span></a><span class="mpre">) (</span><a href="#loc_74_19_74_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_19_74_21&#39;)"><span class="hl_varref"><span class="mpre">i2</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_79_35_79_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_35_79_40&#39;)"><span class="hl_varref"><span class="mpre">i2inc</span></span></a><span class="mpre">)
        </span><a name="loc_81_9_81_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_9_81_16&#39;)"><span class="hl_fundecl"><span class="mpre">addCoef</span></span></a><span class="mpre"> </span><a name="loc_81_17_81_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_19&#39;)"><span class="hl_specname"><span class="mpre">m1</span></span></a><span class="mpre">@(</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><a name="loc_81_30_81_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_30_81_32&#39;)"><span class="hl_vardecl"><span class="mpre">w1</span></span></a><span class="mpre"> </span><a name="loc_81_33_81_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_33_81_35&#39;)"><span class="hl_vardecl"><span class="mpre">v1</span></span></a><span class="mpre">) (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><a name="loc_81_47_81_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_47_81_49&#39;)"><span class="hl_vardecl"><span class="mpre">w2</span></span></a><span class="mpre"> </span><a name="loc_81_50_81_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_50_81_52&#39;)"><span class="hl_vardecl"><span class="mpre">v2</span></span></a><span class="mpre">) =
            case </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_81_30_81_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_30_81_32&#39;)"><span class="hl_varref"><span class="mpre">w1</span></span></a><span class="mpre"> </span><a href="#loc_81_47_81_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_47_81_49&#39;)"><span class="hl_varref"><span class="mpre">w2</span></span></a><span class="mpre"> of
                </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><a href="#loc_81_47_81_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_47_81_49&#39;)"><span class="hl_varref"><span class="mpre">w2</span></span></a><span class="mpre"> (</span><a href="#loc_70_11_70_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_11_70_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_81_50_81_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_50_81_52&#39;)"><span class="hl_varref"><span class="mpre">v2</span></span></a><span class="mpre">), </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><a href="#loc_81_30_81_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_30_81_32&#39;)"><span class="hl_varref"><span class="mpre">w1</span></span></a><span class="mpre"> (</span><a href="#loc_70_11_70_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_11_70_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_81_33_81_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_33_81_35&#39;)"><span class="hl_varref"><span class="mpre">v1</span></span></a><span class="mpre"> </span><a href="#loc_81_50_81_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_50_81_52&#39;)"><span class="hl_varref"><span class="mpre">v2</span></span></a><span class="mpre">), </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
                </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; (</span><a href="#loc_81_17_81_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_19&#39;)"><span class="hl_varref"><span class="mpre">m1</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)

</span><a href="#loc_88_1_88_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_8&#39;)"><span class="mpre">addPoly</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre">
</span><a name="loc_88_1_88_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_8&#39;)"><span class="hl_vardecl"><span class="mpre">addPoly</span></span></a><span class="mpre"> = </span><a href="#loc_70_1_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_10&#39;)"><span class="hl_varref"><span class="mpre">mergePoly</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(+)</span></span><span class="mpre">

</span><a href="#loc_91_1_91_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_8&#39;)"><span class="mpre">subPoly</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre">
</span><a name="loc_91_1_91_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_8&#39;)"><span class="hl_vardecl"><span class="mpre">subPoly</span></span></a><span class="mpre"> = </span><a href="#loc_70_1_70_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_10&#39;)"><span class="hl_varref"><span class="mpre">mergePoly</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(-)</span></span><span class="mpre">

</span><a href="#loc_94_1_94_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_8&#39;)"><span class="mpre">negPoly</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre">
</span><a name="loc_94_1_94_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_8&#39;)"><span class="hl_fundecl"><span class="mpre">negPoly</span></span></a><span class="mpre"> (</span><a href="#loc_32_19_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_29&#39;)"><span class="hl_conref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> </span><a name="loc_94_21_94_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_21_94_22&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) = </span><a href="#loc_32_19_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_29&#39;)"><span class="hl_conref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Vector.html#loc_875_1_875_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_875_1_875_4&#39;)"><span class="hl_varref"><span class="mpre">V.map</span></span></a><span class="mpre"> </span><a href="#loc_95_11_95_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_11_95_25&#39;)"><span class="hl_varref"><span class="mpre">negateMonomial</span></span></a><span class="mpre"> </span><a href="#loc_94_21_94_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_21_94_22&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
    where </span><a name="loc_95_11_95_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_11_95_25&#39;)"><span class="hl_fundecl"><span class="mpre">negateMonomial</span></span></a><span class="mpre"> (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><a name="loc_95_36_95_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_36_95_37&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_95_38_95_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_38_95_39&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) = </span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><a href="#loc_95_36_95_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_36_95_37&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> (-</span><a href="#loc_95_38_95_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_38_95_39&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)

</span><a href="#loc_98_1_98_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_8&#39;)"><span class="mpre">mulPoly</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre">
</span><a name="loc_98_1_98_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_8&#39;)"><span class="hl_fundecl"><span class="mpre">mulPoly</span></span></a><span class="mpre"> </span><a name="loc_98_9_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_11&#39;)"><span class="hl_specname"><span class="mpre">p1</span></span></a><span class="mpre">@(</span><a href="#loc_32_19_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_29&#39;)"><span class="hl_conref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> </span><a name="loc_98_24_98_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_24_98_26&#39;)"><span class="hl_vardecl"><span class="mpre">v1</span></span></a><span class="mpre">) </span><a name="loc_98_28_98_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_28_98_30&#39;)"><span class="hl_specname"><span class="mpre">p2</span></span></a><span class="mpre">@(</span><a href="#loc_32_19_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_29&#39;)"><span class="hl_conref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> </span><a name="loc_98_43_98_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_43_98_45&#39;)"><span class="hl_vardecl"><span class="mpre">v2</span></span></a><span class="mpre">) =
    </span><a href="#loc_51_1_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (\(</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> _ </span><a name="loc_99_37_99_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_37_99_38&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_99_37_99_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_37_99_38&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\</span><a name="loc_99_59_99_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_59_99_60&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><a href="#loc_99_59_99_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_59_99_60&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="#loc_103_9_103_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_99_59_99_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_59_99_60&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Polynomial.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 92, srcSpanEndLine = 99, srcSpanEndColumn = 102}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Polynomial.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 92, srcSpanEndLine = 99, srcSpanEndColumn = 93},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Cry"><span class="mpre">[0..(m+n)]</span></span><span class="mpre">
    where
        (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">m</span></span><span class="mpre"> _) = </span><a href="#loc_98_24_98_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_24_98_26&#39;)"><span class="hl_varref"><span class="mpre">v1</span></span></a><span class="mpre"> </span><a href="Data.Vector.html#loc_366_1_366_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_366_1_366_4&#39;)"><span class="hl_infix"><span class="mpre">!</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
        (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">n</span></span><span class="mpre"> _) = </span><a href="#loc_98_43_98_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_43_98_45&#39;)"><span class="hl_varref"><span class="mpre">v2</span></span></a><span class="mpre"> </span><a href="Data.Vector.html#loc_366_1_366_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_366_1_366_4&#39;)"><span class="hl_infix"><span class="mpre">!</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
        </span><a name="loc_103_9_103_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_9_103_10&#39;)"><span class="hl_fundecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_103_11_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_11_103_12&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> (\</span><a name="loc_103_23_103_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_23_103_26&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_103_27_103_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_27_103_28&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_106_17_106_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_17_106_18&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_103_11_103_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_11_103_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_103_27_103_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_27_103_28&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_105_17_105_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_103_27_103_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_27_103_28&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_103_23_103_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_23_103_26&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Polynomial.hs&quot;, srcSpanStartLine = 103, srcSpanStartColumn = 61, srcSpanEndLine = 103, srcSpanEndColumn = 67}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/Crypto/Number/Polynomial.hs&quot;, srcSpanStartLine = 103, srcSpanStartColumn = 61, srcSpanEndLine = 103, srcSpanEndColumn = 62},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-numbers-0.2.3/"><span class="mpre">[0..r]</span></span><span class="mpre">
            where
                </span><a name="loc_105_17_105_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_18&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_56_1_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_10&#39;)"><span class="hl_varref"><span class="mpre">getWeight</span></span></a><span class="mpre"> </span><a href="#loc_98_9_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_9_98_11&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre">
                </span><a name="loc_106_17_106_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_17_106_18&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_56_1_56_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_10&#39;)"><span class="hl_varref"><span class="mpre">getWeight</span></span></a><span class="mpre"> </span><a href="#loc_98_28_98_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_28_98_30&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre">

</span><a href="#loc_109_1_109_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_11&#39;)"><span class="mpre">squarePoly</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre">
</span><a name="loc_109_1_109_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_11&#39;)"><span class="hl_fundecl"><span class="mpre">squarePoly</span></span></a><span class="mpre"> </span><a name="loc_109_12_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_12_109_13&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="#loc_109_12_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_12_109_13&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_98_1_98_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_8&#39;)"><span class="hl_infix"><span class="mpre">`mulPoly`</span></span></a><span class="mpre"> </span><a href="#loc_109_12_109_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_12_109_13&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">

</span><a href="#loc_112_1_112_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_8&#39;)"><span class="mpre">expPoly</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre">
</span><a name="loc_112_1_112_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_8&#39;)"><span class="hl_fundecl"><span class="mpre">expPoly</span></span></a><span class="mpre"> </span><a name="loc_112_9_112_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_112_11_112_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_11_112_12&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> = </span><a href="#loc_114_9_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_112_9_112_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_9_112_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_112_11_112_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_11_112_12&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
    where
        </span><a name="loc_114_9_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_114_14_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_14_114_15&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><a href="#loc_114_14_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_14_114_15&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
        </span><a href="#loc_114_9_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_115_14_115_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_14_115_15&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_114_9_114_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_9_114_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_109_1_109_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_1_109_11&#39;)"><span class="hl_varref"><span class="mpre">squarePoly</span></span></a><span class="mpre"> </span><a href="#loc_115_14_115_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_14_115_15&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) (</span><a href="#loc_115_16_115_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_16_115_17&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

</span><a href="#loc_118_1_118_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_8&#39;)"><span class="mpre">divPoly</span></a><span class="mpre"> :: </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre">, </span><a href="#loc_32_6_32_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_6_32_16&#39;)"><span class="hl_tyconref"><span class="mpre">Polynomial</span></span></a><span class="mpre">)
</span><a name="loc_118_1_118_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_8&#39;)"><span class="hl_fundecl"><span class="mpre">divPoly</span></span></a><span class="mpre"> </span><a name="loc_118_9_118_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_11&#39;)"><span class="hl_vardecl"><span class="mpre">p1</span></span></a><span class="mpre"> </span><a name="loc_118_12_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_12_118_14&#39;)"><span class="hl_specname"><span class="mpre">p2</span></span></a><span class="mpre">@(</span><a href="#loc_32_19_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_29&#39;)"><span class="hl_conref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> </span><a name="loc_118_27_118_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_27_118_30&#39;)"><span class="hl_vardecl"><span class="mpre">pp2</span></span></a><span class="mpre">) = </span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="mpre"> </span><a href="#loc_51_1_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_119_11_119_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_11_119_18&#39;)"><span class="hl_varref"><span class="mpre">divLoop</span></span></a><span class="mpre"> </span><a href="#loc_118_9_118_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_9_118_11&#39;)"><span class="hl_varref"><span class="mpre">p1</span></span></a><span class="mpre">
    where </span><a name="loc_119_11_119_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_11_119_18&#39;)"><span class="hl_fundecl"><span class="mpre">divLoop</span></span></a><span class="mpre"> </span><a name="loc_119_19_119_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_19_119_21&#39;)"><span class="hl_specname"><span class="mpre">d1</span></span></a><span class="mpre">@(</span><a href="#loc_32_19_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_29&#39;)"><span class="hl_conref"><span class="mpre">Polynomial</span></span></a><span class="mpre"> </span><a name="loc_119_34_119_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_34_119_37&#39;)"><span class="hl_vardecl"><span class="mpre">pp1</span></span></a><span class="mpre">)
            | </span><a href="Data.Vector.html#loc_358_1_358_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_358_1_358_5&#39;)"><span class="hl_varref"><span class="mpre">V.null</span></span></a><span class="mpre"> </span><a href="#loc_119_34_119_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_34_119_37&#39;)"><span class="hl_varref"><span class="mpre">pp1</span></span></a><span class="mpre"> = ([], </span><a href="#loc_119_19_119_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_19_119_21&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre">)
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  =
                let (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><a name="loc_122_31_122_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_31_122_33&#39;)"><span class="hl_vardecl"><span class="mpre">w1</span></span></a><span class="mpre"> </span><a name="loc_122_34_122_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_34_122_36&#39;)"><span class="hl_vardecl"><span class="mpre">v1</span></span></a><span class="mpre">) = </span><a href="#loc_119_34_119_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_34_119_37&#39;)"><span class="hl_varref"><span class="mpre">pp1</span></span></a><span class="mpre"> </span><a href="Data.Vector.html#loc_366_1_366_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_366_1_366_4&#39;)"><span class="hl_infix"><span class="mpre">!</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> in
                let (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><a name="loc_123_31_123_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_31_123_33&#39;)"><span class="hl_vardecl"><span class="mpre">w2</span></span></a><span class="mpre"> </span><a name="loc_123_34_123_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_34_123_36&#39;)"><span class="hl_vardecl"><span class="mpre">v2</span></span></a><span class="mpre">) = </span><a href="#loc_118_27_118_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_27_118_30&#39;)"><span class="hl_varref"><span class="mpre">pp2</span></span></a><span class="mpre"> </span><a href="Data.Vector.html#loc_366_1_366_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Vector.html#loc_366_1_366_4&#39;)"><span class="hl_infix"><span class="mpre">!</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> in
                let </span><a name="loc_124_21_124_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_21_124_22&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_122_31_122_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_31_122_33&#39;)"><span class="hl_varref"><span class="mpre">w1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_123_31_123_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_31_123_33&#39;)"><span class="hl_varref"><span class="mpre">w2</span></span></a><span class="mpre"> in
                let (</span><a name="loc_125_22_125_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_22_125_23&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_125_24_125_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_24_125_25&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_122_34_122_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_34_122_36&#39;)"><span class="hl_varref"><span class="mpre">v1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`divMod`</span></span><span class="mpre"> </span><a href="#loc_123_34_123_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_34_123_36&#39;)"><span class="hl_varref"><span class="mpre">v2</span></span></a><span class="mpre"> in
                if </span><a href="#loc_124_21_124_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_21_124_22&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_125_24_125_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_24_125_25&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                    then
                        let </span><a name="loc_128_29_128_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_29_128_33&#39;)"><span class="hl_vardecl"><span class="mpre">mono</span></span></a><span class="mpre"> = (</span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Monomial</span></span></a><span class="mpre"> </span><a href="#loc_124_21_124_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_21_124_22&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="#loc_125_22_125_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_22_125_23&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) in
                        let </span><a name="loc_129_29_129_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_29_129_35&#39;)"><span class="hl_vardecl"><span class="mpre">remain</span></span></a><span class="mpre"> = </span><a href="#loc_119_19_119_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_19_119_21&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre"> </span><a href="#loc_91_1_91_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_1_91_8&#39;)"><span class="hl_infix"><span class="mpre">`subPoly`</span></span></a><span class="mpre"> (</span><a href="#loc_118_12_118_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_12_118_14&#39;)"><span class="hl_varref"><span class="mpre">p2</span></span></a><span class="mpre"> </span><a href="#loc_98_1_98_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_1_98_8&#39;)"><span class="hl_infix"><span class="mpre">`mulPoly`</span></span></a><span class="mpre"> (</span><a href="#loc_51_1_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_9&#39;)"><span class="hl_varref"><span class="mpre">fromList</span></span></a><span class="mpre"> [</span><a href="#loc_128_29_128_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_29_128_33&#39;)"><span class="hl_varref"><span class="mpre">mono</span></span></a><span class="mpre">])) in
                        let (</span><a name="loc_130_30_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_30_130_31&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">, </span><a name="loc_130_33_130_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_33_130_41&#39;)"><span class="hl_vardecl"><span class="mpre">finalRem</span></span></a><span class="mpre">) = </span><a href="#loc_119_11_119_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_11_119_18&#39;)"><span class="hl_varref"><span class="mpre">divLoop</span></span></a><span class="mpre"> </span><a href="#loc_129_29_129_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_29_129_35&#39;)"><span class="hl_varref"><span class="mpre">remain</span></span></a><span class="mpre"> in
                        (</span><a href="#loc_128_29_128_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_29_128_33&#39;)"><span class="hl_varref"><span class="mpre">mono</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_130_30_130_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_30_130_31&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">, </span><a href="#loc_130_33_130_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_33_130_41&#39;)"><span class="hl_varref"><span class="mpre">finalRem</span></span></a><span class="mpre">)
                    else
                        ([], </span><a href="#loc_119_19_119_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_19_119_21&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre">)
</span></div></body></html>