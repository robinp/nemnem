<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS -fglasgow-exts #-}

module Polymatch () where


import Data.Typeable
import Data.Generics


</span><span class="hl_comment"><span class="mpre">-- Representation of kids</span></span><span class="mpre">
</span><a name="loc_11_1_11_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_1_11_5&#39;)"><span class="hl_fundecl"><span class="mpre">kids</span></span></a><span class="mpre"> </span><a name="loc_11_6_11_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_6_11_7&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> </span><a href="#loc_13_37_13_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_37_13_40&#39;)"><span class="hl_conref"><span class="mpre">Kid</span></span></a><span class="mpre"> </span><a href="#loc_11_6_11_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_6_11_7&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- get all kids</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 1, srcSpanEndLine = 12, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 1, srcSpanEndLine = 12, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 12, srcSpanStartColu"><span class="mpre">type Kids = [Kid]</span></span><span class="mpre">
data </span><span class="hl_tycondecl"><span class="mpre">Kid</span></span><span class="mpre">  = forall k. Typeable k =&gt; </span><a name="loc_13_37_13_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_37_13_40&#39;)"><span class="hl_condecl"><span class="mpre">Kid</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">k</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Build term from a list of kids and the constructor </span></span><span class="mpre">
</span><a href="#loc_18_1_18_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_12&#39;)"><span class="mpre">fromConstrL</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 16, srcSpanEndLine = 17, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 23, srcSpanEndLine = 17, srcSpanEndColumn = 25}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Kids</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_18_1_18_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_12&#39;)"><span class="hl_fundecl"><span class="mpre">fromConstrL</span></span></a><span class="mpre"> </span><a name="loc_18_13_18_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_13_18_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_31_1_31_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_6&#39;)"><span class="hl_varref"><span class="mpre">unIDL</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">gunfold</span></span><span class="mpre"> </span><a href="#loc_21_3_21_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_3_21_4&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_20_3_20_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_3_20_4&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
 where
  </span><a name="loc_20_3_20_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_3_20_4&#39;)"><span class="hl_fundecl"><span class="mpre">z</span></span></a><span class="mpre"> </span><a name="loc_20_5_20_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_5_20_6&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_30_14_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_17&#39;)"><span class="hl_conref"><span class="mpre">IDL</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_20_5_20_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_5_20_6&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_18_13_18_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_13_18_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
  </span><a name="loc_21_3_21_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_3_21_4&#39;)"><span class="hl_fundecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_30_14_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_17&#39;)"><span class="hl_conref"><span class="mpre">IDL</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> _) = </span><a href="#loc_30_14_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_17&#39;)"><span class="hl_conref"><span class="mpre">IDL</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
  </span><a href="#loc_21_3_21_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_3_21_4&#39;)"><span class="hl_fundecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_30_14_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_17&#39;)"><span class="hl_conref"><span class="mpre">IDL</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_22_16_22_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_16_22_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) (</span><a href="#loc_13_37_13_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_37_13_40&#39;)"><span class="hl_conref"><span class="mpre">Kid</span></span></a><span class="mpre"> </span><a name="loc_22_24_22_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_24_22_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_22_26_22_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_26_22_27&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">)) = </span><a href="#loc_30_14_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_17&#39;)"><span class="hl_conref"><span class="mpre">IDL</span></span></a><span class="mpre"> </span><a href="#loc_24_5_24_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_5_24_7&#39;)"><span class="hl_varref"><span class="mpre">f&#39;</span></span></a><span class="mpre"> </span><a href="#loc_22_26_22_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_26_22_27&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
   where
    </span><a name="loc_24_5_24_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_5_24_7&#39;)"><span class="hl_vardecl"><span class="mpre">f&#39;</span></span></a><span class="mpre"> = case </span><a href="Data.Typeable.html#loc_112_1_112_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Typeable.html#loc_112_1_112_5&#39;)"><span class="hl_varref"><span class="mpre">cast</span></span></a><span class="mpre"> </span><a href="#loc_22_24_22_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_24_22_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> of
          (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_25_17_25_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_17_25_19&#39;)"><span class="hl_vardecl"><span class="mpre">x&#39;</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_22_16_22_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_16_22_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_25_17_25_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_17_25_19&#39;)"><span class="hl_varref"><span class="mpre">x&#39;</span></span></a><span class="mpre">)
          _         -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Helper datatype</span></span><span class="mpre">
data </span><span class="hl_tycondecl"><span class="mpre">IDL</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> = </span><a name="loc_30_14_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_17&#39;)"><span class="hl_condecl"><span class="mpre">IDL</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">Kids</span></span><span class="mpre">
</span><a name="loc_31_1_31_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_1_31_6&#39;)"><span class="hl_fundecl"><span class="mpre">unIDL</span></span></a><span class="mpre"> (</span><a href="#loc_30_14_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_14_30_17&#39;)"><span class="hl_conref"><span class="mpre">IDL</span></span></a><span class="mpre"> </span><a name="loc_31_12_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_12_31_14&#39;)"><span class="hl_vardecl"><span class="mpre">mx</span></span></a><span class="mpre"> _) = </span><a href="#loc_31_12_31_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_12_31_14&#39;)"><span class="hl_varref"><span class="mpre">mx</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Two sample datatypes</span></span><span class="mpre">
data </span><span class="hl_tycondecl"><span class="mpre">A</span></span><span class="mpre"> = </span><a name="loc_35_10_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_10_35_11&#39;)"><span class="hl_condecl"><span class="mpre">A</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 19, srcSpanEndLine = 35, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 19, srcSpanEndLine = 35, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 35, srcSpanStartC"><span class="mpre">deriving (Read, Show, Eq, Data, Typeable)</span></span><span class="mpre">
data </span><span class="hl_tycondecl"><span class="mpre">B</span></span><span class="mpre"> = </span><a name="loc_36_10_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_10_36_11&#39;)"><span class="hl_condecl"><span class="mpre">B</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 19, srcSpanEndLine = 36, srcSpanEndColumn = 60}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 19, srcSpanEndLine = 36, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 36, srcSpanStartC"><span class="mpre">deriving (Read, Show, Eq, Data, Typeable)</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Mediate between two &quot;left-equal&quot; Either types</span></span><span class="mpre">
</span><a href="#loc_43_1_43_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_2&#39;)"><span class="mpre">f</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 6, srcSpanEndLine = 41, srcSpanEndColumn = 5}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 6, srcSpanEndLine = 40, srcSpanEndColumn = 7},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn"><span class="mpre">(Data a, Data b, Show a, Read b)
  =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">-&gt;</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">

</span><a name="loc_43_1_43_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_2&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_43_3_43_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_3_43_4&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_43_12_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">)    = </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_43_3_43_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_3_43_4&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_43_12_43_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- conversion really needed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- f g (Left  s) = Left s            -- unappreciated conversion</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- f g s         = s                 -- doesn&#39;t typecheck </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- f g s         = deep_rebuild s    -- too expensive</span></span><span class="mpre">
</span><a href="#loc_43_1_43_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_2&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">g</span></span><span class="mpre"> </span><a name="loc_47_5_47_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_6&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">            = </span><a href="#loc_51_1_51_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_5&#39;)"><span class="hl_varref"><span class="mpre">just</span></span></a><span class="mpre"> (</span><a href="#loc_61_1_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_16&#39;)"><span class="hl_varref"><span class="mpre">shallow_rebuild</span></span></a><span class="mpre"> </span><a href="#loc_47_5_47_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- perhaps this is Ok?</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Get rid of maybies</span></span><span class="mpre">
</span><a name="loc_51_1_51_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_5&#39;)"><span class="hl_vardecl"><span class="mpre">just</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;tried, but failed.&quot;</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Just mentioned for completeness&#39; sake</span></span><span class="mpre">
</span><a href="#loc_56_1_56_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_13&#39;)"><span class="mpre">deep_rebuild</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 17, srcSpanEndLine = 55, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 55, srcSpanStartColumn = 17, srcSpanEndLine = 55, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 55, srcSpanStartCo"><span class="mpre">(Show a, Read b) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_56_1_56_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_13&#39;)"><span class="hl_vardecl"><span class="mpre">deep_rebuild</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">read</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- For the record: it&#39;s possible.</span></span><span class="mpre">
</span><a href="#loc_61_1_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_16&#39;)"><span class="mpre">shallow_rebuild</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 60, srcSpanStartColumn = 20, srcSpanEndLine = 60, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 60, srcSpanStartColumn = 20, srcSpanEndLine = 60, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Polymatch.hs&quot;, srcSpanStartLine = 60, srcSpanStartCo"><span class="mpre">(Data a, Data b) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_61_1_61_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_16&#39;)"><span class="hl_fundecl"><span class="mpre">shallow_rebuild</span></span></a><span class="mpre"> </span><a name="loc_61_17_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_17_61_18&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = </span><a href="#loc_63_3_63_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_3_63_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> 
 where
  </span><a name="loc_63_3_63_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_3_63_4&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">      = </span><a href="#loc_18_1_18_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_12&#39;)"><span class="hl_varref"><span class="mpre">fromConstrL</span></span></a><span class="mpre"> (</span><a href="#loc_11_1_11_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_11_1_11_5&#39;)"><span class="hl_varref"><span class="mpre">kids</span></span></a><span class="mpre"> </span><a href="#loc_61_17_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_17_61_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_64_3_64_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_3_64_9&#39;)"><span class="hl_varref"><span class="mpre">constr</span></span></a><span class="mpre">
  </span><a name="loc_64_3_64_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_3_64_9&#39;)"><span class="hl_vardecl"><span class="mpre">constr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">indexConstr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">dataTypeOf</span></span><span class="mpre"> </span><a href="#loc_63_3_63_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_3_63_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">constrIndex</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_61_17_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_17_61_18&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">))


</span><span class="hl_comment"><span class="mpre">-- Test cases</span></span><span class="mpre">
</span><a name="loc_68_1_68_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_4&#39;)"><span class="hl_fundecl"><span class="mpre">a2b</span></span></a><span class="mpre"> (</span><a href="#loc_35_10_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_10_35_11&#39;)"><span class="hl_conref"><span class="mpre">A</span></span></a><span class="mpre"> </span><a name="loc_68_8_68_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_8_68_9&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><a href="#loc_36_10_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_10_36_11&#39;)"><span class="hl_conref"><span class="mpre">B</span></span></a><span class="mpre"> </span><a href="#loc_68_8_68_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_8_68_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">            </span><span class="hl_comment"><span class="mpre">-- silly conversion</span></span><span class="mpre">
</span><span class="hl_vardecl"><span class="mpre">t1</span></span><span class="mpre"> = </span><a href="#loc_43_1_43_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_2&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_68_1_68_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_4&#39;)"><span class="hl_varref"><span class="mpre">a2b</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;x&quot;</span></span><span class="mpre">)      </span><span class="hl_comment"><span class="mpre">-- prints Left &quot;x&quot;</span></span><span class="mpre">
</span><span class="hl_vardecl"><span class="mpre">t2</span></span><span class="mpre"> = </span><a href="#loc_43_1_43_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_2&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_68_1_68_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_4&#39;)"><span class="hl_varref"><span class="mpre">a2b</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a href="#loc_35_10_35_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_10_35_11&#39;)"><span class="hl_conref"><span class="mpre">A</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;y&quot;</span></span><span class="mpre">)) </span><span class="hl_comment"><span class="mpre">-- prints Right (B &quot;y&quot;)</span></span><span class="mpre">
</span></div></body></html>