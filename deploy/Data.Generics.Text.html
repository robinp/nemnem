<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP #-}
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Data.Generics.Text</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) The University of Glasgow, CWI 2001--2003</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the LICENSE file)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  generics@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  non-portable (uses Data.Generics.Basics)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- \&quot;Scrap your boilerplate\&quot; --- Generic programming in Haskell </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- See &lt;http://www.cs.uu.nl/wiki/GenericProgramming/SYB&gt;. The present module</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- provides generic operations for text serialisation of terms.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module Data.Generics.Text (

    </span><span class="hl_comment"><span class="mpre">-- * Generic show</span></span><span class="mpre">
    gshow, gshows,

    </span><span class="hl_comment"><span class="mpre">-- * Generic read</span></span><span class="mpre">
    gread

 ) where

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

#ifdef __HADDOCK__
import Prelude
#endif
import Control.Monad
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Text.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 8, srcSpanEndLine = 34, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Data&quot;"><span class="mpre">Data.Data</span></span><span class="mpre">
import Data.Generics.Aliases
import Text.ParserCombinators.ReadP

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Generic show: an alternative to \&quot;deriving Show\&quot;</span></span><span class="mpre">
</span><a href="#loc_43_1_43_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_6&#39;)"><span class="mpre">gshow</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Text.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 10, srcSpanEndLine = 42, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Text.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 17, srcSpanEndLine = 42, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_43_1_43_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_6&#39;)"><span class="hl_fundecl"><span class="mpre">gshow</span></span></a><span class="mpre"> </span><a name="loc_43_7_43_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_50_1_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_7&#39;)"><span class="hl_varref"><span class="mpre">gshows</span></span></a><span class="mpre"> </span><a href="#loc_43_7_43_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Generic shows</span></span><span class="mpre">
</span><a href="#loc_50_1_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_7&#39;)"><span class="mpre">gshows</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Text.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 11, srcSpanEndLine = 46, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Text.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 18, srcSpanEndLine = 46, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ShowS</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- This is a prefix-show using surrounding &quot;(&quot; and &quot;)&quot;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- where we recurse into subterms with gmapQ.</span></span><span class="mpre">
</span><a name="loc_50_1_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_7&#39;)"><span class="hl_vardecl"><span class="mpre">gshows</span></span></a><span class="mpre"> = ( \</span><a name="loc_50_13_50_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_13_50_14&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> -&gt;
                </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;(&#39;</span></span><span class="mpre">
              </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">showString</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showConstr</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_50_13_50_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_13_50_14&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
              </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> ((</span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_50_1_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_7&#39;)"><span class="hl_varref"><span class="mpre">gshows</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_50_13_50_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_13_50_14&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
              </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;)&#39;</span></span><span class="mpre">
         ) </span><a href="Data.Generics.Aliases.html#loc_177_1_177_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_177_1_177_5&#39;)"><span class="hl_infix"><span class="mpre">`extQ`</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">shows</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ShowS</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Generic read: an alternative to \&quot;deriving Read\&quot;</span></span><span class="mpre">
</span><a href="#loc_71_1_71_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_6&#39;)"><span class="mpre">gread</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Text.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 10, srcSpanEndLine = 59, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Text.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 17, srcSpanEndLine = 59, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ReadS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-

This is a read operation which insists on prefix notation.  (The
Haskell 98 read deals with infix operators subject to associativity
and precedence as well.) We use fromConstrM to &quot;parse&quot; the input. To be
precise, fromConstrM is used for all types except String. The
type-specific case for String uses basic String read.

-}</span></span><span class="mpre">

</span><a name="loc_71_1_71_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_6&#39;)"><span class="hl_vardecl"><span class="mpre">gread</span></span></a><span class="mpre"> = </span><a href="Text.ParserCombinators.ReadP.html#loc_396_1_396_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_396_1_396_11&#39;)"><span class="hl_varref"><span class="mpre">readP_to_S</span></span></a><span class="mpre"> </span><a href="#loc_77_3_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_3_77_9&#39;)"><span class="hl_varref"><span class="mpre">gread&#39;</span></span></a><span class="mpre">

 where

  </span><span class="hl_comment"><span class="mpre">-- Helper for recursive read</span></span><span class="mpre">
  </span><a href="#loc_77_3_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_3_77_9&#39;)"><span class="mpre">gread&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Text.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 13, srcSpanEndLine = 76, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/Data/Generics/Text.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 21, srcSpanEndLine = 76, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/src/"><span class="mpre">Data a&#39; =&gt;</span></span><span class="mpre"> </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;</span></span><span class="mpre">
  </span><a name="loc_77_3_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_3_77_9&#39;)"><span class="hl_vardecl"><span class="mpre">gread&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_92_5_92_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_5_92_17&#39;)"><span class="hl_varref"><span class="mpre">allButString</span></span></a><span class="mpre"> </span><a href="Data.Generics.Aliases.html#loc_212_1_212_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_212_1_212_5&#39;)"><span class="hl_infix"><span class="mpre">`extR`</span></span></a><span class="mpre"> </span><a href="#loc_83_5_83_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_15&#39;)"><span class="hl_varref"><span class="mpre">stringCase</span></span></a><span class="mpre">

   where

    </span><span class="hl_comment"><span class="mpre">-- A specific case for strings</span></span><span class="mpre">
    </span><a href="#loc_83_5_83_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_15&#39;)"><span class="mpre">stringCase</span></a><span class="mpre"> :: </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    </span><a name="loc_83_5_83_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_5_83_15&#39;)"><span class="hl_vardecl"><span class="mpre">stringCase</span></span></a><span class="mpre"> = </span><a href="Text.ParserCombinators.ReadP.html#loc_402_1_402_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_402_1_402_11&#39;)"><span class="hl_varref"><span class="mpre">readS_to_P</span></span></a><span class="mpre"> </span><a href="Text.Read.html#loc_60_1_60_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Read.html#loc_60_1_60_6&#39;)"><span class="hl_varref"><span class="mpre">reads</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- Determine result type</span></span><span class="mpre">
    </span><a name="loc_86_5_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_15&#39;)"><span class="hl_vardecl"><span class="mpre">myDataType</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">dataTypeOf</span></span><span class="mpre"> (</span><a href="#loc_89_7_89_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_13&#39;)"><span class="hl_varref"><span class="mpre">getArg</span></span></a><span class="mpre"> </span><a href="#loc_92_5_92_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_5_92_17&#39;)"><span class="hl_varref"><span class="mpre">allButString</span></span></a><span class="mpre">)
     where
      </span><a href="#loc_89_7_89_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_13&#39;)"><span class="mpre">getArg</span></a><span class="mpre"> :: </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a&#39;&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a&#39;&#39;</span></span><span class="mpre">
      </span><a name="loc_89_7_89_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_7_89_13&#39;)"><span class="hl_vardecl"><span class="mpre">getArg</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- The generic default for gread</span></span><span class="mpre">
    </span><a name="loc_92_5_92_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_5_92_17&#39;)"><span class="hl_vardecl"><span class="mpre">allButString</span></span></a><span class="mpre"> =
      do
                </span><span class="hl_comment"><span class="mpre">-- Drop &quot;  (  &quot;</span></span><span class="mpre">
         </span><a href="Text.ParserCombinators.ReadP.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_286_1_286_11&#39;)"><span class="hl_varref"><span class="mpre">skipSpaces</span></span></a><span class="mpre">                     </span><span class="hl_comment"><span class="mpre">-- Discard leading space</span></span><span class="mpre">
         _ &lt;- </span><a href="Text.ParserCombinators.ReadP.html#loc_242_1_242_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_242_1_242_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;(&#39;</span></span><span class="mpre">                  </span><span class="hl_comment"><span class="mpre">-- Parse &#39;(&#39;</span></span><span class="mpre">
         </span><a href="Text.ParserCombinators.ReadP.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_286_1_286_11&#39;)"><span class="hl_varref"><span class="mpre">skipSpaces</span></span></a><span class="mpre">                     </span><span class="hl_comment"><span class="mpre">-- Discard following space</span></span><span class="mpre">

                </span><span class="hl_comment"><span class="mpre">-- Do the real work</span></span><span class="mpre">
         </span><a name="loc_100_10_100_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_10_100_13&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_119_5_119_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_16&#39;)"><span class="hl_varref"><span class="mpre">parseConstr</span></span></a><span class="mpre">            </span><span class="hl_comment"><span class="mpre">-- Get a lexeme for the constructor</span></span><span class="mpre">
         </span><a name="loc_101_10_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_10_101_13&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_114_5_114_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_12&#39;)"><span class="hl_varref"><span class="mpre">str2con</span></span></a><span class="mpre"> </span><a href="#loc_100_10_100_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_10_100_13&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">            </span><span class="hl_comment"><span class="mpre">-- Convert it to a Constr (may fail)</span></span><span class="mpre">
         </span><a name="loc_102_10_102_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_10_102_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">    &lt;- </span><span class="hl_varref"><span class="mpre">fromConstrM</span></span><span class="mpre"> </span><a href="#loc_77_3_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_3_77_9&#39;)"><span class="hl_varref"><span class="mpre">gread&#39;</span></span></a><span class="mpre"> </span><a href="#loc_101_10_101_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_10_101_13&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- Read the children</span></span><span class="mpre">

                </span><span class="hl_comment"><span class="mpre">-- Drop &quot;  )  &quot;</span></span><span class="mpre">
         </span><a href="Text.ParserCombinators.ReadP.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_286_1_286_11&#39;)"><span class="hl_varref"><span class="mpre">skipSpaces</span></span></a><span class="mpre">                     </span><span class="hl_comment"><span class="mpre">-- Discard leading space</span></span><span class="mpre">
         _ &lt;- </span><a href="Text.ParserCombinators.ReadP.html#loc_242_1_242_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_242_1_242_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;)&#39;</span></span><span class="mpre">                  </span><span class="hl_comment"><span class="mpre">-- Parse &#39;)&#39;</span></span><span class="mpre">
         </span><a href="Text.ParserCombinators.ReadP.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_286_1_286_11&#39;)"><span class="hl_varref"><span class="mpre">skipSpaces</span></span></a><span class="mpre">                     </span><span class="hl_comment"><span class="mpre">-- Discard following space</span></span><span class="mpre">

         </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_102_10_102_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_10_102_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- Turn string into constructor driven by the requested result type,</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- failing in the monad if it isn&#39;t a constructor of this data type</span></span><span class="mpre">
    </span><a href="#loc_114_5_114_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_12&#39;)"><span class="mpre">str2con</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre">
    </span><a name="loc_114_5_114_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_12&#39;)"><span class="hl_vardecl"><span class="mpre">str2con</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_varref"><span class="mpre">mzero</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">
            </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">readConstr</span></span><span class="mpre"> </span><a href="#loc_86_5_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_15&#39;)"><span class="hl_varref"><span class="mpre">myDataType</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- Get a Constr&#39;s string at the front of an input string</span></span><span class="mpre">
    </span><a href="#loc_119_5_119_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_16&#39;)"><span class="mpre">parseConstr</span></a><span class="mpre"> :: </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    </span><a name="loc_119_5_119_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_5_119_16&#39;)"><span class="hl_vardecl"><span class="mpre">parseConstr</span></span></a><span class="mpre"> =
               </span><a href="Text.ParserCombinators.ReadP.html#loc_252_1_252_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_252_1_252_7&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;[]&quot;</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- Compound lexeme &quot;[]&quot;</span></span><span class="mpre">
          </span><a href="Text.ParserCombinators.ReadP.html#loc_204_6_204_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_204_6_204_9&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre">  </span><a href="Text.ParserCombinators.ReadP.html#loc_252_1_252_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_252_1_252_7&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;()&quot;</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- singleton &quot;()&quot;</span></span><span class="mpre">
          </span><a href="Text.ParserCombinators.ReadP.html#loc_204_6_204_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_204_6_204_9&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre">  </span><a href="#loc_127_5_127_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_5_127_12&#39;)"><span class="hl_varref"><span class="mpre">infixOp</span></span></a><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- Infix operator in parantheses</span></span><span class="mpre">
          </span><a href="Text.ParserCombinators.ReadP.html#loc_204_6_204_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_204_6_204_9&#39;)"><span class="hl_infix"><span class="mpre">&lt;++</span></span></a><span class="mpre">  </span><a href="Text.ParserCombinators.ReadP.html#loc_402_1_402_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_402_1_402_11&#39;)"><span class="hl_varref"><span class="mpre">readS_to_P</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">lex</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- Ordinary constructors and literals</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- Handle infix operators such as (:)</span></span><span class="mpre">
    </span><a href="#loc_127_5_127_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_5_127_12&#39;)"><span class="mpre">infixOp</span></a><span class="mpre"> :: </span><a href="Text.ParserCombinators.ReadP.html#loc_148_9_148_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_148_9_148_14&#39;)"><span class="hl_tyconref"><span class="mpre">ReadP</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
    </span><a name="loc_127_5_127_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_5_127_12&#39;)"><span class="hl_vardecl"><span class="mpre">infixOp</span></span></a><span class="mpre"> = do </span><a name="loc_127_18_127_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_18_127_20&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre">  &lt;- </span><a href="Text.ParserCombinators.ReadP.html#loc_242_1_242_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_242_1_242_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;(&#39;</span></span><span class="mpre">
                 </span><a name="loc_128_18_128_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_18_128_21&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> &lt;- </span><a href="Text.ParserCombinators.ReadP.html#loc_273_1_273_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_273_1_273_7&#39;)"><span class="hl_varref"><span class="mpre">munch1</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(==)</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;)&#39;</span></span><span class="mpre">)
                 </span><a name="loc_129_18_129_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_18_129_20&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre">  &lt;- </span><a href="Text.ParserCombinators.ReadP.html#loc_242_1_242_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.ParserCombinators.ReadP.html#loc_242_1_242_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;)&#39;</span></span><span class="mpre">
                 </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> [</span><a href="#loc_127_18_127_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_18_127_20&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_128_18_128_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_18_128_21&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_129_18_129_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_18_129_20&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre">]
</span></div></body></html>