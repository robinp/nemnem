<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE RecordWildCards   #-}
{-# LANGUAGE ViewPatterns      #-}
module Network.HTTP.Client.Headers
    ( parseStatusHeaders
    ) where

import           Control.Applicative            (</span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">, </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="mpre">(&lt;*&gt;)</span></a><span class="mpre">)
import           Control.Exception              (</span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="mpre">throwIO</span></a><span class="mpre">)
import           Control.Monad
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Headers.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 18, srcSpanEndLine = 11, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre">                as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Headers.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 18, srcSpanEndLine = 12, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre">          as S8
import qualified Data.CaseInsensitive           as CI
import           Network.HTTP.Client.Connection
import           Network.HTTP.Client.Types
import           Network.HTTP.Types
import Data.Word (Word8)

</span><a href="#loc_20_1_20_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_7&#39;)"><span class="mpre">charLF</span></a><span class="mpre">, </span><a href="#loc_21_1_21_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_7&#39;)"><span class="mpre">charCR</span></a><span class="mpre">, </span><a href="#loc_22_1_22_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_10&#39;)"><span class="mpre">charSpace</span></a><span class="mpre">, </span><a href="#loc_23_1_23_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_10&#39;)"><span class="mpre">charColon</span></a><span class="mpre">, </span><a href="#loc_24_1_24_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_1_24_11&#39;)"><span class="mpre">charPeriod</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
</span><a name="loc_20_1_20_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_7&#39;)"><span class="hl_vardecl"><span class="mpre">charLF</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">
</span><a name="loc_21_1_21_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_1_21_7&#39;)"><span class="hl_vardecl"><span class="mpre">charCR</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">13</span></span><span class="mpre">
</span><a name="loc_22_1_22_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_10&#39;)"><span class="hl_vardecl"><span class="mpre">charSpace</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">
</span><a name="loc_23_1_23_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_10&#39;)"><span class="hl_vardecl"><span class="mpre">charColon</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">58</span></span><span class="mpre">
</span><a name="loc_24_1_24_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_1_24_11&#39;)"><span class="hl_vardecl"><span class="mpre">charPeriod</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">46</span></span><span class="mpre">


</span><a href="#loc_28_1_28_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_19&#39;)"><span class="mpre">parseStatusHeaders</span></a><span class="mpre"> :: </span><a href="Network.HTTP.Client.Types.html#loc_63_6_63_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_63_6_63_16&#39;)"><span class="hl_tyconref"><span class="mpre">Connection</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_74_6_74_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_74_6_74_19&#39;)"><span class="hl_tyconref"><span class="mpre">StatusHeaders</span></span></a><span class="mpre">
</span><a name="loc_28_1_28_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_19&#39;)"><span class="hl_fundecl"><span class="mpre">parseStatusHeaders</span></span></a><span class="mpre"> </span><a name="loc_28_20_28_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_20_28_24&#39;)"><span class="hl_vardecl"><span class="mpre">conn</span></span></a><span class="mpre"> = do
    (</span><a name="loc_29_6_29_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_12&#39;)"><span class="hl_vardecl"><span class="mpre">status</span></span></a><span class="mpre">, </span><a name="loc_29_14_29_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_14_29_21&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_33_5_33_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_5_33_18&#39;)"><span class="hl_varref"><span class="mpre">getStatusLine</span></span></a><span class="mpre">
    </span><a name="loc_30_5_30_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_5_30_12&#39;)"><span class="hl_vardecl"><span class="mpre">headers</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_67_5_67_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_5_67_17&#39;)"><span class="hl_varref"><span class="mpre">parseHeaders</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_74_22_74_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_74_22_74_35&#39;)"><span class="hl_conref"><span class="mpre">StatusHeaders</span></span></a><span class="mpre"> </span><a href="#loc_29_6_29_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_12&#39;)"><span class="hl_varref"><span class="mpre">status</span></span></a><span class="mpre"> </span><a href="#loc_29_14_29_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_14_29_21&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre"> </span><a href="#loc_30_5_30_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_5_30_12&#39;)"><span class="hl_varref"><span class="mpre">headers</span></span></a><span class="mpre">
  where
    </span><a name="loc_33_5_33_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_5_33_18&#39;)"><span class="hl_vardecl"><span class="mpre">getStatusLine</span></span></a><span class="mpre"> = do
        </span><span class="hl_comment"><span class="mpre">-- Ensure that there is some data coming in. If not, we want to signal</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- this as a connection problem and not a protocol problem.</span></span><span class="mpre">
        </span><a name="loc_36_9_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Types.html#loc_64_7_64_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_64_7_64_21&#39;)"><span class="hl_varref"><span class="mpre">connectionRead</span></span></a><span class="mpre"> </span><a href="#loc_28_20_28_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_20_28_24&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_36_9_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_93_22_93_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_93_22_93_44&#39;)"><span class="hl_conref"><span class="mpre">NoResponseDataReceived</span></span></a><span class="mpre">

        </span><a name="loc_39_9_39_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_15&#39;)"><span class="hl_specname"><span class="mpre">status</span></span></a><span class="mpre">@(</span><a name="loc_39_17_39_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_17_39_21&#39;)"><span class="hl_vardecl"><span class="mpre">code</span></span></a><span class="mpre">, _) &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_39_1_39_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_39_1_39_23&#39;)"><span class="hl_varref"><span class="mpre">connectionReadLineWith</span></span></a><span class="mpre"> </span><a href="#loc_28_20_28_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_20_28_24&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre"> </span><a href="#loc_36_9_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_9_36_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_45_5_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_16&#39;)"><span class="hl_varref"><span class="mpre">parseStatus</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">
        if </span><a href="#loc_39_17_39_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_17_39_21&#39;)"><span class="hl_varref"><span class="mpre">code</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_177_1_177_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_177_1_177_10&#39;)"><span class="hl_varref"><span class="mpre">status100</span></span></a><span class="mpre">
            then </span><a href="Network.HTTP.Client.Connection.html#loc_34_1_34_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_34_1_34_28&#39;)"><span class="hl_varref"><span class="mpre">connectionDropTillBlankLine</span></span></a><span class="mpre"> </span><a href="#loc_28_20_28_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_20_28_24&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_33_5_33_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_5_33_18&#39;)"><span class="hl_varref"><span class="mpre">getStatusLine</span></span></a><span class="mpre">
            else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_39_9_39_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_15&#39;)"><span class="hl_varref"><span class="mpre">status</span></span></a><span class="mpre">

    </span><a href="#loc_45_5_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_16&#39;)"><span class="mpre">parseStatus</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Network.HTTP.Types.Status.html#loc_114_6_114_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_114_6_114_12&#39;)"><span class="hl_tyconref"><span class="mpre">Status</span></span></a><span class="mpre">, </span><a href="Network.HTTP.Types.Version.html#loc_13_6_13_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Version.html#loc_13_6_13_17&#39;)"><span class="hl_tyconref"><span class="mpre">HttpVersion</span></span></a><span class="mpre">)
    </span><a name="loc_45_5_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_16&#39;)"><span class="hl_fundecl"><span class="mpre">parseStatus</span></span></a><span class="mpre"> </span><a name="loc_45_17_45_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_17_45_18&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_45_19_45_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_19_45_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_45_19_45_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_19_45_21&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_45_17_45_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_17_45_18&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><a href="Network.HTTP.Client.Connection.html#loc_27_1_27_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_27_1_27_19&#39;)"><span class="hl_varref"><span class="mpre">connectionReadLine</span></span></a><span class="mpre"> </span><a href="#loc_28_20_28_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_20_28_24&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_45_5_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_16&#39;)"><span class="hl_varref"><span class="mpre">parseStatus</span></span></a><span class="mpre"> (</span><a href="#loc_45_17_45_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_17_45_18&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
    </span><a href="#loc_45_5_45_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_16&#39;)"><span class="hl_fundecl"><span class="mpre">parseStatus</span></span></a><span class="mpre"> _ </span><a name="loc_46_19_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_19_46_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = do
        let (</span><a name="loc_47_14_47_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_14_47_17&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre">, </span><a name="loc_47_19_47_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_22&#39;)"><span class="hl_vardecl"><span class="mpre">bs2</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.breakByte</span></span><span class="mpre"> </span><a href="#loc_22_1_22_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_10&#39;)"><span class="hl_varref"><span class="mpre">charSpace</span></span></a><span class="mpre"> </span><a href="#loc_46_19_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_19_46_21&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
            (</span><a name="loc_48_14_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_14_48_18&#39;)"><span class="hl_vardecl"><span class="mpre">code</span></span></a><span class="mpre">, </span><a name="loc_48_20_48_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_20_48_23&#39;)"><span class="hl_vardecl"><span class="mpre">bs3</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.breakByte</span></span><span class="mpre"> </span><a href="#loc_22_1_22_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_10&#39;)"><span class="hl_varref"><span class="mpre">charSpace</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.dropWhile</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_22_1_22_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_10&#39;)"><span class="hl_varref"><span class="mpre">charSpace</span></span></a><span class="mpre">) </span><a href="#loc_47_19_47_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_19_47_22&#39;)"><span class="hl_varref"><span class="mpre">bs2</span></span></a><span class="mpre">
            </span><a name="loc_49_13_49_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_13_49_16&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.dropWhile</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_22_1_22_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_10&#39;)"><span class="hl_varref"><span class="mpre">charSpace</span></span></a><span class="mpre">) </span><a href="#loc_48_20_48_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_20_48_23&#39;)"><span class="hl_varref"><span class="mpre">bs3</span></span></a><span class="mpre">
        case </span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_57_5_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_17&#39;)"><span class="hl_varref"><span class="mpre">parseVersion</span></span></a><span class="mpre"> </span><a href="#loc_47_14_47_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_14_47_17&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_62_5_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_12&#39;)"><span class="hl_varref"><span class="mpre">readInt</span></span></a><span class="mpre"> </span><a href="#loc_48_14_48_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_14_48_18&#39;)"><span class="hl_varref"><span class="mpre">code</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_51_19_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_23&#39;)"><span class="hl_vardecl"><span class="mpre">ver&#39;</span></span></a><span class="mpre">, </span><a name="loc_51_25_51_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_25_51_30&#39;)"><span class="hl_vardecl"><span class="mpre">code&#39;</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Status</span></span><span class="mpre"> </span><a href="#loc_51_25_51_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_25_51_30&#39;)"><span class="hl_varref"><span class="mpre">code&#39;</span></span></a><span class="mpre"> </span><a href="#loc_49_13_49_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_13_49_16&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">, </span><a href="#loc_51_19_51_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_19_51_23&#39;)"><span class="hl_varref"><span class="mpre">ver&#39;</span></span></a><span class="mpre">)
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_89_22_89_39" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_89_22_89_39&#39;)"><span class="hl_conref"><span class="mpre">InvalidStatusLine</span></span></a><span class="mpre"> </span><a href="#loc_46_19_46_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_19_46_21&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

    </span><a name="loc_54_5_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_18&#39;)"><span class="hl_fundecl"><span class="mpre">stripPrefixBS</span></span></a><span class="mpre"> </span><a name="loc_54_19_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_19_54_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_54_21_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_21_54_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">
        | </span><a href="#loc_54_19_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_19_54_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`S.isPrefixOf`</span></span><span class="mpre"> </span><a href="#loc_54_21_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_21_54_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_54_19_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_19_54_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_54_21_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_21_54_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    </span><a name="loc_57_5_57_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_5_57_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseVersion</span></span></a><span class="mpre"> </span><a name="loc_57_18_57_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_21&#39;)"><span class="hl_vardecl"><span class="mpre">bs0</span></span></a><span class="mpre"> = do
        </span><a name="loc_58_9_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_12&#39;)"><span class="hl_vardecl"><span class="mpre">bs1</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_54_5_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_18&#39;)"><span class="hl_varref"><span class="mpre">stripPrefixBS</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;HTTP/&quot;</span></span><span class="mpre"> </span><a href="#loc_57_18_57_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_18_57_21&#39;)"><span class="hl_varref"><span class="mpre">bs0</span></span></a><span class="mpre">
        let (</span><a name="loc_59_14_59_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_14_59_18&#39;)"><span class="hl_vardecl"><span class="mpre">num1</span></span></a><span class="mpre">, </span><span class="warning" data-warning="PatPViewPat (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Headers.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 20, srcSpanEndLine = 59, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/http-client-0.3.5/Network/HTTP/Client/Headers.hs&quot;, srcSpanStartLine = 59, srcSpanStartColumn = 29, srcSpanEndLine = 59, srcSpanEndColumn = 31}]}) (App (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nem"><span class="mpre">S.drop 1 -&gt; num2</span></span><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.breakByte</span></span><span class="mpre"> </span><a href="#loc_24_1_24_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_1_24_11&#39;)"><span class="hl_varref"><span class="mpre">charPeriod</span></span></a><span class="mpre"> </span><a href="#loc_58_9_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_12&#39;)"><span class="hl_varref"><span class="mpre">bs1</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">HttpVersion</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_62_5_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_12&#39;)"><span class="hl_varref"><span class="mpre">readInt</span></span></a><span class="mpre"> </span><a href="#loc_59_14_59_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_14_59_18&#39;)"><span class="hl_varref"><span class="mpre">num1</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_62_5_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_12&#39;)"><span class="hl_varref"><span class="mpre">readInt</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">num2</span></span><span class="mpre">

    </span><a name="loc_62_5_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_5_62_12&#39;)"><span class="hl_fundecl"><span class="mpre">readInt</span></span></a><span class="mpre"> </span><a name="loc_62_13_62_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_13_62_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
        case </span><span class="hl_varref"><span class="mpre">S8.readInt</span></span><span class="mpre"> </span><a href="#loc_62_13_62_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_13_62_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_64_19_64_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_19_64_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_64_19_64_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_19_64_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
            _ -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

    </span><a name="loc_67_5_67_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_5_67_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseHeaders</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre"> _ = </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_84_22_84_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_84_22_84_37&#39;)"><span class="hl_conref"><span class="mpre">OverlongHeaders</span></span></a><span class="mpre">
    </span><a href="#loc_67_5_67_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_5_67_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseHeaders</span></span></a><span class="mpre"> </span><a name="loc_68_18_68_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_18_68_23&#39;)"><span class="hl_vardecl"><span class="mpre">count</span></span></a><span class="mpre"> </span><a name="loc_68_24_68_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_24_68_29&#39;)"><span class="hl_vardecl"><span class="mpre">front</span></span></a><span class="mpre"> = do
        </span><a name="loc_69_9_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_13&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Client.Connection.html#loc_27_1_27_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Connection.html#loc_27_1_27_19&#39;)"><span class="hl_varref"><span class="mpre">connectionReadLine</span></span></a><span class="mpre"> </span><a href="#loc_28_20_28_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_20_28_24&#39;)"><span class="hl_varref"><span class="mpre">conn</span></span></a><span class="mpre">
        if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_69_9_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_13&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">
            then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_68_24_68_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_24_68_29&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> []
            else do
                </span><a name="loc_73_17_73_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_17_73_23&#39;)"><span class="hl_vardecl"><span class="mpre">header</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_77_5_77_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_16&#39;)"><span class="hl_varref"><span class="mpre">parseHeader</span></span></a><span class="mpre"> </span><a href="#loc_69_9_69_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_9_69_13&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">
                </span><a href="#loc_67_5_67_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_5_67_17&#39;)"><span class="hl_varref"><span class="mpre">parseHeaders</span></span></a><span class="mpre"> (</span><a href="#loc_68_18_68_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_18_68_23&#39;)"><span class="hl_varref"><span class="mpre">count</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_68_24_68_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_24_68_29&#39;)"><span class="hl_varref"><span class="mpre">front</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_73_17_73_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_17_73_23&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">)

    </span><a href="#loc_77_5_77_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_16&#39;)"><span class="mpre">parseHeader</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Header</span></span><span class="mpre">
    </span><a name="loc_77_5_77_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_16&#39;)"><span class="hl_fundecl"><span class="mpre">parseHeader</span></span></a><span class="mpre"> </span><a name="loc_77_17_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_17_77_19&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = do
        let (</span><a name="loc_78_14_78_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_14_78_17&#39;)"><span class="hl_vardecl"><span class="mpre">key</span></span></a><span class="mpre">, </span><a name="loc_78_19_78_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_19_78_22&#39;)"><span class="hl_vardecl"><span class="mpre">bs2</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">S.breakByte</span></span><span class="mpre"> </span><a href="#loc_23_1_23_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_10&#39;)"><span class="hl_varref"><span class="mpre">charColon</span></span></a><span class="mpre"> </span><a href="#loc_77_17_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_17_77_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_78_19_78_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_19_78_22&#39;)"><span class="hl_varref"><span class="mpre">bs2</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.Client.Types.html#loc_90_22_90_35" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Client.Types.html#loc_90_22_90_35&#39;)"><span class="hl_conref"><span class="mpre">InvalidHeader</span></span></a><span class="mpre"> </span><a href="#loc_77_17_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_17_77_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Data.CaseInsensitive.Internal.html#loc_94_1_94_3" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.CaseInsensitive.Internal.html#loc_94_1_94_3&#39;)"><span class="hl_varref"><span class="mpre">CI.mk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_varref"><span class="mpre">strip</span></span></a><span class="mpre"> </span><a href="#loc_78_14_78_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_14_78_17&#39;)"><span class="hl_varref"><span class="mpre">key</span></span></a><span class="mpre">, </span><a href="#loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_varref"><span class="mpre">strip</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_78_19_78_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_19_78_22&#39;)"><span class="hl_varref"><span class="mpre">bs2</span></span></a><span class="mpre">)

    </span><a name="loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_vardecl"><span class="mpre">strip</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.dropWhile</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_22_1_22_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_10&#39;)"><span class="hl_varref"><span class="mpre">charSpace</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.spanEnd</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_22_1_22_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_10&#39;)"><span class="hl_varref"><span class="mpre">charSpace</span></span></a><span class="mpre">)
</span></div></body></html>