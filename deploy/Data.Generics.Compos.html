<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">{-|
    Compos compatibility layer. This module serves as a drop-in
    replacement in some situations for some of the Compos operations.
    Only the single-type traversals are supported, on normal
    algebraic data types. Users should also import either &quot;Data.Generics.Uniplate.Data&quot;
    or &quot;Data.Generics.Uniplate.Direct&quot;.

    Compos is described in the paper: \&quot;A Pattern for Almost Compositional Functions\&quot;
    by Bjorn Bringert and Aarne Ranta.

    * &lt;http://doi.acm.org/10.1145/1159803.1159834&gt;

    * &lt;http://www.cs.chalmers.se/~bringert/publ/composOp/composOp.pdf&gt;
-}</span></span><span class="mpre">

module Data.Generics.Compos where

import Control.Monad
import Data.Monoid
import Data.Generics.Uniplate.Operations


</span><span class="hl_comment"><span class="mpre">-- | If you want to keep an existing type class</span></span><span class="mpre">
class </span><span class="warning" data-warning="ClassDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 7, srcSpanEndLine = 24, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 18, srcSpanEndLine = 24, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplat"><span class="mpre">Uniplate a =&gt;</span></span><span class="mpre"> </span><a name="loc_24_21_24_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_21_24_27&#39;)"><span class="hl_classdecl"><span class="mpre">Compos</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> where


</span><span class="hl_comment"><span class="mpre">-- | @composOp == &#39;descend&#39;@</span></span><span class="mpre">
</span><a href="#loc_29_1_29_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_9&#39;)"><span class="mpre">composOp</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 13, srcSpanEndLine = 28, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 24, srcSpanEndLine = 28, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unipla"><span class="mpre">Uniplate a =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_29_1_29_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_1_29_9&#39;)"><span class="hl_vardecl"><span class="mpre">composOp</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">descend</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @composOpM == &#39;descendM&#39;@</span></span><span class="mpre">
</span><a href="#loc_34_1_34_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_10&#39;)"><span class="mpre">composOpM</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 14, srcSpanEndLine = 33, srcSpanEndColumn = 38}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 14, srcSpanEndLine = 33, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcS"><span class="mpre">(Uniplate a, Monad m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_34_1_34_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_10&#39;)"><span class="hl_vardecl"><span class="mpre">composOpM</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">descendM</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @composOpM_ == &#39;composOpFold&#39; (return ()) (&gt;&gt;)@</span></span><span class="mpre">
</span><a href="#loc_39_1_39_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_11&#39;)"><span class="mpre">composOpM_</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 15, srcSpanEndLine = 38, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 15, srcSpanEndLine = 38, srcSpanEndColumn = 16},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcS"><span class="mpre">(Uniplate a, Monad m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_39_1_39_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_11&#39;)"><span class="hl_vardecl"><span class="mpre">composOpM_</span></span></a><span class="mpre"> = </span><a href="#loc_54_1_54_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_13&#39;)"><span class="hl_varref"><span class="mpre">composOpFold</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">(&gt;&gt;)</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @composOpMonoid = &#39;composOpFold&#39; mempty mappend@</span></span><span class="mpre">
</span><a href="#loc_44_1_44_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_15&#39;)"><span class="mpre">composOpMonoid</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 19, srcSpanEndLine = 43, srcSpanEndColumn = 44}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 19, srcSpanEndLine = 43, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcS"><span class="mpre">(Uniplate a, Monoid m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre">
</span><a name="loc_44_1_44_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_15&#39;)"><span class="hl_vardecl"><span class="mpre">composOpMonoid</span></span></a><span class="mpre"> = </span><a href="#loc_54_1_54_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_13&#39;)"><span class="hl_varref"><span class="mpre">composOpFold</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_varref"><span class="mpre">mappend</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @composOpMPlus = &#39;composOpFold&#39; mzero mplus@</span></span><span class="mpre">
</span><a href="#loc_49_1_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_14&#39;)"><span class="mpre">composOpMPlus</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcSpanStartLine = 48, srcSpanStartColumn = 18, srcSpanEndLine = 48, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcSpanStartLine = 48, srcSpanStartColumn = 18, srcSpanEndLine = 48, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcS"><span class="mpre">(Uniplate a, MonadPlus m) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_49_1_49_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_14&#39;)"><span class="hl_vardecl"><span class="mpre">composOpMPlus</span></span></a><span class="mpre"> = </span><a href="#loc_54_1_54_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_13&#39;)"><span class="hl_varref"><span class="mpre">composOpFold</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_128_4_128_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_128_4_128_9&#39;)"><span class="hl_varref"><span class="mpre">mzero</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_130_4_130_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_130_4_130_9&#39;)"><span class="hl_varref"><span class="mpre">mplus</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Probably replace with &#39;universe&#39;, perhaps &#39;para&#39;</span></span><span class="mpre">
</span><a href="#loc_54_1_54_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_13&#39;)"><span class="mpre">composOpFold</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 17, srcSpanEndLine = 53, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/uniplate-1.6.12/Data/Generics/Compos.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 28, srcSpanEndLine = 53, srcSpanEndColumn = 30}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/unipla"><span class="mpre">Uniplate a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_54_1_54_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_13&#39;)"><span class="hl_fundecl"><span class="mpre">composOpFold</span></span></a><span class="mpre"> </span><a name="loc_54_14_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_14_54_18&#39;)"><span class="hl_vardecl"><span class="mpre">zero</span></span></a><span class="mpre"> </span><a name="loc_54_19_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_19_54_26&#39;)"><span class="hl_vardecl"><span class="mpre">combine</span></span></a><span class="mpre"> </span><a name="loc_54_27_54_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_27_54_28&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="#loc_54_19_54_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_19_54_26&#39;)"><span class="hl_varref"><span class="mpre">combine</span></span></a><span class="mpre"> </span><a href="#loc_54_14_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_14_54_18&#39;)"><span class="hl_varref"><span class="mpre">zero</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_54_27_54_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_27_54_28&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">children</span></span><span class="mpre">
</span></div></body></html>