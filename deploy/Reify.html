<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS -fglasgow-exts #-}

module Reify (tests) where

</span><span class="hl_comment"><span class="mpre">{-

The following examples illustrate the reification facilities for type
structure. Most notably, we generate shallow terms using the depth of
types and constructors as means to steer the generation.

-}</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 8, srcSpanEndLine = 13, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">

import Data.Maybe
import Data.Generics
import Control.Monad.State
import CompanyDatatypes



</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--        Encoding types as values; some other way.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- 

This group provides a style of encoding types as values and using
them. This style is seen as an alternative to the pragmatic style used
in Data.Typeable.typeOf and elsewhere, i.e., simply use an &quot;undefined&quot;
to denote a type argument. This pragmatic style suffers from lack
of robustness: one feels tempted to pattern match on undefineds.
Maybe Data.Typeable.typeOf etc. should be rewritten accordingly.

-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Type as values to stipulate use of undefineds</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 1, srcSpanEndLine = 41, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 1, srcSpanEndLine = 41, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 16, src"><span class="mpre">type TypeVal a = a -&gt; ()</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The value that denotes a type</span></span><span class="mpre">
</span><a href="#loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="mpre">typeVal</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="hl_vardecl"><span class="mpre">typeVal</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Test for type equivalence</span></span><span class="mpre">
</span><a href="#loc_51_1_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_9&#39;)"><span class="mpre">sameType</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 13, srcSpanEndLine = 50, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 13, srcSpanEndLine = 50, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 24, s"><span class="mpre">(Typeable a, Typeable b) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_51_1_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_9&#39;)"><span class="hl_fundecl"><span class="mpre">sameType</span></span></a><span class="mpre"> </span><a name="loc_51_10_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_10_51_13&#39;)"><span class="hl_vardecl"><span class="mpre">tva</span></span></a><span class="mpre"> </span><a name="loc_51_14_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_14_51_17&#39;)"><span class="hl_vardecl"><span class="mpre">tvb</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">typeOf</span></span><span class="mpre"> (</span><a href="#loc_62_1_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_9&#39;)"><span class="hl_varref"><span class="mpre">type2val</span></span></a><span class="mpre"> </span><a href="#loc_51_10_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_10_51_13&#39;)"><span class="hl_varref"><span class="mpre">tva</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre">
                   </span><span class="hl_varref"><span class="mpre">typeOf</span></span><span class="mpre"> (</span><a href="#loc_62_1_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_9&#39;)"><span class="hl_varref"><span class="mpre">type2val</span></span></a><span class="mpre"> </span><a href="#loc_51_14_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_14_51_17&#39;)"><span class="hl_varref"><span class="mpre">tvb</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Map a value to its type</span></span><span class="mpre">
</span><a href="#loc_57_1_57_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_9&#39;)"><span class="mpre">val2type</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_57_1_57_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_9&#39;)"><span class="hl_fundecl"><span class="mpre">val2type</span></span></a><span class="mpre"> _ = </span><a href="#loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="hl_varref"><span class="mpre">typeVal</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Stipulate this idiom!</span></span><span class="mpre">
</span><a href="#loc_62_1_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_9&#39;)"><span class="mpre">type2val</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_62_1_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_9&#39;)"><span class="hl_fundecl"><span class="mpre">type2val</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Constrain a type</span></span><span class="mpre">
</span><a href="#loc_67_1_67_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_9&#39;)"><span class="mpre">withType</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_67_1_67_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_9&#39;)"><span class="hl_fundecl"><span class="mpre">withType</span></span></a><span class="mpre"> </span><a name="loc_67_10_67_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_10_67_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> _ = </span><a href="#loc_67_10_67_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_10_67_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The argument type of a function</span></span><span class="mpre">
</span><a href="#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_8&#39;)"><span class="mpre">argType</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_72_1_72_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_8&#39;)"><span class="hl_fundecl"><span class="mpre">argType</span></span></a><span class="mpre"> _ = </span><a href="#loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="hl_varref"><span class="mpre">typeVal</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The result type of a function</span></span><span class="mpre">
</span><a href="#loc_77_1_77_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_8&#39;)"><span class="mpre">resType</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_77_1_77_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_8&#39;)"><span class="hl_fundecl"><span class="mpre">resType</span></span></a><span class="mpre"> _ = </span><a href="#loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="hl_varref"><span class="mpre">typeVal</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The parameter type of type constructor</span></span><span class="mpre">
</span><a href="#loc_82_1_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_9&#39;)"><span class="mpre">paraType</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">t</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_82_1_82_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_9&#39;)"><span class="hl_fundecl"><span class="mpre">paraType</span></span></a><span class="mpre"> _ = </span><a href="#loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="hl_varref"><span class="mpre">typeVal</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Type functions,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- i.e., functions mapping types to values</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 1, srcSpanEndLine = 88, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 1, srcSpanEndLine = 88, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 18, src"><span class="mpre">type TypeFun a r = TypeVal a -&gt; r</span></span><span class="mpre">



</span><span class="hl_comment"><span class="mpre">-- Generic type functions,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- i.e., functions mapping types to values</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 95, srcSpanStartColumn = 1, srcSpanEndLine = 95, srcSpanEndColumn = 51}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 95, srcSpanStartColumn = 1, srcSpanEndLine = 95, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 95, srcSpanStartColumn = 18, src"><span class="mpre">type GTypeFun r  = forall a. Data a =&gt; TypeFun a r</span></span><span class="mpre">



</span><span class="hl_comment"><span class="mpre">-- | Extend a type function</span></span><span class="mpre">
</span><a href="#loc_101_1_101_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_8&#39;)"><span class="mpre">extType</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 100, srcSpanStartColumn = 12, srcSpanEndLine = 100, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 100, srcSpanStartColumn = 12, srcSpanEndLine = 100, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 100, srcSpanStartColumn = "><span class="mpre">(Data a, Typeable r) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">TypeFun</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_101_1_101_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_8&#39;)"><span class="hl_fundecl"><span class="mpre">extType</span></span></a><span class="mpre"> </span><a name="loc_101_9_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_101_11_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_11_101_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><a href="#loc_101_9_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cast</span></span><span class="mpre"> </span><a href="#loc_101_11_101_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_11_101_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)



</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--        Mapping operators to map over type structure</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Query all constructors of a given type</span></span><span class="mpre">

</span><a href="#loc_118_1_118_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_9&#39;)"><span class="mpre">gmapType</span></a><span class="mpre"> :: ([(</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
         -&gt; </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre">)
         -&gt; </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">

</span><a name="loc_118_1_118_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_9&#39;)"><span class="hl_fundecl"><span class="mpre">gmapType</span></span></a><span class="mpre"> (</span><a name="loc_118_11_118_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_11_118_12&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre">::[(</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) </span><a name="loc_118_34_118_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_34_118_35&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a name="loc_118_37_118_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_37_118_38&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
 = 
   </span><a href="#loc_118_11_118_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_11_118_12&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">zip</span></span><span class="mpre"> </span><a href="#loc_126_3_126_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_3_126_7&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre"> </span><a href="#loc_132_3_132_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_3_132_8&#39;)"><span class="hl_varref"><span class="mpre">query</span></span></a><span class="mpre">

 where

  </span><span class="hl_comment"><span class="mpre">-- All constructors of the given type</span></span><span class="mpre">
  </span><a href="#loc_126_3_126_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_3_126_7&#39;)"><span class="mpre">cons</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre">]
  </span><a name="loc_126_3_126_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_3_126_7&#39;)"><span class="hl_vardecl"><span class="mpre">cons</span></span></a><span class="mpre">  = if </span><span class="hl_varref"><span class="mpre">isAlgType</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dataTypeOf</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_62_1_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_9&#39;)"><span class="hl_varref"><span class="mpre">type2val</span></span></a><span class="mpre"> </span><a href="#loc_118_37_118_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_37_118_38&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
           then </span><span class="hl_varref"><span class="mpre">dataTypeConstrs</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dataTypeOf</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_62_1_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_9&#39;)"><span class="hl_varref"><span class="mpre">type2val</span></span></a><span class="mpre"> </span><a href="#loc_118_37_118_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_37_118_38&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
           else []

  </span><span class="hl_comment"><span class="mpre">-- Query constructors</span></span><span class="mpre">
  </span><a href="#loc_132_3_132_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_3_132_8&#39;)"><span class="mpre">query</span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre">]
  </span><a name="loc_132_3_132_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_3_132_8&#39;)"><span class="hl_vardecl"><span class="mpre">query</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_118_34_118_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_34_118_35&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_118_37_118_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_37_118_38&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><a href="#loc_126_3_126_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_3_126_7&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Query all subterm types of a given constructor</span></span><span class="mpre">

</span><a href="#loc_141_1_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_11&#39;)"><span class="mpre">gmapConstr</span></a><span class="mpre"> :: ([</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre">)
           -&gt; </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
           -&gt; </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre">)

</span><a name="loc_141_1_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_11&#39;)"><span class="hl_fundecl"><span class="mpre">gmapConstr</span></span></a><span class="mpre"> (</span><a name="loc_141_13_141_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_13_141_14&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre">::[</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">r&#39;</span></span><span class="mpre">) </span><a name="loc_141_27_141_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_27_141_28&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><a name="loc_141_44_141_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_44_141_45&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">
 = 
   </span><a href="#loc_141_13_141_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_13_141_14&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_153_3_153_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_8&#39;)"><span class="hl_varref"><span class="mpre">query</span></span></a><span class="mpre">

 where

  </span><span class="hl_comment"><span class="mpre">-- Term for the given constructor</span></span><span class="mpre">
  </span><a href="#loc_149_3_149_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_3_149_7&#39;)"><span class="mpre">term</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
  </span><a name="loc_149_3_149_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_3_149_7&#39;)"><span class="hl_vardecl"><span class="mpre">term</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromConstr</span></span><span class="mpre"> </span><a href="#loc_141_44_141_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_44_141_45&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Query subterm types</span></span><span class="mpre">
  </span><a href="#loc_153_3_153_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_8&#39;)"><span class="mpre">query</span></a><span class="mpre"> ::  [</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">]
  </span><a name="loc_153_3_153_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_3_153_8&#39;)"><span class="hl_vardecl"><span class="mpre">query</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> (</span><a href="#loc_141_27_141_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_27_141_28&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_57_1_57_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_9&#39;)"><span class="hl_varref"><span class="mpre">val2type</span></span></a><span class="mpre">) </span><a href="#loc_149_3_149_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_3_149_7&#39;)"><span class="hl_varref"><span class="mpre">term</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Compute arity of a given constructor</span></span><span class="mpre">
</span><a href="#loc_158_1_158_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_12&#39;)"><span class="mpre">constrArity</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_158_1_158_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_12&#39;)"><span class="hl_fundecl"><span class="mpre">constrArity</span></span></a><span class="mpre"> </span><a name="loc_158_13_158_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_13_158_14&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_158_15_158_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_15_158_16&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="Data.Generics.Schemes.html#loc_150_1_150_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Schemes.html#loc_150_1_150_8&#39;)"><span class="hl_varref"><span class="mpre">glength</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_67_1_67_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_9&#39;)"><span class="hl_varref"><span class="mpre">withType</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromConstr</span></span><span class="mpre"> </span><a href="#loc_158_15_158_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_15_158_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_158_13_158_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_13_158_14&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Query all immediate subterm types of a given type</span></span><span class="mpre">
</span><a href="#loc_164_1_164_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_17&#39;)"><span class="mpre">gmapSubtermTypes</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 21, srcSpanEndLine = 163, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = 21, srcSpanEndLine = 162, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 162, srcSpanStartColumn = "><span class="mpre">(Data a, Typeable r) 
         =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_164_1_164_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_17&#39;)"><span class="hl_fundecl"><span class="mpre">gmapSubtermTypes</span></span></a><span class="mpre"> </span><a name="loc_164_18_164_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_18_164_19&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> (</span><a name="loc_164_21_164_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_21_164_22&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">::</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) </span><a name="loc_164_27_164_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_27_164_28&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a name="loc_164_30_164_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_30_164_31&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
  =
    </span><a href="#loc_191_3_191_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_3_191_9&#39;)"><span class="hl_varref"><span class="mpre">reduce</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> (</span><a href="#loc_183_3_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_3_183_8&#39;)"><span class="hl_varref"><span class="mpre">query</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_57_1_57_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_9&#39;)"><span class="hl_varref"><span class="mpre">val2type</span></span></a><span class="mpre">)) </span><a href="#loc_179_3_179_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_8&#39;)"><span class="hl_varref"><span class="mpre">terms</span></span></a><span class="mpre">))
           (</span><a href="#loc_196_23_196_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_23_196_32&#39;)"><span class="hl_conref"><span class="mpre">GTypeFun&#39;</span></span></a><span class="mpre"> </span><a href="#loc_164_27_164_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_27_164_28&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)

 where

  </span><span class="hl_comment"><span class="mpre">-- All constructors of the given type</span></span><span class="mpre">
  </span><a href="#loc_173_3_173_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_3_173_7&#39;)"><span class="mpre">cons</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre">]
  </span><a name="loc_173_3_173_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_3_173_7&#39;)"><span class="hl_vardecl"><span class="mpre">cons</span></span></a><span class="mpre">  = if </span><span class="hl_varref"><span class="mpre">isAlgType</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dataTypeOf</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_62_1_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_9&#39;)"><span class="hl_varref"><span class="mpre">type2val</span></span></a><span class="mpre"> </span><a href="#loc_164_30_164_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_30_164_31&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
           then </span><span class="hl_varref"><span class="mpre">dataTypeConstrs</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dataTypeOf</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_62_1_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_9&#39;)"><span class="hl_varref"><span class="mpre">type2val</span></span></a><span class="mpre"> </span><a href="#loc_164_30_164_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_30_164_31&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
           else []

  </span><span class="hl_comment"><span class="mpre">-- Terms for all constructors</span></span><span class="mpre">
  </span><a href="#loc_179_3_179_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_8&#39;)"><span class="mpre">terms</span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
  </span><a name="loc_179_3_179_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_3_179_8&#39;)"><span class="hl_vardecl"><span class="mpre">terms</span></span></a><span class="mpre"> =  </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromConstr</span></span><span class="mpre"> </span><a href="#loc_173_3_173_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_3_173_7&#39;)"><span class="hl_varref"><span class="mpre">cons</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Query a subterm type</span></span><span class="mpre">
  </span><a href="#loc_183_3_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_3_183_8&#39;)"><span class="mpre">query</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 182, srcSpanStartColumn = 12, srcSpanEndLine = 182, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 182, srcSpanStartColumn = 19, srcSpanEndLine = 182, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSp"><span class="mpre">Data b =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="#loc_196_9_196_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_9_196_18&#39;)"><span class="hl_tyconref"><span class="mpre">GTypeFun&#39;</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">,</span><a href="#loc_196_9_196_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_9_196_18&#39;)"><span class="hl_tyconref"><span class="mpre">GTypeFun&#39;</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
  </span><a name="loc_183_3_183_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_3_183_8&#39;)"><span class="hl_fundecl"><span class="mpre">query</span></span></a><span class="mpre"> </span><a name="loc_183_9_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_9_183_10&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_183_11_183_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_11_183_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = (</span><a href="#loc_197_1_197_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_12&#39;)"><span class="hl_varref"><span class="mpre">unGTypeFun&#39;</span></span></a><span class="mpre"> </span><a href="#loc_183_11_183_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_11_183_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_183_9_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_9_183_10&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">, </span><a href="#loc_196_23_196_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_23_196_32&#39;)"><span class="hl_conref"><span class="mpre">GTypeFun&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_187_3_187_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_3_187_10&#39;)"><span class="hl_varref"><span class="mpre">disable</span></span></a><span class="mpre"> </span><a href="#loc_183_9_183_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_9_183_10&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> (</span><a href="#loc_197_1_197_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_12&#39;)"><span class="hl_varref"><span class="mpre">unGTypeFun&#39;</span></span></a><span class="mpre"> </span><a href="#loc_183_11_183_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_11_183_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)))

  </span><span class="hl_comment"><span class="mpre">-- Constant out given type</span></span><span class="mpre">
  </span><a href="#loc_187_3_187_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_3_187_10&#39;)"><span class="mpre">disable</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 186, srcSpanStartColumn = 14, srcSpanEndLine = 186, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 186, srcSpanStartColumn = 21, srcSpanEndLine = 186, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSp"><span class="mpre">Data b =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
  </span><a name="loc_187_3_187_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_3_187_10&#39;)"><span class="hl_fundecl"><span class="mpre">disable</span></span></a><span class="mpre"> (</span><span class="hl_vardecl"><span class="mpre">t</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) </span><a name="loc_187_26_187_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_26_187_27&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_187_26_187_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_26_187_27&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_101_1_101_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_8&#39;)"><span class="hl_infix"><span class="mpre">`extType`</span></span></a><span class="mpre"> \(_::</span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="#loc_164_21_164_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_21_164_22&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Reduce all subterm types</span></span><span class="mpre">
  </span><a href="#loc_191_3_191_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_3_191_9&#39;)"><span class="mpre">reduce</span></a><span class="mpre"> :: [</span><a href="#loc_196_9_196_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_9_196_18&#39;)"><span class="hl_tyconref"><span class="mpre">GTypeFun&#39;</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">,</span><a href="#loc_196_9_196_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_9_196_18&#39;)"><span class="hl_tyconref"><span class="mpre">GTypeFun&#39;</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)] -&gt; </span><a href="#loc_196_9_196_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_9_196_18&#39;)"><span class="hl_tyconref"><span class="mpre">GTypeFun&#39;</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
  </span><a name="loc_191_3_191_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_3_191_9&#39;)"><span class="hl_fundecl"><span class="mpre">reduce</span></span></a><span class="mpre"> [] _ = </span><a href="#loc_164_21_164_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_21_164_22&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
  </span><a href="#loc_191_3_191_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_3_191_9&#39;)"><span class="hl_fundecl"><span class="mpre">reduce</span></span></a><span class="mpre"> (</span><a name="loc_192_11_192_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_11_192_13&#39;)"><span class="hl_vardecl"><span class="mpre">xy</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_192_14_192_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_14_192_15&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">) </span><a name="loc_192_17_192_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_17_192_18&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> (</span><a href="#loc_192_11_192_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_11_192_13&#39;)"><span class="hl_varref"><span class="mpre">xy</span></span></a><span class="mpre"> </span><a href="#loc_192_17_192_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_17_192_18&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">) </span><a href="#loc_164_18_164_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_18_164_19&#39;)"><span class="hl_infix"><span class="mpre">`o`</span></span></a><span class="mpre"> </span><a href="#loc_191_3_191_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_3_191_9&#39;)"><span class="hl_varref"><span class="mpre">reduce</span></span></a><span class="mpre"> </span><a href="#loc_192_14_192_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_14_192_15&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> (</span><a href="#loc_192_11_192_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_11_192_13&#39;)"><span class="hl_varref"><span class="mpre">xy</span></span></a><span class="mpre"> </span><a href="#loc_192_17_192_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_17_192_18&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">))


</span><span class="hl_comment"><span class="mpre">-- First-class polymorphic variation on GTypeFun</span></span><span class="mpre">
newtype </span><a name="loc_196_9_196_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_9_196_18&#39;)"><span class="hl_tycondecl"><span class="mpre">GTypeFun&#39;</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> = </span><a name="loc_196_23_196_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_23_196_32&#39;)"><span class="hl_condecl"><span class="mpre">GTypeFun&#39;</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
</span><a name="loc_197_1_197_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_1_197_12&#39;)"><span class="hl_fundecl"><span class="mpre">unGTypeFun&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_196_23_196_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_23_196_32&#39;)"><span class="hl_conref"><span class="mpre">GTypeFun&#39;</span></span></a><span class="mpre"> </span><a name="loc_197_24_197_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_24_197_25&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) = </span><a href="#loc_197_24_197_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_24_197_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Query all immediate subterm types.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   There is an extra argument to \&quot;constant out\&quot; the type at hand.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   This can be used to avoid cycles.</span></span><span class="mpre">

</span><a href="#loc_210_1_210_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_22&#39;)"><span class="mpre">gmapSubtermTypesConst</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 204, srcSpanStartColumn = 26, srcSpanEndLine = 205, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 204, srcSpanStartColumn = 26, srcSpanEndLine = 204, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 204, srcSpanStartColumn = "><span class="mpre">(Data a, Typeable r)
                      =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
                      -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
                      -&gt; </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> 
                      -&gt; </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> 
                      -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_210_1_210_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_22&#39;)"><span class="hl_fundecl"><span class="mpre">gmapSubtermTypesConst</span></span></a><span class="mpre"> </span><a name="loc_210_23_210_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_23_210_24&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> (</span><a name="loc_210_26_210_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_26_210_27&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">::</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) </span><a name="loc_210_32_210_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_32_210_33&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a name="loc_210_35_210_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_35_210_36&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
  =
    </span><a href="#loc_164_1_164_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_17&#39;)"><span class="hl_varref"><span class="mpre">gmapSubtermTypes</span></span></a><span class="mpre"> </span><a href="#loc_210_23_210_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_23_210_24&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="#loc_210_26_210_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_26_210_27&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><a href="#loc_215_5_215_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_5_215_7&#39;)"><span class="hl_varref"><span class="mpre">f&#39;</span></span></a><span class="mpre"> </span><a href="#loc_210_35_210_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_35_210_36&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
  where
    </span><a href="#loc_215_5_215_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_5_215_7&#39;)"><span class="mpre">f&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
    </span><a name="loc_215_5_215_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_5_215_7&#39;)"><span class="hl_vardecl"><span class="mpre">f&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_210_32_210_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_32_210_33&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_101_1_101_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_8&#39;)"><span class="hl_infix"><span class="mpre">`extType`</span></span></a><span class="mpre"> \(_::</span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><a href="#loc_210_26_210_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_26_210_27&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Count all distinct subterm types</span></span><span class="mpre">
</span><a href="#loc_220_1_220_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_19&#39;)"><span class="mpre">gcountSubtermTypes</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 219, srcSpanStartColumn = 23, srcSpanEndLine = 219, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 219, srcSpanStartColumn = 30, srcSpanEndLine = 219, srcSpanEndColumn = 32}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSp"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_220_1_220_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_19&#39;)"><span class="hl_vardecl"><span class="mpre">gcountSubtermTypes</span></span></a><span class="mpre"> = </span><a href="#loc_164_1_164_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_17&#39;)"><span class="hl_varref"><span class="mpre">gmapSubtermTypes</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(+)</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | A simplied variation on gmapSubtermTypes.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Weakness: no awareness of doubles.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Strength: easy to comprehend as it uses gmapType and gmapConstr.</span></span><span class="mpre">

</span><a href="#loc_229_1_229_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_18&#39;)"><span class="mpre">_gmapSubtermTypes</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 227, srcSpanStartColumn = 22, srcSpanEndLine = 228, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 227, srcSpanStartColumn = 22, srcSpanEndLine = 227, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 227, srcSpanStartColumn = "><span class="mpre">(Data a, Typeable r) 
                  =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
</span><a name="loc_229_1_229_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_18&#39;)"><span class="hl_fundecl"><span class="mpre">_gmapSubtermTypes</span></span></a><span class="mpre"> </span><a name="loc_229_19_229_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_19_229_20&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> (</span><a name="loc_229_22_229_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_22_229_23&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">::</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">) </span><a name="loc_229_28_229_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_28_229_29&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">
  =
    </span><a href="#loc_118_1_118_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_9&#39;)"><span class="hl_varref"><span class="mpre">gmapType</span></span></a><span class="mpre"> </span><a href="#loc_236_3_236_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_3_236_8&#39;)"><span class="hl_varref"><span class="mpre">otype</span></span></a><span class="mpre"> (</span><a href="#loc_141_1_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_11&#39;)"><span class="hl_varref"><span class="mpre">gmapConstr</span></span></a><span class="mpre"> </span><a href="#loc_239_3_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_3_239_10&#39;)"><span class="hl_varref"><span class="mpre">oconstr</span></span></a><span class="mpre"> </span><a href="#loc_229_28_229_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_28_229_29&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)

 where

  </span><a href="#loc_236_3_236_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_3_236_8&#39;)"><span class="mpre">otype</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
  </span><a name="loc_236_3_236_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_3_236_8&#39;)"><span class="hl_vardecl"><span class="mpre">otype</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (\</span><a name="loc_236_19_236_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_19_236_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_236_21_236_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_21_236_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_236_19_236_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_19_236_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_229_19_229_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_19_229_20&#39;)"><span class="hl_infix"><span class="mpre">`o`</span></span></a><span class="mpre"> </span><a href="#loc_236_21_236_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_21_236_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><a href="#loc_229_22_229_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_22_229_23&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

  </span><a href="#loc_239_3_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_3_239_10&#39;)"><span class="mpre">oconstr</span></a><span class="mpre"> :: [</span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">
  </span><a name="loc_239_3_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_3_239_10&#39;)"><span class="hl_vardecl"><span class="mpre">oconstr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="#loc_229_19_229_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_19_229_20&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="#loc_229_22_229_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_22_229_23&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--        Some reifying relations on types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Reachability relation on types, i.e.,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   test if nodes of type @a@ are reachable from nodes of type @b@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   The relation is defined to be reflexive.</span></span><span class="mpre">

</span><a href="#loc_254_1_254_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_14&#39;)"><span class="mpre">reachableType</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 253, srcSpanStartColumn = 18, srcSpanEndLine = 253, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 253, srcSpanStartColumn = 18, srcSpanEndLine = 253, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 253, srcSpanStartColumn = "><span class="mpre">(Data a, Data b) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_254_1_254_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_14&#39;)"><span class="hl_fundecl"><span class="mpre">reachableType</span></span></a><span class="mpre"> (</span><a name="loc_254_16_254_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_16_254_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) (</span><a name="loc_254_31_254_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_31_254_32&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
  =
    </span><span class="hl_varref"><span class="mpre">or</span></span><span class="mpre"> [ </span><a href="#loc_51_1_51_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_9&#39;)"><span class="hl_varref"><span class="mpre">sameType</span></span></a><span class="mpre"> </span><a href="#loc_254_16_254_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_16_254_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_254_31_254_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_31_254_32&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
       , </span><a href="#loc_210_1_210_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_22&#39;)"><span class="hl_varref"><span class="mpre">gmapSubtermTypesConst</span></span></a><span class="mpre"> (\</span><a name="loc_257_34_257_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_34_257_35&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_257_36_257_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_36_257_37&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">or</span></span><span class="mpre"> [</span><a href="#loc_257_34_257_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_34_257_35&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">,</span><a href="#loc_257_36_257_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_36_257_37&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">]) </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> (</span><a href="#loc_254_1_254_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_14&#39;)"><span class="hl_varref"><span class="mpre">reachableType</span></span></a><span class="mpre"> </span><a href="#loc_254_16_254_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_16_254_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) </span><a href="#loc_254_31_254_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_31_254_32&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
       ]


</span><span class="hl_comment"><span class="mpre">-- | Depth of a datatype as the constructor with the minimum depth.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   The outermost &#39;Nothing&#39; denotes a type without constructors.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   The innermost &#39;Nothing&#39; denotes potentially infinite.</span></span><span class="mpre">

</span><a href="#loc_266_1_266_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_1_266_12&#39;)"><span class="mpre">depthOfType</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">))
</span><a name="loc_266_1_266_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_1_266_12&#39;)"><span class="hl_fundecl"><span class="mpre">depthOfType</span></span></a><span class="mpre"> </span><a name="loc_266_13_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_13_266_14&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a name="loc_266_16_266_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_16_266_17&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
  = 
    </span><a href="#loc_118_1_118_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_1_118_9&#39;)"><span class="hl_varref"><span class="mpre">gmapType</span></span></a><span class="mpre"> </span><a href="#loc_273_3_273_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_3_273_4&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="#loc_276_3_276_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_3_276_4&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_266_16_266_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_16_266_17&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

 where
   
  </span><a href="#loc_273_3_273_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_3_273_4&#39;)"><span class="mpre">o</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)] -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
  </span><a name="loc_273_3_273_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_3_273_4&#39;)"><span class="hl_fundecl"><span class="mpre">o</span></span></a><span class="mpre"> </span><a name="loc_273_5_273_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_5_273_6&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_273_5_273_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_5_273_6&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> then </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> else </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">foldr1</span></span><span class="mpre"> </span><a href="#loc_280_3_280_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_3_280_7&#39;)"><span class="hl_varref"><span class="mpre">min&#39;</span></span></a><span class="mpre"> </span><a href="#loc_273_5_273_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_5_273_6&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)

  </span><a href="#loc_276_3_276_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_3_276_4&#39;)"><span class="mpre">f</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
  </span><a name="loc_276_3_276_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_3_276_4&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_295_1_295_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_1_295_14&#39;)"><span class="hl_varref"><span class="mpre">depthOfConstr</span></span></a><span class="mpre"> </span><a href="#loc_287_3_287_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_3_287_5&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Specific minimum operator</span></span><span class="mpre">
  </span><a href="#loc_280_3_280_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_3_280_7&#39;)"><span class="mpre">min&#39;</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
  </span><a name="loc_280_3_280_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_3_280_7&#39;)"><span class="hl_fundecl"><span class="mpre">min&#39;</span></span></a><span class="mpre"> </span><a name="loc_280_8_280_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_8_280_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> (_, </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">) = </span><a href="#loc_280_8_280_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_8_280_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
  </span><a href="#loc_280_3_280_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_3_280_7&#39;)"><span class="hl_fundecl"><span class="mpre">min&#39;</span></span></a><span class="mpre"> (_, </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">) </span><a name="loc_281_21_281_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_21_281_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_281_21_281_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_21_281_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
  </span><a href="#loc_280_3_280_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_3_280_7&#39;)"><span class="hl_fundecl"><span class="mpre">min&#39;</span></span></a><span class="mpre"> (</span><a name="loc_282_9_282_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_9_282_10&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_282_17_282_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_17_282_18&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) (</span><span class="hl_vardecl"><span class="mpre">c&#39;</span></span><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_282_30_282_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_30_282_32&#39;)"><span class="hl_vardecl"><span class="mpre">i&#39;</span></span></a><span class="mpre">) | </span><a href="#loc_282_17_282_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_17_282_18&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_282_30_282_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_30_282_32&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="mpre"> = (</span><a href="#loc_282_9_282_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_9_282_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_282_17_282_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_17_282_18&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
  </span><a href="#loc_280_3_280_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_3_280_7&#39;)"><span class="hl_fundecl"><span class="mpre">min&#39;</span></span></a><span class="mpre"> (</span><span class="hl_vardecl"><span class="mpre">c</span></span><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">i</span></span><span class="mpre">) (</span><a name="loc_283_21_283_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_21_283_23&#39;)"><span class="hl_vardecl"><span class="mpre">c&#39;</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_283_30_283_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_30_283_32&#39;)"><span class="hl_vardecl"><span class="mpre">i&#39;</span></span></a><span class="mpre">)           = (</span><a href="#loc_283_21_283_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_21_283_23&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_283_30_283_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_30_283_32&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="mpre">)

  </span><span class="hl_comment"><span class="mpre">-- Updated predicate for unblocked types</span></span><span class="mpre">
  </span><a href="#loc_287_3_287_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_3_287_5&#39;)"><span class="mpre">p&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
  </span><a name="loc_287_3_287_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_3_287_5&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_266_13_266_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_13_266_14&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_101_1_101_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_8&#39;)"><span class="hl_infix"><span class="mpre">`extType`</span></span></a><span class="mpre"> \(_::</span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Depth of a constructor.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Depth is viewed as the maximum depth of all subterm types + 1.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;Nothing&#39; denotes potentially infinite.</span></span><span class="mpre">

</span><a href="#loc_295_1_295_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_1_295_14&#39;)"><span class="mpre">depthOfConstr</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre"> -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><a name="loc_295_1_295_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_1_295_14&#39;)"><span class="hl_fundecl"><span class="mpre">depthOfConstr</span></span></a><span class="mpre"> </span><a name="loc_295_15_295_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_15_295_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a name="loc_295_18_295_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_18_295_19&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><a name="loc_295_32_295_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_32_295_33&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">
  =
    </span><a href="#loc_141_1_141_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_11&#39;)"><span class="hl_varref"><span class="mpre">gmapConstr</span></span></a><span class="mpre"> </span><a href="#loc_302_3_302_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_3_302_4&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="#loc_305_3_305_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_3_305_4&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_295_18_295_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_18_295_19&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_295_32_295_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_32_295_33&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

 where

  </span><a href="#loc_302_3_302_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_3_302_4&#39;)"><span class="mpre">o</span></a><span class="mpre"> :: [</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">] -&gt; </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
  </span><a name="loc_302_3_302_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_3_302_4&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> = </span><a href="#loc_319_3_319_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_3_319_7&#39;)"><span class="hl_varref"><span class="mpre">inc&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="#loc_313_3_313_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_3_313_7&#39;)"><span class="hl_varref"><span class="mpre">max&#39;</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)

  </span><a href="#loc_305_3_305_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_3_305_4&#39;)"><span class="mpre">f</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GTypeFun</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
  </span><a name="loc_305_3_305_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_3_305_4&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_305_5_305_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_5_305_7&#39;)"><span class="hl_vardecl"><span class="mpre">t&#39;</span></span></a><span class="mpre"> = if </span><a href="#loc_295_15_295_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_15_295_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_305_5_305_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_5_305_7&#39;)"><span class="hl_varref"><span class="mpre">t&#39;</span></span></a><span class="mpre">
            then
                 case </span><a href="#loc_266_1_266_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_1_266_12&#39;)"><span class="hl_varref"><span class="mpre">depthOfType</span></span></a><span class="mpre"> </span><a href="#loc_295_15_295_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_15_295_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_305_5_305_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_5_305_7&#39;)"><span class="hl_varref"><span class="mpre">t&#39;</span></span></a><span class="mpre"> of
                   </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">     -&gt; </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                   </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (_, </span><a name="loc_309_29_309_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_29_309_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_309_29_309_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_29_309_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
            else </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Specific maximum operator</span></span><span class="mpre">
  </span><a name="loc_313_3_313_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_3_313_7&#39;)"><span class="hl_fundecl"><span class="mpre">max&#39;</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> _ = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
  </span><a href="#loc_313_3_313_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_3_313_7&#39;)"><span class="hl_fundecl"><span class="mpre">max&#39;</span></span></a><span class="mpre"> _ </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
  </span><a href="#loc_313_3_313_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_3_313_7&#39;)"><span class="hl_fundecl"><span class="mpre">max&#39;</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_315_14_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_14_315_15&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_315_23_315_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_23_315_25&#39;)"><span class="hl_vardecl"><span class="mpre">i&#39;</span></span></a><span class="mpre">) | </span><a href="#loc_315_14_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_14_315_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_315_23_315_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_23_315_25&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_315_14_315_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_14_315_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
  </span><a href="#loc_313_3_313_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_3_313_7&#39;)"><span class="hl_fundecl"><span class="mpre">max&#39;</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">i</span></span><span class="mpre">) (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_316_23_316_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_23_316_25&#39;)"><span class="hl_vardecl"><span class="mpre">i&#39;</span></span></a><span class="mpre">)           = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_316_23_316_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_23_316_25&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Specific increment operator</span></span><span class="mpre">
  </span><a name="loc_319_3_319_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_3_319_7&#39;)"><span class="hl_fundecl"><span class="mpre">inc&#39;</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
  </span><a href="#loc_319_3_319_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_3_319_7&#39;)"><span class="hl_fundecl"><span class="mpre">inc&#39;</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_320_14_320_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_14_320_15&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) = </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a href="#loc_320_14_320_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_14_320_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--        Build a shallow term </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_330_1_330_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_12&#39;)"><span class="mpre">shallowTerm</span></a><span class="mpre"> :: (forall </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 329, srcSpanStartColumn = 27, srcSpanEndLine = 329, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 329, srcSpanStartColumn = 34, srcSpanEndLine = 329, srcSpanEndColumn = 36}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSp"><span class="mpre">Data a =&gt;</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; (forall </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 329, srcSpanStartColumn = 60, srcSpanEndLine = 329, srcSpanEndColumn = 69}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 329, srcSpanStartColumn = 67, srcSpanEndLine = 329, srcSpanEndColumn = 69}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSp"><span class="mpre">Data b =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_330_1_330_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_12&#39;)"><span class="hl_fundecl"><span class="mpre">shallowTerm</span></span></a><span class="mpre"> </span><a name="loc_330_13_330_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_13_330_17&#39;)"><span class="hl_vardecl"><span class="mpre">cust</span></span></a><span class="mpre">
  = </span><a href="#loc_335_5_335_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_5_335_11&#39;)"><span class="hl_varref"><span class="mpre">result</span></span></a><span class="mpre">
  where
    </span><a href="#loc_335_5_335_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_5_335_11&#39;)"><span class="mpre">result</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 333, srcSpanStartColumn = 25, srcSpanEndLine = 333, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 333, srcSpanStartColumn = 32, srcSpanEndLine = 333, srcSpanEndColumn = 34}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSp"><span class="mpre">Data b =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- Need a type signature here to bring &#39;b&#39; into scope</span></span><span class="mpre">
    </span><a name="loc_335_5_335_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_5_335_11&#39;)"><span class="hl_vardecl"><span class="mpre">result</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><a href="#loc_340_11_340_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_11_340_19&#39;)"><span class="hl_varref"><span class="mpre">gdefault</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_330_13_330_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_13_330_17&#39;)"><span class="hl_varref"><span class="mpre">cust</span></span></a><span class="mpre">
         where

          </span><span class="hl_comment"><span class="mpre">-- The worker, also used for type disambiguation</span></span><span class="mpre">
          </span><a href="#loc_340_11_340_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_11_340_19&#39;)"><span class="mpre">gdefault</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
          </span><a name="loc_340_11_340_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_11_340_19&#39;)"><span class="hl_vardecl"><span class="mpre">gdefault</span></span></a><span class="mpre"> = case </span><a href="#loc_350_11_350_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_11_350_14&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre"> of
                      </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_341_29_341_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_29_341_32&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> _) -&gt; </span><span class="hl_varref"><span class="mpre">fromConstrB</span></span><span class="mpre"> (</span><a href="#loc_330_1_330_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_12&#39;)"><span class="hl_varref"><span class="mpre">shallowTerm</span></span></a><span class="mpre"> </span><a href="#loc_330_13_330_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_13_330_17&#39;)"><span class="hl_varref"><span class="mpre">cust</span></span></a><span class="mpre">) </span><a href="#loc_341_29_341_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_29_341_32&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">
                      _ -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;no shallow term!&quot;</span></span><span class="mpre">

          </span><span class="hl_comment"><span class="mpre">-- The type to be constructed</span></span><span class="mpre">
          </span><a href="#loc_346_11_346_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_11_346_18&#39;)"><span class="mpre">typeVal</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
          </span><a name="loc_346_11_346_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_11_346_18&#39;)"><span class="hl_vardecl"><span class="mpre">typeVal</span></span></a><span class="mpre"> = </span><a href="#loc_57_1_57_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_9&#39;)"><span class="hl_varref"><span class="mpre">val2type</span></span></a><span class="mpre"> </span><a href="#loc_340_11_340_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_11_340_19&#39;)"><span class="hl_varref"><span class="mpre">gdefault</span></span></a><span class="mpre">

          </span><span class="hl_comment"><span class="mpre">-- The most shallow constructor if any </span></span><span class="mpre">
          </span><a href="#loc_350_11_350_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_11_350_14&#39;)"><span class="mpre">con</span></a><span class="mpre"> :: </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre">, </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
          </span><a name="loc_350_11_350_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_11_350_14&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre"> = </span><a href="#loc_266_1_266_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_1_266_12&#39;)"><span class="hl_varref"><span class="mpre">depthOfType</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">) </span><a href="#loc_346_11_346_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_11_346_18&#39;)"><span class="hl_varref"><span class="mpre">typeVal</span></span></a><span class="mpre">



</span><span class="hl_comment"><span class="mpre">-- For testing shallowTerm</span></span><span class="mpre">
</span><a href="#loc_356_1_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_16&#39;)"><span class="mpre">shallowTermBase</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">GenericR</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre">
</span><a name="loc_356_1_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_16&#39;)"><span class="hl_vardecl"><span class="mpre">shallowTermBase</span></span></a><span class="mpre"> =        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> 
                  </span><a href="Data.Generics.Aliases.html#loc_212_1_212_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_212_1_212_5&#39;)"><span class="hl_infix"><span class="mpre">`extR`</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1.23</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre">)
                  </span><a href="Data.Generics.Aliases.html#loc_212_1_212_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_212_1_212_5&#39;)"><span class="hl_infix"><span class="mpre">`extR`</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)



</span><span class="hl_comment"><span class="mpre">-- Sample datatypes</span></span><span class="mpre">
data </span><a name="loc_363_6_363_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_6_363_8&#39;)"><span class="hl_tycondecl"><span class="mpre">T1</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">T1a</span></span><span class="mpre">               </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 363, srcSpanStartColumn = 29, srcSpanEndLine = 363, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 363, srcSpanStartColumn = 29, srcSpanEndLine = 363, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 363, srcSpanStartColumn ="><span class="mpre">deriving (Typeable, Data)</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- just a constant</span></span><span class="mpre">
data </span><a name="loc_364_6_364_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_6_364_8&#39;)"><span class="hl_tycondecl"><span class="mpre">T2</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">T2</span></span><span class="mpre"> </span><a href="#loc_363_6_363_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_6_363_8&#39;)"><span class="hl_tyconref"><span class="mpre">T1</span></span></a><span class="mpre">             </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 364, srcSpanStartColumn = 29, srcSpanEndLine = 364, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 364, srcSpanStartColumn = 29, srcSpanEndLine = 364, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 364, srcSpanStartColumn ="><span class="mpre">deriving (Typeable, Data)</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- little detour</span></span><span class="mpre">
data </span><a name="loc_365_6_365_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_6_365_8&#39;)"><span class="hl_tycondecl"><span class="mpre">T3</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">T3a</span></span><span class="mpre"> </span><a href="#loc_365_6_365_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_6_365_8&#39;)"><span class="hl_tyconref"><span class="mpre">T3</span></span></a><span class="mpre"> | </span><span class="hl_condecl"><span class="mpre">T3b</span></span><span class="mpre"> </span><a href="#loc_364_6_364_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_6_364_8&#39;)"><span class="hl_tyconref"><span class="mpre">T2</span></span></a><span class="mpre">   </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 365, srcSpanStartColumn = 29, srcSpanEndLine = 365, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 365, srcSpanStartColumn = 29, srcSpanEndLine = 365, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 365, srcSpanStartColumn ="><span class="mpre">deriving (Typeable, Data)</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- recursive case</span></span><span class="mpre">
data </span><a name="loc_366_6_366_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_6_366_8&#39;)"><span class="hl_tycondecl"><span class="mpre">T4</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">T4</span></span><span class="mpre"> </span><a href="#loc_365_6_365_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_6_365_8&#39;)"><span class="hl_tyconref"><span class="mpre">T3</span></span></a><span class="mpre"> </span><a href="#loc_365_6_365_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_6_365_8&#39;)"><span class="hl_tyconref"><span class="mpre">T3</span></span></a><span class="mpre">          </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 366, srcSpanStartColumn = 29, srcSpanEndLine = 366, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 366, srcSpanStartColumn = 29, srcSpanEndLine = 366, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/Reify.hs&quot;, srcSpanStartLine = 366, srcSpanStartColumn ="><span class="mpre">deriving (Typeable, Data)</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- sum matters</span></span><span class="mpre">



</span><span class="hl_comment"><span class="mpre">-- Sample type arguments</span></span><span class="mpre">
</span><span class="hl_vardecl"><span class="mpre">t0</span></span><span class="mpre"> = </span><a href="#loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="hl_varref"><span class="mpre">typeVal</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_372_1_372_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_1_372_3&#39;)"><span class="hl_vardecl"><span class="mpre">t1</span></span></a><span class="mpre"> = </span><a href="#loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="hl_varref"><span class="mpre">typeVal</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><a href="#loc_363_6_363_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_6_363_8&#39;)"><span class="hl_tyconref"><span class="mpre">T1</span></span></a><span class="mpre">
</span><a name="loc_373_1_373_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_1_373_3&#39;)"><span class="hl_vardecl"><span class="mpre">t2</span></span></a><span class="mpre"> = </span><a href="#loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="hl_varref"><span class="mpre">typeVal</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><a href="#loc_364_6_364_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_6_364_8&#39;)"><span class="hl_tyconref"><span class="mpre">T2</span></span></a><span class="mpre">
</span><a name="loc_374_1_374_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_3&#39;)"><span class="hl_vardecl"><span class="mpre">t3</span></span></a><span class="mpre"> = </span><a href="#loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="hl_varref"><span class="mpre">typeVal</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><a href="#loc_365_6_365_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_6_365_8&#39;)"><span class="hl_tyconref"><span class="mpre">T3</span></span></a><span class="mpre">
</span><span class="hl_vardecl"><span class="mpre">t4</span></span><span class="mpre"> = </span><a href="#loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="hl_varref"><span class="mpre">typeVal</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><a href="#loc_366_6_366_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_6_366_8&#39;)"><span class="hl_tyconref"><span class="mpre">T4</span></span></a><span class="mpre">
</span><a name="loc_376_1_376_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_9&#39;)"><span class="hl_vardecl"><span class="mpre">tCompany</span></span></a><span class="mpre">  = </span><a href="#loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="hl_varref"><span class="mpre">typeVal</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><a href="CompanyDatatypes.html#loc_9_6_9_13" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_9_6_9_13&#39;)"><span class="hl_tyconref"><span class="mpre">Company</span></span></a><span class="mpre">
</span><a name="loc_377_1_377_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_1_377_8&#39;)"><span class="hl_vardecl"><span class="mpre">tPerson</span></span></a><span class="mpre">   = </span><a href="#loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="hl_varref"><span class="mpre">typeVal</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><a href="CompanyDatatypes.html#loc_13_6_13_12" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_13_6_13_12&#39;)"><span class="hl_tyconref"><span class="mpre">Person</span></span></a><span class="mpre">
</span><a name="loc_378_1_378_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_1_378_10&#39;)"><span class="hl_vardecl"><span class="mpre">tEmployee</span></span></a><span class="mpre"> = </span><a href="#loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="hl_varref"><span class="mpre">typeVal</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><a href="CompanyDatatypes.html#loc_12_6_12_14" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_12_6_12_14&#39;)"><span class="hl_tyconref"><span class="mpre">Employee</span></span></a><span class="mpre">
</span><a name="loc_379_1_379_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_1_379_6&#39;)"><span class="hl_vardecl"><span class="mpre">tDept</span></span></a><span class="mpre">     = </span><a href="#loc_46_1_46_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_8&#39;)"><span class="hl_varref"><span class="mpre">typeVal</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TypeVal</span></span><span class="mpre"> </span><a href="CompanyDatatypes.html#loc_10_6_10_10" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_10_6_10_10&#39;)"><span class="hl_tyconref"><span class="mpre">Dept</span></span></a><span class="mpre">



</span><span class="hl_comment"><span class="mpre">-- Test cases</span></span><span class="mpre">
</span><a name="loc_384_1_384_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_1_384_6&#39;)"><span class="hl_vardecl"><span class="mpre">test0</span></span></a><span class="mpre">   = </span><a href="#loc_372_1_372_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_1_372_3&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre"> </span><a href="#loc_254_1_254_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_14&#39;)"><span class="hl_infix"><span class="mpre">`reachableType`</span></span></a><span class="mpre"> </span><a href="#loc_372_1_372_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_1_372_3&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- True</span></span><span class="mpre">
</span><a name="loc_385_1_385_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_1_385_6&#39;)"><span class="hl_vardecl"><span class="mpre">test1</span></span></a><span class="mpre">   = </span><a href="#loc_372_1_372_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_1_372_3&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre"> </span><a href="#loc_254_1_254_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_14&#39;)"><span class="hl_infix"><span class="mpre">`reachableType`</span></span></a><span class="mpre"> </span><a href="#loc_373_1_373_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_1_373_3&#39;)"><span class="hl_varref"><span class="mpre">t2</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- True</span></span><span class="mpre">
</span><a name="loc_386_1_386_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_1_386_6&#39;)"><span class="hl_vardecl"><span class="mpre">test2</span></span></a><span class="mpre">   = </span><a href="#loc_373_1_373_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_373_1_373_3&#39;)"><span class="hl_varref"><span class="mpre">t2</span></span></a><span class="mpre"> </span><a href="#loc_254_1_254_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_14&#39;)"><span class="hl_infix"><span class="mpre">`reachableType`</span></span></a><span class="mpre"> </span><a href="#loc_372_1_372_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_1_372_3&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- False</span></span><span class="mpre">
</span><a name="loc_387_1_387_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_6&#39;)"><span class="hl_vardecl"><span class="mpre">test3</span></span></a><span class="mpre">   = </span><a href="#loc_372_1_372_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_1_372_3&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre"> </span><a href="#loc_254_1_254_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_14&#39;)"><span class="hl_infix"><span class="mpre">`reachableType`</span></span></a><span class="mpre"> </span><a href="#loc_374_1_374_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_1_374_3&#39;)"><span class="hl_varref"><span class="mpre">t3</span></span></a><span class="mpre">
</span><a name="loc_388_1_388_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_1_388_6&#39;)"><span class="hl_vardecl"><span class="mpre">test4</span></span></a><span class="mpre">   = </span><a href="#loc_377_1_377_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_1_377_8&#39;)"><span class="hl_varref"><span class="mpre">tPerson</span></span></a><span class="mpre"> </span><a href="#loc_254_1_254_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_14&#39;)"><span class="hl_infix"><span class="mpre">`reachableType`</span></span></a><span class="mpre"> </span><a href="#loc_376_1_376_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_9&#39;)"><span class="hl_varref"><span class="mpre">tCompany</span></span></a><span class="mpre">
</span><a name="loc_389_1_389_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_1_389_6&#39;)"><span class="hl_vardecl"><span class="mpre">test5</span></span></a><span class="mpre">   = </span><a href="#loc_220_1_220_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_19&#39;)"><span class="hl_varref"><span class="mpre">gcountSubtermTypes</span></span></a><span class="mpre"> </span><a href="#loc_377_1_377_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_1_377_8&#39;)"><span class="hl_varref"><span class="mpre">tPerson</span></span></a><span class="mpre">
</span><a name="loc_390_1_390_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_6&#39;)"><span class="hl_vardecl"><span class="mpre">test6</span></span></a><span class="mpre">   = </span><a href="#loc_220_1_220_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_19&#39;)"><span class="hl_varref"><span class="mpre">gcountSubtermTypes</span></span></a><span class="mpre"> </span><a href="#loc_378_1_378_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_1_378_10&#39;)"><span class="hl_varref"><span class="mpre">tEmployee</span></span></a><span class="mpre">
</span><a name="loc_391_1_391_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_1_391_6&#39;)"><span class="hl_vardecl"><span class="mpre">test7</span></span></a><span class="mpre">   = </span><a href="#loc_220_1_220_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_19&#39;)"><span class="hl_varref"><span class="mpre">gcountSubtermTypes</span></span></a><span class="mpre"> </span><a href="#loc_379_1_379_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_1_379_6&#39;)"><span class="hl_varref"><span class="mpre">tDept</span></span></a><span class="mpre">
</span><a name="loc_392_1_392_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_1_392_6&#39;)"><span class="hl_vardecl"><span class="mpre">test8</span></span></a><span class="mpre">   = </span><a href="#loc_330_1_330_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_12&#39;)"><span class="hl_varref"><span class="mpre">shallowTerm</span></span></a><span class="mpre"> </span><a href="#loc_356_1_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_16&#39;)"><span class="hl_varref"><span class="mpre">shallowTermBase</span></span></a><span class="mpre"> :: </span><a href="CompanyDatatypes.html#loc_13_6_13_12" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_13_6_13_12&#39;)"><span class="hl_tyconref"><span class="mpre">Person</span></span></a><span class="mpre">
</span><a name="loc_393_1_393_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_1_393_6&#39;)"><span class="hl_vardecl"><span class="mpre">test9</span></span></a><span class="mpre">   = </span><a href="#loc_330_1_330_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_12&#39;)"><span class="hl_varref"><span class="mpre">shallowTerm</span></span></a><span class="mpre"> </span><a href="#loc_356_1_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_16&#39;)"><span class="hl_varref"><span class="mpre">shallowTermBase</span></span></a><span class="mpre"> :: </span><a href="CompanyDatatypes.html#loc_12_6_12_14" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_12_6_12_14&#39;)"><span class="hl_tyconref"><span class="mpre">Employee</span></span></a><span class="mpre">
</span><a name="loc_394_1_394_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_7&#39;)"><span class="hl_vardecl"><span class="mpre">test10</span></span></a><span class="mpre">  = </span><a href="#loc_330_1_330_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_1_330_12&#39;)"><span class="hl_varref"><span class="mpre">shallowTerm</span></span></a><span class="mpre"> </span><a href="#loc_356_1_356_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_1_356_16&#39;)"><span class="hl_varref"><span class="mpre">shallowTermBase</span></span></a><span class="mpre"> :: </span><a href="CompanyDatatypes.html#loc_10_6_10_10" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_10_6_10_10&#39;)"><span class="hl_tyconref"><span class="mpre">Dept</span></span></a><span class="mpre">



</span><a name="loc_398_1_398_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_1_398_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = (   </span><a href="#loc_384_1_384_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_1_384_6&#39;)"><span class="hl_varref"><span class="mpre">test0</span></span></a><span class="mpre">
        , ( </span><a href="#loc_385_1_385_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_1_385_6&#39;)"><span class="hl_varref"><span class="mpre">test1</span></span></a><span class="mpre">
        , ( </span><a href="#loc_386_1_386_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_386_1_386_6&#39;)"><span class="hl_varref"><span class="mpre">test2</span></span></a><span class="mpre">
        , ( </span><a href="#loc_387_1_387_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_6&#39;)"><span class="hl_varref"><span class="mpre">test3</span></span></a><span class="mpre">
        , ( </span><a href="#loc_388_1_388_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_1_388_6&#39;)"><span class="hl_varref"><span class="mpre">test4</span></span></a><span class="mpre">
        , ( </span><a href="#loc_389_1_389_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_1_389_6&#39;)"><span class="hl_varref"><span class="mpre">test5</span></span></a><span class="mpre">
        , ( </span><a href="#loc_390_1_390_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_1_390_6&#39;)"><span class="hl_varref"><span class="mpre">test6</span></span></a><span class="mpre">
        , ( </span><a href="#loc_391_1_391_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_1_391_6&#39;)"><span class="hl_varref"><span class="mpre">test7</span></span></a><span class="mpre">
        , ( </span><a href="#loc_392_1_392_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_1_392_6&#39;)"><span class="hl_varref"><span class="mpre">test8</span></span></a><span class="mpre">
        , ( </span><a href="#loc_393_1_393_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_1_393_6&#39;)"><span class="hl_varref"><span class="mpre">test9</span></span></a><span class="mpre">
        , ( </span><a href="#loc_394_1_394_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_1_394_7&#39;)"><span class="hl_varref"><span class="mpre">test10</span></span></a><span class="mpre">
        ))))))))))) </span><span class="hl_infix"><span class="mpre">~=?</span></span><span class="mpre"> </span><a href="#loc_411_1_411_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_7&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">

</span><a name="loc_411_1_411_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_7&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,(</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,(</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">,(</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,(</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,(</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,(</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">,(</span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">,(</span><a href="CompanyDatatypes.html#loc_13_17_13_18" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_13_17_13_18&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">,
           (</span><a href="CompanyDatatypes.html#loc_12_17_12_18" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_12_17_12_18&#39;)"><span class="hl_conref"><span class="mpre">E</span></span></a><span class="mpre"> (</span><a href="CompanyDatatypes.html#loc_13_17_13_18" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_13_17_13_18&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">) (</span><a href="CompanyDatatypes.html#loc_14_17_14_18" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_14_17_14_18&#39;)"><span class="hl_conref"><span class="mpre">S</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1.23</span></span><span class="mpre">),
              </span><a href="CompanyDatatypes.html#loc_10_17_10_18" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_10_17_10_18&#39;)"><span class="hl_conref"><span class="mpre">D</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre"> (</span><a href="CompanyDatatypes.html#loc_12_17_12_18" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_12_17_12_18&#39;)"><span class="hl_conref"><span class="mpre">E</span></span></a><span class="mpre"> (</span><a href="CompanyDatatypes.html#loc_13_17_13_18" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_13_17_13_18&#39;)"><span class="hl_conref"><span class="mpre">P</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">) (</span><a href="CompanyDatatypes.html#loc_14_17_14_18" onmouseover="nemnem.highlightLocalToRemote(&#39;CompanyDatatypes.html#loc_14_17_14_18&#39;)"><span class="hl_conref"><span class="mpre">S</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1.23</span></span><span class="mpre">)) []))))))))))
</span></div></body></html>