<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module System.X509.MacOS
        ( getSystemCertificateStore
        ) where

import Data.PEM (</span><a href="Data.PEM.Parser.html#loc_91_1_91_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.PEM.Parser.html#loc_91_1_91_12&#39;)"><span class="mpre">pemParseLBS</span></a><span class="mpre">, </span><a href="Data.PEM.Types.html#loc_16_6_16_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.PEM.Types.html#loc_16_6_16_9&#39;)"><span class="mpre">PEM</span></a><span class="mpre">(..))
import System.Process
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/MacOS.hs&quot;, srcSpanStartLine = 7, srcSpanStartColumn = 18, srcSpanEndLine = 7, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as LBS
import Control.Applicative
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/MacOS.hs&quot;, srcSpanStartLine = 9, srcSpanStartColumn = 8, srcSpanEndLine = 9, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;Data.Either&quot;"><span class="mpre">Data.Either</span></span><span class="mpre">

import Data.X509
import Data.X509.CertificateStore

</span><a href="#loc_15_1_15_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_15&#39;)"><span class="mpre">rootCAKeyChain</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_15_1_15_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_15&#39;)"><span class="hl_vardecl"><span class="mpre">rootCAKeyChain</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;/System/Library/Keychains/SystemRootCertificates.keychain&quot;</span></span><span class="mpre">

</span><a href="#loc_18_1_18_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_15&#39;)"><span class="mpre">listInKeyChain</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">SignedCertificate</span></span><span class="mpre">]
</span><a name="loc_18_1_18_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_15&#39;)"><span class="hl_fundecl"><span class="mpre">listInKeyChain</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">keyChain</span></span><span class="mpre"> = do
    (_, </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_19_14_19_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_14_19_18&#39;)"><span class="hl_vardecl"><span class="mpre">hout</span></span></a><span class="mpre">, _, </span><a name="loc_19_23_19_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_23_19_25&#39;)"><span class="hl_vardecl"><span class="mpre">ph</span></span></a><span class="mpre">) &lt;- </span><a href="System.Process.html#loc_211_1_211_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_211_1_211_14&#39;)"><span class="hl_varref"><span class="mpre">createProcess</span></span></a><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/MacOS.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 44, srcSpanEndLine = 19, srcSpanEndColumn = 124}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/MacOS.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 100, srcSpanEndLine = 19, srcSpanEndColumn = 101},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-system-1.4.5/System/X509/MacOS.hs&quot;, sr"><span class="mpre">(proc &quot;security&quot; [&quot;find-certificate&quot;, &quot;-pa&quot;, keyChain]) { std_out = CreatePipe }</span></span><span class="mpre">
    </span><a name="loc_20_5_20_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_5_20_9&#39;)"><span class="hl_vardecl"><span class="mpre">pems</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.PEM.Parser.html#loc_91_1_91_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.PEM.Parser.html#loc_91_1_91_12&#39;)"><span class="hl_varref"><span class="mpre">pemParseLBS</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">LBS.hGetContents</span></span><span class="mpre"> </span><a href="#loc_19_14_19_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_14_19_18&#39;)"><span class="hl_varref"><span class="mpre">hout</span></span></a><span class="mpre">
    let </span><a name="loc_21_9_21_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_9_21_16&#39;)"><span class="hl_vardecl"><span class="mpre">targets</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">rights</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Data.X509.html#loc_95_1_95_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.html#loc_95_1_95_24&#39;)"><span class="hl_varref"><span class="mpre">decodeSignedCertificate</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.PEM.Types.html#loc_19_11_19_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.PEM.Types.html#loc_19_11_19_21&#39;)"><span class="hl_varref"><span class="mpre">pemContent</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_string"><span class="mpre">&quot;CERTIFICATE&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.PEM.Types.html#loc_17_11_17_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.PEM.Types.html#loc_17_11_17_18&#39;)"><span class="hl_varref"><span class="mpre">pemName</span></span></a><span class="mpre">) </span><a href="#loc_20_5_20_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_5_20_9&#39;)"><span class="hl_varref"><span class="mpre">pems</span></span></a><span class="mpre">
    _ &lt;- </span><a href="#loc_21_9_21_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_9_21_16&#39;)"><span class="hl_varref"><span class="mpre">targets</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`seq`</span></span><span class="mpre"> </span><a href="System.Process.html#loc_575_1_575_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_575_1_575_15&#39;)"><span class="hl_varref"><span class="mpre">waitForProcess</span></span></a><span class="mpre"> </span><a href="#loc_19_23_19_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_23_19_25&#39;)"><span class="hl_varref"><span class="mpre">ph</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_21_9_21_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_9_21_16&#39;)"><span class="hl_varref"><span class="mpre">targets</span></span></a><span class="mpre">

</span><a href="#loc_26_1_26_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_26&#39;)"><span class="mpre">getSystemCertificateStore</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Data.X509.CertificateStore.html#loc_16_6_16_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateStore.html#loc_16_6_16_22&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateStore</span></span></a><span class="mpre">
</span><a name="loc_26_1_26_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_26&#39;)"><span class="hl_vardecl"><span class="mpre">getSystemCertificateStore</span></span></a><span class="mpre"> = </span><a href="Data.X509.CertificateStore.html#loc_28_1_28_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateStore.html#loc_28_1_28_21&#39;)"><span class="hl_varref"><span class="mpre">makeCertificateStore</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_18_1_18_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_1_18_15&#39;)"><span class="hl_varref"><span class="mpre">listInKeyChain</span></span></a><span class="mpre"> </span><a href="#loc_15_1_15_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_15_1_15_15&#39;)"><span class="hl_varref"><span class="mpre">rootCAKeyChain</span></span></a><span class="mpre">
</span></div></body></html>