<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module         : Data.ByteString.Lazy.Search.DFA</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright      : Daniel Fischer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Licence        : BSD3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer     : Daniel Fischer &lt;daniel.is.fischer@googlemail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability      : Provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability    : non-portable (BangPatterns)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Fast search of lazy &#39;L.ByteString&#39; values. Breaking,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- splitting and replacing using a deterministic finite automaton.</span></span><span class="mpre">

module Data.ByteString.Lazy.Search.DFA ( </span><span class="hl_comment"><span class="mpre">-- * Overview</span></span><span class="mpre">
                                         </span><span class="hl_comment"><span class="mpre">-- $overview</span></span><span class="mpre">

                                         </span><span class="hl_comment"><span class="mpre">-- ** Complexity and performance</span></span><span class="mpre">
                                         </span><span class="hl_comment"><span class="mpre">-- $complexity</span></span><span class="mpre">

                                         </span><span class="hl_comment"><span class="mpre">-- ** Partial application</span></span><span class="mpre">
                                         </span><span class="hl_comment"><span class="mpre">-- $partial</span></span><span class="mpre">

                                         </span><span class="hl_comment"><span class="mpre">-- * Finding substrings</span></span><span class="mpre">
                                         indices
                                       , nonOverlappingIndices
                                         </span><span class="hl_comment"><span class="mpre">-- * Breaking on substrings</span></span><span class="mpre">
                                       , breakOn
                                       , breakAfter
                                       , breakFindAfter
                                         </span><span class="hl_comment"><span class="mpre">-- * Replacing</span></span><span class="mpre">
                                       , replace
                                         </span><span class="hl_comment"><span class="mpre">-- * Splitting</span></span><span class="mpre">
                                       , split
                                       , splitKeepEnd
                                       , splitKeepFront
                                       ) where

import Data.ByteString.Search.Internal.Utils (</span><a href="Data.ByteString.Search.Internal.Utils.html#loc_45_1_45_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_45_1_45_10&#39;)"><span class="mpre">automaton</span></a><span class="mpre">, </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_338_1_338_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_338_1_338_5&#39;)"><span class="mpre">keep</span></a><span class="mpre">, </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_290_1_290_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_290_1_290_6&#39;)"><span class="mpre">ldrop</span></a><span class="mpre">, </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7&#39;)"><span class="mpre">lsplit</span></a><span class="mpre">)
import Data.ByteString.Search.Substitution

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/DFA.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 18, srcSpanEndLine = 40, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/DFA.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 18, srcSpanEndLine = 41, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as L
import qualified Data.ByteString.Lazy.Internal as LI
import Data.ByteString.Unsafe (</span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="mpre">unsafeIndex</span></a><span class="mpre">)

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/DFA.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 8, srcSpanEndLine = 45, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.Array.Base&quot;"><span class="mpre">Data.Array.Base</span></span><span class="mpre"> (unsafeAt)
</span><span class="hl_comment"><span class="mpre">--import Data.Array.Unboxed (UArray)</span></span><span class="mpre">

import Data.Bits
import Data.Int (</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="mpre">Int64</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- $overview</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This module provides functions related to searching a substring within</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a string. The searching algorithm uses a deterministic finite automaton</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- based on the Knuth-Morris-Pratt algorithm.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The automaton is implemented as an array of @(patternLength + 1) * &amp;#963;@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- state transitions, where &amp;#963; is the alphabet size (256), so it is only</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- suitable for short enough patterns, therefore the patterns in this module</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- are required to be strict &#39;S.ByteString&#39;s.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- When searching a pattern in a UTF-8-encoded &#39;L.ByteString&#39;, be aware that</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- these functions work on bytes, not characters, so the indices are</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- byte-offsets, not character offsets.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- $complexity</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The time and space complexity of the preprocessing phase is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /O/(@patternLength * &amp;#963;@).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The searching phase is /O/(@targetLength@), each target character is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- inspected only once.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In general the functions in this module have about the same performance as</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the corresponding functions using the Knuth-Morris-Pratt algorithm but</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- are considerably slower than the Boyer-Moore functions. For very short</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- patterns or, in the case of &#39;indices&#39;, patterns with a short period</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which occur often, however, times are close to or even below the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Boyer-Moore times.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- $partial</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- All functions can usefully be partially applied. Given only a pattern,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the automaton is constructed only once, allowing efficient re-use.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                            Exported Functions                            --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;indices&#39;@ finds the starting indices of all possibly overlapping</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   occurrences of the pattern in the target string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   If the pattern is empty, the result is @[0 .. &#39;length&#39; target]@.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_95_1_95_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_8&#39;)"><span class="mpre">indices</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_95_1_95_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_8&#39;)"><span class="mpre">indices</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern to find</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Lazy string to search</span></span><span class="mpre">
        -&gt; [</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">]          </span><span class="hl_comment"><span class="mpre">-- ^ Offsets of matches</span></span><span class="mpre">
</span><a name="loc_95_1_95_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_1_95_8&#39;)"><span class="hl_fundecl"><span class="mpre">indices</span></span></a><span class="mpre"> !</span><a name="loc_95_10_95_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_10_95_13&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_320_1_320_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_13&#39;)"><span class="hl_varref"><span class="mpre">lazySearcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_95_10_95_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_10_95_13&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;nonOverlappingIndices&#39;@ finds the starting indices of all</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   non-overlapping occurrences of the pattern in the target string.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   It is more efficient than removing indices from the list produced</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   by &#39;indices&#39;.</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_105_1_105_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_22&#39;)"><span class="mpre">nonOverlappingIndices</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_105_1_105_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_22&#39;)"><span class="mpre">nonOverlappingIndices</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern to find</span></span><span class="mpre">
                      -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ Lazy string to search</span></span><span class="mpre">
                      -&gt; [</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">]        </span><span class="hl_comment"><span class="mpre">-- ^ Offsets of matches</span></span><span class="mpre">
</span><a name="loc_105_1_105_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_1_105_22&#39;)"><span class="hl_fundecl"><span class="mpre">nonOverlappingIndices</span></span></a><span class="mpre"> !</span><a name="loc_105_24_105_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_24_105_27&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_320_1_320_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_13&#39;)"><span class="hl_varref"><span class="mpre">lazySearcher</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_105_24_105_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_24_105_27&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;breakOn&#39; pattern target@ splits @target@ at the first occurrence</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   of @pattern@. If the pattern does not occur in the target, the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   second component of the result is empty, otherwise it starts with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   @pattern@. If the pattern is empty, the first component is empty.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   For a non-empty pattern, the first component is generated lazily,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   thus the first parts of it can be available before the pattern has</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   been found or determined to be absent.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;uncurry&#39; &#39;L.append&#39; . &#39;breakOn&#39; pattern = &#39;id&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_122_1_122_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_8&#39;)"><span class="mpre">breakOn</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern to search for</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Lazy string to search in</span></span><span class="mpre">
        -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">)
                         </span><span class="hl_comment"><span class="mpre">-- ^ Head and tail of string broken at substring</span></span><span class="mpre">
</span><a name="loc_122_1_122_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_8&#39;)"><span class="hl_fundecl"><span class="mpre">breakOn</span></span></a><span class="mpre"> </span><a name="loc_122_9_122_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_12&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_125_5_125_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_5_125_12&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    </span><a name="loc_124_5_124_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_5_124_9&#39;)"><span class="hl_vardecl"><span class="mpre">lbrk</span></span></a><span class="mpre"> = </span><a href="#loc_371_1_371_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_12&#39;)"><span class="hl_varref"><span class="mpre">lazyBreaker</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_122_9_122_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_9_122_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_125_5_125_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_5_125_12&#39;)"><span class="hl_fundecl"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a name="loc_125_13_125_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_13_125_17&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> = let (</span><a name="loc_125_25_125_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_25_125_26&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">, </span><a name="loc_125_28_125_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_28_125_29&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_124_5_124_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_5_124_9&#39;)"><span class="hl_varref"><span class="mpre">lbrk</span></span></a><span class="mpre"> </span><a href="#loc_125_13_125_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_13_125_17&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">
                   in (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_125_25_125_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_25_125_26&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_125_28_125_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_28_125_29&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;breakAfter&#39; pattern target@ splits @target@ behind the first occurrence</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   of @pattern@. An empty second component means that either the pattern</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   does not occur in the target or the first occurrence of pattern is at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   the very end of target. If you need to discriminate between those cases,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   use breakFindAfter.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   If the pattern is empty, the first component is empty.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   For a non-empty pattern, the first component is generated lazily,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   thus the first parts of it can be available before the pattern has</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   been found or determined to be absent.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;uncurry&#39; &#39;L.append&#39; . &#39;breakAfter&#39; pattern = &#39;id&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_144_1_144_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_11&#39;)"><span class="mpre">breakAfter</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern to search for</span></span><span class="mpre">
           -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Lazy string to search in</span></span><span class="mpre">
           -&gt; (</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">)
                            </span><span class="hl_comment"><span class="mpre">-- ^ Head and tail of string broken after substring</span></span><span class="mpre">
</span><a name="loc_144_1_144_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_11&#39;)"><span class="hl_fundecl"><span class="mpre">breakAfter</span></span></a><span class="mpre"> </span><a name="loc_144_12_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_12_144_15&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_147_5_147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_12&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    </span><a name="loc_146_5_146_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_5_146_9&#39;)"><span class="hl_vardecl"><span class="mpre">lbrk</span></span></a><span class="mpre"> = </span><a href="#loc_371_1_371_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_12&#39;)"><span class="hl_varref"><span class="mpre">lazyBreaker</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_144_12_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_12_144_15&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_147_5_147_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_5_147_12&#39;)"><span class="hl_fundecl"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a name="loc_147_13_147_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_13_147_17&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> = let (</span><a name="loc_147_25_147_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_25_147_26&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">, </span><a name="loc_147_28_147_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_28_147_29&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_146_5_146_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_5_146_9&#39;)"><span class="hl_varref"><span class="mpre">lbrk</span></span></a><span class="mpre"> </span><a href="#loc_147_13_147_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_13_147_17&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">
                   in (</span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_147_25_147_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_25_147_26&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_147_28_147_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_28_147_29&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;breakFindAfter&#39;@ does the same as &#39;breakAfter&#39; but additionally indicates</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   whether the pattern is present in the target.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;fst&#39; . &#39;breakFindAfter&#39; pat = &#39;breakAfter&#39; pat</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_161_1_161_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_15&#39;)"><span class="mpre">breakFindAfter</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern to search for</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Lazy string to search in</span></span><span class="mpre">
               -&gt; ((</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">), </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)
                            </span><span class="hl_comment"><span class="mpre">-- ^ Head and tail of string broken after substring</span></span><span class="mpre">
                            </span><span class="hl_comment"><span class="mpre">--   and presence of pattern</span></span><span class="mpre">
</span><a name="loc_161_1_161_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_15&#39;)"><span class="hl_fundecl"><span class="mpre">breakFindAfter</span></span></a><span class="mpre"> </span><a name="loc_161_16_161_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_16_161_19&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_161_16_161_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_16_161_19&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">  = \</span><a name="loc_162_20_162_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_20_162_23&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> -&gt; ((</span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">, </span><a href="#loc_162_20_162_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_20_162_23&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">), </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)
</span><a href="#loc_161_1_161_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_15&#39;)"><span class="hl_fundecl"><span class="mpre">breakFindAfter</span></span></a><span class="mpre"> </span><a name="loc_163_16_163_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_16_163_19&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_167_5_167_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_5_167_12&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    !</span><a name="loc_165_6_165_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_6_165_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_163_16_163_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_16_163_19&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_166_5_166_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_5_166_9&#39;)"><span class="hl_vardecl"><span class="mpre">lbrk</span></span></a><span class="mpre"> = </span><a href="#loc_371_1_371_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_12&#39;)"><span class="hl_varref"><span class="mpre">lazyBreaker</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_163_16_163_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_16_163_19&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_167_5_167_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_5_167_12&#39;)"><span class="hl_fundecl"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a name="loc_167_13_167_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_13_167_17&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> = let (</span><a name="loc_167_25_167_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_25_167_26&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">, </span><a name="loc_167_28_167_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_28_167_29&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_166_5_166_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_5_166_9&#39;)"><span class="hl_varref"><span class="mpre">lbrk</span></span></a><span class="mpre"> </span><a href="#loc_167_13_167_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_13_167_17&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">
                       (</span><a name="loc_168_25_168_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_25_168_27&#39;)"><span class="hl_vardecl"><span class="mpre">f1</span></span></a><span class="mpre">, </span><a name="loc_168_29_168_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_29_168_31&#39;)"><span class="hl_vardecl"><span class="mpre">b1</span></span></a><span class="mpre">) = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7&#39;)"><span class="hl_varref"><span class="mpre">lsplit</span></span></a><span class="mpre"> </span><a href="#loc_165_6_165_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_6_165_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><a href="#loc_167_28_167_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_28_167_29&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
                       </span><a name="loc_169_24_169_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_24_169_29&#39;)"><span class="hl_vardecl"><span class="mpre">mbpat</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_168_25_168_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_25_168_27&#39;)"><span class="hl_varref"><span class="mpre">f1</span></span></a><span class="mpre">
                   in ((</span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> </span><a href="Data.ByteString.Lazy.Internal.html#loc_173_1_173_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_173_1_173_6&#39;)"><span class="hl_varref"><span class="mpre">LI.chunk</span></span></a><span class="mpre"> </span><a href="#loc_169_24_169_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_24_169_29&#39;)"><span class="hl_varref"><span class="mpre">mbpat</span></span></a><span class="mpre"> </span><a href="#loc_167_25_167_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_25_167_26&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><a href="#loc_168_29_168_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_29_168_31&#39;)"><span class="hl_varref"><span class="mpre">b1</span></span></a><span class="mpre">), </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_167_28_167_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_167_28_167_29&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | @&#39;replace&#39; pat sub text@ replaces all (non-overlapping) occurrences of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   @pat@ in @text@ with @sub@. If occurrences of @pat@ overlap, the first</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   occurrence that does not overlap with a replaced previous occurrence</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   is substituted. Occurrences of @pat@ arising from a substitution</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   will not be substituted. For example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;replace&#39; \&quot;ana\&quot; \&quot;olog\&quot; \&quot;banana\&quot; = \&quot;bologna\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;replace&#39; \&quot;ana\&quot; \&quot;o\&quot; \&quot;bananana\&quot; = \&quot;bono\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;replace&#39; \&quot;aab\&quot; \&quot;abaa\&quot; \&quot;aaabb\&quot; = \&quot;aabaab\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   The result is a lazy &#39;L.ByteString&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   which is lazily produced, without copying.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Equality of pattern and substitution is not checked, but</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;replace&#39; pat pat text == text</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   holds (the internal structure is generally different).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   If the pattern is empty but not the substitution, the result</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   is equivalent to (were they &#39;String&#39;s) @cycle sub@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   For non-empty @pat@ and @sub@ a lazy &#39;L.ByteString&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;L.concat&#39; . &#39;Data.List.intersperse&#39; sub . &#39;split&#39; pat = &#39;replace&#39; pat sub</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   and analogous relations hold for other types of @sub@.</span></span><span class="mpre">
</span><a href="#loc_208_1_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_8&#39;)"><span class="mpre">replace</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/DFA.hs&quot;, srcSpanStartLine = 203, srcSpanStartColumn = 12, srcSpanEndLine = 204, srcSpanEndColumn = 11}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/DFA.hs&quot;, srcSpanStartLine = 204, srcSpanStartColumn = 9, srcSpanEndLine = 204, srcSpanEndColumn = 11}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename "><span class="mpre">Substitution rep
        =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern to replace</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyvar"><span class="mpre">rep</span></span><span class="mpre">              </span><span class="hl_comment"><span class="mpre">-- ^ Replacement string</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Lazy string to modify</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Lazy result</span></span><span class="mpre">
</span><a name="loc_208_1_208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_1_208_8&#39;)"><span class="hl_fundecl"><span class="mpre">replace</span></span></a><span class="mpre"> </span><a name="loc_208_9_208_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_9_208_12&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_208_9_208_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_9_208_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> = \</span><a name="loc_209_19_209_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_19_209_22&#39;)"><span class="hl_vardecl"><span class="mpre">sub</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ByteString.Search.Substitution.html#loc_34_5_34_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Substitution.html#loc_34_5_34_17&#39;)"><span class="hl_varref"><span class="mpre">prependCycle</span></span></a><span class="mpre"> </span><a href="#loc_209_19_209_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_209_19_209_22&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
    let !</span><a name="loc_211_10_211_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_10_211_16&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_208_9_208_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_9_208_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
        </span><a name="loc_212_9_212_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_9_212_16&#39;)"><span class="hl_vardecl"><span class="mpre">breaker</span></span></a><span class="mpre"> = </span><a href="#loc_371_1_371_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_12&#39;)"><span class="hl_varref"><span class="mpre">lazyBreaker</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_208_9_208_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_9_208_12&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
        </span><a name="loc_213_9_213_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_9_213_13&#39;)"><span class="hl_fundecl"><span class="mpre">repl</span></span></a><span class="mpre"> </span><a name="loc_213_14_213_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_14_213_19&#39;)"><span class="hl_vardecl"><span class="mpre">subst</span></span></a><span class="mpre"> </span><a name="loc_213_20_213_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_20_213_24&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_213_20_213_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_20_213_24&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">   = []
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">   =
            let (</span><a name="loc_216_18_216_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_18_216_21&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a name="loc_216_23_216_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_23_216_27&#39;)"><span class="hl_vardecl"><span class="mpre">mtch</span></span></a><span class="mpre">) = </span><a href="#loc_212_9_212_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_9_212_16&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a href="#loc_213_20_213_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_20_213_24&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">
            in </span><a href="#loc_216_18_216_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_18_216_21&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> case </span><a href="#loc_216_23_216_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_23_216_27&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre"> of
                        [] -&gt; []
                        _  -&gt; </span><a href="#loc_213_14_213_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_14_213_19&#39;)"><span class="hl_varref"><span class="mpre">subst</span></span></a><span class="mpre"> (</span><a href="#loc_213_9_213_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_9_213_13&#39;)"><span class="hl_varref"><span class="mpre">repl</span></span></a><span class="mpre"> </span><a href="#loc_213_14_213_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_14_213_19&#39;)"><span class="hl_varref"><span class="mpre">subst</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Search.Internal.Utils.html#loc_290_1_290_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_290_1_290_6&#39;)"><span class="hl_varref"><span class="mpre">ldrop</span></span></a><span class="mpre"> </span><a href="#loc_211_10_211_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_10_211_16&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><a href="#loc_216_23_216_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_23_216_27&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre">))
    in \</span><a name="loc_220_9_220_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_9_220_12&#39;)"><span class="hl_vardecl"><span class="mpre">sub</span></span></a><span class="mpre"> -&gt; let </span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_221_21_221_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_21_221_26&#39;)"><span class="mpre">subst</span></a><span class="mpre"> #-}</span></span><span class="mpre">
                   !</span><a name="loc_221_21_221_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_21_221_26&#39;)"><span class="hl_vardecl"><span class="mpre">subst</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Search.Substitution.html#loc_23_5_23_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Substitution.html#loc_23_5_23_17&#39;)"><span class="hl_varref"><span class="mpre">substitution</span></span></a><span class="mpre"> </span><a href="#loc_220_9_220_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_9_220_12&#39;)"><span class="hl_varref"><span class="mpre">sub</span></span></a><span class="mpre">
                   </span><a name="loc_222_20_222_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_20_222_25&#39;)"><span class="hl_vardecl"><span class="mpre">repl1</span></span></a><span class="mpre"> = </span><a href="#loc_213_9_213_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_9_213_13&#39;)"><span class="hl_varref"><span class="mpre">repl</span></span></a><span class="mpre"> </span><a href="#loc_221_21_221_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_21_221_26&#39;)"><span class="hl_varref"><span class="mpre">subst</span></span></a><span class="mpre">
               in </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_222_20_222_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_20_222_25&#39;)"><span class="hl_varref"><span class="mpre">repl1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @&#39;split&#39; pattern target@ splits @target@ at each (non-overlapping)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   occurrence of @pattern@, removing @pattern@. If @pattern@ is empty,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   the result is an infinite list of empty &#39;L.ByteString&#39;s, if @target@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   is empty but not @pattern@, the result is an empty list, otherwise</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   the following relations hold (where @patL@ is the lazy &#39;L.ByteString&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   corresponding to @pat@):</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;L.concat&#39; . &#39;Data.List.intersperse&#39; patL . &#39;split&#39; pat = &#39;id&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;length&#39; (&#39;split&#39; pattern target) ==</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               &#39;length&#39; (&#39;nonOverlappingIndices&#39; pattern target) + 1,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   no fragment in the result contains an occurrence of @pattern@.</span></span><span class="mpre">
</span><a href="#loc_243_1_243_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_6&#39;)"><span class="mpre">split</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern to split on</span></span><span class="mpre">
      -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ Lazy string to split</span></span><span class="mpre">
      -&gt; [</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ Fragments of string</span></span><span class="mpre">
</span><a name="loc_243_1_243_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_6&#39;)"><span class="hl_fundecl"><span class="mpre">split</span></span></a><span class="mpre"> </span><a name="loc_243_7_243_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_7_243_10&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_243_7_243_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_7_243_10&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">)
</span><a href="#loc_243_1_243_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_1_243_6&#39;)"><span class="hl_fundecl"><span class="mpre">split</span></span></a><span class="mpre"> </span><a name="loc_245_7_245_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_7_245_10&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_249_5_249_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_5_249_13&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    !</span><a name="loc_247_6_247_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_6_247_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_245_7_245_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_7_245_10&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_248_5_248_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_5_248_12&#39;)"><span class="hl_vardecl"><span class="mpre">breaker</span></span></a><span class="mpre"> = </span><a href="#loc_371_1_371_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_12&#39;)"><span class="hl_varref"><span class="mpre">lazyBreaker</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_245_7_245_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_7_245_10&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_249_5_249_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_5_249_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a name="loc_249_14_249_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_14_249_18&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_249_14_249_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_14_249_18&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">  = []
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><a href="#loc_252_5_252_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_5_252_14&#39;)"><span class="hl_varref"><span class="mpre">splitter&#39;</span></span></a><span class="mpre"> </span><a href="#loc_249_14_249_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_14_249_18&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">
    </span><a name="loc_252_5_252_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_5_252_14&#39;)"><span class="hl_fundecl"><span class="mpre">splitter&#39;</span></span></a><span class="mpre"> </span><a name="loc_252_15_252_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_15_252_19&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_252_15_252_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_15_252_19&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">  = [[]]
      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  =
        case </span><a href="#loc_248_5_248_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_5_248_12&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a href="#loc_252_15_252_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_15_252_19&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre"> of
          (</span><a name="loc_256_12_256_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_12_256_15&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a name="loc_256_17_256_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_17_256_21&#39;)"><span class="hl_vardecl"><span class="mpre">mtch</span></span></a><span class="mpre">) -&gt;
            </span><a href="#loc_256_12_256_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_12_256_15&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> case </span><a href="#loc_256_17_256_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_17_256_21&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre"> of
                    [] -&gt; []
                    _  -&gt; </span><a href="#loc_252_5_252_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_5_252_14&#39;)"><span class="hl_varref"><span class="mpre">splitter&#39;</span></span></a><span class="mpre"> (</span><a href="Data.ByteString.Search.Internal.Utils.html#loc_290_1_290_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_290_1_290_6&#39;)"><span class="hl_varref"><span class="mpre">ldrop</span></span></a><span class="mpre"> </span><a href="#loc_247_6_247_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_6_247_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><a href="#loc_256_17_256_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_17_256_21&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | @&#39;splitKeepEnd&#39; pattern target@ splits @target@ after each (non-overlapping)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   occurrence of @pattern@. If @pattern@ is empty, the result is an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   infinite list of empty &#39;L.ByteString&#39;s, otherwise the following</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   relations hold:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;L.concat&#39; . &#39;splitKeepEnd&#39; pattern = &#39;id,&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   all fragments in the result except possibly the last end with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   @pattern@, no fragment contains more than one occurrence of @pattern@.</span></span><span class="mpre">
</span><a href="#loc_275_1_275_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_1_275_13&#39;)"><span class="mpre">splitKeepEnd</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern to split on</span></span><span class="mpre">
             -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Lazy string to split</span></span><span class="mpre">
             -&gt; [</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">]  </span><span class="hl_comment"><span class="mpre">-- ^ Fragments of string</span></span><span class="mpre">
</span><a name="loc_275_1_275_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_1_275_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitKeepEnd</span></span></a><span class="mpre"> </span><a name="loc_275_14_275_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_14_275_17&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_275_14_275_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_14_275_17&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">)
</span><a href="#loc_275_1_275_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_1_275_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitKeepEnd</span></span></a><span class="mpre"> </span><a name="loc_277_14_277_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_14_277_17&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_280_5_280_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_5_280_13&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    </span><a name="loc_279_5_279_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_5_279_12&#39;)"><span class="hl_vardecl"><span class="mpre">breaker</span></span></a><span class="mpre"> = </span><a href="#loc_371_1_371_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_12&#39;)"><span class="hl_varref"><span class="mpre">lazyBreaker</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><a href="#loc_277_14_277_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_14_277_17&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_280_5_280_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_5_280_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitter</span></span></a><span class="mpre"> [] = []
    </span><a href="#loc_280_5_280_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_5_280_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a name="loc_281_14_281_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_14_281_18&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> =
      case </span><a href="#loc_279_5_279_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_5_279_12&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a href="#loc_281_14_281_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_14_281_18&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre"> of
        (</span><a name="loc_283_10_283_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_10_283_13&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a name="loc_283_15_283_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_15_283_19&#39;)"><span class="hl_vardecl"><span class="mpre">mtch</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_283_10_283_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_10_283_13&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_280_5_280_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_5_280_13&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a href="#loc_283_15_283_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_15_283_19&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @&#39;splitKeepFront&#39;@ is like &#39;splitKeepEnd&#39;, except that @target@ is split</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   before each occurrence of @pattern@ and hence all fragments</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   with the possible exception of the first begin with @pattern@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   No fragment contains more than one non-overlapping occurrence</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   of @pattern@.</span></span><span class="mpre">
</span><a href="#loc_293_1_293_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_1_293_15&#39;)"><span class="mpre">splitKeepFront</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Strict pattern to split on</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Lazy string to split</span></span><span class="mpre">
               -&gt; [</span><span class="hl_tyconref"><span class="mpre">L.ByteString</span></span><span class="mpre">]  </span><span class="hl_comment"><span class="mpre">-- ^ Fragments of string</span></span><span class="mpre">
</span><a name="loc_293_1_293_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_1_293_15&#39;)"><span class="hl_fundecl"><span class="mpre">splitKeepFront</span></span></a><span class="mpre"> </span><a name="loc_293_16_293_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_16_293_19&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_293_16_293_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_16_293_19&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.empty</span></span><span class="mpre">)
</span><a href="#loc_293_1_293_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_293_1_293_15&#39;)"><span class="hl_fundecl"><span class="mpre">splitKeepFront</span></span></a><span class="mpre"> </span><a name="loc_295_16_295_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_16_295_19&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.fromChunks</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_299_5_299_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_5_299_13&#39;)"><span class="hl_varref"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">L.toChunks</span></span><span class="mpre">
  where
    !</span><a name="loc_297_6_297_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_6_297_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_295_16_295_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_16_295_19&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_298_5_298_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_5_298_12&#39;)"><span class="hl_vardecl"><span class="mpre">breaker</span></span></a><span class="mpre"> = </span><a href="#loc_371_1_371_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_12&#39;)"><span class="hl_varref"><span class="mpre">lazyBreaker</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a href="#loc_295_16_295_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_16_295_19&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    </span><a name="loc_299_5_299_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_5_299_13&#39;)"><span class="hl_fundecl"><span class="mpre">splitter</span></span></a><span class="mpre"> </span><a name="loc_299_14_299_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_14_299_18&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> = case </span><a href="#loc_302_5_302_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_5_302_14&#39;)"><span class="hl_varref"><span class="mpre">splitter&#39;</span></span></a><span class="mpre"> </span><a href="#loc_299_14_299_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_14_299_18&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre"> of
                      ([] </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_300_29_300_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_29_300_32&#39;)"><span class="hl_vardecl"><span class="mpre">rst</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_300_29_300_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_29_300_32&#39;)"><span class="hl_varref"><span class="mpre">rst</span></span></a><span class="mpre">
                      </span><a name="loc_301_23_301_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_23_301_28&#39;)"><span class="hl_vardecl"><span class="mpre">other</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_301_23_301_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_301_23_301_28&#39;)"><span class="hl_varref"><span class="mpre">other</span></span></a><span class="mpre">
    </span><a name="loc_302_5_302_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_5_302_14&#39;)"><span class="hl_fundecl"><span class="mpre">splitter&#39;</span></span></a><span class="mpre"> []    = []
    </span><a href="#loc_302_5_302_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_5_302_14&#39;)"><span class="hl_fundecl"><span class="mpre">splitter&#39;</span></span></a><span class="mpre"> </span><a name="loc_303_15_303_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_15_303_19&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre">  =
      case </span><a href="#loc_298_5_298_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_298_5_298_12&#39;)"><span class="hl_varref"><span class="mpre">breaker</span></span></a><span class="mpre"> </span><a href="#loc_303_15_303_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_15_303_19&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre"> of
        (</span><a name="loc_305_10_305_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_10_305_13&#39;)"><span class="hl_vardecl"><span class="mpre">pre</span></span></a><span class="mpre">, </span><a name="loc_305_15_305_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_15_305_19&#39;)"><span class="hl_vardecl"><span class="mpre">mtch</span></span></a><span class="mpre">) -&gt;
          </span><a href="#loc_305_10_305_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_10_305_13&#39;)"><span class="hl_varref"><span class="mpre">pre</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> case </span><a href="#loc_305_15_305_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_15_305_19&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre"> of
                  [] -&gt; []
                  _  -&gt; case </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_310_1_310_7&#39;)"><span class="hl_varref"><span class="mpre">lsplit</span></span></a><span class="mpre"> </span><a href="#loc_297_6_297_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_6_297_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> </span><a href="#loc_305_15_305_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_15_305_19&#39;)"><span class="hl_varref"><span class="mpre">mtch</span></span></a><span class="mpre"> of
                          (</span><a name="loc_309_28_309_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_28_309_30&#39;)"><span class="hl_vardecl"><span class="mpre">pt</span></span></a><span class="mpre">, </span><a name="loc_309_32_309_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_32_309_35&#39;)"><span class="hl_vardecl"><span class="mpre">rst</span></span></a><span class="mpre">) -&gt;
                            if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_309_32_309_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_32_309_35&#39;)"><span class="hl_varref"><span class="mpre">rst</span></span></a><span class="mpre">
                              then [</span><a href="#loc_309_28_309_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_28_309_30&#39;)"><span class="hl_varref"><span class="mpre">pt</span></span></a><span class="mpre">]
                              else let (</span><a name="loc_312_41_312_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_41_312_42&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_312_45_312_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_45_312_46&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">) = </span><a href="#loc_302_5_302_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_5_302_14&#39;)"><span class="hl_varref"><span class="mpre">splitter&#39;</span></span></a><span class="mpre"> </span><a href="#loc_309_32_309_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_32_309_35&#39;)"><span class="hl_varref"><span class="mpre">rst</span></span></a><span class="mpre">
                                   in (</span><a href="#loc_309_28_309_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_28_309_30&#39;)"><span class="hl_varref"><span class="mpre">pt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_312_41_312_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_41_312_42&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_312_45_312_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_45_312_46&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                            Searching Function                            --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_320_1_320_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_13&#39;)"><span class="mpre">lazySearcher</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; [</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre">]
</span><a name="loc_320_1_320_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_13&#39;)"><span class="hl_fundecl"><span class="mpre">lazySearcher</span></span></a><span class="mpre"> _ !</span><a name="loc_320_17_320_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_17_320_20&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_320_17_320_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_17_320_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">        =
      let </span><a name="loc_322_11_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_11_322_14&#39;)"><span class="hl_fundecl"><span class="mpre">zgo</span></span></a><span class="mpre"> _ [] = []
          </span><a href="#loc_322_11_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_11_322_14&#39;)"><span class="hl_fundecl"><span class="mpre">zgo</span></span></a><span class="mpre"> !</span><a name="loc_323_16_323_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_16_323_21&#39;)"><span class="hl_vardecl"><span class="mpre">prior</span></span></a><span class="mpre"> (!</span><a name="loc_323_24_323_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_24_323_27&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_323_30_323_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_30_323_34&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) =
              let !</span><a name="loc_324_20_324_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_20_324_21&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_323_24_323_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_24_323_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
                  !</span><a name="loc_325_20_325_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_20_325_26&#39;)"><span class="hl_vardecl"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_323_16_323_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_16_323_21&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_324_20_324_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_324_20_324_21&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
              in [</span><a href="#loc_323_16_323_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_16_323_21&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_326_44_326_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_44_326_45&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> | </span><a name="loc_326_44_326_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_44_326_45&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> &lt;- </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/DFA.hs&quot;, srcSpanStartLine = 326, srcSpanStartColumn = 49, srcSpanEndLine = 326, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/stringsearch-0.3.6.5/Data/ByteString/Lazy/Search/DFA.hs&quot;, srcSpanStartLine = 326, srcSpanStartColumn = 49, srcSpanEndLine = 326, srcSpanEndColumn = 50},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/strings"><span class="mpre">[1 .. l]</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_322_11_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_11_322_14&#39;)"><span class="hl_varref"><span class="mpre">zgo</span></span></a><span class="mpre"> </span><a href="#loc_325_20_325_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_325_20_325_26&#39;)"><span class="hl_varref"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> </span><a href="#loc_323_30_323_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_323_30_323_34&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
      in (</span><span class="hl_num"><span class="mpre">0</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_322_11_322_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_11_322_14&#39;)"><span class="hl_varref"><span class="mpre">zgo</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_320_17_320_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_17_320_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> =
      let !</span><a name="loc_329_12_329_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_12_329_13&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.head</span></span><span class="mpre"> </span><a href="#loc_320_17_320_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_17_320_20&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
          </span><a name="loc_330_11_330_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_11_330_15&#39;)"><span class="hl_vardecl"><span class="mpre">ixes</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.elemIndices</span></span><span class="mpre"> </span><a href="#loc_329_12_329_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_12_329_13&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">
          </span><a name="loc_331_11_331_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_11_331_13&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> _ [] = []
          </span><a href="#loc_331_11_331_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_11_331_13&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_332_15_332_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_15_332_20&#39;)"><span class="hl_vardecl"><span class="mpre">prior</span></span></a><span class="mpre"> (!</span><a name="loc_332_23_332_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_23_332_26&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_332_29_332_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_29_332_33&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">)
            = let !</span><a name="loc_333_20_333_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_20_333_26&#39;)"><span class="hl_vardecl"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_332_15_332_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_15_332_20&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_332_23_332_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_23_332_26&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)
              in </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_332_15_332_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_15_332_20&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">) (</span><a href="#loc_330_11_330_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_330_11_330_15&#39;)"><span class="hl_varref"><span class="mpre">ixes</span></span></a><span class="mpre"> </span><a href="#loc_332_23_332_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_23_332_26&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_331_11_331_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_11_331_13&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_333_20_333_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_20_333_26&#39;)"><span class="hl_varref"><span class="mpre">prior&#39;</span></span></a><span class="mpre"> </span><a href="#loc_332_29_332_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_29_332_33&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
      in </span><a href="#loc_331_11_331_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_331_11_331_13&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
</span><a href="#loc_320_1_320_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_13&#39;)"><span class="hl_fundecl"><span class="mpre">lazySearcher</span></span></a><span class="mpre"> !</span><a name="loc_336_15_336_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_15_336_22&#39;)"><span class="hl_vardecl"><span class="mpre">overlap</span></span></a><span class="mpre"> </span><a name="loc_336_23_336_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_23_336_26&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_342_5_342_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_5_342_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  where
    !</span><a name="loc_338_6_338_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_6_338_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_336_23_336_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_23_336_26&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    !</span><a name="loc_339_6_339_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_6_339_10&#39;)"><span class="hl_vardecl"><span class="mpre">auto</span></span></a><span class="mpre">   = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_45_1_45_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_45_1_45_10&#39;)"><span class="hl_varref"><span class="mpre">automaton</span></span></a><span class="mpre"> </span><a href="#loc_336_23_336_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_23_336_26&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    !</span><a name="loc_340_6_340_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_6_340_8&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre">     = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_336_23_336_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_23_336_26&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    !</span><a name="loc_341_6_341_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_6_341_9&#39;)"><span class="hl_vardecl"><span class="mpre">ams</span></span></a><span class="mpre">    = if </span><a href="#loc_336_15_336_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_336_15_336_22&#39;)"><span class="hl_varref"><span class="mpre">overlap</span></span></a><span class="mpre"> then </span><a href="#loc_338_6_338_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_6_338_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> else </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><a name="loc_342_5_342_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_5_342_11&#39;)"><span class="hl_fundecl"><span class="mpre">search</span></span></a><span class="mpre"> _ _ [] = []
    </span><a href="#loc_342_5_342_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_5_342_11&#39;)"><span class="hl_fundecl"><span class="mpre">search</span></span></a><span class="mpre"> !</span><a name="loc_343_13_343_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_13_343_18&#39;)"><span class="hl_vardecl"><span class="mpre">prior</span></span></a><span class="mpre"> </span><a name="loc_343_19_343_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_19_343_21&#39;)"><span class="hl_vardecl"><span class="mpre">st</span></span></a><span class="mpre"> (!</span><a name="loc_343_24_343_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_24_343_27&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_343_28_343_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_28_343_32&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><a href="#loc_349_9_349_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_9_349_14&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_343_19_343_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_19_343_21&#39;)"><span class="hl_varref"><span class="mpre">st</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
      where
        !</span><a name="loc_345_10_345_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_10_345_16&#39;)"><span class="hl_vardecl"><span class="mpre">strLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_343_24_343_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_24_343_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
        </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_348_9_348_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_9_348_14&#39;)"><span class="mpre">strAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
        </span><a href="#loc_348_9_348_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_9_348_14&#39;)"><span class="mpre">strAt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
        </span><a name="loc_348_9_348_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_9_348_14&#39;)"><span class="hl_fundecl"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a name="loc_348_15_348_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_15_348_16&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_343_24_343_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_24_343_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_infix"><span class="mpre">`unsafeIndex`</span></span></a><span class="mpre"> </span><a href="#loc_348_15_348_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_15_348_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
        </span><a name="loc_349_9_349_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_9_349_14&#39;)"><span class="hl_fundecl"><span class="mpre">match</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> !</span><a name="loc_349_18_349_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_18_349_21&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre">
          | </span><a href="#loc_349_18_349_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_18_349_21&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_345_10_345_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_10_345_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> = </span><a href="#loc_342_5_342_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_5_342_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> (</span><a href="#loc_343_13_343_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_13_343_18&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_345_10_345_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_10_345_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_343_28_343_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_28_343_32&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
          | </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_343_24_343_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_24_343_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_349_18_349_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_18_349_21&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_340_6_340_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_6_340_8&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre">   = </span><a href="#loc_349_9_349_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_9_349_14&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (</span><a href="#loc_349_18_349_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_18_349_21&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><a href="#loc_349_9_349_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_9_349_14&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><a href="#loc_349_18_349_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_18_349_21&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><a href="#loc_349_9_349_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_9_349_14&#39;)"><span class="hl_fundecl"><span class="mpre">match</span></span></a><span class="mpre"> </span><a name="loc_353_15_353_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_15_353_20&#39;)"><span class="hl_vardecl"><span class="mpre">state</span></span></a><span class="mpre"> </span><a name="loc_353_21_353_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_21_353_24&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre">
          | </span><a href="#loc_353_21_353_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_21_353_24&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_345_10_345_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_10_345_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> = </span><a href="#loc_342_5_342_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_5_342_11&#39;)"><span class="hl_varref"><span class="mpre">search</span></span></a><span class="mpre"> (</span><a href="#loc_343_13_343_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_13_343_18&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_345_10_345_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_345_10_345_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">) </span><a href="#loc_353_15_353_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_15_353_20&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><a href="#loc_343_28_343_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_28_343_32&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     =
            let </span><a name="loc_356_17_356_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_17_356_23&#39;)"><span class="hl_vardecl"><span class="mpre">nstate</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_339_6_339_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_6_339_10&#39;)"><span class="hl_varref"><span class="mpre">auto</span></span></a><span class="mpre"> ((</span><a href="#loc_353_15_353_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_15_353_20&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_348_9_348_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_348_9_348_14&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_353_21_353_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_21_353_24&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre">)
                !</span><a name="loc_357_18_357_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_18_357_24&#39;)"><span class="hl_vardecl"><span class="mpre">nxtIdx</span></span></a><span class="mpre"> = </span><a href="#loc_353_21_353_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_21_353_24&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
            in if </span><a href="#loc_356_17_356_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_17_356_23&#39;)"><span class="hl_varref"><span class="mpre">nstate</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_338_6_338_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_6_338_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">
                then (</span><a href="#loc_343_13_343_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_13_343_18&#39;)"><span class="hl_varref"><span class="mpre">prior</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_357_18_357_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_18_357_24&#39;)"><span class="hl_varref"><span class="mpre">nxtIdx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_338_6_338_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_6_338_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">
                            </span><a href="#loc_349_9_349_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_9_349_14&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_341_6_341_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_6_341_9&#39;)"><span class="hl_varref"><span class="mpre">ams</span></span></a><span class="mpre"> </span><a href="#loc_357_18_357_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_18_357_24&#39;)"><span class="hl_varref"><span class="mpre">nxtIdx</span></span></a><span class="mpre">
                else </span><a href="#loc_349_9_349_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_9_349_14&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_356_17_356_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_356_17_356_23&#39;)"><span class="hl_varref"><span class="mpre">nstate</span></span></a><span class="mpre"> </span><a href="#loc_357_18_357_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_357_18_357_24&#39;)"><span class="hl_varref"><span class="mpre">nxtIdx</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                                 Breaking                                 --</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Code duplication :(</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Needed for reasonable performance.</span></span><span class="mpre">
</span><a href="#loc_371_1_371_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_12&#39;)"><span class="mpre">lazyBreaker</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]
                    -&gt; ([</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">], [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">])
</span><a name="loc_371_1_371_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_12&#39;)"><span class="hl_fundecl"><span class="mpre">lazyBreaker</span></span></a><span class="mpre"> </span><a name="loc_371_13_371_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_13_371_19&#39;)"><span class="hl_vardecl"><span class="mpre">before</span></span></a><span class="mpre"> </span><a name="loc_371_20_371_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_20_371_23&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_371_20_371_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_20_371_23&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">  = \</span><a name="loc_372_20_372_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_20_372_24&#39;)"><span class="hl_vardecl"><span class="mpre">strs</span></span></a><span class="mpre"> -&gt; ([], </span><a href="#loc_372_20_372_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_20_372_24&#39;)"><span class="hl_varref"><span class="mpre">strs</span></span></a><span class="mpre">)
  | </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_371_20_371_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_20_371_23&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> =
    let !</span><a name="loc_374_10_374_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_10_374_11&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.head</span></span><span class="mpre"> </span><a href="#loc_371_20_371_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_20_371_23&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
        !</span><a name="loc_375_10_375_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_10_375_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = if </span><a href="#loc_371_13_371_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_13_371_19&#39;)"><span class="hl_varref"><span class="mpre">before</span></span></a><span class="mpre"> then </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> else </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        </span><a name="loc_376_9_376_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_9_376_13&#39;)"><span class="hl_vardecl"><span class="mpre">ixes</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.elemIndices</span></span><span class="mpre"> </span><a href="#loc_374_10_374_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_374_10_374_11&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">
        </span><a name="loc_377_9_377_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_9_377_13&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> [] = ([], [])
        </span><a href="#loc_377_9_377_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_9_377_13&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> (!</span><a name="loc_378_16_378_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_16_378_19&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_378_20_378_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_20_378_24&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) =
            let !</span><a name="loc_379_18_379_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_18_379_24&#39;)"><span class="hl_vardecl"><span class="mpre">strLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_378_16_378_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_16_378_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
            in case </span><a href="#loc_376_9_376_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_9_376_13&#39;)"><span class="hl_varref"><span class="mpre">ixes</span></span></a><span class="mpre"> </span><a href="#loc_378_16_378_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_16_378_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> of
                []  -&gt; let (</span><a name="loc_381_29_381_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_29_381_31&#39;)"><span class="hl_vardecl"><span class="mpre">fr</span></span></a><span class="mpre">, </span><a name="loc_381_33_381_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_33_381_35&#39;)"><span class="hl_vardecl"><span class="mpre">bk</span></span></a><span class="mpre">) = </span><a href="#loc_377_9_377_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_9_377_13&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_378_20_378_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_20_378_24&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> in (</span><a href="#loc_378_16_378_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_16_378_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_381_29_381_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_29_381_31&#39;)"><span class="hl_varref"><span class="mpre">fr</span></span></a><span class="mpre">, </span><a href="#loc_381_33_381_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_381_33_381_35&#39;)"><span class="hl_varref"><span class="mpre">bk</span></span></a><span class="mpre">)
                (</span><a name="loc_382_18_382_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_18_382_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; let !</span><a name="loc_382_31_382_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_31_382_32&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> = </span><a href="#loc_382_18_382_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_18_382_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_375_10_375_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_375_10_375_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
                         in if </span><a href="#loc_382_31_382_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_31_382_32&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_379_18_379_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_18_379_24&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre">
                              then ([</span><a href="#loc_378_16_378_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_16_378_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">],</span><a href="#loc_378_20_378_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_20_378_24&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
                              else ([</span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_382_31_382_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_31_382_32&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> </span><a href="#loc_378_16_378_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_16_378_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">], </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_382_31_382_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_31_382_32&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> </span><a href="#loc_378_16_378_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_16_378_19&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_378_20_378_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_20_378_24&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
    in </span><a href="#loc_377_9_377_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_9_377_13&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre">
</span><a href="#loc_371_1_371_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_1_371_12&#39;)"><span class="hl_fundecl"><span class="mpre">lazyBreaker</span></span></a><span class="mpre"> !</span><a name="loc_387_14_387_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_14_387_20&#39;)"><span class="hl_vardecl"><span class="mpre">before</span></span></a><span class="mpre"> </span><a name="loc_387_21_387_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_21_387_24&#39;)"><span class="hl_vardecl"><span class="mpre">pat</span></span></a><span class="mpre"> = </span><a href="#loc_392_5_392_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_5_392_10&#39;)"><span class="hl_varref"><span class="mpre">bscan</span></span></a><span class="mpre"> [] </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  where
    !</span><a name="loc_389_6_389_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_6_389_12&#39;)"><span class="hl_vardecl"><span class="mpre">patLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_387_21_387_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_21_387_24&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    !</span><a name="loc_390_6_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_6_390_10&#39;)"><span class="hl_vardecl"><span class="mpre">auto</span></span></a><span class="mpre">   = </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_45_1_45_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_45_1_45_10&#39;)"><span class="hl_varref"><span class="mpre">automaton</span></span></a><span class="mpre"> </span><a href="#loc_387_21_387_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_21_387_24&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre">
    !</span><a name="loc_391_6_391_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_6_391_8&#39;)"><span class="hl_vardecl"><span class="mpre">p0</span></span></a><span class="mpre">     = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_387_21_387_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_21_387_24&#39;)"><span class="hl_varref"><span class="mpre">pat</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><a name="loc_392_5_392_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_5_392_10&#39;)"><span class="hl_fundecl"><span class="mpre">bscan</span></span></a><span class="mpre"> _ _ [] = ([], [])
    </span><a href="#loc_392_5_392_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_5_392_10&#39;)"><span class="hl_fundecl"><span class="mpre">bscan</span></span></a><span class="mpre"> !</span><a name="loc_393_12_393_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_12_393_16&#39;)"><span class="hl_vardecl"><span class="mpre">past</span></span></a><span class="mpre"> !</span><a name="loc_393_18_393_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_18_393_21&#39;)"><span class="hl_vardecl"><span class="mpre">sta</span></span></a><span class="mpre"> (!</span><a name="loc_393_24_393_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_24_393_27&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_393_28_393_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_28_393_32&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><a href="#loc_399_9_399_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_9_399_14&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_393_18_393_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_18_393_21&#39;)"><span class="hl_varref"><span class="mpre">sta</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
      where
        !</span><a name="loc_395_10_395_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_10_395_16&#39;)"><span class="hl_vardecl"><span class="mpre">strLen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_393_24_393_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_24_393_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
        </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_398_9_398_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_9_398_14&#39;)"><span class="mpre">strAt</span></a><span class="mpre"> #-}</span></span><span class="mpre">
        </span><a href="#loc_398_9_398_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_9_398_14&#39;)"><span class="mpre">strAt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
        </span><a name="loc_398_9_398_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_9_398_14&#39;)"><span class="hl_fundecl"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a name="loc_398_15_398_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_15_398_16&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_393_24_393_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_24_393_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_infix"><span class="mpre">`unsafeIndex`</span></span></a><span class="mpre"> </span><a href="#loc_398_15_398_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_15_398_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
        </span><a name="loc_399_9_399_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_9_399_14&#39;)"><span class="hl_fundecl"><span class="mpre">match</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_399_17_399_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_17_399_20&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre">
          | </span><a href="#loc_399_17_399_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_17_399_20&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_395_10_395_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_10_395_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> =
            let (</span><a name="loc_401_18_401_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_18_401_20&#39;)"><span class="hl_vardecl"><span class="mpre">fr</span></span></a><span class="mpre">, </span><a name="loc_401_22_401_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_22_401_24&#39;)"><span class="hl_vardecl"><span class="mpre">bk</span></span></a><span class="mpre">) = </span><a href="#loc_392_5_392_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_5_392_10&#39;)"><span class="hl_varref"><span class="mpre">bscan</span></span></a><span class="mpre"> [] </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_393_28_393_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_28_393_32&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
            in (</span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_393_12_393_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_12_393_16&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> (</span><a href="#loc_393_24_393_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_24_393_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_401_18_401_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_18_401_20&#39;)"><span class="hl_varref"><span class="mpre">fr</span></span></a><span class="mpre">), </span><a href="#loc_401_22_401_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_22_401_24&#39;)"><span class="hl_varref"><span class="mpre">bk</span></span></a><span class="mpre">)
          | </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_393_24_393_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_24_393_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><a href="#loc_399_17_399_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_17_399_20&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_391_6_391_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_6_391_8&#39;)"><span class="hl_varref"><span class="mpre">p0</span></span></a><span class="mpre"> = </span><a href="#loc_399_9_399_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_9_399_14&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (</span><a href="#loc_399_17_399_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_17_399_20&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_399_9_399_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_9_399_14&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><a href="#loc_399_17_399_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_17_399_20&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
        </span><a href="#loc_399_9_399_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_9_399_14&#39;)"><span class="hl_fundecl"><span class="mpre">match</span></span></a><span class="mpre"> </span><a name="loc_405_15_405_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_15_405_20&#39;)"><span class="hl_vardecl"><span class="mpre">state</span></span></a><span class="mpre"> </span><a name="loc_405_21_405_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_21_405_24&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre">
          | </span><a href="#loc_405_21_405_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_21_405_24&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_395_10_395_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_10_395_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> =
            let (</span><a name="loc_407_18_407_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_18_407_20&#39;)"><span class="hl_vardecl"><span class="mpre">kp</span></span></a><span class="mpre">, !</span><a name="loc_407_23_407_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_23_407_25&#39;)"><span class="hl_vardecl"><span class="mpre">rl</span></span></a><span class="mpre">) = if </span><a href="#loc_387_14_387_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_14_387_20&#39;)"><span class="hl_varref"><span class="mpre">before</span></span></a><span class="mpre">
                                then </span><a href="Data.ByteString.Search.Internal.Utils.html#loc_338_1_338_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Search.Internal.Utils.html#loc_338_1_338_5&#39;)"><span class="hl_varref"><span class="mpre">keep</span></span></a><span class="mpre"> </span><a href="#loc_405_15_405_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_15_405_20&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> (</span><a href="#loc_393_24_393_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_24_393_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_393_12_393_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_12_393_16&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre">)
                                else ([], </span><a href="#loc_393_24_393_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_24_393_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_393_12_393_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_12_393_16&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre">)
                (</span><a name="loc_410_18_410_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_18_410_20&#39;)"><span class="hl_vardecl"><span class="mpre">fr</span></span></a><span class="mpre">, </span><a name="loc_410_22_410_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_22_410_24&#39;)"><span class="hl_vardecl"><span class="mpre">bk</span></span></a><span class="mpre">) = </span><a href="#loc_392_5_392_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_5_392_10&#39;)"><span class="hl_varref"><span class="mpre">bscan</span></span></a><span class="mpre"> </span><a href="#loc_407_18_407_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_18_407_20&#39;)"><span class="hl_varref"><span class="mpre">kp</span></span></a><span class="mpre"> </span><a href="#loc_405_15_405_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_15_405_20&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><a href="#loc_393_28_393_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_28_393_32&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
            in (</span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_407_23_407_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_407_23_407_25&#39;)"><span class="hl_varref"><span class="mpre">rl</span></span></a><span class="mpre"> </span><a href="#loc_410_18_410_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_18_410_20&#39;)"><span class="hl_varref"><span class="mpre">fr</span></span></a><span class="mpre">, </span><a href="#loc_410_22_410_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_410_22_410_24&#39;)"><span class="hl_varref"><span class="mpre">bk</span></span></a><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> =
            let !</span><a name="loc_413_18_413_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_18_413_24&#39;)"><span class="hl_vardecl"><span class="mpre">nstate</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unsafeAt</span></span><span class="mpre"> </span><a href="#loc_390_6_390_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_6_390_10&#39;)"><span class="hl_varref"><span class="mpre">auto</span></span></a><span class="mpre"> ((</span><a href="#loc_405_15_405_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_15_405_20&#39;)"><span class="hl_varref"><span class="mpre">state</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_398_9_398_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_9_398_14&#39;)"><span class="hl_varref"><span class="mpre">strAt</span></span></a><span class="mpre"> </span><a href="#loc_405_21_405_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_21_405_24&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre">)
                !</span><a name="loc_414_18_414_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_18_414_24&#39;)"><span class="hl_vardecl"><span class="mpre">nxtIdx</span></span></a><span class="mpre"> = </span><a href="#loc_405_21_405_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_21_405_24&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
            in if </span><a href="#loc_413_18_413_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_18_413_24&#39;)"><span class="hl_varref"><span class="mpre">nstate</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_389_6_389_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_6_389_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre">
                then case if </span><a href="#loc_387_14_387_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_14_387_20&#39;)"><span class="hl_varref"><span class="mpre">before</span></span></a><span class="mpre"> then </span><a href="#loc_414_18_414_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_18_414_24&#39;)"><span class="hl_varref"><span class="mpre">nxtIdx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_389_6_389_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_6_389_12&#39;)"><span class="hl_varref"><span class="mpre">patLen</span></span></a><span class="mpre"> else </span><a href="#loc_414_18_414_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_18_414_24&#39;)"><span class="hl_varref"><span class="mpre">nxtIdx</span></span></a><span class="mpre"> of
                       </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> -&gt; (</span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_393_12_393_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_12_393_16&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> [], </span><a href="#loc_393_24_393_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_24_393_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_393_28_393_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_28_393_32&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
                       </span><a name="loc_418_24_418_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_24_418_28&#39;)"><span class="hl_vardecl"><span class="mpre">stIx</span></span></a><span class="mpre"> | </span><a href="#loc_418_24_418_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_24_418_28&#39;)"><span class="hl_varref"><span class="mpre">stIx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> -&gt; </span><a href="#loc_431_1_431_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_1_431_4&#39;)"><span class="hl_varref"><span class="mpre">rgo</span></span></a><span class="mpre"> (-</span><a href="#loc_418_24_418_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_24_418_28&#39;)"><span class="hl_varref"><span class="mpre">stIx</span></span></a><span class="mpre">) (</span><a href="#loc_393_24_393_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_24_393_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_393_28_393_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_28_393_32&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">) </span><a href="#loc_393_12_393_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_12_393_16&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre">
                            | </span><a href="#loc_418_24_418_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_24_418_28&#39;)"><span class="hl_varref"><span class="mpre">stIx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_395_10_395_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_10_395_16&#39;)"><span class="hl_varref"><span class="mpre">strLen</span></span></a><span class="mpre"> -&gt;
                              (</span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_393_12_393_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_12_393_16&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre"> [</span><a href="#loc_393_24_393_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_24_393_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">],</span><a href="#loc_393_28_393_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_28_393_32&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
                            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt;
                              (</span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_393_12_393_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_12_393_16&#39;)"><span class="hl_varref"><span class="mpre">past</span></span></a><span class="mpre">
                                    [</span><span class="hl_varref"><span class="mpre">S.take</span></span><span class="mpre"> </span><a href="#loc_418_24_418_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_24_418_28&#39;)"><span class="hl_varref"><span class="mpre">stIx</span></span></a><span class="mpre"> </span><a href="#loc_393_24_393_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_24_393_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">], </span><span class="hl_varref"><span class="mpre">S.drop</span></span><span class="mpre"> </span><a href="#loc_418_24_418_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_24_418_28&#39;)"><span class="hl_varref"><span class="mpre">stIx</span></span></a><span class="mpre"> </span><a href="#loc_393_24_393_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_24_393_27&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_393_28_393_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_28_393_32&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
                else </span><a href="#loc_399_9_399_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_9_399_14&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_413_18_413_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_18_413_24&#39;)"><span class="hl_varref"><span class="mpre">nstate</span></span></a><span class="mpre"> </span><a href="#loc_414_18_414_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_18_414_24&#39;)"><span class="hl_varref"><span class="mpre">nxtIdx</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Did I already mention that I suck at finding names?</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_431_1_431_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_1_431_4&#39;)"><span class="mpre">rgo</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_431_1_431_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_1_431_4&#39;)"><span class="mpre">rgo</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">]
    -&gt; ([</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">], [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">])
</span><a name="loc_431_1_431_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_1_431_4&#39;)"><span class="hl_fundecl"><span class="mpre">rgo</span></span></a><span class="mpre"> !</span><a name="loc_431_6_431_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_6_431_8&#39;)"><span class="hl_vardecl"><span class="mpre">kp</span></span></a><span class="mpre"> </span><a name="loc_431_9_431_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_9_431_12&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> (!</span><a name="loc_431_15_431_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_15_431_18&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_431_19_431_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_19_431_23&#39;)"><span class="hl_vardecl"><span class="mpre">more</span></span></a><span class="mpre">)
  | </span><a href="#loc_438_8_438_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_8_438_10&#39;)"><span class="hl_varref"><span class="mpre">sl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_431_6_431_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_6_431_8&#39;)"><span class="hl_varref"><span class="mpre">kp</span></span></a><span class="mpre">    = (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_431_19_431_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_19_431_23&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre">, </span><a href="#loc_431_15_431_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_15_431_18&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_431_9_431_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_9_431_12&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)
  | </span><a href="#loc_438_8_438_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_8_438_10&#39;)"><span class="hl_varref"><span class="mpre">sl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_431_6_431_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_6_431_8&#39;)"><span class="hl_varref"><span class="mpre">kp</span></span></a><span class="mpre">     = </span><a href="#loc_431_1_431_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_1_431_4&#39;)"><span class="hl_varref"><span class="mpre">rgo</span></span></a><span class="mpre"> (</span><a href="#loc_431_6_431_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_6_431_8&#39;)"><span class="hl_varref"><span class="mpre">kp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_438_8_438_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_8_438_10&#39;)"><span class="hl_varref"><span class="mpre">sl</span></span></a><span class="mpre">) (</span><a href="#loc_431_15_431_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_15_431_18&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_431_9_431_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_9_431_12&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">) </span><a href="#loc_431_19_431_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_19_431_23&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">   = case </span><span class="hl_varref"><span class="mpre">S.splitAt</span></span><span class="mpre"> (</span><a href="#loc_438_8_438_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_8_438_10&#39;)"><span class="hl_varref"><span class="mpre">sl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_431_6_431_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_6_431_8&#39;)"><span class="hl_varref"><span class="mpre">kp</span></span></a><span class="mpre">) </span><a href="#loc_431_15_431_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_15_431_18&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> of
                    (</span><a name="loc_435_22_435_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_22_435_24&#39;)"><span class="hl_vardecl"><span class="mpre">fr</span></span></a><span class="mpre">, </span><a name="loc_435_26_435_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_26_435_28&#39;)"><span class="hl_vardecl"><span class="mpre">bk</span></span></a><span class="mpre">) -&gt;
                      (</span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(.)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_431_19_431_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_19_431_23&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre"> [</span><a href="#loc_435_22_435_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_22_435_24&#39;)"><span class="hl_varref"><span class="mpre">fr</span></span></a><span class="mpre">], </span><a href="#loc_435_26_435_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_26_435_28&#39;)"><span class="hl_varref"><span class="mpre">bk</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_431_9_431_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_9_431_12&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)
    where
      !</span><a name="loc_438_8_438_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_8_438_10&#39;)"><span class="hl_vardecl"><span class="mpre">sl</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_431_15_431_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_15_431_18&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
</span><a href="#loc_431_1_431_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_1_431_4&#39;)"><span class="hl_fundecl"><span class="mpre">rgo</span></span></a><span class="mpre"> _ _ [] = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Not enough past!&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If that error is ever encountered, I screwed up badly.</span></span><span class="mpre">
</span></div></body></html>